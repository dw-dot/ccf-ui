var TFe=Object.defineProperty,AFe=Object.defineProperties,MFe=Object.getOwnPropertyDescriptors,fT=Object.getOwnPropertySymbols,W9=Object.prototype.hasOwnProperty,q9=Object.prototype.propertyIsEnumerable,_r=Math.pow,Y9=(Ut,it,et)=>it in Ut?TFe(Ut,it,{enumerable:!0,configurable:!0,writable:!0,value:et}):Ut[it]=et,ot=(Ut,it)=>{for(var et in it||(it={}))W9.call(it,et)&&Y9(Ut,et,it[et]);if(fT)for(var et of fT(it))q9.call(it,et)&&Y9(Ut,et,it[et]);return Ut},wn=(Ut,it)=>AFe(Ut,MFe(it)),K9=(Ut,it)=>{var et={};for(var yt in Ut)W9.call(Ut,yt)&&it.indexOf(yt)<0&&(et[yt]=Ut[yt]);if(null!=Ut&&fT)for(var yt of fT(Ut))it.indexOf(yt)<0&&q9.call(Ut,yt)&&(et[yt]=Ut[yt]);return et};(self.webpackChunkccf_ui=self.webpackChunkccf_ui||[]).push([[179],{1440:(Ut,it,et)=>{var yt=et(1052).default;Ut.exports=function Y(xe,he,W){function j(H,b){if(!he[H]){if(!xe[H]){if(F)return F(H,!0);var R=new Error("Cannot find module '"+H+"'");throw R.code="MODULE_NOT_FOUND",R}var T=he[H]={exports:{}};xe[H][0].call(T.exports,function(v){return j(xe[H][1][v]||v)},T,T.exports,Y,xe,he,W)}return he[H].exports}for(var F=void 0,Q=0;Q<W.length;Q++)j(W[Q]);return j}({1:[function(Y,xe,he){var W,j;W=this,j=function(W,j,F,Q,H){"use strict";function A(Ae,Ue,qe,Fe){return new(qe||(qe=Promise))(function(G,pe){function de(pt){try{_t(Fe.next(pt))}catch(we){pe(we)}}function je(pt){try{_t(Fe.throw(pt))}catch(we){pe(we)}}function _t(pt){pt.done?G(pt.value):function(G){return G instanceof qe?G:new qe(function(pe){pe(G)})}(pt.value).then(de,je)}_t((Fe=Fe.apply(Ae,Ue||[])).next())})}function z(Ae,Ue){var Fe,q,G,pe,qe={label:0,sent:function(){if(1&G[0])throw G[1];return G[1]},trys:[],ops:[]};return pe={next:de(0),throw:de(1),return:de(2)},"function"==typeof Symbol&&(pe[Symbol.iterator]=function(){return this}),pe;function de(_t){return function(pt){return function(_t){if(Fe)throw new TypeError("Generator is already executing.");for(;qe;)try{if(Fe=1,q&&(G=2&_t[0]?q.return:_t[0]?q.throw||((G=q.return)&&G.call(q),0):q.next)&&!(G=G.call(q,_t[1])).done)return G;switch(q=0,G&&(_t=[2&_t[0],G.value]),_t[0]){case 0:case 1:G=_t;break;case 4:return qe.label++,{value:_t[1],done:!1};case 5:qe.label++,q=_t[1],_t=[0];continue;case 7:_t=qe.ops.pop(),qe.trys.pop();continue;default:if(!(G=(G=qe.trys).length>0&&G[G.length-1])&&(6===_t[0]||2===_t[0])){qe=0;continue}if(3===_t[0]&&(!G||_t[1]>G[0]&&_t[1]<G[3])){qe.label=_t[1];break}if(6===_t[0]&&qe.label<G[1]){qe.label=G[1],G=_t;break}if(G&&qe.label<G[2]){qe.label=G[2],qe.ops.push(_t);break}G[2]&&qe.ops.pop(),qe.trys.pop();continue}_t=Ue.call(Ae,qe)}catch(pt){_t=[6,pt],q=0}finally{Fe=G=0}if(5&_t[0])throw _t[1];return{value:_t[0]?_t[1]:void 0,done:!0}}([_t,pt])}}}function Qe(Ae){var Ue=Ae.length,qe=0;return new H.Readable({objectMode:!0,read:function(){this.push(qe<Ue?Ae[qe++]:null)}})}W.addJsonLdToStore=function(Ae,Ue){return A(this,void 0,void 0,function(){var qe,Fe,q;return z(this,function(G){switch(G.label){case 0:return"string"!=typeof Ae?[3,4]:[4,fetch(Ae,{redirect:"follow"})];case 1:return(Fe=G.sent()).ok?[4,Fe.json()]:[3,3];case 2:qe=G.sent(),G.label=3;case 3:return[3,5];case 4:qe=Ae,G.label=5;case 5:return qe?[4,j.toRDF(qe)]:[3,7];case 6:q=G.sent(),Ue.import(Qe(q)),G.label=7;case 7:return[2,Ue]}})})},W.addN3ToStore=function(Ae,Ue){return A(this,void 0,void 0,function(){var qe,Fe,q;return z(this,function(G){switch(G.label){case 0:return"string"==typeof Ae&&(null==Ae?void 0:Ae.startsWith("http"))?[4,fetch(Ae,{redirect:"follow"})]:[3,4];case 1:return(Fe=G.sent()).ok?[4,Fe.text()]:[3,3];case 2:qe=G.sent(),G.label=3;case 3:return[3,5];case 4:qe=Ae,G.label=5;case 5:return qe&&(q=new F.Parser({format:"n3"}).parse(qe),Ue.import(Qe(q))),[2,Ue]}})})},W.addRdfXmlToStore=function(Ae,Ue){return A(this,void 0,void 0,function(){var qe,Fe,q,G;return z(this,function(pe){switch(pe.label){case 0:return"string"==typeof Ae&&(null==Ae?void 0:Ae.startsWith("http"))?[4,fetch(Ae,{redirect:"follow"})]:[3,4];case 1:return(Fe=pe.sent()).ok?[4,Fe.text()]:[3,3];case 2:qe=pe.sent(),pe.label=3;case 3:return[3,5];case 4:qe=Ae,pe.label=5;case 5:return qe?(q=new Q.RdfXmlParser({dataFactory:F.DataFactory,strict:!0}),G=new Promise(function(de){q.once("end",function(){return de(Ue)})}),Ue.import(q),q.write(qe),q.end(),[2,G]):[2,Ue]}})})},W.arrayToStream=Qe,W.deserializeN3Store=function(Ae,Ue){var qe=JSON.parse(Ae),Fe=new F.Store;return Object.assign(Fe,qe,{_factory:null!=Ue?Ue:F.DataFactory}),Fe},W.readQuads=function(Ae,Ue,qe,Fe,q){return Ae.readQuads(Ue,qe,Fe,q)},W.serializeN3Store=function(Ae){var Ue=Object.assign({},Ae);return delete Ue._factory,JSON.stringify(Ue)},W.streamToArray=function(Ae){return new Promise(function(Ue,qe){var Fe=[];Ae.on("data",function(q){Fe.push(q)}).once("end",function(){Ue(Fe)}).once("error",function(q){qe(q)})})},Object.keys(F).forEach(function(Ae){"default"!==Ae&&!W.hasOwnProperty(Ae)&&Object.defineProperty(W,Ae,{enumerable:!0,get:function(){return F[Ae]}})}),Object.defineProperty(W,"__esModule",{value:!0})},"object"==typeof he&&void 0!==xe?j(he,Y("jsonld"),Y("n3"),Y("rdfxml-streaming-parser"),Y("readable-stream")):j((W="undefined"!=typeof globalThis?globalThis:W||self).tripleStoreUtils={},W.jsonld,W.n3,W.rdfxmlStreamingParser,W.readablestream)},{jsonld:26,n3:43,"rdfxml-streaming-parser":64,"readable-stream":81}],2:[function(Y,xe,he){"use strict";he.byteLength=function(z){var N=C(z),ue=N[1];return 3*(N[0]+ue)/4-ue},he.toByteArray=function(z){var N,$,K=C(z),ue=K[0],I=K[1],O=new F(function(z,N,K){return 3*(N+K)/4-K}(0,ue,I)),X=0,E=I>0?ue-4:ue;for($=0;$<E;$+=4)N=j[z.charCodeAt($)]<<18|j[z.charCodeAt($+1)]<<12|j[z.charCodeAt($+2)]<<6|j[z.charCodeAt($+3)],O[X++]=N>>16&255,O[X++]=N>>8&255,O[X++]=255&N;return 2===I&&(N=j[z.charCodeAt($)]<<2|j[z.charCodeAt($+1)]>>4,O[X++]=255&N),1===I&&(N=j[z.charCodeAt($)]<<10|j[z.charCodeAt($+1)]<<4|j[z.charCodeAt($+2)]>>2,O[X++]=N>>8&255,O[X++]=255&N),O},he.fromByteArray=function(z){for(var N,K=z.length,ue=K%3,I=[],O=16383,X=0,E=K-ue;X<E;X+=O)I.push(x(z,X,X+O>E?E:X+O));return 1===ue?I.push(W[(N=z[K-1])>>2]+W[N<<4&63]+"=="):2===ue&&I.push(W[(N=(z[K-2]<<8)+z[K-1])>>10]+W[N>>4&63]+W[N<<2&63]+"="),I.join("")};for(var W=[],j=[],F="undefined"!=typeof Uint8Array?Uint8Array:Array,Q="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",H=0,b=Q.length;H<b;++H)W[H]=Q[H],j[Q.charCodeAt(H)]=H;function C(z){var N=z.length;if(N%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var K=z.indexOf("=");return-1===K&&(K=N),[K,K===N?0:4-K%4]}function y(z){return W[z>>18&63]+W[z>>12&63]+W[z>>6&63]+W[63&z]}function x(z,N,K){for(var I=[],O=N;O<K;O+=3)I.push(y((z[O]<<16&16711680)+(z[O+1]<<8&65280)+(255&z[O+2])));return I.join("")}j["-".charCodeAt(0)]=62,j["_".charCodeAt(0)]=63},{}],3:[function(Y,xe,he){},{}],4:[function(Y,xe,he){var W=Y("buffer"),j=W.Buffer;function F(H,b){for(var C in H)b[C]=H[C]}function Q(H,b,C){return j(H,b,C)}j.from&&j.alloc&&j.allocUnsafe&&j.allocUnsafeSlow?xe.exports=W:(F(W,he),he.Buffer=Q),F(j,Q),Q.from=function(H,b,C){if("number"==typeof H)throw new TypeError("Argument must not be a number");return j(H,b,C)},Q.alloc=function(H,b,C){if("number"!=typeof H)throw new TypeError("Argument must be a number");var R=j(H);return void 0!==b?"string"==typeof C?R.fill(b,C):R.fill(b):R.fill(0),R},Q.allocUnsafe=function(H){if("number"!=typeof H)throw new TypeError("Argument must be a number");return j(H)},Q.allocUnsafeSlow=function(H){if("number"!=typeof H)throw new TypeError("Argument must be a number");return W.SlowBuffer(H)}},{buffer:6}],5:[function(Y,xe,he){"use strict";var W=Y("safe-buffer").Buffer,j=W.isEncoding||function(I){switch((I=""+I)&&I.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function H(I){var O;switch(this.encoding=function(I){var O=function(I){if(!I)return"utf8";for(var O;;)switch(I){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return I;default:if(O)return;I=(""+I).toLowerCase(),O=!0}}(I);if("string"!=typeof O&&(W.isEncoding===j||!j(I)))throw new Error("Unknown encoding: "+I);return O||I}(I),this.encoding){case"utf16le":this.text=x,this.end=A,O=4;break;case"utf8":this.fillLast=T,O=4;break;case"base64":this.text=z,this.end=N,O=3;break;default:return this.write=K,void(this.end=ue)}this.lastNeed=0,this.lastTotal=0,this.lastChar=W.allocUnsafe(O)}function b(I){return I<=127?0:I>>5==6?2:I>>4==14?3:I>>3==30?4:I>>6==2?-1:-2}function T(I){var O=this.lastTotal-this.lastNeed,X=function(I,O,X){if(128!=(192&O[0]))return I.lastNeed=0,"\ufffd";if(I.lastNeed>1&&O.length>1){if(128!=(192&O[1]))return I.lastNeed=1,"\ufffd";if(I.lastNeed>2&&O.length>2&&128!=(192&O[2]))return I.lastNeed=2,"\ufffd"}}(this,I);return void 0!==X?X:this.lastNeed<=I.length?(I.copy(this.lastChar,O,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(I.copy(this.lastChar,O,0,I.length),void(this.lastNeed-=I.length))}function x(I,O){if((I.length-O)%2==0){var X=I.toString("utf16le",O);if(X){var E=X.charCodeAt(X.length-1);if(E>=55296&&E<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=I[I.length-2],this.lastChar[1]=I[I.length-1],X.slice(0,-1)}return X}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=I[I.length-1],I.toString("utf16le",O,I.length-1)}function A(I){var O=I&&I.length?this.write(I):"";return this.lastNeed?O+this.lastChar.toString("utf16le",0,this.lastTotal-this.lastNeed):O}function z(I,O){var X=(I.length-O)%3;return 0===X?I.toString("base64",O):(this.lastNeed=3-X,this.lastTotal=3,1===X?this.lastChar[0]=I[I.length-1]:(this.lastChar[0]=I[I.length-2],this.lastChar[1]=I[I.length-1]),I.toString("base64",O,I.length-X))}function N(I){var O=I&&I.length?this.write(I):"";return this.lastNeed?O+this.lastChar.toString("base64",0,3-this.lastNeed):O}function K(I){return I.toString(this.encoding)}function ue(I){return I&&I.length?this.write(I):""}he.StringDecoder=H,H.prototype.write=function(I){if(0===I.length)return"";var O,X;if(this.lastNeed){if(void 0===(O=this.fillLast(I)))return"";X=this.lastNeed,this.lastNeed=0}else X=0;return X<I.length?O?O+this.text(I,X):this.text(I,X):O||""},H.prototype.end=function(I){var O=I&&I.length?this.write(I):"";return this.lastNeed?O+"\ufffd":O},H.prototype.text=function(I,O){var X=function(I,O,X){var E=O.length-1;if(E<X)return 0;var $=b(O[E]);return $>=0?($>0&&(I.lastNeed=$-1),$):--E<X||-2===$?0:($=b(O[E]))>=0?($>0&&(I.lastNeed=$-2),$):--E<X||-2===$?0:($=b(O[E]))>=0?($>0&&(2===$?$=0:I.lastNeed=$-3),$):0}(this,I,O);if(!this.lastNeed)return I.toString("utf8",O);this.lastTotal=X;var E=I.length-(X-this.lastNeed);return I.copy(this.lastChar,0,E),I.toString("utf8",O,E)},H.prototype.fillLast=function(I){if(this.lastNeed<=I.length)return I.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);I.copy(this.lastChar,this.lastTotal-this.lastNeed,0,I.length),this.lastNeed-=I.length}},{"safe-buffer":4}],6:[function(Y,xe,he){(function(W){(function(){"use strict";var j=Y("base64-js"),F=Y("ieee754");he.Buffer=C,he.SlowBuffer=function(B){return+B!=B&&(B=0),C.alloc(+B)},he.INSPECT_MAX_BYTES=50;var Q=2147483647;function b(B){if(B>Q)throw new RangeError('The value "'+B+'" is invalid for option "size"');var P=new Uint8Array(B);return P.__proto__=C.prototype,P}function C(B,P,V){if("number"==typeof B){if("string"==typeof P)throw new TypeError('The "string" argument must be of type string. Received type number');return y(B)}return R(B,P,V)}function R(B,P,V){if("string"==typeof B)return function(B,P){if(("string"!=typeof P||""===P)&&(P="utf8"),!C.isEncoding(P))throw new TypeError("Unknown encoding: "+P);var V=0|I(B,P),Re=b(V),Ze=Re.write(B,P);return Ze!==V&&(Re=Re.slice(0,Ze)),Re}(B,P);if(ArrayBuffer.isView(B))return A(B);if(null==B)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof B);if(pt(B,ArrayBuffer)||B&&pt(B.buffer,ArrayBuffer))return function(B,P,V){if(P<0||B.byteLength<P)throw new RangeError('"offset" is outside of buffer bounds');if(B.byteLength<P+(V||0))throw new RangeError('"length" is outside of buffer bounds');var Re;return(Re=void 0===P&&void 0===V?new Uint8Array(B):void 0===V?new Uint8Array(B,P):new Uint8Array(B,P,V)).__proto__=C.prototype,Re}(B,P,V);if("number"==typeof B)throw new TypeError('The "value" argument must not be of type number. Received type number');var Re=B.valueOf&&B.valueOf();if(null!=Re&&Re!==B)return C.from(Re,P,V);var Ze=function(B){if(C.isBuffer(B)){var P=0|K(B.length),V=b(P);return 0===V.length||B.copy(V,0,0,P),V}return void 0!==B.length?"number"!=typeof B.length||we(B.length)?b(0):A(B):"Buffer"===B.type&&Array.isArray(B.data)?A(B.data):void 0}(B);if(Ze)return Ze;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof B[Symbol.toPrimitive])return C.from(B[Symbol.toPrimitive]("string"),P,V);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof B)}function T(B){if("number"!=typeof B)throw new TypeError('"size" argument must be of type number');if(B<0)throw new RangeError('The value "'+B+'" is invalid for option "size"')}function y(B){return T(B),b(B<0?0:0|K(B))}function A(B){for(var P=B.length<0?0:0|K(B.length),V=b(P),Re=0;Re<P;Re+=1)V[Re]=255&B[Re];return V}function K(B){if(B>=Q)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Q.toString(16)+" bytes");return 0|B}function I(B,P){if(C.isBuffer(B))return B.length;if(ArrayBuffer.isView(B)||pt(B,ArrayBuffer))return B.byteLength;if("string"!=typeof B)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof B);var V=B.length,Re=arguments.length>2&&!0===arguments[2];if(!Re&&0===V)return 0;for(var Ze=!1;;)switch(P){case"ascii":case"latin1":case"binary":return V;case"utf8":case"utf-8":return G(B).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*V;case"hex":return V>>>1;case"base64":return je(B).length;default:if(Ze)return Re?-1:G(B).length;P=(""+P).toLowerCase(),Ze=!0}}function O(B,P,V){var Re=!1;if((void 0===P||P<0)&&(P=0),P>this.length||((void 0===V||V>this.length)&&(V=this.length),V<=0)||(V>>>=0)<=(P>>>=0))return"";for(B||(B="utf8");;)switch(B){case"hex":return tt(this,P,V);case"utf8":case"utf-8":return ye(this,P,V);case"ascii":return st(this,P,V);case"latin1":case"binary":return Qe(this,P,V);case"base64":return ne(this,P,V);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ke(this,P,V);default:if(Re)throw new TypeError("Unknown encoding: "+B);B=(B+"").toLowerCase(),Re=!0}}function X(B,P,V){var Re=B[P];B[P]=B[V],B[V]=Re}function E(B,P,V,Re,Ze){if(0===B.length)return-1;if("string"==typeof V?(Re=V,V=0):V>2147483647?V=2147483647:V<-2147483648&&(V=-2147483648),we(V=+V)&&(V=Ze?0:B.length-1),V<0&&(V=B.length+V),V>=B.length){if(Ze)return-1;V=B.length-1}else if(V<0){if(!Ze)return-1;V=0}if("string"==typeof P&&(P=C.from(P,Re)),C.isBuffer(P))return 0===P.length?-1:$(B,P,V,Re,Ze);if("number"==typeof P)return P&=255,"function"==typeof Uint8Array.prototype.indexOf?Ze?Uint8Array.prototype.indexOf.call(B,P,V):Uint8Array.prototype.lastIndexOf.call(B,P,V):$(B,[P],V,Re,Ze);throw new TypeError("val must be string, number or Buffer")}function $(B,P,V,Re,Ze){var $n,St=1,Rt=B.length,Mn=P.length;if(void 0!==Re&&("ucs2"===(Re=String(Re).toLowerCase())||"ucs-2"===Re||"utf16le"===Re||"utf-16le"===Re)){if(B.length<2||P.length<2)return-1;St=2,Rt/=2,Mn/=2,V/=2}function Nn(Ps,ds){return 1===St?Ps[ds]:Ps.readUInt16BE(ds*St)}if(Ze){var bi=-1;for($n=V;$n<Rt;$n++)if(Nn(B,$n)===Nn(P,-1===bi?0:$n-bi)){if(-1===bi&&(bi=$n),$n-bi+1===Mn)return bi*St}else-1!==bi&&($n-=$n-bi),bi=-1}else for(V+Mn>Rt&&(V=Rt-Mn),$n=V;$n>=0;$n--){for(var fi=!0,Gr=0;Gr<Mn;Gr++)if(Nn(B,$n+Gr)!==Nn(P,Gr)){fi=!1;break}if(fi)return $n}return-1}function Z(B,P,V,Re){V=Number(V)||0;var Ze=B.length-V;Re?(Re=Number(Re))>Ze&&(Re=Ze):Re=Ze;var St=P.length;Re>St/2&&(Re=St/2);for(var Rt=0;Rt<Re;++Rt){var Mn=parseInt(P.substr(2*Rt,2),16);if(we(Mn))return Rt;B[V+Rt]=Mn}return Rt}function ae(B,P,V,Re){return _t(G(P,B.length-V),B,V,Re)}function oe(B,P,V,Re){return _t(function(B){for(var P=[],V=0;V<B.length;++V)P.push(255&B.charCodeAt(V));return P}(P),B,V,Re)}function te(B,P,V,Re){return oe(B,P,V,Re)}function Ce(B,P,V,Re){return _t(je(P),B,V,Re)}function me(B,P,V,Re){return _t(function(B,P){for(var V,Re,St=[],Rt=0;Rt<B.length&&!((P-=2)<0);++Rt)Re=(V=B.charCodeAt(Rt))>>8,St.push(V%256),St.push(Re);return St}(P,B.length-V),B,V,Re)}function ne(B,P,V){return j.fromByteArray(0===P&&V===B.length?B:B.slice(P,V))}function ye(B,P,V){V=Math.min(B.length,V);for(var Re=[],Ze=P;Ze<V;){var Nn,$n,bi,fi,St=B[Ze],Rt=null,Mn=St>239?4:St>223?3:St>191?2:1;if(Ze+Mn<=V)switch(Mn){case 1:St<128&&(Rt=St);break;case 2:128==(192&(Nn=B[Ze+1]))&&(fi=(31&St)<<6|63&Nn)>127&&(Rt=fi);break;case 3:$n=B[Ze+2],128==(192&(Nn=B[Ze+1]))&&128==(192&$n)&&(fi=(15&St)<<12|(63&Nn)<<6|63&$n)>2047&&(fi<55296||fi>57343)&&(Rt=fi);break;case 4:$n=B[Ze+2],bi=B[Ze+3],128==(192&(Nn=B[Ze+1]))&&128==(192&$n)&&128==(192&bi)&&(fi=(15&St)<<18|(63&Nn)<<12|(63&$n)<<6|63&bi)>65535&&fi<1114112&&(Rt=fi)}null===Rt?(Rt=65533,Mn=1):Rt>65535&&(Re.push((Rt-=65536)>>>10&1023|55296),Rt=56320|1023&Rt),Re.push(Rt),Ze+=Mn}return function(B){var P=B.length;if(P<=4096)return String.fromCharCode.apply(String,B);for(var V="",Re=0;Re<P;)V+=String.fromCharCode.apply(String,B.slice(Re,Re+=4096));return V}(Re)}he.kMaxLength=Q,!(C.TYPED_ARRAY_SUPPORT=function(){try{var B=new Uint8Array(1);return B.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===B.foo()}catch(P){return!1}}())&&"undefined"!=typeof console&&"function"==typeof console.error&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(C.prototype,"parent",{enumerable:!0,get:function(){if(C.isBuffer(this))return this.buffer}}),Object.defineProperty(C.prototype,"offset",{enumerable:!0,get:function(){if(C.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&C[Symbol.species]===C&&Object.defineProperty(C,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),C.poolSize=8192,C.from=function(B,P,V){return R(B,P,V)},C.prototype.__proto__=Uint8Array.prototype,C.__proto__=Uint8Array,C.alloc=function(B,P,V){return function(B,P,V){return T(B),B<=0?b(B):void 0!==P?"string"==typeof V?b(B).fill(P,V):b(B).fill(P):b(B)}(B,P,V)},C.allocUnsafe=function(B){return y(B)},C.allocUnsafeSlow=function(B){return y(B)},C.isBuffer=function(P){return null!=P&&!0===P._isBuffer&&P!==C.prototype},C.compare=function(P,V){if(pt(P,Uint8Array)&&(P=C.from(P,P.offset,P.byteLength)),pt(V,Uint8Array)&&(V=C.from(V,V.offset,V.byteLength)),!C.isBuffer(P)||!C.isBuffer(V))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(P===V)return 0;for(var Re=P.length,Ze=V.length,St=0,Rt=Math.min(Re,Ze);St<Rt;++St)if(P[St]!==V[St]){Re=P[St],Ze=V[St];break}return Re<Ze?-1:Ze<Re?1:0},C.isEncoding=function(P){switch(String(P).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},C.concat=function(P,V){if(!Array.isArray(P))throw new TypeError('"list" argument must be an Array of Buffers');if(0===P.length)return C.alloc(0);var Re;if(void 0===V)for(V=0,Re=0;Re<P.length;++Re)V+=P[Re].length;var Ze=C.allocUnsafe(V),St=0;for(Re=0;Re<P.length;++Re){var Rt=P[Re];if(pt(Rt,Uint8Array)&&(Rt=C.from(Rt)),!C.isBuffer(Rt))throw new TypeError('"list" argument must be an Array of Buffers');Rt.copy(Ze,St),St+=Rt.length}return Ze},C.byteLength=I,C.prototype._isBuffer=!0,C.prototype.swap16=function(){var P=this.length;if(P%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var V=0;V<P;V+=2)X(this,V,V+1);return this},C.prototype.swap32=function(){var P=this.length;if(P%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var V=0;V<P;V+=4)X(this,V,V+3),X(this,V+1,V+2);return this},C.prototype.swap64=function(){var P=this.length;if(P%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var V=0;V<P;V+=8)X(this,V,V+7),X(this,V+1,V+6),X(this,V+2,V+5),X(this,V+3,V+4);return this},C.prototype.toLocaleString=C.prototype.toString=function(){var P=this.length;return 0===P?"":0===arguments.length?ye(this,0,P):O.apply(this,arguments)},C.prototype.equals=function(P){if(!C.isBuffer(P))throw new TypeError("Argument must be a Buffer");return this===P||0===C.compare(this,P)},C.prototype.inspect=function(){var P="",V=he.INSPECT_MAX_BYTES;return P=this.toString("hex",0,V).replace(/(.{2})/g,"$1 ").trim(),this.length>V&&(P+=" ... "),"<Buffer "+P+">"},C.prototype.compare=function(P,V,Re,Ze,St){if(pt(P,Uint8Array)&&(P=C.from(P,P.offset,P.byteLength)),!C.isBuffer(P))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof P);if(void 0===V&&(V=0),void 0===Re&&(Re=P?P.length:0),void 0===Ze&&(Ze=0),void 0===St&&(St=this.length),V<0||Re>P.length||Ze<0||St>this.length)throw new RangeError("out of range index");if(Ze>=St&&V>=Re)return 0;if(Ze>=St)return-1;if(V>=Re)return 1;if(this===P)return 0;for(var Rt=(St>>>=0)-(Ze>>>=0),Mn=(Re>>>=0)-(V>>>=0),Nn=Math.min(Rt,Mn),$n=this.slice(Ze,St),bi=P.slice(V,Re),fi=0;fi<Nn;++fi)if($n[fi]!==bi[fi]){Rt=$n[fi],Mn=bi[fi];break}return Rt<Mn?-1:Mn<Rt?1:0},C.prototype.includes=function(P,V,Re){return-1!==this.indexOf(P,V,Re)},C.prototype.indexOf=function(P,V,Re){return E(this,P,V,Re,!0)},C.prototype.lastIndexOf=function(P,V,Re){return E(this,P,V,Re,!1)},C.prototype.write=function(P,V,Re,Ze){if(void 0===V)Ze="utf8",Re=this.length,V=0;else if(void 0===Re&&"string"==typeof V)Ze=V,Re=this.length,V=0;else{if(!isFinite(V))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");V>>>=0,isFinite(Re)?(Re>>>=0,void 0===Ze&&(Ze="utf8")):(Ze=Re,Re=void 0)}var St=this.length-V;if((void 0===Re||Re>St)&&(Re=St),P.length>0&&(Re<0||V<0)||V>this.length)throw new RangeError("Attempt to write outside buffer bounds");Ze||(Ze="utf8");for(var Rt=!1;;)switch(Ze){case"hex":return Z(this,P,V,Re);case"utf8":case"utf-8":return ae(this,P,V,Re);case"ascii":return oe(this,P,V,Re);case"latin1":case"binary":return te(this,P,V,Re);case"base64":return Ce(this,P,V,Re);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return me(this,P,V,Re);default:if(Rt)throw new TypeError("Unknown encoding: "+Ze);Ze=(""+Ze).toLowerCase(),Rt=!0}},C.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function st(B,P,V){var Re="";V=Math.min(B.length,V);for(var Ze=P;Ze<V;++Ze)Re+=String.fromCharCode(127&B[Ze]);return Re}function Qe(B,P,V){var Re="";V=Math.min(B.length,V);for(var Ze=P;Ze<V;++Ze)Re+=String.fromCharCode(B[Ze]);return Re}function tt(B,P,V){var Re=B.length;(!P||P<0)&&(P=0),(!V||V<0||V>Re)&&(V=Re);for(var Ze="",St=P;St<V;++St)Ze+=q(B[St]);return Ze}function Ke(B,P,V){for(var Re=B.slice(P,V),Ze="",St=0;St<Re.length;St+=2)Ze+=String.fromCharCode(Re[St]+256*Re[St+1]);return Ze}function ze(B,P,V){if(B%1!=0||B<0)throw new RangeError("offset is not uint");if(B+P>V)throw new RangeError("Trying to access beyond buffer length")}function ke(B,P,V,Re,Ze,St){if(!C.isBuffer(B))throw new TypeError('"buffer" argument must be a Buffer instance');if(P>Ze||P<St)throw new RangeError('"value" argument is out of bounds');if(V+Re>B.length)throw new RangeError("Index out of range")}function Xe(B,P,V,Re,Ze,St){if(V+Re>B.length)throw new RangeError("Index out of range");if(V<0)throw new RangeError("Index out of range")}function Ae(B,P,V,Re,Ze){return P=+P,V>>>=0,Ze||Xe(B,0,V,4),F.write(B,P,V,Re,23,4),V+4}function Ue(B,P,V,Re,Ze){return P=+P,V>>>=0,Ze||Xe(B,0,V,8),F.write(B,P,V,Re,52,8),V+8}C.prototype.slice=function(P,V){var Re=this.length;(P=~~P)<0?(P+=Re)<0&&(P=0):P>Re&&(P=Re),(V=void 0===V?Re:~~V)<0?(V+=Re)<0&&(V=0):V>Re&&(V=Re),V<P&&(V=P);var Ze=this.subarray(P,V);return Ze.__proto__=C.prototype,Ze},C.prototype.readUIntLE=function(P,V,Re){P>>>=0,V>>>=0,Re||ze(P,V,this.length);for(var Ze=this[P],St=1,Rt=0;++Rt<V&&(St*=256);)Ze+=this[P+Rt]*St;return Ze},C.prototype.readUIntBE=function(P,V,Re){P>>>=0,V>>>=0,Re||ze(P,V,this.length);for(var Ze=this[P+--V],St=1;V>0&&(St*=256);)Ze+=this[P+--V]*St;return Ze},C.prototype.readUInt8=function(P,V){return P>>>=0,V||ze(P,1,this.length),this[P]},C.prototype.readUInt16LE=function(P,V){return P>>>=0,V||ze(P,2,this.length),this[P]|this[P+1]<<8},C.prototype.readUInt16BE=function(P,V){return P>>>=0,V||ze(P,2,this.length),this[P]<<8|this[P+1]},C.prototype.readUInt32LE=function(P,V){return P>>>=0,V||ze(P,4,this.length),(this[P]|this[P+1]<<8|this[P+2]<<16)+16777216*this[P+3]},C.prototype.readUInt32BE=function(P,V){return P>>>=0,V||ze(P,4,this.length),16777216*this[P]+(this[P+1]<<16|this[P+2]<<8|this[P+3])},C.prototype.readIntLE=function(P,V,Re){P>>>=0,V>>>=0,Re||ze(P,V,this.length);for(var Ze=this[P],St=1,Rt=0;++Rt<V&&(St*=256);)Ze+=this[P+Rt]*St;return Ze>=(St*=128)&&(Ze-=Math.pow(2,8*V)),Ze},C.prototype.readIntBE=function(P,V,Re){P>>>=0,V>>>=0,Re||ze(P,V,this.length);for(var Ze=V,St=1,Rt=this[P+--Ze];Ze>0&&(St*=256);)Rt+=this[P+--Ze]*St;return Rt>=(St*=128)&&(Rt-=Math.pow(2,8*V)),Rt},C.prototype.readInt8=function(P,V){return P>>>=0,V||ze(P,1,this.length),128&this[P]?-1*(255-this[P]+1):this[P]},C.prototype.readInt16LE=function(P,V){P>>>=0,V||ze(P,2,this.length);var Re=this[P]|this[P+1]<<8;return 32768&Re?4294901760|Re:Re},C.prototype.readInt16BE=function(P,V){P>>>=0,V||ze(P,2,this.length);var Re=this[P+1]|this[P]<<8;return 32768&Re?4294901760|Re:Re},C.prototype.readInt32LE=function(P,V){return P>>>=0,V||ze(P,4,this.length),this[P]|this[P+1]<<8|this[P+2]<<16|this[P+3]<<24},C.prototype.readInt32BE=function(P,V){return P>>>=0,V||ze(P,4,this.length),this[P]<<24|this[P+1]<<16|this[P+2]<<8|this[P+3]},C.prototype.readFloatLE=function(P,V){return P>>>=0,V||ze(P,4,this.length),F.read(this,P,!0,23,4)},C.prototype.readFloatBE=function(P,V){return P>>>=0,V||ze(P,4,this.length),F.read(this,P,!1,23,4)},C.prototype.readDoubleLE=function(P,V){return P>>>=0,V||ze(P,8,this.length),F.read(this,P,!0,52,8)},C.prototype.readDoubleBE=function(P,V){return P>>>=0,V||ze(P,8,this.length),F.read(this,P,!1,52,8)},C.prototype.writeUIntLE=function(P,V,Re,Ze){P=+P,V>>>=0,Re>>>=0,Ze||ke(this,P,V,Re,Math.pow(2,8*Re)-1,0);var Rt=1,Mn=0;for(this[V]=255&P;++Mn<Re&&(Rt*=256);)this[V+Mn]=P/Rt&255;return V+Re},C.prototype.writeUIntBE=function(P,V,Re,Ze){P=+P,V>>>=0,Re>>>=0,Ze||ke(this,P,V,Re,Math.pow(2,8*Re)-1,0);var Rt=Re-1,Mn=1;for(this[V+Rt]=255&P;--Rt>=0&&(Mn*=256);)this[V+Rt]=P/Mn&255;return V+Re},C.prototype.writeUInt8=function(P,V,Re){return P=+P,V>>>=0,Re||ke(this,P,V,1,255,0),this[V]=255&P,V+1},C.prototype.writeUInt16LE=function(P,V,Re){return P=+P,V>>>=0,Re||ke(this,P,V,2,65535,0),this[V]=255&P,this[V+1]=P>>>8,V+2},C.prototype.writeUInt16BE=function(P,V,Re){return P=+P,V>>>=0,Re||ke(this,P,V,2,65535,0),this[V]=P>>>8,this[V+1]=255&P,V+2},C.prototype.writeUInt32LE=function(P,V,Re){return P=+P,V>>>=0,Re||ke(this,P,V,4,4294967295,0),this[V+3]=P>>>24,this[V+2]=P>>>16,this[V+1]=P>>>8,this[V]=255&P,V+4},C.prototype.writeUInt32BE=function(P,V,Re){return P=+P,V>>>=0,Re||ke(this,P,V,4,4294967295,0),this[V]=P>>>24,this[V+1]=P>>>16,this[V+2]=P>>>8,this[V+3]=255&P,V+4},C.prototype.writeIntLE=function(P,V,Re,Ze){if(P=+P,V>>>=0,!Ze){var St=Math.pow(2,8*Re-1);ke(this,P,V,Re,St-1,-St)}var Rt=0,Mn=1,Nn=0;for(this[V]=255&P;++Rt<Re&&(Mn*=256);)P<0&&0===Nn&&0!==this[V+Rt-1]&&(Nn=1),this[V+Rt]=(P/Mn>>0)-Nn&255;return V+Re},C.prototype.writeIntBE=function(P,V,Re,Ze){if(P=+P,V>>>=0,!Ze){var St=Math.pow(2,8*Re-1);ke(this,P,V,Re,St-1,-St)}var Rt=Re-1,Mn=1,Nn=0;for(this[V+Rt]=255&P;--Rt>=0&&(Mn*=256);)P<0&&0===Nn&&0!==this[V+Rt+1]&&(Nn=1),this[V+Rt]=(P/Mn>>0)-Nn&255;return V+Re},C.prototype.writeInt8=function(P,V,Re){return P=+P,V>>>=0,Re||ke(this,P,V,1,127,-128),P<0&&(P=255+P+1),this[V]=255&P,V+1},C.prototype.writeInt16LE=function(P,V,Re){return P=+P,V>>>=0,Re||ke(this,P,V,2,32767,-32768),this[V]=255&P,this[V+1]=P>>>8,V+2},C.prototype.writeInt16BE=function(P,V,Re){return P=+P,V>>>=0,Re||ke(this,P,V,2,32767,-32768),this[V]=P>>>8,this[V+1]=255&P,V+2},C.prototype.writeInt32LE=function(P,V,Re){return P=+P,V>>>=0,Re||ke(this,P,V,4,2147483647,-2147483648),this[V]=255&P,this[V+1]=P>>>8,this[V+2]=P>>>16,this[V+3]=P>>>24,V+4},C.prototype.writeInt32BE=function(P,V,Re){return P=+P,V>>>=0,Re||ke(this,P,V,4,2147483647,-2147483648),P<0&&(P=4294967295+P+1),this[V]=P>>>24,this[V+1]=P>>>16,this[V+2]=P>>>8,this[V+3]=255&P,V+4},C.prototype.writeFloatLE=function(P,V,Re){return Ae(this,P,V,!0,Re)},C.prototype.writeFloatBE=function(P,V,Re){return Ae(this,P,V,!1,Re)},C.prototype.writeDoubleLE=function(P,V,Re){return Ue(this,P,V,!0,Re)},C.prototype.writeDoubleBE=function(P,V,Re){return Ue(this,P,V,!1,Re)},C.prototype.copy=function(P,V,Re,Ze){if(!C.isBuffer(P))throw new TypeError("argument should be a Buffer");if(Re||(Re=0),!Ze&&0!==Ze&&(Ze=this.length),V>=P.length&&(V=P.length),V||(V=0),Ze>0&&Ze<Re&&(Ze=Re),Ze===Re||0===P.length||0===this.length)return 0;if(V<0)throw new RangeError("targetStart out of bounds");if(Re<0||Re>=this.length)throw new RangeError("Index out of range");if(Ze<0)throw new RangeError("sourceEnd out of bounds");Ze>this.length&&(Ze=this.length),P.length-V<Ze-Re&&(Ze=P.length-V+Re);var St=Ze-Re;if(this===P&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(V,Re,Ze);else if(this===P&&Re<V&&V<Ze)for(var Rt=St-1;Rt>=0;--Rt)P[Rt+V]=this[Rt+Re];else Uint8Array.prototype.set.call(P,this.subarray(Re,Ze),V);return St},C.prototype.fill=function(P,V,Re,Ze){if("string"==typeof P){if("string"==typeof V?(Ze=V,V=0,Re=this.length):"string"==typeof Re&&(Ze=Re,Re=this.length),void 0!==Ze&&"string"!=typeof Ze)throw new TypeError("encoding must be a string");if("string"==typeof Ze&&!C.isEncoding(Ze))throw new TypeError("Unknown encoding: "+Ze);if(1===P.length){var St=P.charCodeAt(0);("utf8"===Ze&&St<128||"latin1"===Ze)&&(P=St)}}else"number"==typeof P&&(P&=255);if(V<0||this.length<V||this.length<Re)throw new RangeError("Out of range index");if(Re<=V)return this;var Rt;if(V>>>=0,Re=void 0===Re?this.length:Re>>>0,P||(P=0),"number"==typeof P)for(Rt=V;Rt<Re;++Rt)this[Rt]=P;else{var Mn=C.isBuffer(P)?P:C.from(P,Ze),Nn=Mn.length;if(0===Nn)throw new TypeError('The value "'+P+'" is invalid for argument "value"');for(Rt=0;Rt<Re-V;++Rt)this[Rt+V]=Mn[Rt%Nn]}return this};var qe=/[^+/0-9A-Za-z-_]/g;function q(B){return B<16?"0"+B.toString(16):B.toString(16)}function G(B,P){P=P||1/0;for(var V,Re=B.length,Ze=null,St=[],Rt=0;Rt<Re;++Rt){if((V=B.charCodeAt(Rt))>55295&&V<57344){if(!Ze){if(V>56319){(P-=3)>-1&&St.push(239,191,189);continue}if(Rt+1===Re){(P-=3)>-1&&St.push(239,191,189);continue}Ze=V;continue}if(V<56320){(P-=3)>-1&&St.push(239,191,189),Ze=V;continue}V=65536+(Ze-55296<<10|V-56320)}else Ze&&(P-=3)>-1&&St.push(239,191,189);if(Ze=null,V<128){if((P-=1)<0)break;St.push(V)}else if(V<2048){if((P-=2)<0)break;St.push(V>>6|192,63&V|128)}else if(V<65536){if((P-=3)<0)break;St.push(V>>12|224,V>>6&63|128,63&V|128)}else{if(!(V<1114112))throw new Error("Invalid code point");if((P-=4)<0)break;St.push(V>>18|240,V>>12&63|128,V>>6&63|128,63&V|128)}}return St}function je(B){return j.toByteArray(function(B){if((B=(B=B.split("=")[0]).trim().replace(qe,"")).length<2)return"";for(;B.length%4!=0;)B+="=";return B}(B))}function _t(B,P,V,Re){for(var Ze=0;Ze<Re&&!(Ze+V>=P.length||Ze>=B.length);++Ze)P[Ze+V]=B[Ze];return Ze}function pt(B,P){return B instanceof P||null!=B&&null!=B.constructor&&null!=B.constructor.name&&B.constructor.name===P.name}function we(B){return B!=B}}).call(this)}).call(this,Y("buffer").Buffer)},{"base64-js":2,buffer:6,ieee754:9}],7:[function(Y,xe,he){"use strict";xe.exports=function W(j){return null===j||"object"!=typeof j||null!=j.toJSON?JSON.stringify(j):Array.isArray(j)?"["+j.reduce((F,Q,H)=>F+(0===H?"":",")+W(void 0===Q||"symbol"==typeof Q?null:Q),"")+"]":"{"+Object.keys(j).sort().reduce((F,Q,H)=>void 0===j[Q]||"symbol"==typeof j[Q]?F:F+(0===F.length?"":",")+W(Q)+":"+W(j[Q]),"")+"}"}},{}],8:[function(Y,xe,he){"use strict";var F,W="object"==typeof Reflect?Reflect:null,j=W&&"function"==typeof W.apply?W.apply:function($,Z,ae){return Function.prototype.apply.call($,Z,ae)};F=W&&"function"==typeof W.ownKeys?W.ownKeys:Object.getOwnPropertySymbols?function($){return Object.getOwnPropertyNames($).concat(Object.getOwnPropertySymbols($))}:function($){return Object.getOwnPropertyNames($)};var H=Number.isNaN||function($){return $!=$};function b(){b.init.call(this)}xe.exports=b,xe.exports.once=function(E,$){return new Promise(function(Z,ae){function oe(Ce){E.removeListener($,te),ae(Ce)}function te(){"function"==typeof E.removeListener&&E.removeListener("error",oe),Z([].slice.call(arguments))}X(E,$,te,{once:!0}),"error"!==$&&function(E,$,Z){"function"==typeof E.on&&X(E,"error",$,Z)}(E,oe,{once:!0})})},b.EventEmitter=b,b.prototype._events=void 0,b.prototype._eventsCount=0,b.prototype._maxListeners=void 0;var C=10;function R(E){if("function"!=typeof E)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof E)}function T(E){return void 0===E._maxListeners?b.defaultMaxListeners:E._maxListeners}function v(E,$,Z,ae){var oe,te,Ce;if(R(Z),void 0===(te=E._events)?(te=E._events=Object.create(null),E._eventsCount=0):(void 0!==te.newListener&&(E.emit("newListener",$,Z.listener?Z.listener:Z),te=E._events),Ce=te[$]),void 0===Ce)Ce=te[$]=Z,++E._eventsCount;else if("function"==typeof Ce?Ce=te[$]=ae?[Z,Ce]:[Ce,Z]:ae?Ce.unshift(Z):Ce.push(Z),(oe=T(E))>0&&Ce.length>oe&&!Ce.warned){Ce.warned=!0;var me=new Error("Possible EventEmitter memory leak detected. "+Ce.length+" "+String($)+" listeners added. Use emitter.setMaxListeners() to increase limit");me.name="MaxListenersExceededWarning",me.emitter=E,me.type=$,me.count=Ce.length,function(E){console&&console.warn&&console.warn(E)}(me)}return E}function y(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function x(E,$,Z){var ae={fired:!1,wrapFn:void 0,target:E,type:$,listener:Z},oe=y.bind(ae);return oe.listener=Z,ae.wrapFn=oe,oe}function A(E,$,Z){var ae=E._events;if(void 0===ae)return[];var oe=ae[$];return void 0===oe?[]:"function"==typeof oe?Z?[oe.listener||oe]:[oe]:Z?function(E){for(var $=new Array(E.length),Z=0;Z<$.length;++Z)$[Z]=E[Z].listener||E[Z];return $}(oe):N(oe,oe.length)}function z(E){var $=this._events;if(void 0!==$){var Z=$[E];if("function"==typeof Z)return 1;if(void 0!==Z)return Z.length}return 0}function N(E,$){for(var Z=new Array($),ae=0;ae<$;++ae)Z[ae]=E[ae];return Z}function X(E,$,Z,ae){if("function"==typeof E.on)ae.once?E.once($,Z):E.on($,Z);else{if("function"!=typeof E.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof E);E.addEventListener($,function oe(te){ae.once&&E.removeEventListener($,oe),Z(te)})}}Object.defineProperty(b,"defaultMaxListeners",{enumerable:!0,get:function(){return C},set:function(E){if("number"!=typeof E||E<0||H(E))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+E+".");C=E}}),b.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},b.prototype.setMaxListeners=function($){if("number"!=typeof $||$<0||H($))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+$+".");return this._maxListeners=$,this},b.prototype.getMaxListeners=function(){return T(this)},b.prototype.emit=function($){for(var Z=[],ae=1;ae<arguments.length;ae++)Z.push(arguments[ae]);var oe="error"===$,te=this._events;if(void 0!==te)oe=oe&&void 0===te.error;else if(!oe)return!1;if(oe){var Ce;if(Z.length>0&&(Ce=Z[0]),Ce instanceof Error)throw Ce;var me=new Error("Unhandled error."+(Ce?" ("+Ce.message+")":""));throw me.context=Ce,me}var ne=te[$];if(void 0===ne)return!1;if("function"==typeof ne)j(ne,this,Z);else{var ye=ne.length,Oe=N(ne,ye);for(ae=0;ae<ye;++ae)j(Oe[ae],this,Z)}return!0},b.prototype.on=b.prototype.addListener=function($,Z){return v(this,$,Z,!1)},b.prototype.prependListener=function($,Z){return v(this,$,Z,!0)},b.prototype.once=function($,Z){return R(Z),this.on($,x(this,$,Z)),this},b.prototype.prependOnceListener=function($,Z){return R(Z),this.prependListener($,x(this,$,Z)),this},b.prototype.off=b.prototype.removeListener=function($,Z){var ae,oe,te,Ce,me;if(R(Z),void 0===(oe=this._events))return this;if(void 0===(ae=oe[$]))return this;if(ae===Z||ae.listener===Z)0==--this._eventsCount?this._events=Object.create(null):(delete oe[$],oe.removeListener&&this.emit("removeListener",$,ae.listener||Z));else if("function"!=typeof ae){for(te=-1,Ce=ae.length-1;Ce>=0;Ce--)if(ae[Ce]===Z||ae[Ce].listener===Z){me=ae[Ce].listener,te=Ce;break}if(te<0)return this;0===te?ae.shift():function(E,$){for(;$+1<E.length;$++)E[$]=E[$+1];E.pop()}(ae,te),1===ae.length&&(oe[$]=ae[0]),void 0!==oe.removeListener&&this.emit("removeListener",$,me||Z)}return this},b.prototype.removeAllListeners=function($){var Z,ae,oe;if(void 0===(ae=this._events))return this;if(void 0===ae.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==ae[$]&&(0==--this._eventsCount?this._events=Object.create(null):delete ae[$]),this;if(0===arguments.length){var Ce,te=Object.keys(ae);for(oe=0;oe<te.length;++oe)"removeListener"!==(Ce=te[oe])&&this.removeAllListeners(Ce);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(Z=ae[$]))this.removeListener($,Z);else if(void 0!==Z)for(oe=Z.length-1;oe>=0;oe--)this.removeListener($,Z[oe]);return this},b.prototype.listeners=function($){return A(this,$,!0)},b.prototype.rawListeners=function($){return A(this,$,!1)},b.listenerCount=function(E,$){return"function"==typeof E.listenerCount?E.listenerCount($):z.call(E,$)},b.prototype.listenerCount=z,b.prototype.eventNames=function(){return this._eventsCount>0?F(this._events):[]}},{}],9:[function(Y,xe,he){he.read=function(W,j,F,Q,H){var b,C,R=8*H-Q-1,T=(1<<R)-1,v=T>>1,y=-7,x=F?H-1:0,A=F?-1:1,z=W[j+x];for(x+=A,b=z&(1<<-y)-1,z>>=-y,y+=R;y>0;b=256*b+W[j+x],x+=A,y-=8);for(C=b&(1<<-y)-1,b>>=-y,y+=Q;y>0;C=256*C+W[j+x],x+=A,y-=8);if(0===b)b=1-v;else{if(b===T)return C?NaN:1/0*(z?-1:1);C+=Math.pow(2,Q),b-=v}return(z?-1:1)*C*Math.pow(2,b-Q)},he.write=function(W,j,F,Q,H,b){var C,R,T,v=8*b-H-1,y=(1<<v)-1,x=y>>1,A=23===H?Math.pow(2,-24)-Math.pow(2,-77):0,z=Q?0:b-1,N=Q?1:-1,K=j<0||0===j&&1/j<0?1:0;for(j=Math.abs(j),isNaN(j)||j===1/0?(R=isNaN(j)?1:0,C=y):(C=Math.floor(Math.log(j)/Math.LN2),j*(T=Math.pow(2,-C))<1&&(C--,T*=2),(j+=C+x>=1?A/T:A*Math.pow(2,1-x))*T>=2&&(C++,T/=2),C+x>=y?(R=0,C=y):C+x>=1?(R=(j*T-1)*Math.pow(2,H),C+=x):(R=j*Math.pow(2,x-1)*Math.pow(2,H),C=0));H>=8;W[F+z]=255&R,z+=N,R/=256,H-=8);for(C=C<<H|R,v+=H;v>0;W[F+z]=255&C,z+=N,C/=256,v-=8);W[F+z-N]|=128*K}},{}],10:[function(Y,xe,he){xe.exports="function"==typeof Object.create?function(j,F){F&&(j.super_=F,j.prototype=Object.create(F.prototype,{constructor:{value:j,enumerable:!1,writable:!0,configurable:!0}}))}:function(j,F){if(F){j.super_=F;var Q=function(){};Q.prototype=F.prototype,j.prototype=new Q,j.prototype.constructor=j}}},{}],11:[function(Y,xe,he){"use strict";const{isArray:W,isObject:j,isString:F}=Y("./types"),{asArray:Q}=Y("./util"),{prependBase:H}=Y("./url"),b=Y("./JsonLdError"),C=Y("./ResolvedContext");function T(y){throw new b("Invalid JSON-LD syntax; @context must be an object.","jsonld.SyntaxError",{code:"invalid local context",context:y})}function v({context:y,base:x}){if(!y)return;const A=y["@context"];if(F(A))y["@context"]=H(x,A);else if(W(A))for(let z=0;z<A.length;++z){const N=A[z];F(N)?A[z]=H(x,N):j(N)&&v({context:{"@context":N},base:x})}else if(j(A))for(const z in A)v({context:A[z],base:x})}xe.exports=class{constructor({sharedCache:x}){this.perOpCache=new Map,this.sharedCache=x}resolve({activeCtx:x,context:A,documentLoader:z,base:N,cycles:K=new Set}){var ue=this;return yt(function*(){A&&j(A)&&A["@context"]&&(A=A["@context"]),A=Q(A);const I=[];for(const O of A){if(F(O)){let $=ue._get(O);$||($=yield ue._resolveRemoteContext({activeCtx:x,url:O,documentLoader:z,base:N,cycles:K})),W($)?I.push(...$):I.push($);continue}if(null===O){I.push(new C({document:null}));continue}j(O)||T(A);const X=JSON.stringify(O);let E=ue._get(X);E||(E=new C({document:O}),ue._cacheResolvedContext({key:X,resolved:E,tag:"static"})),I.push(E)}return I})()}_get(x){let A=this.perOpCache.get(x);if(!A){const z=this.sharedCache.get(x);z&&(A=z.get("static"),A&&this.perOpCache.set(x,A))}return A}_cacheResolvedContext({key:x,resolved:A,tag:z}){if(this.perOpCache.set(x,A),void 0!==z){let N=this.sharedCache.get(x);N||(N=new Map,this.sharedCache.set(x,N)),N.set(z,A)}return A}_resolveRemoteContext({activeCtx:x,url:A,documentLoader:z,base:N,cycles:K}){var ue=this;return yt(function*(){A=H(N,A);const{context:I,remoteDoc:O}=yield ue._fetchContext({activeCtx:x,url:A,documentLoader:z,cycles:K});v({context:I,base:N=O.documentUrl||A});const X=yield ue.resolve({activeCtx:x,context:I,documentLoader:z,base:N,cycles:K});return ue._cacheResolvedContext({key:A,resolved:X,tag:O.tag}),X})()}_fetchContext({activeCtx:x,url:A,documentLoader:z,cycles:N}){return yt(function*(){if(N.size>10)throw new b("Maximum number of @context URLs exceeded.","jsonld.ContextUrlError",{code:"json-ld-1.0"===x.processingMode?"loading remote context failed":"context overflow",max:10});if(N.has(A))throw new b("Cyclical @context URLs detected.","jsonld.ContextUrlError",{code:"json-ld-1.0"===x.processingMode?"recursive context inclusion":"context overflow",url:A});let K,ue;N.add(A);try{ue=yield z(A),K=ue.document||null,F(K)&&(K=JSON.parse(K))}catch(I){throw new b("Dereferencing a URL did not result in a valid JSON-LD object. Possible causes are an inaccessible URL perhaps due to a same-origin policy (ensure the server uses CORS if you are using client-side JavaScript), too many redirects, a non-JSON response, or more than one HTTP Link Header was provided for a remote context.","jsonld.InvalidUrl",{code:"loading remote context failed",url:A,cause:I})}if(!j(K))throw new b("Dereferencing a URL did not result in a JSON object. The response was valid JSON, but it was not a JSON object.","jsonld.InvalidUrl",{code:"invalid remote context",url:A});return K="@context"in K?{"@context":K["@context"]}:{"@context":{}},ue.contextUrl&&(W(K["@context"])||(K["@context"]=[K["@context"]]),K["@context"].push(ue.contextUrl)),{context:K,remoteDoc:ue}})()}}},{"./JsonLdError":12,"./ResolvedContext":16,"./types":30,"./url":31,"./util":32}],12:[function(Y,xe,he){"use strict";xe.exports=class extends Error{constructor(j="An unspecified JSON-LD error occurred.",F="jsonld.Error",Q={}){super(j),this.name=F,this.message=j,this.details=Q}}},{}],13:[function(Y,xe,he){"use strict";xe.exports=W=>{class j{toString(){return"[object JsonLdProcessor]"}}return Object.defineProperty(j,"prototype",{writable:!1,enumerable:!1}),Object.defineProperty(j.prototype,"constructor",{writable:!0,enumerable:!1,configurable:!0,value:j}),j.compact=function(F,Q){return arguments.length<2?Promise.reject(new TypeError("Could not compact, too few arguments.")):W.compact(F,Q)},j.expand=function(F){return arguments.length<1?Promise.reject(new TypeError("Could not expand, too few arguments.")):W.expand(F)},j.flatten=function(F){return arguments.length<1?Promise.reject(new TypeError("Could not flatten, too few arguments.")):W.flatten(F)},j}},{}],14:[function(Y,xe,he){"use strict";xe.exports=Y("rdf-canonize").NQuads},{"rdf-canonize":46}],15:[function(Y,xe,he){"use strict";xe.exports=class{constructor(){this._requests={}}wrapLoader(j){const F=this;return F._loader=j,function(){return F.add.apply(F,arguments)}}add(j){var F=this;return yt(function*(){let Q=F._requests[j];if(Q)return Promise.resolve(Q);Q=F._requests[j]=F._loader(j);try{return yield Q}finally{delete F._requests[j]}})()}}},{}],16:[function(Y,xe,he){"use strict";const W=Y("lru-cache");xe.exports=class{constructor({document:Q}){this.document=Q,this.cache=new W({max:10})}getProcessed(Q){return this.cache.get(Q)}setProcessed(Q,H){this.cache.set(Q,H)}}},{"lru-cache":33}],17:[function(Y,xe,he){"use strict";const W=Y("./JsonLdError"),{isArray:j,isObject:F,isString:Q,isUndefined:H}=Y("./types"),{isList:b,isValue:C,isGraph:R,isSimpleGraph:T,isSubjectReference:v}=Y("./graphTypes"),{expandIri:y,getContextValue:x,isKeyword:A,process:z,processingMode:N}=Y("./context"),{removeBase:K,prependBase:ue}=Y("./url"),{addValue:I,asArray:O,compareShortestLeast:X}=Y("./util"),E={};function Z(ae,oe,te){if("@nest"!==y(ae,oe,{vocab:!0},te))throw new W("JSON-LD compact error; nested property must have an @nest value resolving to @nest.","jsonld.SyntaxError",{code:"invalid @nest value"})}xe.exports=E,E.compact=function(){var ae=yt(function*({activeCtx:oe,activeProperty:te=null,element:Ce,options:me={},compactionMap:ne=(()=>{})}){if(j(Ce)){let Oe=[];for(let $e=0;$e<Ce.length;++$e){let st=yield E.compact({activeCtx:oe,activeProperty:te,element:Ce[$e],options:me,compactionMap:ne});null===st&&(st=yield ne({unmappedValue:Ce[$e],activeCtx:oe,activeProperty:te,parent:Ce,index:$e,options:me}),void 0===st)||Oe.push(st)}return me.compactArrays&&1===Oe.length&&0===(x(oe,te,"@container")||[]).length&&(Oe=Oe[0]),Oe}const ye=x(oe,te,"@context");if(H(ye)||(oe=yield z({activeCtx:oe,localCtx:ye,propagate:!0,overrideProtected:!0,options:me})),F(Ce)){if(me.link&&"@id"in Ce&&me.link.hasOwnProperty(Ce["@id"])){const ke=me.link[Ce["@id"]];for(let Xe=0;Xe<ke.length;++Xe)if(ke[Xe].expanded===Ce)return ke[Xe].compacted}if(C(Ce)||v(Ce)){const ke=E.compactValue({activeCtx:oe,activeProperty:te,value:Ce,options:me});return me.link&&v(Ce)&&(me.link.hasOwnProperty(Ce["@id"])||(me.link[Ce["@id"]]=[]),me.link[Ce["@id"]].push({expanded:Ce,compacted:ke})),ke}if(b(Ce)&&(x(oe,te,"@container")||[]).includes("@list"))return E.compact({activeCtx:oe,activeProperty:te,element:Ce["@list"],options:me,compactionMap:ne});const Oe="@reverse"===te,$e={},st=oe;!C(Ce)&&!v(Ce)&&(oe=oe.revertToPreviousContext());const Qe=x(st,te,"@context");H(Qe)||(oe=yield z({activeCtx:oe,localCtx:Qe,propagate:!0,overrideProtected:!0,options:me})),me.link&&"@id"in Ce&&(me.link.hasOwnProperty(Ce["@id"])||(me.link[Ce["@id"]]=[]),me.link[Ce["@id"]].push({expanded:Ce,compacted:$e}));let tt=Ce["@type"]||[];tt.length>1&&(tt=Array.from(tt).sort());const Ke=oe;for(const ke of tt){const Xe=E.compactIri({activeCtx:Ke,iri:ke,relativeTo:{vocab:!0}}),Ae=x(st,Xe,"@context");H(Ae)||(oe=yield z({activeCtx:oe,localCtx:Ae,options:me,propagate:!1}))}const ze=Object.keys(Ce).sort();for(const ke of ze){const Xe=Ce[ke];if("@id"!==ke)if("@type"!==ke)if("@reverse"!==ke)if("@preserve"!==ke)if("@index"!==ke)if("@graph"!==ke&&"@list"!==ke&&"@included"!==ke&&A(ke)){const Ae=E.compactIri({activeCtx:oe,iri:ke,relativeTo:{vocab:!0}});I($e,Ae,Xe)}else{if(!j(Xe))throw new W("JSON-LD expansion error; expanded value must be an array.","jsonld.SyntaxError");if(0===Xe.length){const Ae=E.compactIri({activeCtx:oe,iri:ke,value:Xe,relativeTo:{vocab:!0},reverse:Oe}),Ue=oe.mappings.has(Ae)?oe.mappings.get(Ae)["@nest"]:null;let qe=$e;Ue&&(Z(oe,Ue,me),F($e[Ue])||($e[Ue]={}),qe=$e[Ue]),I(qe,Ae,Xe,{propertyIsArray:!0})}for(const Ae of Xe){const Ue=E.compactIri({activeCtx:oe,iri:ke,value:Ae,relativeTo:{vocab:!0},reverse:Oe}),qe=oe.mappings.has(Ue)?oe.mappings.get(Ue)["@nest"]:null;let Fe=$e;qe&&(Z(oe,qe,me),F($e[qe])||($e[qe]={}),Fe=$e[qe]);const q=x(oe,Ue,"@container")||[],G=R(Ae),pe=b(Ae);let de;pe?de=Ae["@list"]:G&&(de=Ae["@graph"]);let je=yield E.compact({activeCtx:oe,activeProperty:Ue,element:pe||G?de:Ae,options:me,compactionMap:ne});if(pe){if(j(je)||(je=[je]),q.includes("@list")){I(Fe,Ue,je,{valueIsArray:!0,allowDuplicate:!0});continue}je={[E.compactIri({activeCtx:oe,iri:"@list",relativeTo:{vocab:!0}})]:je},"@index"in Ae&&(je[E.compactIri({activeCtx:oe,iri:"@index",relativeTo:{vocab:!0}})]=Ae["@index"])}if(G)if(q.includes("@graph")&&(q.includes("@id")||q.includes("@index")&&T(Ae))){let _t;Fe.hasOwnProperty(Ue)?_t=Fe[Ue]:Fe[Ue]=_t={};const pt=(q.includes("@id")?Ae["@id"]:Ae["@index"])||E.compactIri({activeCtx:oe,iri:"@none",relativeTo:{vocab:!0}});I(_t,pt,je,{propertyIsArray:!me.compactArrays||q.includes("@set")})}else q.includes("@graph")&&T(Ae)?(j(je)&&je.length>1&&(je={"@included":je}),I(Fe,Ue,je,{propertyIsArray:!me.compactArrays||q.includes("@set")})):(j(je)&&1===je.length&&me.compactArrays&&(je=je[0]),je={[E.compactIri({activeCtx:oe,iri:"@graph",relativeTo:{vocab:!0}})]:je},"@id"in Ae&&(je[E.compactIri({activeCtx:oe,iri:"@id",relativeTo:{vocab:!0}})]=Ae["@id"]),"@index"in Ae&&(je[E.compactIri({activeCtx:oe,iri:"@index",relativeTo:{vocab:!0}})]=Ae["@index"]),I(Fe,Ue,je,{propertyIsArray:!me.compactArrays||q.includes("@set")}));else if(q.includes("@language")||q.includes("@index")||q.includes("@id")||q.includes("@type")){let _t,pt;if(Fe.hasOwnProperty(Ue)?_t=Fe[Ue]:Fe[Ue]=_t={},q.includes("@language"))C(je)&&(je=je["@value"]),pt=Ae["@language"];else if(q.includes("@index")){const we=x(oe,Ue,"@index")||"@index",B=E.compactIri({activeCtx:oe,iri:we,relativeTo:{vocab:!0}});if("@index"===we)pt=Ae["@index"],delete je[B];else{let P;if([pt,...P]=O(je[we]||[]),Q(pt))switch(P.length){case 0:delete je[we];break;case 1:je[we]=P[0];break;default:je[we]=P}else pt=null}}else if(q.includes("@id")){const we=E.compactIri({activeCtx:oe,iri:"@id",relativeTo:{vocab:!0}});pt=je[we],delete je[we]}else if(q.includes("@type")){const we=E.compactIri({activeCtx:oe,iri:"@type",relativeTo:{vocab:!0}});let B;switch([pt,...B]=O(je[we]||[]),B.length){case 0:delete je[we];break;case 1:je[we]=B[0];break;default:je[we]=B}1===Object.keys(je).length&&"@id"in Ae&&(je=yield E.compact({activeCtx:oe,activeProperty:Ue,element:{"@id":Ae["@id"]},options:me,compactionMap:ne}))}pt||(pt=E.compactIri({activeCtx:oe,iri:"@none",relativeTo:{vocab:!0}})),I(_t,pt,je,{propertyIsArray:q.includes("@set")})}else{const _t=!me.compactArrays||q.includes("@set")||q.includes("@list")||j(je)&&0===je.length||"@list"===ke||"@graph"===ke;I(Fe,Ue,je,{propertyIsArray:_t})}}}else{if((x(oe,te,"@container")||[]).includes("@index"))continue;const Ue=E.compactIri({activeCtx:oe,iri:ke,relativeTo:{vocab:!0}});I($e,Ue,Xe)}else{const Ae=yield E.compact({activeCtx:oe,activeProperty:te,element:Xe,options:me,compactionMap:ne});j(Ae)&&0===Ae.length||I($e,ke,Ae)}else{const Ae=yield E.compact({activeCtx:oe,activeProperty:"@reverse",element:Xe,options:me,compactionMap:ne});for(const Ue in Ae)if(oe.mappings.has(Ue)&&oe.mappings.get(Ue).reverse){const qe=Ae[Ue],q=(x(oe,Ue,"@container")||[]).includes("@set")||!me.compactArrays;I($e,Ue,qe,{propertyIsArray:q}),delete Ae[Ue]}if(Object.keys(Ae).length>0){const Ue=E.compactIri({activeCtx:oe,iri:ke,relativeTo:{vocab:!0}});I($e,Ue,Ae)}}else{let Ae=O(Xe).map(G=>E.compactIri({activeCtx:st,iri:G,relativeTo:{vocab:!0}}));1===Ae.length&&(Ae=Ae[0]);const Ue=E.compactIri({activeCtx:oe,iri:"@type",relativeTo:{vocab:!0}}),q=(x(oe,Ue,"@container")||[]).includes("@set")&&N(oe,1.1)||j(Ae)&&0===Xe.length;I($e,Ue,Ae,{propertyIsArray:q})}else{let Ae=O(Xe).map(qe=>E.compactIri({activeCtx:oe,iri:qe,relativeTo:{vocab:!1},base:me.base}));1===Ae.length&&(Ae=Ae[0]),$e[E.compactIri({activeCtx:oe,iri:"@id",relativeTo:{vocab:!0}})]=Ae}}return $e}return Ce});return function(oe){return ae.apply(this,arguments)}}(),E.compactIri=({activeCtx:ae,iri:oe,value:te=null,relativeTo:Ce={vocab:!1},reverse:me=!1,base:ne=null})=>{if(null===oe)return oe;ae.isPropertyTermScoped&&ae.previousContext&&(ae=ae.previousContext);const ye=ae.getInverse();if(A(oe)&&oe in ye&&"@none"in ye[oe]&&"@type"in ye[oe]["@none"]&&"@none"in ye[oe]["@none"]["@type"])return ye[oe]["@none"]["@type"]["@none"];if(Ce.vocab&&oe in ye){const tt=ae["@language"]||"@none",Ke=[];F(te)&&"@index"in te&&!("@graph"in te)&&Ke.push("@index","@index@set"),F(te)&&"@preserve"in te&&(te=te["@preserve"][0]),R(te)?("@index"in te&&Ke.push("@graph@index","@graph@index@set","@index","@index@set"),"@id"in te&&Ke.push("@graph@id","@graph@id@set"),Ke.push("@graph","@graph@set","@set"),"@index"in te||Ke.push("@graph@index","@graph@index@set","@index","@index@set"),"@id"in te||Ke.push("@graph@id","@graph@id@set")):F(te)&&!C(te)&&Ke.push("@id","@id@set","@type","@set@type");let ze="@language",ke="@null";if(me)ze="@type",ke="@reverse",Ke.push("@set");else if(b(te)){"@index"in te||Ke.push("@list");const Ae=te["@list"];if(0===Ae.length)ze="@any",ke="@none";else{let Ue=0===Ae.length?tt:null,qe=null;for(let Fe=0;Fe<Ae.length;++Fe){const q=Ae[Fe];let G="@none",pe="@none";if(C(q)?"@direction"in q?G=`${(q["@language"]||"").toLowerCase()}_${q["@direction"]}`:"@language"in q?G=q["@language"].toLowerCase():"@type"in q?pe=q["@type"]:G="@null":pe="@id",null===Ue?Ue=G:G!==Ue&&C(q)&&(Ue="@none"),null===qe?qe=pe:pe!==qe&&(qe="@none"),"@none"===Ue&&"@none"===qe)break}Ue=Ue||"@none",qe=qe||"@none","@none"!==qe?(ze="@type",ke=qe):ke=Ue}}else{if(C(te))if("@language"in te&&!("@index"in te)){Ke.push("@language","@language@set"),ke=te["@language"];const Ae=te["@direction"];Ae&&(ke=`${ke}_${Ae}`)}else"@direction"in te&&!("@index"in te)?ke=`_${te["@direction"]}`:"@type"in te&&(ze="@type",ke=te["@type"]);else ze="@type",ke="@id";Ke.push("@set")}Ke.push("@none"),F(te)&&!("@index"in te)&&Ke.push("@index","@index@set"),C(te)&&1===Object.keys(te).length&&Ke.push("@language","@language@set");const Xe=function(ae,oe,te,Ce,me,ne){null===ne&&(ne="@null");const ye=[];if(("@id"===ne||"@reverse"===ne)&&F(te)&&"@id"in te){"@reverse"===ne&&ye.push("@reverse");const $e=E.compactIri({activeCtx:ae,iri:te["@id"],relativeTo:{vocab:!0}});ae.mappings.has($e)&&ae.mappings.get($e)&&ae.mappings.get($e)["@id"]===te["@id"]?ye.push.apply(ye,["@vocab","@id"]):ye.push.apply(ye,["@id","@vocab"])}else{ye.push(ne);const $e=ye.find(st=>st.includes("_"));$e&&ye.push($e.replace(/^[^_]+_/,"_"))}ye.push("@none");const Oe=ae.inverse[oe];for(const $e of Ce){if(!($e in Oe))continue;const st=Oe[$e][me];for(const Qe of ye)if(Qe in st)return st[Qe]}return null}(ae,oe,te,Ke,ze,ke);if(null!==Xe)return Xe}if(Ce.vocab&&"@vocab"in ae){const tt=ae["@vocab"];if(0===oe.indexOf(tt)&&oe!==tt){const Ke=oe.substr(tt.length);if(!ae.mappings.has(Ke))return Ke}}let Oe=null;const $e=[];let st=ae.fastCurieMap;const Qe=oe.length-1;for(let tt=0;tt<Qe&&oe[tt]in st;++tt)st=st[oe[tt]],""in st&&$e.push(st[""][0]);for(let tt=$e.length-1;tt>=0;--tt){const Ke=$e[tt],ze=Ke.terms;for(const ke of ze){const Xe=ke+":"+oe.substr(Ke.iri.length);ae.mappings.get(ke)._prefix&&(!ae.mappings.has(Xe)||null===te&&ae.mappings.get(Xe)["@id"]===oe)&&(null===Oe||X(Xe,Oe)<0)&&(Oe=Xe)}}if(null!==Oe)return Oe;for(const[tt,Ke]of ae.mappings)if(Ke&&Ke._prefix&&oe.startsWith(tt+":"))throw new W(`Absolute IRI "${oe}" confused with prefix "${tt}".`,"jsonld.SyntaxError",{code:"IRI confused with prefix",context:ae});return Ce.vocab?oe:"@base"in ae?ae["@base"]?K(ue(ne,ae["@base"]),oe):oe:K(ne,oe)},E.compactValue=({activeCtx:ae,activeProperty:oe,value:te,options:Ce})=>{if(C(te)){const Oe=x(ae,oe,"@type"),$e=x(ae,oe,"@language"),st=x(ae,oe,"@direction"),Qe=x(ae,oe,"@container")||[],tt="@index"in te&&!Qe.includes("@index");if(!tt&&"@none"!==Oe&&(te["@type"]===Oe||"@language"in te&&te["@language"]===$e&&"@direction"in te&&te["@direction"]===st||"@language"in te&&te["@language"]===$e||"@direction"in te&&te["@direction"]===st))return te["@value"];const Ke=Object.keys(te).length,ze=1===Ke||2===Ke&&"@index"in te&&!tt,ke="@language"in ae,Xe=Q(te["@value"]),Ae=ae.mappings.has(oe)&&null===ae.mappings.get(oe)["@language"];if(ze&&"@none"!==Oe&&(!ke||!Xe||Ae))return te["@value"];const Ue={};return tt&&(Ue[E.compactIri({activeCtx:ae,iri:"@index",relativeTo:{vocab:!0}})]=te["@index"]),"@type"in te?Ue[E.compactIri({activeCtx:ae,iri:"@type",relativeTo:{vocab:!0}})]=E.compactIri({activeCtx:ae,iri:te["@type"],relativeTo:{vocab:!0}}):"@language"in te&&(Ue[E.compactIri({activeCtx:ae,iri:"@language",relativeTo:{vocab:!0}})]=te["@language"]),"@direction"in te&&(Ue[E.compactIri({activeCtx:ae,iri:"@direction",relativeTo:{vocab:!0}})]=te["@direction"]),Ue[E.compactIri({activeCtx:ae,iri:"@value",relativeTo:{vocab:!0}})]=te["@value"],Ue}const me=y(ae,oe,{vocab:!0},Ce),ne=x(ae,oe,"@type"),ye=E.compactIri({activeCtx:ae,iri:te["@id"],relativeTo:{vocab:"@vocab"===ne},base:Ce.base});return"@id"===ne||"@vocab"===ne||"@graph"===me?ye:{[E.compactIri({activeCtx:ae,iri:"@id",relativeTo:{vocab:!0}})]:ye}}},{"./JsonLdError":12,"./context":19,"./graphTypes":25,"./types":30,"./url":31,"./util":32}],18:[function(Y,xe,he){"use strict";const W="http://www.w3.org/1999/02/22-rdf-syntax-ns#",j="http://www.w3.org/2001/XMLSchema#";xe.exports={LINK_HEADER_REL:"http://www.w3.org/ns/json-ld#context",LINK_HEADER_CONTEXT:"http://www.w3.org/ns/json-ld#context",RDF:W,RDF_LIST:W+"List",RDF_FIRST:W+"first",RDF_REST:W+"rest",RDF_NIL:W+"nil",RDF_TYPE:W+"type",RDF_PLAIN_LITERAL:W+"PlainLiteral",RDF_XML_LITERAL:W+"XMLLiteral",RDF_JSON_LITERAL:W+"JSON",RDF_OBJECT:W+"object",RDF_LANGSTRING:W+"langString",XSD:j,XSD_BOOLEAN:j+"boolean",XSD_DOUBLE:j+"double",XSD_INTEGER:j+"integer",XSD_STRING:j+"string"}},{}],19:[function(Y,xe,he){"use strict";const W=Y("./util"),j=Y("./JsonLdError"),{isArray:F,isObject:Q,isString:H,isUndefined:b}=Y("./types"),{isAbsolute:C,isRelative:R,prependBase:T}=Y("./url"),{asArray:v,compareShortestLeast:y}=Y("./util"),x=new Map,z=/^@[a-zA-Z]+$/,N={};function K(I,O,X,E,$,Z){if(null===O||!H(O)||N.isKeyword(O))return O;if(O.match(z))return null;if(E&&E.hasOwnProperty(O)&&!0!==$.get(O)&&N.createTermDefinition({activeCtx:I,localCtx:E,term:O,defined:$,options:Z}),(X=X||{}).vocab){const oe=I.mappings.get(O);if(null===oe)return null;if(Q(oe)&&"@id"in oe)return oe["@id"]}const ae=O.indexOf(":");if(ae>0){const oe=O.substr(0,ae),te=O.substr(ae+1);if("_"===oe||0===te.indexOf("//"))return O;E&&E.hasOwnProperty(oe)&&N.createTermDefinition({activeCtx:I,localCtx:E,term:oe,defined:$,options:Z});const Ce=I.mappings.get(oe);if(Ce&&Ce._prefix)return Ce["@id"]+te;if(C(O))return O}if(X.vocab&&"@vocab"in I)return I["@vocab"]+O;if(X.base&&"@base"in I){if(I["@base"])return T(T(Z.base,I["@base"]),O)}else if(X.base)return T(Z.base,O);return O}function ue(I,O){if(!I||"object"!=typeof I||!O||"object"!=typeof O)return I===O;const X=Array.isArray(I);if(X!==Array.isArray(O))return!1;if(X){if(I.length!==O.length)return!1;for(let Z=0;Z<I.length;++Z)if(!ue(I[Z],O[Z]))return!1;return!0}const E=Object.keys(I),$=Object.keys(O);if(E.length!==$.length)return!1;for(const Z in I){let ae=I[Z],oe=O[Z];if("@container"===Z&&Array.isArray(ae)&&Array.isArray(oe)&&(ae=ae.slice().sort(),oe=oe.slice().sort()),!ue(ae,oe))return!1}return!0}xe.exports=N,N.process=function(){var I=yt(function*({activeCtx:O,localCtx:X,options:E,propagate:$=!0,overrideProtected:Z=!1,cycles:ae=new Set}){if(Q(X)&&"@context"in X&&F(X["@context"])&&(X=X["@context"]),0===v(X).length)return O;const te=yield E.contextResolver.resolve({activeCtx:O,context:X,documentLoader:E.documentLoader,base:E.base});Q(te[0].document)&&"boolean"==typeof te[0].document["@propagate"]&&($=te[0].document["@propagate"]);let Ce=O;!$&&!Ce.previousContext&&(Ce=Ce.clone(),Ce.previousContext=O);for(const me of te){let{document:ne}=me;if(O=Ce,null===ne){if(!Z&&0!==Object.keys(O.protected).length){const $e=E&&E.protectedMode||"error";if("error"===$e)throw new j("Tried to nullify a context with protected terms outside of a term definition.","jsonld.SyntaxError",{code:"invalid context nullification"});if("warn"===$e){console.warn("WARNING: invalid context nullification");const st=me.getProcessed(O);if(st){Ce=O=st;continue}const Qe=O;Ce=O=N.getInitialContext(E).clone();for(const[tt,Ke]of Object.entries(Qe.protected))Ke&&(O.mappings[tt]=W.clone(Qe.mappings[tt]));O.protected=W.clone(Qe.protected),me.setProcessed(Qe,Ce);continue}throw new j("Invalid protectedMode.","jsonld.SyntaxError",{code:"invalid protected mode",context:X,protectedMode:$e})}Ce=O=N.getInitialContext(E).clone();continue}const ye=me.getProcessed(O);if(ye){Ce=O=ye;continue}if(Q(ne)&&"@context"in ne&&(ne=ne["@context"]),!Q(ne))throw new j("Invalid JSON-LD syntax; @context must be an object.","jsonld.SyntaxError",{code:"invalid local context",context:ne});Ce=Ce.clone();const Oe=new Map;if("@version"in ne){if(1.1!==ne["@version"])throw new j("Unsupported JSON-LD version: "+ne["@version"],"jsonld.UnsupportedVersion",{code:"invalid @version value",context:ne});if(O.processingMode&&"json-ld-1.0"===O.processingMode)throw new j("@version: "+ne["@version"]+" not compatible with "+O.processingMode,"jsonld.ProcessingModeConflict",{code:"processing mode conflict",context:ne});Ce.processingMode="json-ld-1.1",Ce["@version"]=ne["@version"],Oe.set("@version",!0)}if(Ce.processingMode=Ce.processingMode||O.processingMode,"@base"in ne){let $e=ne["@base"];if(null!==$e&&!C($e)){if(!R($e))throw new j('Invalid JSON-LD syntax; the value of "@base" in a @context must be an absolute IRI, a relative IRI, or null.',"jsonld.SyntaxError",{code:"invalid base IRI",context:ne});$e=T(Ce["@base"],$e)}Ce["@base"]=$e,Oe.set("@base",!0)}if("@vocab"in ne){const $e=ne["@vocab"];if(null===$e)delete Ce["@vocab"];else{if(!H($e))throw new j('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:ne});if(!C($e)&&N.processingMode(Ce,1))throw new j('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be an absolute IRI.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:ne});Ce["@vocab"]=K(Ce,$e,{vocab:!0,base:!0},void 0,void 0,E)}Oe.set("@vocab",!0)}if("@language"in ne){const $e=ne["@language"];if(null===$e)delete Ce["@language"];else{if(!H($e))throw new j('Invalid JSON-LD syntax; the value of "@language" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid default language",context:ne});Ce["@language"]=$e.toLowerCase()}Oe.set("@language",!0)}if("@direction"in ne){const $e=ne["@direction"];if("json-ld-1.0"===O.processingMode)throw new j("Invalid JSON-LD syntax; @direction not compatible with "+O.processingMode,"jsonld.SyntaxError",{code:"invalid context member",context:ne});if(null===$e)delete Ce["@direction"];else{if("ltr"!==$e&&"rtl"!==$e)throw new j('Invalid JSON-LD syntax; the value of "@direction" in a @context must be null, "ltr", or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",context:ne});Ce["@direction"]=$e}Oe.set("@direction",!0)}if("@propagate"in ne){const $e=ne["@propagate"];if("json-ld-1.0"===O.processingMode)throw new j("Invalid JSON-LD syntax; @propagate not compatible with "+O.processingMode,"jsonld.SyntaxError",{code:"invalid context entry",context:ne});if("boolean"!=typeof $e)throw new j("Invalid JSON-LD syntax; @propagate value must be a boolean.","jsonld.SyntaxError",{code:"invalid @propagate value",context:X});Oe.set("@propagate",!0)}if("@import"in ne){const $e=ne["@import"];if("json-ld-1.0"===O.processingMode)throw new j("Invalid JSON-LD syntax; @import not compatible with "+O.processingMode,"jsonld.SyntaxError",{code:"invalid context entry",context:ne});if(!H($e))throw new j("Invalid JSON-LD syntax; @import must be a string.","jsonld.SyntaxError",{code:"invalid @import value",context:X});const st=yield E.contextResolver.resolve({activeCtx:O,context:$e,documentLoader:E.documentLoader,base:E.base});if(1!==st.length)throw new j("Invalid JSON-LD syntax; @import must reference a single context.","jsonld.SyntaxError",{code:"invalid remote context",context:X});const Qe=st[0].getProcessed(O);if(Qe)ne=Qe;else{const tt=st[0].document;if("@import"in tt)throw new j("Invalid JSON-LD syntax: imported context must not include @import.","jsonld.SyntaxError",{code:"invalid context entry",context:X});for(const Ke in tt)ne.hasOwnProperty(Ke)||(ne[Ke]=tt[Ke]);st[0].setProcessed(O,ne)}Oe.set("@import",!0)}Oe.set("@protected",ne["@protected"]||!1);for(const $e in ne)if(N.createTermDefinition({activeCtx:Ce,localCtx:ne,term:$e,defined:Oe,options:E,overrideProtected:Z}),Q(ne[$e])&&"@context"in ne[$e]){const st=ne[$e]["@context"];let Qe=!0;if(H(st)){const tt=T(E.base,st);ae.has(tt)?Qe=!1:ae.add(tt)}if(Qe)try{yield N.process({activeCtx:Ce.clone(),localCtx:ne[$e]["@context"],overrideProtected:!0,options:E,cycles:ae})}catch(tt){throw new j("Invalid JSON-LD syntax; invalid scoped context.","jsonld.SyntaxError",{code:"invalid scoped context",context:ne[$e]["@context"],term:$e})}}me.setProcessed(O,Ce)}return Ce});return function(O){return I.apply(this,arguments)}}(),N.createTermDefinition=({activeCtx:I,localCtx:O,term:X,defined:E,options:$,overrideProtected:Z=!1})=>{if(E.has(X)){if(E.get(X))return;throw new j("Cyclical context definition detected.","jsonld.CyclicalContext",{code:"cyclic IRI mapping",context:O,term:X})}let ae;if(E.set(X,!1),O.hasOwnProperty(X)&&(ae=O[X]),"@type"===X&&Q(ae)&&"@set"===(ae["@container"]||"@set")&&N.processingMode(I,1.1)){const Oe=["@container","@id","@protected"],$e=Object.keys(ae);if(0===$e.length||$e.some(st=>!Oe.includes(st)))throw new j("Invalid JSON-LD syntax; keywords cannot be overridden.","jsonld.SyntaxError",{code:"keyword redefinition",context:O,term:X})}else{if(N.isKeyword(X))throw new j("Invalid JSON-LD syntax; keywords cannot be overridden.","jsonld.SyntaxError",{code:"keyword redefinition",context:O,term:X});if(X.match(z))return void console.warn('WARNING: terms beginning with "@" are reserved for future use and ignored',{term:X});if(""===X)throw new j("Invalid JSON-LD syntax; a term cannot be an empty string.","jsonld.SyntaxError",{code:"invalid term definition",context:O})}const oe=I.mappings.get(X);I.mappings.has(X)&&I.mappings.delete(X);let te=!1;if((H(ae)||null===ae)&&(te=!0,ae={"@id":ae}),!Q(ae))throw new j("Invalid JSON-LD syntax; @context term values must be strings or objects.","jsonld.SyntaxError",{code:"invalid term definition",context:O});const Ce={};I.mappings.set(X,Ce),Ce.reverse=!1;const me=["@container","@id","@language","@reverse","@type"];N.processingMode(I,1.1)&&me.push("@context","@direction","@index","@nest","@prefix","@protected");for(const Oe in ae)if(!me.includes(Oe))throw new j("Invalid JSON-LD syntax; a term definition must not contain "+Oe,"jsonld.SyntaxError",{code:"invalid term definition",context:O});const ne=X.indexOf(":");if(Ce._termHasColon=ne>0,"@reverse"in ae){if("@id"in ae)throw new j("Invalid JSON-LD syntax; a @reverse term definition must not contain @id.","jsonld.SyntaxError",{code:"invalid reverse property",context:O});if("@nest"in ae)throw new j("Invalid JSON-LD syntax; a @reverse term definition must not contain @nest.","jsonld.SyntaxError",{code:"invalid reverse property",context:O});const Oe=ae["@reverse"];if(!H(Oe))throw new j("Invalid JSON-LD syntax; a @context @reverse value must be a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:O});if(!N.isKeyword(Oe)&&Oe.match(z))return console.warn('WARNING: values beginning with "@" are reserved for future use and ignored',{reverse:Oe}),void(oe?I.mappings.set(X,oe):I.mappings.delete(X));const $e=K(I,Oe,{vocab:!0,base:!1},O,E,$);if(!C($e))throw new j("Invalid JSON-LD syntax; a @context @reverse value must be an absolute IRI or a blank node identifier.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:O});Ce["@id"]=$e,Ce.reverse=!0}else if("@id"in ae){let Oe=ae["@id"];if(Oe&&!H(Oe))throw new j("Invalid JSON-LD syntax; a @context @id value must be an array of strings or a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:O});if(null===Oe)Ce["@id"]=null;else{if(!N.isKeyword(Oe)&&Oe.match(z))return console.warn('WARNING: values beginning with "@" are reserved for future use and ignored',{id:Oe}),void(oe?I.mappings.set(X,oe):I.mappings.delete(X));if(Oe!==X){if(Oe=K(I,Oe,{vocab:!0,base:!1},O,E,$),!C(Oe)&&!N.isKeyword(Oe))throw new j("Invalid JSON-LD syntax; a @context @id value must be an absolute IRI, a blank node identifier, or a keyword.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:O});if(X.match(/(?::[^:])|\//)&&K(I,X,{vocab:!0,base:!1},O,new Map(E).set(X,!0),$)!==Oe)throw new j("Invalid JSON-LD syntax; term in form of IRI must expand to definition.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:O});Ce["@id"]=Oe,Ce._prefix=te&&!Ce._termHasColon&&Oe.match(/[:\/\?#\[\]@]$/)}}}if(!("@id"in Ce))if(Ce._termHasColon){const Oe=X.substr(0,ne);if(O.hasOwnProperty(Oe)&&N.createTermDefinition({activeCtx:I,localCtx:O,term:Oe,defined:E,options:$}),I.mappings.has(Oe)){const $e=X.substr(ne+1);Ce["@id"]=I.mappings.get(Oe)["@id"]+$e}else Ce["@id"]=X}else if("@type"===X)Ce["@id"]=X;else{if(!("@vocab"in I))throw new j("Invalid JSON-LD syntax; @context terms must define an @id.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:O,term:X});Ce["@id"]=I["@vocab"]+X}if((!0===ae["@protected"]||!0===E.get("@protected")&&!1!==ae["@protected"])&&(I.protected[X]=!0,Ce.protected=!0),E.set(X,!0),"@type"in ae){let Oe=ae["@type"];if(!H(Oe))throw new j("Invalid JSON-LD syntax; an @context @type value must be a string.","jsonld.SyntaxError",{code:"invalid type mapping",context:O});if("@json"===Oe||"@none"===Oe){if(N.processingMode(I,1))throw new j(`Invalid JSON-LD syntax; an @context @type value must not be "${Oe}" in JSON-LD 1.0 mode.`,"jsonld.SyntaxError",{code:"invalid type mapping",context:O})}else if("@id"!==Oe&&"@vocab"!==Oe){if(Oe=K(I,Oe,{vocab:!0,base:!1},O,E,$),!C(Oe))throw new j("Invalid JSON-LD syntax; an @context @type value must be an absolute IRI.","jsonld.SyntaxError",{code:"invalid type mapping",context:O});if(0===Oe.indexOf("_:"))throw new j("Invalid JSON-LD syntax; an @context @type value must be an IRI, not a blank node identifier.","jsonld.SyntaxError",{code:"invalid type mapping",context:O})}Ce["@type"]=Oe}if("@container"in ae){const Oe=H(ae["@container"])?[ae["@container"]]:ae["@container"]||[],$e=["@list","@set","@index","@language"];let st=!0;const Qe=Oe.includes("@set");if(N.processingMode(I,1.1)){if($e.push("@graph","@id","@type"),Oe.includes("@list")){if(1!==Oe.length)throw new j("Invalid JSON-LD syntax; @context @container with @list must have no other values","jsonld.SyntaxError",{code:"invalid container mapping",context:O})}else if(Oe.includes("@graph")){if(Oe.some(tt=>"@graph"!==tt&&"@id"!==tt&&"@index"!==tt&&"@set"!==tt))throw new j("Invalid JSON-LD syntax; @context @container with @graph must have no other values other than @id, @index, and @set","jsonld.SyntaxError",{code:"invalid container mapping",context:O})}else st&=Oe.length<=(Qe?2:1);if(Oe.includes("@type")&&(Ce["@type"]=Ce["@type"]||"@id",!["@id","@vocab"].includes(Ce["@type"])))throw new j("Invalid JSON-LD syntax; container: @type requires @type to be @id or @vocab.","jsonld.SyntaxError",{code:"invalid type mapping",context:O})}else st&=!F(ae["@container"]),st&=Oe.length<=1;if(st&=Oe.every(tt=>$e.includes(tt)),st&=!(Qe&&Oe.includes("@list")),!st)throw new j("Invalid JSON-LD syntax; @context @container value must be one of the following: "+$e.join(", "),"jsonld.SyntaxError",{code:"invalid container mapping",context:O});if(Ce.reverse&&!Oe.every(tt=>["@index","@set"].includes(tt)))throw new j("Invalid JSON-LD syntax; @context @container value for a @reverse type definition must be @index or @set.","jsonld.SyntaxError",{code:"invalid reverse property",context:O});Ce["@container"]=Oe}if("@index"in ae){if(!("@container"in ae)||!Ce["@container"].includes("@index"))throw new j(`Invalid JSON-LD syntax; @index without @index in @container: "${ae["@index"]}" on term "${X}".`,"jsonld.SyntaxError",{code:"invalid term definition",context:O});if(!H(ae["@index"])||0===ae["@index"].indexOf("@"))throw new j(`Invalid JSON-LD syntax; @index must expand to an IRI: "${ae["@index"]}" on term "${X}".`,"jsonld.SyntaxError",{code:"invalid term definition",context:O});Ce["@index"]=ae["@index"]}if("@context"in ae&&(Ce["@context"]=ae["@context"]),"@language"in ae&&!("@type"in ae)){let Oe=ae["@language"];if(null!==Oe&&!H(Oe))throw new j("Invalid JSON-LD syntax; @context @language value must be a string or null.","jsonld.SyntaxError",{code:"invalid language mapping",context:O});null!==Oe&&(Oe=Oe.toLowerCase()),Ce["@language"]=Oe}if("@prefix"in ae){if(X.match(/:|\//))throw new j("Invalid JSON-LD syntax; @context @prefix used on a compact IRI term","jsonld.SyntaxError",{code:"invalid term definition",context:O});if(N.isKeyword(Ce["@id"]))throw new j("Invalid JSON-LD syntax; keywords may not be used as prefixes","jsonld.SyntaxError",{code:"invalid term definition",context:O});if("boolean"!=typeof ae["@prefix"])throw new j("Invalid JSON-LD syntax; @context value for @prefix must be boolean","jsonld.SyntaxError",{code:"invalid @prefix value",context:O});Ce._prefix=!0===ae["@prefix"]}if("@direction"in ae){const Oe=ae["@direction"];if(null!==Oe&&"ltr"!==Oe&&"rtl"!==Oe)throw new j('Invalid JSON-LD syntax; @direction value must be null, "ltr", or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",context:O});Ce["@direction"]=Oe}if("@nest"in ae){const Oe=ae["@nest"];if(!H(Oe)||"@nest"!==Oe&&0===Oe.indexOf("@"))throw new j("Invalid JSON-LD syntax; @context @nest value must be a string which is not a keyword other than @nest.","jsonld.SyntaxError",{code:"invalid @nest value",context:O});Ce["@nest"]=Oe}const ye=Ce["@id"];if("@context"===ye||"@preserve"===ye)throw new j("Invalid JSON-LD syntax; @context and @preserve cannot be aliased.","jsonld.SyntaxError",{code:"invalid keyword alias",context:O});if(oe&&oe.protected&&!Z&&(I.protected[X]=!0,Ce.protected=!0,!ue(oe,Ce))){const Oe=$&&$.protectedMode||"error";if("error"===Oe)throw new j(`Invalid JSON-LD syntax; tried to redefine "${X}" which is a protected term.`,"jsonld.SyntaxError",{code:"protected term redefinition",context:O,term:X});if("warn"===Oe)return void console.warn("WARNING: protected term redefinition",{term:X});throw new j("Invalid protectedMode.","jsonld.SyntaxError",{code:"invalid protected mode",context:O,term:X,protectedMode:Oe})}},N.expandIri=(I,O,X,E)=>K(I,O,X,void 0,void 0,E),N.getInitialContext=I=>{const O=JSON.stringify({processingMode:I.processingMode}),X=x.get(O);if(X)return X;const E={processingMode:I.processingMode,mappings:new Map,inverse:null,getInverse:function(){const Ce=this;if(Ce.inverse)return Ce.inverse;const me=Ce.inverse={},ne=Ce.fastCurieMap={},ye={},Oe=(Ce["@language"]||"@none").toLowerCase(),$e=Ce["@direction"],st=Ce.mappings,Qe=[...st.keys()].sort(y);for(const tt of Qe){const Ke=st.get(tt);if(null===Ke)continue;let ze=Ke["@container"]||"@none";if(ze=[].concat(ze).sort().join(""),null===Ke["@id"])continue;const ke=v(Ke["@id"]);for(const Xe of ke){let Ae=me[Xe];const Ue=N.isKeyword(Xe);if(Ae)!Ue&&!Ke._termHasColon&&ye[Xe].push(tt);else if(me[Xe]=Ae={},!Ue&&!Ke._termHasColon){ye[Xe]=[tt];const qe={iri:Xe,terms:ye[Xe]};Xe[0]in ne?ne[Xe[0]].push(qe):ne[Xe[0]]=[qe]}if(Ae[ze]||(Ae[ze]={"@language":{},"@type":{},"@any":{}}),Ae=Ae[ze],ae(tt,Ae["@any"],"@none"),Ke.reverse)ae(tt,Ae["@type"],"@reverse");else if("@none"===Ke["@type"])ae(tt,Ae["@any"],"@none"),ae(tt,Ae["@language"],"@none"),ae(tt,Ae["@type"],"@none");else if("@type"in Ke)ae(tt,Ae["@type"],Ke["@type"]);else if("@language"in Ke&&"@direction"in Ke){const qe=Ke["@language"],Fe=Ke["@direction"];ae(tt,Ae["@language"],qe&&Fe?`${qe}_${Fe}`.toLowerCase():qe?qe.toLowerCase():Fe?`_${Fe}`:"@null")}else"@language"in Ke?ae(tt,Ae["@language"],(Ke["@language"]||"@null").toLowerCase()):"@direction"in Ke?ae(tt,Ae["@language"],Ke["@direction"]?`_${Ke["@direction"]}`:"@none"):$e?(ae(tt,Ae["@language"],`_${$e}`),ae(tt,Ae["@language"],"@none"),ae(tt,Ae["@type"],"@none")):(ae(tt,Ae["@language"],Oe),ae(tt,Ae["@language"],"@none"),ae(tt,Ae["@type"],"@none"))}}for(const tt in ne)Z(ne,tt,1);return me},clone:function(){const Ce={};return Ce.mappings=W.clone(this.mappings),Ce.clone=this.clone,Ce.inverse=null,Ce.getInverse=this.getInverse,Ce.protected=W.clone(this.protected),this.previousContext&&(Ce.previousContext=this.previousContext.clone()),Ce.revertToPreviousContext=this.revertToPreviousContext,"@base"in this&&(Ce["@base"]=this["@base"]),"@language"in this&&(Ce["@language"]=this["@language"]),"@vocab"in this&&(Ce["@vocab"]=this["@vocab"]),Ce},revertToPreviousContext:function(){return this.previousContext?this.previousContext.clone():this},protected:{}};return 1e4===x.size&&x.clear(),x.set(O,E),E;function Z(Ce,me,ne){const ye=Ce[me],Oe=Ce[me]={};let $e,st;for(const Qe of ye)$e=Qe.iri,st=ne>=$e.length?"":$e[ne],st in Oe?Oe[st].push(Qe):Oe[st]=[Qe];for(const Qe in Oe)""!==Qe&&Z(Oe,Qe,ne+1)}function ae(Ce,me,ne){me.hasOwnProperty(ne)||(me[ne]=Ce)}},N.getContextValue=(I,O,X)=>{if(null===O)return"@context"===X?void 0:null;if(I.mappings.has(O)){const E=I.mappings.get(O);if(b(X))return E;if(E.hasOwnProperty(X))return E[X]}return"@language"===X&&X in I||"@direction"===X&&X in I?I[X]:"@context"!==X?null:void 0},N.processingMode=(I,O)=>O.toString()>="1.1"?!I.processingMode||I.processingMode>="json-ld-"+O.toString():"json-ld-1.0"===I.processingMode,N.isKeyword=I=>{if(!H(I)||"@"!==I[0])return!1;switch(I){case"@base":case"@container":case"@context":case"@default":case"@direction":case"@embed":case"@explicit":case"@graph":case"@id":case"@included":case"@index":case"@json":case"@language":case"@list":case"@nest":case"@none":case"@omitDefault":case"@prefix":case"@preserve":case"@protected":case"@requireAll":case"@reverse":case"@set":case"@type":case"@value":case"@version":case"@vocab":return!0}return!1}},{"./JsonLdError":12,"./types":30,"./url":31,"./util":32}],20:[function(Y,xe,he){"use strict";const{parseLinkHeader:W,buildHeaders:j}=Y("../util"),{LINK_HEADER_CONTEXT:F}=Y("../constants"),Q=Y("../JsonLdError"),H=Y("../RequestQueue"),{prependBase:b}=Y("../url"),C=/(^|(\r\n))link:/i;function R(T,v,y){const x=new(T=T||XMLHttpRequest);return new Promise((A,z)=>{x.onload=()=>A(x),x.onerror=N=>z(N),x.open("GET",v,!0);for(const N in y)x.setRequestHeader(N,y[N]);x.send()})}xe.exports=({secure:T,headers:v={},xhr:y}={headers:{}})=>{return v=j(v),(new H).wrapLoader(A);function A(N){return z.apply(this,arguments)}function z(){return(z=yt(function*(N){if(0!==N.indexOf("http:")&&0!==N.indexOf("https:"))throw new Q('URL could not be dereferenced; only "http" and "https" URLs are supported.',"jsonld.InvalidUrl",{code:"loading document failed",url:N});if(T&&0!==N.indexOf("https"))throw new Q('URL could not be dereferenced; secure mode is enabled and the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:N});let K;try{K=yield R(y,N,v)}catch(E){throw new Q("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:N,cause:E})}if(K.status>=400)throw new Q("URL could not be dereferenced: "+K.statusText,"jsonld.LoadDocumentError",{code:"loading document failed",url:N,httpStatusCode:K.status});let ue={contextUrl:null,documentUrl:N,document:K.response},I=null;const O=K.getResponseHeader("Content-Type");let X;if(C.test(K.getAllResponseHeaders())&&(X=K.getResponseHeader("Link")),X&&"application/ld+json"!==O){const E=W(X),$=E[F];if(Array.isArray($))throw new Q("URL could not be dereferenced, it has more than one associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:N});$&&(ue.contextUrl=$.target),I=E.alternate,I&&"application/ld+json"==I.type&&!(O||"").match(/^application\/(\w*\+)?json$/)&&(ue=yield A(b(N,I.target)))}return ue})).apply(this,arguments)}}},{"../JsonLdError":12,"../RequestQueue":15,"../constants":18,"../url":31,"../util":32}],21:[function(Y,xe,he){"use strict";const W=Y("./JsonLdError"),{isArray:j,isObject:F,isEmptyObject:Q,isString:H,isUndefined:b}=Y("./types"),{isList:C,isValue:R,isGraph:T,isSubject:v}=Y("./graphTypes"),{expandIri:y,getContextValue:x,isKeyword:A,process:z,processingMode:N}=Y("./context"),{isAbsolute:K}=Y("./url"),{addValue:ue,asArray:I,getValues:O,validateTypeValue:X}=Y("./util"),E={};xe.exports=E;const $=/^[a-zA-Z]{1,8}(-[a-zA-Z0-9]{1,8})*$/;function Z(ne){return ae.apply(this,arguments)}function ae(){return(ae=yt(function*({activeCtx:ne,activeProperty:ye,expandedActiveProperty:Oe,element:$e,expandedParent:st,options:Qe={},insideList:tt,typeKey:Ke,typeScopedContext:ze,expansionMap:ke}){const Xe=Object.keys($e).sort(),Ae=[];let Ue;const qe=$e[Ke]&&"@json"===y(ne,j($e[Ke])?$e[Ke][0]:$e[Ke],{vocab:!0},Qe);for(const Fe of Xe){let G,q=$e[Fe];if("@context"===Fe)continue;let pe=y(ne,Fe,{vocab:!0},Qe);if((null===pe||!K(pe)&&!A(pe))&&(pe=ke({unmappedProperty:Fe,activeCtx:ne,activeProperty:ye,parent:$e,options:Qe,insideList:tt,value:q,expandedParent:st}),void 0===pe))continue;if(A(pe)){if("@reverse"===Oe)throw new W("Invalid JSON-LD syntax; a keyword cannot be used as a @reverse property.","jsonld.SyntaxError",{code:"invalid reverse property map",value:q});if(pe in st&&"@included"!==pe&&"@type"!==pe)throw new W("Invalid JSON-LD syntax; colliding keywords detected.","jsonld.SyntaxError",{code:"colliding keywords",keyword:pe})}if("@id"===pe){if(!H(q)){if(!Qe.isFrame)throw new W('Invalid JSON-LD syntax; "@id" value must a string.',"jsonld.SyntaxError",{code:"invalid @id value",value:q});if(F(q)){if(!Q(q))throw new W('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:q})}else{if(!j(q))throw new W('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:q});if(!q.every(pt=>H(pt)))throw new W('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:q})}}ue(st,"@id",I(q).map(pt=>H(pt)?y(ne,pt,{base:!0},Qe):pt),{propertyIsArray:Qe.isFrame});continue}if("@type"===pe){F(q)&&(q=Object.fromEntries(Object.entries(q).map(([pt,we])=>[y(ze,pt,{vocab:!0}),I(we).map(B=>y(ze,B,{base:!0,vocab:!0}))]))),X(q,Qe.isFrame),ue(st,"@type",I(q).map(pt=>H(pt)?y(ze,pt,{base:!0,vocab:!0},Qe):pt),{propertyIsArray:Qe.isFrame});continue}if("@included"===pe&&N(ne,1.1)){const pt=I(yield E.expand({activeCtx:ne,activeProperty:ye,element:q,options:Qe,expansionMap:ke}));if(!pt.every(we=>v(we)))throw new W("Invalid JSON-LD syntax; values of @included must expand to node objects.","jsonld.SyntaxError",{code:"invalid @included value",value:q});ue(st,"@included",pt,{propertyIsArray:!0});continue}if("@graph"===pe&&!F(q)&&!j(q))throw new W('Invalid JSON-LD syntax; "@graph" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid @graph value",value:q});if("@value"===pe){Ue=q,qe&&N(ne,1.1)?st["@value"]=q:ue(st,"@value",q,{propertyIsArray:Qe.isFrame});continue}if("@language"===pe){if(null===q)continue;if(!H(q)&&!Qe.isFrame)throw new W('Invalid JSON-LD syntax; "@language" value must be a string.',"jsonld.SyntaxError",{code:"invalid language-tagged string",value:q});q=I(q).map(pt=>H(pt)?pt.toLowerCase():pt);for(const pt of q)H(pt)&&!pt.match($)&&console.warn(`@language must be valid BCP47: ${pt}`);ue(st,"@language",q,{propertyIsArray:Qe.isFrame});continue}if("@direction"===pe){if(!H(q)&&!Qe.isFrame)throw new W('Invalid JSON-LD syntax; "@direction" value must be a string.',"jsonld.SyntaxError",{code:"invalid base direction",value:q});q=I(q);for(const pt of q)if(H(pt)&&"ltr"!==pt&&"rtl"!==pt)throw new W('Invalid JSON-LD syntax; "@direction" must be "ltr" or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",value:q});ue(st,"@direction",q,{propertyIsArray:Qe.isFrame});continue}if("@index"===pe){if(!H(q))throw new W('Invalid JSON-LD syntax; "@index" value must be a string.',"jsonld.SyntaxError",{code:"invalid @index value",value:q});ue(st,"@index",q);continue}if("@reverse"===pe){if(!F(q))throw new W('Invalid JSON-LD syntax; "@reverse" value must be an object.',"jsonld.SyntaxError",{code:"invalid @reverse value",value:q});if(G=yield E.expand({activeCtx:ne,activeProperty:"@reverse",element:q,options:Qe,expansionMap:ke}),"@reverse"in G)for(const we in G["@reverse"])ue(st,we,G["@reverse"][we],{propertyIsArray:!0});let pt=st["@reverse"]||null;for(const we in G){if("@reverse"===we)continue;null===pt&&(pt=st["@reverse"]={}),ue(pt,we,[],{propertyIsArray:!0});const B=G[we];for(let P=0;P<B.length;++P){const V=B[P];if(R(V)||C(V))throw new W('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:G});ue(pt,we,V,{propertyIsArray:!0})}}continue}if("@nest"===pe){Ae.push(Fe);continue}let de=ne;const je=x(ne,Fe,"@context");b(je)||(de=yield z({activeCtx:ne,localCtx:je,propagate:!0,overrideProtected:!0,options:Qe}));const _t=x(de,Fe,"@container")||[];if(_t.includes("@language")&&F(q))G=te(de,q,x(de,Fe,"@direction"),Qe);else if(_t.includes("@index")&&F(q)){const pt=_t.includes("@graph"),we=x(de,Fe,"@index")||"@index",B="@index"!==we&&y(ne,we,{vocab:!0},Qe);G=yield Ce({activeCtx:de,options:Qe,activeProperty:Fe,value:q,expansionMap:ke,asGraph:pt,indexKey:we,propertyIndex:B})}else if(_t.includes("@id")&&F(q)){const pt=_t.includes("@graph");G=yield Ce({activeCtx:de,options:Qe,activeProperty:Fe,value:q,expansionMap:ke,asGraph:pt,indexKey:"@id"})}else if(_t.includes("@type")&&F(q))G=yield Ce({activeCtx:de.revertToPreviousContext(),options:Qe,activeProperty:Fe,value:q,expansionMap:ke,asGraph:!1,indexKey:"@type"});else{const pt="@list"===pe;if(pt||"@set"===pe){let we=ye;pt&&"@graph"===Oe&&(we=null),G=yield E.expand({activeCtx:de,activeProperty:we,element:q,options:Qe,insideList:pt,expansionMap:ke})}else G="@json"===x(ne,Fe,"@type")?{"@type":"@json","@value":q}:yield E.expand({activeCtx:de,activeProperty:Fe,element:q,options:Qe,insideList:!1,expansionMap:ke})}if(null!==G||"@value"===pe||(G=ke({unmappedValue:q,expandedProperty:pe,activeCtx:de,activeProperty:ye,parent:$e,options:Qe,insideList:tt,key:Fe,expandedParent:st}),void 0!==G)){if("@list"!==pe&&!C(G)&&_t.includes("@list")&&(G={"@list":I(G)}),_t.includes("@graph")&&!_t.some(pt=>"@id"===pt||"@index"===pt)&&(G=I(G).map(pt=>({"@graph":I(pt)}))),de.mappings.has(Fe)&&de.mappings.get(Fe).reverse){const pt=st["@reverse"]=st["@reverse"]||{};G=I(G);for(let we=0;we<G.length;++we){const B=G[we];if(R(B)||C(B))throw new W('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:G});ue(pt,pe,B,{propertyIsArray:!0})}continue}ue(st,pe,G,{propertyIsArray:!0})}}if("@value"in st&&("@json"!==st["@type"]||!N(ne,1.1))&&(F(Ue)||j(Ue))&&!Qe.isFrame)throw new W('Invalid JSON-LD syntax; "@value" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid value object value",value:Ue});for(const Fe of Ae){const q=j($e[Fe])?$e[Fe]:[$e[Fe]];for(const G of q){if(!F(G)||Object.keys(G).some(pe=>"@value"===y(ne,pe,{vocab:!0},Qe)))throw new W("Invalid JSON-LD syntax; nested value must be a node object.","jsonld.SyntaxError",{code:"invalid @nest value",value:G});yield Z({activeCtx:ne,activeProperty:ye,expandedActiveProperty:Oe,element:G,expandedParent:st,options:Qe,insideList:tt,typeScopedContext:ze,typeKey:Ke,expansionMap:ke})}}})).apply(this,arguments)}function oe({activeCtx:ne,activeProperty:ye,value:Oe,options:$e}){if(null==Oe)return null;const st=y(ne,ye,{vocab:!0},$e);if("@id"===st)return y(ne,Oe,{base:!0},$e);if("@type"===st)return y(ne,Oe,{vocab:!0,base:!0},$e);const Qe=x(ne,ye,"@type");if(("@id"===Qe||"@graph"===st)&&H(Oe))return{"@id":y(ne,Oe,{base:!0},$e)};if("@vocab"===Qe&&H(Oe))return{"@id":y(ne,Oe,{vocab:!0,base:!0},$e)};if(A(st))return Oe;const tt={};if(Qe&&!["@id","@vocab","@none"].includes(Qe))tt["@type"]=Qe;else if(H(Oe)){const Ke=x(ne,ye,"@language");null!==Ke&&(tt["@language"]=Ke);const ze=x(ne,ye,"@direction");null!==ze&&(tt["@direction"]=ze)}return["boolean","number","string"].includes(typeof Oe)||(Oe=Oe.toString()),tt["@value"]=Oe,tt}function te(ne,ye,Oe,$e){const st=[],Qe=Object.keys(ye).sort();for(const tt of Qe){const Ke=y(ne,tt,{vocab:!0},$e);let ze=ye[tt];j(ze)||(ze=[ze]);for(const ke of ze){if(null===ke)continue;if(!H(ke))throw new W("Invalid JSON-LD syntax; language map values must be strings.","jsonld.SyntaxError",{code:"invalid language map value",languageMap:ye});const Xe={"@value":ke};"@none"!==Ke&&(Xe["@language"]=tt.toLowerCase()),Oe&&(Xe["@direction"]=Oe),st.push(Xe)}}return st}function Ce(ne){return me.apply(this,arguments)}function me(){return(me=yt(function*({activeCtx:ne,options:ye,activeProperty:Oe,value:$e,expansionMap:st,asGraph:Qe,indexKey:tt,propertyIndex:Ke}){const ze=[],ke=Object.keys($e).sort(),Xe="@type"===tt;for(let Ae of ke){if(Xe){const Fe=x(ne,Ae,"@context");b(Fe)||(ne=yield z({activeCtx:ne,localCtx:Fe,propagate:!1,options:ye}))}let qe,Ue=$e[Ae];j(Ue)||(Ue=[Ue]),Ue=yield E.expand({activeCtx:ne,activeProperty:Oe,element:Ue,options:ye,insideList:!1,insideIndex:!0,expansionMap:st}),qe=Ke?"@none"===Ae?"@none":oe({activeCtx:ne,activeProperty:tt,value:Ae,options:ye}):y(ne,Ae,{vocab:!0},ye),"@id"===tt?Ae=y(ne,Ae,{base:!0},ye):Xe&&(Ae=qe);for(let Fe of Ue){if(Qe&&!T(Fe)&&(Fe={"@graph":[Fe]}),"@type"===tt)"@none"===qe||(Fe["@type"]=Fe["@type"]?[Ae].concat(Fe["@type"]):[Ae]);else{if(R(Fe)&&!["@language","@type","@index"].includes(tt))throw new W(`Invalid JSON-LD syntax; Attempt to add illegal key to value object: "${tt}".`,"jsonld.SyntaxError",{code:"invalid value object",value:Fe});Ke?"@none"!==qe&&ue(Fe,Ke,qe,{propertyIsArray:!0,prependValue:!0}):"@none"!==qe&&!(tt in Fe)&&(Fe[tt]=Ae)}ze.push(Fe)}}return ze})).apply(this,arguments)}E.expand=function(){var ne=yt(function*({activeCtx:ye,activeProperty:Oe=null,element:$e,options:st={},insideList:Qe=!1,insideIndex:tt=!1,typeScopedContext:Ke=null,expansionMap:ze=(()=>{})}){if(null==$e)return null;if("@default"===Oe&&(st=Object.assign({},st,{isFrame:!1})),!j($e)&&!F($e)){if(!Qe&&(null===Oe||"@graph"===y(ye,Oe,{vocab:!0},st))){const G=yield ze({unmappedValue:$e,activeCtx:ye,activeProperty:Oe,options:st,insideList:Qe});return void 0===G?null:G}return oe({activeCtx:ye,activeProperty:Oe,value:$e,options:st})}if(j($e)){let G=[];const pe=x(ye,Oe,"@container")||[];Qe=Qe||pe.includes("@list");for(let de=0;de<$e.length;++de){let je=yield E.expand({activeCtx:ye,activeProperty:Oe,element:$e[de],options:st,expansionMap:ze,insideIndex:tt,typeScopedContext:Ke});Qe&&j(je)&&(je={"@list":je}),(null!==je||(je=yield ze({unmappedValue:$e[de],activeCtx:ye,activeProperty:Oe,parent:$e,index:de,options:st,expandedParent:G,insideList:Qe}),void 0!==je))&&(j(je)?G=G.concat(je):G.push(je))}return G}const ke=y(ye,Oe,{vocab:!0},st),Xe=x(ye,Oe,"@context");Ke=Ke||(ye.previousContext?ye:null);let Ae=Object.keys($e).sort(),Ue=!tt;if(Ue&&Ke&&Ae.length<=2&&!Ae.includes("@context"))for(const G of Ae){const pe=y(Ke,G,{vocab:!0},st);if("@value"===pe){Ue=!1,ye=Ke;break}if("@id"===pe&&1===Ae.length){Ue=!1;break}}Ue&&(ye=ye.revertToPreviousContext()),b(Xe)||(ye=yield z({activeCtx:ye,localCtx:Xe,propagate:!0,overrideProtected:!0,options:st})),"@context"in $e&&(ye=yield z({activeCtx:ye,localCtx:$e["@context"],options:st})),Ke=ye;let qe=null;for(const G of Ae)if("@type"===y(ye,G,{vocab:!0},st)){qe=qe||G;const de=$e[G],je=Array.isArray(de)?de.length>1?de.slice().sort():de:[de];for(const _t of je){const pt=x(Ke,_t,"@context");b(pt)||(ye=yield z({activeCtx:ye,localCtx:pt,options:st,propagate:!1}))}}let Fe={};yield Z({activeCtx:ye,activeProperty:Oe,expandedActiveProperty:ke,element:$e,expandedParent:Fe,options:st,insideList:Qe,typeKey:qe,typeScopedContext:Ke,expansionMap:ze}),Ae=Object.keys(Fe);let q=Ae.length;if("@value"in Fe){if("@type"in Fe&&("@language"in Fe||"@direction"in Fe))throw new W('Invalid JSON-LD syntax; an element containing "@value" may not contain both "@type" and either "@language" or "@direction".',"jsonld.SyntaxError",{code:"invalid value object",element:Fe});let G=q-1;if("@type"in Fe&&(G-=1),"@index"in Fe&&(G-=1),"@language"in Fe&&(G-=1),"@direction"in Fe&&(G-=1),0!==G)throw new W('Invalid JSON-LD syntax; an element containing "@value" may only have an "@index" property and either "@type" or either or both "@language" or "@direction".',"jsonld.SyntaxError",{code:"invalid value object",element:Fe});const pe=null===Fe["@value"]?[]:I(Fe["@value"]),de=O(Fe,"@type");if(!N(ye,1.1)||!de.includes("@json")||1!==de.length)if(0===pe.length){const je=yield ze({unmappedValue:Fe,activeCtx:ye,activeProperty:Oe,element:$e,options:st,insideList:Qe});Fe=void 0!==je?je:null}else{if(!pe.every(je=>H(je)||Q(je))&&"@language"in Fe)throw new W("Invalid JSON-LD syntax; only strings may be language-tagged.","jsonld.SyntaxError",{code:"invalid language-tagged value",element:Fe});if(!de.every(je=>K(je)&&!(H(je)&&0===je.indexOf("_:"))||Q(je)))throw new W('Invalid JSON-LD syntax; an element containing "@value" and "@type" must have an absolute IRI for the value of "@type".',"jsonld.SyntaxError",{code:"invalid typed value",element:Fe})}}else if("@type"in Fe&&!j(Fe["@type"]))Fe["@type"]=[Fe["@type"]];else if("@set"in Fe||"@list"in Fe){if(q>1&&(2!==q||!("@index"in Fe)))throw new W('Invalid JSON-LD syntax; if an element has the property "@set" or "@list", then it can have at most one other property that is "@index".',"jsonld.SyntaxError",{code:"invalid set or list object",element:Fe});"@set"in Fe&&(Fe=Fe["@set"],Ae=Object.keys(Fe),q=Ae.length)}else if(1===q&&"@language"in Fe){const G=yield ze(Fe,{unmappedValue:Fe,activeCtx:ye,activeProperty:Oe,element:$e,options:st,insideList:Qe});Fe=void 0!==G?G:null}if(F(Fe)&&!st.keepFreeFloatingNodes&&!Qe&&(null===Oe||"@graph"===ke)&&(0===q||"@value"in Fe||"@list"in Fe||1===q&&"@id"in Fe)){const G=yield ze({unmappedValue:Fe,activeCtx:ye,activeProperty:Oe,element:$e,options:st,insideList:Qe});Fe=void 0!==G?G:null}return Fe});return function(ye){return ne.apply(this,arguments)}}()},{"./JsonLdError":12,"./context":19,"./graphTypes":25,"./types":30,"./url":31,"./util":32}],22:[function(Y,xe,he){"use strict";const{isSubjectReference:W}=Y("./graphTypes"),{createMergedNodeMap:j}=Y("./nodeMap"),F={};xe.exports=F,F.flatten=Q=>{const H=j(Q),b=[],C=Object.keys(H).sort();for(let R=0;R<C.length;++R){const T=H[C[R]];W(T)||b.push(T)}return b}},{"./graphTypes":25,"./nodeMap":27}],23:[function(Y,xe,he){"use strict";const{isKeyword:W}=Y("./context"),j=Y("./graphTypes"),F=Y("./types"),Q=Y("./util"),H=Y("./url"),b=Y("./JsonLdError"),{createNodeMap:C,mergeNodeMapGraphs:R}=Y("./nodeMap"),T={};function v(E){const $={};for(const Z in E)void 0!==E[Z]&&($["@"+Z]=[E[Z]]);return[$]}function y(E,$,Z){for(let ae=Z.length-1;ae>=0;--ae){const oe=Z[ae];if(oe.graph===$&&oe.subject["@id"]===E["@id"])return!0}return!1}function x(E,$,Z){const ae="@"+Z;let oe=ae in E?E[ae][0]:$[Z];if("embed"===Z)if(!0===oe)oe="@once";else if(!1===oe)oe="@never";else if("@always"!==oe&&"@never"!==oe&&"@link"!==oe&&"@first"!==oe&&"@last"!==oe&&"@once"!==oe)throw new b("Invalid JSON-LD syntax; invalid value of @embed.","jsonld.SyntaxError",{code:"invalid @embed value",frame:E});return oe}function A(E){if(!F.isArray(E)||1!==E.length||!F.isObject(E[0]))throw new b("Invalid JSON-LD syntax; a JSON-LD frame must be a single object.","jsonld.SyntaxError",{frame:E});if("@id"in E[0])for(const $ of Q.asArray(E[0]["@id"]))if(!F.isObject($)&&!H.isAbsolute($)||F.isString($)&&0===$.indexOf("_:"))throw new b("Invalid JSON-LD syntax; invalid @id in frame.","jsonld.SyntaxError",{code:"invalid frame",frame:E});if("@type"in E[0])for(const $ of Q.asArray(E[0]["@type"]))if(!F.isObject($)&&!H.isAbsolute($)||F.isString($)&&0===$.indexOf("_:"))throw new b("Invalid JSON-LD syntax; invalid @type in frame.","jsonld.SyntaxError",{code:"invalid frame",frame:E})}function N(E,$,Z,ae){let oe=!0,te=!1;for(const Ce in Z){let me=!1;const ne=Q.getValues($,Ce),ye=0===Q.getValues(Z,Ce).length;if("@id"===Ce){if(F.isEmptyObject(Z["@id"][0]||{})?me=!0:Z["@id"].length>=0&&(me=Z["@id"].includes(ne[0])),!ae.requireAll)return me}else if("@type"===Ce){if(oe=!1,ye){if(ne.length>0)return!1;me=!0}else if(1===Z["@type"].length&&F.isEmptyObject(Z["@type"][0]))me=ne.length>0;else for(const Oe of Z["@type"])me=!(!F.isObject(Oe)||!("@default"in Oe))||me||ne.some($e=>$e===Oe);if(!ae.requireAll)return me}else{if(W(Ce))continue;{const Oe=Q.getValues(Z,Ce)[0];let $e=!1;if(Oe&&(A([Oe]),$e="@default"in Oe),oe=!1,0===ne.length&&$e)continue;if(ne.length>0&&ye)return!1;if(void 0===Oe){if(ne.length>0)return!1;me=!0}else if(j.isList(Oe)){const st=Oe["@list"][0];if(j.isList(ne[0])){const Qe=ne[0]["@list"];j.isValue(st)?me=Qe.some(tt=>X(st,tt)):(j.isSubject(st)||j.isSubjectReference(st))&&(me=Qe.some(tt=>O(E,st,tt,ae)))}}else me=j.isValue(Oe)?ne.some(st=>X(Oe,st)):j.isSubjectReference(Oe)?ne.some(st=>O(E,Oe,st,ae)):!!F.isObject(Oe)&&ne.length>0}}if(!me&&ae.requireAll)return!1;te=te||me}return oe||te}function K(E,$){const Z=E.uniqueEmbeds[E.graph],ae=Z[$],oe=ae.parent,te=ae.property,Ce={"@id":$};if(F.isArray(oe)){for(let ne=0;ne<oe.length;++ne)if(Q.compareValues(oe[ne],Ce)){oe[ne]=Ce;break}}else{const ne=F.isArray(oe[te]);Q.removeValue(oe,te,Ce,{propertyIsArray:ne}),Q.addValue(oe,te,Ce,{propertyIsArray:ne})}const me=ne=>{const ye=Object.keys(Z);for(const Oe of ye)Oe in Z&&F.isObject(Z[Oe].parent)&&Z[Oe].parent["@id"]===ne&&(delete Z[Oe],me(Oe))};me($)}function ue(E,$){if(F.isArray(E))return E.map(Z=>ue(Z,$));if(F.isObject(E)){if("@preserve"in E)return E["@preserve"][0];if(j.isValue(E))return E;if(j.isList(E))return E["@list"]=ue(E["@list"],$),E;if("@id"in E){const Z=E["@id"];if($.link.hasOwnProperty(Z)){const ae=$.link[Z].indexOf(E);if(-1!==ae)return $.link[Z][ae];$.link[Z].push(E)}else $.link[Z]=[E]}for(const Z in E)"@id"===Z&&$.bnodesToClear.includes(E[Z])?delete E["@id"]:E[Z]=ue(E[Z],$)}return E}function I(E,$,Z){F.isObject(E)?Q.addValue(E,$,Z,{propertyIsArray:!0}):E.push(Z)}function O(E,$,Z,ae){if(!("@id"in Z))return!1;const oe=E.subjects[Z["@id"]];return oe&&N(E,oe,$,ae)}function X(E,$){const Z=$["@value"],ae=$["@type"],oe=$["@language"],te=E["@value"]?F.isArray(E["@value"])?E["@value"]:[E["@value"]]:[],Ce=E["@type"]?F.isArray(E["@type"])?E["@type"]:[E["@type"]]:[],me=E["@language"]?F.isArray(E["@language"])?E["@language"]:[E["@language"]]:[];return 0===te.length&&0===Ce.length&&0===me.length||!(!te.includes(Z)&&!F.isEmptyObject(te[0])||!(!ae&&0===Ce.length||Ce.includes(ae)||ae&&F.isEmptyObject(Ce[0]))||!(!oe&&0===me.length||me.includes(oe)||oe&&F.isEmptyObject(me[0])))}xe.exports=T,T.frameMergedOrDefault=(E,$,Z)=>{const ae={options:Z,embedded:!1,graph:"@default",graphMap:{"@default":{}},subjectStack:[],link:{},bnodeMap:{}},oe=new Q.IdentifierIssuer("_:b");C(E,ae.graphMap,"@default",oe),Z.merged&&(ae.graphMap["@merged"]=R(ae.graphMap),ae.graph="@merged"),ae.subjects=ae.graphMap[ae.graph];const te=[];return T.frame(ae,Object.keys(ae.subjects).sort(),$,te),Z.pruneBlankNodeIdentifiers&&(Z.bnodesToClear=Object.keys(ae.bnodeMap).filter(Ce=>1===ae.bnodeMap[Ce].length)),Z.link={},ue(te,Z)},T.frame=(E,$,Z,ae,oe=null)=>{A(Z);const te=E.options,Ce={embed:x(Z=Z[0],te,"embed"),explicit:x(Z,te,"explicit"),requireAll:x(Z,te,"requireAll")};E.link.hasOwnProperty(E.graph)||(E.link[E.graph]={});const me=E.link[E.graph],ne=function(E,$,Z,ae){const oe={};for(const te of $){const Ce=E.graphMap[E.graph][te];N(E,Ce,Z,ae)&&(oe[te]=Ce)}return oe}(E,$,Z,Ce),ye=Object.keys(ne).sort();for(const Oe of ye){const $e=ne[Oe];if(null===oe?E.uniqueEmbeds={[E.graph]:{}}:E.uniqueEmbeds[E.graph]=E.uniqueEmbeds[E.graph]||{},"@link"===Ce.embed&&Oe in me){I(ae,oe,me[Oe]);continue}const st={"@id":Oe};if(0===Oe.indexOf("_:")&&Q.addValue(E.bnodeMap,Oe,st,{propertyIsArray:!0}),me[Oe]=st,("@first"===Ce.embed||"@last"===Ce.embed)&&E.is11)throw new b("Invalid JSON-LD syntax; invalid value of @embed.","jsonld.SyntaxError",{code:"invalid @embed value",frame:Z});if(E.embedded||!E.uniqueEmbeds[E.graph].hasOwnProperty(Oe)){if(E.embedded&&("@never"===Ce.embed||y($e,E.graph,E.subjectStack))){I(ae,oe,st);continue}if(E.embedded&&("@first"==Ce.embed||"@once"==Ce.embed)&&E.uniqueEmbeds[E.graph].hasOwnProperty(Oe)){I(ae,oe,st);continue}if("@last"===Ce.embed&&Oe in E.uniqueEmbeds[E.graph]&&K(E,Oe),E.uniqueEmbeds[E.graph][Oe]={parent:ae,property:oe},E.subjectStack.push({subject:$e,graph:E.graph}),Oe in E.graphMap){let Qe=!1,tt=null;"@graph"in Z?(tt=Z["@graph"][0],Qe=!("@merged"===Oe||"@default"===Oe),F.isObject(tt)||(tt={})):(Qe="@merged"!==E.graph,tt={}),Qe&&T.frame(wn(ot({},E),{graph:Oe,embedded:!1}),Object.keys(E.graphMap[Oe]).sort(),[tt],st,"@graph")}"@included"in Z&&T.frame(wn(ot({},E),{embedded:!1}),$,Z["@included"],st,"@included");for(const Qe of Object.keys($e).sort())if(W(Qe)){if(st[Qe]=Q.clone($e[Qe]),"@type"===Qe)for(const tt of $e["@type"])0===tt.indexOf("_:")&&Q.addValue(E.bnodeMap,tt,st,{propertyIsArray:!0})}else if(!Ce.explicit||Qe in Z)for(const tt of $e[Qe]){const Ke=Qe in Z?Z[Qe]:v(Ce);if(j.isList(tt)){const ze=Z[Qe]&&Z[Qe][0]&&Z[Qe][0]["@list"]?Z[Qe][0]["@list"]:v(Ce),ke={"@list":[]};I(st,Qe,ke);const Xe=tt["@list"];for(const Ae of Xe)j.isSubjectReference(Ae)?T.frame(wn(ot({},E),{embedded:!0}),[Ae["@id"]],ze,ke,"@list"):I(ke,"@list",Q.clone(Ae))}else j.isSubjectReference(tt)?T.frame(wn(ot({},E),{embedded:!0}),[tt["@id"]],Ke,st,Qe):X(Ke[0],tt)&&I(st,Qe,Q.clone(tt))}for(const Qe of Object.keys(Z).sort()){if("@type"===Qe){if(!F.isObject(Z[Qe][0])||!("@default"in Z[Qe][0]))continue}else if(W(Qe))continue;const tt=Z[Qe][0]||{};if(!x(tt,te,"omitDefault")&&!(Qe in st)){let ze="@null";"@default"in tt&&(ze=Q.clone(tt["@default"])),F.isArray(ze)||(ze=[ze]),st[Qe]=[{"@preserve":ze}]}}for(const Qe of Object.keys(Z["@reverse"]||{}).sort()){const tt=Z["@reverse"][Qe];for(const Ke of Object.keys(E.subjects))Q.getValues(E.subjects[Ke],Qe).some(ke=>ke["@id"]===Oe)&&(st["@reverse"]=st["@reverse"]||{},Q.addValue(st["@reverse"],Qe,[],{propertyIsArray:!0}),T.frame(wn(ot({},E),{embedded:!0}),[Ke],tt,st["@reverse"][Qe],oe))}I(ae,oe,st),E.subjectStack.pop()}}},T.cleanupNull=(E,$)=>{if(F.isArray(E))return E.map(ae=>T.cleanupNull(ae,$)).filter(ae=>ae);if("@null"===E)return null;if(F.isObject(E)){if("@id"in E){const Z=E["@id"];if($.link.hasOwnProperty(Z)){const ae=$.link[Z].indexOf(E);if(-1!==ae)return $.link[Z][ae];$.link[Z].push(E)}else $.link[Z]=[E]}for(const Z in E)E[Z]=T.cleanupNull(E[Z],$)}return E}},{"./JsonLdError":12,"./context":19,"./graphTypes":25,"./nodeMap":27,"./types":30,"./url":31,"./util":32}],24:[function(Y,xe,he){"use strict";const W=Y("./JsonLdError"),j=Y("./graphTypes"),F=Y("./types"),Q=Y("./util"),{RDF_LIST:H,RDF_FIRST:b,RDF_REST:C,RDF_NIL:R,RDF_TYPE:T,RDF_JSON_LITERAL:v,XSD_BOOLEAN:y,XSD_DOUBLE:x,XSD_INTEGER:A,XSD_STRING:z}=Y("./constants"),N=/^[a-zA-Z]{1,8}(-[a-zA-Z0-9]{1,8})*$/,K={};function ue(I,O,X){if(I.termType.endsWith("Node"))return{"@id":I.value};const E={"@value":I.value};if(I.language)E["@language"]=I.language;else{let $=I.datatype.value;if($||($=z),$===v){$="@json";try{E["@value"]=JSON.parse(E["@value"])}catch(Z){throw new W("JSON literal could not be parsed.","jsonld.InvalidJsonLiteral",{code:"invalid JSON literal",value:E["@value"],cause:Z})}}if(O){if($===y)"true"===E["@value"]?E["@value"]=!0:"false"===E["@value"]&&(E["@value"]=!1);else if(F.isNumeric(E["@value"]))if($===A){const Z=parseInt(E["@value"],10);Z.toFixed(0)===E["@value"]&&(E["@value"]=Z)}else $===x&&(E["@value"]=parseFloat(E["@value"]));[y,A,x,z].includes($)||(E["@type"]=$)}else if("i18n-datatype"===X&&$.startsWith("https://www.w3.org/ns/i18n#")){const[,Z,ae]=$.split(/[#_]/);Z.length>0&&(E["@language"]=Z,Z.match(N)||console.warn(`@language must be valid BCP47: ${Z}`)),E["@direction"]=ae}else $!==z&&(E["@type"]=$)}return E}xe.exports=K,K.fromRDF=function(){var I=yt(function*(O,{useRdfType:X=!1,useNativeTypes:E=!1,rdfDirection:$=null}){const Z={},ae={"@default":Z},oe={};for(const me of O){const ne="DefaultGraph"===me.graph.termType?"@default":me.graph.value;ne in ae||(ae[ne]={}),"@default"!==ne&&!(ne in Z)&&(Z[ne]={"@id":ne});const ye=ae[ne],Oe=me.subject.value,$e=me.predicate.value,st=me.object;Oe in ye||(ye[Oe]={"@id":Oe});const Qe=ye[Oe],tt=st.termType.endsWith("Node");if(tt&&!(st.value in ye)&&(ye[st.value]={"@id":st.value}),$e===T&&!X&&tt){Q.addValue(Qe,"@type",st.value,{propertyIsArray:!0});continue}const Ke=ue(st,E,$);if(Q.addValue(Qe,$e,Ke,{propertyIsArray:!0}),tt)if(st.value===R){const ze=ye[st.value];"usages"in ze||(ze.usages=[]),ze.usages.push({node:Qe,property:$e,value:Ke})}else oe[st.value]=!(st.value in oe)&&{node:Qe,property:$e,value:Ke}}for(const me in ae){const ne=ae[me];if(!(R in ne))continue;const ye=ne[R];if(ye.usages){for(let Oe of ye.usages){let $e=Oe.node,st=Oe.property,Qe=Oe.value;const tt=[],Ke=[];let ze=Object.keys($e).length;for(;st===C&&F.isObject(oe[$e["@id"]])&&F.isArray($e[b])&&1===$e[b].length&&F.isArray($e[C])&&1===$e[C].length&&(3===ze||4===ze&&F.isArray($e["@type"])&&1===$e["@type"].length&&$e["@type"][0]===H)&&(tt.push($e[b][0]),Ke.push($e["@id"]),Oe=oe[$e["@id"]],$e=Oe.node,st=Oe.property,Qe=Oe.value,ze=Object.keys($e).length,j.isBlankNode($e)););delete Qe["@id"],Qe["@list"]=tt.reverse();for(const ke of Ke)delete ne[ke]}delete ye.usages}}const te=[],Ce=Object.keys(Z).sort();for(const me of Ce){const ne=Z[me];if(me in ae){const ye=ne["@graph"]=[],Oe=ae[me],$e=Object.keys(Oe).sort();for(const st of $e){const Qe=Oe[st];j.isSubjectReference(Qe)||ye.push(Qe)}}j.isSubjectReference(ne)||te.push(ne)}return te});return function(O,X){return I.apply(this,arguments)}}()},{"./JsonLdError":12,"./constants":18,"./graphTypes":25,"./types":30,"./util":32}],25:[function(Y,xe,he){"use strict";const W=Y("./types"),j={};xe.exports=j,j.isSubject=F=>!(!W.isObject(F)||"@value"in F||"@set"in F||"@list"in F)&&(Object.keys(F).length>1||!("@id"in F)),j.isSubjectReference=F=>W.isObject(F)&&1===Object.keys(F).length&&"@id"in F,j.isValue=F=>W.isObject(F)&&"@value"in F,j.isList=F=>W.isObject(F)&&"@list"in F,j.isGraph=F=>W.isObject(F)&&"@graph"in F&&1===Object.keys(F).filter(Q=>"@id"!==Q&&"@index"!==Q).length,j.isSimpleGraph=F=>j.isGraph(F)&&!("@id"in F),j.isBlankNode=F=>!!W.isObject(F)&&("@id"in F?0===F["@id"].indexOf("_:"):0===Object.keys(F).length||!("@value"in F||"@set"in F||"@list"in F))},{"./types":30}],26:[function(Y,xe,he){const W=Y("rdf-canonize"),j=Y("./platform"),F=Y("./util"),Q=Y("./ContextResolver"),H=F.IdentifierIssuer,b=Y("./JsonLdError"),C=Y("lru-cache"),R=Y("./NQuads"),{expand:T}=Y("./expand"),{flatten:v}=Y("./flatten"),{fromRDF:y}=Y("./fromRdf"),{toRDF:x}=Y("./toRdf"),{frameMergedOrDefault:A,cleanupNull:z}=Y("./frame"),{isArray:N,isObject:K,isString:ue}=Y("./types"),{isSubjectReference:I}=Y("./graphTypes"),{expandIri:O,getInitialContext:X,process:E,processingMode:$}=Y("./context"),{compact:Z,compactIri:ae}=Y("./compact"),{createNodeMap:oe,createMergedNodeMap:te,mergeNodeMaps:Ce}=Y("./nodeMap"),me=function(ye){const Oe={},st=new C({max:100});function Qe(tt,ke){var Xe=ke,{documentLoader:Ke=ye.documentLoader}=Xe,ze=K9(Xe,["documentLoader"]);return Object.assign({},{documentLoader:Ke},ze,tt)}return ye.compact=function(){var tt=yt(function*(Ke,ze,ke){if(arguments.length<2)throw new TypeError("Could not compact, too few arguments.");if(null===ze)throw new b("The compaction context must not be null.","jsonld.CompactError",{code:"invalid local context"});if(null===Ke)return null;let Xe;(ke=Qe(ke,{base:ue(Ke)?Ke:"",compactArrays:!0,compactToRelative:!0,graph:!1,skipExpansion:!1,link:!1,issuer:new H("_:b"),contextResolver:new Q({sharedCache:st})})).link&&(ke.skipExpansion=!0),ke.compactToRelative||delete ke.base,Xe=ke.skipExpansion?Ke:yield ye.expand(Ke,ke);const Ae=yield ye.processContext(X(ke),ze,ke);let Ue=yield Z({activeCtx:Ae,element:Xe,options:ke,compactionMap:ke.compactionMap});ke.compactArrays&&!ke.graph&&N(Ue)?1===Ue.length?Ue=Ue[0]:0===Ue.length&&(Ue={}):ke.graph&&K(Ue)&&(Ue=[Ue]),K(ze)&&"@context"in ze&&(ze=ze["@context"]),ze=F.clone(ze),N(ze)||(ze=[ze]);const qe=ze;ze=[];for(let q=0;q<qe.length;++q)(!K(qe[q])||Object.keys(qe[q]).length>0)&&ze.push(qe[q]);const Fe=ze.length>0;if(1===ze.length&&(ze=ze[0]),N(Ue)){const q=ae({activeCtx:Ae,iri:"@graph",relativeTo:{vocab:!0}}),G=Ue;Ue={},Fe&&(Ue["@context"]=ze),Ue[q]=G}else if(K(Ue)&&Fe){const q=Ue;Ue={"@context":ze};for(const G in q)Ue[G]=q[G]}return Ue});return function(Ke,ze,ke){return tt.apply(this,arguments)}}(),ye.expand=function(){var tt=yt(function*(Ke,ze){if(arguments.length<1)throw new TypeError("Could not expand, too few arguments.");!1===(ze=Qe(ze,{keepFreeFloatingNodes:!1,contextResolver:new Q({sharedCache:st})})).expansionMap&&(ze.expansionMap=void 0);const ke={},Xe=[];if("expandContext"in ze){const Fe=F.clone(ze.expandContext);ke.expandContext=K(Fe)&&"@context"in Fe?Fe:{"@context":Fe},Xe.push(ke.expandContext)}let Ae;if(ue(Ke)){const Fe=yield ye.get(Ke,ze);Ae=Fe.documentUrl,ke.input=Fe.document,Fe.contextUrl&&(ke.remoteContext={"@context":Fe.contextUrl},Xe.push(ke.remoteContext))}else ke.input=F.clone(Ke);"base"in ze||(ze.base=Ae||"");let Ue=X(ze);for(const Fe of Xe)Ue=yield E({activeCtx:Ue,localCtx:Fe,options:ze});let qe=yield T({activeCtx:Ue,element:ke.input,options:ze,expansionMap:ze.expansionMap});return K(qe)&&"@graph"in qe&&1===Object.keys(qe).length?qe=qe["@graph"]:null===qe&&(qe=[]),N(qe)||(qe=[qe]),qe});return function(Ke,ze){return tt.apply(this,arguments)}}(),ye.flatten=function(){var tt=yt(function*(Ke,ze,ke){if(arguments.length<1)return new TypeError("Could not flatten, too few arguments.");ze="function"==typeof ze?null:ze||null,ke=Qe(ke,{base:ue(Ke)?Ke:"",contextResolver:new Q({sharedCache:st})});const Xe=yield ye.expand(Ke,ke),Ae=v(Xe);return null===ze?Ae:(ke.graph=!0,ke.skipExpansion=!0,yield ye.compact(Ae,ze,ke))});return function(Ke,ze,ke){return tt.apply(this,arguments)}}(),ye.frame=function(){var tt=yt(function*(Ke,ze,ke){if(arguments.length<2)throw new TypeError("Could not frame, too few arguments.");if(ke=Qe(ke,{base:ue(Ke)?Ke:"",embed:"@once",explicit:!1,requireAll:!1,omitDefault:!1,bnodesToClear:[],contextResolver:new Q({sharedCache:st})}),ue(ze)){const de=yield ye.get(ze,ke);if(ze=de.document,de.contextUrl){let je=ze["@context"];je?N(je)?je.push(de.contextUrl):je=[je,de.contextUrl]:je=de.contextUrl,ze["@context"]=je}}const Xe=ze&&ze["@context"]||{},Ae=yield ye.processContext(X(ke),Xe,ke);ke.hasOwnProperty("omitGraph")||(ke.omitGraph=$(Ae,1.1)),ke.hasOwnProperty("pruneBlankNodeIdentifiers")||(ke.pruneBlankNodeIdentifiers=$(Ae,1.1));const Ue=yield ye.expand(Ke,ke),qe=ot({},ke);qe.isFrame=!0,qe.keepFreeFloatingNodes=!0;const Fe=yield ye.expand(ze,qe),q=Object.keys(ze).map(de=>O(Ae,de,{vocab:!0}));qe.merged=!q.includes("@graph"),qe.is11=$(Ae,1.1);const G=A(Ue,Fe,qe);qe.graph=!ke.omitGraph,qe.skipExpansion=!0,qe.link={},qe.framing=!0;let pe=yield ye.compact(G,Xe,qe);return qe.link={},pe=z(pe,qe),pe});return function(Ke,ze,ke){return tt.apply(this,arguments)}}(),ye.link=function(){var tt=yt(function*(Ke,ze,ke){const Xe={};return ze&&(Xe["@context"]=ze),Xe["@embed"]="@link",ye.frame(Ke,Xe,ke)});return function(Ke,ze,ke){return tt.apply(this,arguments)}}(),ye.normalize=ye.canonize=function(){var tt=yt(function*(Ke,ze){if(arguments.length<1)throw new TypeError("Could not canonize, too few arguments.");if("inputFormat"in(ze=Qe(ze,{base:ue(Ke)?Ke:"",algorithm:"URDNA2015",skipExpansion:!1,contextResolver:new Q({sharedCache:st})}))){if("application/n-quads"!==ze.inputFormat&&"application/nquads"!==ze.inputFormat)throw new b("Unknown canonicalization input format.","jsonld.CanonizeError");const Ae=R.parse(Ke);return W.canonize(Ae,ze)}const ke=ot({},ze);delete ke.format,ke.produceGeneralizedRdf=!1;const Xe=yield ye.toRDF(Ke,ke);return W.canonize(Xe,ze)});return function(Ke,ze){return tt.apply(this,arguments)}}(),ye.fromRDF=function(){var tt=yt(function*(Ke,ze){if(arguments.length<1)throw new TypeError("Could not convert from RDF, too few arguments.");ze=Qe(ze,{format:ue(Ke)?"application/n-quads":void 0});const{format:ke}=ze;let{rdfParser:Xe}=ze;if(ke){if(Xe=Xe||Oe[ke],!Xe)throw new b("Unknown input format.","jsonld.UnknownFormat",{format:ke})}else Xe=()=>Ke;const Ae=yield Xe(Ke);return y(Ae,ze)});return function(Ke,ze){return tt.apply(this,arguments)}}(),ye.toRDF=function(){var tt=yt(function*(Ke,ze){if(arguments.length<1)throw new TypeError("Could not convert to RDF, too few arguments.");let ke;ke=(ze=Qe(ze,{base:ue(Ke)?Ke:"",skipExpansion:!1,contextResolver:new Q({sharedCache:st})})).skipExpansion?Ke:yield ye.expand(Ke,ze);const Xe=x(ke,ze);if(ze.format){if("application/n-quads"===ze.format||"application/nquads"===ze.format)return R.serialize(Xe);throw new b("Unknown output format.","jsonld.UnknownFormat",{format:ze.format})}return Xe});return function(Ke,ze){return tt.apply(this,arguments)}}(),ye.createNodeMap=function(){var tt=yt(function*(Ke,ze){if(arguments.length<1)throw new TypeError("Could not create node map, too few arguments.");ze=Qe(ze,{base:ue(Ke)?Ke:"",contextResolver:new Q({sharedCache:st})});const ke=yield ye.expand(Ke,ze);return te(ke,ze)});return function(Ke,ze){return tt.apply(this,arguments)}}(),ye.merge=function(){var tt=yt(function*(Ke,ze,ke){if(arguments.length<1)throw new TypeError("Could not merge, too few arguments.");if(!N(Ke))throw new TypeError('Could not merge, "docs" must be an array.');ze="function"==typeof ze?null:ze||null,ke=Qe(ke,{contextResolver:new Q({sharedCache:st})});const Xe=yield Promise.all(Ke.map(de=>{const je=ot({},ke);return ye.expand(de,je)}));let Ae=!0;"mergeNodes"in ke&&(Ae=ke.mergeNodes);const Ue=ke.issuer||new H("_:b"),qe={"@default":{}};for(let de=0;de<Xe.length;++de){const je=F.relabelBlankNodes(Xe[de],{issuer:new H("_:b"+de+"-")}),_t=Ae||0===de?qe:{"@default":{}};if(oe(je,_t,"@default",Ue),_t!==qe)for(const pt in _t){const we=_t[pt];if(!(pt in qe)){qe[pt]=we;continue}const B=qe[pt];for(const P in we)P in B||(B[P]=we[P])}}const Fe=Ce(qe),q=[],G=Object.keys(Fe).sort();for(let de=0;de<G.length;++de){const je=Fe[G[de]];I(je)||q.push(je)}return null===ze?q:(ke.graph=!0,ke.skipExpansion=!0,yield ye.compact(q,ze,ke))});return function(Ke,ze,ke){return tt.apply(this,arguments)}}(),Object.defineProperty(ye,"documentLoader",{get:()=>ye._documentLoader,set:tt=>ye._documentLoader=tt}),ye.documentLoader=function(){var tt=yt(function*(Ke){throw new b("Could not retrieve a JSON-LD document from the URL. URL dereferencing not implemented.","jsonld.LoadDocumentError",{code:"loading document failed",url:Ke})});return function(Ke){return tt.apply(this,arguments)}}(),ye.get=function(){var tt=yt(function*(Ke,ze){let ke;ke="function"==typeof ze.documentLoader?ze.documentLoader:ye.documentLoader;const Xe=yield ke(Ke);try{if(!Xe.document)throw new b("No remote document found at the given URL.","jsonld.NullRemoteDocument");ue(Xe.document)&&(Xe.document=JSON.parse(Xe.document))}catch(Ae){throw new b("Could not retrieve a JSON-LD document from the URL.","jsonld.LoadDocumentError",{code:"loading document failed",cause:Ae,remoteDoc:Xe})}return Xe});return function(Ke,ze){return tt.apply(this,arguments)}}(),ye.processContext=function(){var tt=yt(function*(Ke,ze,ke){return ke=Qe(ke,{base:"",contextResolver:new Q({sharedCache:st})}),null===ze?X(ke):(ze=F.clone(ze),K(ze)&&"@context"in ze||(ze={"@context":ze}),E({activeCtx:Ke,localCtx:ze,options:ke}))});return function(Ke,ze,ke){return tt.apply(this,arguments)}}(),ye.getContextValue=Y("./context").getContextValue,ye.documentLoaders={},ye.useDocumentLoader=function(tt){if(!(tt in ye.documentLoaders))throw new b('Unknown document loader type: "'+tt+'"',"jsonld.UnknownDocumentLoader",{type:tt});ye.documentLoader=ye.documentLoaders[tt].apply(ye,Array.prototype.slice.call(arguments,1))},ye.registerRDFParser=function(tt,Ke){Oe[tt]=Ke},ye.unregisterRDFParser=function(tt){delete Oe[tt]},ye.registerRDFParser("application/n-quads",R.parse),ye.registerRDFParser("application/nquads",R.parse),ye.url=Y("./url"),ye.util=F,Object.assign(ye,F),ye.promises=ye,ye.RequestQueue=Y("./RequestQueue"),ye.JsonLdProcessor=Y("./JsonLdProcessor")(ye),j.setupGlobals(ye),j.setupDocumentLoaders(ye),ye},ne=function(){return me(function(){return ne()})};me(ne),xe.exports=ne},{"./ContextResolver":11,"./JsonLdError":12,"./JsonLdProcessor":13,"./NQuads":14,"./RequestQueue":15,"./compact":17,"./context":19,"./expand":21,"./flatten":22,"./frame":23,"./fromRdf":24,"./graphTypes":25,"./nodeMap":27,"./platform":28,"./toRdf":29,"./types":30,"./url":31,"./util":32,"lru-cache":33,"rdf-canonize":46}],27:[function(Y,xe,he){"use strict";const{isKeyword:W}=Y("./context"),j=Y("./graphTypes"),F=Y("./types"),Q=Y("./util"),H=Y("./JsonLdError"),b={};xe.exports=b,b.createMergedNodeMap=(C,R)=>{const T=(R=R||{}).issuer||new Q.IdentifierIssuer("_:b"),v={"@default":{}};return b.createNodeMap(C,v,"@default",T),b.mergeNodeMaps(v)},b.createNodeMap=(C,R,T,v,y,x)=>{if(F.isArray(C)){for(const K of C)b.createNodeMap(K,R,T,v,void 0,x);return}if(!F.isObject(C))return void(x&&x.push(C));if(j.isValue(C)){if("@type"in C){let K=C["@type"];0===K.indexOf("_:")&&(C["@type"]=K=v.getId(K))}return void(x&&x.push(C))}if(x&&j.isList(C)){const K=[];return b.createNodeMap(C["@list"],R,T,v,y,K),void x.push({"@list":K})}if("@type"in C){const K=C["@type"];for(const ue of K)0===ue.indexOf("_:")&&v.getId(ue)}F.isUndefined(y)&&(y=j.isBlankNode(C)?v.getId(C["@id"]):C["@id"]),x&&x.push({"@id":y});const A=R[T],z=A[y]=A[y]||{};z["@id"]=y;const N=Object.keys(C).sort();for(let K of N){if("@id"===K)continue;if("@reverse"===K){const I={"@id":y},O=C["@reverse"];for(const X in O){const E=O[X];for(const $ of E){let Z=$["@id"];j.isBlankNode($)&&(Z=v.getId(Z)),b.createNodeMap($,R,T,v,Z),Q.addValue(A[Z],X,I,{propertyIsArray:!0,allowDuplicate:!1})}}continue}if("@graph"===K){y in R||(R[y]={}),b.createNodeMap(C[K],R,y,v);continue}if("@included"===K){b.createNodeMap(C[K],R,T,v);continue}if("@type"!==K&&W(K)){if("@index"===K&&K in z&&(C[K]!==z[K]||C[K]["@id"]!==z[K]["@id"]))throw new H("Invalid JSON-LD syntax; conflicting @index property detected.","jsonld.SyntaxError",{code:"conflicting indexes",subject:z});z[K]=C[K];continue}const ue=C[K];if(0===K.indexOf("_:")&&(K=v.getId(K)),0!==ue.length)for(let I of ue)if("@type"===K&&(I=0===I.indexOf("_:")?v.getId(I):I),j.isSubject(I)||j.isSubjectReference(I)){if("@id"in I&&!I["@id"])continue;const O=j.isBlankNode(I)?v.getId(I["@id"]):I["@id"];Q.addValue(z,K,{"@id":O},{propertyIsArray:!0,allowDuplicate:!1}),b.createNodeMap(I,R,T,v,O)}else if(j.isValue(I))Q.addValue(z,K,I,{propertyIsArray:!0,allowDuplicate:!1});else if(j.isList(I)){const O=[];b.createNodeMap(I["@list"],R,T,v,y,O),I={"@list":O},Q.addValue(z,K,I,{propertyIsArray:!0,allowDuplicate:!1})}else b.createNodeMap(I,R,T,v,y),Q.addValue(z,K,I,{propertyIsArray:!0,allowDuplicate:!1});else Q.addValue(z,K,[],{propertyIsArray:!0})}},b.mergeNodeMapGraphs=C=>{const R={};for(const T of Object.keys(C).sort())for(const v of Object.keys(C[T]).sort()){const y=C[T][v];v in R||(R[v]={"@id":v});const x=R[v];for(const A of Object.keys(y).sort())if(W(A)&&"@type"!==A)x[A]=Q.clone(y[A]);else for(const z of y[A])Q.addValue(x,A,Q.clone(z),{propertyIsArray:!0,allowDuplicate:!1})}return R},b.mergeNodeMaps=C=>{const R=C["@default"],T=Object.keys(C).sort();for(const v of T){if("@default"===v)continue;const y=C[v];let x=R[v];x?"@graph"in x||(x["@graph"]=[]):R[v]=x={"@id":v,"@graph":[]};const A=x["@graph"];for(const z of Object.keys(y).sort()){const N=y[z];j.isSubjectReference(N)||A.push(N)}}return R}},{"./JsonLdError":12,"./context":19,"./graphTypes":25,"./types":30,"./util":32}],28:[function(Y,xe,he){"use strict";const W=Y("./documentLoaders/xhr"),j={};xe.exports=j,j.setupDocumentLoaders=function(F){"undefined"!=typeof XMLHttpRequest&&(F.documentLoaders.xhr=W,F.useDocumentLoader("xhr"))},j.setupGlobals=function(F){void 0===globalThis.JsonLdProcessor&&Object.defineProperty(globalThis,"JsonLdProcessor",{writable:!0,enumerable:!1,configurable:!0,value:F.JsonLdProcessor})}},{"./documentLoaders/xhr":20}],29:[function(Y,xe,he){"use strict";const{createNodeMap:W}=Y("./nodeMap"),{isKeyword:j}=Y("./context"),F=Y("./graphTypes"),Q=Y("canonicalize"),H=Y("./types"),b=Y("./util"),{RDF_FIRST:C,RDF_REST:R,RDF_NIL:T,RDF_TYPE:v,RDF_JSON_LITERAL:y,RDF_LANGSTRING:x,XSD_BOOLEAN:A,XSD_DOUBLE:z,XSD_INTEGER:N,XSD_STRING:K}=Y("./constants"),{isAbsolute:ue}=Y("./url"),I={};function O($,Z,ae,oe,te){const Ce=Object.keys(Z).sort();for(const me of Ce){const ne=Z[me],ye=Object.keys(ne).sort();for(let Oe of ye){const $e=ne[Oe];if("@type"===Oe)Oe=v;else if(j(Oe))continue;for(const st of $e){const Qe={termType:me.startsWith("_:")?"BlankNode":"NamedNode",value:me};if(!ue(me))continue;const tt={termType:Oe.startsWith("_:")?"BlankNode":"NamedNode",value:Oe};if(!ue(Oe)||"BlankNode"===tt.termType&&!te.produceGeneralizedRdf)continue;const Ke=E(st,oe,$,ae,te.rdfDirection);Ke&&$.push({subject:Qe,predicate:tt,object:Ke,graph:ae})}}}}function E($,Z,ae,oe,te){const Ce={};if(F.isValue($)){Ce.termType="Literal",Ce.value=void 0,Ce.datatype={termType:"NamedNode"};let me=$["@value"];const ne=$["@type"]||null;"@json"===ne?(Ce.value=Q(me),Ce.datatype.value=y):H.isBoolean(me)?(Ce.value=me.toString(),Ce.datatype.value=ne||A):H.isDouble(me)||ne===z?(H.isDouble(me)||(me=parseFloat(me)),Ce.value=me.toExponential(15).replace(/(\d)0*e\+?/,"$1E"),Ce.datatype.value=ne||z):H.isNumber(me)?(Ce.value=me.toFixed(0),Ce.datatype.value=ne||N):"i18n-datatype"===te&&"@direction"in $?(Ce.datatype.value="https://www.w3.org/ns/i18n#"+($["@language"]||"")+`_${$["@direction"]}`,Ce.value=me):"@language"in $?(Ce.value=me,Ce.datatype.value=ne||x,Ce.language=$["@language"]):(Ce.value=me,Ce.datatype.value=ne||K)}else if(F.isList($)){const me=function($,Z,ae,oe,te){const Ce={termType:"NamedNode",value:C},me={termType:"NamedNode",value:R},ne={termType:"NamedNode",value:T},ye=$.pop(),Oe=ye?{termType:"BlankNode",value:Z.getId()}:ne;let $e=Oe;for(const st of $){const Qe=E(st,Z,ae,oe,te),tt={termType:"BlankNode",value:Z.getId()};ae.push({subject:$e,predicate:Ce,object:Qe,graph:oe}),ae.push({subject:$e,predicate:me,object:tt,graph:oe}),$e=tt}if(ye){const st=E(ye,Z,ae,oe,te);ae.push({subject:$e,predicate:Ce,object:st,graph:oe}),ae.push({subject:$e,predicate:me,object:ne,graph:oe})}return Oe}($["@list"],Z,ae,oe,te);Ce.termType=me.termType,Ce.value=me.value}else{const me=H.isObject($)?$["@id"]:$;Ce.termType=me.startsWith("_:")?"BlankNode":"NamedNode",Ce.value=me}return"NamedNode"!==Ce.termType||ue(Ce.value)?Ce:null}xe.exports=I,I.toRDF=($,Z)=>{const ae=new b.IdentifierIssuer("_:b"),oe={"@default":{}};W($,oe,"@default",ae);const te=[],Ce=Object.keys(oe).sort();for(const me of Ce){let ne;if("@default"===me)ne={termType:"DefaultGraph",value:""};else{if(!ue(me))continue;ne=me.startsWith("_:")?{termType:"BlankNode"}:{termType:"NamedNode"},ne.value=me}O(te,oe[me],ne,ae,Z)}return te}},{"./constants":18,"./context":19,"./graphTypes":25,"./nodeMap":27,"./types":30,"./url":31,"./util":32,canonicalize:7}],30:[function(Y,xe,he){"use strict";const W={};xe.exports=W,W.isArray=Array.isArray,W.isBoolean=j=>"boolean"==typeof j||"[object Boolean]"===Object.prototype.toString.call(j),W.isDouble=j=>W.isNumber(j)&&(-1!==String(j).indexOf(".")||Math.abs(j)>=1e21),W.isEmptyObject=j=>W.isObject(j)&&0===Object.keys(j).length,W.isNumber=j=>"number"==typeof j||"[object Number]"===Object.prototype.toString.call(j),W.isNumeric=j=>!isNaN(parseFloat(j))&&isFinite(j),W.isObject=j=>"[object Object]"===Object.prototype.toString.call(j),W.isString=j=>"string"==typeof j||"[object String]"===Object.prototype.toString.call(j),W.isUndefined=j=>void 0===j},{}],31:[function(Y,xe,he){"use strict";const W=Y("./types"),j={};xe.exports=j,j.parsers={simple:{keys:["href","scheme","authority","path","query","fragment"],regex:/^(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/},full:{keys:["href","protocol","scheme","authority","auth","user","password","hostname","port","path","directory","file","query","fragment"],regex:/^(([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?(?:(((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/}},j.parse=(Q,H)=>{const b={},C=j.parsers[H||"full"],R=C.regex.exec(Q);let T=C.keys.length;for(;T--;)b[C.keys[T]]=void 0===R[T]?null:R[T];return("https"===b.scheme&&"443"===b.port||"http"===b.scheme&&"80"===b.port)&&(b.href=b.href.replace(":"+b.port,""),b.authority=b.authority.replace(":"+b.port,""),b.port=null),b.normalizedPath=j.removeDotSegments(b.path),b},j.prependBase=(Q,H)=>{if(null===Q||j.isAbsolute(H))return H;(!Q||W.isString(Q))&&(Q=j.parse(Q||""));const b=j.parse(H),C={protocol:Q.protocol||""};if(null!==b.authority)C.authority=b.authority,C.path=b.path,C.query=b.query;else if(C.authority=Q.authority,""===b.path)C.path=Q.path,C.query=null!==b.query?b.query:Q.query;else{if(0===b.path.indexOf("/"))C.path=b.path;else{let T=Q.path;T=T.substr(0,T.lastIndexOf("/")+1),(T.length>0||Q.authority)&&"/"!==T.substr(-1)&&(T+="/"),T+=b.path,C.path=T}C.query=b.query}""!==b.path&&(C.path=j.removeDotSegments(C.path));let R=C.protocol;return null!==C.authority&&(R+="//"+C.authority),R+=C.path,null!==C.query&&(R+="?"+C.query),null!==b.fragment&&(R+="#"+b.fragment),""===R&&(R="./"),R},j.removeBase=(Q,H)=>{if(null===Q)return H;(!Q||W.isString(Q))&&(Q=j.parse(Q||""));let b="";if(""!==Q.href?b+=(Q.protocol||"")+"//"+(Q.authority||""):H.indexOf("//")&&(b+="//"),0!==H.indexOf(b))return H;const C=j.parse(H.substr(b.length)),R=Q.normalizedPath.split("/"),T=C.normalizedPath.split("/"),v=C.fragment||C.query?0:1;for(;R.length>0&&T.length>v&&R[0]===T[0];)R.shift(),T.shift();let y="";if(R.length>0){R.pop();for(let x=0;x<R.length;++x)y+="../"}return y+=T.join("/"),null!==C.query&&(y+="?"+C.query),null!==C.fragment&&(y+="#"+C.fragment),""===y&&(y="./"),y},j.removeDotSegments=Q=>{if(0===Q.length)return"";const H=Q.split("/"),b=[];for(;H.length>0;){const C=H.shift(),R=0===H.length;"."!==C?".."!==C?b.push(C):(b.pop(),R&&b.push("")):R&&b.push("")}return"/"===Q[0]&&b.length>0&&""!==b[0]&&b.unshift(""),1===b.length&&""===b[0]?"/":b.join("/")};const F=/^([A-Za-z][A-Za-z0-9+-.]*|_):[^\s]*$/;j.isAbsolute=Q=>W.isString(Q)&&F.test(Q),j.isRelative=Q=>W.isString(Q)},{"./types":30}],32:[function(Y,xe,he){"use strict";const W=Y("./graphTypes"),j=Y("./types"),F=Y("rdf-canonize").IdentifierIssuer,Q=Y("./JsonLdError"),H=/(?:<[^>]*?>|"[^"]*?"|[^,])+/g,b=/\s*<([^>]*?)>\s*(?:;\s*(.*))?/,C=/(.*?)=(?:(?:"([^"]*?)")|([^"]*?))\s*(?:(?:;\s*)|$)/g,R_headers={accept:"application/ld+json, application/json"},T={};function v(y,x){if(j.isArray(x))for(let A=0;A<x.length;++A)x[A]=v(y,x[A]);else if(W.isList(x))x["@list"]=v(y,x["@list"]);else if(j.isObject(x)){W.isBlankNode(x)&&(x["@id"]=y.getId(x["@id"]));const A=Object.keys(x).sort();for(let z=0;z<A.length;++z){const N=A[z];"@id"!==N&&(x[N]=v(y,x[N]))}}return x}xe.exports=T,T.IdentifierIssuer=F,T.clone=function(y){if(y&&"object"==typeof y){let x;if(j.isArray(y)){x=[];for(let A=0;A<y.length;++A)x[A]=T.clone(y[A])}else if(y instanceof Map){x=new Map;for(const[A,z]of y)x.set(A,T.clone(z))}else if(y instanceof Set){x=new Set;for(const A of y)x.add(T.clone(A))}else if(j.isObject(y)){x={};for(const A in y)x[A]=T.clone(y[A])}else x=y.toString();return x}return y},T.asArray=function(y){return Array.isArray(y)?y:[y]},T.buildHeaders=(y={})=>{if(Object.keys(y).some(A=>"accept"===A.toLowerCase()))throw new RangeError('Accept header may not be specified; only "'+R_headers.accept+'" is supported.');return Object.assign({Accept:R_headers.accept},y)},T.parseLinkHeader=y=>{const x={},A=y.match(H);for(let z=0;z<A.length;++z){let N=A[z].match(b);if(!N)continue;const K={target:N[1]},ue=N[2];for(;N=C.exec(ue);)K[N[1]]=void 0===N[2]?N[3]:N[2];const I=K.rel||"";Array.isArray(x[I])?x[I].push(K):x[I]=x.hasOwnProperty(I)?[x[I],K]:K}return x},T.validateTypeValue=(y,x)=>{if(!(j.isString(y)||j.isArray(y)&&y.every(A=>j.isString(A)))){if(x&&j.isObject(y))switch(Object.keys(y).length){case 0:return;case 1:if("@default"in y&&T.asArray(y["@default"]).every(A=>j.isString(A)))return}throw new Q('Invalid JSON-LD syntax; "@type" value must a string, an array of strings, an empty object, or a default object.',"jsonld.SyntaxError",{code:"invalid type value",value:y})}},T.hasProperty=(y,x)=>{if(y.hasOwnProperty(x)){const A=y[x];return!j.isArray(A)||A.length>0}return!1},T.hasValue=(y,x,A)=>{if(T.hasProperty(y,x)){let z=y[x];const N=W.isList(z);if(j.isArray(z)||N){N&&(z=z["@list"]);for(let K=0;K<z.length;++K)if(T.compareValues(A,z[K]))return!0}else if(!j.isArray(A))return T.compareValues(A,z)}return!1},T.addValue=(y,x,A,z)=>{if("propertyIsArray"in(z=z||{})||(z.propertyIsArray=!1),"valueIsArray"in z||(z.valueIsArray=!1),"allowDuplicate"in z||(z.allowDuplicate=!0),"prependValue"in z||(z.prependValue=!1),z.valueIsArray)y[x]=A;else if(j.isArray(A)){0===A.length&&z.propertyIsArray&&!y.hasOwnProperty(x)&&(y[x]=[]),z.prependValue&&(A=A.concat(y[x]),y[x]=[]);for(let N=0;N<A.length;++N)T.addValue(y,x,A[N],z)}else if(y.hasOwnProperty(x)){const N=!z.allowDuplicate&&T.hasValue(y,x,A);!j.isArray(y[x])&&(!N||z.propertyIsArray)&&(y[x]=[y[x]]),N||(z.prependValue?y[x].unshift(A):y[x].push(A))}else y[x]=z.propertyIsArray?[A]:A},T.getValues=(y,x)=>[].concat(y[x]||[]),T.removeProperty=(y,x)=>{delete y[x]},T.removeValue=(y,x,A,z)=>{"propertyIsArray"in(z=z||{})||(z.propertyIsArray=!1);const N=T.getValues(y,x).filter(K=>!T.compareValues(K,A));0===N.length?T.removeProperty(y,x):y[x]=1!==N.length||z.propertyIsArray?N:N[0]},T.relabelBlankNodes=(y,x)=>v((x=x||{}).issuer||new F("_:b"),y),T.compareValues=(y,x)=>!!(y===x||W.isValue(y)&&W.isValue(x)&&y["@value"]===x["@value"]&&y["@type"]===x["@type"]&&y["@language"]===x["@language"]&&y["@index"]===x["@index"])||!!(j.isObject(y)&&"@id"in y&&j.isObject(x)&&"@id"in x)&&y["@id"]===x["@id"],T.compareShortestLeast=(y,x)=>y.length<x.length?-1:x.length<y.length?1:y===x?0:y<x?-1:1},{"./JsonLdError":12,"./graphTypes":25,"./types":30,"rdf-canonize":46}],33:[function(Y,xe,he){"use strict";const W=Y("yallist"),j=Symbol("max"),F=Symbol("length"),Q=Symbol("lengthCalculator"),H=Symbol("allowStale"),b=Symbol("maxAge"),C=Symbol("dispose"),R=Symbol("noDisposeOnSet"),T=Symbol("lruList"),v=Symbol("cache"),y=Symbol("updateAgeOnGet"),x=()=>1;const z=(X,E,$)=>{const Z=X[v].get(E);if(Z){const ae=Z.value;if(N(X,ae)){if(ue(X,Z),!X[H])return}else $&&(X[y]&&(Z.value.now=Date.now()),X[T].unshiftNode(Z));return ae.value}},N=(X,E)=>{if(!E||!E.maxAge&&!X[b])return!1;const $=Date.now()-E.now;return E.maxAge?$>E.maxAge:X[b]&&$>X[b]},K=X=>{if(X[F]>X[j])for(let E=X[T].tail;X[F]>X[j]&&null!==E;){const $=E.prev;ue(X,E),E=$}},ue=(X,E)=>{if(E){const $=E.value;X[C]&&X[C]($.key,$.value),X[F]-=$.length,X[v].delete($.key),X[T].removeNode(E)}};class I{constructor(E,$,Z,ae,oe){this.key=E,this.value=$,this.length=Z,this.now=ae,this.maxAge=oe||0}}const O=(X,E,$,Z)=>{let ae=$.value;N(X,ae)&&(ue(X,$),X[H]||(ae=void 0)),ae&&E.call(Z,ae.value,ae.key,X)};xe.exports=class{constructor(E){if("number"==typeof E&&(E={max:E}),E||(E={}),E.max&&("number"!=typeof E.max||E.max<0))throw new TypeError("max must be a non-negative number");this[j]=E.max||1/0;const Z=E.length||x;if(this[Q]="function"!=typeof Z?x:Z,this[H]=E.stale||!1,E.maxAge&&"number"!=typeof E.maxAge)throw new TypeError("maxAge must be a number");this[b]=E.maxAge||0,this[C]=E.dispose,this[R]=E.noDisposeOnSet||!1,this[y]=E.updateAgeOnGet||!1,this.reset()}set max(E){if("number"!=typeof E||E<0)throw new TypeError("max must be a non-negative number");this[j]=E||1/0,K(this)}get max(){return this[j]}set allowStale(E){this[H]=!!E}get allowStale(){return this[H]}set maxAge(E){if("number"!=typeof E)throw new TypeError("maxAge must be a non-negative number");this[b]=E,K(this)}get maxAge(){return this[b]}set lengthCalculator(E){"function"!=typeof E&&(E=x),E!==this[Q]&&(this[Q]=E,this[F]=0,this[T].forEach($=>{$.length=this[Q]($.value,$.key),this[F]+=$.length})),K(this)}get lengthCalculator(){return this[Q]}get length(){return this[F]}get itemCount(){return this[T].length}rforEach(E,$){$=$||this;for(let Z=this[T].tail;null!==Z;){const ae=Z.prev;O(this,E,Z,$),Z=ae}}forEach(E,$){$=$||this;for(let Z=this[T].head;null!==Z;){const ae=Z.next;O(this,E,Z,$),Z=ae}}keys(){return this[T].toArray().map(E=>E.key)}values(){return this[T].toArray().map(E=>E.value)}reset(){this[C]&&this[T]&&this[T].length&&this[T].forEach(E=>this[C](E.key,E.value)),this[v]=new Map,this[T]=new W,this[F]=0}dump(){return this[T].map(E=>!N(this,E)&&{k:E.key,v:E.value,e:E.now+(E.maxAge||0)}).toArray().filter(E=>E)}dumpLru(){return this[T]}set(E,$,Z){if((Z=Z||this[b])&&"number"!=typeof Z)throw new TypeError("maxAge must be a number");const ae=Z?Date.now():0,oe=this[Q]($,E);if(this[v].has(E)){if(oe>this[j])return ue(this,this[v].get(E)),!1;const me=this[v].get(E).value;return this[C]&&(this[R]||this[C](E,me.value)),me.now=ae,me.maxAge=Z,me.value=$,this[F]+=oe-me.length,me.length=oe,this.get(E),K(this),!0}const te=new I(E,$,oe,ae,Z);return te.length>this[j]?(this[C]&&this[C](E,$),!1):(this[F]+=te.length,this[T].unshift(te),this[v].set(E,this[T].head),K(this),!0)}has(E){if(!this[v].has(E))return!1;const $=this[v].get(E).value;return!N(this,$)}get(E){return z(this,E,!0)}peek(E){return z(this,E,!1)}pop(){const E=this[T].tail;return E?(ue(this,E),E.value):null}del(E){ue(this,this[v].get(E))}load(E){this.reset();const $=Date.now();for(let Z=E.length-1;Z>=0;Z--){const ae=E[Z],oe=ae.e||0;if(0===oe)this.set(ae.k,ae.v);else{const te=oe-$;te>0&&this.set(ae.k,ae.v,te)}}}prune(){this[v].forEach((E,$)=>z(this,$,!1))}}},{yallist:92}],34:[function(Y,xe,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.default=void 0;const W="http://www.w3.org/1999/02/22-rdf-syntax-ns#",j="http://www.w3.org/2001/XMLSchema#",F="http://www.w3.org/2000/10/swap/";he.default={xsd:{decimal:`${j}decimal`,boolean:`${j}boolean`,double:`${j}double`,integer:`${j}integer`,string:`${j}string`},rdf:{type:`${W}type`,nil:`${W}nil`,first:`${W}first`,rest:`${W}rest`,langString:`${W}langString`},owl:{sameAs:"http://www.w3.org/2002/07/owl#sameAs"},r:{forSome:`${F}reify#forSome`,forAll:`${F}reify#forAll`},log:{implies:`${F}log#implies`}}},{}],35:[function(Y,xe,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.default=he.Variable=he.Triple=he.Term=he.Quad=he.NamedNode=he.Literal=he.DefaultGraph=he.BlankNode=void 0,he.escapeQuotes=E,he.termFromId=function I(ne,ye){if(ye=ye||v,!ne)return ye.defaultGraph();switch(ne[0]){case"?":return ye.variable(ne.substr(1));case"_":return ye.blankNode(ne.substr(2));case'"':if(ye===v)return new z(ne);if('"'===ne[ne.length-1])return ye.literal(ne.substr(1,ne.length-2));const Oe=ne.lastIndexOf('"',ne.length-1);return ye.literal(ne.substr(1,Oe-1),"@"===ne[Oe+1]?ne.substr(Oe+2):ye.namedNode(ne.substr(Oe+3)));case"<":const $e=T.exec(ne);return ye.quad(I($($e[1]),ye),I($($e[2]),ye),I($($e[3]),ye),$e[4]&&I($($e[4]),ye));default:return ye.namedNode(ne)}},he.termToId=function O(ne){if("string"==typeof ne)return ne;if(ne instanceof x&&"Quad"!==ne.termType)return ne.id;if(!ne)return b.id;switch(ne.termType){case"NamedNode":return ne.value;case"BlankNode":return`_:${ne.value}`;case"Variable":return`?${ne.value}`;case"DefaultGraph":return"";case"Literal":return`"${ne.value}"${ne.language?`@${ne.language}`:ne.datatype&&ne.datatype.value!==H.string?`^^${ne.datatype.value}`:""}`;case"Quad":return`<<${E(O(ne.subject))} ${E(O(ne.predicate))} ${E(O(ne.object))}${(0,j.isDefaultGraph)(ne.graph)?"":` ${O(ne.graph)}`}>>`;default:throw new Error(`Unexpected termType: ${ne.termType}`)}},he.unescapeQuotes=$;var ne,W=(ne=Y("./IRIs"))&&ne.__esModule?ne:{default:ne},j=Y("./N3Util");const{rdf:Q,xsd:H}=W.default;let b,C=0;const R=/^"(.*".*)(?="[^"]*$)/,T=/^<<("(?:""|[^"])*"[^ ]*|[^ ]+) ("(?:""|[^"])*"[^ ]*|[^ ]+) ("(?:""|[^"])*"[^ ]*|[^ ]+) ?("(?:""|[^"])*"[^ ]*|[^ ]+)?>>$/,v={namedNode:function(ne){return new A(ne)},blankNode:function(ne){return new N(ne||"n3-"+C++)},variable:function(ne){return new K(ne)},literal:function(ne,ye){if("string"==typeof ye)return new z(`"${ne}"@${ye.toLowerCase()}`);let Oe=ye?ye.value:"";return""===Oe&&("boolean"==typeof ne?Oe=H.boolean:"number"==typeof ne&&(Number.isFinite(ne)?Oe=Number.isInteger(ne)?H.integer:H.double:(Oe=H.double,Number.isNaN(ne)||(ne=ne>0?"INF":"-INF")))),new z(""===Oe||Oe===H.string?`"${ne}"`:`"${ne}"^^${Oe}`)},defaultGraph:function(){return b},quad:me,triple:me};he.default=v;class x{constructor(ye){this.id=ye}get value(){return this.id}equals(ye){return ye instanceof x?this.id===ye.id:!!ye&&this.termType===ye.termType&&this.value===ye.value}hashCode(){return 0}toJSON(){return{termType:this.termType,value:this.value}}}he.Term=x;class A extends x{get termType(){return"NamedNode"}}he.NamedNode=A;class z extends x{get termType(){return"Literal"}get value(){return this.id.substring(1,this.id.lastIndexOf('"'))}get language(){const ye=this.id;let Oe=ye.lastIndexOf('"')+1;return Oe<ye.length&&"@"===ye[Oe++]?ye.substr(Oe).toLowerCase():""}get datatype(){return new A(this.datatypeString)}get datatypeString(){const ye=this.id,Oe=ye.lastIndexOf('"')+1,$e=Oe<ye.length?ye[Oe]:"";return"^"===$e?ye.substr(Oe+2):"@"!==$e?H.string:Q.langString}equals(ye){return ye instanceof z?this.id===ye.id:!!ye&&!!ye.datatype&&this.termType===ye.termType&&this.value===ye.value&&this.language===ye.language&&this.datatype.value===ye.datatype.value}toJSON(){return{termType:this.termType,value:this.value,language:this.language,datatype:{termType:"NamedNode",value:this.datatypeString}}}}he.Literal=z;class N extends x{constructor(ye){super(`_:${ye}`)}get termType(){return"BlankNode"}get value(){return this.id.substr(2)}}he.BlankNode=N;class K extends x{constructor(ye){super(`?${ye}`)}get termType(){return"Variable"}get value(){return this.id.substr(1)}}he.Variable=K;class ue extends x{constructor(){return super(""),b||this}get termType(){return"DefaultGraph"}equals(ye){return this===ye||!!ye&&this.termType===ye.termType}}he.DefaultGraph=ue,b=new ue;class X extends x{constructor(ye,Oe,$e,st){super(""),this._subject=ye,this._predicate=Oe,this._object=$e,this._graph=st||b}get termType(){return"Quad"}get subject(){return this._subject}get predicate(){return this._predicate}get object(){return this._object}get graph(){return this._graph}toJSON(){return{termType:this.termType,subject:this._subject.toJSON(),predicate:this._predicate.toJSON(),object:this._object.toJSON(),graph:this._graph.toJSON()}}equals(ye){return!!ye&&this._subject.equals(ye.subject)&&this._predicate.equals(ye.predicate)&&this._object.equals(ye.object)&&this._graph.equals(ye.graph)}}function E(ne){return ne.replace(R,(ye,Oe)=>`"${Oe.replace(/"/g,'""')}`)}function $(ne){return ne.replace(R,(ye,Oe)=>`"${Oe.replace(/""/g,'"')}`)}function me(ne,ye,Oe,$e){return new X(ne,ye,Oe,$e)}he.Triple=he.Quad=X},{"./IRIs":34,"./N3Util":41}],36:[function(Y,xe,he){(function(W){(function(){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.default=void 0;var j=Q(Y("./IRIs")),F=Q(Y("queue-microtask"));function Q(x){return x&&x.__esModule?x:{default:x}}const{xsd:H}=j.default,b=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{8})|\\([^])/g,C={"\\":"\\","'":"'",'"':'"',n:"\n",r:"\r",t:"\t",f:"\f",b:"\b",_:"_","~":"~",".":".","-":"-","!":"!",$:"$","&":"&","(":"(",")":")","*":"*","+":"+",",":",",";":";","=":"=","/":"/","?":"?","#":"#","@":"@","%":"%"},R=/[\x00-\x20<>\\"\{\}\|\^\`]/,T={_iri:!0,_unescapedIri:!0,_simpleQuotedString:!0,_langcode:!0,_blank:!0,_newline:!0,_comment:!0,_whitespace:!0,_endOfFile:!0},v=/$0^/;he.default=class{constructor(A){if(this._iri=/^<((?:[^ <>{}\\]|\\[uU])+)>[ \t]*/,this._unescapedIri=/^<([^\x00-\x20<>\\"\{\}\|\^\`]*)>[ \t]*/,this._simpleQuotedString=/^"([^"\\\r\n]*)"(?=[^"])/,this._simpleApostropheString=/^'([^'\\\r\n]*)'(?=[^'])/,this._langcode=/^@([a-z]+(?:-[a-z0-9]+)*)(?=[^a-z0-9\-])/i,this._prefix=/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:(?=[#\s<])/,this._prefixed=/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:((?:(?:[0-:A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])(?:(?:[\.\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])*(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~]))?)?)(?:[ \t]+|(?=\.?[,;!\^\s#()\[\]\{\}"'<>]))/,this._variable=/^\?(?:(?:[A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?=[.,;!\^\s#()\[\]\{\}"'<>])/,this._blank=/^_:((?:[0-9A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?:[ \t]+|(?=\.?[,;:\s#()\[\]\{\}"'<>]))/,this._number=/^[\-+]?(?:(\d+\.\d*|\.?\d+)[eE][\-+]?|\d*(\.)?)\d+(?=\.?[,;:\s#()\[\]\{\}"'<>])/,this._boolean=/^(?:true|false)(?=[.,;\s#()\[\]\{\}"'<>])/,this._keyword=/^@[a-z]+(?=[\s#<:])/i,this._sparqlKeyword=/^(?:PREFIX|BASE|GRAPH)(?=[\s#<])/i,this._shortPredicates=/^a(?=[\s#()\[\]\{\}"'<>])/,this._newline=/^[ \t]*(?:#[^\n\r]*)?(?:\r\n|\n|\r)[ \t]*/,this._comment=/#([^\n\r]*)/,this._whitespace=/^[ \t]+/,this._endOfFile=/^(?:#[^\n\r]*)?$/,this._lineMode=!!(A=A||{}).lineMode){this._n3Mode=!1;for(const z in this)!(z in T)&&this[z]instanceof RegExp&&(this[z]=v)}else this._n3Mode=!1!==A.n3;this._comments=!!A.comments,this._literalClosingPos=0}_tokenizeToEnd(A,z){let N=this._input,K=N.length;for(;;){let O,X;for(;O=this._newline.exec(N);)this._comments&&(X=this._comment.exec(O[0]))&&ue("comment",X[1],"",this._line,O[0].length),N=N.substr(O[0].length,N.length),K=N.length,this._line++;if(!O&&(O=this._whitespace.exec(N))&&(N=N.substr(O[0].length,N.length)),this._endOfFile.test(N))return z&&(this._comments&&(X=this._comment.exec(N))&&ue("comment",X[1],"",this._line,N.length),N=null,ue("eof","","",this._line,0)),this._input=N;const E=this._line,$=N[0];let Z="",ae="",oe="",te=null,Ce=0,me=!1;switch($){case"^":if(N.length<3)break;if("^"!==N[1]){this._n3Mode&&(Ce=1,Z="^");break}if(this._previousMarker="^^",N=N.substr(2),"<"!==N[0]){me=!0;break}case"<":if(te=this._unescapedIri.exec(N))Z="IRI",ae=te[1];else if(te=this._iri.exec(N)){if(ae=this._unescape(te[1]),null===ae||R.test(ae))return I(this);Z="IRI"}else N.length>1&&"<"===N[1]?(Z="<<",Ce=2):this._n3Mode&&N.length>1&&"="===N[1]&&(Z="inverse",Ce=2,ae=">");break;case">":N.length>1&&">"===N[1]&&(Z=">>",Ce=2);break;case"_":((te=this._blank.exec(N))||z&&(te=this._blank.exec(`${N} `)))&&(Z="blank",oe="_",ae=te[1]);break;case'"':if(te=this._simpleQuotedString.exec(N))ae=te[1];else if(({value:ae,matchLength:Ce}=this._parseLiteral(N)),null===ae)return I(this);(null!==te||0!==Ce)&&(Z="literal",this._literalClosingPos=0);break;case"'":if(!this._lineMode){if(te=this._simpleApostropheString.exec(N))ae=te[1];else if(({value:ae,matchLength:Ce}=this._parseLiteral(N)),null===ae)return I(this);(null!==te||0!==Ce)&&(Z="literal",this._literalClosingPos=0)}break;case"?":this._n3Mode&&(te=this._variable.exec(N))&&(Z="var",ae=te[0]);break;case"@":"literal"===this._previousMarker&&(te=this._langcode.exec(N))?(Z="langcode",ae=te[1]):(te=this._keyword.exec(N))&&(Z=te[0]);break;case".":if(1===N.length?z:N[1]<"0"||N[1]>"9"){Z=".",Ce=1;break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"+":case"-":(te=this._number.exec(N)||z&&(te=this._number.exec(`${N} `)))&&(Z="literal",ae=te[0],oe="string"==typeof te[1]?H.double:"string"==typeof te[2]?H.decimal:H.integer);break;case"B":case"b":case"p":case"P":case"G":case"g":(te=this._sparqlKeyword.exec(N))?Z=te[0].toUpperCase():me=!0;break;case"f":case"t":(te=this._boolean.exec(N))?(Z="literal",ae=te[0],oe=H.boolean):me=!0;break;case"a":(te=this._shortPredicates.exec(N))?(Z="abbreviation",ae="a"):me=!0;break;case"=":this._n3Mode&&N.length>1&&(Z="abbreviation",">"!==N[1]?(Ce=1,ae="="):(Ce=2,ae=">"));break;case"!":if(!this._n3Mode)break;case",":case";":case"[":case"]":case"(":case")":case"{":case"}":this._lineMode||(Ce=1,Z=$);break;default:me=!0}if(me&&("@prefix"!==this._previousMarker&&"PREFIX"!==this._previousMarker||!(te=this._prefix.exec(N))?((te=this._prefixed.exec(N))||z&&(te=this._prefixed.exec(`${N} `)))&&(Z="prefixed",oe=te[1]||"",ae=this._unescape(te[2])):(Z="prefix",ae=te[1]||"")),"^^"===this._previousMarker)switch(Z){case"prefixed":Z="type";break;case"IRI":Z="typeIRI";break;default:Z=""}if(!Z)return z||!/^'''|^"""/.test(N)&&/\n|\r/.test(N)?I(this):this._input=N;const ne=Ce||te[0].length,ye=ue(Z,ae,oe,E,ne);this.previousToken=ye,this._previousMarker=Z,N=N.substr(ne,N.length)}function ue(O,X,E,$,Z){const ae=N?K-N.length:K,te={type:O,value:X,prefix:E,line:$,start:ae,end:ae+Z};return A(null,te),te}function I(O){A(O._syntaxError(/^\S*/.exec(N)[0]))}}_unescape(A){let z=!1;const N=A.replace(b,(K,ue,I,O)=>{if("string"==typeof ue)return String.fromCharCode(Number.parseInt(ue,16));if("string"==typeof I){let X=Number.parseInt(I,16);return X<=65535?String.fromCharCode(Number.parseInt(I,16)):String.fromCharCode(55296+((X-=65536)>>10),56320+(1023&X))}return O in C?C[O]:(z=!0,"")});return z?null:N}_parseLiteral(A){if(A.length>=3){const z=A.match(/^(?:"""|"|'''|'|)/)[0],N=z.length;let K=Math.max(this._literalClosingPos,N);for(;(K=A.indexOf(z,K))>0;){let ue=0;for(;"\\"===A[K-ue-1];)ue++;if(ue%2==0){const I=A.substring(N,K),O=I.split(/\r\n|\r|\n/).length-1,X=K+N;if(1===N&&0!==O||3===N&&this._lineMode)break;return this._line+=O,{value:this._unescape(I),matchLength:X}}K++}this._literalClosingPos=A.length-N+1}return{value:"",matchLength:0}}_syntaxError(A){this._input=null;const z=new Error(`Unexpected "${A}" on line ${this._line}.`);return z.context={token:void 0,line:this._line,previousToken:this.previousToken},z}_readStartingBom(A){return A.startsWith("\ufeff")?A.substr(1):A}tokenize(A,z){if(this._line=1,"string"==typeof A){if(this._input=this._readStartingBom(A),"function"!=typeof z){const N=[];let K;if(this._tokenizeToEnd((ue,I)=>ue?K=ue:N.push(I),!0),K)throw K;return N}(0,F.default)(()=>this._tokenizeToEnd(z,!0))}else this._pendingBuffer=null,"function"==typeof A.setEncoding&&A.setEncoding("utf8"),A.on("data",N=>{null!==this._input&&0!==N.length&&(this._pendingBuffer&&(N=W.concat([this._pendingBuffer,N]),this._pendingBuffer=null),128&N[N.length-1]?this._pendingBuffer=N:(void 0===this._input?this._input=this._readStartingBom("string"==typeof N?N:N.toString()):this._input+=N,this._tokenizeToEnd(z,!1)))}),A.on("end",()=>{"string"==typeof this._input&&this._tokenizeToEnd(z,!0)}),A.on("error",z)}}}).call(this)}).call(this,Y("buffer").Buffer)},{"./IRIs":34,buffer:6,"queue-microtask":45}],37:[function(Y,xe,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.default=void 0;var W=Q(Y("./N3Lexer")),j=Q(Y("./N3DataFactory")),F=Q(Y("./IRIs"));function Q(T){return T&&T.__esModule?T:{default:T}}let H=0;class b{constructor(v){this._contextStack=[],this._graph=null,this._setBase((v=v||{}).baseIRI),v.factory&&R(this,v.factory);const y="string"==typeof v.format?v.format.match(/\w*$/)[0].toLowerCase():"",x=/turtle/.test(y),A=/trig/.test(y),z=/triple/.test(y),N=/quad/.test(y),K=this._n3Mode=/n3/.test(y),ue=z||N;(this._supportsNamedGraphs=!(x||K))||(this._readPredicateOrNamedGraph=this._readPredicate),this._supportsQuads=!(x||A||z||K),this._supportsRDFStar=""===y||/star|\*$/.test(y),ue&&(this._resolveRelativeIRI=I=>null),this._blankNodePrefix="string"!=typeof v.blankNodePrefix?"":v.blankNodePrefix.replace(/^(?!_:)/,"_:"),this._lexer=v.lexer||new W.default({lineMode:ue,n3:K}),this._explicitQuantifiers=!!v.explicitQuantifiers}static _resetBlankNodePrefix(){H=0}_setBase(v){if(v){const y=v.indexOf("#");y>=0&&(v=v.substr(0,y)),this._base=v,this._basePath=v.indexOf("/")<0?v:v.replace(/[^\/?]*(?:\?.*)?$/,""),v=v.match(/^(?:([a-z][a-z0-9+.-]*:))?(?:\/\/[^\/]*)?/i),this._baseRoot=v[0],this._baseScheme=v[1]}else this._base="",this._basePath=""}_saveContext(v,y,x,A,z){const N=this._n3Mode;this._contextStack.push({subject:x,predicate:A,object:z,graph:y,type:v,inverse:!!N&&this._inversePredicate,blankPrefix:N?this._prefixes._:"",quantified:N?this._quantified:null}),N&&(this._inversePredicate=!1,this._prefixes._=this._graph?`${this._graph.id.substr(2)}.`:".",this._quantified=Object.create(this._quantified))}_restoreContext(){const v=this._contextStack.pop(),y=this._n3Mode;this._subject=v.subject,this._predicate=v.predicate,this._object=v.object,this._graph=v.graph,y&&(this._inversePredicate=v.inverse,this._prefixes._=v.blankPrefix,this._quantified=v.quantified)}_readInTopContext(v){switch(v.type){case"eof":return null!==this._graph?this._error("Unclosed graph",v):(delete this._prefixes._,this._callback(null,null,this._prefixes));case"PREFIX":this._sparqlStyle=!0;case"@prefix":return this._readPrefix;case"BASE":this._sparqlStyle=!0;case"@base":return this._readBaseIRI;case"{":if(this._supportsNamedGraphs)return this._graph="",this._subject=null,this._readSubject;case"GRAPH":if(this._supportsNamedGraphs)return this._readNamedGraphLabel;default:return this._readSubject(v)}}_readEntity(v,y){let x;switch(v.type){case"IRI":case"typeIRI":const A=this._resolveIRI(v.value);if(null===A)return this._error("Invalid IRI",v);x=this._namedNode(A);break;case"type":case"prefixed":const z=this._prefixes[v.prefix];if(void 0===z)return this._error(`Undefined prefix "${v.prefix}:"`,v);x=this._namedNode(z+v.value);break;case"blank":x=this._blankNode(this._prefixes[v.prefix]+v.value);break;case"var":x=this._variable(v.value.substr(1));break;default:return this._error(`Expected entity but got ${v.type}`,v)}return!y&&this._n3Mode&&x.id in this._quantified&&(x=this._quantified[x.id]),x}_readSubject(v){switch(this._predicate=null,v.type){case"[":return this._saveContext("blank",this._graph,this._subject=this._blankNode(),null,null),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this.RDF_NIL,null,null),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._graph=this._blankNode(),null,null),this._readSubject):this._error("Unexpected graph",v);case"}":return this._readPunctuation(v);case"@forSome":return this._n3Mode?(this._subject=null,this._predicate=this.N3_FORSOME,this._quantifier=this._blankNode,this._readQuantifierList):this._error('Unexpected "@forSome"',v);case"@forAll":return this._n3Mode?(this._subject=null,this._predicate=this.N3_FORALL,this._quantifier=this._variable,this._readQuantifierList):this._error('Unexpected "@forAll"',v);case"literal":if(!this._n3Mode)return this._error("Unexpected literal",v);if(0===v.prefix.length)return this._literalValue=v.value,this._completeSubjectLiteral;this._subject=this._literal(v.value,this._namedNode(v.prefix));break;case"<<":return this._supportsRDFStar?(this._saveContext("<<",this._graph,null,null,null),this._graph=null,this._readSubject):this._error("Unexpected RDF* syntax",v);default:if(void 0===(this._subject=this._readEntity(v)))return;if(this._n3Mode)return this._getPathReader(this._readPredicateOrNamedGraph)}return this._readPredicateOrNamedGraph}_readPredicate(v){const y=v.type;switch(y){case"inverse":this._inversePredicate=!0;case"abbreviation":this._predicate=this.ABBREVIATIONS[v.value];break;case".":case"]":case"}":return null===this._predicate?this._error(`Unexpected ${y}`,v):(this._subject=null,"]"===y?this._readBlankNodeTail(v):this._readPunctuation(v));case";":return null!==this._predicate?this._readPredicate:this._error("Expected predicate but got ;",v);case"[":if(this._n3Mode)return this._saveContext("blank",this._graph,this._subject,this._subject=this._blankNode(),null),this._readBlankNodeHead;case"blank":if(!this._n3Mode)return this._error("Disallowed blank node as predicate",v);default:if(void 0===(this._predicate=this._readEntity(v)))return}return this._readObject}_readObject(v){switch(v.type){case"literal":if(0===v.prefix.length)return this._literalValue=v.value,this._readDataTypeOrLang;this._object=this._literal(v.value,this._namedNode(v.prefix));break;case"[":return this._saveContext("blank",this._graph,this._subject,this._predicate,this._subject=this._blankNode()),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this._subject,this._predicate,this.RDF_NIL),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph=this._blankNode()),this._readSubject):this._error("Unexpected graph",v);case"<<":return this._supportsRDFStar?(this._saveContext("<<",this._graph,this._subject,this._predicate,null),this._graph=null,this._readSubject):this._error("Unexpected RDF* syntax",v);default:if(void 0===(this._object=this._readEntity(v)))return;if(this._n3Mode)return this._getPathReader(this._getContextEndReader())}return this._getContextEndReader()}_readPredicateOrNamedGraph(v){return"{"===v.type?this._readGraph(v):this._readPredicate(v)}_readGraph(v){return"{"!==v.type?this._error(`Expected graph but got ${v.type}`,v):(this._graph=this._subject,this._subject=null,this._readSubject)}_readBlankNodeHead(v){return"]"===v.type?(this._subject=null,this._readBlankNodeTail(v)):(this._predicate=null,this._readPredicate(v))}_readBlankNodeTail(v){if("]"!==v.type)return this._readBlankNodePunctuation(v);null!==this._subject&&this._emit(this._subject,this._predicate,this._object,this._graph);const y=null===this._predicate;return this._restoreContext(),null!==this._object?this._getContextEndReader():null!==this._predicate?this._readObject:y?this._readPredicateOrNamedGraph:this._readPredicateAfterBlank}_readPredicateAfterBlank(v){switch(v.type){case".":case"}":return this._subject=null,this._readPunctuation(v);default:return this._readPredicate(v)}}_readListItem(v){let y=null,x=null,A=this._readListItem;const z=this._subject,N=this._contextStack,K=N[N.length-1];switch(v.type){case"[":this._saveContext("blank",this._graph,x=this._blankNode(),this.RDF_FIRST,this._subject=y=this._blankNode()),A=this._readBlankNodeHead;break;case"(":this._saveContext("list",this._graph,x=this._blankNode(),this.RDF_FIRST,this.RDF_NIL),this._subject=null;break;case")":if(this._restoreContext(),0!==N.length&&"list"===N[N.length-1].type&&this._emit(this._subject,this._predicate,this._object,this._graph),null===this._predicate){if(A=this._readPredicate,this._subject===this.RDF_NIL)return A}else if(A=this._getContextEndReader(),this._object===this.RDF_NIL)return A;x=this.RDF_NIL;break;case"literal":0===v.prefix.length?(this._literalValue=v.value,A=this._readListItemDataTypeOrLang):(y=this._literal(v.value,this._namedNode(v.prefix)),A=this._getContextEndReader());break;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph=this._blankNode()),this._readSubject):this._error("Unexpected graph",v);default:if(void 0===(y=this._readEntity(v)))return}if(null===x&&(this._subject=x=this._blankNode()),null===z?null===K.predicate?K.subject=x:K.object=x:this._emit(z,this.RDF_REST,x,this._graph),null!==y){if(this._n3Mode&&("IRI"===v.type||"prefixed"===v.type))return this._saveContext("item",this._graph,x,this.RDF_FIRST,y),this._subject=y,this._predicate=null,this._getPathReader(this._readListItem);this._emit(x,this.RDF_FIRST,y,this._graph)}return A}_readDataTypeOrLang(v){return this._completeObjectLiteral(v,!1)}_readListItemDataTypeOrLang(v){return this._completeObjectLiteral(v,!0)}_completeLiteral(v){let y=this._literal(this._literalValue);switch(v.type){case"type":case"typeIRI":const x=this._readEntity(v);if(void 0===x)return;y=this._literal(this._literalValue,x),v=null;break;case"langcode":y=this._literal(this._literalValue,v.value),v=null}return{token:v,literal:y}}_completeSubjectLiteral(v){return this._subject=this._completeLiteral(v).literal,this._readPredicateOrNamedGraph}_completeObjectLiteral(v,y){const x=this._completeLiteral(v);if(x)return this._object=x.literal,y&&this._emit(this._subject,this.RDF_FIRST,this._object,this._graph),null===x.token?this._getContextEndReader():(this._readCallback=this._getContextEndReader(),this._readCallback(x.token))}_readFormulaTail(v){return"}"!==v.type?this._readPunctuation(v):(null!==this._subject&&this._emit(this._subject,this._predicate,this._object,this._graph),this._restoreContext(),null===this._object?this._readPredicate:this._getContextEndReader())}_readPunctuation(v){let y,x=this._graph;const A=this._subject,z=this._inversePredicate;switch(v.type){case"}":if(null===this._graph)return this._error("Unexpected graph closing",v);if(this._n3Mode)return this._readFormulaTail(v);this._graph=null;case".":this._subject=null,y=this._contextStack.length?this._readSubject:this._readInTopContext,z&&(this._inversePredicate=!1);break;case";":y=this._readPredicate;break;case",":y=this._readObject;break;default:if(this._supportsQuads&&null===this._graph&&void 0!==(x=this._readEntity(v))){y=this._readQuadPunctuation;break}return this._error(`Expected punctuation to follow "${this._object.id}"`,v)}if(null!==A){const N=this._predicate,K=this._object;z?this._emit(K,N,A,x):this._emit(A,N,K,x)}return y}_readBlankNodePunctuation(v){let y;switch(v.type){case";":y=this._readPredicate;break;case",":y=this._readObject;break;default:return this._error(`Expected punctuation to follow "${this._object.id}"`,v)}return this._emit(this._subject,this._predicate,this._object,this._graph),y}_readQuadPunctuation(v){return"."!==v.type?this._error("Expected dot to follow quad",v):this._readInTopContext}_readPrefix(v){return"prefix"!==v.type?this._error("Expected prefix to follow @prefix",v):(this._prefix=v.value,this._readPrefixIRI)}_readPrefixIRI(v){if("IRI"!==v.type)return this._error(`Expected IRI to follow prefix "${this._prefix}:"`,v);const y=this._readEntity(v);return this._prefixes[this._prefix]=y.value,this._prefixCallback(this._prefix,y),this._readDeclarationPunctuation}_readBaseIRI(v){const y="IRI"===v.type&&this._resolveIRI(v.value);return y?(this._setBase(y),this._readDeclarationPunctuation):this._error("Expected valid IRI to follow base declaration",v)}_readNamedGraphLabel(v){switch(v.type){case"IRI":case"blank":case"prefixed":return this._readSubject(v),this._readGraph;case"[":return this._readNamedGraphBlankLabel;default:return this._error("Invalid graph label",v)}}_readNamedGraphBlankLabel(v){return"]"!==v.type?this._error("Invalid graph label",v):(this._subject=this._blankNode(),this._readGraph)}_readDeclarationPunctuation(v){return this._sparqlStyle?(this._sparqlStyle=!1,this._readInTopContext(v)):"."!==v.type?this._error("Expected declaration to end with a dot",v):this._readInTopContext}_readQuantifierList(v){let y;switch(v.type){case"IRI":case"prefixed":if(void 0!==(y=this._readEntity(v,!0)))break;default:return this._error(`Unexpected ${v.type}`,v)}return this._explicitQuantifiers?(null===this._subject?this._emit(this._graph||this.DEFAULTGRAPH,this._predicate,this._subject=this._blankNode(),this.QUANTIFIERS_GRAPH):this._emit(this._subject,this.RDF_REST,this._subject=this._blankNode(),this.QUANTIFIERS_GRAPH),this._emit(this._subject,this.RDF_FIRST,y,this.QUANTIFIERS_GRAPH)):this._quantified[y.id]=this._quantifier(this._blankNode().value),this._readQuantifierPunctuation}_readQuantifierPunctuation(v){return","===v.type?this._readQuantifierList:(this._explicitQuantifiers&&(this._emit(this._subject,this.RDF_REST,this.RDF_NIL,this.QUANTIFIERS_GRAPH),this._subject=null),this._readCallback=this._getContextEndReader(),this._readCallback(v))}_getPathReader(v){return this._afterPath=v,this._readPath}_readPath(v){switch(v.type){case"!":return this._readForwardPath;case"^":return this._readBackwardPath;default:const y=this._contextStack,x=y.length&&y[y.length-1];if(x&&"item"===x.type){const A=this._subject;this._restoreContext(),this._emit(this._subject,this.RDF_FIRST,A,this._graph)}return this._afterPath(v)}}_readForwardPath(v){let y,x;const A=this._blankNode();if(void 0!==(x=this._readEntity(v)))return null===this._predicate?(y=this._subject,this._subject=A):(y=this._object,this._object=A),this._emit(y,x,A,this._graph),this._readPath}_readBackwardPath(v){const y=this._blankNode();let x,A;if(void 0!==(x=this._readEntity(v)))return null===this._predicate?(A=this._subject,this._subject=y):(A=this._object,this._object=y),this._emit(y,x,A,this._graph),this._readPath}_readRDFStarTailOrGraph(v){return">>"!==v.type?this._supportsQuads&&null===this._graph&&void 0!==(this._graph=this._readEntity(v))?this._readRDFStarTail:this._error(`Expected >> to follow "${this._object.id}"`,v):this._readRDFStarTail(v)}_readRDFStarTail(v){if(">>"!==v.type)return this._error(`Expected >> but got ${v.type}`,v);const y=this._quad(this._subject,this._predicate,this._object,this._graph||this.DEFAULTGRAPH);return this._restoreContext(),null===this._subject?(this._subject=y,this._readPredicate):(this._object=y,this._getContextEndReader())}_getContextEndReader(){const v=this._contextStack;if(!v.length)return this._readPunctuation;switch(v[v.length-1].type){case"blank":return this._readBlankNodeTail;case"list":return this._readListItem;case"formula":return this._readFormulaTail;case"<<":return this._readRDFStarTailOrGraph}}_emit(v,y,x,A){this._callback(null,this._quad(v,y,x,A||this.DEFAULTGRAPH))}_error(v,y){const x=new Error(`${v} on line ${y.line}.`);x.context={token:y,line:y.line,previousToken:this._lexer.previousToken},this._callback(x),this._callback=C}_resolveIRI(v){return/^[a-z][a-z0-9+.-]*:/i.test(v)?v:this._resolveRelativeIRI(v)}_resolveRelativeIRI(v){if(!v.length)return this._base;switch(v[0]){case"#":return this._base+v;case"?":return this._base.replace(/(?:\?.*)?$/,v);case"/":return("/"===v[1]?this._baseScheme:this._baseRoot)+this._removeDotSegments(v);default:return/^[^/:]*:/.test(v)?null:this._removeDotSegments(this._basePath+v)}}_removeDotSegments(v){if(!/(^|\/)\.\.?($|[/#?])/.test(v))return v;const y=v.length;let x="",A=-1,z=-1,N=0,K="/";for(;A<y;){switch(K){case":":if(z<0&&"/"===v[++A]&&"/"===v[++A])for(;(z=A+1)<y&&"/"!==v[z];)A=z;break;case"?":case"#":A=y;break;case"/":if("."===v[A+1])switch(K=v[1+ ++A],K){case"/":x+=v.substring(N,A-1),N=A+1;break;case void 0:case"?":case"#":return x+v.substring(N,A)+v.substr(A+1);case".":if(K=v[1+ ++A],void 0===K||"/"===K||"?"===K||"#"===K){if(x+=v.substring(N,A-2),(N=x.lastIndexOf("/"))>=z&&(x=x.substr(0,N)),"/"!==K)return`${x}/${v.substr(A+1)}`;N=A+1}}}K=v[++A]}return x+v.substring(N)}parse(v,y,x){if(this._readCallback=this._readInTopContext,this._sparqlStyle=!1,this._prefixes=Object.create(null),this._prefixes._=this._blankNodePrefix?this._blankNodePrefix.substr(2):`b${H++}_`,this._prefixCallback=x||C,this._inversePredicate=!1,this._quantified=Object.create(null),!y){const A=[];let z;if(this._callback=(N,K)=>{N?z=N:K&&A.push(K)},this._lexer.tokenize(v).every(N=>this._readCallback=this._readCallback(N)),z)throw z;return A}this._callback=y,this._lexer.tokenize(v,(A,z)=>{null!==A?(this._callback(A),this._callback=C):this._readCallback&&(this._readCallback=this._readCallback(z))})}}function C(){}function R(T,v){const y=v.namedNode;T._namedNode=y,T._blankNode=v.blankNode,T._literal=v.literal,T._variable=v.variable,T._quad=v.quad,T.DEFAULTGRAPH=v.defaultGraph(),T.RDF_FIRST=y(F.default.rdf.first),T.RDF_REST=y(F.default.rdf.rest),T.RDF_NIL=y(F.default.rdf.nil),T.N3_FORALL=y(F.default.r.forAll),T.N3_FORSOME=y(F.default.r.forSome),T.ABBREVIATIONS={a:y(F.default.rdf.type),"=":y(F.default.owl.sameAs),">":y(F.default.log.implies)},T.QUANTIFIERS_GRAPH=y("urn:n3:quantifiers")}he.default=b,R(b.prototype,j.default)},{"./IRIs":34,"./N3DataFactory":35,"./N3Lexer":36}],38:[function(Y,xe,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.default=void 0;var v,W=function(v,y){if(!y&&v&&v.__esModule)return v;if(null===v||"object"!=typeof v&&"function"!=typeof v)return{default:v};var x=H(y);if(x&&x.has(v))return x.get(v);var A={},z=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var N in v)if("default"!==N&&Object.prototype.hasOwnProperty.call(v,N)){var K=z?Object.getOwnPropertyDescriptor(v,N):null;K&&(K.get||K.set)?Object.defineProperty(A,N,K):A[N]=v[N]}return A.default=v,x&&x.set(v,A),A}(Y("./N3DataFactory")),j=Y("readable-stream"),F=(v=Y("./IRIs"))&&v.__esModule?v:{default:v};function H(v){if("function"!=typeof WeakMap)return null;var y=new WeakMap,x=new WeakMap;return(H=function(A){return A?x:y})(v)}class C{constructor(y,x){this._size=0,this._graphs=Object.create(null),this._id=0,this._ids=Object.create(null),this._ids["><"]=0,this._entities=Object.create(null),this._blankNodeIndex=0,!x&&y&&!y[0]&&(x=y,y=null),this._factory=(x=x||{}).factory||W.default,y&&this.addQuads(y)}get size(){let y=this._size;if(null!==y)return y;y=0;const x=this._graphs;let A,z;for(const N in x)for(const K in A=x[N].subjects)for(const ue in z=A[K])y+=Object.keys(z[ue]).length;return this._size=y}_addToIndex(y,x,A,z){const N=y[x]||(y[x]={}),K=N[A]||(N[A]={}),ue=z in K;return ue||(K[z]=null),!ue}_removeFromIndex(y,x,A,z){const N=y[x],K=N[A];delete K[z];for(const ue in K)return;delete N[A];for(const ue in N)return;delete y[x]}*_findInIndex(y,x,A,z,N,K,ue,I){let O,X,E;const Z=!x+!A+!z>1?Object.keys(this._ids):this._entities,ae=(0,W.termFromId)(I,this._factory);x&&((O=y,y={})[x]=O[x]);for(const oe in y){const te=Z[oe];if(X=y[oe]){A&&((O=X,X={})[A]=O[A]);for(const Ce in X){const me=Z[Ce];if(E=X[Ce]){const ne=z?z in E?[z]:[]:Object.keys(E);for(let ye=0;ye<ne.length;ye++){const Oe={subject:null,predicate:null,object:null};Oe[N]=(0,W.termFromId)(te,this._factory),Oe[K]=(0,W.termFromId)(me,this._factory),Oe[ue]=(0,W.termFromId)(Z[ne[ye]],this._factory),yield this._factory.quad(Oe.subject,Oe.predicate,Oe.object,ae)}}}}}}_loop(y,x){for(const A in y)x(A)}_loopByKey0(y,x,A){let z,N;if(z=y[x])for(N in z)A(N)}_loopByKey1(y,x,A){let z,N;for(z in y)N=y[z],N[x]&&A(z)}_loopBy2Keys(y,x,A,z){let N,K,ue;if((N=y[x])&&(K=N[A]))for(ue in K)z(ue)}_countInIndex(y,x,A,z){let K,ue,I,N=0;x&&((K=y,y={})[x]=K[x]);for(const O in y)if(ue=y[O]){A&&((K=ue,ue={})[A]=K[A]);for(const X in ue)(I=ue[X])&&(z?z in I&&N++:N+=Object.keys(I).length)}return N}_getGraphs(y){if(!R(y))return this._graphs;const x={};return x[y]=this._graphs[y],x}_uniqueEntities(y){const x=Object.create(null);return A=>{A in x||(x[A]=!0,y((0,W.termFromId)(this._entities[A],this._factory)))}}add(y){return this.addQuad(y),this}addQuad(y,x,A,z){x||(z=y.graph,A=y.object,x=y.predicate,y=y.subject),y=(0,W.termToId)(y),x=(0,W.termToId)(x),A=(0,W.termToId)(A),z=(0,W.termToId)(z);let N=this._graphs[z];N||(N=this._graphs[z]={subjects:{},predicates:{},objects:{}},Object.freeze(N));const K=this._ids,ue=this._entities;y=K[y]||(K[ue[++this._id]=y]=this._id),x=K[x]||(K[ue[++this._id]=x]=this._id),A=K[A]||(K[ue[++this._id]=A]=this._id);const I=this._addToIndex(N.subjects,y,x,A);return this._addToIndex(N.predicates,x,A,y),this._addToIndex(N.objects,A,y,x),this._size=null,I}addQuads(y){for(let x=0;x<y.length;x++)this.addQuad(y[x])}delete(y){return this.removeQuad(y),this}has(y,x,A,z){return y&&y.subject&&({subject:y,predicate:x,object:A,graph:z}=y),!this.readQuads(y,x,A,z).next().done}import(y){return y.on("data",x=>{this.addQuad(x)}),y}removeQuad(y,x,A,z){x||(z=y.graph,A=y.object,x=y.predicate,y=y.subject),y=(0,W.termToId)(y),x=(0,W.termToId)(x),A=(0,W.termToId)(A),z=(0,W.termToId)(z);const N=this._ids,K=this._graphs;let ue,I,O;if(!((y=N[y])&&(x=N[x])&&(A=N[A])&&(ue=K[z])&&(I=ue.subjects[y])&&(O=I[x])&&A in O))return!1;for(y in this._removeFromIndex(ue.subjects,y,x,A),this._removeFromIndex(ue.predicates,x,A,y),this._removeFromIndex(ue.objects,A,y,x),null!==this._size&&this._size--,ue.subjects)return!0;return delete K[z],!0}removeQuads(y){for(let x=0;x<y.length;x++)this.removeQuad(y[x])}remove(y){return y.on("data",x=>{this.removeQuad(x)}),y}removeMatches(y,x,A,z){const N=new j.Readable({objectMode:!0});return N._read=()=>{for(const K of this.readQuads(y,x,A,z))N.push(K);N.push(null)},this.remove(N)}deleteGraph(y){return this.removeMatches(null,null,null,y)}getQuads(y,x,A,z){return[...this.readQuads(y,x,A,z)]}*readQuads(y,x,A,z){y=y&&(0,W.termToId)(y),x=x&&(0,W.termToId)(x),A=A&&(0,W.termToId)(A),z=z&&(0,W.termToId)(z);const N=this._getGraphs(z),K=this._ids;let ue,I,O,X;if(!(R(y)&&!(I=K[y])||R(x)&&!(O=K[x])||R(A)&&!(X=K[A])))for(const E in N)(ue=N[E])&&(I?X?yield*this._findInIndex(ue.objects,X,I,O,"object","subject","predicate",E,null,!0):yield*this._findInIndex(ue.subjects,I,O,null,"subject","predicate","object",E,null,!0):O?yield*this._findInIndex(ue.predicates,O,X,null,"predicate","object","subject",E,null,!0):X?yield*this._findInIndex(ue.objects,X,null,null,"object","subject","predicate",E,null,!0):yield*this._findInIndex(ue.subjects,null,null,null,"subject","predicate","object",E,null,!0))}match(y,x,A,z){return new T(this,y,x,A,z)}countQuads(y,x,A,z){y=y&&(0,W.termToId)(y),x=x&&(0,W.termToId)(x),A=A&&(0,W.termToId)(A),z=z&&(0,W.termToId)(z);const N=this._getGraphs(z),K=this._ids;let I,O,X,E,ue=0;if(R(y)&&!(O=K[y])||R(x)&&!(X=K[x])||R(A)&&!(E=K[A]))return 0;for(const $ in N)(I=N[$])&&(ue+=y?A?this._countInIndex(I.objects,E,O,X):this._countInIndex(I.subjects,O,X,E):x?this._countInIndex(I.predicates,X,E,O):this._countInIndex(I.objects,E,O,X));return ue}forEach(y,x,A,z,N){this.some(K=>(y(K),!1),x,A,z,N)}every(y,x,A,z,N){let K=!1;const ue=!this.some(I=>(K=!0,!y(I)),x,A,z,N);return K&&ue}some(y,x,A,z,N){for(const K of this.readQuads(x,A,z,N))if(y(K))return!0;return!1}getSubjects(y,x,A){const z=[];return this.forSubjects(N=>{z.push(N)},y,x,A),z}forSubjects(y,x,A,z){x=x&&(0,W.termToId)(x),A=A&&(0,W.termToId)(A),z=z&&(0,W.termToId)(z);const N=this._ids,K=this._getGraphs(z);let ue,I,O;if(y=this._uniqueEntities(y),!(R(x)&&!(I=N[x])||R(A)&&!(O=N[A])))for(z in K)(ue=K[z])&&(I?O?this._loopBy2Keys(ue.predicates,I,O,y):this._loopByKey1(ue.subjects,I,y):O?this._loopByKey0(ue.objects,O,y):this._loop(ue.subjects,y))}getPredicates(y,x,A){const z=[];return this.forPredicates(N=>{z.push(N)},y,x,A),z}forPredicates(y,x,A,z){x=x&&(0,W.termToId)(x),A=A&&(0,W.termToId)(A),z=z&&(0,W.termToId)(z);const N=this._ids,K=this._getGraphs(z);let ue,I,O;if(y=this._uniqueEntities(y),!(R(x)&&!(I=N[x])||R(A)&&!(O=N[A])))for(z in K)(ue=K[z])&&(I?O?this._loopBy2Keys(ue.objects,O,I,y):this._loopByKey0(ue.subjects,I,y):O?this._loopByKey1(ue.predicates,O,y):this._loop(ue.predicates,y))}getObjects(y,x,A){const z=[];return this.forObjects(N=>{z.push(N)},y,x,A),z}forObjects(y,x,A,z){x=x&&(0,W.termToId)(x),A=A&&(0,W.termToId)(A),z=z&&(0,W.termToId)(z);const N=this._ids,K=this._getGraphs(z);let ue,I,O;if(y=this._uniqueEntities(y),!(R(x)&&!(I=N[x])||R(A)&&!(O=N[A])))for(z in K)(ue=K[z])&&(I?O?this._loopBy2Keys(ue.subjects,I,O,y):this._loopByKey1(ue.objects,I,y):O?this._loopByKey0(ue.predicates,O,y):this._loop(ue.objects,y))}getGraphs(y,x,A){const z=[];return this.forGraphs(N=>{z.push(N)},y,x,A),z}forGraphs(y,x,A,z){for(const N in this._graphs)this.some(K=>(y(K.graph),!0),x,A,z,N)}createBlankNode(y){let x,A;if(y)for(x=y=`_:${y}`,A=1;this._ids[x];)x=y+A++;else do{x="_:b"+this._blankNodeIndex++}while(this._ids[x]);return this._ids[x]=++this._id,this._entities[this._id]=x,this._factory.blankNode(x.substr(2))}extractLists({remove:y=!1,ignoreErrors:x=!1}={}){const A={},z=x?()=>!0:(ue,I)=>{throw new Error(`${ue.value} ${I}`)},N=this.getQuads(null,F.default.rdf.rest,F.default.rdf.nil,null),K=y?[...N]:[];return N.forEach(ue=>{const I=[];let X,E,O=!1;const $=ue.graph;let Z=ue.subject;for(;Z&&!O;){const ae=this.getQuads(null,null,Z,null),oe=this.getQuads(Z,null,null,null);let te,Ce=null,me=null,ne=null;for(let ye=0;ye<oe.length&&!O;ye++)te=oe[ye],te.graph.equals($)?X?O=z(Z,"has non-list arcs out"):te.predicate.value===F.default.rdf.first?Ce?O=z(Z,"has multiple rdf:first arcs"):K.push(Ce=te):te.predicate.value===F.default.rdf.rest?me?O=z(Z,"has multiple rdf:rest arcs"):K.push(me=te):ae.length?O=z(Z,"can't be subject and object"):(X=te,E="subject"):O=z(Z,"not confined to single graph");for(let ye=0;ye<ae.length&&!O;++ye)te=ae[ye],X?O=z(Z,"can't have coreferences"):te.predicate.value===F.default.rdf.rest?ne?O=z(Z,"has incoming rdf:rest arcs"):ne=te:(X=te,E="object");Ce?I.unshift(Ce.object):O=z(Z,"has no list head"),Z=ne&&ne.subject}O?y=!1:X&&(A[X[E].value]=I)}),y&&this.removeQuads(K),A}*[Symbol.iterator](){yield*this.readQuads()}}function R(v){return"string"==typeof v||v instanceof String}he.default=C;class T extends j.Readable{constructor(y,x,A,z,N){super({objectMode:!0}),Object.assign(this,{n3Store:y,subject:x,predicate:A,object:z,graph:N})}get filtered(){if(!this._filtered){const{n3Store:y,graph:x,object:A,predicate:z,subject:N}=this,K=y.getQuads(N,z,A,x);this._filtered=new C(K,{factory:y._factory})}return this._filtered}get size(){return this.filtered.size}_read(){for(const y of this)this.push(y);this.push(null)}add(y){return this.filtered.add(y)}delete(y){return this.filtered.delete(y)}has(y){return this.filtered.has(y)}match(y,x,A,z){return new T(this.filtered,y,x,A,z)}*[Symbol.iterator](){yield*this._filtered||this.n3Store.readQuads(this.subject,this.predicate,this.object,this.graph)}}},{"./IRIs":34,"./N3DataFactory":35,"readable-stream":81}],39:[function(Y,xe,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.default=void 0;var H,W=(H=Y("./N3Parser"))&&H.__esModule?H:{default:H},j=Y("readable-stream");he.default=class extends j.Transform{constructor(b){let R,T;super({decodeStrings:!0}),this._readableState.objectMode=!0,new W.default(b).parse({on:(v,y)=>{switch(v){case"data":R=y;break;case"end":T=y}}},(v,y)=>{v&&this.emit("error",v)||y&&this.push(y)},(v,y)=>{this.emit("prefix",v,y)}),this._transform=(v,y,x)=>{R(v),x()},this._flush=v=>{T(),v()}}import(b){return b.on("data",C=>{this.write(C)}),b.on("end",()=>{this.end()}),b.on("error",C=>{this.emit("error",C)}),this}}},{"./N3Parser":37,"readable-stream":81}],40:[function(Y,xe,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.default=void 0;var H,W=Y("readable-stream"),j=(H=Y("./N3Writer"))&&H.__esModule?H:{default:H};he.default=class extends W.Transform{constructor(b){super({encoding:"utf8",writableObjectMode:!0});const C=this._writer=new j.default({write:(R,T,v)=>{this.push(R),v&&v()},end:R=>{this.push(null),R&&R()}},b);this._transform=(R,T,v)=>{C.addQuad(R,v)},this._flush=R=>{C.end(R)}}import(b){return b.on("data",C=>{this.write(C)}),b.on("end",()=>{this.end()}),b.on("error",C=>{this.emit("error",C)}),b.on("prefix",(C,R)=>{this._writer.addPrefix(C,R)}),this}}},{"./N3Writer":42,"readable-stream":81}],41:[function(Y,xe,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.inDefaultGraph=function(y){return C(y.graph)},he.isBlankNode=function(y){return!!y&&"BlankNode"===y.termType},he.isDefaultGraph=C,he.isLiteral=function(y){return!!y&&"Literal"===y.termType},he.isNamedNode=function(y){return!!y&&"NamedNode"===y.termType},he.isVariable=function(y){return!!y&&"Variable"===y.termType},he.prefix=function(y,x){return v({"":y.value||y},x)("")},he.prefixes=v;var y,W=(y=Y("./N3DataFactory"))&&y.__esModule?y:{default:y};function C(y){return!!y&&"DefaultGraph"===y.termType}function v(y,x){const A=Object.create(null);for(const N in y)z(N,y[N]);function z(N,K){if("string"==typeof K){const ue=Object.create(null);A[N]=I=>ue[I]||(ue[I]=x.namedNode(K+I))}else if(!(N in A))throw new Error(`Unknown prefix: ${N}`);return A[N]}return x=x||W.default,z}},{"./N3DataFactory":35}],42:[function(Y,xe,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.default=void 0;var ue,W=(ue=Y("./IRIs"))&&ue.__esModule?ue:{default:ue},j=function(ue,I){if(!I&&ue&&ue.__esModule)return ue;if(null===ue||"object"!=typeof ue&&"function"!=typeof ue)return{default:ue};var O=Q(I);if(O&&O.has(ue))return O.get(ue);var X={},E=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var $ in ue)if("default"!==$&&Object.prototype.hasOwnProperty.call(ue,$)){var Z=E?Object.getOwnPropertyDescriptor(ue,$):null;Z&&(Z.get||Z.set)?Object.defineProperty(X,$,Z):X[$]=ue[$]}return X.default=ue,O&&O.set(ue,X),X}(Y("./N3DataFactory")),F=Y("./N3Util");function Q(ue){if("function"!=typeof WeakMap)return null;var I=new WeakMap,O=new WeakMap;return(Q=function(X){return X?O:I})(ue)}const C=j.default.defaultGraph(),{rdf:R,xsd:T}=W.default,v=/["\\\t\n\r\b\f\u0000-\u0019\ud800-\udbff]/,y=/["\\\t\n\r\b\f\u0000-\u0019]|[\ud800-\udbff][\udc00-\udfff]/g,x={"\\":"\\\\",'"':'\\"',"\t":"\\t","\n":"\\n","\r":"\\r","\b":"\\b","\f":"\\f"};class A extends j.Term{equals(){return!1}}function N(ue){let I=x[ue];return void 0===I&&(1===ue.length?(I=ue.charCodeAt(0).toString(16),I="\\u0000".substr(0,6-I.length)+I):(I=(1024*(ue.charCodeAt(0)-55296)+ue.charCodeAt(1)+9216).toString(16),I="\\U00000000".substr(0,10-I.length)+I)),I}function K(ue){return ue.replace(/[\]\/\(\)\*\+\?\.\\\$]/g,"\\$&")}he.default=class{constructor(I,O){if(this._prefixRegex=/$0^/,I&&"function"!=typeof I.write&&(O=I,I=null),this._lists=(O=O||{}).lists,I)this._outputStream=I,this._endStream=void 0===O.end||!!O.end;else{let X="";this._outputStream={write(E,$,Z){X+=E,Z&&Z()},end:E=>{E&&E(null,X)}},this._endStream=!0}this._subject=null,/triple|quad/i.test(O.format)?(this._lineMode=!0,this._writeQuad=this._writeQuadLine):(this._lineMode=!1,this._graph=C,this._prefixIRIs=Object.create(null),O.prefixes&&this.addPrefixes(O.prefixes),O.baseIRI&&(this._baseMatcher=new RegExp(`^${K(O.baseIRI)}${O.baseIRI.endsWith("/")?"":"[#?]"}`),this._baseLength=O.baseIRI.length))}get _inDefaultGraph(){return C.equals(this._graph)}_write(I,O){this._outputStream.write(I,"utf8",O)}_writeQuad(I,O,X,E,$){try{E.equals(this._graph)||(this._write((null===this._subject?"":this._inDefaultGraph?".\n":"\n}\n")+(C.equals(E)?"":`${this._encodeIriOrBlank(E)} {\n`)),this._graph=E,this._subject=null),I.equals(this._subject)?O.equals(this._predicate)?this._write(`, ${this._encodeObject(X)}`,$):this._write(`;\n    ${this._encodePredicate(this._predicate=O)} ${this._encodeObject(X)}`,$):this._write(`${(null===this._subject?"":".\n")+this._encodeSubject(this._subject=I)} ${this._encodePredicate(this._predicate=O)} ${this._encodeObject(X)}`,$)}catch(Z){$&&$(Z)}}_writeQuadLine(I,O,X,E,$){delete this._prefixMatch,this._write(this.quadToString(I,O,X,E),$)}quadToString(I,O,X,E){return`${this._encodeSubject(I)} ${this._encodeIriOrBlank(O)} ${this._encodeObject(X)}${E&&E.value?` ${this._encodeIriOrBlank(E)} .\n`:" .\n"}`}quadsToString(I){return I.map(O=>this.quadToString(O.subject,O.predicate,O.object,O.graph)).join("")}_encodeSubject(I){return"Quad"===I.termType?this._encodeQuad(I):this._encodeIriOrBlank(I)}_encodeIriOrBlank(I){if("NamedNode"!==I.termType)return this._lists&&I.value in this._lists&&(I=this.list(this._lists[I.value])),"id"in I?I.id:`_:${I.value}`;let O=I.value;this._baseMatcher&&this._baseMatcher.test(O)&&(O=O.substr(this._baseLength)),v.test(O)&&(O=O.replace(y,N));const X=this._prefixRegex.exec(O);return X?X[1]?this._prefixIRIs[X[1]]+X[2]:O:`<${O}>`}_encodeLiteral(I){let O=I.value;if(v.test(O)&&(O=O.replace(y,N)),I.language)return`"${O}"@${I.language}`;if(this._lineMode){if(I.datatype.value===T.string)return`"${O}"`}else switch(I.datatype.value){case T.string:return`"${O}"`;case T.boolean:if("true"===O||"false"===O)return O;break;case T.integer:if(/^[+-]?\d+$/.test(O))return O;break;case T.decimal:if(/^[+-]?\d*\.\d+$/.test(O))return O;break;case T.double:if(/^[+-]?(?:\d+\.\d*|\.?\d+)[eE][+-]?\d+$/.test(O))return O}return`"${O}"^^${this._encodeIriOrBlank(I.datatype)}`}_encodePredicate(I){return I.value===R.type?"a":this._encodeIriOrBlank(I)}_encodeObject(I){switch(I.termType){case"Quad":return this._encodeQuad(I);case"Literal":return this._encodeLiteral(I);default:return this._encodeIriOrBlank(I)}}_encodeQuad({subject:I,predicate:O,object:X,graph:E}){return`<<${this._encodeSubject(I)} ${this._encodePredicate(O)} ${this._encodeObject(X)}${(0,F.isDefaultGraph)(E)?"":` ${this._encodeIriOrBlank(E)}`}>>`}_blockedWrite(){throw new Error("Cannot write because the writer has been closed.")}addQuad(I,O,X,E,$){void 0===X?this._writeQuad(I.subject,I.predicate,I.object,I.graph,O):"function"==typeof E?this._writeQuad(I,O,X,C,E):this._writeQuad(I,O,X,E||C,$)}addQuads(I){for(let O=0;O<I.length;O++)this.addQuad(I[O])}addPrefix(I,O,X){const E={};E[I]=O,this.addPrefixes(E,X)}addPrefixes(I,O){if(!this._prefixIRIs)return O&&O();let X=!1;for(let E in I){let $=I[E];"string"!=typeof $&&($=$.value),X=!0,null!==this._subject&&(this._write(this._inDefaultGraph?".\n":"\n}\n"),this._subject=null,this._graph=""),this._prefixIRIs[$]=E+=":",this._write(`@prefix ${E} <${$}>.\n`)}if(X){let E="",$="";for(const Z in this._prefixIRIs)E+=E?`|${Z}`:Z,$+=($?"|":"")+this._prefixIRIs[Z];E=K(E),this._prefixRegex=new RegExp(`^(?:${$})[^/]*$|^(${E})([a-zA-Z][\\-_a-zA-Z0-9]*)$`)}this._write(X?"\n":"",O)}blank(I,O){let E,$,X=I;switch(void 0===I?X=[]:I.termType?X=[{predicate:I,object:O}]:"length"in I||(X=[I]),$=X.length){case 0:return new A("[]");case 1:if(E=X[0],!(E.object instanceof A))return new A(`[ ${this._encodePredicate(E.predicate)} ${this._encodeObject(E.object)} ]`);default:let Z="[";for(let ae=0;ae<$;ae++)E=X[ae],E.predicate.equals(I)?Z+=`, ${this._encodeObject(E.object)}`:(Z+=`${(ae?";\n  ":"\n  ")+this._encodePredicate(E.predicate)} ${this._encodeObject(E.object)}`,I=E.predicate);return new A(`${Z}\n]`)}}list(I){const O=I&&I.length||0,X=new Array(O);for(let E=0;E<O;E++)X[E]=this._encodeObject(I[E]);return new A(`(${X.join(" ")})`)}end(I){null!==this._subject&&(this._write(this._inDefaultGraph?".\n":"\n}\n"),this._subject=null),this._write=this._blockedWrite;let O=I&&((X,E)=>{O=null,I(X,E)});if(this._endStream)try{return this._outputStream.end(O)}catch(X){}O&&O()}}},{"./IRIs":34,"./N3DataFactory":35,"./N3Util":41}],43:[function(Y,xe,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),Object.defineProperty(he,"BlankNode",{enumerable:!0,get:function(){return R.BlankNode}}),Object.defineProperty(he,"DataFactory",{enumerable:!0,get:function(){return R.default}}),Object.defineProperty(he,"DefaultGraph",{enumerable:!0,get:function(){return R.DefaultGraph}}),Object.defineProperty(he,"Lexer",{enumerable:!0,get:function(){return W.default}}),Object.defineProperty(he,"Literal",{enumerable:!0,get:function(){return R.Literal}}),Object.defineProperty(he,"NamedNode",{enumerable:!0,get:function(){return R.NamedNode}}),Object.defineProperty(he,"Parser",{enumerable:!0,get:function(){return j.default}}),Object.defineProperty(he,"Quad",{enumerable:!0,get:function(){return R.Quad}}),Object.defineProperty(he,"Store",{enumerable:!0,get:function(){return Q.default}}),Object.defineProperty(he,"StreamParser",{enumerable:!0,get:function(){return H.default}}),Object.defineProperty(he,"StreamWriter",{enumerable:!0,get:function(){return b.default}}),Object.defineProperty(he,"Term",{enumerable:!0,get:function(){return R.Term}}),Object.defineProperty(he,"Triple",{enumerable:!0,get:function(){return R.Triple}}),he.Util=void 0,Object.defineProperty(he,"Variable",{enumerable:!0,get:function(){return R.Variable}}),Object.defineProperty(he,"Writer",{enumerable:!0,get:function(){return F.default}}),he.default=void 0,Object.defineProperty(he,"termFromId",{enumerable:!0,get:function(){return R.termFromId}}),Object.defineProperty(he,"termToId",{enumerable:!0,get:function(){return R.termToId}});var W=y(Y("./N3Lexer")),j=y(Y("./N3Parser")),F=y(Y("./N3Writer")),Q=y(Y("./N3Store")),H=y(Y("./N3StreamParser")),b=y(Y("./N3StreamWriter")),C=v(Y("./N3Util"));he.Util=C;var R=v(Y("./N3DataFactory"));function T(A){if("function"!=typeof WeakMap)return null;var z=new WeakMap,N=new WeakMap;return(T=function(K){return K?N:z})(A)}function v(A,z){if(!z&&A&&A.__esModule)return A;if(null===A||"object"!=typeof A&&"function"!=typeof A)return{default:A};var N=T(z);if(N&&N.has(A))return N.get(A);var K={},ue=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var I in A)if("default"!==I&&Object.prototype.hasOwnProperty.call(A,I)){var O=ue?Object.getOwnPropertyDescriptor(A,I):null;O&&(O.get||O.set)?Object.defineProperty(K,I,O):K[I]=A[I]}return K.default=A,N&&N.set(A,K),K}function y(A){return A&&A.__esModule?A:{default:A}}he.default={Lexer:W.default,Parser:j.default,Writer:F.default,Store:Q.default,StreamParser:H.default,StreamWriter:b.default,Util:C,DataFactory:R.default,Term:R.Term,NamedNode:R.NamedNode,Literal:R.Literal,BlankNode:R.BlankNode,Variable:R.Variable,DefaultGraph:R.DefaultGraph,Quad:R.Quad,Triple:R.Triple,termFromId:R.termFromId,termToId:R.termToId}},{"./N3DataFactory":35,"./N3Lexer":36,"./N3Parser":37,"./N3Store":38,"./N3StreamParser":39,"./N3StreamWriter":40,"./N3Util":41,"./N3Writer":42}],44:[function(Y,xe,he){var j,F,W=xe.exports={};function Q(){throw new Error("setTimeout has not been defined")}function H(){throw new Error("clearTimeout has not been defined")}function b(K){if(j===setTimeout)return setTimeout(K,0);if((j===Q||!j)&&setTimeout)return j=setTimeout,setTimeout(K,0);try{return j(K,0)}catch(ue){try{return j.call(null,K,0)}catch(I){return j.call(this,K,0)}}}!function(){try{j="function"==typeof setTimeout?setTimeout:Q}catch(K){j=Q}try{F="function"==typeof clearTimeout?clearTimeout:H}catch(K){F=H}}();var v,R=[],T=!1,y=-1;function x(){!T||!v||(T=!1,v.length?R=v.concat(R):y=-1,R.length&&A())}function A(){if(!T){var K=b(x);T=!0;for(var ue=R.length;ue;){for(v=R,R=[];++y<ue;)v&&v[y].run();y=-1,ue=R.length}v=null,T=!1,function(K){if(F===clearTimeout)return clearTimeout(K);if((F===H||!F)&&clearTimeout)return F=clearTimeout,clearTimeout(K);try{F(K)}catch(ue){try{return F.call(null,K)}catch(I){return F.call(this,K)}}}(K)}}function z(K,ue){this.fun=K,this.array=ue}function N(){}W.nextTick=function(K){var ue=new Array(arguments.length-1);if(arguments.length>1)for(var I=1;I<arguments.length;I++)ue[I-1]=arguments[I];R.push(new z(K,ue)),1===R.length&&!T&&b(A)},z.prototype.run=function(){this.fun.apply(null,this.array)},W.title="browser",W.browser=!0,W.env={},W.argv=[],W.version="",W.versions={},W.on=N,W.addListener=N,W.once=N,W.off=N,W.removeListener=N,W.removeAllListeners=N,W.emit=N,W.prependListener=N,W.prependOnceListener=N,W.listeners=function(K){return[]},W.binding=function(K){throw new Error("process.binding is not supported")},W.cwd=function(){return"/"},W.chdir=function(K){throw new Error("process.chdir is not supported")},W.umask=function(){return 0}},{}],45:[function(Y,xe,he){(function(W){(function(){let j;xe.exports="function"==typeof queueMicrotask?queueMicrotask.bind("undefined"!=typeof window?window:W):F=>(j||(j=Promise.resolve())).then(F).catch(Q=>setTimeout(()=>{throw Q},0))}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],46:[function(Y,xe,he){xe.exports=Y("./lib")},{"./lib":55}],47:[function(Y,xe,he){"use strict";xe.exports=class X9{constructor(j,F=new Map,Q=0){this.prefix=j,this._existing=F,this.counter=Q}clone(){const{prefix:j,_existing:F,counter:Q}=this;return new X9(j,new Map(F),Q)}getId(j){const F=j&&this._existing.get(j);if(F)return F;const Q=this.prefix+this.counter;return this.counter++,j&&this._existing.set(j,Q),Q}hasId(j){return this._existing.has(j)}getOldIds(){return[...this._existing.keys()]}}},{}],48:[function(Y,xe,he){"use strict";Y("setimmediate");const W=self.crypto||self.msCrypto;xe.exports=class{constructor(F){if(!W||!W.subtle)throw new Error("crypto.subtle not found.");if("sha256"===F)this.algorithm={name:"SHA-256"};else{if("sha1"!==F)throw new Error(`Unsupport algorithm "${F}".`);this.algorithm={name:"SHA-1"}}this._content=""}update(F){this._content+=F}digest(){var F=this;return yt(function*(){const Q=(new TextEncoder).encode(F._content),H=new Uint8Array(yield W.subtle.digest(F.algorithm,Q));let b="";for(let C=0;C<H.length;++C)b+=H[C].toString(16).padStart(2,"0");return b})()}}},{setimmediate:86}],49:[function(Y,xe,he){"use strict";const F="http://www.w3.org/1999/02/22-rdf-syntax-ns#langString",Q="http://www.w3.org/2001/XMLSchema#string",H="NamedNode",b="BlankNode",C="Literal",R="DefaultGraph",T={};function v(N,K){return N.subject.termType===K.subject.termType&&N.object.termType===K.object.termType&&N.subject.value===K.subject.value&&N.predicate.value===K.predicate.value&&N.object.value===K.object.value&&(N.object.termType!==C||N.object.datatype.termType===K.object.datatype.termType&&N.object.language===K.object.language&&N.object.datatype.value===K.object.datatype.value)}T.eoln=/(?:\r\n)|(?:\n)|(?:\r)/g,T.empty=new RegExp("^[ \\t]*$"),T.quad=new RegExp('^[ \\t]*(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9])(?:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040.])*(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040]))?))[ \\t]+(?:<([^:]+:[^>]*)>)[ \\t]+(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9])(?:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040.])*(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040]))?)|(?:"([^"\\\\]*(?:\\\\.[^"\\\\]*)*)"(?:(?:\\^\\^(?:<([^:]+:[^>]*)>))|(?:@([a-zA-Z]+(?:-[a-zA-Z0-9]+)*)))?))[ \\t]*(?:\\.|(?:(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9])(?:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040.])*(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040]))?))[ \\t]*\\.))[ \\t]*$'),xe.exports=class LF{static parse(K){const ue=[],I={},O=K.split(T.eoln);let X=0;for(const E of O){if(X++,T.empty.test(E))continue;const $=E.match(T.quad);if(null===$)throw new Error("N-Quads parse error on line "+X+".");const Z={subject:null,predicate:null,object:null,graph:null};if(Z.subject=void 0!==$[1]?{termType:H,value:$[1]}:{termType:b,value:$[2]},Z.predicate={termType:H,value:$[3]},void 0!==$[4]?Z.object={termType:H,value:$[4]}:void 0!==$[5]?Z.object={termType:b,value:$[5]}:(Z.object={termType:C,value:void 0,datatype:{termType:H}},void 0!==$[7]?Z.object.datatype.value=$[7]:void 0!==$[8]?(Z.object.datatype.value=F,Z.object.language=$[8]):Z.object.datatype.value=Q,Z.object.value=$[6].replace(A,function(K,ue,I,O){if(ue)switch(ue){case"t":return"\t";case"b":return"\b";case"n":return"\n";case"r":return"\r";case"f":return"\f";case'"':return'"';case"'":return"'";case"\\":return"\\"}if(I)return String.fromCharCode(parseInt(I,16));if(O)throw new Error("Unsupported U escape")})),Z.graph=void 0!==$[9]?{termType:H,value:$[9]}:void 0!==$[10]?{termType:b,value:$[10]}:{termType:R,value:""},Z.graph.value in I){let ae=!0;const oe=I[Z.graph.value];for(const te of oe)if(v(te,Z)){ae=!1;break}ae&&(oe.push(Z),ue.push(Z))}else I[Z.graph.value]=[Z],ue.push(Z)}return ue}static serialize(K){Array.isArray(K)||(K=LF.legacyDatasetToQuads(K));const ue=[];for(const I of K)ue.push(LF.serializeQuad(I));return ue.sort().join("")}static serializeQuad(K){const ue=K.subject,O=K.object,X=K.graph;let E="";return E+=ue.termType===H?`<${ue.value}>`:`${ue.value}`,E+=` <${K.predicate.value}> `,O.termType===H?E+=`<${O.value}>`:O.termType===b?E+=O.value:(E+=`"${N=O.value,N.replace(y,function(K){switch(K){case'"':return'\\"';case"\\":return"\\\\";case"\n":return"\\n";case"\r":return"\\r"}})}"`,O.datatype.value===F?O.language&&(E+=`@${O.language}`):O.datatype.value!==Q&&(E+=`^^<${O.datatype.value}>`)),X.termType===H?E+=` <${X.value}>`:X.termType===b&&(E+=` ${X.value}`),E+=" .\n",E;var N}static legacyDatasetToQuads(K){const ue=[],I={"blank node":b,IRI:H,literal:C};for(const O in K)K[O].forEach(E=>{const $={};for(const Z in E){const ae=E[Z],oe={termType:I[ae.type],value:ae.value};oe.termType===C&&(oe.datatype={termType:H},"datatype"in ae&&(oe.datatype.value=ae.datatype),"language"in ae?("datatype"in ae||(oe.datatype.value=F),oe.language=ae.language):"datatype"in ae||(oe.datatype.value=Q)),$[Z]=oe}$.graph="@default"===O?{termType:R,value:""}:{termType:O.startsWith("_:")?b:H,value:O},ue.push($)});return ue}};const y=/["\\\n\r]/g;const A=/(?:\\([tbnrf"'\\]))|(?:\\u([0-9A-Fa-f]{4}))|(?:\\U([0-9A-Fa-f]{8}))/g},{}],50:[function(Y,xe,he){"use strict";xe.exports=class{constructor(j){this.current=j.sort(),this.done=!1,this.dir=new Map;for(let F=0;F<j.length;++F)this.dir.set(j[F],!0)}hasNext(){return!this.done}next(){const{current:j,dir:F}=this,Q=j.slice();let H=null,b=0;const C=j.length;for(let R=0;R<C;++R){const T=j[R],v=F.get(T);(null===H||T>H)&&(v&&R>0&&T>j[R-1]||!v&&R<C-1&&T>j[R+1])&&(H=T,b=R)}if(null===H)this.done=!0;else{const R=F.get(H)?b-1:b+1;j[b]=j[R],j[R]=H;for(const T of j)T>H&&F.set(T,!F.get(T))}return Q}}},{}],51:[function(Y,xe,he){(function(W){(function(){"use strict";const j=Y("./IdentifierIssuer"),F=Y("./MessageDigest"),Q=Y("./Permuter"),H=Y("./NQuads");function b(C,R){return C.hash<R.hash?-1:C.hash>R.hash?1:0}xe.exports=class{constructor(){this.name="URDNA2015",this.blankNodeInfo=new Map,this.canonicalIssuer=new j("_:c14n"),this.hashAlgorithm="sha256",this.quads=null}main(R){var T=this;return yt(function*(){T.quads=R;for(const K of R)T._addBlankNodeQuadInfo({quad:K,component:K.subject}),T._addBlankNodeQuadInfo({quad:K,component:K.object}),T._addBlankNodeQuadInfo({quad:K,component:K.graph});const v=new Map,y=[...T.blankNodeInfo.keys()];let x=0;for(const K of y)++x%100==0&&(yield T._yield()),yield T._hashAndTrackBlankNode({id:K,hashToBlankNodes:v});const A=[...v.keys()].sort(),z=[];for(const K of A){const ue=v.get(K);ue.length>1?z.push(ue):T.canonicalIssuer.getId(ue[0])}for(const K of z){const ue=[];for(const I of K){if(T.canonicalIssuer.hasId(I))continue;const O=new j("_:b");O.getId(I);const X=yield T.hashNDegreeQuads(I,O);ue.push(X)}ue.sort(b);for(const I of ue){const O=I.issuer.getOldIds();for(const X of O)T.canonicalIssuer.getId(X)}}const N=[];for(const K of T.quads){const ue=ot({},K);ue.subject=T._useCanonicalId({component:ue.subject}),ue.object=T._useCanonicalId({component:ue.object}),ue.graph=T._useCanonicalId({component:ue.graph}),N.push(H.serializeQuad(ue))}return N.sort(),N.join("")})()}hashFirstDegreeQuads(R){var T=this;return yt(function*(){const v=[],y=T.blankNodeInfo.get(R),x=y.quads;for(const z of x){const N={subject:null,predicate:z.predicate,object:null,graph:null};N.subject=T.modifyFirstDegreeComponent(R,z.subject,"subject"),N.object=T.modifyFirstDegreeComponent(R,z.object,"object"),N.graph=T.modifyFirstDegreeComponent(R,z.graph,"graph"),v.push(H.serializeQuad(N))}v.sort();const A=new F(T.hashAlgorithm);for(const z of v)A.update(z);return y.hash=yield A.digest(),y.hash})()}hashRelatedBlankNode(R,T,v,y){var x=this;return yt(function*(){let A;A=x.canonicalIssuer.hasId(R)?x.canonicalIssuer.getId(R):v.hasId(R)?v.getId(R):x.blankNodeInfo.get(R).hash;const z=new F(x.hashAlgorithm);return z.update(y),"g"!==y&&z.update(x.getRelatedPredicate(T)),z.update(A),z.digest()})()}hashNDegreeQuads(R,T){var v=this;return yt(function*(){const y=new F(v.hashAlgorithm),x=yield v.createHashToRelated(R,T),A=[...x.keys()].sort();for(const z of A){y.update(z);let K,N="";const ue=new Q(x.get(z));let I=0;for(;ue.hasNext();){const O=ue.next();++I%3==0&&(yield v._yield());let X=T.clone(),E="";const $=[];let Z=!1;for(const ae of O)if(v.canonicalIssuer.hasId(ae)?E+=v.canonicalIssuer.getId(ae):(X.hasId(ae)||$.push(ae),E+=X.getId(ae)),0!==N.length&&E>N){Z=!0;break}if(!Z){for(const ae of $){const oe=yield v.hashNDegreeQuads(ae,X);if(E+=X.getId(ae),E+=`<${oe.hash}>`,X=oe.issuer,0!==N.length&&E>N){Z=!0;break}}Z||(0===N.length||E<N)&&(N=E,K=X)}}y.update(N),T=K}return{hash:yield y.digest(),issuer:T}})()}modifyFirstDegreeComponent(R,T){return"BlankNode"!==T.termType?T:{termType:"BlankNode",value:T.value===R?"_:a":"_:z"}}getRelatedPredicate(R){return`<${R.predicate.value}>`}createHashToRelated(R,T){var v=this;return yt(function*(){const y=new Map,x=v.blankNodeInfo.get(R).quads;let A=0;for(const z of x)++A%100==0&&(yield v._yield()),yield Promise.all([v._addRelatedBlankNodeHash({quad:z,component:z.subject,position:"s",id:R,issuer:T,hashToRelated:y}),v._addRelatedBlankNodeHash({quad:z,component:z.object,position:"o",id:R,issuer:T,hashToRelated:y}),v._addRelatedBlankNodeHash({quad:z,component:z.graph,position:"g",id:R,issuer:T,hashToRelated:y})]);return y})()}_hashAndTrackBlankNode({id:R,hashToBlankNodes:T}){var v=this;return yt(function*(){const y=yield v.hashFirstDegreeQuads(R),x=T.get(y);x?x.push(R):T.set(y,[R])})()}_addBlankNodeQuadInfo({quad:R,component:T}){if("BlankNode"!==T.termType)return;const v=T.value,y=this.blankNodeInfo.get(v);y?y.quads.add(R):this.blankNodeInfo.set(v,{quads:new Set([R]),hash:null})}_addRelatedBlankNodeHash({quad:R,component:T,position:v,id:y,issuer:x,hashToRelated:A}){var z=this;return yt(function*(){if("BlankNode"!==T.termType||T.value===y)return;const N=T.value,K=yield z.hashRelatedBlankNode(N,R,x,v),ue=A.get(K);ue?ue.push(N):A.set(K,[N])})()}_useCanonicalId({component:R}){return"BlankNode"!==R.termType||R.value.startsWith(this.canonicalIssuer.prefix)?R:{termType:"BlankNode",value:this.canonicalIssuer.getId(R.value)}}_yield(){return yt(function*(){return new Promise(R=>W(R))})()}}}).call(this)}).call(this,Y("timers").setImmediate)},{"./IdentifierIssuer":47,"./MessageDigest":48,"./NQuads":49,"./Permuter":50,timers:89}],52:[function(Y,xe,he){"use strict";const W=Y("./IdentifierIssuer"),j=Y("./MessageDigest"),F=Y("./Permuter"),Q=Y("./NQuads");function H(b,C){return b.hash<C.hash?-1:b.hash>C.hash?1:0}xe.exports=class{constructor(){this.name="URDNA2015",this.blankNodeInfo=new Map,this.canonicalIssuer=new W("_:c14n"),this.hashAlgorithm="sha256",this.quads=null}main(C){this.quads=C;for(const A of C)this._addBlankNodeQuadInfo({quad:A,component:A.subject}),this._addBlankNodeQuadInfo({quad:A,component:A.object}),this._addBlankNodeQuadInfo({quad:A,component:A.graph});const R=new Map,T=[...this.blankNodeInfo.keys()];for(const A of T)this._hashAndTrackBlankNode({id:A,hashToBlankNodes:R});const v=[...R.keys()].sort(),y=[];for(const A of v){const z=R.get(A);z.length>1?y.push(z):this.canonicalIssuer.getId(z[0])}for(const A of y){const z=[];for(const N of A){if(this.canonicalIssuer.hasId(N))continue;const K=new W("_:b");K.getId(N);const ue=this.hashNDegreeQuads(N,K);z.push(ue)}z.sort(H);for(const N of z){const K=N.issuer.getOldIds();for(const ue of K)this.canonicalIssuer.getId(ue)}}const x=[];for(const A of this.quads){const z=ot({},A);z.subject=this._useCanonicalId({component:z.subject}),z.object=this._useCanonicalId({component:z.object}),z.graph=this._useCanonicalId({component:z.graph}),x.push(Q.serializeQuad(z))}return x.sort(),x.join("")}hashFirstDegreeQuads(C){const R=[],T=this.blankNodeInfo.get(C),v=T.quads;for(const x of v){const A={subject:null,predicate:x.predicate,object:null,graph:null};A.subject=this.modifyFirstDegreeComponent(C,x.subject,"subject"),A.object=this.modifyFirstDegreeComponent(C,x.object,"object"),A.graph=this.modifyFirstDegreeComponent(C,x.graph,"graph"),R.push(Q.serializeQuad(A))}R.sort();const y=new j(this.hashAlgorithm);for(const x of R)y.update(x);return T.hash=y.digest(),T.hash}hashRelatedBlankNode(C,R,T,v){let y;y=this.canonicalIssuer.hasId(C)?this.canonicalIssuer.getId(C):T.hasId(C)?T.getId(C):this.blankNodeInfo.get(C).hash;const x=new j(this.hashAlgorithm);return x.update(v),"g"!==v&&x.update(this.getRelatedPredicate(R)),x.update(y),x.digest()}hashNDegreeQuads(C,R){const T=new j(this.hashAlgorithm),v=this.createHashToRelated(C,R),y=[...v.keys()].sort();for(const x of y){T.update(x);let z,A="";const N=new F(v.get(x));for(;N.hasNext();){const K=N.next();let ue=R.clone(),I="";const O=[];let X=!1;for(const E of K)if(this.canonicalIssuer.hasId(E)?I+=this.canonicalIssuer.getId(E):(ue.hasId(E)||O.push(E),I+=ue.getId(E)),0!==A.length&&I>A){X=!0;break}if(!X){for(const E of O){const $=this.hashNDegreeQuads(E,ue);if(I+=ue.getId(E),I+=`<${$.hash}>`,ue=$.issuer,0!==A.length&&I>A){X=!0;break}}X||(0===A.length||I<A)&&(A=I,z=ue)}}T.update(A),R=z}return{hash:T.digest(),issuer:R}}modifyFirstDegreeComponent(C,R){return"BlankNode"!==R.termType?R:{termType:"BlankNode",value:R.value===C?"_:a":"_:z"}}getRelatedPredicate(C){return`<${C.predicate.value}>`}createHashToRelated(C,R){const T=new Map,v=this.blankNodeInfo.get(C).quads;for(const y of v)this._addRelatedBlankNodeHash({quad:y,component:y.subject,position:"s",id:C,issuer:R,hashToRelated:T}),this._addRelatedBlankNodeHash({quad:y,component:y.object,position:"o",id:C,issuer:R,hashToRelated:T}),this._addRelatedBlankNodeHash({quad:y,component:y.graph,position:"g",id:C,issuer:R,hashToRelated:T});return T}_hashAndTrackBlankNode({id:C,hashToBlankNodes:R}){const T=this.hashFirstDegreeQuads(C),v=R.get(T);v?v.push(C):R.set(T,[C])}_addBlankNodeQuadInfo({quad:C,component:R}){if("BlankNode"!==R.termType)return;const T=R.value,v=this.blankNodeInfo.get(T);v?v.quads.add(C):this.blankNodeInfo.set(T,{quads:new Set([C]),hash:null})}_addRelatedBlankNodeHash({quad:C,component:R,position:T,id:v,issuer:y,hashToRelated:x}){if("BlankNode"!==R.termType||R.value===v)return;const A=R.value,z=this.hashRelatedBlankNode(A,C,y,T),N=x.get(z);N?N.push(A):x.set(z,[A])}_useCanonicalId({component:C}){return"BlankNode"!==C.termType||C.value.startsWith(this.canonicalIssuer.prefix)?C:{termType:"BlankNode",value:this.canonicalIssuer.getId(C.value)}}}},{"./IdentifierIssuer":47,"./MessageDigest":48,"./NQuads":49,"./Permuter":50}],53:[function(Y,xe,he){"use strict";const W=Y("./URDNA2015");xe.exports=class extends W{constructor(){super(),this.name="URGNA2012",this.hashAlgorithm="sha1"}modifyFirstDegreeComponent(F,Q,H){return"BlankNode"!==Q.termType?Q:"graph"===H?{termType:"BlankNode",value:"_:g"}:{termType:"BlankNode",value:Q.value===F?"_:a":"_:z"}}getRelatedPredicate(F){return F.predicate.value}createHashToRelated(F,Q){var H=this;return yt(function*(){const b=new Map,C=H.blankNodeInfo.get(F).quads;let R=0;for(const T of C){let v,y;if("BlankNode"===T.subject.termType&&T.subject.value!==F)y=T.subject.value,v="p";else{if("BlankNode"!==T.object.termType||T.object.value===F)continue;y=T.object.value,v="r"}++R%100==0&&(yield H._yield());const x=yield H.hashRelatedBlankNode(y,T,Q,v),A=b.get(x);A?A.push(y):b.set(x,[y])}return b})()}}},{"./URDNA2015":51}],54:[function(Y,xe,he){"use strict";const W=Y("./URDNA2015Sync");xe.exports=class extends W{constructor(){super(),this.name="URGNA2012",this.hashAlgorithm="sha1"}modifyFirstDegreeComponent(F,Q,H){return"BlankNode"!==Q.termType?Q:"graph"===H?{termType:"BlankNode",value:"_:g"}:{termType:"BlankNode",value:Q.value===F?"_:a":"_:z"}}getRelatedPredicate(F){return F.predicate.value}createHashToRelated(F,Q){const H=new Map,b=this.blankNodeInfo.get(F).quads;for(const C of b){let R,T;if("BlankNode"===C.subject.termType&&C.subject.value!==F)T=C.subject.value,R="p";else{if("BlankNode"!==C.object.termType||C.object.value===F)continue;T=C.object.value,R="r"}const v=this.hashRelatedBlankNode(T,C,Q,R),y=H.get(v);y?y.push(T):H.set(v,[T])}return H}}},{"./URDNA2015Sync":52}],55:[function(Y,xe,he){"use strict";const W=Y("./URDNA2015"),j=Y("./URGNA2012"),F=Y("./URDNA2015Sync"),Q=Y("./URGNA2012Sync");let H;try{H=Y("rdf-canonize-native")}catch(C){}const b={};xe.exports=b,b.NQuads=Y("./NQuads"),b.IdentifierIssuer=Y("./IdentifierIssuer"),b._rdfCanonizeNative=function(C){return C&&(H=C),H},b.canonize=function(){var C=yt(function*(R,T){if(Array.isArray(R)||(R=b.NQuads.legacyDatasetToQuads(R)),T.useNative){if(!H)throw new Error("rdf-canonize-native not available");return new Promise((v,y)=>H.canonize(R,T,(x,A)=>x?y(x):v(A)))}if("URDNA2015"===T.algorithm)return new W(T).main(R);if("URGNA2012"===T.algorithm)return new j(T).main(R);throw"algorithm"in T?new Error("Invalid RDF Dataset Canonicalization algorithm: "+T.algorithm):new Error("No RDF Dataset Canonicalization algorithm specified.")});return function(R,T){return C.apply(this,arguments)}}(),b._canonizeSync=function(C,R){if(Array.isArray(C)||(C=b.NQuads.legacyDatasetToQuads(C)),R.useNative){if(H)return H.canonizeSync(C,R);throw new Error("rdf-canonize-native not available")}if("URDNA2015"===R.algorithm)return new F(R).main(C);if("URGNA2012"===R.algorithm)return new Q(R).main(C);throw"algorithm"in R?new Error("Invalid RDF Dataset Canonicalization algorithm: "+R.algorithm):new Error("No RDF Dataset Canonicalization algorithm specified.")}},{"./IdentifierIssuer":47,"./NQuads":49,"./URDNA2015":51,"./URDNA2015Sync":52,"./URGNA2012":53,"./URGNA2012Sync":54,"rdf-canonize-native":3}],56:[function(Y,xe,he){"use strict";var W=this&&this.__createBinding||(Object.create?function(F,Q,H,b){void 0===b&&(b=H),Object.defineProperty(F,b,{enumerable:!0,get:function(){return Q[H]}})}:function(F,Q,H,b){void 0===b&&(b=H),F[b]=Q[H]}),j=this&&this.__exportStar||function(F,Q){for(var H in F)"default"!==H&&!Object.prototype.hasOwnProperty.call(Q,H)&&W(Q,F,H)};Object.defineProperty(he,"__esModule",{value:!0}),j(Y("./lib/BlankNode"),he),j(Y("./lib/DataFactory"),he),j(Y("./lib/DefaultGraph"),he),j(Y("./lib/Literal"),he),j(Y("./lib/NamedNode"),he),j(Y("./lib/Quad"),he),j(Y("./lib/Variable"),he)},{"./lib/BlankNode":57,"./lib/DataFactory":58,"./lib/DefaultGraph":59,"./lib/Literal":60,"./lib/NamedNode":61,"./lib/Quad":62,"./lib/Variable":63}],57:[function(Y,xe,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.BlankNode=void 0;he.BlankNode=class{constructor(F){this.termType="BlankNode",this.value=F}equals(F){return!!F&&"BlankNode"===F.termType&&F.value===this.value}}},{}],58:[function(Y,xe,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.DataFactory=void 0;const W=Y("./BlankNode"),j=Y("./DefaultGraph"),F=Y("./Literal"),Q=Y("./NamedNode"),H=Y("./Quad"),b=Y("./Variable");let C=0;he.DataFactory=class{constructor(v){this.blankNodeCounter=0,this.blankNodePrefix=(v=v||{}).blankNodePrefix||`df_${C++}_`}namedNode(v){return new Q.NamedNode(v)}blankNode(v){return new W.BlankNode(v||`${this.blankNodePrefix}${this.blankNodeCounter++}`)}literal(v,y){return new F.Literal(v,y)}variable(v){return new b.Variable(v)}defaultGraph(){return j.DefaultGraph.INSTANCE}quad(v,y,x,A){return new H.Quad(v,y,x,A||this.defaultGraph())}fromTerm(v){switch(v.termType){case"NamedNode":return this.namedNode(v.value);case"BlankNode":return this.blankNode(v.value);case"Literal":return v.language?this.literal(v.value,v.language):v.datatype.equals(F.Literal.XSD_STRING)?this.literal(v.value):this.literal(v.value,this.fromTerm(v.datatype));case"Variable":return this.variable(v.value);case"DefaultGraph":return this.defaultGraph();case"Quad":return this.quad(this.fromTerm(v.subject),this.fromTerm(v.predicate),this.fromTerm(v.object),this.fromTerm(v.graph))}}fromQuad(v){return this.fromTerm(v)}resetBlankNodeCounter(){this.blankNodeCounter=0}}},{"./BlankNode":57,"./DefaultGraph":59,"./Literal":60,"./NamedNode":61,"./Quad":62,"./Variable":63}],59:[function(Y,xe,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.DefaultGraph=void 0;class W{constructor(){this.termType="DefaultGraph",this.value=""}equals(F){return!!F&&"DefaultGraph"===F.termType}}he.DefaultGraph=W,W.INSTANCE=new W},{}],60:[function(Y,xe,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.Literal=void 0;const W=Y("./NamedNode");class j{constructor(Q,H){this.termType="Literal",this.value=Q,"string"==typeof H?(this.language=H,this.datatype=j.RDF_LANGUAGE_STRING):H?(this.language="",this.datatype=H):(this.language="",this.datatype=j.XSD_STRING)}equals(Q){return!!Q&&"Literal"===Q.termType&&Q.value===this.value&&Q.language===this.language&&Q.datatype.equals(this.datatype)}}he.Literal=j,j.RDF_LANGUAGE_STRING=new W.NamedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"),j.XSD_STRING=new W.NamedNode("http://www.w3.org/2001/XMLSchema#string")},{"./NamedNode":61}],61:[function(Y,xe,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.NamedNode=void 0;he.NamedNode=class{constructor(F){this.termType="NamedNode",this.value=F}equals(F){return!!F&&"NamedNode"===F.termType&&F.value===this.value}}},{}],62:[function(Y,xe,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.Quad=void 0;he.Quad=class{constructor(F,Q,H,b){this.termType="Quad",this.value="",this.subject=F,this.predicate=Q,this.object=H,this.graph=b}equals(F){return!!F&&("Quad"===F.termType||!F.termType)&&this.subject.equals(F.subject)&&this.predicate.equals(F.predicate)&&this.object.equals(F.object)&&this.graph.equals(F.graph)}}},{}],63:[function(Y,xe,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.Variable=void 0;he.Variable=class{constructor(F){this.termType="Variable",this.value=F}equals(F){return!!F&&"Variable"===F.termType&&F.value===this.value}}},{}],64:[function(Y,xe,he){"use strict";var W=this&&this.__createBinding||(Object.create?function(F,Q,H,b){void 0===b&&(b=H),Object.defineProperty(F,b,{enumerable:!0,get:function(){return Q[H]}})}:function(F,Q,H,b){void 0===b&&(b=H),F[b]=Q[H]}),j=this&&this.__exportStar||function(F,Q){for(var H in F)"default"!==H&&!Object.prototype.hasOwnProperty.call(Q,H)&&W(Q,F,H)};Object.defineProperty(he,"__esModule",{value:!0}),j(Y("./lib/RdfXmlParser"),he)},{"./lib/RdfXmlParser":66}],65:[function(Y,xe,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.ParseError=void 0;class W extends Error{constructor(F,Q){const H=F.saxStream._parser;super(F.trackPosition?`Line ${H.line+1} column ${H.column+1}: ${Q}`:Q)}}he.ParseError=W},{}],66:[function(Y,xe,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.ParseType=he.RdfXmlParser=void 0;const W=Y("relative-to-absolute-iri"),j=Y("sax"),F=Y("stream"),Q=Y("./ParseError"),H=Y("rdf-data-factory");class b extends F.Transform{constructor(T){super({readableObjectMode:!0}),this.activeTagStack=[],this.nodeIds={},T&&(Object.assign(this,T),this.options=T),this.dataFactory||(this.dataFactory=new H.DataFactory),this.baseIRI||(this.baseIRI=""),this.defaultGraph||(this.defaultGraph=this.dataFactory.defaultGraph()),this.saxStream=j.createStream(this.strict,{xmlns:!1,position:this.trackPosition}),this.strict||(this.saxStream._parser.looseCase="toString"),this.attachSaxListeners()}static parseNamespace(T,v){const y={};let x=!1;for(const z in T.attributes)z.startsWith("xmlns")&&(5===z.length?(x=!0,y[""]=T.attributes[z]):":"===z.charAt(5)&&(x=!0,y[z.substr(6)]=T.attributes[z]));const A=v&&v.ns?v.ns:[b.DEFAULT_NS];return x?A.concat([y]):A}static expandPrefixedTerm(T,v,y){const x=T.indexOf(":");let A,z;x>=0?(A=T.substr(0,x),z=T.substr(x+1)):(A="",z=T);let N=null,K=null;for(let ue=v.length-1;ue>=0;ue--){const I=v[ue][A];if(I){N=I;break}K||(K=v[ue][""])}if(!N){if(A&&"xmlns"!==A)throw new Q.ParseError(y,`The prefix '${A}' in term '${T}' was not bound.`);N=K||""}return{prefix:A,local:z,uri:N}}static isValidIri(T){return b.IRI_REGEX.test(T)}import(T){const v=new F.PassThrough({readableObjectMode:!0});T.on("error",x=>y.emit("error",x)),T.on("data",x=>v.push(x)),T.on("end",()=>v.push(null));const y=v.pipe(new b(this.options));return y}_transform(T,v,y){try{this.saxStream.write(T,v)}catch(x){return y(x)}y()}newParseError(T){return new Q.ParseError(this,T)}valueToUri(T,v){return this.uriToNamedNode(W.resolve(T,v.baseIRI))}uriToNamedNode(T){if(!b.isValidIri(T))throw this.newParseError(`Invalid URI: ${T}`);return this.dataFactory.namedNode(T)}validateNcname(T){if(!b.NCNAME_MATCHER.test(T))throw this.newParseError(`Not a valid NCName: ${T}`)}attachSaxListeners(){this.saxStream.on("error",T=>this.emit("error",T)),this.saxStream.on("opentag",this.onTag.bind(this)),this.saxStream.on("text",this.onText.bind(this)),this.saxStream.on("closetag",this.onCloseTag.bind(this)),this.saxStream.on("doctype",this.onDoctype.bind(this))}onTag(T){const v=this.activeTagStack.length?this.activeTagStack[this.activeTagStack.length-1]:null;let y=C.RESOURCE;if(v&&(v.hadChildren=!0,y=v.childrenParseType),v&&v.childrenStringTags){const A=T.name;let z="";for(const I in T.attributes)z+=` ${I}="${T.attributes[I]}"`;v.childrenStringTags.push(`<${A}${z}>`);const ue={childrenStringTags:v.childrenStringTags};return ue.childrenStringEmitClosingTag=`</${A}>`,void this.activeTagStack.push(ue)}const x={};v?(x.language=v.language,x.baseIRI=v.baseIRI):x.baseIRI=this.baseIRI,this.activeTagStack.push(x),x.ns=b.parseNamespace(T,v),y===C.RESOURCE?this.onTagResource(T,x,v,!v):this.onTagProperty(T,x,v)}onTagResource(T,v,y,x){const A=b.expandPrefixedTerm(T.name,v.ns,this);v.childrenParseType=C.PROPERTY;let z=!0;if(A.uri===b.RDF){if(!x&&b.FORBIDDEN_NODE_ELEMENTS.indexOf(A.local)>=0)throw this.newParseError(`Illegal node element name: ${A.local}`);switch(A.local){case"RDF":v.childrenParseType=C.RESOURCE;case"Description":z=!1}}const N=[],K=[];let ue=null,I=!1,O=!1,X=null;for(const E in T.attributes){const $=T.attributes[E],Z=b.expandPrefixedTerm(E,v.ns,this);if(y&&Z.uri===b.RDF)switch(Z.local){case"about":if(ue)throw this.newParseError(`Only one of rdf:about, rdf:nodeID and rdf:ID can be present, while ${$} and ${ue} where found.`);ue=$;continue;case"ID":if(ue)throw this.newParseError(`Only one of rdf:about, rdf:nodeID and rdf:ID can be present, while ${$} and ${ue} where found.`);this.validateNcname($),ue="#"+$,I=!0;continue;case"nodeID":if(ue)throw this.newParseError(`Only one of rdf:about, rdf:nodeID and rdf:ID can be present, while ${$} and ${ue} where found.`);this.validateNcname($),ue=$,O=!0;continue;case"bagID":throw this.newParseError("rdf:bagID is not supported.");case"type":X=$;continue;case"aboutEach":throw this.newParseError("rdf:aboutEach is not supported.");case"aboutEachPrefix":throw this.newParseError("rdf:aboutEachPrefix is not supported.");case"li":throw this.newParseError("rdf:li on node elements are not supported.")}else if(Z.uri===b.XML){if("lang"===Z.local){v.language=""===$?null:$.toLowerCase();continue}if("base"===Z.local){v.baseIRI=W.resolve($,v.baseIRI);continue}}"xml"!==Z.prefix&&Z.uri&&(N.push(this.uriToNamedNode(Z.uri+Z.local)),K.push($))}if(null!==ue&&(v.subject=O?this.dataFactory.blankNode(ue):this.valueToUri(ue,v),I&&this.claimNodeId(v.subject)),v.subject||(v.subject=this.dataFactory.blankNode()),z){const E=this.uriToNamedNode(A.uri+A.local);this.emitTriple(v.subject,this.dataFactory.namedNode(b.RDF+"type"),E,y?y.reifiedStatementId:null)}if(y){if(y.predicate)if(y.childrenCollectionSubject){const E=this.dataFactory.blankNode();this.emitTriple(y.childrenCollectionSubject,y.childrenCollectionPredicate,E,y.reifiedStatementId),this.emitTriple(E,this.dataFactory.namedNode(b.RDF+"first"),v.subject,v.reifiedStatementId),y.childrenCollectionSubject=E,y.childrenCollectionPredicate=this.dataFactory.namedNode(b.RDF+"rest")}else{this.emitTriple(y.subject,y.predicate,v.subject,y.reifiedStatementId);for(let E=0;E<y.predicateSubPredicates.length;E++)this.emitTriple(v.subject,y.predicateSubPredicates[E],y.predicateSubObjects[E],null);y.predicateSubPredicates=[],y.predicateSubObjects=[],y.predicateEmitted=!0}for(let E=0;E<N.length;E++){const $=this.dataFactory.literal(K[E],v.datatype||v.language);this.emitTriple(v.subject,N[E],$,y.reifiedStatementId)}X&&this.emitTriple(v.subject,this.dataFactory.namedNode(b.RDF+"type"),this.uriToNamedNode(X),null)}}onTagProperty(T,v,y){const x=b.expandPrefixedTerm(T.name,v.ns,this);if(v.childrenParseType=C.RESOURCE,v.subject=y.subject,x.uri===b.RDF&&"li"===x.local?(y.listItemCounter||(y.listItemCounter=1),v.predicate=this.uriToNamedNode(x.uri+"_"+y.listItemCounter++)):v.predicate=this.uriToNamedNode(x.uri+x.local),x.uri===b.RDF&&b.FORBIDDEN_PROPERTY_ELEMENTS.indexOf(x.local)>=0)throw this.newParseError(`Illegal property element name: ${x.local}`);v.predicateSubPredicates=[],v.predicateSubObjects=[];let A=!1,z=!1,N=null,K=!0;const ue=[],I=[];for(const O in T.attributes){const X=T.attributes[O],E=b.expandPrefixedTerm(O,v.ns,this);if(E.uri===b.RDF)switch(E.local){case"resource":if(N)throw this.newParseError(`Found both rdf:resource (${X}) and rdf:nodeID (${N}).`);if(A)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:resource (${X})`);v.hadChildren=!0,N=X,K=!1;continue;case"datatype":if(z)throw this.newParseError(`Found both non-rdf:* property attributes and rdf:datatype (${X}).`);if(A)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:datatype (${X})`);v.datatype=this.valueToUri(X,v);continue;case"nodeID":if(z)throw this.newParseError(`Found both non-rdf:* property attributes and rdf:nodeID (${X}).`);if(v.hadChildren)throw this.newParseError(`Found both rdf:resource and rdf:nodeID (${X}).`);if(A)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:nodeID (${X})`);this.validateNcname(X),v.hadChildren=!0,N=X,K=!0;continue;case"bagID":throw this.newParseError("rdf:bagID is not supported.");case"parseType":if(z)throw this.newParseError("rdf:parseType is not allowed when non-rdf:* property attributes are present");if(v.datatype)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:datatype (${v.datatype.value})`);if(N)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:nodeID or rdf:resource (${N})`);if("Resource"===X){A=!0,v.childrenParseType=C.PROPERTY;const $=this.dataFactory.blankNode();this.emitTriple(v.subject,v.predicate,$,v.reifiedStatementId),v.subject=$,v.predicate=null}else"Collection"===X?(A=!0,v.hadChildren=!0,v.childrenCollectionSubject=v.subject,v.childrenCollectionPredicate=v.predicate,K=!1):"Literal"===X&&(A=!0,v.childrenTagsToString=!0,v.childrenStringTags=[]);continue;case"ID":this.validateNcname(X),v.reifiedStatementId=this.valueToUri("#"+X,v),this.claimNodeId(v.reifiedStatementId);continue}else if(E.uri===b.XML&&"lang"===E.local){v.language=""===X?null:X.toLowerCase();continue}if("xml"!==E.prefix&&"xmlns"!==E.prefix&&E.uri){if(A||v.datatype)throw this.newParseError(`Found illegal rdf:* properties on property element with attribute: ${X}`);v.hadChildren=!0,z=!0,ue.push(this.uriToNamedNode(E.uri+E.local)),I.push(this.dataFactory.literal(X,v.datatype||v.language))}}if(null!==N){const O=v.subject;v.subject=K?this.dataFactory.blankNode(N):this.valueToUri(N,v),this.emitTriple(O,v.predicate,v.subject,v.reifiedStatementId);for(let X=0;X<ue.length;X++)this.emitTriple(v.subject,ue[X],I[X],null);v.predicateEmitted=!0}else K&&(v.predicateSubPredicates=ue,v.predicateSubObjects=I,v.predicateEmitted=!1)}emitTriple(T,v,y,x){this.push(this.dataFactory.quad(T,v,y,this.defaultGraph)),x&&(this.push(this.dataFactory.quad(x,this.dataFactory.namedNode(b.RDF+"type"),this.dataFactory.namedNode(b.RDF+"Statement"),this.defaultGraph)),this.push(this.dataFactory.quad(x,this.dataFactory.namedNode(b.RDF+"subject"),T,this.defaultGraph)),this.push(this.dataFactory.quad(x,this.dataFactory.namedNode(b.RDF+"predicate"),v,this.defaultGraph)),this.push(this.dataFactory.quad(x,this.dataFactory.namedNode(b.RDF+"object"),y,this.defaultGraph)))}claimNodeId(T){if(!this.allowDuplicateRdfIds){if(this.nodeIds[T.value])throw this.newParseError(`Found multiple occurrences of rdf:ID='${T.value}'.`);this.nodeIds[T.value]=!0}}onText(T){const v=this.activeTagStack.length?this.activeTagStack[this.activeTagStack.length-1]:null;v&&(v.childrenStringTags?v.childrenStringTags.push(T):v.predicate&&(v.text=T))}onCloseTag(){const T=this.activeTagStack.pop();if(T.childrenStringEmitClosingTag&&T.childrenStringTags.push(T.childrenStringEmitClosingTag),T.childrenTagsToString&&(T.datatype=this.dataFactory.namedNode(b.RDF+"XMLLiteral"),T.text=T.childrenStringTags.join(""),T.hadChildren=!1),T.childrenCollectionSubject)this.emitTriple(T.childrenCollectionSubject,T.childrenCollectionPredicate,this.dataFactory.namedNode(b.RDF+"nil"),T.reifiedStatementId);else if(T.predicate)if(T.hadChildren||T.childrenParseType===C.PROPERTY){if(!T.predicateEmitted){const v=this.dataFactory.blankNode();this.emitTriple(T.subject,T.predicate,v,T.reifiedStatementId);for(let y=0;y<T.predicateSubPredicates.length;y++)this.emitTriple(v,T.predicateSubPredicates[y],T.predicateSubObjects[y],null)}}else this.emitTriple(T.subject,T.predicate,this.dataFactory.literal(T.text||"",T.datatype||T.language),T.reifiedStatementId)}onDoctype(T){T.replace(/<!ENTITY\s+([^\s]+)\s+["']([^"']+)["']\s*>/g,(v,y,x)=>(this.saxStream._parser.ENTITIES[y]=x,""))}}var C,R;he.RdfXmlParser=b,b.IRI_REGEX=/^([A-Za-z][A-Za-z0-9+-.]*):[^ "<>{}|\\\[\]`]*$/,b.MIME_TYPE="application/rdf+xml",b.RDF="http://www.w3.org/1999/02/22-rdf-syntax-ns#",b.XML="http://www.w3.org/XML/1998/namespace",b.XMLNS="http://www.w3.org/2000/xmlns/",b.DEFAULT_NS={xml:b.XML},b.FORBIDDEN_NODE_ELEMENTS=["RDF","ID","about","bagID","parseType","resource","nodeID","li","aboutEach","aboutEachPrefix"],b.FORBIDDEN_PROPERTY_ELEMENTS=["Description","RDF","ID","about","bagID","parseType","resource","nodeID","aboutEach","aboutEachPrefix"],b.NCNAME_MATCHER=/^([A-Za-z\xC0-\xD6\xD8-\xF6\u{F8}-\u{2FF}\u{370}-\u{37D}\u{37F}-\u{1FFF}\u{200C}-\u{200D}\u{2070}-\u{218F}\u{2C00}-\u{2FEF}\u{3001}-\u{D7FF}\u{F900}-\u{FDCF}\u{FDF0}-\u{FFFD}\u{10000}-\u{EFFFF}_])([A-Za-z\xC0-\xD6\xD8-\xF6\u{F8}-\u{2FF}\u{370}-\u{37D}\u{37F}-\u{1FFF}\u{200C}-\u{200D}\u{2070}-\u{218F}\u{2C00}-\u{2FEF}\u{3001}-\u{D7FF}\u{F900}-\u{FDCF}\u{FDF0}-\u{FFFD}\u{10000}-\u{EFFFF}_\-.0-9#xB7\u{0300}-\u{036F}\u{203F}-\u{2040}])*$/u,(R=C=he.ParseType||(he.ParseType={}))[R.RESOURCE=0]="RESOURCE",R[R.PROPERTY=1]="PROPERTY"},{"./ParseError":65,"rdf-data-factory":56,"relative-to-absolute-iri":82,sax:85,stream:87}],67:[function(Y,xe,he){"use strict";var j={};function F(R,T,v){v||(v=Error);var x=function(A){function z(N,K,ue){return A.call(this,function(A,z,N){return"string"==typeof T?T:T(A,z,N)}(N,K,ue))||this}return function(R,T){R.prototype=Object.create(T.prototype),R.prototype.constructor=R,R.__proto__=T}(z,A),z}(v);x.prototype.name=v.name,x.prototype.code=R,j[R]=x}function Q(R,T){if(Array.isArray(R)){var v=R.length;return R=R.map(function(y){return String(y)}),v>2?"one of ".concat(T," ").concat(R.slice(0,v-1).join(", "),", or ")+R[v-1]:2===v?"one of ".concat(T," ").concat(R[0]," or ").concat(R[1]):"of ".concat(T," ").concat(R[0])}return"of ".concat(T," ").concat(String(R))}F("ERR_INVALID_OPT_VALUE",function(R,T){return'The value "'+T+'" is invalid for option "'+R+'"'},TypeError),F("ERR_INVALID_ARG_TYPE",function(R,T,v){var y,x;if("string"==typeof T&&function(R,T,v){return R.substr(!v||v<0?0:+v,T.length)===T}(T,"not ")?(y="must not be",T=T.replace(/^not /,"")):y="must be",function(R,T,v){return(void 0===v||v>R.length)&&(v=R.length),R.substring(v-T.length,v)===T}(R," argument"))x="The ".concat(R," ").concat(y," ").concat(Q(T,"type"));else{var A=function(R,T,v){return"number"!=typeof v&&(v=0),!(v+T.length>R.length)&&-1!==R.indexOf(T,v)}(R,".")?"property":"argument";x='The "'.concat(R,'" ').concat(A," ").concat(y," ").concat(Q(T,"type"))}return x+". Received type ".concat(typeof v)},TypeError),F("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),F("ERR_METHOD_NOT_IMPLEMENTED",function(R){return"The "+R+" method is not implemented"}),F("ERR_STREAM_PREMATURE_CLOSE","Premature close"),F("ERR_STREAM_DESTROYED",function(R){return"Cannot call "+R+" after a stream was destroyed"}),F("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),F("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),F("ERR_STREAM_WRITE_AFTER_END","write after end"),F("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),F("ERR_UNKNOWN_ENCODING",function(R){return"Unknown encoding: "+R},TypeError),F("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),xe.exports.codes=j},{}],68:[function(Y,xe,he){(function(W){(function(){"use strict";var j=Object.keys||function(y){var x=[];for(var A in y)x.push(A);return x};xe.exports=R;var F=Y("./_stream_readable"),Q=Y("./_stream_writable");Y("inherits")(R,F);for(var H=j(Q.prototype),b=0;b<H.length;b++){var C=H[b];R.prototype[C]||(R.prototype[C]=Q.prototype[C])}function R(y){if(!(this instanceof R))return new R(y);F.call(this,y),Q.call(this,y),this.allowHalfOpen=!0,y&&(!1===y.readable&&(this.readable=!1),!1===y.writable&&(this.writable=!1),!1===y.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",T)))}function T(){this._writableState.ended||W.nextTick(v,this)}function v(y){y.end()}Object.defineProperty(R.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(R.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(R.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(R.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(x){void 0===this._readableState||void 0===this._writableState||(this._readableState.destroyed=x,this._writableState.destroyed=x)}})}).call(this)}).call(this,Y("_process"))},{"./_stream_readable":70,"./_stream_writable":72,_process:44,inherits:10}],69:[function(Y,xe,he){"use strict";xe.exports=j;var W=Y("./_stream_transform");function j(F){if(!(this instanceof j))return new j(F);W.call(this,F)}Y("inherits")(j,W),j.prototype._transform=function(F,Q,H){H(null,F)}},{"./_stream_transform":71,inherits:10}],70:[function(Y,xe,he){(function(W,j){(function(){"use strict";var F;xe.exports=ne,ne.ReadableState=me,Y("events");var H=function(B,P){return B.listeners(P).length},b=Y("./internal/streams/stream"),C=Y("buffer").Buffer,R=j.Uint8Array||function(){};var x,y=Y("util");x=y&&y.debuglog?y.debuglog("stream"):function(){};var $,Z,ae,A=Y("./internal/streams/buffer_list"),z=Y("./internal/streams/destroy"),K=Y("./internal/streams/state").getHighWaterMark,ue=Y("../errors").codes,I=ue.ERR_INVALID_ARG_TYPE,O=ue.ERR_STREAM_PUSH_AFTER_EOF,X=ue.ERR_METHOD_NOT_IMPLEMENTED,E=ue.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;Y("inherits")(ne,b);var oe=z.errorOrDestroy,te=["error","close","destroy","pause","resume"];function me(we,B,P){F=F||Y("./_stream_duplex"),"boolean"!=typeof P&&(P=B instanceof F),this.objectMode=!!(we=we||{}).objectMode,P&&(this.objectMode=this.objectMode||!!we.readableObjectMode),this.highWaterMark=K(this,we,"readableHighWaterMark",P),this.buffer=new A,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==we.emitClose,this.autoDestroy=!!we.autoDestroy,this.destroyed=!1,this.defaultEncoding=we.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,we.encoding&&($||($=Y("string_decoder/").StringDecoder),this.decoder=new $(we.encoding),this.encoding=we.encoding)}function ne(we){if(F=F||Y("./_stream_duplex"),!(this instanceof ne))return new ne(we);this._readableState=new me(we,this,this instanceof F),this.readable=!0,we&&("function"==typeof we.read&&(this._read=we.read),"function"==typeof we.destroy&&(this._destroy=we.destroy)),b.call(this)}function ye(we,B,P,V,Re){x("readableAddChunk",B);var St,Ze=we._readableState;if(null===B)Ze.reading=!1,function(we,B){if(x("onEofChunk"),!B.ended){if(B.decoder){var P=B.decoder.end();P&&P.length&&(B.buffer.push(P),B.length+=B.objectMode?1:P.length)}B.ended=!0,B.sync?ze(we):(B.needReadable=!1,B.emittedReadable||(B.emittedReadable=!0,ke(we)))}}(we,Ze);else if(Re||(St=function(we,B){var P;return!function(we){return C.isBuffer(we)||we instanceof R}(B)&&"string"!=typeof B&&void 0!==B&&!we.objectMode&&(P=new I("chunk",["string","Buffer","Uint8Array"],B)),P}(Ze,B)),St)oe(we,St);else if(Ze.objectMode||B&&B.length>0)if("string"!=typeof B&&!Ze.objectMode&&Object.getPrototypeOf(B)!==C.prototype&&(B=function(we){return C.from(we)}(B)),V)Ze.endEmitted?oe(we,new E):Oe(we,Ze,B,!0);else if(Ze.ended)oe(we,new O);else{if(Ze.destroyed)return!1;Ze.reading=!1,Ze.decoder&&!P?(B=Ze.decoder.write(B),Ze.objectMode||0!==B.length?Oe(we,Ze,B,!1):Xe(we,Ze)):Oe(we,Ze,B,!1)}else V||(Ze.reading=!1,Xe(we,Ze));return!Ze.ended&&(Ze.length<Ze.highWaterMark||0===Ze.length)}function Oe(we,B,P,V){B.flowing&&0===B.length&&!B.sync?(B.awaitDrain=0,we.emit("data",P)):(B.length+=B.objectMode?1:P.length,V?B.buffer.unshift(P):B.buffer.push(P),B.needReadable&&ze(we)),Xe(we,B)}Object.defineProperty(ne.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(B){!this._readableState||(this._readableState.destroyed=B)}}),ne.prototype.destroy=z.destroy,ne.prototype._undestroy=z.undestroy,ne.prototype._destroy=function(we,B){B(we)},ne.prototype.push=function(we,B){var V,P=this._readableState;return P.objectMode?V=!0:"string"==typeof we&&((B=B||P.defaultEncoding)!==P.encoding&&(we=C.from(we,B),B=""),V=!0),ye(this,we,B,!1,V)},ne.prototype.unshift=function(we){return ye(this,we,null,!0,!1)},ne.prototype.isPaused=function(){return!1===this._readableState.flowing},ne.prototype.setEncoding=function(we){$||($=Y("string_decoder/").StringDecoder);var B=new $(we);this._readableState.decoder=B,this._readableState.encoding=this._readableState.decoder.encoding;for(var P=this._readableState.buffer.head,V="";null!==P;)V+=B.write(P.data),P=P.next;return this._readableState.buffer.clear(),""!==V&&this._readableState.buffer.push(V),this._readableState.length=V.length,this};var st=1073741824;function tt(we,B){return we<=0||0===B.length&&B.ended?0:B.objectMode?1:we!=we?B.flowing&&B.length?B.buffer.head.data.length:B.length:(we>B.highWaterMark&&(B.highWaterMark=function(we){return we>=st?we=st:(we--,we|=we>>>1,we|=we>>>2,we|=we>>>4,we|=we>>>8,we|=we>>>16,we++),we}(we)),we<=B.length?we:B.ended?B.length:(B.needReadable=!0,0))}function ze(we){var B=we._readableState;x("emitReadable",B.needReadable,B.emittedReadable),B.needReadable=!1,B.emittedReadable||(x("emitReadable",B.flowing),B.emittedReadable=!0,W.nextTick(ke,we))}function ke(we){var B=we._readableState;x("emitReadable_",B.destroyed,B.length,B.ended),!B.destroyed&&(B.length||B.ended)&&(we.emit("readable"),B.emittedReadable=!1),B.needReadable=!B.flowing&&!B.ended&&B.length<=B.highWaterMark,pe(we)}function Xe(we,B){B.readingMore||(B.readingMore=!0,W.nextTick(Ae,we,B))}function Ae(we,B){for(;!B.reading&&!B.ended&&(B.length<B.highWaterMark||B.flowing&&0===B.length);){var P=B.length;if(x("maybeReadMore read 0"),we.read(0),P===B.length)break}B.readingMore=!1}function qe(we){var B=we._readableState;B.readableListening=we.listenerCount("readable")>0,B.resumeScheduled&&!B.paused?B.flowing=!0:we.listenerCount("data")>0&&we.resume()}function Fe(we){x("readable nexttick read 0"),we.read(0)}function G(we,B){x("resume",B.reading),B.reading||we.read(0),B.resumeScheduled=!1,we.emit("resume"),pe(we),B.flowing&&!B.reading&&we.read(0)}function pe(we){var B=we._readableState;for(x("flow",B.flowing);B.flowing&&null!==we.read(););}function de(we,B){return 0===B.length?null:(B.objectMode?P=B.buffer.shift():!we||we>=B.length?(P=B.decoder?B.buffer.join(""):1===B.buffer.length?B.buffer.first():B.buffer.concat(B.length),B.buffer.clear()):P=B.buffer.consume(we,B.decoder),P);var P}function je(we){var B=we._readableState;x("endReadable",B.endEmitted),B.endEmitted||(B.ended=!0,W.nextTick(_t,B,we))}function _t(we,B){if(x("endReadableNT",we.endEmitted,we.length),!we.endEmitted&&0===we.length&&(we.endEmitted=!0,B.readable=!1,B.emit("end"),we.autoDestroy)){var P=B._writableState;(!P||P.autoDestroy&&P.finished)&&B.destroy()}}function pt(we,B){for(var P=0,V=we.length;P<V;P++)if(we[P]===B)return P;return-1}ne.prototype.read=function(we){x("read",we),we=parseInt(we,10);var B=this._readableState,P=we;if(0!==we&&(B.emittedReadable=!1),0===we&&B.needReadable&&((0!==B.highWaterMark?B.length>=B.highWaterMark:B.length>0)||B.ended))return x("read: emitReadable",B.length,B.ended),0===B.length&&B.ended?je(this):ze(this),null;if(0===(we=tt(we,B))&&B.ended)return 0===B.length&&je(this),null;var Re,V=B.needReadable;return x("need readable",V),(0===B.length||B.length-we<B.highWaterMark)&&x("length less than watermark",V=!0),B.ended||B.reading?x("reading or ended",V=!1):V&&(x("do read"),B.reading=!0,B.sync=!0,0===B.length&&(B.needReadable=!0),this._read(B.highWaterMark),B.sync=!1,B.reading||(we=tt(P,B))),null===(Re=we>0?de(we,B):null)?(B.needReadable=B.length<=B.highWaterMark,we=0):(B.length-=we,B.awaitDrain=0),0===B.length&&(B.ended||(B.needReadable=!0),P!==we&&B.ended&&je(this)),null!==Re&&this.emit("data",Re),Re},ne.prototype._read=function(we){oe(this,new X("_read()"))},ne.prototype.pipe=function(we,B){var P=this,V=this._readableState;switch(V.pipesCount){case 0:V.pipes=we;break;case 1:V.pipes=[V.pipes,we];break;default:V.pipes.push(we)}V.pipesCount+=1,x("pipe count=%d opts=%j",V.pipesCount,B);var Ze=B&&!1===B.end||we===W.stdout||we===W.stderr?ds:Rt;function St(Fs,$r){x("onunpipe"),Fs===P&&$r&&!1===$r.hasUnpiped&&($r.hasUnpiped=!0,x("cleanup"),we.removeListener("close",Gr),we.removeListener("finish",Ps),we.removeListener("drain",Mn),we.removeListener("error",fi),we.removeListener("unpipe",St),P.removeListener("end",Rt),P.removeListener("end",ds),P.removeListener("data",bi),Nn=!0,V.awaitDrain&&(!we._writableState||we._writableState.needDrain)&&Mn())}function Rt(){x("onend"),we.end()}V.endEmitted?W.nextTick(Ze):P.once("end",Ze),we.on("unpipe",St);var Mn=function(we){return function(){var P=we._readableState;x("pipeOnDrain",P.awaitDrain),P.awaitDrain&&P.awaitDrain--,0===P.awaitDrain&&H(we,"data")&&(P.flowing=!0,pe(we))}}(P);we.on("drain",Mn);var Nn=!1;function bi(Fs){x("ondata");var $r=we.write(Fs);x("dest.write",$r),!1===$r&&((1===V.pipesCount&&V.pipes===we||V.pipesCount>1&&-1!==pt(V.pipes,we))&&!Nn&&(x("false write response, pause",V.awaitDrain),V.awaitDrain++),P.pause())}function fi(Fs){x("onerror",Fs),ds(),we.removeListener("error",fi),0===H(we,"error")&&oe(we,Fs)}function Gr(){we.removeListener("finish",Ps),ds()}function Ps(){x("onfinish"),we.removeListener("close",Gr),ds()}function ds(){x("unpipe"),P.unpipe(we)}return P.on("data",bi),function(we,B,P){if("function"==typeof we.prependListener)return we.prependListener(B,P);we._events&&we._events[B]?Array.isArray(we._events[B])?we._events[B].unshift(P):we._events[B]=[P,we._events[B]]:we.on(B,P)}(we,"error",fi),we.once("close",Gr),we.once("finish",Ps),we.emit("pipe",P),V.flowing||(x("pipe resume"),P.resume()),we},ne.prototype.unpipe=function(we){var B=this._readableState,P={hasUnpiped:!1};if(0===B.pipesCount)return this;if(1===B.pipesCount)return we&&we!==B.pipes||(we||(we=B.pipes),B.pipes=null,B.pipesCount=0,B.flowing=!1,we&&we.emit("unpipe",this,P)),this;if(!we){var V=B.pipes,Re=B.pipesCount;B.pipes=null,B.pipesCount=0,B.flowing=!1;for(var Ze=0;Ze<Re;Ze++)V[Ze].emit("unpipe",this,{hasUnpiped:!1});return this}var St=pt(B.pipes,we);return-1===St||(B.pipes.splice(St,1),B.pipesCount-=1,1===B.pipesCount&&(B.pipes=B.pipes[0]),we.emit("unpipe",this,P)),this},ne.prototype.addListener=ne.prototype.on=function(we,B){var P=b.prototype.on.call(this,we,B),V=this._readableState;return"data"===we?(V.readableListening=this.listenerCount("readable")>0,!1!==V.flowing&&this.resume()):"readable"===we&&!V.endEmitted&&!V.readableListening&&(V.readableListening=V.needReadable=!0,V.flowing=!1,V.emittedReadable=!1,x("on readable",V.length,V.reading),V.length?ze(this):V.reading||W.nextTick(Fe,this)),P},ne.prototype.removeListener=function(we,B){var P=b.prototype.removeListener.call(this,we,B);return"readable"===we&&W.nextTick(qe,this),P},ne.prototype.removeAllListeners=function(we){var B=b.prototype.removeAllListeners.apply(this,arguments);return("readable"===we||void 0===we)&&W.nextTick(qe,this),B},ne.prototype.resume=function(){var we=this._readableState;return we.flowing||(x("resume"),we.flowing=!we.readableListening,function(we,B){B.resumeScheduled||(B.resumeScheduled=!0,W.nextTick(G,we,B))}(this,we)),we.paused=!1,this},ne.prototype.pause=function(){return x("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(x("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},ne.prototype.wrap=function(we){var B=this,P=this._readableState,V=!1;for(var Re in we.on("end",function(){if(x("wrapped end"),P.decoder&&!P.ended){var St=P.decoder.end();St&&St.length&&B.push(St)}B.push(null)}),we.on("data",function(St){x("wrapped data"),P.decoder&&(St=P.decoder.write(St)),P.objectMode&&null==St||!(P.objectMode||St&&St.length)||B.push(St)||(V=!0,we.pause())}),we)void 0===this[Re]&&"function"==typeof we[Re]&&(this[Re]=function(Rt){return function(){return we[Rt].apply(we,arguments)}}(Re));for(var Ze=0;Ze<te.length;Ze++)we.on(te[Ze],this.emit.bind(this,te[Ze]));return this._read=function(St){x("wrapped _read",St),V&&(V=!1,we.resume())},this},"function"==typeof Symbol&&(ne.prototype[Symbol.asyncIterator]=function(){return void 0===Z&&(Z=Y("./internal/streams/async_iterator")),Z(this)}),Object.defineProperty(ne.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(ne.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(ne.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(B){this._readableState&&(this._readableState.flowing=B)}}),ne._fromList=de,Object.defineProperty(ne.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(ne.from=function(we,B){return void 0===ae&&(ae=Y("./internal/streams/from")),ae(ne,we,B)})}).call(this)}).call(this,Y("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../errors":67,"./_stream_duplex":68,"./internal/streams/async_iterator":73,"./internal/streams/buffer_list":74,"./internal/streams/destroy":75,"./internal/streams/from":77,"./internal/streams/state":79,"./internal/streams/stream":80,_process:44,buffer:6,events:8,inherits:10,"string_decoder/":88,util:3}],71:[function(Y,xe,he){"use strict";xe.exports=R;var W=Y("../errors").codes,j=W.ERR_METHOD_NOT_IMPLEMENTED,F=W.ERR_MULTIPLE_CALLBACK,Q=W.ERR_TRANSFORM_ALREADY_TRANSFORMING,H=W.ERR_TRANSFORM_WITH_LENGTH_0,b=Y("./_stream_duplex");function C(y,x){var A=this._transformState;A.transforming=!1;var z=A.writecb;if(null===z)return this.emit("error",new F);A.writechunk=null,A.writecb=null,null!=x&&this.push(x),z(y);var N=this._readableState;N.reading=!1,(N.needReadable||N.length<N.highWaterMark)&&this._read(N.highWaterMark)}function R(y){if(!(this instanceof R))return new R(y);b.call(this,y),this._transformState={afterTransform:C.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,y&&("function"==typeof y.transform&&(this._transform=y.transform),"function"==typeof y.flush&&(this._flush=y.flush)),this.on("prefinish",T)}function T(){var y=this;"function"!=typeof this._flush||this._readableState.destroyed?v(this,null,null):this._flush(function(x,A){v(y,x,A)})}function v(y,x,A){if(x)return y.emit("error",x);if(null!=A&&y.push(A),y._writableState.length)throw new H;if(y._transformState.transforming)throw new Q;return y.push(null)}Y("inherits")(R,b),R.prototype.push=function(y,x){return this._transformState.needTransform=!1,b.prototype.push.call(this,y,x)},R.prototype._transform=function(y,x,A){A(new j("_transform()"))},R.prototype._write=function(y,x,A){var z=this._transformState;if(z.writecb=A,z.writechunk=y,z.writeencoding=x,!z.transforming){var N=this._readableState;(z.needTransform||N.needReadable||N.length<N.highWaterMark)&&this._read(N.highWaterMark)}},R.prototype._read=function(y){var x=this._transformState;null===x.writechunk||x.transforming?x.needTransform=!0:(x.transforming=!0,this._transform(x.writechunk,x.writeencoding,x.afterTransform))},R.prototype._destroy=function(y,x){b.prototype._destroy.call(this,y,function(A){x(A)})}},{"../errors":67,"./_stream_duplex":68,inherits:10}],72:[function(Y,xe,he){(function(W,j){(function(){"use strict";function Q(pe){var de=this;this.next=null,this.entry=null,this.finish=function(){!function(pe,de,je){var _t=pe.entry;for(pe.entry=null;_t;){var pt=_t.callback;de.pendingcb--,pt(je),_t=_t.next}de.corkedRequestsFree.next=pe}(de,pe)}}var H;xe.exports=me,me.WritableState=te;var b={deprecate:Y("util-deprecate")},C=Y("./internal/streams/stream"),R=Y("buffer").Buffer,T=j.Uint8Array||function(){};var Ce,x=Y("./internal/streams/destroy"),z=Y("./internal/streams/state").getHighWaterMark,N=Y("../errors").codes,K=N.ERR_INVALID_ARG_TYPE,ue=N.ERR_METHOD_NOT_IMPLEMENTED,I=N.ERR_MULTIPLE_CALLBACK,O=N.ERR_STREAM_CANNOT_PIPE,X=N.ERR_STREAM_DESTROYED,E=N.ERR_STREAM_NULL_VALUES,$=N.ERR_STREAM_WRITE_AFTER_END,Z=N.ERR_UNKNOWN_ENCODING,ae=x.errorOrDestroy;function oe(){}function te(pe,de,je){H=H||Y("./_stream_duplex"),"boolean"!=typeof je&&(je=de instanceof H),this.objectMode=!!(pe=pe||{}).objectMode,je&&(this.objectMode=this.objectMode||!!pe.writableObjectMode),this.highWaterMark=z(this,pe,"writableHighWaterMark",je),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1,this.decodeStrings=!(!1===pe.decodeStrings),this.defaultEncoding=pe.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(pt){!function(pe,de){var je=pe._writableState,_t=je.sync,pt=je.writecb;if("function"!=typeof pt)throw new I;if(function(pe){pe.writing=!1,pe.writecb=null,pe.length-=pe.writelen,pe.writelen=0}(je),de)!function(pe,de,je,_t,pt){--de.pendingcb,je?(W.nextTick(pt,_t),W.nextTick(Fe,pe,de),pe._writableState.errorEmitted=!0,ae(pe,_t)):(pt(_t),pe._writableState.errorEmitted=!0,ae(pe,_t),Fe(pe,de))}(pe,je,_t,de,pt);else{var we=Ae(je)||pe.destroyed;!we&&!je.corked&&!je.bufferProcessing&&je.bufferedRequest&&Xe(pe,je),_t?W.nextTick(ze,pe,je,we,pt):ze(pe,je,we,pt)}}(de,pt)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==pe.emitClose,this.autoDestroy=!!pe.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new Q(this)}function me(pe){var de=this instanceof(H=H||Y("./_stream_duplex"));if(!de&&!Ce.call(me,this))return new me(pe);this._writableState=new te(pe,this,de),this.writable=!0,pe&&("function"==typeof pe.write&&(this._write=pe.write),"function"==typeof pe.writev&&(this._writev=pe.writev),"function"==typeof pe.destroy&&(this._destroy=pe.destroy),"function"==typeof pe.final&&(this._final=pe.final)),C.call(this)}function $e(pe,de,je,_t,pt,we){if(!je){var B=function(pe,de,je){return!pe.objectMode&&!1!==pe.decodeStrings&&"string"==typeof de&&(de=R.from(de,je)),de}(de,_t,pt);_t!==B&&(je=!0,pt="buffer",_t=B)}var P=de.objectMode?1:_t.length;de.length+=P;var V=de.length<de.highWaterMark;if(V||(de.needDrain=!0),de.writing||de.corked){var Re=de.lastBufferedRequest;de.lastBufferedRequest={chunk:_t,encoding:pt,isBuf:je,callback:we,next:null},Re?Re.next=de.lastBufferedRequest:de.bufferedRequest=de.lastBufferedRequest,de.bufferedRequestCount+=1}else st(pe,de,!1,P,_t,pt,we);return V}function st(pe,de,je,_t,pt,we,B){de.writelen=_t,de.writecb=B,de.writing=!0,de.sync=!0,de.destroyed?de.onwrite(new X("write")):je?pe._writev(pt,de.onwrite):pe._write(pt,we,de.onwrite),de.sync=!1}function ze(pe,de,je,_t){je||function(pe,de){0===de.length&&de.needDrain&&(de.needDrain=!1,pe.emit("drain"))}(pe,de),de.pendingcb--,_t(),Fe(pe,de)}function Xe(pe,de){de.bufferProcessing=!0;var je=de.bufferedRequest;if(pe._writev&&je&&je.next){var pt=new Array(de.bufferedRequestCount),we=de.corkedRequestsFree;we.entry=je;for(var B=0,P=!0;je;)pt[B]=je,je.isBuf||(P=!1),je=je.next,B+=1;pt.allBuffers=P,st(pe,de,!0,de.length,pt,"",we.finish),de.pendingcb++,de.lastBufferedRequest=null,we.next?(de.corkedRequestsFree=we.next,we.next=null):de.corkedRequestsFree=new Q(de),de.bufferedRequestCount=0}else{for(;je;){var V=je.chunk;if(st(pe,de,!1,de.objectMode?1:V.length,V,je.encoding,je.callback),je=je.next,de.bufferedRequestCount--,de.writing)break}null===je&&(de.lastBufferedRequest=null)}de.bufferedRequest=je,de.bufferProcessing=!1}function Ae(pe){return pe.ending&&0===pe.length&&null===pe.bufferedRequest&&!pe.finished&&!pe.writing}function Ue(pe,de){pe._final(function(je){de.pendingcb--,je&&ae(pe,je),de.prefinished=!0,pe.emit("prefinish"),Fe(pe,de)})}function Fe(pe,de){var je=Ae(de);if(je&&(function(pe,de){!de.prefinished&&!de.finalCalled&&("function"!=typeof pe._final||de.destroyed?(de.prefinished=!0,pe.emit("prefinish")):(de.pendingcb++,de.finalCalled=!0,W.nextTick(Ue,pe,de)))}(pe,de),0===de.pendingcb&&(de.finished=!0,pe.emit("finish"),de.autoDestroy))){var _t=pe._readableState;(!_t||_t.autoDestroy&&_t.endEmitted)&&pe.destroy()}return je}Y("inherits")(me,C),te.prototype.getBuffer=function(){for(var de=this.bufferedRequest,je=[];de;)je.push(de),de=de.next;return je},function(){try{Object.defineProperty(te.prototype,"buffer",{get:b.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(pe){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(Ce=Function.prototype[Symbol.hasInstance],Object.defineProperty(me,Symbol.hasInstance,{value:function(de){return!!Ce.call(this,de)||this===me&&de&&de._writableState instanceof te}})):Ce=function(de){return de instanceof this},me.prototype.pipe=function(){ae(this,new O)},me.prototype.write=function(pe,de,je){var _t=this._writableState,pt=!1,we=!_t.objectMode&&function(pe){return R.isBuffer(pe)||pe instanceof T}(pe);return we&&!R.isBuffer(pe)&&(pe=function(pe){return R.from(pe)}(pe)),"function"==typeof de&&(je=de,de=null),we?de="buffer":de||(de=_t.defaultEncoding),"function"!=typeof je&&(je=oe),_t.ending?function(pe,de){var je=new $;ae(pe,je),W.nextTick(de,je)}(this,je):(we||function(pe,de,je,_t){var pt;return null===je?pt=new E:"string"!=typeof je&&!de.objectMode&&(pt=new K("chunk",["string","Buffer"],je)),!pt||(ae(pe,pt),W.nextTick(_t,pt),!1)}(this,_t,pe,je))&&(_t.pendingcb++,pt=$e(this,_t,we,pe,de,je)),pt},me.prototype.cork=function(){this._writableState.corked++},me.prototype.uncork=function(){var pe=this._writableState;pe.corked&&(pe.corked--,!pe.writing&&!pe.corked&&!pe.bufferProcessing&&pe.bufferedRequest&&Xe(this,pe))},me.prototype.setDefaultEncoding=function(de){if("string"==typeof de&&(de=de.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((de+"").toLowerCase())>-1))throw new Z(de);return this._writableState.defaultEncoding=de,this},Object.defineProperty(me.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(me.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),me.prototype._write=function(pe,de,je){je(new ue("_write()"))},me.prototype._writev=null,me.prototype.end=function(pe,de,je){var _t=this._writableState;return"function"==typeof pe?(je=pe,pe=null,de=null):"function"==typeof de&&(je=de,de=null),null!=pe&&this.write(pe,de),_t.corked&&(_t.corked=1,this.uncork()),_t.ending||function(pe,de,je){de.ending=!0,Fe(pe,de),je&&(de.finished?W.nextTick(je):pe.once("finish",je)),de.ended=!0,pe.writable=!1}(this,_t,je),this},Object.defineProperty(me.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(me.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(de){!this._writableState||(this._writableState.destroyed=de)}}),me.prototype.destroy=x.destroy,me.prototype._undestroy=x.undestroy,me.prototype._destroy=function(pe,de){de(pe)}}).call(this)}).call(this,Y("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../errors":67,"./_stream_duplex":68,"./internal/streams/destroy":75,"./internal/streams/state":79,"./internal/streams/stream":80,_process:44,buffer:6,inherits:10,"util-deprecate":90}],73:[function(Y,xe,he){(function(W){(function(){"use strict";var j;function F(O,X,E){return X in O?Object.defineProperty(O,X,{value:E,enumerable:!0,configurable:!0,writable:!0}):O[X]=E,O}var Q=Y("./end-of-stream"),H=Symbol("lastResolve"),b=Symbol("lastReject"),C=Symbol("error"),R=Symbol("ended"),T=Symbol("lastPromise"),v=Symbol("handlePromise"),y=Symbol("stream");function x(O,X){return{value:O,done:X}}function A(O){var X=O[H];if(null!==X){var E=O[y].read();null!==E&&(O[T]=null,O[H]=null,O[b]=null,X(x(E,!1)))}}function z(O){W.nextTick(A,O)}var K=Object.getPrototypeOf(function(){}),ue=Object.setPrototypeOf((F(j={get stream(){return this[y]},next:function(){var X=this,E=this[C];if(null!==E)return Promise.reject(E);if(this[R])return Promise.resolve(x(void 0,!0));if(this[y].destroyed)return new Promise(function(oe,te){W.nextTick(function(){X[C]?te(X[C]):oe(x(void 0,!0))})});var Z,$=this[T];if($)Z=new Promise(function(O,X){return function(E,$){O.then(function(){X[R]?E(x(void 0,!0)):X[v](E,$)},$)}}($,this));else{var ae=this[y].read();if(null!==ae)return Promise.resolve(x(ae,!1));Z=new Promise(this[v])}return this[T]=Z,Z}},Symbol.asyncIterator,function(){return this}),F(j,"return",function(){var X=this;return new Promise(function(E,$){X[y].destroy(null,function(Z){Z?$(Z):E(x(void 0,!0))})})}),j),K);xe.exports=function(X){var E,$=Object.create(ue,(F(E={},y,{value:X,writable:!0}),F(E,H,{value:null,writable:!0}),F(E,b,{value:null,writable:!0}),F(E,C,{value:null,writable:!0}),F(E,R,{value:X._readableState.endEmitted,writable:!0}),F(E,v,{value:function(ae,oe){var te=$[y].read();te?($[T]=null,$[H]=null,$[b]=null,ae(x(te,!1))):($[H]=ae,$[b]=oe)},writable:!0}),E));return $[T]=null,Q(X,function(Z){if(Z&&"ERR_STREAM_PREMATURE_CLOSE"!==Z.code){var ae=$[b];return null!==ae&&($[T]=null,$[H]=null,$[b]=null,ae(Z)),void($[C]=Z)}var oe=$[H];null!==oe&&($[T]=null,$[H]=null,$[b]=null,oe(x(void 0,!0))),$[R]=!0}),X.on("readable",z.bind(null,$)),$}}).call(this)}).call(this,Y("_process"))},{"./end-of-stream":76,_process:44}],74:[function(Y,xe,he){"use strict";function W(A,z){var N=Object.keys(A);if(Object.getOwnPropertySymbols){var K=Object.getOwnPropertySymbols(A);z&&(K=K.filter(function(ue){return Object.getOwnPropertyDescriptor(A,ue).enumerable})),N.push.apply(N,K)}return N}function F(A,z,N){return z in A?Object.defineProperty(A,z,{value:N,enumerable:!0,configurable:!0,writable:!0}):A[z]=N,A}function H(A,z){for(var N=0;N<z.length;N++){var K=z[N];K.enumerable=K.enumerable||!1,K.configurable=!0,"value"in K&&(K.writable=!0),Object.defineProperty(A,K.key,K)}}var R=Y("buffer").Buffer,v=Y("util").inspect,y=v&&v.custom||"inspect";function x(A,z,N){R.prototype.copy.call(A,z,N)}xe.exports=function(){function A(){(function(A,z){if(!(A instanceof z))throw new TypeError("Cannot call a class as a function")})(this,A),this.head=null,this.tail=null,this.length=0}return function(A,z,N){z&&H(A.prototype,z),N&&H(A,N)}(A,[{key:"push",value:function(N){var K={data:N,next:null};this.length>0?this.tail.next=K:this.head=K,this.tail=K,++this.length}},{key:"unshift",value:function(N){var K={data:N,next:this.head};0===this.length&&(this.tail=K),this.head=K,++this.length}},{key:"shift",value:function(){if(0!==this.length){var N=this.head.data;return this.head=1===this.length?this.tail=null:this.head.next,--this.length,N}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(N){if(0===this.length)return"";for(var K=this.head,ue=""+K.data;K=K.next;)ue+=N+K.data;return ue}},{key:"concat",value:function(N){if(0===this.length)return R.alloc(0);for(var K=R.allocUnsafe(N>>>0),ue=this.head,I=0;ue;)x(ue.data,K,I),I+=ue.data.length,ue=ue.next;return K}},{key:"consume",value:function(N,K){var ue;return N<this.head.data.length?(ue=this.head.data.slice(0,N),this.head.data=this.head.data.slice(N)):ue=N===this.head.data.length?this.shift():K?this._getString(N):this._getBuffer(N),ue}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(N){var K=this.head,ue=1,I=K.data;for(N-=I.length;K=K.next;){var O=K.data,X=N>O.length?O.length:N;if(I+=X===O.length?O:O.slice(0,N),0==(N-=X)){X===O.length?(++ue,this.head=K.next?K.next:this.tail=null):(this.head=K,K.data=O.slice(X));break}++ue}return this.length-=ue,I}},{key:"_getBuffer",value:function(N){var K=R.allocUnsafe(N),ue=this.head,I=1;for(ue.data.copy(K),N-=ue.data.length;ue=ue.next;){var O=ue.data,X=N>O.length?O.length:N;if(O.copy(K,K.length-N,0,X),0==(N-=X)){X===O.length?(++I,this.head=ue.next?ue.next:this.tail=null):(this.head=ue,ue.data=O.slice(X));break}++I}return this.length-=I,K}},{key:y,value:function(N,K){return v(this,function(A){for(var z=1;z<arguments.length;z++){var N=null!=arguments[z]?arguments[z]:{};z%2?W(Object(N),!0).forEach(function(K){F(A,K,N[K])}):Object.getOwnPropertyDescriptors?Object.defineProperties(A,Object.getOwnPropertyDescriptors(N)):W(Object(N)).forEach(function(K){Object.defineProperty(A,K,Object.getOwnPropertyDescriptor(N,K))})}return A}({},K,{depth:0,customInspect:!1}))}}]),A}()},{buffer:6,util:3}],75:[function(Y,xe,he){(function(W){(function(){"use strict";function F(R,T){b(R,T),Q(R)}function Q(R){R._writableState&&!R._writableState.emitClose||R._readableState&&!R._readableState.emitClose||R.emit("close")}function b(R,T){R.emit("error",T)}xe.exports={destroy:function(R,T){var v=this;return this._readableState&&this._readableState.destroyed||this._writableState&&this._writableState.destroyed?(T?T(R):R&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,W.nextTick(b,this,R)):W.nextTick(b,this,R)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(R||null,function(A){!T&&A?v._writableState?v._writableState.errorEmitted?W.nextTick(Q,v):(v._writableState.errorEmitted=!0,W.nextTick(F,v,A)):W.nextTick(F,v,A):T?(W.nextTick(Q,v),T(A)):W.nextTick(Q,v)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(R,T){var v=R._readableState,y=R._writableState;v&&v.autoDestroy||y&&y.autoDestroy?R.destroy(T):R.emit("error",T)}}}).call(this)}).call(this,Y("_process"))},{_process:44}],76:[function(Y,xe,he){"use strict";var W=Y("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function F(){}xe.exports=function H(b,C,R){if("function"==typeof C)return H(b,null,C);C||(C={}),R=function(b){var C=!1;return function(){if(!C){C=!0;for(var R=arguments.length,T=new Array(R),v=0;v<R;v++)T[v]=arguments[v];b.apply(this,T)}}}(R||F);var T=C.readable||!1!==C.readable&&b.readable,v=C.writable||!1!==C.writable&&b.writable,y=function(){b.writable||A()},x=b._writableState&&b._writableState.finished,A=function(){v=!1,x=!0,T||R.call(b)},z=b._readableState&&b._readableState.endEmitted,N=function(){T=!1,z=!0,v||R.call(b)},K=function(X){R.call(b,X)},ue=function(){var X;return T&&!z?((!b._readableState||!b._readableState.ended)&&(X=new W),R.call(b,X)):v&&!x?((!b._writableState||!b._writableState.ended)&&(X=new W),R.call(b,X)):void 0},I=function(){b.req.on("finish",A)};return function(b){return b.setHeader&&"function"==typeof b.abort}(b)?(b.on("complete",A),b.on("abort",ue),b.req?I():b.on("request",I)):v&&!b._writableState&&(b.on("end",y),b.on("close",y)),b.on("end",N),b.on("finish",A),!1!==C.error&&b.on("error",K),b.on("close",ue),function(){b.removeListener("complete",A),b.removeListener("abort",ue),b.removeListener("request",I),b.req&&b.req.removeListener("finish",A),b.removeListener("end",y),b.removeListener("close",y),b.removeListener("finish",A),b.removeListener("end",N),b.removeListener("error",K),b.removeListener("close",ue)}}},{"../../../errors":67}],77:[function(Y,xe,he){xe.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],78:[function(Y,xe,he){"use strict";var W;var F=Y("../../../errors").codes,Q=F.ERR_MISSING_ARGS,H=F.ERR_STREAM_DESTROYED;function b(A){if(A)throw A}function R(A,z,N,K){K=function(A){var z=!1;return function(){z||(z=!0,A.apply(void 0,arguments))}}(K);var ue=!1;A.on("close",function(){ue=!0}),void 0===W&&(W=Y("./end-of-stream")),W(A,{readable:z,writable:N},function(O){if(O)return K(O);ue=!0,K()});var I=!1;return function(O){if(!ue&&!I){if(I=!0,function(A){return A.setHeader&&"function"==typeof A.abort}(A))return A.abort();if("function"==typeof A.destroy)return A.destroy();K(O||new H("pipe"))}}}function T(A){A()}function v(A,z){return A.pipe(z)}function y(A){return A.length&&"function"==typeof A[A.length-1]?A.pop():b}xe.exports=function(){for(var A=arguments.length,z=new Array(A),N=0;N<A;N++)z[N]=arguments[N];var K=y(z);if(Array.isArray(z[0])&&(z=z[0]),z.length<2)throw new Q("streams");var ue,I=z.map(function(O,X){var E=X<z.length-1;return R(O,E,X>0,function(Z){ue||(ue=Z),Z&&I.forEach(T),!E&&(I.forEach(T),K(ue))})});return z.reduce(v)}},{"../../../errors":67,"./end-of-stream":76}],79:[function(Y,xe,he){"use strict";var W=Y("../../../errors").codes.ERR_INVALID_OPT_VALUE;xe.exports={getHighWaterMark:function(Q,H,b,C){var R=function(Q,H,b){return null!=Q.highWaterMark?Q.highWaterMark:H?Q[b]:null}(H,C,b);if(null!=R){if(!isFinite(R)||Math.floor(R)!==R||R<0)throw new W(C?b:"highWaterMark",R);return Math.floor(R)}return Q.objectMode?16:16384}}},{"../../../errors":67}],80:[function(Y,xe,he){xe.exports=Y("events").EventEmitter},{events:8}],81:[function(Y,xe,he){(he=xe.exports=Y("./lib/_stream_readable.js")).Stream=he,he.Readable=he,he.Writable=Y("./lib/_stream_writable.js"),he.Duplex=Y("./lib/_stream_duplex.js"),he.Transform=Y("./lib/_stream_transform.js"),he.PassThrough=Y("./lib/_stream_passthrough.js"),he.finished=Y("./lib/internal/streams/end-of-stream.js"),he.pipeline=Y("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":68,"./lib/_stream_passthrough.js":69,"./lib/_stream_readable.js":70,"./lib/_stream_transform.js":71,"./lib/_stream_writable.js":72,"./lib/internal/streams/end-of-stream.js":76,"./lib/internal/streams/pipeline.js":78}],82:[function(Y,xe,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),function(j){for(var F in j)he.hasOwnProperty(F)||(he[F]=j[F])}(Y("./lib/Resolve"))},{"./lib/Resolve":83}],83:[function(Y,xe,he){"use strict";function j(H){const b=[];let C=0;for(;C<H.length;)switch(H[C]){case"/":if("."===H[C+1])if("."===H[C+2]){if(!Q(H[C+3])){b.push([]),C++;break}b.pop(),H[C+3]||b.push([]),C+=3}else{if(!Q(H[C+2])){b.push([]),C++;break}H[C+2]||b.push([]),C+=2}else b.push([]),C++;break;case"#":case"?":b.length||b.push([]),b[b.length-1].push(H.substr(C)),C=H.length;break;default:b.length||b.push([]),b[b.length-1].push(H[C]),C++}return"/"+b.map(R=>R.join("")).join("/")}function F(H,b){let C=b+1;b>=0?"/"===H[b+1]&&"/"===H[b+2]&&(C=b+3):"/"===H[0]&&"/"===H[1]&&(C=2);const R=H.indexOf("/",C);return R<0?H:H.substr(0,R)+j(H.substr(R))}function Q(H){return!H||"#"===H||"?"===H||"/"===H}Object.defineProperty(he,"__esModule",{value:!0}),he.resolve=function(H,b){const C=(b=b||"").indexOf("#");if(C>0&&(b=b.substr(0,C)),!H.length){if(b.indexOf(":")<0)throw new Error(`Found invalid baseIRI '${b}' for value '${H}'`);return b}if(H.startsWith("?")){const z=b.indexOf("?");return z>0&&(b=b.substr(0,z)),b+H}if(H.startsWith("#"))return b+H;if(!b.length){const z=H.indexOf(":");if(z<0)throw new Error(`Found invalid relative IRI '${H}' for a missing baseIRI`);return F(H,z)}const R=H.indexOf(":");if(R>=0)return F(H,R);const T=b.indexOf(":");if(T<0)throw new Error(`Found invalid baseIRI '${b}' for value '${H}'`);const v=b.substr(0,T+1);if(0===H.indexOf("//"))return v+F(H,R);let y;if(b.indexOf("//",T)===T+1){if(y=b.indexOf("/",T+3),y<0)return b.length>T+3?b+"/"+F(H,R):v+F(H,R)}else if(y=b.indexOf("/",T+1),y<0)return v+F(H,R);if(0===H.indexOf("/"))return b.substr(0,y)+j(H);let x=b.substr(y);const A=x.lastIndexOf("/");return A>=0&&A<x.length-1&&(x=x.substr(0,A+1),"."===H[0]&&"."!==H[1]&&"/"!==H[1]&&H[2]&&(H=H.substr(1))),H=j(H=x+H),b.substr(0,y)+H},he.removeDotSegments=j,he.removeDotSegmentsOfPath=F},{}],84:[function(Y,xe,he){var W=Y("buffer"),j=W.Buffer;function F(H,b){for(var C in H)b[C]=H[C]}function Q(H,b,C){return j(H,b,C)}j.from&&j.alloc&&j.allocUnsafe&&j.allocUnsafeSlow?xe.exports=W:(F(W,he),he.Buffer=Q),Q.prototype=Object.create(j.prototype),F(j,Q),Q.from=function(H,b,C){if("number"==typeof H)throw new TypeError("Argument must not be a number");return j(H,b,C)},Q.alloc=function(H,b,C){if("number"!=typeof H)throw new TypeError("Argument must be a number");var R=j(H);return void 0!==b?"string"==typeof C?R.fill(b,C):R.fill(b):R.fill(0),R},Q.allocUnsafe=function(H){if("number"!=typeof H)throw new TypeError("Argument must be a number");return j(H)},Q.allocUnsafeSlow=function(H){if("number"!=typeof H)throw new TypeError("Argument must be a number");return W.SlowBuffer(H)}},{buffer:6}],85:[function(Y,xe,he){(function(W){(function(){!function(j){j.parser=function(q,G){return new Q(q,G)},j.SAXParser=Q,j.SAXStream=y,j.createStream=function(q,G){return new y(q,G)},j.MAX_BUFFER_LENGTH=65536;var R,F=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];function Q(q,G){if(!(this instanceof Q))return new Q(q,G);var pe=this;(function(q){for(var G=0,pe=F.length;G<pe;G++)q[F[G]]=""})(pe),pe.q=pe.c="",pe.bufferCheckPosition=j.MAX_BUFFER_LENGTH,pe.opt=G||{},pe.opt.lowercase=pe.opt.lowercase||pe.opt.lowercasetags,pe.looseCase=pe.opt.lowercase?"toLowerCase":"toUpperCase",pe.tags=[],pe.closed=pe.closedRoot=pe.sawRoot=!1,pe.tag=pe.error=null,pe.strict=!!q,pe.noscript=!(!q&&!pe.opt.noscript),pe.state=te.BEGIN,pe.strictEntities=pe.opt.strictEntities,pe.ENTITIES=Object.create(pe.strictEntities?j.XML_ENTITIES:j.ENTITIES),pe.attribList=[],pe.opt.xmlns&&(pe.ns=Object.create(K)),pe.trackPosition=!1!==pe.opt.position,pe.trackPosition&&(pe.position=pe.line=pe.column=0),me(pe,"onready")}j.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(q){function G(){}return G.prototype=q,new G}),Object.keys||(Object.keys=function(q){var G=[];for(var pe in q)q.hasOwnProperty(pe)&&G.push(pe);return G}),Q.prototype={end:function(){st(this)},write:function(q){var G=this;if(this.error)throw this.error;if(G.closed)return $e(G,"Cannot write after close. Assign an onready handler.");if(null===q)return st(G);"object"==typeof q&&(q=q.toString());for(var pe=0,de="";de=qe(q,pe++),G.c=de,de;)switch(G.trackPosition&&(G.position++,"\n"===de?(G.line++,G.column=0):G.column++),G.state){case te.BEGIN:if(G.state=te.BEGIN_WHITESPACE,"\ufeff"===de)continue;Ue(G,de);continue;case te.BEGIN_WHITESPACE:Ue(G,de);continue;case te.TEXT:if(G.sawRoot&&!G.closedRoot){for(var je=pe-1;de&&"<"!==de&&"&"!==de;)(de=qe(q,pe++))&&G.trackPosition&&(G.position++,"\n"===de?(G.line++,G.column=0):G.column++);G.textNode+=q.substring(je,pe-1)}"<"!==de||G.sawRoot&&G.closedRoot&&!G.strict?(!E(de)&&(!G.sawRoot||G.closedRoot)&&Qe(G,"Text data outside of root node."),"&"===de?G.state=te.TEXT_ENTITY:G.textNode+=de):(G.state=te.OPEN_WAKA,G.startTagPosition=G.position);continue;case te.SCRIPT:"<"===de?G.state=te.SCRIPT_ENDING:G.script+=de;continue;case te.SCRIPT_ENDING:"/"===de?G.state=te.CLOSE_TAG:(G.script+="<"+de,G.state=te.SCRIPT);continue;case te.OPEN_WAKA:"!"===de?(G.state=te.SGML_DECL,G.sgmlDecl=""):E(de)||(ae(ue,de)?(G.state=te.OPEN_TAG,G.tagName=de):"/"===de?(G.state=te.CLOSE_TAG,G.tagName=""):"?"===de?(G.state=te.PROC_INST,G.procInstName=G.procInstBody=""):(Qe(G,"Unencoded <"),G.startTagPosition+1<G.position&&(de=new Array(G.position-G.startTagPosition).join(" ")+de),G.textNode+="<"+de,G.state=te.TEXT));continue;case te.SGML_DECL:"[CDATA["===(G.sgmlDecl+de).toUpperCase()?(ne(G,"onopencdata"),G.state=te.CDATA,G.sgmlDecl="",G.cdata=""):G.sgmlDecl+de==="--"?(G.state=te.COMMENT,G.comment="",G.sgmlDecl=""):"DOCTYPE"===(G.sgmlDecl+de).toUpperCase()?(G.state=te.DOCTYPE,(G.doctype||G.sawRoot)&&Qe(G,"Inappropriately located doctype declaration"),G.doctype="",G.sgmlDecl=""):">"===de?(ne(G,"onsgmldeclaration",G.sgmlDecl),G.sgmlDecl="",G.state=te.TEXT):($(de)&&(G.state=te.SGML_DECL_QUOTED),G.sgmlDecl+=de);continue;case te.SGML_DECL_QUOTED:de===G.q&&(G.state=te.SGML_DECL,G.q=""),G.sgmlDecl+=de;continue;case te.DOCTYPE:">"===de?(G.state=te.TEXT,ne(G,"ondoctype",G.doctype),G.doctype=!0):(G.doctype+=de,"["===de?G.state=te.DOCTYPE_DTD:$(de)&&(G.state=te.DOCTYPE_QUOTED,G.q=de));continue;case te.DOCTYPE_QUOTED:G.doctype+=de,de===G.q&&(G.q="",G.state=te.DOCTYPE);continue;case te.DOCTYPE_DTD:G.doctype+=de,"]"===de?G.state=te.DOCTYPE:$(de)&&(G.state=te.DOCTYPE_DTD_QUOTED,G.q=de);continue;case te.DOCTYPE_DTD_QUOTED:G.doctype+=de,de===G.q&&(G.state=te.DOCTYPE_DTD,G.q="");continue;case te.COMMENT:"-"===de?G.state=te.COMMENT_ENDING:G.comment+=de;continue;case te.COMMENT_ENDING:"-"===de?(G.state=te.COMMENT_ENDED,G.comment=Oe(G.opt,G.comment),G.comment&&ne(G,"oncomment",G.comment),G.comment=""):(G.comment+="-"+de,G.state=te.COMMENT);continue;case te.COMMENT_ENDED:">"!==de?(Qe(G,"Malformed comment"),G.comment+="--"+de,G.state=te.COMMENT):G.state=te.TEXT;continue;case te.CDATA:"]"===de?G.state=te.CDATA_ENDING:G.cdata+=de;continue;case te.CDATA_ENDING:"]"===de?G.state=te.CDATA_ENDING_2:(G.cdata+="]"+de,G.state=te.CDATA);continue;case te.CDATA_ENDING_2:">"===de?(G.cdata&&ne(G,"oncdata",G.cdata),ne(G,"onclosecdata"),G.cdata="",G.state=te.TEXT):"]"===de?G.cdata+="]":(G.cdata+="]]"+de,G.state=te.CDATA);continue;case te.PROC_INST:"?"===de?G.state=te.PROC_INST_ENDING:E(de)?G.state=te.PROC_INST_BODY:G.procInstName+=de;continue;case te.PROC_INST_BODY:if(!G.procInstBody&&E(de))continue;"?"===de?G.state=te.PROC_INST_ENDING:G.procInstBody+=de;continue;case te.PROC_INST_ENDING:">"===de?(ne(G,"onprocessinginstruction",{name:G.procInstName,body:G.procInstBody}),G.procInstName=G.procInstBody="",G.state=te.TEXT):(G.procInstBody+="?"+de,G.state=te.PROC_INST_BODY);continue;case te.OPEN_TAG:ae(I,de)?G.tagName+=de:(tt(G),">"===de?ke(G):"/"===de?G.state=te.OPEN_TAG_SLASH:(E(de)||Qe(G,"Invalid character in tag name"),G.state=te.ATTRIB));continue;case te.OPEN_TAG_SLASH:">"===de?(ke(G,!0),Xe(G)):(Qe(G,"Forward-slash in opening tag not followed by >"),G.state=te.ATTRIB);continue;case te.ATTRIB:if(E(de))continue;">"===de?ke(G):"/"===de?G.state=te.OPEN_TAG_SLASH:ae(ue,de)?(G.attribName=de,G.attribValue="",G.state=te.ATTRIB_NAME):Qe(G,"Invalid attribute name");continue;case te.ATTRIB_NAME:"="===de?G.state=te.ATTRIB_VALUE:">"===de?(Qe(G,"Attribute without value"),G.attribValue=G.attribName,ze(G),ke(G)):E(de)?G.state=te.ATTRIB_NAME_SAW_WHITE:ae(I,de)?G.attribName+=de:Qe(G,"Invalid attribute name");continue;case te.ATTRIB_NAME_SAW_WHITE:if("="===de)G.state=te.ATTRIB_VALUE;else{if(E(de))continue;Qe(G,"Attribute without value"),G.tag.attributes[G.attribName]="",G.attribValue="",ne(G,"onattribute",{name:G.attribName,value:""}),G.attribName="",">"===de?ke(G):ae(ue,de)?(G.attribName=de,G.state=te.ATTRIB_NAME):(Qe(G,"Invalid attribute name"),G.state=te.ATTRIB)}continue;case te.ATTRIB_VALUE:if(E(de))continue;$(de)?(G.q=de,G.state=te.ATTRIB_VALUE_QUOTED):(Qe(G,"Unquoted attribute value"),G.state=te.ATTRIB_VALUE_UNQUOTED,G.attribValue=de);continue;case te.ATTRIB_VALUE_QUOTED:if(de!==G.q){"&"===de?G.state=te.ATTRIB_VALUE_ENTITY_Q:G.attribValue+=de;continue}ze(G),G.q="",G.state=te.ATTRIB_VALUE_CLOSED;continue;case te.ATTRIB_VALUE_CLOSED:E(de)?G.state=te.ATTRIB:">"===de?ke(G):"/"===de?G.state=te.OPEN_TAG_SLASH:ae(ue,de)?(Qe(G,"No whitespace between attributes"),G.attribName=de,G.attribValue="",G.state=te.ATTRIB_NAME):Qe(G,"Invalid attribute name");continue;case te.ATTRIB_VALUE_UNQUOTED:if(!Z(de)){"&"===de?G.state=te.ATTRIB_VALUE_ENTITY_U:G.attribValue+=de;continue}ze(G),">"===de?ke(G):G.state=te.ATTRIB;continue;case te.CLOSE_TAG:if(G.tagName)">"===de?Xe(G):ae(I,de)?G.tagName+=de:G.script?(G.script+="</"+G.tagName,G.tagName="",G.state=te.SCRIPT):(E(de)||Qe(G,"Invalid tagname in closing tag"),G.state=te.CLOSE_TAG_SAW_WHITE);else{if(E(de))continue;oe(ue,de)?G.script?(G.script+="</"+de,G.state=te.SCRIPT):Qe(G,"Invalid tagname in closing tag."):G.tagName=de}continue;case te.CLOSE_TAG_SAW_WHITE:if(E(de))continue;">"===de?Xe(G):Qe(G,"Invalid characters in closing tag");continue;case te.TEXT_ENTITY:case te.ATTRIB_VALUE_ENTITY_Q:case te.ATTRIB_VALUE_ENTITY_U:var pt,we;switch(G.state){case te.TEXT_ENTITY:pt=te.TEXT,we="textNode";break;case te.ATTRIB_VALUE_ENTITY_Q:pt=te.ATTRIB_VALUE_QUOTED,we="attribValue";break;case te.ATTRIB_VALUE_ENTITY_U:pt=te.ATTRIB_VALUE_UNQUOTED,we="attribValue"}";"===de?(G[we]+=Ae(G),G.entity="",G.state=pt):ae(G.entity.length?X:O,de)?G.entity+=de:(Qe(G,"Invalid character in entity name"),G[we]+="&"+G.entity+de,G.entity="",G.state=pt);continue;default:throw new Error(G,"Unknown state: "+G.state)}return G.position>=G.bufferCheckPosition&&function(q){for(var G=Math.max(j.MAX_BUFFER_LENGTH,10),pe=0,de=0,je=F.length;de<je;de++){var _t=q[F[de]].length;if(_t>G)switch(F[de]){case"textNode":ye(q);break;case"cdata":ne(q,"oncdata",q.cdata),q.cdata="";break;case"script":ne(q,"onscript",q.script),q.script="";break;default:$e(q,"Max buffer length exceeded: "+F[de])}pe=Math.max(pe,_t)}q.bufferCheckPosition=j.MAX_BUFFER_LENGTH-pe+q.position}(G),G},resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){!function(q){ye(q),""!==q.cdata&&(ne(q,"oncdata",q.cdata),q.cdata=""),""!==q.script&&(ne(q,"onscript",q.script),q.script="")}(this)}};try{R=Y("stream").Stream}catch(q){R=function(){}}var T=j.EVENTS.filter(function(q){return"error"!==q&&"end"!==q});function y(q,G){if(!(this instanceof y))return new y(q,G);R.apply(this),this._parser=new Q(q,G),this.writable=!0,this.readable=!0;var pe=this;this._parser.onend=function(){pe.emit("end")},this._parser.onerror=function(de){pe.emit("error",de),pe._parser.error=null},this._decoder=null,T.forEach(function(de){Object.defineProperty(pe,"on"+de,{get:function(){return pe._parser["on"+de]},set:function(je){if(!je)return pe.removeAllListeners(de),pe._parser["on"+de]=je,je;pe.on(de,je)},enumerable:!0,configurable:!1})})}(y.prototype=Object.create(R.prototype,{constructor:{value:y}})).write=function(q){if("function"==typeof W&&"function"==typeof W.isBuffer&&W.isBuffer(q)){if(!this._decoder){var G=Y("string_decoder").StringDecoder;this._decoder=new G("utf8")}q=this._decoder.write(q)}return this._parser.write(q.toString()),this.emit("data",q),!0},y.prototype.end=function(q){return q&&q.length&&this.write(q),this._parser.end(),!0},y.prototype.on=function(q,G){var pe=this;return!pe._parser["on"+q]&&-1!==T.indexOf(q)&&(pe._parser["on"+q]=function(){var de=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);de.splice(0,0,q),pe.emit.apply(pe,de)}),R.prototype.on.call(pe,q,G)};var z="http://www.w3.org/XML/1998/namespace",N="http://www.w3.org/2000/xmlns/",K={xml:z,xmlns:N},ue=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,I=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,O=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,X=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function E(q){return" "===q||"\n"===q||"\r"===q||"\t"===q}function $(q){return'"'===q||"'"===q}function Z(q){return">"===q||E(q)}function ae(q,G){return q.test(G)}function oe(q,G){return!ae(q,G)}var q,G,pe,te=0;for(var Ce in j.STATE={BEGIN:te++,BEGIN_WHITESPACE:te++,TEXT:te++,TEXT_ENTITY:te++,OPEN_WAKA:te++,SGML_DECL:te++,SGML_DECL_QUOTED:te++,DOCTYPE:te++,DOCTYPE_QUOTED:te++,DOCTYPE_DTD:te++,DOCTYPE_DTD_QUOTED:te++,COMMENT_STARTING:te++,COMMENT:te++,COMMENT_ENDING:te++,COMMENT_ENDED:te++,CDATA:te++,CDATA_ENDING:te++,CDATA_ENDING_2:te++,PROC_INST:te++,PROC_INST_BODY:te++,PROC_INST_ENDING:te++,OPEN_TAG:te++,OPEN_TAG_SLASH:te++,ATTRIB:te++,ATTRIB_NAME:te++,ATTRIB_NAME_SAW_WHITE:te++,ATTRIB_VALUE:te++,ATTRIB_VALUE_QUOTED:te++,ATTRIB_VALUE_CLOSED:te++,ATTRIB_VALUE_UNQUOTED:te++,ATTRIB_VALUE_ENTITY_Q:te++,ATTRIB_VALUE_ENTITY_U:te++,CLOSE_TAG:te++,CLOSE_TAG_SAW_WHITE:te++,SCRIPT:te++,SCRIPT_ENDING:te++},j.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},j.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(j.ENTITIES).forEach(function(q){var G=j.ENTITIES[q],pe="number"==typeof G?String.fromCharCode(G):G;j.ENTITIES[q]=pe}),j.STATE)j.STATE[j.STATE[Ce]]=Ce;function me(q,G,pe){q[G]&&q[G](pe)}function ne(q,G,pe){q.textNode&&ye(q),me(q,G,pe)}function ye(q){q.textNode=Oe(q.opt,q.textNode),q.textNode&&me(q,"ontext",q.textNode),q.textNode=""}function Oe(q,G){return q.trim&&(G=G.trim()),q.normalize&&(G=G.replace(/\s+/g," ")),G}function $e(q,G){return ye(q),q.trackPosition&&(G+="\nLine: "+q.line+"\nColumn: "+q.column+"\nChar: "+q.c),G=new Error(G),q.error=G,me(q,"onerror",G),q}function st(q){return q.sawRoot&&!q.closedRoot&&Qe(q,"Unclosed root tag"),q.state!==te.BEGIN&&q.state!==te.BEGIN_WHITESPACE&&q.state!==te.TEXT&&$e(q,"Unexpected end"),ye(q),q.c="",q.closed=!0,me(q,"onend"),Q.call(q,q.strict,q.opt),q}function Qe(q,G){if("object"!=typeof q||!(q instanceof Q))throw new Error("bad call to strictFail");q.strict&&$e(q,G)}function tt(q){q.strict||(q.tagName=q.tagName[q.looseCase]());var G=q.tags[q.tags.length-1]||q,pe=q.tag={name:q.tagName,attributes:{}};q.opt.xmlns&&(pe.ns=G.ns),q.attribList.length=0,ne(q,"onopentagstart",pe)}function Ke(q,G){var de=q.indexOf(":")<0?["",q]:q.split(":"),je=de[0],_t=de[1];return G&&"xmlns"===q&&(je="xmlns",_t=""),{prefix:je,local:_t}}function ze(q){if(q.strict||(q.attribName=q.attribName[q.looseCase]()),-1!==q.attribList.indexOf(q.attribName)||q.tag.attributes.hasOwnProperty(q.attribName))q.attribName=q.attribValue="";else{if(q.opt.xmlns){var G=Ke(q.attribName,!0),de=G.local;if("xmlns"===G.prefix)if("xml"===de&&q.attribValue!==z)Qe(q,"xml: prefix must be bound to "+z+"\nActual: "+q.attribValue);else if("xmlns"===de&&q.attribValue!==N)Qe(q,"xmlns: prefix must be bound to "+N+"\nActual: "+q.attribValue);else{var je=q.tag,_t=q.tags[q.tags.length-1]||q;je.ns===_t.ns&&(je.ns=Object.create(_t.ns)),je.ns[de]=q.attribValue}q.attribList.push([q.attribName,q.attribValue])}else q.tag.attributes[q.attribName]=q.attribValue,ne(q,"onattribute",{name:q.attribName,value:q.attribValue});q.attribName=q.attribValue=""}}function ke(q,G){if(q.opt.xmlns){var pe=q.tag,de=Ke(q.tagName);pe.prefix=de.prefix,pe.local=de.local,pe.uri=pe.ns[de.prefix]||"",pe.prefix&&!pe.uri&&(Qe(q,"Unbound namespace prefix: "+JSON.stringify(q.tagName)),pe.uri=de.prefix),pe.ns&&(q.tags[q.tags.length-1]||q).ns!==pe.ns&&Object.keys(pe.ns).forEach(function(Mn){ne(q,"onopennamespace",{prefix:Mn,uri:pe.ns[Mn]})});for(var _t=0,pt=q.attribList.length;_t<pt;_t++){var we=q.attribList[_t],B=we[0],P=we[1],V=Ke(B,!0),Re=V.prefix,St=""===Re?"":pe.ns[Re]||"",Rt={name:B,value:P,prefix:Re,local:V.local,uri:St};Re&&"xmlns"!==Re&&!St&&(Qe(q,"Unbound namespace prefix: "+JSON.stringify(Re)),Rt.uri=Re),q.tag.attributes[B]=Rt,ne(q,"onattribute",Rt)}q.attribList.length=0}q.tag.isSelfClosing=!!G,q.sawRoot=!0,q.tags.push(q.tag),ne(q,"onopentag",q.tag),G||(q.state=q.noscript||"script"!==q.tagName.toLowerCase()?te.TEXT:te.SCRIPT,q.tag=null,q.tagName=""),q.attribName=q.attribValue="",q.attribList.length=0}function Xe(q){if(!q.tagName)return Qe(q,"Weird empty close tag."),q.textNode+="</>",void(q.state=te.TEXT);if(q.script){if("script"!==q.tagName)return q.script+="</"+q.tagName+">",q.tagName="",void(q.state=te.SCRIPT);ne(q,"onscript",q.script),q.script=""}var G=q.tags.length,pe=q.tagName;q.strict||(pe=pe[q.looseCase]());for(var de=pe;G--&&q.tags[G].name!==de;)Qe(q,"Unexpected close tag");if(G<0)return Qe(q,"Unmatched closing tag: "+q.tagName),q.textNode+="</"+q.tagName+">",void(q.state=te.TEXT);q.tagName=pe;for(var _t=q.tags.length;_t-- >G;){var pt=q.tag=q.tags.pop();q.tagName=q.tag.name,ne(q,"onclosetag",q.tagName);var we={};for(var B in pt.ns)we[B]=pt.ns[B];q.opt.xmlns&&pt.ns!==(q.tags[q.tags.length-1]||q).ns&&Object.keys(pt.ns).forEach(function(V){ne(q,"onclosenamespace",{prefix:V,uri:pt.ns[V]})})}0===G&&(q.closedRoot=!0),q.tagName=q.attribValue=q.attribName="",q.attribList.length=0,q.state=te.TEXT}function Ae(q){var de,G=q.entity,pe=G.toLowerCase(),je="";return q.ENTITIES[G]?q.ENTITIES[G]:q.ENTITIES[pe]?q.ENTITIES[pe]:("#"===(G=pe).charAt(0)&&("x"===G.charAt(1)?(G=G.slice(2),je=(de=parseInt(G,16)).toString(16)):(G=G.slice(1),je=(de=parseInt(G,10)).toString(10))),G=G.replace(/^0+/,""),isNaN(de)||je.toLowerCase()!==G?(Qe(q,"Invalid character entity"),"&"+q.entity+";"):String.fromCodePoint(de))}function Ue(q,G){"<"===G?(q.state=te.OPEN_WAKA,q.startTagPosition=q.position):E(G)||(Qe(q,"Non-whitespace before first tag."),q.textNode=G,q.state=te.TEXT)}function qe(q,G){var pe="";return G<q.length&&(pe=q.charAt(G)),pe}te=j.STATE,String.fromCodePoint||(q=String.fromCharCode,G=Math.floor,pe=function(){var de=16384,je=[],we=-1,B=arguments.length;if(!B)return"";for(var P="";++we<B;){var V=Number(arguments[we]);if(!isFinite(V)||V<0||V>1114111||G(V)!==V)throw RangeError("Invalid code point: "+V);V<=65535?je.push(V):je.push(55296+((V-=65536)>>10),V%1024+56320),(we+1===B||je.length>de)&&(P+=q.apply(null,je),je.length=0)}return P},Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:pe,configurable:!0,writable:!0}):String.fromCodePoint=pe)}(void 0===he?this.sax={}:he)}).call(this)}).call(this,Y("buffer").Buffer)},{buffer:6,stream:87,string_decoder:5}],86:[function(Y,xe,he){(function(W,j){(function(){!function(F,Q){"use strict";if(!F.setImmediate){var T,H=1,b={},C=!1,R=F.document,X=Object.getPrototypeOf&&Object.getPrototypeOf(F);X=X&&X.setTimeout?X:F,"[object process]"==={}.toString.call(F.process)?T=function(E){W.nextTick(function(){A(E)})}:function(){if(F.postMessage&&!F.importScripts){var E=!0,$=F.onmessage;return F.onmessage=function(){E=!1},F.postMessage("","*"),F.onmessage=$,E}}()?(E="setImmediate$"+Math.random()+"$",$=function(Z){Z.source===F&&"string"==typeof Z.data&&0===Z.data.indexOf(E)&&A(+Z.data.slice(E.length))},F.addEventListener?F.addEventListener("message",$,!1):F.attachEvent("onmessage",$),T=function(Z){F.postMessage(E+Z,"*")}):F.MessageChannel?function(){var E=new MessageChannel;E.port1.onmessage=function($){A($.data)},T=function($){E.port2.postMessage($)}}():R&&"onreadystatechange"in R.createElement("script")?function(){var E=R.documentElement;T=function($){var Z=R.createElement("script");Z.onreadystatechange=function(){A($),Z.onreadystatechange=null,E.removeChild(Z),Z=null},E.appendChild(Z)}}():T=function(E){setTimeout(A,0,E)},X.setImmediate=function(E){"function"!=typeof E&&(E=new Function(""+E));for(var $=new Array(arguments.length-1),Z=0;Z<$.length;Z++)$[Z]=arguments[Z+1];return b[H]={callback:E,args:$},T(H),H++},X.clearImmediate=y}var E,$;function y(E){delete b[E]}function A(E){if(C)setTimeout(A,0,E);else{var $=b[E];if($){C=!0;try{!function(E){var $=E.callback,Z=E.args;switch(Z.length){case 0:$();break;case 1:$(Z[0]);break;case 2:$(Z[0],Z[1]);break;case 3:$(Z[0],Z[1],Z[2]);break;default:$.apply(void 0,Z)}}($)}finally{y(E),C=!1}}}}}("undefined"==typeof self?void 0===j?this:j:self)}).call(this)}).call(this,Y("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:44}],87:[function(Y,xe,he){xe.exports=F;var W=Y("events").EventEmitter;function F(){W.call(this)}Y("inherits")(F,W),F.Readable=Y("readable-stream/lib/_stream_readable.js"),F.Writable=Y("readable-stream/lib/_stream_writable.js"),F.Duplex=Y("readable-stream/lib/_stream_duplex.js"),F.Transform=Y("readable-stream/lib/_stream_transform.js"),F.PassThrough=Y("readable-stream/lib/_stream_passthrough.js"),F.finished=Y("readable-stream/lib/internal/streams/end-of-stream.js"),F.pipeline=Y("readable-stream/lib/internal/streams/pipeline.js"),F.Stream=F,F.prototype.pipe=function(Q,H){var b=this;function C(z){Q.writable&&!1===Q.write(z)&&b.pause&&b.pause()}function R(){b.readable&&b.resume&&b.resume()}b.on("data",C),Q.on("drain",R),!Q._isStdio&&(!H||!1!==H.end)&&(b.on("end",v),b.on("close",y));var T=!1;function v(){T||(T=!0,Q.end())}function y(){T||(T=!0,"function"==typeof Q.destroy&&Q.destroy())}function x(z){if(A(),0===W.listenerCount(this,"error"))throw z}function A(){b.removeListener("data",C),Q.removeListener("drain",R),b.removeListener("end",v),b.removeListener("close",y),b.removeListener("error",x),Q.removeListener("error",x),b.removeListener("end",A),b.removeListener("close",A),Q.removeListener("close",A)}return b.on("error",x),Q.on("error",x),b.on("end",A),b.on("close",A),Q.on("close",A),Q.emit("pipe",b),Q}},{events:8,inherits:10,"readable-stream/lib/_stream_duplex.js":68,"readable-stream/lib/_stream_passthrough.js":69,"readable-stream/lib/_stream_readable.js":70,"readable-stream/lib/_stream_transform.js":71,"readable-stream/lib/_stream_writable.js":72,"readable-stream/lib/internal/streams/end-of-stream.js":76,"readable-stream/lib/internal/streams/pipeline.js":78}],88:[function(Y,xe,he){arguments[4][5][0].apply(he,arguments)},{dup:5,"safe-buffer":84}],89:[function(Y,xe,he){(function(W,j){(function(){var F=Y("process/browser.js").nextTick,Q=Function.prototype.apply,H=Array.prototype.slice,b={},C=0;function R(T,v){this._id=T,this._clearFn=v}he.setTimeout=function(){return new R(Q.call(setTimeout,window,arguments),clearTimeout)},he.setInterval=function(){return new R(Q.call(setInterval,window,arguments),clearInterval)},he.clearTimeout=he.clearInterval=function(T){T.close()},R.prototype.unref=R.prototype.ref=function(){},R.prototype.close=function(){this._clearFn.call(window,this._id)},he.enroll=function(T,v){clearTimeout(T._idleTimeoutId),T._idleTimeout=v},he.unenroll=function(T){clearTimeout(T._idleTimeoutId),T._idleTimeout=-1},he._unrefActive=he.active=function(T){clearTimeout(T._idleTimeoutId);var v=T._idleTimeout;v>=0&&(T._idleTimeoutId=setTimeout(function(){T._onTimeout&&T._onTimeout()},v))},he.setImmediate="function"==typeof W?W:function(T){var v=C++,y=!(arguments.length<2)&&H.call(arguments,1);return b[v]=!0,F(function(){b[v]&&(y?T.apply(null,y):T.call(null),he.clearImmediate(v))}),v},he.clearImmediate="function"==typeof j?j:function(T){delete b[T]}}).call(this)}).call(this,Y("timers").setImmediate,Y("timers").clearImmediate)},{"process/browser.js":44,timers:89}],90:[function(Y,xe,he){(function(W){(function(){function F(Q){try{if(!W.localStorage)return!1}catch(b){return!1}var H=W.localStorage[Q];return null!=H&&"true"===String(H).toLowerCase()}xe.exports=function(Q,H){if(F("noDeprecation"))return Q;var b=!1;return function(){if(!b){if(F("throwDeprecation"))throw new Error(H);F("traceDeprecation")?console.trace(H):console.warn(H),b=!0}return Q.apply(this,arguments)}}}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],91:[function(Y,xe,he){"use strict";xe.exports=function(W){W.prototype[Symbol.iterator]=function*(){for(let j=this.head;j;j=j.next)yield j.value}}},{}],92:[function(Y,xe,he){"use strict";function W(b){var C=this;if(C instanceof W||(C=new W),C.tail=null,C.head=null,C.length=0,b&&"function"==typeof b.forEach)b.forEach(function(v){C.push(v)});else if(arguments.length>0)for(var R=0,T=arguments.length;R<T;R++)C.push(arguments[R]);return C}function j(b,C,R){var T=C===b.head?new H(R,null,C,b):new H(R,C,C.next,b);return null===T.next&&(b.tail=T),null===T.prev&&(b.head=T),b.length++,T}function F(b,C){b.tail=new H(C,b.tail,null,b),b.head||(b.head=b.tail),b.length++}function Q(b,C){b.head=new H(C,null,b.head,b),b.tail||(b.tail=b.head),b.length++}function H(b,C,R,T){if(!(this instanceof H))return new H(b,C,R,T);this.list=T,this.value=b,C?(C.next=this,this.prev=C):this.prev=null,R?(R.prev=this,this.next=R):this.next=null}xe.exports=W,W.Node=H,W.create=W,W.prototype.removeNode=function(b){if(b.list!==this)throw new Error("removing node which does not belong to this list");var C=b.next,R=b.prev;return C&&(C.prev=R),R&&(R.next=C),b===this.head&&(this.head=C),b===this.tail&&(this.tail=R),b.list.length--,b.next=null,b.prev=null,b.list=null,C},W.prototype.unshiftNode=function(b){if(b!==this.head){b.list&&b.list.removeNode(b);var C=this.head;b.list=this,b.next=C,C&&(C.prev=b),this.head=b,this.tail||(this.tail=b),this.length++}},W.prototype.pushNode=function(b){if(b!==this.tail){b.list&&b.list.removeNode(b);var C=this.tail;b.list=this,b.prev=C,C&&(C.next=b),this.tail=b,this.head||(this.head=b),this.length++}},W.prototype.push=function(){for(var b=0,C=arguments.length;b<C;b++)F(this,arguments[b]);return this.length},W.prototype.unshift=function(){for(var b=0,C=arguments.length;b<C;b++)Q(this,arguments[b]);return this.length},W.prototype.pop=function(){if(this.tail){var b=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,b}},W.prototype.shift=function(){if(this.head){var b=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,b}},W.prototype.forEach=function(b,C){C=C||this;for(var R=this.head,T=0;null!==R;T++)b.call(C,R.value,T,this),R=R.next},W.prototype.forEachReverse=function(b,C){C=C||this;for(var R=this.tail,T=this.length-1;null!==R;T--)b.call(C,R.value,T,this),R=R.prev},W.prototype.get=function(b){for(var C=0,R=this.head;null!==R&&C<b;C++)R=R.next;if(C===b&&null!==R)return R.value},W.prototype.getReverse=function(b){for(var C=0,R=this.tail;null!==R&&C<b;C++)R=R.prev;if(C===b&&null!==R)return R.value},W.prototype.map=function(b,C){C=C||this;for(var R=new W,T=this.head;null!==T;)R.push(b.call(C,T.value,this)),T=T.next;return R},W.prototype.mapReverse=function(b,C){C=C||this;for(var R=new W,T=this.tail;null!==T;)R.push(b.call(C,T.value,this)),T=T.prev;return R},W.prototype.reduce=function(b,C){var R,T=this.head;if(arguments.length>1)R=C;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");T=this.head.next,R=this.head.value}for(var v=0;null!==T;v++)R=b(R,T.value,v),T=T.next;return R},W.prototype.reduceReverse=function(b,C){var R,T=this.tail;if(arguments.length>1)R=C;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");T=this.tail.prev,R=this.tail.value}for(var v=this.length-1;null!==T;v--)R=b(R,T.value,v),T=T.prev;return R},W.prototype.toArray=function(){for(var b=new Array(this.length),C=0,R=this.head;null!==R;C++)b[C]=R.value,R=R.next;return b},W.prototype.toArrayReverse=function(){for(var b=new Array(this.length),C=0,R=this.tail;null!==R;C++)b[C]=R.value,R=R.prev;return b},W.prototype.slice=function(b,C){(C=C||this.length)<0&&(C+=this.length),(b=b||0)<0&&(b+=this.length);var R=new W;if(C<b||C<0)return R;b<0&&(b=0),C>this.length&&(C=this.length);for(var T=0,v=this.head;null!==v&&T<b;T++)v=v.next;for(;null!==v&&T<C;T++,v=v.next)R.push(v.value);return R},W.prototype.sliceReverse=function(b,C){(C=C||this.length)<0&&(C+=this.length),(b=b||0)<0&&(b+=this.length);var R=new W;if(C<b||C<0)return R;b<0&&(b=0),C>this.length&&(C=this.length);for(var T=this.length,v=this.tail;null!==v&&T>C;T--)v=v.prev;for(;null!==v&&T>b;T--,v=v.prev)R.push(v.value);return R},W.prototype.splice=function(b,C,...R){b>this.length&&(b=this.length-1),b<0&&(b=this.length+b);for(var T=0,v=this.head;null!==v&&T<b;T++)v=v.next;var y=[];for(T=0;v&&T<C;T++)y.push(v.value),v=this.removeNode(v);for(null===v&&(v=this.tail),v!==this.head&&v!==this.tail&&(v=v.prev),T=0;T<R.length;T++)v=j(this,v,R[T]);return y},W.prototype.reverse=function(){for(var b=this.head,C=this.tail,R=b;null!==R;R=R.prev){var T=R.prev;R.prev=R.next,R.next=T}return this.head=C,this.tail=b,this};try{Y("./iterator.js")(W)}catch(b){}},{"./iterator.js":91}]},{},[1])(1)},1002:Ut=>{"use strict";Ut.exports=et,Ut.exports.default=et;var it=1e20;function et(Y,xe,he,W,j,F){this.fontSize=Y||24,this.buffer=void 0===xe?3:xe,this.cutoff=W||.25,this.fontFamily=j||"sans-serif",this.fontWeight=F||"normal",this.radius=he||8;var Q=this.size=this.fontSize+2*this.buffer,H=Q+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=Q,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textAlign="left",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(H*H),this.gridInner=new Float64Array(H*H),this.f=new Float64Array(H),this.z=new Float64Array(H+1),this.v=new Uint16Array(H),this.useMetrics=void 0!==this.ctx.measureText("A").actualBoundingBoxLeft,this.middle=Math.round(Q/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function At(Y,xe,he,W,j,F){for(var Q=0;Q<xe;Q++)dt(Y,Q,xe,he,W,j,F);for(var H=0;H<he;H++)dt(Y,H*xe,1,xe,W,j,F)}function dt(Y,xe,he,W,j,F,Q){var H,b,C,R;for(F[0]=0,Q[0]=-it,Q[1]=it,H=0;H<W;H++)j[H]=Y[xe+H*he];for(H=1,b=0,C=0;H<W;H++){do{C=(j[H]-j[R=F[b]]+H*H-R*R)/(H-R)/2}while(C<=Q[b]&&--b>-1);F[++b]=H,Q[b]=C,Q[b+1]=it}for(H=0,b=0;H<W;H++){for(;Q[b+1]<H;)b++;Y[xe+H*he]=j[R=F[b]]+(H-R)*(H-R)}}et.prototype._draw=function(Y,xe){var F,Q,H,b,C,R,T,v,y,he=this.ctx.measureText(Y),W=he.width,j=2*this.buffer;xe&&this.useMetrics?(C=Math.floor(he.actualBoundingBoxAscent),v=this.buffer+Math.ceil(he.actualBoundingBoxAscent),R=this.buffer,T=this.buffer,F=(Q=Math.min(this.size,Math.ceil(he.actualBoundingBoxRight-he.actualBoundingBoxLeft)))+j,H=(b=Math.min(this.size-R,Math.ceil(he.actualBoundingBoxAscent+he.actualBoundingBoxDescent)))+j,this.ctx.textBaseline="alphabetic"):(F=Q=this.size,H=b=this.size,C=19*this.fontSize/24,R=T=0,v=this.middle,this.ctx.textBaseline="middle"),Q&&b&&(this.ctx.clearRect(T,R,Q,b),this.ctx.fillText(Y,this.buffer,v),y=this.ctx.getImageData(T,R,Q,b));var x=new Uint8ClampedArray(F*H);return function(Y,xe,he,W,j,F,Q){F.fill(it,0,xe*he),Q.fill(0,0,xe*he);for(var H=(xe-W)/2,b=0;b<j;b++)for(var C=0;C<W;C++){var R=(b+H)*xe+C+H,T=Y.data[4*(b*W+C)+3]/255;if(1===T)F[R]=0,Q[R]=it;else if(0===T)F[R]=it,Q[R]=0;else{var v=Math.max(0,.5-T),y=Math.max(0,T-.5);F[R]=v*v,Q[R]=y*y}}}(y,F,H,Q,b,this.gridOuter,this.gridInner),At(this.gridOuter,F,H,this.f,this.v,this.z),At(this.gridInner,F,H,this.f,this.v,this.z),function(Y,xe,he,W,j,F,Q){for(var H=0;H<xe*he;H++){var b=Math.sqrt(W[H])-Math.sqrt(j[H]);Y[H]=Math.round(255-255*(b/F+Q))}}(x,F,H,this.gridOuter,this.gridInner,this.radius,this.cutoff),{data:x,metrics:{width:Q,height:b,sdfWidth:F,sdfHeight:H,top:C,left:0,advance:W}}},et.prototype.draw=function(Y){return this._draw(Y,!1).data},et.prototype.drawWithMetrics=function(Y){return this._draw(Y,!0)}},322:Ut=>{Ut.exports=function(et,yt){var ee=yt.length;if(0!==ee){var At=et.length;et.length+=ee;for(var dt=0;dt<ee;dt++)et[At+dt]=yt[dt]}}},4517:(Ut,it)=>{"use strict";var yt=(()=>{return(At=yt||(yt={})).typeOfFunction="function",At.boolTrue=!0,yt;var At})();function ee(At,dt,Y){if(!Y||typeof Y.value!==yt.typeOfFunction)throw new TypeError("Only methods can be decorated with @bind. <"+dt+"> is not a method!");return{configurable:yt.boolTrue,get:function(){var xe=Y.value.bind(this);return Object.defineProperty(this,dt,{value:xe,configurable:yt.boolTrue,writable:yt.boolTrue}),xe}}}it.ak=ee,it.ZP=ee},7266:(Ut,it,et)=>{Ut.exports={ResizeSensor:et(9835),ElementQueries:et(4845)}},4845:function(Ut,it,et){"use strict";var yt,ee,At;"undefined"!=typeof window&&window,ee=[et(9835)],void 0!==(At="function"==typeof(yt=function(dt){var Y=function(){var he,W={},j=[];function F(I){I||(I=document.documentElement);var O=window.getComputedStyle(I,null).fontSize;return parseFloat(O)||16}function H(I,O){var X=O.split(/\d/),E=X[X.length-1];switch(O=parseFloat(O),E){case"px":return O;case"em":return O*F(I);case"rem":return O*F();case"vw":return O*document.documentElement.clientWidth/100;case"vh":return O*document.documentElement.clientHeight/100;case"vmin":case"vmax":var $=document.documentElement.clientWidth/100,Z=document.documentElement.clientHeight/100;return O*(0,Math["vmin"===E?"min":"max"])($,Z);default:return O}}function b(I,O){this.element=I;var X,E,$,Z,ae,oe,te,Ce,me=["min-width","min-height","max-width","max-height"];this.call=function(){for(X in $=function(I){if(!I.getBoundingClientRect)return{width:I.offsetWidth,height:I.offsetHeight};var O=I.getBoundingClientRect();return{width:Math.round(O.width),height:Math.round(O.height)}}(this.element),oe={},W[O])!W[O].hasOwnProperty(X)||(Z=H(this.element,(E=W[O][X]).value),ae="width"===E.property?$.width:$.height,te="","min"===E.mode&&ae>=Z&&(te+=E.value),"max"===E.mode&&ae<=Z&&(te+=E.value),oe[Ce=E.mode+"-"+E.property]||(oe[Ce]=""),te&&-1===(" "+oe[Ce]+" ").indexOf(" "+te+" ")&&(oe[Ce]+=" "+te));for(var ne in me)!me.hasOwnProperty(ne)||(oe[me[ne]]?this.element.setAttribute(me[ne],oe[me[ne]].substr(1)):this.element.removeAttribute(me[ne]))}}function C(I,O){I.elementQueriesSetupInformation||(I.elementQueriesSetupInformation=new b(I,O)),I.elementQueriesSensor||(I.elementQueriesSensor=new dt(I,function(){I.elementQueriesSetupInformation.call()}))}function R(I,O,X,E){if(void 0===W[I]){W[I]=[];var $=j.length;he.innerHTML+="\n"+I+" {animation: 0.1s element-queries;}",he.innerHTML+="\n"+I+" > .resize-sensor {min-width: "+$+"px;}",j.push(I)}W[I].push({mode:O,property:X,value:E})}function T(I){var O;if(document.querySelectorAll&&(O=I?I.querySelectorAll.bind(I):document.querySelectorAll.bind(document)),!O&&"undefined"!=typeof $$&&(O=$$),!O&&"undefined"!=typeof jQuery&&(O=jQuery),!O)throw"No document.querySelectorAll, jQuery or Mootools's $$ found.";return O}function y(I){var O=[],X=[],E=[],$=0,Z=-1,ae=[];for(var oe in I.children)if(I.children.hasOwnProperty(oe)&&I.children[oe].tagName&&"img"===I.children[oe].tagName.toLowerCase()){O.push(I.children[oe]);var te=I.children[oe].getAttribute("min-width")||I.children[oe].getAttribute("data-min-width"),Ce=I.children[oe].getAttribute("data-src")||I.children[oe].getAttribute("url");E.push(Ce),X.push({minWidth:te}),te?I.children[oe].style.display="none":($=O.length-1,I.children[oe].style.display="block")}function ne(){var Oe,ye=!1;for(Oe in O)!O.hasOwnProperty(Oe)||X[Oe].minWidth&&I.offsetWidth>X[Oe].minWidth&&(ye=Oe);if(ye||(ye=$),Z!==ye)if(ae[ye])O[Z].style.display="none",O[ye].style.display="block",Z=ye;else{var $e=new Image;$e.onload=function(){O[ye].src=E[ye],O[Z].style.display="none",O[ye].style.display="block",ae[ye]=!0,Z=ye},$e.src=E[ye]}else O[ye].src=E[ye]}Z=$,I.resizeSensorInstance=new dt(I,ne),ne()}var A=/,?[\s\t]*([^,\n]*?)((?:\[[\s\t]*?(?:min|max)-(?:width|height)[\s\t]*?[~$\^]?=[\s\t]*?"[^"]*?"[\s\t]*?])+)([^,\n\s\{]*)/gim,z=/\[[\s\t]*?(min|max)-(width|height)[\s\t]*?[~$\^]?=[\s\t]*?"([^"]*?)"[\s\t]*?]/gim;function N(I){var O,X,E,$;for(I=I.replace(/'/g,'"');null!==(O=A.exec(I));)for(X=O[1]+O[3],E=O[2];null!==($=z.exec(E));)R(X,$[1],$[2],$[3])}function K(I){var O="";if(I)if("string"==typeof I)(-1!==(I=I.toLowerCase()).indexOf("min-width")||-1!==I.indexOf("max-width"))&&N(I);else for(var X=0,E=I.length;X<E;X++)1===I[X].type?(-1!==(O=I[X].selectorText||I[X].cssText).indexOf("min-height")||-1!==O.indexOf("max-height")||-1!==O.indexOf("min-width")||-1!==O.indexOf("max-width"))&&N(O):4===I[X].type?K(I[X].cssRules||I[X].rules):3===I[X].type&&I[X].styleSheet.hasOwnProperty("cssRules")&&K(I[X].styleSheet.cssRules)}var ue=!1;this.init=function(){var I="animationstart";void 0!==document.documentElement.style.webkitAnimationName?I="webkitAnimationStart":void 0!==document.documentElement.style.MozAnimationName?I="mozanimationstart":void 0!==document.documentElement.style.OAnimationName&&(I="oanimationstart"),document.body.addEventListener(I,function(E){var $=E.target,Z=$&&window.getComputedStyle($,null),ae=Z&&Z.getPropertyValue("animation-name");if(ae&&-1!==ae.indexOf("element-queries")){$.elementQueriesSensor=new dt($,function(){$.elementQueriesSetupInformation&&$.elementQueriesSetupInformation.call()});var Ce=window.getComputedStyle($.resizeSensor,null).getPropertyValue("min-width");Ce=parseInt(Ce.replace("px","")),C(E.target,j[Ce])}}),ue||((he=document.createElement("style")).type="text/css",he.innerHTML="[responsive-image] > img, [data-responsive-image] {overflow: hidden; padding: 0; } [responsive-image] > img, [data-responsive-image] > img {width: 100%;}",he.innerHTML+="\n@keyframes element-queries { 0% { visibility: inherit; } }",document.getElementsByTagName("head")[0].appendChild(he),ue=!0);for(var O=0,X=document.styleSheets.length;O<X;O++)try{document.styleSheets[O].href&&0===document.styleSheets[O].href.indexOf("file://")&&console.warn("CssElementQueries: unable to parse local css files, "+document.styleSheets[O].href),K(document.styleSheets[O].cssRules||document.styleSheets[O].rules||document.styleSheets[O].cssText)}catch(E){}!function(){for(var O=T()("[data-responsive-image],[responsive-image]"),X=0,E=O.length;X<E;X++)y(O[X])}()},this.findElementQueriesElements=function(I){!function(I){var O=T(I);for(var X in W)if(W.hasOwnProperty(X))for(var E=O(X,I),$=0,Z=E.length;$<Z;$++)C(E[$],X)}(I)},this.update=function(){this.init()}};Y.update=function(){Y.instance.update()},Y.detach=function(he){he.elementQueriesSetupInformation?(he.elementQueriesSensor.detach(),delete he.elementQueriesSetupInformation,delete he.elementQueriesSensor):he.resizeSensorInstance&&(he.resizeSensorInstance.detach(),delete he.resizeSensorInstance)},Y.init=function(){Y.instance||(Y.instance=new Y),Y.instance.init()};return Y.findElementQueriesElements=function(he){Y.instance.findElementQueriesElements(he)},Y.listen=function(){!function(he){if(document.addEventListener)document.addEventListener("DOMContentLoaded",he,!1);else if(/KHTML|WebKit|iCab/i.test(navigator.userAgent))var W=setInterval(function(){/loaded|complete/i.test(document.readyState)&&(he(),clearInterval(W))},10);else window.onload=he}(Y.init)},Y})?yt.apply(it,ee):yt)&&(Ut.exports=At)},9835:function(Ut,it,et){"use strict";var yt,ee;"undefined"!=typeof window&&window,void 0!==(ee="function"==typeof(yt=function(){if("undefined"==typeof window)return null;var At="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),dt=At.requestAnimationFrame||At.mozRequestAnimationFrame||At.webkitRequestAnimationFrame||function(Q){return At.setTimeout(Q,20)},Y=At.cancelAnimationFrame||At.mozCancelAnimationFrame||At.webkitCancelAnimationFrame||function(Q){At.clearTimeout(Q)};function xe(Q,H){var b=Object.prototype.toString.call(Q),C="[object Array]"===b||"[object NodeList]"===b||"[object HTMLCollection]"===b||"[object Object]"===b||"undefined"!=typeof jQuery&&Q instanceof jQuery||"undefined"!=typeof Elements&&Q instanceof Elements,R=0,T=Q.length;if(C)for(;R<T;R++)H(Q[R]);else H(Q)}function he(Q){if(!Q.getBoundingClientRect)return{width:Q.offsetWidth,height:Q.offsetHeight};var H=Q.getBoundingClientRect();return{width:Math.round(H.width),height:Math.round(H.height)}}function W(Q,H){Object.keys(H).forEach(function(b){Q.style[b]=H[b]})}var j=function(Q,H){var b=0;function C(){var v,y,T=[];this.add=function(x){T.push(x)},this.call=function(x){for(v=0,y=T.length;v<y;v++)T[v].call(this,x)},this.remove=function(x){var A=[];for(v=0,y=T.length;v<y;v++)T[v]!==x&&A.push(T[v]);T=A},this.length=function(){return T.length}}function R(T,v){if(T){if(T.resizedAttached)return void T.resizedAttached.add(v);T.resizedAttached=new C,T.resizedAttached.add(v),T.resizeSensor=document.createElement("div"),T.resizeSensor.dir="ltr",T.resizeSensor.className="resize-sensor";var y={pointerEvents:"none",position:"absolute",left:"0px",top:"0px",right:"0px",bottom:"0px",overflow:"hidden",zIndex:"-1",visibility:"hidden",maxWidth:"100%"},x={position:"absolute",left:"0px",top:"0px",transition:"0s"};W(T.resizeSensor,y);var A=document.createElement("div");A.className="resize-sensor-expand",W(A,y);var z=document.createElement("div");W(z,x),A.appendChild(z);var N=document.createElement("div");N.className="resize-sensor-shrink",W(N,y);var K=document.createElement("div");W(K,x),W(K,{width:"200%",height:"200%"}),N.appendChild(K),T.resizeSensor.appendChild(A),T.resizeSensor.appendChild(N),T.appendChild(T.resizeSensor);var ue=window.getComputedStyle(T),I=ue?ue.getPropertyValue("position"):null;"absolute"!==I&&"relative"!==I&&"fixed"!==I&&"sticky"!==I&&(T.style.position="relative");var O=!1,X=0,E=he(T),$=0,Z=0,ae=!0;b=0;var te=function(){if(ae){if(0===T.offsetWidth&&0===T.offsetHeight)return void(b||(b=dt(function(){b=0,te()})));ae=!1}var ye,Oe;Oe=T.offsetHeight,z.style.width=(ye=T.offsetWidth)+10+"px",z.style.height=Oe+10+"px",A.scrollLeft=ye+10,A.scrollTop=Oe+10,N.scrollLeft=ye+10,N.scrollTop=Oe+10};T.resizeSensor.resetSensor=te;var Ce=function(){X=0,O&&($=E.width,Z=E.height,T.resizedAttached&&T.resizedAttached.call(E))},me=function(){E=he(T),(O=E.width!==$||E.height!==Z)&&!X&&(X=dt(Ce)),te()},ne=function(ye,Oe,$e){ye.attachEvent?ye.attachEvent("on"+Oe,$e):ye.addEventListener(Oe,$e)};ne(A,"scroll",me),ne(N,"scroll",me),b=dt(function(){b=0,te()})}}xe(Q,function(T){R(T,H)}),this.detach=function(T){b||(Y(b),b=0),j.detach(Q,T)},this.reset=function(){Q.resizeSensor.resetSensor()}};if(j.reset=function(Q){xe(Q,function(H){H.resizeSensor.resetSensor()})},j.detach=function(Q,H){xe(Q,function(b){!b||b.resizedAttached&&"function"==typeof H&&(b.resizedAttached.remove(H),b.resizedAttached.length())||b.resizeSensor&&(b.contains(b.resizeSensor)&&b.removeChild(b.resizeSensor),delete b.resizeSensor,delete b.resizedAttached)})},"undefined"!=typeof MutationObserver){var F=new MutationObserver(function(Q){for(var H in Q)if(Q.hasOwnProperty(H))for(var b=Q[H].addedNodes,C=0;C<b.length;C++)b[C].resizeSensor&&j.reset(b[C])});document.addEventListener("DOMContentLoaded",function(Q){F.observe(document.body,{childList:!0,subtree:!0})})}return j})?yt.call(it,et,it,Ut):yt)&&(Ut.exports=ee)},7445:(Ut,it,et)=>{var yt=et(3910),ee=et(9369),At=et(322);function dt(Q,H,b){if(!yt(Q))throw new Error("graphology-shortest-path: invalid graphology instance.");if(arguments.length<3)throw new Error("graphology-shortest-path: invalid number of arguments. Expecting at least 3.");if(!Q.hasNode(H))throw new Error('graphology-shortest-path: the "'+H+'" source node does not exist in the given graph.');if(!Q.hasNode(b))throw new Error('graphology-shortest-path: the "'+b+'" target node does not exist in the given graph.');if((H=""+H)==(b=""+b))return[H];var C=Q.inboundNeighbors.bind(Q),R=Q.outboundNeighbors.bind(Q),T={},v={};T[H]=null,v[b]=null;var A,z,N,K,ue,I,O,X,y=[H],x=[b],E=!1;e:for(;y.length&&x.length;)if(y.length<=x.length){for(A=y,y=[],ue=0,O=A.length;ue<O;ue++)for(I=0,X=(N=R(z=A[ue])).length;I<X;I++)if((K=N[I])in T||(y.push(K),T[K]=z),K in v){E=!0;break e}}else for(A=x,x=[],ue=0,O=A.length;ue<O;ue++)for(z=A[ue],N=C(z),I=0,X=N.length;I<X;I++)if(K=N[I],K in v||(x.push(K),v[K]=z),K in T){E=!0;break e}if(!E)return null;for(var $=[];K;)$.unshift(K),K=T[K];for(K=v[$[$.length-1]];K;)$.push(K),K=v[K];return $.length?$:null}function Y(Q,H){if(!yt(Q))throw new Error("graphology-shortest-path: invalid graphology instance.");if(arguments.length<2)throw new Error("graphology-shortest-path: invalid number of arguments. Expecting at least 2.");if(!Q.hasNode(H))throw new Error('graphology-shortest-path: the "'+H+'" source node does not exist in the given graph.');var R,T,v,y,x,A,b={},C={};for(b[H=""+H]=!0,C[H]=[H];Object.keys(b).length;)for(v in R=b,b={},R)for(x=0,A=(T=Q.outboundNeighbors(v)).length;x<A;x++)C[y=T[x]]||(C[y]=C[v].concat(y),b[y]=!0);return C}function xe(Q,H,b){if(!yt(H))throw new Error("graphology-shortest-path: invalid graphology instance.");if(!H.hasNode(b))throw new Error('graphology-shortest-path: the "'+b+'" source node does not exist in the given graph.');b=""+b;var C=new Set,R={},T=0;R[b]=0;for(var y,x,A,v=[b];0!==v.length;){var z=[];for(y=0,x=v.length;y<x;y++)!C.has(A=v[y])&&(C.add(A),At(z,H[Q](A)),R[A]=T);T++,v=z}return R}var he=xe.bind(null,"outboundNeighbors"),W=xe.bind(null,"neighbors");function j(Q,H,b){return arguments.length<3?Y(Q,H):dt(Q,H,b)}j.bidirectional=dt,j.singleSource=Y,j.singleSourceLength=he,j.undirectedSingleSourceLength=W,j.brandes=function(Q,H){H=""+H;var v,y,x,A,z,N,K,ue,I,b=[],C={},R={},T=Q.nodes();for(N=0,ue=T.length;N<ue;N++)C[A=T[N]]=[],R[A]=0;var O={};R[H]=1,O[H]=0;for(var X=ee.of(H);X.size;)for(A=X.dequeue(),b.push(A),v=O[A],y=R[A],K=0,I=(x=Q.outboundNeighbors(A)).length;K<I;K++)(z=x[K])in O||(X.enqueue(z),O[z]=v+1),O[z]===v+1&&(R[z]+=y,C[z].push(A));return[b,C,R]},Ut.exports=j},3910:Ut=>{Ut.exports=function(et){return null!==et&&"object"==typeof et&&"function"==typeof et.addUndirectedEdgeWithKey&&"function"==typeof et.dropNode&&"boolean"==typeof et.multi}},698:function(Ut){Ut.exports=function(){"use strict";function it(re){return(it="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(fe){return typeof fe}:function(fe){return fe&&"function"==typeof Symbol&&fe.constructor===Symbol&&fe!==Symbol.prototype?"symbol":typeof fe})(re)}function et(re,fe){re.prototype=Object.create(fe.prototype),re.prototype.constructor=re,ee(re,fe)}function yt(re){return(yt=Object.setPrototypeOf?Object.getPrototypeOf:function(fe){return fe.__proto__||Object.getPrototypeOf(fe)})(re)}function ee(re,fe){return(ee=Object.setPrototypeOf||function(se,M){return se.__proto__=M,se})(re,fe)}function At(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(re){return!1}}function dt(re,fe,se){return(dt=At()?Reflect.construct:function(M,k,J){var Ee=[null];Ee.push.apply(Ee,k);var Le=new(Function.bind.apply(M,Ee));return J&&ee(Le,J.prototype),Le}).apply(null,arguments)}function Y(re){var fe="function"==typeof Map?new Map:void 0;return(Y=function(se){if(null===se||-1===Function.toString.call(se).indexOf("[native code]"))return se;if("function"!=typeof se)throw new TypeError("Super expression must either be null or a function");if(void 0!==fe){if(fe.has(se))return fe.get(se);fe.set(se,k)}function k(){return dt(se,arguments,yt(this).constructor)}return k.prototype=Object.create(se.prototype,{constructor:{value:k,enumerable:!1,writable:!0,configurable:!0}}),ee(k,se)})(re)}function xe(re){if(void 0===re)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return re}var he=function(){for(var re=arguments[0],fe=1,se=arguments.length;fe<se;fe++)if(arguments[fe])for(var M in arguments[fe])re[M]=arguments[fe][M];return re};function W(re,fe,se,M){var k=re._nodes.get(fe),J=null;return k?J="mixed"===M?k.out&&k.out[se]||k.undirected&&k.undirected[se]:"directed"===M?k.out&&k.out[se]:k.undirected&&k.undirected[se]:J}function j(re){return null!==re&&"object"===it(re)&&"function"==typeof re.addUndirectedEdgeWithKey&&"function"==typeof re.dropNode}function F(re){return"object"===it(re)&&null!==re&&re.constructor===Object}function Q(re){var fe;for(fe in re)return!1;return!0}function H(re,fe,se){Object.defineProperty(re,fe,{enumerable:!1,configurable:!1,writable:!0,value:se})}function b(re,fe,se){var M={enumerable:!0,configurable:!0};"function"==typeof se?M.get=se:(M.value=se,M.writable=!1),Object.defineProperty(re,fe,M)}function C(re){return!(!F(re)||re.attributes&&!Array.isArray(re.attributes))}"function"==typeof Object.assign&&(he=Object.assign);var R,T={exports:{}},v="object"==typeof Reflect?Reflect:null,y=v&&"function"==typeof v.apply?v.apply:function(re,fe,se){return Function.prototype.apply.call(re,fe,se)};R=v&&"function"==typeof v.ownKeys?v.ownKeys:Object.getOwnPropertySymbols?function(re){return Object.getOwnPropertyNames(re).concat(Object.getOwnPropertySymbols(re))}:function(re){return Object.getOwnPropertyNames(re)};var x=Number.isNaN||function(re){return re!=re};function A(){A.init.call(this)}T.exports=A,T.exports.once=function(re,fe){return new Promise(function(se,M){function k(Ee){re.removeListener(fe,J),M(Ee)}function J(){"function"==typeof re.removeListener&&re.removeListener("error",k),se([].slice.call(arguments))}var Ee;Z(re,fe,J,{once:!0}),"error"!==fe&&("function"==typeof(Ee=re).on&&Z(Ee,"error",k,{once:!0}))})},A.EventEmitter=A,A.prototype._events=void 0,A.prototype._eventsCount=0,A.prototype._maxListeners=void 0;var z=10;function N(re){if("function"!=typeof re)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof re)}function K(re){return void 0===re._maxListeners?A.defaultMaxListeners:re._maxListeners}function ue(re,fe,se,M){var k,J,Ee;if(N(se),void 0===(J=re._events)?(J=re._events=Object.create(null),re._eventsCount=0):(void 0!==J.newListener&&(re.emit("newListener",fe,se.listener?se.listener:se),J=re._events),Ee=J[fe]),void 0===Ee)Ee=J[fe]=se,++re._eventsCount;else if("function"==typeof Ee?Ee=J[fe]=M?[se,Ee]:[Ee,se]:M?Ee.unshift(se):Ee.push(se),(k=K(re))>0&&Ee.length>k&&!Ee.warned){Ee.warned=!0;var nt=new Error("Possible EventEmitter memory leak detected. "+Ee.length+" "+String(fe)+" listeners added. Use emitter.setMaxListeners() to increase limit");nt.name="MaxListenersExceededWarning",nt.emitter=re,nt.type=fe,nt.count=Ee.length,console&&console.warn&&console.warn(nt)}return re}function I(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function O(re,fe,se){var M={fired:!1,wrapFn:void 0,target:re,type:fe,listener:se},k=I.bind(M);return k.listener=se,M.wrapFn=k,k}function X(re,fe,se){var M=re._events;if(void 0===M)return[];var k=M[fe];return void 0===k?[]:"function"==typeof k?se?[k.listener||k]:[k]:se?function(J){for(var Ee=new Array(J.length),Le=0;Le<Ee.length;++Le)Ee[Le]=J[Le].listener||J[Le];return Ee}(k):$(k,k.length)}function E(re){var fe=this._events;if(void 0!==fe){var se=fe[re];if("function"==typeof se)return 1;if(void 0!==se)return se.length}return 0}function $(re,fe){for(var se=new Array(fe),M=0;M<fe;++M)se[M]=re[M];return se}function Z(re,fe,se,M){if("function"==typeof re.on)M.once?re.once(fe,se):re.on(fe,se);else{if("function"!=typeof re.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof re);re.addEventListener(fe,function k(J){M.once&&re.removeEventListener(fe,k),se(J)})}}function ae(re){Object.defineProperty(this,"_next",{writable:!1,enumerable:!1,value:re}),this.done=!1}Object.defineProperty(A,"defaultMaxListeners",{enumerable:!0,get:function(){return z},set:function(re){if("number"!=typeof re||re<0||x(re))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+re+".");z=re}}),A.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},A.prototype.setMaxListeners=function(re){if("number"!=typeof re||re<0||x(re))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+re+".");return this._maxListeners=re,this},A.prototype.getMaxListeners=function(){return K(this)},A.prototype.emit=function(re){for(var fe=[],se=1;se<arguments.length;se++)fe.push(arguments[se]);var M="error"===re,k=this._events;if(void 0!==k)M=M&&void 0===k.error;else if(!M)return!1;if(M){var J;if(fe.length>0&&(J=fe[0]),J instanceof Error)throw J;var Ee=new Error("Unhandled error."+(J?" ("+J.message+")":""));throw Ee.context=J,Ee}var Le=k[re];if(void 0===Le)return!1;if("function"==typeof Le)y(Le,this,fe);else{var nt=Le.length,Ot=$(Le,nt);for(se=0;se<nt;++se)y(Ot[se],this,fe)}return!0},A.prototype.on=A.prototype.addListener=function(re,fe){return ue(this,re,fe,!1)},A.prototype.prependListener=function(re,fe){return ue(this,re,fe,!0)},A.prototype.once=function(re,fe){return N(fe),this.on(re,O(this,re,fe)),this},A.prototype.prependOnceListener=function(re,fe){return N(fe),this.prependListener(re,O(this,re,fe)),this},A.prototype.off=A.prototype.removeListener=function(re,fe){var se,M,k,J,Ee;if(N(fe),void 0===(M=this._events))return this;if(void 0===(se=M[re]))return this;if(se===fe||se.listener===fe)0==--this._eventsCount?this._events=Object.create(null):(delete M[re],M.removeListener&&this.emit("removeListener",re,se.listener||fe));else if("function"!=typeof se){for(k=-1,J=se.length-1;J>=0;J--)if(se[J]===fe||se[J].listener===fe){Ee=se[J].listener,k=J;break}if(k<0)return this;0===k?se.shift():function(Le,nt){for(;nt+1<Le.length;nt++)Le[nt]=Le[nt+1];Le.pop()}(se,k),1===se.length&&(M[re]=se[0]),void 0!==M.removeListener&&this.emit("removeListener",re,Ee||fe)}return this},A.prototype.removeAllListeners=function(re){var fe,se,M;if(void 0===(se=this._events))return this;if(void 0===se.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==se[re]&&(0==--this._eventsCount?this._events=Object.create(null):delete se[re]),this;if(0===arguments.length){var k,J=Object.keys(se);for(M=0;M<J.length;++M)"removeListener"!==(k=J[M])&&this.removeAllListeners(k);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(fe=se[re]))this.removeListener(re,fe);else if(void 0!==fe)for(M=fe.length-1;M>=0;M--)this.removeListener(re,fe[M]);return this},A.prototype.listeners=function(re){return X(this,re,!0)},A.prototype.rawListeners=function(re){return X(this,re,!1)},A.listenerCount=function(re,fe){return"function"==typeof re.listenerCount?re.listenerCount(fe):E.call(re,fe)},A.prototype.listenerCount=E,A.prototype.eventNames=function(){return this._eventsCount>0?R(this._events):[]},ae.prototype.next=function(){if(this.done)return{done:!0};var re=this._next();return re.done&&(this.done=!0),re},"undefined"!=typeof Symbol&&(ae.prototype[Symbol.iterator]=function(){return this}),ae.of=function(){var re=arguments,fe=re.length,se=0;return new ae(function(){return se>=fe?{done:!0}:{done:!1,value:re[se++]}})},ae.empty=function(){var re=new ae(null);return re.done=!0,re},ae.is=function(re){return re instanceof ae||"object"==typeof re&&null!==re&&"function"==typeof re.next};var oe=ae,te=function(re,fe){for(var se,M=arguments.length>1?fe:1/0,k=M!==1/0?new Array(M):[],J=0;;){if(J===M)return k;if((se=re.next()).done)return J!==fe?k.slice(0,J):k;k[J++]=se.value}},Ce=function(re){function fe(se,M){var k;return(k=re.call(this)||this).name="GraphError",k.message=se||"",k.data=M||{},k}return et(fe,re),fe}(Y(Error)),me=function(re){function fe(se,M){var k;return(k=re.call(this,se,M)||this).name="InvalidArgumentsGraphError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(xe(k),fe.prototype.constructor),k}return et(fe,re),fe}(Ce),ne=function(re){function fe(se,M){var k;return(k=re.call(this,se,M)||this).name="NotFoundGraphError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(xe(k),fe.prototype.constructor),k}return et(fe,re),fe}(Ce),ye=function(re){function fe(se,M){var k;return(k=re.call(this,se,M)||this).name="UsageGraphError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(xe(k),fe.prototype.constructor),k}return et(fe,re),fe}(Ce);function Oe(re,fe){this.key=re,this.attributes=fe,this.inDegree=0,this.outDegree=0,this.undirectedDegree=0,this.directedSelfLoops=0,this.undirectedSelfLoops=0,this.in={},this.out={},this.undirected={}}function $e(re,fe){this.key=re,this.attributes=fe,this.inDegree=0,this.outDegree=0,this.directedSelfLoops=0,this.in={},this.out={}}function st(re,fe){this.key=re,this.attributes=fe,this.undirectedDegree=0,this.undirectedSelfLoops=0,this.undirected={}}function Qe(re,fe,se,M,k,J){this.key=fe,this.attributes=J,this.undirected=re,this.source=M,this.target=k,this.generatedKey=se}function tt(re,fe,se,M,k,J,Ee){var Le,nt,Ot="out",We="in";if(fe&&(Ot=We="undirected"),re.multi){if(void 0===(nt=(Le=J[Ot])[k])&&(nt=new Set,Le[k]=nt),nt.add(se),M===k&&fe)return;void 0===(Le=Ee[We])[M]&&(Le[M]=nt)}else{if(J[Ot][k]=se,M===k&&fe)return;Ee[We][M]=se}}function Ke(re,fe,se){var M=re.multi,k=se.source,J=se.target,Ee=k.key,Le=J.key,nt=k[fe?"undirected":"out"],Ot=fe?"undirected":"in";if(Le in nt)if(M){var We=nt[Le];1===We.size?(delete nt[Le],delete J[Ot][Ee]):We.delete(se)}else delete nt[Le];M||delete J[Ot][Ee]}$e.prototype.upgradeToMixed=function(){this.undirectedDegree=0,this.undirectedSelfLoops=0,this.undirected={}},st.prototype.upgradeToMixed=function(){this.inDegree=0,this.outDegree=0,this.directedSelfLoops=0,this.in={},this.out={}};var ze=[{name:function(re){return"get".concat(re,"Attribute")},attacher:function(re,fe,se){re.prototype[fe]=function(M,k){var J;if("mixed"!==this.type&&"mixed"!==se&&se!==this.type)throw new ye("Graph.".concat(fe,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new ye("Graph.".concat(fe,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var Ee=""+M,Le=""+k;if(k=arguments[2],!(J=W(this,Ee,Le,se)))throw new ne("Graph.".concat(fe,': could not find an edge for the given path ("').concat(Ee,'" - "').concat(Le,'").'))}else if(!(J=this._edges.get(M=""+M)))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" edge in the graph.'));if("mixed"!==se&&J.undirected!==("undirected"===se))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" ').concat(se," edge in the graph."));return J.attributes[k]}}},{name:function(re){return"get".concat(re,"Attributes")},attacher:function(re,fe,se){re.prototype[fe]=function(M){var k;if("mixed"!==this.type&&"mixed"!==se&&se!==this.type)throw new ye("Graph.".concat(fe,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>1){if(this.multi)throw new ye("Graph.".concat(fe,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var J=""+M,Ee=""+arguments[1];if(!(k=W(this,J,Ee,se)))throw new ne("Graph.".concat(fe,': could not find an edge for the given path ("').concat(J,'" - "').concat(Ee,'").'))}else if(!(k=this._edges.get(M=""+M)))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" edge in the graph.'));if("mixed"!==se&&k.undirected!==("undirected"===se))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" ').concat(se," edge in the graph."));return k.attributes}}},{name:function(re){return"has".concat(re,"Attribute")},attacher:function(re,fe,se){re.prototype[fe]=function(M,k){var J;if("mixed"!==this.type&&"mixed"!==se&&se!==this.type)throw new ye("Graph.".concat(fe,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new ye("Graph.".concat(fe,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var Ee=""+M,Le=""+k;if(k=arguments[2],!(J=W(this,Ee,Le,se)))throw new ne("Graph.".concat(fe,': could not find an edge for the given path ("').concat(Ee,'" - "').concat(Le,'").'))}else if(!(J=this._edges.get(M=""+M)))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" edge in the graph.'));if("mixed"!==se&&J.undirected!==("undirected"===se))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" ').concat(se," edge in the graph."));return J.attributes.hasOwnProperty(k)}}},{name:function(re){return"set".concat(re,"Attribute")},attacher:function(re,fe,se){re.prototype[fe]=function(M,k,J){var Ee;if("mixed"!==this.type&&"mixed"!==se&&se!==this.type)throw new ye("Graph.".concat(fe,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>3){if(this.multi)throw new ye("Graph.".concat(fe,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var Le=""+M,nt=""+k;if(k=arguments[2],J=arguments[3],!(Ee=W(this,Le,nt,se)))throw new ne("Graph.".concat(fe,': could not find an edge for the given path ("').concat(Le,'" - "').concat(nt,'").'))}else if(!(Ee=this._edges.get(M=""+M)))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" edge in the graph.'));if("mixed"!==se&&Ee.undirected!==("undirected"===se))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" ').concat(se," edge in the graph."));return Ee.attributes[k]=J,this.emit("edgeAttributesUpdated",{key:Ee.key,type:"set",attributes:Ee.attributes,name:k}),this}}},{name:function(re){return"update".concat(re,"Attribute")},attacher:function(re,fe,se){re.prototype[fe]=function(M,k,J){var Ee;if("mixed"!==this.type&&"mixed"!==se&&se!==this.type)throw new ye("Graph.".concat(fe,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>3){if(this.multi)throw new ye("Graph.".concat(fe,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var Le=""+M,nt=""+k;if(k=arguments[2],J=arguments[3],!(Ee=W(this,Le,nt,se)))throw new ne("Graph.".concat(fe,': could not find an edge for the given path ("').concat(Le,'" - "').concat(nt,'").'))}else if(!(Ee=this._edges.get(M=""+M)))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" edge in the graph.'));if("function"!=typeof J)throw new me("Graph.".concat(fe,": updater should be a function."));if("mixed"!==se&&Ee.undirected!==("undirected"===se))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" ').concat(se," edge in the graph."));return Ee.attributes[k]=J(Ee.attributes[k]),this.emit("edgeAttributesUpdated",{key:Ee.key,type:"set",attributes:Ee.attributes,name:k}),this}}},{name:function(re){return"remove".concat(re,"Attribute")},attacher:function(re,fe,se){re.prototype[fe]=function(M,k){var J;if("mixed"!==this.type&&"mixed"!==se&&se!==this.type)throw new ye("Graph.".concat(fe,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new ye("Graph.".concat(fe,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var Ee=""+M,Le=""+k;if(k=arguments[2],!(J=W(this,Ee,Le,se)))throw new ne("Graph.".concat(fe,': could not find an edge for the given path ("').concat(Ee,'" - "').concat(Le,'").'))}else if(!(J=this._edges.get(M=""+M)))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" edge in the graph.'));if("mixed"!==se&&J.undirected!==("undirected"===se))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" ').concat(se," edge in the graph."));return delete J.attributes[k],this.emit("edgeAttributesUpdated",{key:J.key,type:"remove",attributes:J.attributes,name:k}),this}}},{name:function(re){return"replace".concat(re,"Attributes")},attacher:function(re,fe,se){re.prototype[fe]=function(M,k){var J;if("mixed"!==this.type&&"mixed"!==se&&se!==this.type)throw new ye("Graph.".concat(fe,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new ye("Graph.".concat(fe,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var Ee=""+M,Le=""+k;if(k=arguments[2],!(J=W(this,Ee,Le,se)))throw new ne("Graph.".concat(fe,': could not find an edge for the given path ("').concat(Ee,'" - "').concat(Le,'").'))}else if(!(J=this._edges.get(M=""+M)))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" edge in the graph.'));if(!F(k))throw new me("Graph.".concat(fe,": provided attributes are not a plain object."));if("mixed"!==se&&J.undirected!==("undirected"===se))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" ').concat(se," edge in the graph."));return J.attributes=k,this.emit("edgeAttributesUpdated",{key:J.key,type:"replace",attributes:J.attributes}),this}}},{name:function(re){return"merge".concat(re,"Attributes")},attacher:function(re,fe,se){re.prototype[fe]=function(M,k){var J;if("mixed"!==this.type&&"mixed"!==se&&se!==this.type)throw new ye("Graph.".concat(fe,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new ye("Graph.".concat(fe,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var Ee=""+M,Le=""+k;if(k=arguments[2],!(J=W(this,Ee,Le,se)))throw new ne("Graph.".concat(fe,': could not find an edge for the given path ("').concat(Ee,'" - "').concat(Le,'").'))}else if(!(J=this._edges.get(M=""+M)))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" edge in the graph.'));if(!F(k))throw new me("Graph.".concat(fe,": provided attributes are not a plain object."));if("mixed"!==se&&J.undirected!==("undirected"===se))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" ').concat(se," edge in the graph."));return he(J.attributes,k),this.emit("edgeAttributesUpdated",{key:J.key,type:"merge",attributes:J.attributes,data:k}),this}}}],ke=oe,Xe=function(){var re,fe=arguments,se=-1;return new ke(function M(){if(!re){if(++se>=fe.length)return{done:!0};re=fe[se]}var k=re.next();return k.done?(re=null,M()):k})},Ae=[{name:"edges",type:"mixed"},{name:"inEdges",type:"directed",direction:"in"},{name:"outEdges",type:"directed",direction:"out"},{name:"inboundEdges",type:"mixed",direction:"in"},{name:"outboundEdges",type:"mixed",direction:"out"},{name:"directedEdges",type:"directed"},{name:"undirectedEdges",type:"undirected"}];function Ue(re,fe){for(var se in fe)re.push(fe[se].key)}function qe(re,fe){for(var se in fe)fe[se].forEach(function(M){return re.push(M.key)})}function Fe(re,fe,se){for(var M in re)if(M!==se){var k=re[M];fe(k.key,k.attributes,k.source.key,k.target.key,k.source.attributes,k.target.attributes,k.undirected,k.generatedKey)}}function q(re,fe,se){for(var M in re)M!==se&&re[M].forEach(function(k){return fe(k.key,k.attributes,k.source.key,k.target.key,k.source.attributes,k.target.attributes,k.undirected,k.generatedKey)})}function G(re,fe,se){for(var M in re)if(M!==se){var k=re[M];if(fe(k.key,k.attributes,k.source.key,k.target.key,k.source.attributes,k.target.attributes,k.undirected,k.generatedKey))return!0}return!1}function pe(re,fe,se){var M,k,J,Ee,Le;for(var nt in re)if(nt!==se)for(M=re[nt].values();!0!==(k=M.next()).done;)if(Ee=(J=k.value).source,fe(J.key,J.attributes,Ee.key,(Le=J.target).key,Ee.attributes,Le.attributes,J.undirected,J.generatedKey))return!0;return!1}function de(re,fe){var se=Object.keys(re),M=se.length,k=null,J=0;return new oe(function Ee(){var Le;if(k){var nt=k.next();if(nt.done)return k=null,J++,Ee();Le=nt.value}else{if(J>=M)return{done:!0};var Ot=se[J];if(Ot===fe)return J++,Ee();if((Le=re[Ot])instanceof Set)return k=Le.values(),Ee();J++}return{done:!1,value:[Le.key,Le.attributes,Le.source.key,Le.target.key,Le.source.attributes,Le.target.attributes]}})}function je(re,fe,se){var M=fe[se];M&&re.push(M.key)}function _t(re,fe,se){var M=fe[se];M&&M.forEach(function(k){return re.push(k.key)})}function pt(re,fe,se){var M=re[fe];if(M){var k=M.source,J=M.target;se(M.key,M.attributes,k.key,J.key,k.attributes,J.attributes,M.undirected,M.generatedKey)}}function we(re,fe,se){var M=re[fe];M&&M.forEach(function(k){return se(k.key,k.attributes,k.source.key,k.target.key,k.source.attributes,k.target.attributes,k.undirected,k.generatedKey)})}function B(re,fe,se){var M=re[fe];if(M){var k=M.source,J=M.target;return se(M.key,M.attributes,k.key,J.key,k.attributes,J.attributes,M.undirected,M.generatedKey)}}function P(re,fe,se){var M=re[fe];if(M){for(var k,J,Ee=M.values();!0!==(k=Ee.next()).done;)if(se((J=k.value).key,J.attributes,J.source.key,J.target.key,J.source.attributes,J.target.attributes,J.undirected,J.generatedKey))return!0;return!1}}function V(re,fe){var se=re[fe];if(se instanceof Set){var M=se.values();return new oe(function(){var k=M.next();if(k.done)return k;var J=k.value;return{done:!1,value:[J.key,J.attributes,J.source.key,J.target.key,J.source.attributes,J.target.attributes]}})}return oe.of([se.key,se.attributes,se.source.key,se.target.key,se.source.attributes,se.target.attributes])}function Re(re,fe){if(0===re.size)return[];if("mixed"===fe||fe===re.type)return"function"==typeof Array.from?Array.from(re._edges.keys()):te(re._edges.keys(),re._edges.size);for(var se,M,J=new Array("undirected"===fe?re.undirectedSize:re.directedSize),Ee="undirected"===fe,Le=re._edges.values(),nt=0;!0!==(se=Le.next()).done;)(M=se.value).undirected===Ee&&(J[nt++]=M.key);return J}function Ze(re,fe,se){if(0!==re.size)for(var M,k,J="mixed"!==fe&&fe!==re.type,Ee="undirected"===fe,Le=re._edges.values();!0!==(M=Le.next()).done;)if(k=M.value,!J||k.undirected===Ee){var Wt=k.source,Ct=k.target;se(k.key,k.attributes,Wt.key,Ct.key,Wt.attributes,Ct.attributes,k.undirected,k.generatedKey)}}function St(re,fe,se){if(0!==re.size)for(var M,k,J="mixed"!==fe&&fe!==re.type,Ee="undirected"===fe,Le=re._edges.values();!0!==(M=Le.next()).done;)if(k=M.value,!J||k.undirected===Ee){var Wt=k.source,Ct=k.target;if(se(k.key,k.attributes,Wt.key,Ct.key,Wt.attributes,Ct.attributes,k.undirected,k.generatedKey))break}}function Rt(re,fe){if(0===re.size)return oe.empty();var se="mixed"!==fe&&fe!==re.type,M="undirected"===fe,k=re._edges.values();return new oe(function(){for(var J,Ee;;){if((J=k.next()).done)return J;if(Ee=J.value,!se||Ee.undirected===M)break}return{value:[Ee.key,Ee.attributes,Ee.source.key,Ee.target.key,Ee.source.attributes,Ee.target.attributes],done:!1}})}function Mn(re,fe,se,M){var k=[],J=re?qe:Ue;return"undirected"!==fe&&("out"!==se&&J(k,M.in),"in"!==se&&J(k,M.out),!se&&M.directedSelfLoops>0&&k.splice(k.lastIndexOf(M.key),1)),"directed"!==fe&&J(k,M.undirected),k}function Nn(re,fe,se,M,k){var J=re?q:Fe;"undirected"!==fe&&("out"!==se&&J(M.in,k),"in"!==se&&J(M.out,k,se?null:M.key)),"directed"!==fe&&J(M.undirected,k)}function $n(re,fe,se,M,k){var J=re?pe:G;"undirected"!==fe&&("out"!==se&&J(M.in,k)||"in"!==se&&J(M.out,k,se?null:M.key))||"directed"===fe||J(M.undirected,k)}function bi(re,fe,se){var M=oe.empty();return"undirected"!==re&&("out"!==fe&&void 0!==se.in&&(M=Xe(M,de(se.in))),"in"!==fe&&void 0!==se.out&&(M=Xe(M,de(se.out,fe?null:se.key)))),"directed"!==re&&void 0!==se.undirected&&(M=Xe(M,de(se.undirected))),M}function fi(re,fe,se,M,k){var J=fe?_t:je,Ee=[];return"undirected"!==re&&(void 0!==M.in&&"out"!==se&&J(Ee,M.in,k),void 0!==M.out&&"in"!==se&&J(Ee,M.out,k),!se&&M.directedSelfLoops>0&&Ee.splice(Ee.lastIndexOf(M.key),1)),"directed"!==re&&void 0!==M.undirected&&J(Ee,M.undirected,k),Ee}function Gr(re,fe,se,M,k,J){var Ee=fe?we:pt;"undirected"!==re&&(void 0!==M.in&&"out"!==se&&Ee(M.in,k,J),M.key!==k&&void 0!==M.out&&"in"!==se&&Ee(M.out,k,J)),"directed"!==re&&void 0!==M.undirected&&Ee(M.undirected,k,J)}function Ps(re,fe,se,M,k,J){var Ee=fe?P:B;"undirected"!==re&&(void 0!==M.in&&"out"!==se&&Ee(M.in,k,J)||M.key!==k&&void 0!==M.out&&"in"!==se&&Ee(M.out,k,J,se?null:M.key))||"directed"===re||void 0===M.undirected||Ee(M.undirected,k,J)}function ds(re,fe,se,M){var k=oe.empty();return"undirected"!==re&&(void 0!==se.in&&"out"!==fe&&M in se.in&&(k=Xe(k,V(se.in,M))),void 0!==se.out&&"in"!==fe&&M in se.out&&(k=Xe(k,V(se.out,M)))),"directed"!==re&&void 0!==se.undirected&&M in se.undirected&&(k=Xe(k,V(se.undirected,M))),k}var Fs=[{name:"neighbors",type:"mixed"},{name:"inNeighbors",type:"directed",direction:"in"},{name:"outNeighbors",type:"directed",direction:"out"},{name:"inboundNeighbors",type:"mixed",direction:"in"},{name:"outboundNeighbors",type:"mixed",direction:"out"},{name:"directedNeighbors",type:"directed"},{name:"undirectedNeighbors",type:"undirected"}];function $r(re,fe){if(void 0!==fe)for(var se in fe)re.add(se)}function _a(re,fe,se){if("mixed"!==re){if("undirected"===re)return Object.keys(se.undirected);if("string"==typeof fe)return Object.keys(se[fe])}var M=new Set;return"undirected"!==re&&("out"!==fe&&$r(M,se.in),"in"!==fe&&$r(M,se.out)),"directed"!==re&&$r(M,se.undirected),te(M.values(),M.size)}function Ml(re,fe,se){for(var M in fe){var k=fe[M];k instanceof Set&&(k=k.values().next().value);var J=k.source,Le=J===re?k.target:J;se(Le.key,Le.attributes)}}function ya(re,fe,se,M){for(var k in se){var J=se[k];J instanceof Set&&(J=J.values().next().value);var Ee=J.source,nt=Ee===fe?J.target:Ee;re.has(nt.key)||(re.add(nt.key),M(nt.key,nt.attributes))}}function ys(re,fe,se){for(var M in fe){var k=fe[M];k instanceof Set&&(k=k.values().next().value);var J=k.source,Le=J===re?k.target:J;if(se(Le.key,Le.attributes))return!0}return!1}function Jt(re,fe,se,M){for(var k in se){var J=se[k];J instanceof Set&&(J=J.values().next().value);var Ee=J.source,nt=Ee===fe?J.target:Ee;if(!re.has(nt.key)&&(re.add(nt.key),M(nt.key,nt.attributes)))return!0}return!1}function Ka(re,fe){var se=Object.keys(fe),M=se.length,k=0;return new oe(function(){if(k>=M)return{done:!0};var J=fe[se[k++]];J instanceof Set&&(J=J.values().next().value);var Ee=J.source,nt=Ee===re?J.target:Ee;return{done:!1,value:[nt.key,nt.attributes]}})}function rt(re,fe,se){var M=Object.keys(se),k=M.length,J=0;return new oe(function Ee(){if(J>=k)return{done:!0};var Le=se[M[J++]];Le instanceof Set&&(Le=Le.values().next().value);var nt=Le.source,We=nt===fe?Le.target:nt;return re.has(We.key)?Ee():(re.add(We.key),{done:!1,value:[We.key,We.attributes]})})}function lt(re,fe,se,M,k){var J=re._nodes.get(M);if("undirected"!==fe){if("out"!==se&&void 0!==J.in)for(var Ee in J.in)if(Ee===k)return!0;if("in"!==se&&void 0!==J.out)for(var Le in J.out)if(Le===k)return!0}if("directed"!==fe&&void 0!==J.undirected)for(var nt in J.undirected)if(nt===k)return!0;return!1}function Be(re,fe,se){for(var M,k,J,Ee,Le,nt,Ot,We=fe._nodes.values(),Wt=fe.type;!0!==(M=We.next()).done;){if(k=M.value,"undirected"!==Wt)for(J in Ee=k.out)if(nt=(Le=Ee[J]).target,Ot=se(k.key,nt.key,k.attributes,nt.attributes,Le.key,Le.attributes,Le.undirected,Le.generatedKey),re&&Ot)return;if("directed"!==Wt)for(J in Ee=k.undirected)if((nt=(Le=Ee[J]).target).key!==J&&(nt=Le.source),Ot=se(k.key,nt.key,k.attributes,nt.attributes,Le.key,Le.attributes,Le.undirected,Le.generatedKey),re&&Ot)return}}function ut(re,fe,se){for(var M,k,J,Ee,Le,nt,Ot,We,Wt,Ct=fe._nodes.values(),mn=fe.type;!0!==(M=Ct.next()).done;){if(k=M.value,"undirected"!==mn)for(J in nt=k.out)for(Ee=nt[J].values();!0!==(Le=Ee.next()).done;)if(We=(Ot=Le.value).target,Wt=se(k.key,We.key,k.attributes,We.attributes,Ot.key,Ot.attributes,Ot.undirected,Ot.generatedKey),re&&Wt)return;if("directed"!==mn)for(J in nt=k.undirected)for(Ee=nt[J].values();!0!==(Le=Ee.next()).done;)if((We=(Ot=Le.value).target).key!==J&&(We=Ot.source),Wt=se(k.key,We.key,k.attributes,We.attributes,Ot.key,Ot.attributes,Ot.undirected,Ot.generatedKey),re&&Wt)return}}function Je(re,fe){var se={key:re};return Q(fe.attributes)||(se.attributes=he({},fe.attributes)),se}function Tt(re,fe){var se={source:fe.source.key,target:fe.target.key};return fe.generatedKey||(se.key=re),Q(fe.attributes)||(se.attributes=he({},fe.attributes)),fe.undirected&&(se.undirected=!0),se}function Mt(re){return F(re)?"key"in re?!("attributes"in re)||F(re.attributes)&&null!==re.attributes?null:"invalid-attributes":"no-key":"not-object"}function Dt(re){return F(re)?"source"in re?"target"in re?!("attributes"in re)||F(re.attributes)&&null!==re.attributes?"undirected"in re&&"boolean"!=typeof re.undirected?"invalid-undirected":null:"invalid-attributes":"no-target":"no-source":"not-object"}var Xt=new Set(["directed","undirected","mixed"]),Un=new Set(["domain","_events","_eventsCount","_maxListeners"]),ii={allowSelfLoops:!0,edgeKeyGenerator:null,multi:!1,type:"mixed"};function On(re,fe,se){var M=new re.NodeDataClass(fe,se);return re._nodes.set(fe,M),re.emit("nodeAdded",{key:fe,attributes:se}),M}function gn(re,fe,se,M,k,J,Ee,Le){if(!M&&"undirected"===re.type)throw new ye("Graph.".concat(fe,": you cannot add a directed edge to an undirected graph. Use the #.addEdge or #.addUndirectedEdge instead."));if(M&&"directed"===re.type)throw new ye("Graph.".concat(fe,": you cannot add an undirected edge to a directed graph. Use the #.addEdge or #.addDirectedEdge instead."));if(Le&&!F(Le))throw new me("Graph.".concat(fe,': invalid attributes. Expecting an object but got "').concat(Le,'"'));if(J=""+J,Ee=""+Ee,Le=Le||{},!re.allowSelfLoops&&J===Ee)throw new ye("Graph.".concat(fe,': source & target are the same ("').concat(J,"\"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false."));var nt=re._nodes.get(J),Ot=re._nodes.get(Ee);if(!nt)throw new ne("Graph.".concat(fe,': source node "').concat(J,'" not found.'));if(!Ot)throw new ne("Graph.".concat(fe,': target node "').concat(Ee,'" not found.'));var We={key:null,undirected:M,source:J,target:Ee,attributes:Le};if(se&&(k=re._edgeKeyGenerator(We)),re._edges.has(k=""+k))throw new ye("Graph.".concat(fe,': the "').concat(k,'" edge already exists in the graph.'));if(!re.multi&&(M?void 0!==nt.undirected[Ee]:void 0!==nt.out[Ee]))throw new ye("Graph.".concat(fe,': an edge linking "').concat(J,'" to "').concat(Ee,"\" already exists. If you really want to add multiple edges linking those nodes, you should create a multi graph by using the 'multi' option."));var Wt=new Qe(M,k,se,nt,Ot,Le);return re._edges.set(k,Wt),J===Ee?M?(nt.undirectedSelfLoops++,re._undirectedSelfLoopCount++):(nt.directedSelfLoops++,re._directedSelfLoopCount++):M?(nt.undirectedDegree++,Ot.undirectedDegree++):(nt.outDegree++,Ot.inDegree++),tt(re,M,Wt,J,Ee,nt,Ot),M?re._undirectedSize++:re._directedSize++,We.key=k,re.emit("edgeAdded",We),k}function Wn(re,fe,se,M,k,J,Ee,Le,nt){if(!M&&"undirected"===re.type)throw new ye("Graph.".concat(fe,": you cannot add a directed edge to an undirected graph. Use the #.addEdge or #.addUndirectedEdge instead."));if(M&&"directed"===re.type)throw new ye("Graph.".concat(fe,": you cannot add an undirected edge to a directed graph. Use the #.addEdge or #.addDirectedEdge instead."));if(Le)if(nt){if("function"!=typeof Le)throw new me("Graph.".concat(fe,': invalid updater function. Expecting a function but got "').concat(Le,'"'))}else if(!F(Le))throw new me("Graph.".concat(fe,': invalid attributes. Expecting an object but got "').concat(Le,'"'));var Ot;if(J=""+J,Ee=""+Ee,nt&&(Ot=Le,Le=void 0),!re.allowSelfLoops&&J===Ee)throw new ye("Graph.".concat(fe,': source & target are the same ("').concat(J,"\"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false."));var We,Wt,Ct=re._nodes.get(J),mn=re._nodes.get(Ee);if(!se&&(We=re._edges.get(k))){if(We.source.key!==J||We.target.key!==Ee||M&&(We.source.key!==Ee||We.target.key!==J))throw new ye("Graph.".concat(fe,': inconsistency detected when attempting to merge the "').concat(k,'" edge with "').concat(J,'" source & "').concat(Ee,'" target vs. ("').concat(We.source.key,'", "').concat(We.target.key,'").'));Wt=We}if(Wt||re.multi||!Ct||(Wt=M?Ct.undirected[Ee]:Ct.out[Ee]),Wt)return(nt?Ot:Le)?(nt?(Wt.attributes=Ot(Wt.attributes),re.emit("edgeAttributesUpdated",{type:"replace",key:Wt.key,attributes:Wt.attributes})):(he(Wt.attributes,Le),re.emit("edgeAttributesUpdated",{type:"merge",key:Wt.key,attributes:Wt.attributes,data:Le})),Wt.key):Wt.key;Le=Le||{},nt&&Ot&&(Le=Ot(Le));var qr={key:null,undirected:M,source:J,target:Ee,attributes:Le};if(se&&(k=re._edgeKeyGenerator(qr)),re._edges.has(k=""+k))throw new ye("Graph.".concat(fe,': the "').concat(k,'" edge already exists in the graph.'));return Ct||(Ct=On(re,J,{}),J===Ee&&(mn=Ct)),mn||(mn=On(re,Ee,{})),We=new Qe(M,k,se,Ct,mn,Le),re._edges.set(k,We),J===Ee?M?(Ct.undirectedSelfLoops++,re._undirectedSelfLoopCount++):(Ct.directedSelfLoops++,re._directedSelfLoopCount++):M?(Ct.undirectedDegree++,mn.undirectedDegree++):(Ct.outDegree++,mn.inDegree++),tt(re,M,We,J,Ee,Ct,mn),M?re._undirectedSize++:re._directedSize++,qr.key=k,re.emit("edgeAdded",qr),k}var re,Sn=function(re){function fe(M){var k;if(k=re.call(this)||this,(M=he({},ii,M)).edgeKeyGenerator&&"function"!=typeof M.edgeKeyGenerator)throw new me("Graph.constructor: invalid 'edgeKeyGenerator' option. Expecting a function but got \"".concat(M.edgeKeyGenerator,'".'));if("boolean"!=typeof M.multi)throw new me("Graph.constructor: invalid 'multi' option. Expecting a boolean but got \"".concat(M.multi,'".'));if(!Xt.has(M.type))throw new me('Graph.constructor: invalid \'type\' option. Should be one of "mixed", "directed" or "undirected" but got "'.concat(M.type,'".'));if("boolean"!=typeof M.allowSelfLoops)throw new me("Graph.constructor: invalid 'allowSelfLoops' option. Expecting a boolean but got \"".concat(M.allowSelfLoops,'".'));var J,Ee="mixed"===M.type?Oe:"directed"===M.type?$e:st;return H(xe(k),"NodeDataClass",Ee),H(xe(k),"_attributes",{}),H(xe(k),"_nodes",new Map),H(xe(k),"_edges",new Map),H(xe(k),"_directedSize",0),H(xe(k),"_undirectedSize",0),H(xe(k),"_directedSelfLoopCount",0),H(xe(k),"_undirectedSelfLoopCount",0),H(xe(k),"_edgeKeyGenerator",M.edgeKeyGenerator||(J=0,function(){return J++})),H(xe(k),"_options",M),Un.forEach(function(Le){return H(xe(k),Le,k[Le])}),b(xe(k),"order",function(){return k._nodes.size}),b(xe(k),"size",function(){return k._edges.size}),b(xe(k),"directedSize",function(){return k._directedSize}),b(xe(k),"undirectedSize",function(){return k._undirectedSize}),b(xe(k),"selfLoopCount",function(){return k._directedSelfLoopCount+k._undirectedSelfLoopCount}),b(xe(k),"directedSelfLoopCount",function(){return k._directedSelfLoopCount}),b(xe(k),"undirectedSelfLoopCount",function(){return k._undirectedSelfLoopCount}),b(xe(k),"multi",k._options.multi),b(xe(k),"type",k._options.type),b(xe(k),"allowSelfLoops",k._options.allowSelfLoops),b(xe(k),"implementation",function(){return"graphology"}),k}et(fe,re);var se=fe.prototype;return se.hasNode=function(M){return this._nodes.has(""+M)},se.hasDirectedEdge=function(M,k){if("undirected"===this.type)return!1;if(1===arguments.length){var Ee=this._edges.get(""+M);return!!Ee&&!Ee.undirected}if(2===arguments.length){k=""+k;var Le=this._nodes.get(M=""+M);if(!Le)return!1;var nt=Le.out[k];return!(!nt||this.multi&&!nt.size)}throw new me("Graph.hasDirectedEdge: invalid arity (".concat(arguments.length,", instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target."))},se.hasUndirectedEdge=function(M,k){if("directed"===this.type)return!1;if(1===arguments.length){var Ee=this._edges.get(""+M);return!!Ee&&Ee.undirected}if(2===arguments.length){k=""+k;var Le=this._nodes.get(M=""+M);if(!Le)return!1;var nt=Le.undirected[k];return!(!nt||this.multi&&!nt.size)}throw new me("Graph.hasDirectedEdge: invalid arity (".concat(arguments.length,", instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target."))},se.hasEdge=function(M,k){if(1===arguments.length)return this._edges.has(""+M);if(2===arguments.length){k=""+k;var Ee=this._nodes.get(M=""+M);if(!Ee)return!1;var Le=void 0!==Ee.out&&Ee.out[k];return Le||(Le=void 0!==Ee.undirected&&Ee.undirected[k]),!(!Le||this.multi&&!Le.size)}throw new me("Graph.hasEdge: invalid arity (".concat(arguments.length,", instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target."))},se.directedEdge=function(M,k){if("undirected"!==this.type){if(M=""+M,k=""+k,this.multi)throw new ye("Graph.directedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.directedEdges instead.");var J=this._nodes.get(M);if(!J)throw new ne('Graph.directedEdge: could not find the "'.concat(M,'" source node in the graph.'));if(!this._nodes.has(k))throw new ne('Graph.directedEdge: could not find the "'.concat(k,'" target node in the graph.'));var Ee=J.out&&J.out[k]||void 0;return Ee?Ee.key:void 0}},se.undirectedEdge=function(M,k){if("directed"!==this.type){if(M=""+M,k=""+k,this.multi)throw new ye("Graph.undirectedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.undirectedEdges instead.");var J=this._nodes.get(M);if(!J)throw new ne('Graph.undirectedEdge: could not find the "'.concat(M,'" source node in the graph.'));if(!this._nodes.has(k))throw new ne('Graph.undirectedEdge: could not find the "'.concat(k,'" target node in the graph.'));var Ee=J.undirected&&J.undirected[k]||void 0;return Ee?Ee.key:void 0}},se.edge=function(M,k){if(this.multi)throw new ye("Graph.edge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.edges instead.");k=""+k;var J=this._nodes.get(M=""+M);if(!J)throw new ne('Graph.edge: could not find the "'.concat(M,'" source node in the graph.'));if(!this._nodes.has(k))throw new ne('Graph.edge: could not find the "'.concat(k,'" target node in the graph.'));var Ee=J.out&&J.out[k]||J.undirected&&J.undirected[k]||void 0;if(Ee)return Ee.key},se.inDegree=function(M){var k=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("boolean"!=typeof k)throw new me('Graph.inDegree: Expecting a boolean but got "'.concat(k,'" for the second parameter (allowing self-loops to be counted).'));var J=this._nodes.get(M=""+M);if(!J)throw new ne('Graph.inDegree: could not find the "'.concat(M,'" node in the graph.'));return"undirected"===this.type?0:J.inDegree+(k?J.directedSelfLoops:0)},se.outDegree=function(M){var k=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("boolean"!=typeof k)throw new me('Graph.outDegree: Expecting a boolean but got "'.concat(k,'" for the second parameter (allowing self-loops to be counted).'));var J=this._nodes.get(M=""+M);if(!J)throw new ne('Graph.outDegree: could not find the "'.concat(M,'" node in the graph.'));return"undirected"===this.type?0:J.outDegree+(k?J.directedSelfLoops:0)},se.directedDegree=function(M){var k=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("boolean"!=typeof k)throw new me('Graph.directedDegree: Expecting a boolean but got "'.concat(k,'" for the second parameter (allowing self-loops to be counted).'));var J=this._nodes.get(M=""+M);if(!J)throw new ne('Graph.directedDegree: could not find the "'.concat(M,'" node in the graph.'));if("undirected"===this.type)return 0;var Ee=k?J.directedSelfLoops:0;return J.inDegree+Ee+(J.outDegree+Ee)},se.undirectedDegree=function(M){var k=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("boolean"!=typeof k)throw new me('Graph.undirectedDegree: Expecting a boolean but got "'.concat(k,'" for the second parameter (allowing self-loops to be counted).'));var J=this._nodes.get(M=""+M);if(!J)throw new ne('Graph.undirectedDegree: could not find the "'.concat(M,'" node in the graph.'));return"directed"===this.type?0:J.undirectedDegree+2*(k?J.undirectedSelfLoops:0)},se.degree=function(M){var k=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("boolean"!=typeof k)throw new me('Graph.degree: Expecting a boolean but got "'.concat(k,'" for the second parameter (allowing self-loops to be counted).'));var J=this._nodes.get(M=""+M);if(!J)throw new ne('Graph.degree: could not find the "'.concat(M,'" node in the graph.'));var Ee=0,Le=0;return"directed"!==this.type&&(k&&(Le=J.undirectedSelfLoops),Ee+=J.undirectedDegree+2*Le),"undirected"!==this.type&&(k&&(Le=J.directedSelfLoops),Ee+=J.inDegree+J.outDegree+2*Le),Ee},se.source=function(M){var k=this._edges.get(M=""+M);if(!k)throw new ne('Graph.source: could not find the "'.concat(M,'" edge in the graph.'));return k.source.key},se.target=function(M){var k=this._edges.get(M=""+M);if(!k)throw new ne('Graph.target: could not find the "'.concat(M,'" edge in the graph.'));return k.target.key},se.extremities=function(M){var k=this._edges.get(M=""+M);if(!k)throw new ne('Graph.extremities: could not find the "'.concat(M,'" edge in the graph.'));return[k.source.key,k.target.key]},se.opposite=function(M,k){M=""+M;var J=this._edges.get(k=""+k);if(!J)throw new ne('Graph.opposite: could not find the "'.concat(k,'" edge in the graph.'));var Ee=J.source.key,Le=J.target.key;if(M!==Ee&&M!==Le)throw new ne('Graph.opposite: the "'.concat(M,'" node is not attached to the "').concat(k,'" edge (').concat(Ee,", ").concat(Le,")."));return M===Ee?Le:Ee},se.hasExtremity=function(M,k){k=""+k;var J=this._edges.get(M=""+M);if(!J)throw new ne('Graph.hasExtremity: could not find the "'.concat(M,'" edge in the graph.'));return J.source.key===k||J.target.key===k},se.isUndirected=function(M){var k=this._edges.get(M=""+M);if(!k)throw new ne('Graph.isUndirected: could not find the "'.concat(M,'" edge in the graph.'));return k.undirected},se.isDirected=function(M){var k=this._edges.get(M=""+M);if(!k)throw new ne('Graph.isDirected: could not find the "'.concat(M,'" edge in the graph.'));return!k.undirected},se.isSelfLoop=function(M){var k=this._edges.get(M=""+M);if(!k)throw new ne('Graph.isSelfLoop: could not find the "'.concat(M,'" edge in the graph.'));return k.source===k.target},se.hasGeneratedKey=function(M){var k=this._edges.get(M=""+M);if(!k)throw new ne('Graph.hasGeneratedKey: could not find the "'.concat(M,'" edge in the graph.'));return k.generatedKey},se.addNode=function(M,k){return function(J,Ee,Le){if(Le&&!F(Le))throw new me('Graph.addNode: invalid attributes. Expecting an object but got "'.concat(Le,'"'));if(Le=Le||{},J._nodes.has(Ee=""+Ee))throw new ye('Graph.addNode: the "'.concat(Ee,'" node already exist in the graph.'));var nt=new J.NodeDataClass(Ee,Le);return J._nodes.set(Ee,nt),J.emit("nodeAdded",{key:Ee,attributes:Le}),nt}(this,M,k).key},se.mergeNode=function(M,k){if(k&&!F(k))throw new me('Graph.mergeNode: invalid attributes. Expecting an object but got "'.concat(k,'"'));k=k||{};var J=this._nodes.get(M=""+M);return J?(k&&(he(J.attributes,k),this.emit("nodeAttributesUpdated",{type:"merge",key:M,attributes:J.attributes,data:k})),M):(J=new this.NodeDataClass(M,k),this._nodes.set(M,J),this.emit("nodeAdded",{key:M,attributes:k}),M)},se.updateNode=function(M,k){if(k&&"function"!=typeof k)throw new me('Graph.updateNode: invalid updater function. Expecting a function but got "'.concat(k,'"'));var J=this._nodes.get(M=""+M);if(J)return k&&(J.attributes=k(J.attributes),this.emit("nodeAttributesUpdated",{type:"replace",key:M,attributes:J.attributes})),M;var Le=k?k({}):{};return J=new this.NodeDataClass(M,Le),this._nodes.set(M,J),this.emit("nodeAdded",{key:M,attributes:Le}),M},se.dropNode=function(M){var k=this,J=this._nodes.get(M=""+M);if(!J)throw new ne('Graph.dropNode: could not find the "'.concat(M,'" node in the graph.'));this.forEachEdge(M,function(Ee){k.dropEdge(Ee)}),this._nodes.delete(M),this.emit("nodeDropped",{key:M,attributes:J.attributes})},se.dropEdge=function(M){var k;if(arguments.length>1){var J=""+arguments[0],Ee=""+arguments[1];if(!(k=W(this,J,Ee,this.type)))throw new ne('Graph.dropEdge: could not find the "'.concat(J,'" -> "').concat(Ee,'" edge in the graph.'))}else if(!(k=this._edges.get(M=""+M)))throw new ne('Graph.dropEdge: could not find the "'.concat(M,'" edge in the graph.'));this._edges.delete(k.key);var nt=k.source,Ot=k.target,We=k.attributes,Wt=k.undirected;return nt===Ot?Wt?(nt.undirectedSelfLoops--,this._undirectedSelfLoopCount--):(nt.directedSelfLoops--,this._directedSelfLoopCount--):Wt?(nt.undirectedDegree--,Ot.undirectedDegree--):(nt.outDegree--,Ot.inDegree--),Ke(this,Wt,k),Wt?this._undirectedSize--:this._directedSize--,this.emit("edgeDropped",{key:M,attributes:We,source:nt.key,target:Ot.key,undirected:Wt}),this},se.clear=function(){this._edges.clear(),this._nodes.clear(),this.emit("cleared")},se.clearEdges=function(){this._edges.clear(),this.clearIndex(),this.emit("edgesCleared")},se.getAttribute=function(M){return this._attributes[M]},se.getAttributes=function(){return this._attributes},se.hasAttribute=function(M){return this._attributes.hasOwnProperty(M)},se.setAttribute=function(M,k){return this._attributes[M]=k,this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:M}),this},se.updateAttribute=function(M,k){if("function"!=typeof k)throw new me("Graph.updateAttribute: updater should be a function.");return this._attributes[M]=k(this._attributes[M]),this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:M}),this},se.removeAttribute=function(M){return delete this._attributes[M],this.emit("attributesUpdated",{type:"remove",attributes:this._attributes,name:M}),this},se.replaceAttributes=function(M){if(!F(M))throw new me("Graph.replaceAttributes: provided attributes are not a plain object.");return this._attributes=M,this.emit("attributesUpdated",{type:"replace",attributes:this._attributes}),this},se.mergeAttributes=function(M){if(!F(M))throw new me("Graph.mergeAttributes: provided attributes are not a plain object.");return he(this._attributes,M),this.emit("attributesUpdated",{type:"merge",attributes:this._attributes,data:M}),this},se.getNodeAttribute=function(M,k){var J=this._nodes.get(M=""+M);if(!J)throw new ne('Graph.getNodeAttribute: could not find the "'.concat(M,'" node in the graph.'));return J.attributes[k]},se.getNodeAttributes=function(M){var k=this._nodes.get(M=""+M);if(!k)throw new ne('Graph.getNodeAttributes: could not find the "'.concat(M,'" node in the graph.'));return k.attributes},se.hasNodeAttribute=function(M,k){var J=this._nodes.get(M=""+M);if(!J)throw new ne('Graph.hasNodeAttribute: could not find the "'.concat(M,'" node in the graph.'));return J.attributes.hasOwnProperty(k)},se.setNodeAttribute=function(M,k,J){var Ee=this._nodes.get(M=""+M);if(!Ee)throw new ne('Graph.setNodeAttribute: could not find the "'.concat(M,'" node in the graph.'));if(arguments.length<3)throw new me("Graph.setNodeAttribute: not enough arguments. Either you forgot to pass the attribute's name or value, or you meant to use #.replaceNodeAttributes / #.mergeNodeAttributes instead.");return Ee.attributes[k]=J,this.emit("nodeAttributesUpdated",{key:M,type:"set",attributes:Ee.attributes,name:k}),this},se.updateNodeAttribute=function(M,k,J){var Ee=this._nodes.get(M=""+M);if(!Ee)throw new ne('Graph.updateNodeAttribute: could not find the "'.concat(M,'" node in the graph.'));if(arguments.length<3)throw new me("Graph.updateNodeAttribute: not enough arguments. Either you forgot to pass the attribute's name or updater, or you meant to use #.replaceNodeAttributes / #.mergeNodeAttributes instead.");if("function"!=typeof J)throw new me("Graph.updateAttribute: updater should be a function.");var Le=Ee.attributes,nt=J(Le[k]);return Le[k]=nt,this.emit("nodeAttributesUpdated",{key:M,type:"set",attributes:Ee.attributes,name:k}),this},se.removeNodeAttribute=function(M,k){var J=this._nodes.get(M=""+M);if(!J)throw new ne('Graph.hasNodeAttribute: could not find the "'.concat(M,'" node in the graph.'));return delete J.attributes[k],this.emit("nodeAttributesUpdated",{key:M,type:"remove",attributes:J.attributes,name:k}),this},se.replaceNodeAttributes=function(M,k){var J=this._nodes.get(M=""+M);if(!J)throw new ne('Graph.replaceNodeAttributes: could not find the "'.concat(M,'" node in the graph.'));if(!F(k))throw new me("Graph.replaceNodeAttributes: provided attributes are not a plain object.");return J.attributes=k,this.emit("nodeAttributesUpdated",{key:M,type:"replace",attributes:J.attributes}),this},se.mergeNodeAttributes=function(M,k){var J=this._nodes.get(M=""+M);if(!J)throw new ne('Graph.mergeNodeAttributes: could not find the "'.concat(M,'" node in the graph.'));if(!F(k))throw new me("Graph.mergeNodeAttributes: provided attributes are not a plain object.");return he(J.attributes,k),this.emit("nodeAttributesUpdated",{key:M,type:"merge",attributes:J.attributes,data:k}),this},se.updateEachNodeAttributes=function(M,k){if("function"!=typeof M)throw new me("Graph.updateEachNodeAttributes: expecting an updater function.");if(k&&!C(k))throw new me("Graph.updateEachNodeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");for(var J,Ee,Le=this._nodes.values();!0!==(J=Le.next()).done;)(Ee=J.value).attributes=M(Ee.key,Ee.attributes);this.emit("eachNodeAttributesUpdated",{hints:k||null})},se.updateEachEdgeAttributes=function(M,k){if("function"!=typeof M)throw new me("Graph.updateEachEdgeAttributes: expecting an updater function.");if(k&&!C(k))throw new me("Graph.updateEachEdgeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");for(var J,Ee,Le=this._edges.values();!0!==(J=Le.next()).done;)(Ee=J.value).attributes=M(Ee.key,Ee.attributes);this.emit("eachEdgeAttributesUpdated",{hints:k||null})},se.forEach=function(M){if("function"!=typeof M)throw new me("Graph.forEach: expecting a callback.");this.multi?ut(!1,this,M):Be(!1,this,M)},se.forEachUntil=function(M){if("function"!=typeof M)throw new me("Graph.forEach: expecting a callback.");this.multi?ut(!0,this,M):Be(!0,this,M)},se.adjacency=function(){return this.multi?(nt=(M=this)._nodes.values(),Ot=M.type,We="outer",Wt=null,new oe(function Ct(){var mn;if("outer"===We)return!0===(mn=nt.next()).done?mn:(k=mn.value,We="directed",Ct());if("directed"===We)return"undirected"===Ot?(We="undirected",Ct()):(Ee=k.out,J=Object.keys(k.out),Le=0,We="inner-directed",Ct());if("undirected"===We){if("directed"===Ot)return We="outer",Ct();Ee=k.undirected,J=Object.keys(k.undirected),Le=0,We="inner-undirected"}if(!Wt&&Le>=J.length)return We="inner-undirected"===We?"outer":"undirected",Ct();if(!Wt){var vs=J[Le++];return Wt=Ee[vs].values(),Ct()}if((mn=Wt.next()).done)return Wt=null,Ct();var qr=mn.value,Ks=qr.target;return"inner-undirected"===We&&Ks.key===k.key&&(Ks=qr.source),{done:!1,value:[k.key,Ks.key,k.attributes,Ks.attributes,qr.key,qr.attributes]}})):(Dl=(Ct=this)._nodes.values(),co=Ct.type,Fr="outer",new oe(function Ls(){var bc;if("outer"===Fr)return!0===(bc=Dl.next()).done?bc:(mn=bc.value,Fr="directed",Ls());if("directed"===Fr)return"undirected"===co?(Fr="undirected",Ls()):(qr=mn.out,vs=Object.keys(mn.out),Ks=0,Fr="inner-directed",Ls());if("undirected"===Fr){if("directed"===co)return Fr="outer",Ls();qr=mn.undirected,vs=Object.keys(mn.undirected),Ks=0,Fr="inner-undirected"}if(Ks>=vs.length)return Fr="inner-undirected"===Fr?"outer":"undirected",Ls();var bn=vs[Ks++],uo=qr[bn],Il=uo.target;return"inner-undirected"===Fr&&Il.key===mn.key&&(Il=uo.source),{done:!1,value:[mn.key,Il.key,mn.attributes,Il.attributes,uo.key,uo.attributes]}}));var Ct,mn,vs,qr,Ks,Dl,co,Fr,M,k,J,Ee,Le,nt,Ot,We,Wt},se.nodes=function(){return"function"==typeof Array.from?Array.from(this._nodes.keys()):te(this._nodes.keys(),this._nodes.size)},se.forEachNode=function(M){if("function"!=typeof M)throw new me("Graph.forEachNode: expecting a callback.");this._nodes.forEach(function(k,J){M(J,k.attributes)})},se.forEachNodeUntil=function(M){if("function"!=typeof M)throw new me("Graph.forEachNode: expecting a callback.");for(var k,J,Ee=this._nodes.values();!0!==(k=Ee.next())&&!M((J=k.value).key,J.attributes););},se.nodeEntries=function(){var M=this._nodes.values();return new oe(function(){var k=M.next();if(k.done)return k;var J=k.value;return{value:[J.key,J.attributes],done:!1}})},se.exportNode=function(M){var k=this._nodes.get(M=""+M);if(!k)throw new ne('Graph.exportNode: could not find the "'.concat(M,'" node in the graph.'));return Je(M,k)},se.exportEdge=function(M){var k=this._edges.get(M=""+M);if(!k)throw new ne('Graph.exportEdge: could not find the "'.concat(M,'" edge in the graph.'));return Tt(M,k)},se.export=function(){var M=new Array(this._nodes.size),k=0;this._nodes.forEach(function(Ee,Le){M[k++]=Je(Le,Ee)});var J=new Array(this._edges.size);return k=0,this._edges.forEach(function(Ee,Le){J[k++]=Tt(Le,Ee)}),{attributes:this.getAttributes(),nodes:M,edges:J,options:{type:this.type,multi:this.multi,allowSelfLoops:this.allowSelfLoops}}},se.importNode=function(M){var k=arguments.length>1&&void 0!==arguments[1]&&arguments[1],J=Mt(M);if(J){if("not-object"===J)throw new me('Graph.importNode: invalid serialized node. A serialized node should be a plain object with at least a "key" property.');if("no-key"===J)throw new me("Graph.importNode: no key provided.");if("invalid-attributes"===J)throw new me("Graph.importNode: invalid attributes. Attributes should be a plain object, null or omitted.")}var Ee=M.key,Le=M.attributes,nt=void 0===Le?{}:Le;return k?this.mergeNode(Ee,nt):this.addNode(Ee,nt),this},se.importEdge=function(M){var k=arguments.length>1&&void 0!==arguments[1]&&arguments[1],J=Dt(M);if(J){if("not-object"===J)throw new me('Graph.importEdge: invalid serialized edge. A serialized edge should be a plain object with at least a "source" & "target" property.');if("no-source"===J)throw new me("Graph.importEdge: missing souce.");if("no-target"===J)throw new me("Graph.importEdge: missing target.");if("invalid-attributes"===J)throw new me("Graph.importEdge: invalid attributes. Attributes should be a plain object, null or omitted.");if("invalid-undirected"===J)throw new me("Graph.importEdge: invalid undirected. Undirected should be boolean or omitted.")}var Ee=M.source,Le=M.target,nt=M.attributes,Ot=void 0===nt?{}:nt,We=M.undirected,Wt=void 0!==We&&We;return"key"in M?(k?Wt?this.mergeUndirectedEdgeWithKey:this.mergeDirectedEdgeWithKey:Wt?this.addUndirectedEdgeWithKey:this.addDirectedEdgeWithKey).call(this,M.key,Ee,Le,Ot):(k?Wt?this.mergeUndirectedEdge:this.mergeDirectedEdge:Wt?this.addUndirectedEdge:this.addDirectedEdge).call(this,Ee,Le,Ot),this},se.import=function(M){var k,J,Ee,Le=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(j(M))return this.import(M.export(),Le),this;if(!F(M))throw new me("Graph.import: invalid argument. Expecting a serialized graph or, alternatively, a Graph instance.");if(M.attributes){if(!F(M.attributes))throw new me("Graph.import: invalid attributes. Expecting a plain object.");Le?this.mergeAttributes(M.attributes):this.replaceAttributes(M.attributes)}if(M.nodes){if(Ee=M.nodes,!Array.isArray(Ee))throw new me("Graph.import: invalid nodes. Expecting an array.");for(k=0,J=Ee.length;k<J;k++)this.importNode(Ee[k],Le)}if(M.edges){if(Ee=M.edges,!Array.isArray(Ee))throw new me("Graph.import: invalid edges. Expecting an array.");for(k=0,J=Ee.length;k<J;k++)this.importEdge(Ee[k],Le)}return this},se.nullCopy=function(M){return new fe(he({},this._options,M))},se.emptyCopy=function(M){var k=this.nullCopy(M);return this._nodes.forEach(function(J,Ee){var Le=he({},J.attributes);J=new k.NodeDataClass(Ee,Le),k._nodes.set(Ee,J)}),k},se.copy=function(){var M=new fe(this._options);return M.import(this),M},se.upgradeToMixed=function(){return"mixed"===this.type||(this._nodes.forEach(function(M){return M.upgradeToMixed()}),this._options.type="mixed",b(this,"type",this._options.type),H(this,"NodeDataClass",Oe)),this},se.upgradeToMulti=function(){return this.multi||(this._options.multi=!0,b(this,"multi",!0),(M=this)._nodes.forEach(function(k,J){if(k.out)for(var Ee in k.out){var Le=new Set;Le.add(k.out[Ee]),k.out[Ee]=Le,M._nodes.get(Ee).in[J]=Le}if(k.undirected)for(var nt in k.undirected)if(!(nt>J)){var Ot=new Set;Ot.add(k.undirected[nt]),k.undirected[nt]=Ot,M._nodes.get(nt).undirected[J]=Ot}})),this;var M},se.clearIndex=function(){return this._nodes.forEach(function(M){void 0!==M.in&&(M.in={},M.out={}),void 0!==M.undirected&&(M.undirected={})}),this},se.toJSON=function(){return this.export()},se.toString=function(){return"[object Graph]"},se.inspect=function(){var M=this,k={};this._nodes.forEach(function(Ot,We){k[We]=Ot.attributes});var J={},Ee={};this._edges.forEach(function(Ot,We){var Wt=Ot.undirected?"--":"->",Ct="",mn="(".concat(Ot.source.key,")").concat(Wt,"(").concat(Ot.target.key,")");Ot.generatedKey?M.multi&&(void 0===Ee[mn]?Ee[mn]=0:Ee[mn]++,Ct+="".concat(Ee[mn],". ")):Ct+="[".concat(We,"]: "),J[Ct+=mn]=Ot.attributes});var Le={};for(var nt in this)this.hasOwnProperty(nt)&&!Un.has(nt)&&"function"!=typeof this[nt]&&(Le[nt]=this[nt]);return Le.attributes=this._attributes,Le.nodes=k,Le.edges=J,H(Le,"constructor",this.constructor),Le},fe}(T.exports.EventEmitter);"undefined"!=typeof Symbol&&(Sn.prototype[Symbol.for("nodejs.util.inspect.custom")]=Sn.prototype.inspect),[{name:function(re){return"".concat(re,"Edge")},generateKey:!0},{name:function(re){return"".concat(re,"DirectedEdge")},generateKey:!0,type:"directed"},{name:function(re){return"".concat(re,"UndirectedEdge")},generateKey:!0,type:"undirected"},{name:function(re){return"".concat(re,"EdgeWithKey")}},{name:function(re){return"".concat(re,"DirectedEdgeWithKey")},type:"directed"},{name:function(re){return"".concat(re,"UndirectedEdgeWithKey")},type:"undirected"}].forEach(function(re){["add","merge","update"].forEach(function(fe){var se=re.name(fe),M="add"===fe?gn:Wn;Sn.prototype[se]=re.generateKey?function(k,J,Ee){return M(this,se,!0,"undirected"===(re.type||this.type),null,k,J,Ee,"update"===fe)}:function(k,J,Ee,Le){return M(this,se,!1,"undirected"===(re.type||this.type),k,J,Ee,Le,"update"===fe)}})}),"undefined"!=typeof Symbol&&(Sn.prototype[Symbol.iterator]=Sn.prototype.adjacency),re=Sn,ze.forEach(function(fe){var se=fe.name,M=fe.attacher;M(re,se("Edge"),"mixed"),M(re,se("DirectedEdge"),"directed"),M(re,se("UndirectedEdge"),"undirected")}),function(re){Ae.forEach(function(fe){var M,k,J,Ee;J=(M=fe).type,Ee=M.direction,re.prototype[k=M.name]=function(Le,nt){if("mixed"!==J&&"mixed"!==this.type&&J!==this.type)return[];if(!arguments.length)return Re(this,J);if(1===arguments.length){var Ot=this._nodes.get(Le=""+Le);if(void 0===Ot)throw new ne("Graph.".concat(k,': could not find the "').concat(Le,'" node in the graph.'));return Mn(this.multi,"mixed"===J?this.type:J,Ee,Ot)}if(2===arguments.length){nt=""+nt;var We=this._nodes.get(Le=""+Le);if(!We)throw new ne("Graph.".concat(k,':  could not find the "').concat(Le,'" source node in the graph.'));if(!this._nodes.has(nt))throw new ne("Graph.".concat(k,':  could not find the "').concat(nt,'" target node in the graph.'));return fi(J,this.multi,Ee,We,nt)}throw new me("Graph.".concat(k,": too many arguments (expecting 0, 1 or 2 and got ").concat(arguments.length,")."))},function(se,M){var k=M.name,J=M.type,Ee=M.direction,Le="forEach"+k[0].toUpperCase()+k.slice(1,-1);se.prototype[Le]=function(nt,Ot,We){if("mixed"===J||"mixed"===this.type||J===this.type){if(1===arguments.length)return Ze(this,J,We=nt);if(2===arguments.length){We=Ot;var Wt=this._nodes.get(nt=""+nt);if(void 0===Wt)throw new ne("Graph.".concat(Le,': could not find the "').concat(nt,'" node in the graph.'));return Nn(this.multi,"mixed"===J?this.type:J,Ee,Wt,We)}if(3===arguments.length){Ot=""+Ot;var Ct=this._nodes.get(nt=""+nt);if(!Ct)throw new ne("Graph.".concat(Le,':  could not find the "').concat(nt,'" source node in the graph.'));if(!this._nodes.has(Ot))throw new ne("Graph.".concat(Le,':  could not find the "').concat(Ot,'" target node in the graph.'));return Gr(J,this.multi,Ee,Ct,Ot,We)}throw new me("Graph.".concat(Le,": too many arguments (expecting 1, 2 or 3 and got ").concat(arguments.length,")."))}}}(re,fe),function(se,M){var k=M.name,J=M.type,Ee=M.direction,Le="forEach"+k[0].toUpperCase()+k.slice(1,-1)+"Until";se.prototype[Le]=function(nt,Ot,We){if("mixed"===J||"mixed"===this.type||J===this.type){if(1===arguments.length)return St(this,J,We=nt);if(2===arguments.length){We=Ot;var Wt=this._nodes.get(nt=""+nt);if(void 0===Wt)throw new ne("Graph.".concat(Le,': could not find the "').concat(nt,'" node in the graph.'));return $n(this.multi,"mixed"===J?this.type:J,Ee,Wt,We)}if(3===arguments.length){Ot=""+Ot;var Ct=this._nodes.get(nt=""+nt);if(!Ct)throw new ne("Graph.".concat(Le,':  could not find the "').concat(nt,'" source node in the graph.'));if(!this._nodes.has(Ot))throw new ne("Graph.".concat(Le,':  could not find the "').concat(Ot,'" target node in the graph.'));return Ps(J,this.multi,Ee,Ct,Ot,We)}throw new me("Graph.".concat(Le,": too many arguments (expecting 1, 2 or 3 and got ").concat(arguments.length,")."))}}}(re,fe),function(se,M){var J=M.type,Ee=M.direction,Le=M.name.slice(0,-1)+"Entries";se.prototype[Le]=function(nt,Ot){if("mixed"!==J&&"mixed"!==this.type&&J!==this.type)return oe.empty();if(!arguments.length)return Rt(this,J);if(1===arguments.length){var We=this._nodes.get(nt=""+nt);if(!We)throw new ne("Graph.".concat(Le,': could not find the "').concat(nt,'" node in the graph.'));return bi(J,Ee,We)}if(2===arguments.length){Ot=""+Ot;var Wt=this._nodes.get(nt=""+nt);if(!Wt)throw new ne("Graph.".concat(Le,':  could not find the "').concat(nt,'" source node in the graph.'));if(!this._nodes.has(Ot))throw new ne("Graph.".concat(Le,':  could not find the "').concat(Ot,'" target node in the graph.'));return ds(J,Ee,Wt,Ot)}throw new me("Graph.".concat(Le,": too many arguments (expecting 0, 1 or 2 and got ").concat(arguments.length,")."))}}(re,fe)})}(Sn),function(re){Fs.forEach(function(fe){var M,k,J,Ee;J=(M=fe).type,Ee=M.direction,re.prototype[k=M.name]=function(Le){if("mixed"!==J&&"mixed"!==this.type&&J!==this.type)return[];if(2===arguments.length){var nt=""+arguments[0],Ot=""+arguments[1];if(!this._nodes.has(nt))throw new ne("Graph.".concat(k,': could not find the "').concat(nt,'" node in the graph.'));if(!this._nodes.has(Ot))throw new ne("Graph.".concat(k,': could not find the "').concat(Ot,'" node in the graph.'));return lt(this,J,Ee,nt,Ot)}if(1===arguments.length){var We=this._nodes.get(Le=""+Le);if(void 0===We)throw new ne("Graph.".concat(k,': could not find the "').concat(Le,'" node in the graph.'));return _a("mixed"===J?this.type:J,Ee,We)}throw new me("Graph.".concat(k,": invalid number of arguments (expecting 1 or 2 and got ").concat(arguments.length,")."))},function(re,fe){var se=fe.name,M=fe.type,k=fe.direction,J="forEach"+se[0].toUpperCase()+se.slice(1,-1);re.prototype[J]=function(Ee,Le){if("mixed"===M||"mixed"===this.type||M===this.type){var nt=this._nodes.get(Ee=""+Ee);if(void 0===nt)throw new ne("Graph.".concat(J,': could not find the "').concat(Ee,'" node in the graph.'));!function(Ot,We,Wt,Ct){if("mixed"!==Ot){if("undirected"===Ot)return Ml(Wt,Wt.undirected,Ct);if("string"==typeof We)return Ml(Wt,Wt[We],Ct)}var mn=new Set;"undirected"!==Ot&&("out"!==We&&ya(mn,Wt,Wt.in,Ct),"in"!==We&&ya(mn,Wt,Wt.out,Ct)),"directed"!==Ot&&ya(mn,Wt,Wt.undirected,Ct)}("mixed"===M?this.type:M,k,nt,Le)}}}(re,fe),function(re,fe){var se=fe.name,M=fe.type,k=fe.direction,J="forEach"+se[0].toUpperCase()+se.slice(1,-1)+"Until";re.prototype[J]=function(Ee,Le){if("mixed"===M||"mixed"===this.type||M===this.type){var nt=this._nodes.get(Ee=""+Ee);if(void 0===nt)throw new ne("Graph.".concat(J,': could not find the "').concat(Ee,'" node in the graph.'));!function(Ot,We,Wt,Ct){if("mixed"!==Ot){if("undirected"===Ot)return ys(Wt,Wt.undirected,Ct);if("string"==typeof We)return ys(Wt,Wt[We],Ct)}var mn=new Set;"undirected"!==Ot&&("out"!==We&&Jt(mn,Wt,Wt.in,Ct)||"in"!==We&&Jt(mn,Wt,Wt.out,Ct))||"directed"===Ot||Jt(mn,Wt,Wt.undirected,Ct)}("mixed"===M?this.type:M,k,nt,Le)}}}(re,fe),function(re,fe){var M=fe.type,k=fe.direction,J=fe.name.slice(0,-1)+"Entries";re.prototype[J]=function(Ee){if("mixed"!==M&&"mixed"!==this.type&&M!==this.type)return oe.empty();var Le=this._nodes.get(Ee=""+Ee);if(void 0===Le)throw new ne("Graph.".concat(J,': could not find the "').concat(Ee,'" node in the graph.'));return function(nt,Ot,We){if("mixed"!==nt){if("undirected"===nt)return Ka(We,We.undirected);if("string"==typeof Ot)return Ka(We,We[Ot])}var Wt=oe.empty(),Ct=new Set;return"undirected"!==nt&&("out"!==Ot&&(Wt=Xe(Wt,rt(Ct,We,We.in))),"in"!==Ot&&(Wt=Xe(Wt,rt(Ct,We,We.out)))),"directed"!==nt&&(Wt=Xe(Wt,rt(Ct,We,We.undirected))),Wt}("mixed"===M?this.type:M,k,Le)}}(re,fe)})}(Sn);var tr=function(re){function fe(se){var M=he({type:"directed"},se);if("multi"in M&&!1!==M.multi)throw new me("DirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if("directed"!==M.type)throw new me('DirectedGraph.from: inconsistent "'+M.type+'" type in given options!');return re.call(this,M)||this}return et(fe,re),fe}(Sn),nr=function(re){function fe(se){var M=he({type:"undirected"},se);if("multi"in M&&!1!==M.multi)throw new me("UndirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if("undirected"!==M.type)throw new me('UndirectedGraph.from: inconsistent "'+M.type+'" type in given options!');return re.call(this,M)||this}return et(fe,re),fe}(Sn),Yn=function(re){function fe(se){var M=he({multi:!0},se);if("multi"in M&&!0!==M.multi)throw new me("MultiGraph.from: inconsistent indication that the graph should be simple in given options!");return re.call(this,M)||this}return et(fe,re),fe}(Sn),ji=function(re){function fe(se){var M=he({type:"directed",multi:!0},se);if("multi"in M&&!0!==M.multi)throw new me("MultiDirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if("directed"!==M.type)throw new me('MultiDirectedGraph.from: inconsistent "'+M.type+'" type in given options!');return re.call(this,M)||this}return et(fe,re),fe}(Sn),va=function(re){function fe(se){var M=he({type:"undirected",multi:!0},se);if("multi"in M&&!0!==M.multi)throw new me("MultiUndirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if("undirected"!==M.type)throw new me('MultiUndirectedGraph.from: inconsistent "'+M.type+'" type in given options!');return re.call(this,M)||this}return et(fe,re),fe}(Sn);function Wr(re){re.from=function(fe,se){var M=he({},fe.options,se),k=new re(M);return k.import(fe),k}}return Wr(Sn),Wr(tr),Wr(nr),Wr(Yn),Wr(ji),Wr(va),Sn.Graph=Sn,Sn.DirectedGraph=tr,Sn.UndirectedGraph=nr,Sn.MultiGraph=Yn,Sn.MultiDirectedGraph=ji,Sn.MultiUndirectedGraph=va,Sn.InvalidArgumentsGraphError=me,Sn.NotFoundGraphError=ne,Sn.UsageGraphError=ye,Sn}()},1524:(Ut,it,et)=>{var yt;!function(ee,At,dt,Y){"use strict";var T,xe=["","webkit","Moz","MS","ms","o"],he=At.createElement("div"),j=Math.round,F=Math.abs,Q=Date.now;function H(ve,Me,Ge){return setTimeout(A(ve,Ge),Me)}function b(ve,Me,Ge){return!!Array.isArray(ve)&&(C(ve,Ge[Me],Ge),!0)}function C(ve,Me,Ge){var bt;if(ve)if(ve.forEach)ve.forEach(Me,Ge);else if(ve.length!==Y)for(bt=0;bt<ve.length;)Me.call(Ge,ve[bt],bt,ve),bt++;else for(bt in ve)ve.hasOwnProperty(bt)&&Me.call(Ge,ve[bt],bt,ve)}function R(ve,Me,Ge){var bt="DEPRECATED METHOD: "+Me+"\n"+Ge+" AT \n";return function(){var Ht=new Error("get-stack-trace"),Yt=Ht&&Ht.stack?Ht.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",ri=ee.console&&(ee.console.warn||ee.console.log);return ri&&ri.call(ee.console,bt,Yt),ve.apply(this,arguments)}}T="function"!=typeof Object.assign?function(Me){if(Me===Y||null===Me)throw new TypeError("Cannot convert undefined or null to object");for(var Ge=Object(Me),bt=1;bt<arguments.length;bt++){var Ht=arguments[bt];if(Ht!==Y&&null!==Ht)for(var Yt in Ht)Ht.hasOwnProperty(Yt)&&(Ge[Yt]=Ht[Yt])}return Ge}:Object.assign;var v=R(function(Me,Ge,bt){for(var Ht=Object.keys(Ge),Yt=0;Yt<Ht.length;)(!bt||bt&&Me[Ht[Yt]]===Y)&&(Me[Ht[Yt]]=Ge[Ht[Yt]]),Yt++;return Me},"extend","Use `assign`."),y=R(function(Me,Ge){return v(Me,Ge,!0)},"merge","Use `assign`.");function x(ve,Me,Ge){var Ht,bt=Me.prototype;(Ht=ve.prototype=Object.create(bt)).constructor=ve,Ht._super=bt,Ge&&T(Ht,Ge)}function A(ve,Me){return function(){return ve.apply(Me,arguments)}}function z(ve,Me){return"function"==typeof ve?ve.apply(Me&&Me[0]||Y,Me):ve}function N(ve,Me){return ve===Y?Me:ve}function K(ve,Me,Ge){C(X(Me),function(bt){ve.addEventListener(bt,Ge,!1)})}function ue(ve,Me,Ge){C(X(Me),function(bt){ve.removeEventListener(bt,Ge,!1)})}function I(ve,Me){for(;ve;){if(ve==Me)return!0;ve=ve.parentNode}return!1}function O(ve,Me){return ve.indexOf(Me)>-1}function X(ve){return ve.trim().split(/\s+/g)}function E(ve,Me,Ge){if(ve.indexOf&&!Ge)return ve.indexOf(Me);for(var bt=0;bt<ve.length;){if(Ge&&ve[bt][Ge]==Me||!Ge&&ve[bt]===Me)return bt;bt++}return-1}function $(ve){return Array.prototype.slice.call(ve,0)}function Z(ve,Me,Ge){for(var bt=[],Ht=[],Yt=0;Yt<ve.length;){var ri=Me?ve[Yt][Me]:ve[Yt];E(Ht,ri)<0&&bt.push(ve[Yt]),Ht[Yt]=ri,Yt++}return Ge&&(bt=Me?bt.sort(function(Yr,bs){return Yr[Me]>bs[Me]}):bt.sort()),bt}function ae(ve,Me){for(var Ge,bt,Ht=Me[0].toUpperCase()+Me.slice(1),Yt=0;Yt<xe.length;){if((bt=(Ge=xe[Yt])?Ge+Ht:Me)in ve)return bt;Yt++}return Y}var oe=1;function Ce(ve){var Me=ve.ownerDocument||ve;return Me.defaultView||Me.parentWindow||ee}var ne="ontouchstart"in ee,ye=ae(ee,"PointerEvent")!==Y,Oe=ne&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),$e="touch",Qe="mouse",_t=["x","y"],pt=["clientX","clientY"];function we(ve,Me){var Ge=this;this.manager=ve,this.callback=Me,this.element=ve.element,this.target=ve.options.inputTarget,this.domHandler=function(bt){z(ve.options.enable,[ve])&&Ge.handler(bt)},this.init()}function P(ve,Me,Ge){var bt=Ge.pointers.length,Ht=Ge.changedPointers.length,Yt=1&Me&&bt-Ht==0,ri=12&Me&&bt-Ht==0;Ge.isFirst=!!Yt,Ge.isFinal=!!ri,Yt&&(ve.session={}),Ge.eventType=Me,function(ve,Me){var Ge=ve.session,bt=Me.pointers,Ht=bt.length;Ge.firstInput||(Ge.firstInput=St(Me)),Ht>1&&!Ge.firstMultiple?Ge.firstMultiple=St(Me):1===Ht&&(Ge.firstMultiple=!1);var Yt=Ge.firstInput,ri=Ge.firstMultiple,Lr=ri?ri.center:Yt.center,Yr=Me.center=Rt(bt);Me.timeStamp=Q(),Me.deltaTime=Me.timeStamp-Yt.timeStamp,Me.angle=bi(Lr,Yr),Me.distance=$n(Lr,Yr),function(ve,Me){var Ge=Me.center,bt=ve.offsetDelta||{},Ht=ve.prevDelta||{},Yt=ve.prevInput||{};(1===Me.eventType||4===Yt.eventType)&&(Ht=ve.prevDelta={x:Yt.deltaX||0,y:Yt.deltaY||0},bt=ve.offsetDelta={x:Ge.x,y:Ge.y}),Me.deltaX=Ht.x+(Ge.x-bt.x),Me.deltaY=Ht.y+(Ge.y-bt.y)}(Ge,Me),Me.offsetDirection=Nn(Me.deltaX,Me.deltaY);var bs=Mn(Me.deltaTime,Me.deltaX,Me.deltaY);Me.overallVelocityX=bs.x,Me.overallVelocityY=bs.y,Me.overallVelocity=F(bs.x)>F(bs.y)?bs.x:bs.y,Me.scale=ri?function(ve,Me){return $n(Me[0],Me[1],pt)/$n(ve[0],ve[1],pt)}(ri.pointers,bt):1,Me.rotation=ri?function(ve,Me){return bi(Me[1],Me[0],pt)+bi(ve[1],ve[0],pt)}(ri.pointers,bt):0,Me.maxPointers=Ge.prevInput?Me.pointers.length>Ge.prevInput.maxPointers?Me.pointers.length:Ge.prevInput.maxPointers:Me.pointers.length,function(ve,Me){var Ht,Yt,ri,Lr,Ge=ve.lastInterval||Me,bt=Me.timeStamp-Ge.timeStamp;if(8!=Me.eventType&&(bt>25||Ge.velocity===Y)){var Yr=Me.deltaX-Ge.deltaX,bs=Me.deltaY-Ge.deltaY,ti=Mn(bt,Yr,bs);Yt=ti.x,ri=ti.y,Ht=F(ti.x)>F(ti.y)?ti.x:ti.y,Lr=Nn(Yr,bs),ve.lastInterval=Me}else Ht=Ge.velocity,Yt=Ge.velocityX,ri=Ge.velocityY,Lr=Ge.direction;Me.velocity=Ht,Me.velocityX=Yt,Me.velocityY=ri,Me.direction=Lr}(Ge,Me);var ti=ve.element;I(Me.srcEvent.target,ti)&&(ti=Me.srcEvent.target),Me.target=ti}(ve,Ge),ve.emit("hammer.input",Ge),ve.recognize(Ge),ve.session.prevInput=Ge}function St(ve){for(var Me=[],Ge=0;Ge<ve.pointers.length;)Me[Ge]={clientX:j(ve.pointers[Ge].clientX),clientY:j(ve.pointers[Ge].clientY)},Ge++;return{timeStamp:Q(),pointers:Me,center:Rt(Me),deltaX:ve.deltaX,deltaY:ve.deltaY}}function Rt(ve){var Me=ve.length;if(1===Me)return{x:j(ve[0].clientX),y:j(ve[0].clientY)};for(var Ge=0,bt=0,Ht=0;Ht<Me;)Ge+=ve[Ht].clientX,bt+=ve[Ht].clientY,Ht++;return{x:j(Ge/Me),y:j(bt/Me)}}function Mn(ve,Me,Ge){return{x:Me/ve||0,y:Ge/ve||0}}function Nn(ve,Me){return ve===Me?1:F(ve)>=F(Me)?ve<0?2:4:Me<0?8:16}function $n(ve,Me,Ge){Ge||(Ge=_t);var bt=Me[Ge[0]]-ve[Ge[0]],Ht=Me[Ge[1]]-ve[Ge[1]];return Math.sqrt(bt*bt+Ht*Ht)}function bi(ve,Me,Ge){return Ge||(Ge=_t),180*Math.atan2(Me[Ge[1]]-ve[Ge[1]],Me[Ge[0]]-ve[Ge[0]])/Math.PI}we.prototype={handler:function(){},init:function(){this.evEl&&K(this.element,this.evEl,this.domHandler),this.evTarget&&K(this.target,this.evTarget,this.domHandler),this.evWin&&K(Ce(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&ue(this.element,this.evEl,this.domHandler),this.evTarget&&ue(this.target,this.evTarget,this.domHandler),this.evWin&&ue(Ce(this.element),this.evWin,this.domHandler)}};var Ps={mousedown:1,mousemove:2,mouseup:4},ds="mousedown",Fs="mousemove mouseup";function $r(){this.evEl=ds,this.evWin=Fs,this.pressed=!1,we.apply(this,arguments)}x($r,we,{handler:function(Me){var Ge=Ps[Me.type];1&Ge&&0===Me.button&&(this.pressed=!0),2&Ge&&1!==Me.which&&(Ge=4),this.pressed&&(4&Ge&&(this.pressed=!1),this.callback(this.manager,Ge,{pointers:[Me],changedPointers:[Me],pointerType:Qe,srcEvent:Me}))}});var _a={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},Ml={2:$e,3:"pen",4:Qe,5:"kinect"},ya="pointerdown",ys="pointermove pointerup pointercancel";function Jt(){this.evEl=ya,this.evWin=ys,we.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}ee.MSPointerEvent&&!ee.PointerEvent&&(ya="MSPointerDown",ys="MSPointerMove MSPointerUp MSPointerCancel"),x(Jt,we,{handler:function(Me){var Ge=this.store,bt=!1,Ht=Me.type.toLowerCase().replace("ms",""),Yt=_a[Ht],ri=Ml[Me.pointerType]||Me.pointerType,Lr=ri==$e,Yr=E(Ge,Me.pointerId,"pointerId");1&Yt&&(0===Me.button||Lr)?Yr<0&&(Ge.push(Me),Yr=Ge.length-1):12&Yt&&(bt=!0),!(Yr<0)&&(Ge[Yr]=Me,this.callback(this.manager,Yt,{pointers:Ge,changedPointers:[Me],pointerType:ri,srcEvent:Me}),bt&&Ge.splice(Yr,1))}});var Ka={touchstart:1,touchmove:2,touchend:4,touchcancel:8},rt="touchstart",lt="touchstart touchmove touchend touchcancel";function ht(){this.evTarget=rt,this.evWin=lt,this.started=!1,we.apply(this,arguments)}function ge(ve,Me){var Ge=$(ve.touches),bt=$(ve.changedTouches);return 12&Me&&(Ge=Z(Ge.concat(bt),"identifier",!0)),[Ge,bt]}x(ht,we,{handler:function(Me){var Ge=Ka[Me.type];if(1===Ge&&(this.started=!0),this.started){var bt=ge.call(this,Me,Ge);12&Ge&&bt[0].length-bt[1].length==0&&(this.started=!1),this.callback(this.manager,Ge,{pointers:bt[0],changedPointers:bt[1],pointerType:$e,srcEvent:Me})}}});var be={touchstart:1,touchmove:2,touchend:4,touchcancel:8},Be="touchstart touchmove touchend touchcancel";function ut(){this.evTarget=Be,this.targetIds={},we.apply(this,arguments)}function Je(ve,Me){var Ge=$(ve.touches),bt=this.targetIds;if(3&Me&&1===Ge.length)return bt[Ge[0].identifier]=!0,[Ge,Ge];var Ht,Yt,ri=$(ve.changedTouches),Lr=[],Yr=this.target;if(Yt=Ge.filter(function(bs){return I(bs.target,Yr)}),1===Me)for(Ht=0;Ht<Yt.length;)bt[Yt[Ht].identifier]=!0,Ht++;for(Ht=0;Ht<ri.length;)bt[ri[Ht].identifier]&&Lr.push(ri[Ht]),12&Me&&delete bt[ri[Ht].identifier],Ht++;return Lr.length?[Z(Yt.concat(Lr),"identifier",!0),Lr]:void 0}function Dt(){we.apply(this,arguments);var ve=A(this.handler,this);this.touch=new ut(this.manager,ve),this.mouse=new $r(this.manager,ve),this.primaryTouch=null,this.lastTouches=[]}function Xt(ve,Me){1&ve?(this.primaryTouch=Me.changedPointers[0].identifier,Un.call(this,Me)):12&ve&&Un.call(this,Me)}function Un(ve){var Me=ve.changedPointers[0];if(Me.identifier===this.primaryTouch){var Ge={x:Me.clientX,y:Me.clientY};this.lastTouches.push(Ge);var bt=this.lastTouches;setTimeout(function(){var Yt=bt.indexOf(Ge);Yt>-1&&bt.splice(Yt,1)},2500)}}function ii(ve){for(var Me=ve.srcEvent.clientX,Ge=ve.srcEvent.clientY,bt=0;bt<this.lastTouches.length;bt++){var Ht=this.lastTouches[bt],Yt=Math.abs(Me-Ht.x),ri=Math.abs(Ge-Ht.y);if(Yt<=25&&ri<=25)return!0}return!1}x(ut,we,{handler:function(Me){var Ge=be[Me.type],bt=Je.call(this,Me,Ge);!bt||this.callback(this.manager,Ge,{pointers:bt[0],changedPointers:bt[1],pointerType:$e,srcEvent:Me})}}),x(Dt,we,{handler:function(Me,Ge,bt){var Yt=bt.pointerType==Qe;if(!(Yt&&bt.sourceCapabilities&&bt.sourceCapabilities.firesTouchEvents)){if(bt.pointerType==$e)Xt.call(this,Ge,bt);else if(Yt&&ii.call(this,bt))return;this.callback(Me,Ge,bt)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var On=ae(he.style,"touchAction"),gn=On!==Y,Wn="compute",tr="manipulation",nr="none",Yn="pan-x",ji="pan-y",va=function(){if(!gn)return!1;var ve={},Me=ee.CSS&&ee.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(Ge){ve[Ge]=!Me||ee.CSS.supports("touch-action",Ge)}),ve}();function Wr(ve,Me){this.manager=ve,this.set(Me)}function Ot(ve){this.options=T({},this.defaults,ve||{}),this.id=oe++,this.manager=null,this.options.enable=N(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function We(ve){return 16&ve?"cancel":8&ve?"end":4&ve?"move":2&ve?"start":""}function Wt(ve){return 16==ve?"down":8==ve?"up":2==ve?"left":4==ve?"right":""}function Ct(ve,Me){var Ge=Me.manager;return Ge?Ge.get(ve):ve}function mn(){Ot.apply(this,arguments)}function vs(){mn.apply(this,arguments),this.pX=null,this.pY=null}function qr(){mn.apply(this,arguments)}function Ks(){Ot.apply(this,arguments),this._timer=null,this._input=null}function Dl(){mn.apply(this,arguments)}function co(){mn.apply(this,arguments)}function Fr(){Ot.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Ls(ve,Me){return(Me=Me||{}).recognizers=N(Me.recognizers,Ls.defaults.preset),new uo(ve,Me)}function uo(ve,Me){this.options=T({},Ls.defaults,Me||{}),this.options.inputTarget=this.options.inputTarget||ve,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=ve,this.input=function(ve){return new(ve.options.inputClass||(ye?Jt:Oe?ut:ne?Dt:$r))(ve,P)}(this),this.touchAction=new Wr(this,this.options.touchAction),Il(this,!0),C(this.options.recognizers,function(Ge){var bt=this.add(new Ge[0](Ge[1]));Ge[2]&&bt.recognizeWith(Ge[2]),Ge[3]&&bt.requireFailure(Ge[3])},this)}function Il(ve,Me){var bt,Ge=ve.element;Ge.style&&(C(ve.options.cssProps,function(Ht,Yt){bt=ae(Ge.style,Yt),Me?(ve.oldCssProps[bt]=Ge.style[bt],Ge.style[bt]=Ht):Ge.style[bt]=ve.oldCssProps[bt]||""}),Me||(ve.oldCssProps={}))}Wr.prototype={set:function(ve){ve==Wn&&(ve=this.compute()),gn&&this.manager.element.style&&va[ve]&&(this.manager.element.style[On]=ve),this.actions=ve.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var ve=[];return C(this.manager.recognizers,function(Me){z(Me.options.enable,[Me])&&(ve=ve.concat(Me.getTouchAction()))}),function(ve){if(O(ve,nr))return nr;var Me=O(ve,Yn),Ge=O(ve,ji);return Me&&Ge?nr:Me||Ge?Me?Yn:ji:O(ve,tr)?tr:"auto"}(ve.join(" "))},preventDefaults:function(ve){var Me=ve.srcEvent,Ge=ve.offsetDirection;if(!this.manager.session.prevented){var bt=this.actions,Ht=O(bt,nr)&&!va[nr],Yt=O(bt,ji)&&!va[ji],ri=O(bt,Yn)&&!va[Yn];if(Ht&&1===ve.pointers.length&&ve.distance<2&&ve.deltaTime<250)return;return ri&&Yt||!(Ht||Yt&&6&Ge||ri&&24&Ge)?void 0:this.preventSrc(Me)}Me.preventDefault()},preventSrc:function(ve){this.manager.session.prevented=!0,ve.preventDefault()}},Ot.prototype={defaults:{},set:function(ve){return T(this.options,ve),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(ve){if(b(ve,"recognizeWith",this))return this;var Me=this.simultaneous;return Me[(ve=Ct(ve,this)).id]||(Me[ve.id]=ve,ve.recognizeWith(this)),this},dropRecognizeWith:function(ve){return b(ve,"dropRecognizeWith",this)||(ve=Ct(ve,this),delete this.simultaneous[ve.id]),this},requireFailure:function(ve){if(b(ve,"requireFailure",this))return this;var Me=this.requireFail;return-1===E(Me,ve=Ct(ve,this))&&(Me.push(ve),ve.requireFailure(this)),this},dropRequireFailure:function(ve){if(b(ve,"dropRequireFailure",this))return this;ve=Ct(ve,this);var Me=E(this.requireFail,ve);return Me>-1&&this.requireFail.splice(Me,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(ve){return!!this.simultaneous[ve.id]},emit:function(ve){var Me=this,Ge=this.state;function bt(Ht){Me.manager.emit(Ht,ve)}Ge<8&&bt(Me.options.event+We(Ge)),bt(Me.options.event),ve.additionalEvent&&bt(ve.additionalEvent),Ge>=8&&bt(Me.options.event+We(Ge))},tryEmit:function(ve){if(this.canEmit())return this.emit(ve);this.state=32},canEmit:function(){for(var ve=0;ve<this.requireFail.length;){if(!(33&this.requireFail[ve].state))return!1;ve++}return!0},recognize:function(ve){var Me=T({},ve);if(!z(this.options.enable,[this,Me]))return this.reset(),void(this.state=32);56&this.state&&(this.state=1),this.state=this.process(Me),30&this.state&&this.tryEmit(Me)},process:function(ve){},getTouchAction:function(){},reset:function(){}},x(mn,Ot,{defaults:{pointers:1},attrTest:function(ve){var Me=this.options.pointers;return 0===Me||ve.pointers.length===Me},process:function(ve){var Me=this.state,Ge=ve.eventType,bt=6&Me,Ht=this.attrTest(ve);return bt&&(8&Ge||!Ht)?16|Me:bt||Ht?4&Ge?8|Me:2&Me?4|Me:2:32}}),x(vs,mn,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var ve=this.options.direction,Me=[];return 6&ve&&Me.push(ji),24&ve&&Me.push(Yn),Me},directionTest:function(ve){var Me=this.options,Ge=!0,bt=ve.distance,Ht=ve.direction,Yt=ve.deltaX,ri=ve.deltaY;return Ht&Me.direction||(6&Me.direction?(Ht=0===Yt?1:Yt<0?2:4,Ge=Yt!=this.pX,bt=Math.abs(ve.deltaX)):(Ht=0===ri?1:ri<0?8:16,Ge=ri!=this.pY,bt=Math.abs(ve.deltaY))),ve.direction=Ht,Ge&&bt>Me.threshold&&Ht&Me.direction},attrTest:function(ve){return mn.prototype.attrTest.call(this,ve)&&(2&this.state||!(2&this.state)&&this.directionTest(ve))},emit:function(ve){this.pX=ve.deltaX,this.pY=ve.deltaY;var Me=Wt(ve.direction);Me&&(ve.additionalEvent=this.options.event+Me),this._super.emit.call(this,ve)}}),x(qr,mn,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[nr]},attrTest:function(ve){return this._super.attrTest.call(this,ve)&&(Math.abs(ve.scale-1)>this.options.threshold||2&this.state)},emit:function(ve){1!==ve.scale&&(ve.additionalEvent=this.options.event+(ve.scale<1?"in":"out")),this._super.emit.call(this,ve)}}),x(Ks,Ot,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return["auto"]},process:function(ve){var Me=this.options,Ge=ve.pointers.length===Me.pointers,bt=ve.distance<Me.threshold,Ht=ve.deltaTime>Me.time;if(this._input=ve,!bt||!Ge||12&ve.eventType&&!Ht)this.reset();else if(1&ve.eventType)this.reset(),this._timer=H(function(){this.state=8,this.tryEmit()},Me.time,this);else if(4&ve.eventType)return 8;return 32},reset:function(){clearTimeout(this._timer)},emit:function(ve){8===this.state&&(ve&&4&ve.eventType?this.manager.emit(this.options.event+"up",ve):(this._input.timeStamp=Q(),this.manager.emit(this.options.event,this._input)))}}),x(Dl,mn,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[nr]},attrTest:function(ve){return this._super.attrTest.call(this,ve)&&(Math.abs(ve.rotation)>this.options.threshold||2&this.state)}}),x(co,mn,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return vs.prototype.getTouchAction.call(this)},attrTest:function(ve){var Ge,Me=this.options.direction;return 30&Me?Ge=ve.overallVelocity:6&Me?Ge=ve.overallVelocityX:24&Me&&(Ge=ve.overallVelocityY),this._super.attrTest.call(this,ve)&&Me&ve.offsetDirection&&ve.distance>this.options.threshold&&ve.maxPointers==this.options.pointers&&F(Ge)>this.options.velocity&&4&ve.eventType},emit:function(ve){var Me=Wt(ve.offsetDirection);Me&&this.manager.emit(this.options.event+Me,ve),this.manager.emit(this.options.event,ve)}}),x(Fr,Ot,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[tr]},process:function(ve){var Me=this.options,Ge=ve.pointers.length===Me.pointers,bt=ve.distance<Me.threshold,Ht=ve.deltaTime<Me.time;if(this.reset(),1&ve.eventType&&0===this.count)return this.failTimeout();if(bt&&Ht&&Ge){if(4!=ve.eventType)return this.failTimeout();var Yt=!this.pTime||ve.timeStamp-this.pTime<Me.interval,ri=!this.pCenter||$n(this.pCenter,ve.center)<Me.posThreshold;if(this.pTime=ve.timeStamp,this.pCenter=ve.center,ri&&Yt?this.count+=1:this.count=1,this._input=ve,0==this.count%Me.taps)return this.hasRequireFailures()?(this._timer=H(function(){this.state=8,this.tryEmit()},Me.interval,this),2):8}return 32},failTimeout:function(){return this._timer=H(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Ls.VERSION="2.0.7",Ls.defaults={domEvents:!1,touchAction:Wn,enable:!0,inputTarget:null,inputClass:null,preset:[[Dl,{enable:!1}],[qr,{enable:!1},["rotate"]],[co,{direction:6}],[vs,{direction:6},["swipe"]],[Fr],[Fr,{event:"doubletap",taps:2},["tap"]],[Ks]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},uo.prototype={set:function(ve){return T(this.options,ve),ve.touchAction&&this.touchAction.update(),ve.inputTarget&&(this.input.destroy(),this.input.target=ve.inputTarget,this.input.init()),this},stop:function(ve){this.session.stopped=ve?2:1},recognize:function(ve){var Me=this.session;if(!Me.stopped){this.touchAction.preventDefaults(ve);var Ge,bt=this.recognizers,Ht=Me.curRecognizer;(!Ht||Ht&&8&Ht.state)&&(Ht=Me.curRecognizer=null);for(var Yt=0;Yt<bt.length;)Ge=bt[Yt],2===Me.stopped||Ht&&Ge!=Ht&&!Ge.canRecognizeWith(Ht)?Ge.reset():Ge.recognize(ve),!Ht&&14&Ge.state&&(Ht=Me.curRecognizer=Ge),Yt++}},get:function(ve){if(ve instanceof Ot)return ve;for(var Me=this.recognizers,Ge=0;Ge<Me.length;Ge++)if(Me[Ge].options.event==ve)return Me[Ge];return null},add:function(ve){if(b(ve,"add",this))return this;var Me=this.get(ve.options.event);return Me&&this.remove(Me),this.recognizers.push(ve),ve.manager=this,this.touchAction.update(),ve},remove:function(ve){if(b(ve,"remove",this))return this;if(ve=this.get(ve)){var Me=this.recognizers,Ge=E(Me,ve);-1!==Ge&&(Me.splice(Ge,1),this.touchAction.update())}return this},on:function(ve,Me){if(ve!==Y&&Me!==Y){var Ge=this.handlers;return C(X(ve),function(bt){Ge[bt]=Ge[bt]||[],Ge[bt].push(Me)}),this}},off:function(ve,Me){if(ve!==Y){var Ge=this.handlers;return C(X(ve),function(bt){Me?Ge[bt]&&Ge[bt].splice(E(Ge[bt],Me),1):delete Ge[bt]}),this}},emit:function(ve,Me){this.options.domEvents&&function(ve,Me){var Ge=At.createEvent("Event");Ge.initEvent(ve,!0,!0),Ge.gesture=Me,Me.target.dispatchEvent(Ge)}(ve,Me);var Ge=this.handlers[ve]&&this.handlers[ve].slice();if(Ge&&Ge.length){Me.type=ve,Me.preventDefault=function(){Me.srcEvent.preventDefault()};for(var bt=0;bt<Ge.length;)Ge[bt](Me),bt++}},destroy:function(){this.element&&Il(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},T(Ls,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:uo,Input:we,TouchAction:Wr,TouchInput:ut,MouseInput:$r,PointerEventInput:Jt,TouchMouseInput:Dt,SingleTouchInput:ht,Recognizer:Ot,AttrRecognizer:mn,Tap:Fr,Pan:vs,Swipe:co,Pinch:qr,Rotate:Dl,Press:Ks,on:K,off:ue,each:C,merge:y,extend:v,assign:T,inherit:x,bindFn:A,prefixed:ae}),(void 0!==ee?ee:"undefined"!=typeof self?self:{}).Hammer=Ls,(yt=function(){return Ls}.call(it,et,it,Ut))!==Y&&(Ut.exports=yt)}(window,document)},3815:function(Ut,it,et){var yt;Ut=et.nmd(Ut),function(){var ee,xe="Expected a function",W="__lodash_hash_undefined__",F="__lodash_placeholder__",z=32,K=128,te=1/0,Ce=9007199254740991,ye=4294967295,st=[["ary",K],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",z],["partialRight",64],["rearg",256]],Qe="[object Arguments]",tt="[object Array]",ze="[object Boolean]",ke="[object Date]",Ae="[object Error]",Ue="[object Function]",qe="[object GeneratorFunction]",Fe="[object Map]",q="[object Number]",pe="[object Object]",de="[object Promise]",_t="[object RegExp]",pt="[object Set]",we="[object String]",B="[object Symbol]",V="[object WeakMap]",Ze="[object ArrayBuffer]",St="[object DataView]",Rt="[object Float32Array]",Mn="[object Float64Array]",Nn="[object Int8Array]",$n="[object Int16Array]",bi="[object Int32Array]",fi="[object Uint8Array]",Gr="[object Uint8ClampedArray]",Ps="[object Uint16Array]",ds="[object Uint32Array]",Fs=/\b__p \+= '';/g,$r=/\b(__p \+=) '' \+/g,_a=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Ml=/&(?:amp|lt|gt|quot|#39);/g,ya=/[&<>"']/g,ys=RegExp(Ml.source),Jt=RegExp(ya.source),Ka=/<%-([\s\S]+?)%>/g,rt=/<%([\s\S]+?)%>/g,lt=/<%=([\s\S]+?)%>/g,ht=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ge=/^\w*$/,be=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Be=/[\\^$.*+?()[\]{}|]/g,ut=RegExp(Be.source),Je=/^\s+/,Tt=/\s/,Mt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Dt=/\{\n\/\* \[wrapped with (.+)\] \*/,Xt=/,? & /,Un=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ii=/[()=,{}\[\]\/\s]/,On=/\\(\\)?/g,gn=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Wn=/\w*$/,Sn=/^[-+]0x[0-9a-f]+$/i,tr=/^0b[01]+$/i,nr=/^\[object .+?Constructor\]$/,Yn=/^0o[0-7]+$/i,ji=/^(?:0|[1-9]\d*)$/,va=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Wr=/($^)/,re=/['\n\r\u2028\u2029\\]/g,fe="\\ud800-\\udfff",J="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Ee="\\u2700-\\u27bf",Le="a-z\\xdf-\\xf6\\xf8-\\xff",Ct="A-Z\\xc0-\\xd6\\xd8-\\xde",mn="\\ufe0e\\ufe0f",vs="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ks="["+fe+"]",Dl="["+vs+"]",co="["+J+"]",Fr="\\d+",Ls="["+Ee+"]",bc="["+Le+"]",bn="[^"+fe+vs+Fr+Ee+Le+Ct+"]",uo="\\ud83c[\\udffb-\\udfff]",ba="[^"+fe+"]",md="(?:\\ud83c[\\udde6-\\uddff]){2}",ve="[\\ud800-\\udbff][\\udc00-\\udfff]",Me="["+Ct+"]",bt="(?:"+bc+"|"+bn+")",Ht="(?:"+Me+"|"+bn+")",Yt="(?:['\u2019](?:d|ll|m|re|s|t|ve))?",ri="(?:['\u2019](?:D|LL|M|RE|S|T|VE))?",Lr="(?:"+co+"|"+uo+")?",Yr="["+mn+"]?",pT=Yr+Lr+"(?:\\u200d(?:"+[ba,md,ve].join("|")+")"+Yr+Lr+")*",_d="(?:"+[Ls,md,ve].join("|")+")"+pT,Zi="(?:"+[ba+co+"?",co,md,ve,Ks].join("|")+")",op=RegExp("['\u2019]","g"),Ym=RegExp(co,"g"),Th=RegExp(uo+"(?="+uo+")|"+Zi+pT,"g"),Yv=RegExp([Me+"?"+bc+"+"+Yt+"(?="+[Dl,Me,"$"].join("|")+")",Ht+"+"+ri+"(?="+[Dl,Me+bt,"$"].join("|")+")",Me+"?"+bt+"+"+Yt,Me+"+"+ri,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Fr,_d].join("|"),"g"),gT=RegExp("[\\u200d"+fe+J+mn+"]"),Ol=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Ah=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],mT=-1,_n={};_n[Rt]=_n[Mn]=_n[Nn]=_n[$n]=_n[bi]=_n[fi]=_n[Gr]=_n[Ps]=_n[ds]=!0,_n[Qe]=_n[tt]=_n[Ze]=_n[ze]=_n[St]=_n[ke]=_n[Ae]=_n[Ue]=_n[Fe]=_n[q]=_n[pe]=_n[_t]=_n[pt]=_n[we]=_n[V]=!1;var ir={};ir[Qe]=ir[tt]=ir[Ze]=ir[St]=ir[ze]=ir[ke]=ir[Rt]=ir[Mn]=ir[Nn]=ir[$n]=ir[bi]=ir[Fe]=ir[q]=ir[pe]=ir[_t]=ir[pt]=ir[we]=ir[B]=ir[fi]=ir[Gr]=ir[Ps]=ir[ds]=!0,ir[Ae]=ir[Ue]=ir[V]=!1;var an={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},_T=parseFloat,Zv=parseInt,Bt="object"==typeof global&&global&&global.Object===Object&&global,ks="object"==typeof self&&self&&self.Object===Object&&self,Li=Bt||ks||Function("return this")(),Rl=it&&!it.nodeType&&it,wa=Rl&&Ut&&!Ut.nodeType&&Ut,Ao=wa&&wa.exports===Rl,Km=Ao&&Bt.process,yr=function(){try{return wa&&wa.require&&wa.require("util").types||Km&&Km.binding&&Km.binding("util")}catch(It){}}(),rn=yr&&yr.isArrayBuffer,oi=yr&&yr.isDate,or=yr&&yr.isMap,ho=yr&&yr.isRegExp,wc=yr&&yr.isSet,ts=yr&&yr.isTypedArray;function ns(at,It,Et){switch(Et.length){case 0:return at.call(It);case 1:return at.call(It,Et[0]);case 2:return at.call(It,Et[0],Et[1]);case 3:return at.call(It,Et[0],Et[1],Et[2])}return at.apply(It,Et)}function kr(at,It,Et,cn){for(var Tn=-1,Ni=null==at?0:at.length;++Tn<Ni;){var Kr=at[Tn];It(cn,Kr,Et(Kr),at)}return cn}function Bs(at,It){for(var Et=-1,cn=null==at?0:at.length;++Et<cn&&!1!==It(at[Et],Et,at););return at}function yd(at,It){for(var Et=null==at?0:at.length;Et--&&!1!==It(at[Et],Et,at););return at}function Jn(at,It){for(var Et=-1,cn=null==at?0:at.length;++Et<cn;)if(!It(at[Et],Et,at))return!1;return!0}function Ea(at,It){for(var Et=-1,cn=null==at?0:at.length,Tn=0,Ni=[];++Et<cn;){var Kr=at[Et];It(Kr,Et,at)&&(Ni[Tn++]=Kr)}return Ni}function Nl(at,It){return!(null==at||!at.length)&&Xa(at,It,0)>-1}function Mh(at,It,Et){for(var cn=-1,Tn=null==at?0:at.length;++cn<Tn;)if(Et(It,at[cn]))return!0;return!1}function Ui(at,It){for(var Et=-1,cn=null==at?0:at.length,Tn=Array(cn);++Et<cn;)Tn[Et]=It(at[Et],Et,at);return Tn}function Br(at,It){for(var Et=-1,cn=It.length,Tn=at.length;++Et<cn;)at[Tn+Et]=It[Et];return at}function pu(at,It,Et,cn){var Tn=-1,Ni=null==at?0:at.length;for(cn&&Ni&&(Et=at[++Tn]);++Tn<Ni;)Et=It(Et,at[Tn],Tn,at);return Et}function vd(at,It,Et,cn){var Tn=null==at?0:at.length;for(cn&&Tn&&(Et=at[--Tn]);Tn--;)Et=It(Et,at[Tn],Tn,at);return Et}function Mo(at,It){for(var Et=-1,cn=null==at?0:at.length;++Et<cn;)if(It(at[Et],Et,at))return!0;return!1}var rr=Xm("length");function Dh(at,It,Et){var cn;return Et(at,function(Tn,Ni,Kr){if(It(Tn,Ni,Kr))return cn=Ni,!1}),cn}function bd(at,It,Et,cn){for(var Tn=at.length,Ni=Et+(cn?1:-1);cn?Ni--:++Ni<Tn;)if(It(at[Ni],Ni,at))return Ni;return-1}function Xa(at,It,Et){return It==It?function(at,It,Et){for(var cn=Et-1,Tn=at.length;++cn<Tn;)if(at[cn]===It)return cn;return-1}(at,It,Et):bd(at,Ec,Et)}function ap(at,It,Et,cn){for(var Tn=Et-1,Ni=at.length;++Tn<Ni;)if(cn(at[Tn],It))return Tn;return-1}function Ec(at){return at!=at}function ws(at,It){var Et=null==at?0:at.length;return Et?wd(at,It)/Et:NaN}function Xm(at){return function(It){return null==It?ee:It[at]}}function Go(at){return function(It){return null==at?ee:at[It]}}function $o(at,It,Et,cn,Tn){return Tn(at,function(Ni,Kr,Hi){Et=cn?(cn=!1,Ni):It(Et,Ni,Kr,Hi)}),Et}function wd(at,It){for(var Et,cn=-1,Tn=at.length;++cn<Tn;){var Ni=It(at[cn]);Ni!==ee&&(Et=Et===ee?Ni:Et+Ni)}return Et}function Ed(at,It){for(var Et=-1,cn=Array(at);++Et<at;)cn[Et]=It(Et);return cn}function Jv(at){return at&&at.slice(0,Sc(at)+1).replace(Je,"")}function Wo(at){return function(It){return at(It)}}function Zm(at,It){return Ui(It,function(Et){return at[Et]})}function Ih(at,It){return at.has(It)}function bT(at,It){for(var Et=-1,cn=at.length;++Et<cn&&Xa(It,at[Et],0)>-1;);return Et}function wT(at,It){for(var Et=at.length;Et--&&Xa(It,at[Et],0)>-1;);return Et}function BF(at,It){for(var Et=at.length,cn=0;Et--;)at[Et]===It&&++cn;return cn}var VF=Go({\u00c0:"A",\u00c1:"A",\u00c2:"A",\u00c3:"A",\u00c4:"A",\u00c5:"A",\u00e0:"a",\u00e1:"a",\u00e2:"a",\u00e3:"a",\u00e4:"a",\u00e5:"a",\u00c7:"C",\u00e7:"c",\u00d0:"D",\u00f0:"d",\u00c8:"E",\u00c9:"E",\u00ca:"E",\u00cb:"E",\u00e8:"e",\u00e9:"e",\u00ea:"e",\u00eb:"e",\u00cc:"I",\u00cd:"I",\u00ce:"I",\u00cf:"I",\u00ec:"i",\u00ed:"i",\u00ee:"i",\u00ef:"i",\u00d1:"N",\u00f1:"n",\u00d2:"O",\u00d3:"O",\u00d4:"O",\u00d5:"O",\u00d6:"O",\u00d8:"O",\u00f2:"o",\u00f3:"o",\u00f4:"o",\u00f5:"o",\u00f6:"o",\u00f8:"o",\u00d9:"U",\u00da:"U",\u00db:"U",\u00dc:"U",\u00f9:"u",\u00fa:"u",\u00fb:"u",\u00fc:"u",\u00dd:"Y",\u00fd:"y",\u00ff:"y",\u00c6:"Ae",\u00e6:"ae",\u00de:"Th",\u00fe:"th",\u00df:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010a:"C",\u010c:"C",\u0107:"c",\u0109:"c",\u010b:"c",\u010d:"c",\u010e:"D",\u0110:"D",\u010f:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011a:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011b:"e",\u011c:"G",\u011e:"G",\u0120:"G",\u0122:"G",\u011d:"g",\u011f:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012a:"I",\u012c:"I",\u012e:"I",\u0130:"I",\u0129:"i",\u012b:"i",\u012d:"i",\u012f:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013b:"L",\u013d:"L",\u013f:"L",\u0141:"L",\u013a:"l",\u013c:"l",\u013e:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014a:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014b:"n",\u014c:"O",\u014e:"O",\u0150:"O",\u014d:"o",\u014f:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015a:"S",\u015c:"S",\u015e:"S",\u0160:"S",\u015b:"s",\u015d:"s",\u015f:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016a:"U",\u016c:"U",\u016e:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016b:"u",\u016d:"u",\u016f:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017b:"Z",\u017d:"Z",\u017a:"z",\u017c:"z",\u017e:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017f:"s"}),jF=Go({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function UF(at){return"\\"+an[at]}function Oh(at){return gT.test(at)}function eb(at){var It=-1,Et=Array(at.size);return at.forEach(function(cn,Tn){Et[++It]=[Tn,cn]}),Et}function ET(at,It){return function(Et){return at(It(Et))}}function gu(at,It){for(var Et=-1,cn=at.length,Tn=0,Ni=[];++Et<cn;){var Kr=at[Et];(Kr===It||Kr===F)&&(at[Et]=F,Ni[Tn++]=Et)}return Ni}function Jm(at){var It=-1,Et=Array(at.size);return at.forEach(function(cn){Et[++It]=cn}),Et}function Rh(at){return Oh(at)?function(at){for(var It=Th.lastIndex=0;Th.test(at);)++It;return It}(at):rr(at)}function Qa(at){return Oh(at)?function(at){return at.match(Th)||[]}(at):function(at){return at.split("")}(at)}function Sc(at){for(var It=at.length;It--&&Tt.test(at.charAt(It)););return It}var t_=Go({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),Nh=function at(It){var d,Et=(It=null==It?Li:Nh.defaults(Li.Object(),It,Nh.pick(Li,Ah))).Array,cn=It.Date,Tn=It.Error,Ni=It.Function,Kr=It.Math,Hi=It.Object,n_=It.RegExp,i_=It.String,xa=It.TypeError,ar=Et.prototype,mu=Hi.prototype,lp=It["__core-js_shared__"],vr=Ni.prototype.toString,Gi=mu.hasOwnProperty,qF=0,Ph=(d=/[^.]+$/.exec(lp&&lp.keys&&lp.keys.IE_PROTO||""))?"Symbol(src)_1."+d:"",Xs=mu.toString,CT=vr.call(Hi),r_=Li._,Sd=n_("^"+vr.call(Gi).replace(Be,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Vs=Ao?It.Buffer:ee,Pl=It.Symbol,xd=It.Uint8Array,ib=Vs?Vs.allocUnsafe:ee,Ca=ET(Hi.getPrototypeOf,Hi),s_=Hi.create,cp=mu.propertyIsEnumerable,Ln=ar.splice,TT=Pl?Pl.isConcatSpreadable:ee,Fh=Pl?Pl.iterator:ee,_u=Pl?Pl.toStringTag:ee,up=function(){try{var d=Nc(Hi,"defineProperty");return d({},"",{}),d}catch(p){}}(),rb=It.clearTimeout!==Li.clearTimeout&&It.clearTimeout,AT=cn&&cn.now!==Li.Date.now&&cn.now,MT=It.setTimeout!==Li.setTimeout&&It.setTimeout,Vt=Kr.ceil,pi=Kr.floor,Mr=Hi.getOwnPropertySymbols,is=Vs?Vs.isBuffer:ee,o_=It.isFinite,Lh=ar.join,Za=ET(Hi.keys,Hi),Vr=Kr.max,hs=Kr.min,YF=cn.now,DT=It.parseInt,kh=Kr.random,dp=ar.reverse,Es=Nc(It,"DataView"),fo=Nc(It,"Map"),hp=Nc(It,"Promise"),Ta=Nc(It,"Set"),Do=Nc(It,"WeakMap"),Bh=Nc(Hi,"create"),Vh=Do&&new Do,Cd={},IT=Du(Es),a_=Du(fo),l_=Du(hp),sb=Du(Ta),c_=Du(Do),fp=Pl?Pl.prototype:ee,Td=fp?fp.valueOf:ee,jh=fp?fp.toString:ee;function Se(d){if(Er(d)&&!Dn(d)&&!(d instanceof ai)){if(d instanceof Io)return d;if(Gi.call(d,"__wrapped__"))return kp(d)}return new Io(d)}var yu=function(){function d(){}return function(p){if(!wr(p))return{};if(s_)return s_(p);d.prototype=p;var _=new d;return d.prototype=ee,_}}();function Uh(){}function Io(d,p){this.__wrapped__=d,this.__actions__=[],this.__chain__=!!p,this.__index__=0,this.__values__=ee}function ai(d){this.__wrapped__=d,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=ye,this.__views__=[]}function po(d){var p=-1,_=null==d?0:d.length;for(this.clear();++p<_;){var L=d[p];this.set(L[0],L[1])}}function Fl(d){var p=-1,_=null==d?0:d.length;for(this.clear();++p<_;){var L=d[p];this.set(L[0],L[1])}}function Ja(d){var p=-1,_=null==d?0:d.length;for(this.clear();++p<_;){var L=d[p];this.set(L[0],L[1])}}function Aa(d){var p=-1,_=null==d?0:d.length;for(this.__data__=new Ja;++p<_;)this.add(d[p])}function Ma(d){var p=this.__data__=new Fl(d);this.size=p.size}function Hh(d,p){var _=Dn(d),L=!_&&ll(d),le=!_&&!L&&cl(d),Te=!_&&!L&&!le&&sf(d),He=_||L||le||Te,Ye=He?Ed(d.length,i_):[],ct=Ye.length;for(var Nt in d)(p||Gi.call(d,Nt))&&(!He||!("length"==Nt||le&&("offset"==Nt||"parent"==Nt)||Te&&("buffer"==Nt||"byteLength"==Nt||"byteOffset"==Nt)||No(Nt,ct)))&&Ye.push(Nt);return Ye}function f_(d){var p=d.length;return p?d[Ll(0,p-1)]:ee}function ab(d,p){return Ud(Zs(d),vu(p,0,d.length))}function Ad(d){return Ud(Zs(d))}function p_(d,p,_){(_!==ee&&!An(d[p],_)||_===ee&&!(p in d))&&tl(d,p,_)}function el(d,p,_){var L=d[p];(!Gi.call(d,p)||!An(L,_)||_===ee&&!(p in d))&&tl(d,p,_)}function Md(d,p){for(var _=d.length;_--;)if(An(d[_][0],p))return _;return-1}function yp(d,p,_,L){return Tc(d,function(le,Te,He){p(L,le,_(le),He)}),L}function zT(d,p){return d&&Ia(p,As(p),d)}function tl(d,p,_){"__proto__"==p&&up?up(d,p,{configurable:!0,enumerable:!0,value:_,writable:!0}):d[p]=_}function g_(d,p){for(var _=-1,L=p.length,le=Et(L),Te=null==d;++_<L;)le[_]=Te?ee:lf(d,p[_]);return le}function vu(d,p,_){return d==d&&(_!==ee&&(d=d<=_?d:_),p!==ee&&(d=d>=p?d:p)),d}function js(d,p,_,L,le,Te){var He,Ye=1&p,ct=2&p,Nt=4&p;if(_&&(He=le?_(d,L,le,Te):_(d)),He!==ee)return He;if(!wr(d))return d;var Pt=Dn(d);if(Pt){if(He=function(d){var p=d.length,_=new d.constructor(p);return p&&"string"==typeof d[0]&&Gi.call(d,"index")&&(_.index=d.index,_.input=d.input),_}(d),!Ye)return Zs(d,He)}else{var zt=zs(d),en=zt==Ue||zt==qe;if(cl(d))return Tp(d,Ye);if(zt==pe||zt==Qe||en&&!le){if(He=ct||en?{}:Ib(d),!Ye)return ct?function(d,p){return Ia(d,Ab(d),p)}(d,function(d,p){return d&&Ia(p,eo(p),d)}(He,d)):function(d,p){return Ia(d,O_(d),p)}(d,zT(He,d))}else{if(!ir[zt])return le?d:{};He=function(d,p,_){var L=d.constructor;switch(p){case Ze:return Cu(d);case ze:case ke:return new L(+d);case St:return function(d,p){var _=p?Cu(d.buffer):d.buffer;return new d.constructor(_,d.byteOffset,d.byteLength)}(d,_);case Rt:case Mn:case Nn:case $n:case bi:case fi:case Gr:case Ps:case ds:return T_(d,_);case Fe:return new L;case q:case we:return new L(d);case _t:return function(d){var p=new d.constructor(d.source,Wn.exec(d));return p.lastIndex=d.lastIndex,p}(d);case pt:return new L;case B:return function(d){return Td?Hi(Td.call(d)):{}}(d)}}(d,zt,Ye)}}Te||(Te=new Ma);var vn=Te.get(d);if(vn)return vn;Te.set(d,He),uA(d)?d.forEach(function(kn){He.add(js(kn,p,_,kn,d,Te))}):oA(d)&&d.forEach(function(kn,ui){He.set(ui,js(kn,p,_,ui,d,Te))});var ci=Pt?ee:(Nt?ct?D_:jl:ct?eo:As)(d);return Bs(ci||d,function(kn,ui){ci&&(kn=d[ui=kn]),el(He,ui,js(kn,p,_,ui,d,Te))}),He}function vp(d,p,_){var L=_.length;if(null==d)return!L;for(d=Hi(d);L--;){var le=_[L],He=d[le];if(He===ee&&!(le in d)||!(0,p[le])(He))return!1}return!0}function Gh(d,p,_){if("function"!=typeof d)throw new xa(xe);return Qh(function(){d.apply(ee,_)},p)}function Cc(d,p,_,L){var le=-1,Te=Nl,He=!0,Ye=d.length,ct=[],Nt=p.length;if(!Ye)return ct;_&&(p=Ui(p,Wo(_))),L?(Te=Mh,He=!1):p.length>=200&&(Te=Ih,He=!1,p=new Aa(p));e:for(;++le<Ye;){var Pt=d[le],zt=null==_?Pt:_(Pt);if(Pt=L||0!==Pt?Pt:0,He&&zt==zt){for(var en=Nt;en--;)if(p[en]===zt)continue e;ct.push(Pt)}else Te(p,zt,L)||ct.push(Pt)}return ct}Se.templateSettings={escape:Ka,evaluate:rt,interpolate:lt,variable:"",imports:{_:Se}},(Se.prototype=Uh.prototype).constructor=Se,(Io.prototype=yu(Uh.prototype)).constructor=Io,(ai.prototype=yu(Uh.prototype)).constructor=ai,po.prototype.clear=function(){this.__data__=Bh?Bh(null):{},this.size=0},po.prototype.delete=function(d){var p=this.has(d)&&delete this.__data__[d];return this.size-=p?1:0,p},po.prototype.get=function(d){var p=this.__data__;if(Bh){var _=p[d];return _===W?ee:_}return Gi.call(p,d)?p[d]:ee},po.prototype.has=function(d){var p=this.__data__;return Bh?p[d]!==ee:Gi.call(p,d)},po.prototype.set=function(d,p){var _=this.__data__;return this.size+=this.has(d)?0:1,_[d]=Bh&&p===ee?W:p,this},Fl.prototype.clear=function(){this.__data__=[],this.size=0},Fl.prototype.delete=function(d){var p=this.__data__,_=Md(p,d);return!(_<0||(_==p.length-1?p.pop():Ln.call(p,_,1),--this.size,0))},Fl.prototype.get=function(d){var p=this.__data__,_=Md(p,d);return _<0?ee:p[_][1]},Fl.prototype.has=function(d){return Md(this.__data__,d)>-1},Fl.prototype.set=function(d,p){var _=this.__data__,L=Md(_,d);return L<0?(++this.size,_.push([d,p])):_[L][1]=p,this},Ja.prototype.clear=function(){this.size=0,this.__data__={hash:new po,map:new(fo||Fl),string:new po}},Ja.prototype.delete=function(d){var p=Us(this,d).delete(d);return this.size-=p?1:0,p},Ja.prototype.get=function(d){return Us(this,d).get(d)},Ja.prototype.has=function(d){return Us(this,d).has(d)},Ja.prototype.set=function(d,p){var _=Us(this,d),L=_.size;return _.set(d,p),this.size+=_.size==L?0:1,this},Aa.prototype.add=Aa.prototype.push=function(d){return this.__data__.set(d,W),this},Aa.prototype.has=function(d){return this.__data__.has(d)},Ma.prototype.clear=function(){this.__data__=new Fl,this.size=0},Ma.prototype.delete=function(d){var p=this.__data__,_=p.delete(d);return this.size=p.size,_},Ma.prototype.get=function(d){return this.__data__.get(d)},Ma.prototype.has=function(d){return this.__data__.has(d)},Ma.prototype.set=function(d,p){var _=this.__data__;if(_ instanceof Fl){var L=_.__data__;if(!fo||L.length<199)return L.push([d,p]),this.size=++_.size,this;_=this.__data__=new Ja(L)}return _.set(d,p),this.size=_.size,this};var Tc=rl(nl),__=rl(bp,!0);function cb(d,p){var _=!0;return Tc(d,function(L,le,Te){return _=!!p(L,le,Te)}),_}function $h(d,p,_){for(var L=-1,le=d.length;++L<le;){var Te=d[L],He=p(Te);if(null!=He&&(Ye===ee?He==He&&!ia(He):_(He,Ye)))var Ye=He,ct=Te}return ct}function db(d,p){var _=[];return Tc(d,function(L,le,Te){p(L,le,Te)&&_.push(L)}),_}function Ss(d,p,_,L,le){var Te=-1,He=d.length;for(_||(_=l1),le||(le=[]);++Te<He;){var Ye=d[Te];p>0&&_(Ye)?p>1?Ss(Ye,p-1,_,L,le):Br(le,Ye):L||(le[le.length]=Ye)}return le}var Dd=yb(),Id=yb(!0);function nl(d,p){return d&&Dd(d,p,As)}function bp(d,p){return d&&Id(d,p,As)}function Wh(d,p){return Ea(p,function(_){return na(d[_])})}function qo(d,p){for(var _=0,L=(p=Ic(p,d)).length;null!=d&&_<L;)d=d[ei(p[_++])];return _&&_==L?d:ee}function $i(d,p,_){var L=p(d);return Dn(d)?L:Br(L,_(d))}function xs(d){return null==d?d===ee?"[object Undefined]":"[object Null]":_u&&_u in Hi(d)?function(d){var p=Gi.call(d,_u),_=d[_u];try{d[_u]=ee;var L=!0}catch(Te){}var le=Xs.call(d);return L&&(p?d[_u]=_:delete d[_u]),le}(d):function(d){return Xs.call(d)}(d)}function Yo(d,p){return d>p}function Od(d,p){return null!=d&&Gi.call(d,p)}function Rd(d,p){return null!=d&&p in Hi(d)}function bu(d,p,_){for(var L=_?Mh:Nl,le=d[0].length,Te=d.length,He=Te,Ye=Et(Te),ct=1/0,Nt=[];He--;){var Pt=d[He];He&&p&&(Pt=Ui(Pt,Wo(p))),ct=hs(Pt.length,ct),Ye[He]=!_&&(p||le>=120&&Pt.length>=120)?new Aa(He&&Pt):ee}Pt=d[0];var zt=-1,en=Ye[0];e:for(;++zt<le&&Nt.length<ct;){var vn=Pt[zt],Fn=p?p(vn):vn;if(vn=_||0!==vn?vn:0,!(en?Ih(en,Fn):L(Nt,Fn,_))){for(He=Te;--He;){var ci=Ye[He];if(!(ci?Ih(ci,Fn):L(d[He],Fn,_)))continue e}en&&en.push(Fn),Nt.push(vn)}}return Nt}function Da(d,p,_){var L=null==(d=F_(d,p=Ic(p,d)))?d:d[ei(Jo(p))];return null==L?ee:ns(L,d,_)}function HT(d){return Er(d)&&xs(d)==Qe}function wp(d,p,_,L,le){return d===p||(null==d||null==p||!Er(d)&&!Er(p)?d!=d&&p!=p:function(d,p,_,L,le,Te){var He=Dn(d),Ye=Dn(p),ct=He?tt:zs(d),Nt=Ye?tt:zs(p),Pt=(ct=ct==Qe?pe:ct)==pe,zt=(Nt=Nt==Qe?pe:Nt)==pe,en=ct==Nt;if(en&&cl(d)){if(!cl(p))return!1;He=!0,Pt=!1}if(en&&!Pt)return Te||(Te=new Ma),He||sf(d)?Rp(d,p,_,L,le,Te):function(d,p,_,L,le,Te,He){switch(_){case St:if(d.byteLength!=p.byteLength||d.byteOffset!=p.byteOffset)return!1;d=d.buffer,p=p.buffer;case Ze:return!(d.byteLength!=p.byteLength||!Te(new xd(d),new xd(p)));case ze:case ke:case q:return An(+d,+p);case Ae:return d.name==p.name&&d.message==p.message;case _t:case we:return d==p+"";case Fe:var Ye=eb;case pt:if(Ye||(Ye=Jm),d.size!=p.size&&!(1&L))return!1;var Nt=He.get(d);if(Nt)return Nt==p;L|=2,He.set(d,p);var Pt=Rp(Ye(d),Ye(p),L,le,Te,He);return He.delete(d),Pt;case B:if(Td)return Td.call(d)==Td.call(p)}return!1}(d,p,ct,_,L,le,Te);if(!(1&_)){var vn=Pt&&Gi.call(d,"__wrapped__"),Fn=zt&&Gi.call(p,"__wrapped__");if(vn||Fn){var ci=vn?d.value():d,kn=Fn?p.value():p;return Te||(Te=new Ma),le(ci,kn,_,L,Te)}}return!!en&&(Te||(Te=new Ma),function(d,p,_,L,le,Te){var He=1&_,Ye=jl(d),ct=Ye.length;if(ct!=jl(p).length&&!He)return!1;for(var zt=ct;zt--;){var en=Ye[zt];if(!(He?en in p:Gi.call(p,en)))return!1}var vn=Te.get(d),Fn=Te.get(p);if(vn&&Fn)return vn==p&&Fn==d;var ci=!0;Te.set(d,p),Te.set(p,d);for(var kn=He;++zt<ct;){var ui=d[en=Ye[zt]],wi=p[en];if(L)var _o=He?L(wi,ui,en,p,d,Te):L(ui,wi,en,d,p,Te);if(!(_o===ee?ui===wi||le(ui,wi,_,L,Te):_o)){ci=!1;break}kn||(kn="constructor"==en)}if(ci&&!kn){var Gs=d.constructor,ra=p.constructor;Gs!=ra&&"constructor"in d&&"constructor"in p&&!("function"==typeof Gs&&Gs instanceof Gs&&"function"==typeof ra&&ra instanceof ra)&&(ci=!1)}return Te.delete(d),Te.delete(p),ci}(d,p,_,L,le,Te))}(d,p,_,L,wp,le))}function v_(d,p,_,L){var le=_.length,Te=le,He=!L;if(null==d)return!Te;for(d=Hi(d);le--;){var Ye=_[le];if(He&&Ye[2]?Ye[1]!==d[Ye[0]]:!(Ye[0]in d))return!1}for(;++le<Te;){var ct=(Ye=_[le])[0],Nt=d[ct],Pt=Ye[1];if(He&&Ye[2]){if(Nt===ee&&!(ct in d))return!1}else{var zt=new Ma;if(L)var en=L(Nt,Pt,ct,d,p,zt);if(!(en===ee?wp(Pt,Nt,3,L,zt):en))return!1}}return!0}function b_(d){return!(!wr(d)||function(d){return!!Ph&&Ph in d}(d))&&(na(d)?Sd:nr).test(Du(d))}function WT(d){return"function"==typeof d?d:null==d?to:"object"==typeof d?Dn(d)?Pd(d[0],d[1]):KT(d):Ru(d)}function hb(d){if(!Fp(d))return Za(d);var p=[];for(var _ in Hi(d))Gi.call(d,_)&&"constructor"!=_&&p.push(_);return p}function fb(d,p){return d<p}function qT(d,p){var _=-1,L=go(d)?Et(d.length):[];return Tc(d,function(le,Te,He){L[++_]=p(le,Te,He)}),L}function KT(d){var p=Qo(d);return 1==p.length&&p[0][2]?u1(p[0][0],p[0][1]):function(_){return _===d||v_(_,d,p)}}function Pd(d,p){return Zo(d)&&c1(p)?u1(ei(d),p):function(_){var L=lf(_,d);return L===ee&&L===p?Yp(_,d):wp(p,L,3)}}function w_(d,p,_,L,le){d!==p&&Dd(p,function(Te,He){if(le||(le=new Ma),wr(Te))!function(d,p,_,L,le,Te,He){var Ye=L_(d,_),ct=L_(p,_),Nt=He.get(ct);if(Nt)p_(d,_,Nt);else{var Pt=Te?Te(Ye,ct,_+"",d,p,He):ee,zt=Pt===ee;if(zt){var en=Dn(ct),vn=!en&&cl(ct),Fn=!en&&!vn&&sf(ct);Pt=ct,en||vn||Fn?Dn(Ye)?Pt=Ye:br(Ye)?Pt=Zs(Ye):vn?(zt=!1,Pt=Tp(ct,!0)):Fn?(zt=!1,Pt=T_(ct,!0)):Pt=[]:qp(ct)||ll(ct)?(Pt=Ye,ll(Ye)?Pt=Ew(Ye):(!wr(Ye)||na(Ye))&&(Pt=Ib(ct))):zt=!1}zt&&(He.set(ct,Pt),le(Pt,ct,L,Te,He),He.delete(ct)),p_(d,_,Pt)}}(d,p,He,_,w_,L,le);else{var Ye=L?L(L_(d,He),Te,He+"",d,p,le):ee;Ye===ee&&(Ye=Te),p_(d,He,Ye)}},eo)}function wu(d,p){var _=d.length;if(_)return No(p+=p<0?_:0,_)?d[p]:ee}function qh(d,p,_){p=p.length?Ui(p,function(Te){return Dn(Te)?function(He){return qo(He,1===Te.length?Te[0]:Te)}:Te}):[to];var L=-1;return p=Ui(p,Wo(Pn())),function(at,It){var Et=at.length;for(at.sort(function(Te,He){return function(d,p,_){for(var L=-1,le=d.criteria,Te=p.criteria,He=le.length,Ye=_.length;++L<He;){var ct=Oc(le[L],Te[L]);if(ct)return L>=Ye?ct:ct*("desc"==_[L]?-1:1)}return d.index-p.index}(Te,He,_)});Et--;)at[Et]=at[Et].value;return at}(qT(d,function(Te,He,Ye){return{criteria:Ui(p,function(Nt){return Nt(Te)}),index:++L,value:Te}}))}function pb(d,p,_){for(var L=-1,le=p.length,Te={};++L<le;){var He=p[L],Ye=qo(d,He);_(Ye,He)&&Sp(Te,Ic(He,d),Ye)}return Te}function Xo(d,p,_,L){var le=L?ap:Xa,Te=-1,He=p.length,Ye=d;for(d===p&&(p=Zs(p)),_&&(Ye=Ui(d,Wo(_)));++Te<He;)for(var ct=0,Nt=p[Te],Pt=_?_(Nt):Nt;(ct=le(Ye,Pt,ct,L))>-1;)Ye!==d&&Ln.call(Ye,ct,1),Ln.call(d,ct,1);return d}function Yh(d,p){for(var _=d?p.length:0,L=_-1;_--;){var le=p[_];if(_==L||le!==Te){var Te=le;No(le)?Ln.call(d,le,1):Eu(d,le)}}return d}function Ll(d,p){return d+pi(kh()*(p-d+1))}function Ep(d,p){var _="";if(!d||p<1||p>Ce)return _;do{p%2&&(_+=d),(p=pi(p/2))&&(d+=d)}while(p);return _}function li(d,p){return Lp(d1(d,p,to),d+"")}function XT(d){return f_(Xd(d))}function r2(d,p){var _=Xd(d);return Ud(_,vu(p,0,_.length))}function Sp(d,p,_,L){if(!wr(d))return d;for(var le=-1,Te=(p=Ic(p,d)).length,He=Te-1,Ye=d;null!=Ye&&++le<Te;){var ct=ei(p[le]),Nt=_;if("__proto__"===ct||"constructor"===ct||"prototype"===ct)return d;if(le!=He){var Pt=Ye[ct];(Nt=L?L(Pt,ct,Ye):ee)===ee&&(Nt=wr(Pt)?Pt:No(p[le+1])?[]:{})}el(Ye,ct,Nt),Ye=Ye[ct]}return d}var E_=Vh?function(d,p){return Vh.set(d,p),d}:to,Oo=up?function(d,p){return up(d,"toString",{configurable:!0,enumerable:!1,value:Sy(p),writable:!0})}:to;function S_(d){return Ud(Xd(d))}function Cs(d,p,_){var L=-1,le=d.length;p<0&&(p=-p>le?0:le+p),(_=_>le?le:_)<0&&(_+=le),le=p>_?0:_-p>>>0,p>>>=0;for(var Te=Et(le);++L<le;)Te[L]=d[L+p];return Te}function s2(d,p){var _;return Tc(d,function(L,le,Te){return!(_=p(L,le,Te))}),!!_}function Kh(d,p,_){var L=0,le=null==d?L:d.length;if("number"==typeof p&&p==p&&le<=2147483647){for(;L<le;){var Te=L+le>>>1,He=d[Te];null!==He&&!ia(He)&&(_?He<=p:He<p)?L=Te+1:le=Te}return le}return x_(d,p,to,_)}function x_(d,p,_,L){var le=0,Te=null==d?0:d.length;if(0===Te)return 0;for(var He=(p=_(p))!=p,Ye=null===p,ct=ia(p),Nt=p===ee;le<Te;){var Pt=pi((le+Te)/2),zt=_(d[Pt]),en=zt!==ee,vn=null===zt,Fn=zt==zt,ci=ia(zt);if(He)var kn=L||Fn;else kn=Nt?Fn&&(L||en):Ye?Fn&&en&&(L||!vn):ct?Fn&&en&&!vn&&(L||!ci):!vn&&!ci&&(L?zt<=p:zt<p);kn?le=Pt+1:Te=Pt}return hs(Te,4294967294)}function gb(d,p){for(var _=-1,L=d.length,le=0,Te=[];++_<L;){var He=d[_],Ye=p?p(He):He;if(!_||!An(Ye,ct)){var ct=Ye;Te[le++]=0===He?0:He}}return Te}function mb(d){return"number"==typeof d?d:ia(d)?NaN:+d}function Ro(d){if("string"==typeof d)return d;if(Dn(d))return Ui(d,Ro)+"";if(ia(d))return jh?jh.call(d):"";var p=d+"";return"0"==p&&1/d==-te?"-0":p}function Mc(d,p,_){var L=-1,le=Nl,Te=d.length,He=!0,Ye=[],ct=Ye;if(_)He=!1,le=Mh;else if(Te>=200){var Nt=p?null:M_(d);if(Nt)return Jm(Nt);He=!1,le=Ih,ct=new Aa}else ct=p?[]:Ye;e:for(;++L<Te;){var Pt=d[L],zt=p?p(Pt):Pt;if(Pt=_||0!==Pt?Pt:0,He&&zt==zt){for(var en=ct.length;en--;)if(ct[en]===zt)continue e;p&&ct.push(zt),Ye.push(Pt)}else le(ct,zt,_)||(ct!==Ye&&ct.push(zt),Ye.push(Pt))}return Ye}function Eu(d,p){return null==(d=F_(d,p=Ic(p,d)))||delete d[ei(Jo(p))]}function xp(d,p,_,L){return Sp(d,p,_(qo(d,p)),L)}function Su(d,p,_,L){for(var le=d.length,Te=L?le:-1;(L?Te--:++Te<le)&&p(d[Te],Te,d););return _?Cs(d,L?0:Te,L?Te+1:le):Cs(d,L?Te+1:0,L?le:Te)}function QT(d,p){var _=d;return _ instanceof ai&&(_=_.value()),pu(p,function(L,le){return le.func.apply(le.thisArg,Br([L],le.args))},_)}function xu(d,p,_){var L=d.length;if(L<2)return L?Mc(d[0]):[];for(var le=-1,Te=Et(L);++le<L;)for(var He=d[le],Ye=-1;++Ye<L;)Ye!=le&&(Te[le]=Cc(Te[le]||He,d[Ye],p,_));return Mc(Ss(Te,1),p,_)}function Cp(d,p,_){for(var L=-1,le=d.length,Te=p.length,He={};++L<le;)_(He,d[L],L<Te?p[L]:ee);return He}function Dc(d){return br(d)?d:[]}function C_(d){return"function"==typeof d?d:to}function Ic(d,p){return Dn(d)?d:Zo(d,p)?[d]:Pb(ki(d))}var ZT=li;function il(d,p,_){var L=d.length;return _=_===ee?L:_,!p&&_>=L?d:Cs(d,p,_)}var JT=rb||function(d){return Li.clearTimeout(d)};function Tp(d,p){if(p)return d.slice();var _=d.length,L=ib?ib(_):new d.constructor(_);return d.copy(L),L}function Cu(d){var p=new d.constructor(d.byteLength);return new xd(p).set(new xd(d)),p}function T_(d,p){var _=p?Cu(d.buffer):d.buffer;return new d.constructor(_,d.byteOffset,d.length)}function Oc(d,p){if(d!==p){var _=d!==ee,L=null===d,le=d==d,Te=ia(d),He=p!==ee,Ye=null===p,ct=p==p,Nt=ia(p);if(!Ye&&!Nt&&!Te&&d>p||Te&&He&&ct&&!Ye&&!Nt||L&&He&&ct||!_&&ct||!le)return 1;if(!L&&!Te&&!Nt&&d<p||Nt&&_&&le&&!L&&!Te||Ye&&_&&le||!He&&le||!ct)return-1}return 0}function Ld(d,p,_,L){for(var le=-1,Te=d.length,He=_.length,Ye=-1,ct=p.length,Nt=Vr(Te-He,0),Pt=Et(ct+Nt),zt=!L;++Ye<ct;)Pt[Ye]=p[Ye];for(;++le<He;)(zt||le<Te)&&(Pt[_[le]]=d[le]);for(;Nt--;)Pt[Ye++]=d[le++];return Pt}function _b(d,p,_,L){for(var le=-1,Te=d.length,He=-1,Ye=_.length,ct=-1,Nt=p.length,Pt=Vr(Te-Ye,0),zt=Et(Pt+Nt),en=!L;++le<Pt;)zt[le]=d[le];for(var vn=le;++ct<Nt;)zt[vn+ct]=p[ct];for(;++He<Ye;)(en||le<Te)&&(zt[vn+_[He]]=d[le++]);return zt}function Zs(d,p){var _=-1,L=d.length;for(p||(p=Et(L));++_<L;)p[_]=d[_];return p}function Ia(d,p,_,L){var le=!_;_||(_={});for(var Te=-1,He=p.length;++Te<He;){var Ye=p[Te],ct=L?L(_[Ye],d[Ye],Ye,_,d):ee;ct===ee&&(ct=d[Ye]),le?tl(_,Ye,ct):el(_,Ye,ct)}return _}function Xr(d,p){return function(_,L){var le=Dn(_)?kr:yp,Te=p?p():{};return le(_,d,Pn(L,2),Te)}}function kl(d){return li(function(p,_){var L=-1,le=_.length,Te=le>1?_[le-1]:ee,He=le>2?_[2]:ee;for(Te=d.length>3&&"function"==typeof Te?(le--,Te):ee,He&&Hs(_[0],_[1],He)&&(Te=le<3?ee:Te,le=1),p=Hi(p);++L<le;){var Ye=_[L];Ye&&d(p,Ye,L,Te)}return p})}function rl(d,p){return function(_,L){if(null==_)return _;if(!go(_))return d(_,L);for(var le=_.length,Te=p?le:-1,He=Hi(_);(p?Te--:++Te<le)&&!1!==L(He[Te],Te,He););return _}}function yb(d){return function(p,_,L){for(var le=-1,Te=Hi(p),He=L(p),Ye=He.length;Ye--;){var ct=He[d?Ye:++le];if(!1===_(Te[ct],ct,Te))break}return p}}function Ap(d){return function(p){var _=Oh(p=ki(p))?Qa(p):ee,L=_?_[0]:p.charAt(0),le=_?il(_,1).join(""):p.slice(1);return L[d]()+le}}function Bl(d){return function(p){return pu(wy(py(p).replace(op,"")),d,"")}}function Bd(d){return function(){var p=arguments;switch(p.length){case 0:return new d;case 1:return new d(p[0]);case 2:return new d(p[0],p[1]);case 3:return new d(p[0],p[1],p[2]);case 4:return new d(p[0],p[1],p[2],p[3]);case 5:return new d(p[0],p[1],p[2],p[3],p[4]);case 6:return new d(p[0],p[1],p[2],p[3],p[4],p[5]);case 7:return new d(p[0],p[1],p[2],p[3],p[4],p[5],p[6])}var _=yu(d.prototype),L=d.apply(_,p);return wr(L)?L:_}}function bb(d){return function(p,_,L){var le=Hi(p);if(!go(p)){var Te=Pn(_,3);p=As(p),_=function(Ye){return Te(le[Ye],Ye,le)}}var He=d(p,_,L);return He>-1?le[Te?p[He]:He]:ee}}function Au(d){return sl(function(p){var _=p.length,L=_,le=Io.prototype.thru;for(d&&p.reverse();L--;){var Te=p[L];if("function"!=typeof Te)throw new xa(xe);if(le&&!He&&"wrapper"==Np(Te))var He=new Io([],!0)}for(L=He?L:_;++L<_;){var Ye=Np(Te=p[L]),ct="wrapper"==Ye?I_(Te):ee;He=ct&&Pp(ct[0])&&424==ct[1]&&!ct[4].length&&1==ct[9]?He[Np(ct[0])].apply(He,ct[3]):1==Te.length&&Pp(Te)?He[Ye]():He.thru(Te)}return function(){var Nt=arguments,Pt=Nt[0];if(He&&1==Nt.length&&Dn(Pt))return He.plant(Pt).value();for(var zt=0,en=_?p[zt].apply(this,Nt):Pt;++zt<_;)en=p[zt].call(this,en);return en}})}function Rc(d,p,_,L,le,Te,He,Ye,ct,Nt){var Pt=p&K,zt=1&p,en=2&p,vn=24&p,Fn=512&p,ci=en?ee:Bd(d);return function kn(){for(var ui=arguments.length,wi=Et(ui),_o=ui;_o--;)wi[_o]=arguments[_o];if(vn)var Gs=jd(kn),ra=BF(wi,Gs);if(L&&(wi=Ld(wi,L,le,vn)),Te&&(wi=_b(wi,Te,He,vn)),ui-=ra,vn&&ui<Nt){var Bi=gu(wi,Gs);return Sb(d,p,Rc,kn.placeholder,_,wi,Bi,Ye,ct,Nt-ui)}var hl=zt?_:this,kc=en?hl[d]:d;return ui=wi.length,Ye?wi=h1(wi,Ye):Fn&&ui>1&&wi.reverse(),Pt&&ct<ui&&(wi.length=ct),this&&this!==Li&&this instanceof kn&&(kc=ci||Bd(kc)),kc.apply(hl,wi)}}function wb(d,p){return function(_,L){return function(d,p,_,L){return nl(d,function(le,Te,He){p(L,_(le),Te,He)}),L}(_,d,p(L),{})}}function A_(d,p){return function(_,L){var le;if(_===ee&&L===ee)return p;if(_!==ee&&(le=_),L!==ee){if(le===ee)return L;"string"==typeof _||"string"==typeof L?(_=Ro(_),L=Ro(L)):(_=mb(_),L=mb(L)),le=d(_,L)}return le}}function Mp(d){return sl(function(p){return p=Ui(p,Wo(Pn())),li(function(_){var L=this;return d(p,function(le){return ns(le,L,_)})})})}function Dp(d,p){var _=(p=p===ee?" ":Ro(p)).length;if(_<2)return _?Ep(p,d):p;var L=Ep(p,Vt(d/Rh(p)));return Oh(p)?il(Qa(L),0,d).join(""):L.slice(0,d)}function Eb(d){return function(p,_,L){return L&&"number"!=typeof L&&Hs(p,_,L)&&(_=L=ee),p=ul(p),_===ee?(_=p,p=0):_=ul(_),function(d,p,_,L){for(var le=-1,Te=Vr(Vt((p-d)/(_||1)),0),He=Et(Te);Te--;)He[L?Te:++le]=d,d+=_;return He}(p,_,L=L===ee?p<_?1:-1:ul(L),d)}}function Ip(d){return function(p,_){return"string"==typeof p&&"string"==typeof _||(p=mo(p),_=mo(_)),d(p,_)}}function Sb(d,p,_,L,le,Te,He,Ye,ct,Nt){var Pt=8&p;p|=Pt?z:64,4&(p&=~(Pt?64:z))||(p&=-4);var ci=[d,p,le,Pt?Te:ee,Pt?He:ee,Pt?ee:Te,Pt?ee:He,Ye,ct,Nt],kn=_.apply(ee,ci);return Pp(d)&&Nb(kn,ci),kn.placeholder=L,Zh(kn,d,p)}function Vd(d){var p=Kr[d];return function(_,L){if(_=mo(_),(L=null==L?0:hs(Qn(L),292))&&o_(_)){var le=(ki(_)+"e").split("e");return+((le=(ki(p(le[0]+"e"+(+le[1]+L)))+"e").split("e"))[0]+"e"+(+le[1]-L))}return p(_)}}var M_=Ta&&1/Jm(new Ta([,-0]))[1]==te?function(d){return new Ta(d)}:Ty;function Mu(d){return function(p){var _=zs(p);return _==Fe?eb(p):_==pt?function(at){var It=-1,Et=Array(at.size);return at.forEach(function(cn){Et[++It]=[cn,cn]}),Et}(p):function(at,It){return Ui(It,function(Et){return[Et,at[Et]]})}(p,d(p))}}function Vl(d,p,_,L,le,Te,He,Ye){var ct=2&p;if(!ct&&"function"!=typeof d)throw new xa(xe);var Nt=L?L.length:0;if(Nt||(p&=-97,L=le=ee),He=He===ee?He:Vr(Qn(He),0),Ye=Ye===ee?Ye:Qn(Ye),Nt-=le?le.length:0,64&p){var Pt=L,zt=le;L=le=ee}var en=ct?ee:I_(d),vn=[d,p,_,L,le,Pt,zt,Te,He,Ye];if(en&&function(d,p){var _=d[1],L=p[1],le=_|L;if(!(le<131||(L==K&&8==_||L==K&&256==_&&d[7].length<=p[8]||384==L&&p[7].length<=p[8]&&8==_)))return d;1&L&&(d[2]=p[2],le|=1&_?0:4);var Ye=p[3];if(Ye){var ct=d[3];d[3]=ct?Ld(ct,Ye,p[4]):Ye,d[4]=ct?gu(d[3],F):p[4]}(Ye=p[5])&&(d[5]=(ct=d[5])?_b(ct,Ye,p[6]):Ye,d[6]=ct?gu(d[5],F):p[6]),(Ye=p[7])&&(d[7]=Ye),L&K&&(d[8]=null==d[8]?p[8]:hs(d[8],p[8])),null==d[9]&&(d[9]=p[9]),d[0]=p[0],d[1]=le}(vn,en),d=vn[0],p=vn[1],_=vn[2],L=vn[3],le=vn[4],!(Ye=vn[9]=vn[9]===ee?ct?0:d.length:Vr(vn[9]-Nt,0))&&24&p&&(p&=-25),p&&1!=p)Fn=8==p||16==p?function(d,p,_){var L=Bd(d);return function le(){for(var Te=arguments.length,He=Et(Te),Ye=Te,ct=jd(le);Ye--;)He[Ye]=arguments[Ye];var Nt=Te<3&&He[0]!==ct&&He[Te-1]!==ct?[]:gu(He,ct);return(Te-=Nt.length)<_?Sb(d,p,Rc,le.placeholder,ee,He,Nt,ee,ee,_-Te):ns(this&&this!==Li&&this instanceof le?L:d,this,He)}}(d,p,Ye):p!=z&&33!=p||le.length?Rc.apply(ee,vn):function(d,p,_,L){var le=1&p,Te=Bd(d);return function He(){for(var Ye=-1,ct=arguments.length,Nt=-1,Pt=L.length,zt=Et(Pt+ct),en=this&&this!==Li&&this instanceof He?Te:d;++Nt<Pt;)zt[Nt]=L[Nt];for(;ct--;)zt[Nt++]=arguments[++Ye];return ns(en,le?_:this,zt)}}(d,p,_,L);else var Fn=function(d,p,_){var L=1&p,le=Bd(d);return function Te(){return(this&&this!==Li&&this instanceof Te?le:d).apply(L?_:this,arguments)}}(d,p,_);return Zh((en?E_:Nb)(Fn,vn),d,p)}function xb(d,p,_,L){return d===ee||An(d,mu[_])&&!Gi.call(L,_)?p:d}function n1(d,p,_,L,le,Te){return wr(d)&&wr(p)&&(Te.set(p,d),w_(d,p,ee,n1,Te),Te.delete(p)),d}function Op(d){return qp(d)?ee:d}function Rp(d,p,_,L,le,Te){var He=1&_,Ye=d.length,ct=p.length;if(Ye!=ct&&!(He&&ct>Ye))return!1;var Nt=Te.get(d),Pt=Te.get(p);if(Nt&&Pt)return Nt==p&&Pt==d;var zt=-1,en=!0,vn=2&_?new Aa:ee;for(Te.set(d,p),Te.set(p,d);++zt<Ye;){var Fn=d[zt],ci=p[zt];if(L)var kn=He?L(ci,Fn,zt,p,d,Te):L(Fn,ci,zt,d,p,Te);if(kn!==ee){if(kn)continue;en=!1;break}if(vn){if(!Mo(p,function(ui,wi){if(!Ih(vn,wi)&&(Fn===ui||le(Fn,ui,_,L,Te)))return vn.push(wi)})){en=!1;break}}else if(Fn!==ci&&!le(Fn,ci,_,L,Te)){en=!1;break}}return Te.delete(d),Te.delete(p),en}function sl(d){return Lp(d1(d,ee,Ts),d+"")}function jl(d){return $i(d,As,O_)}function D_(d){return $i(d,eo,Ab)}var I_=Vh?function(d){return Vh.get(d)}:Ty;function Np(d){for(var p=d.name+"",_=Cd[p],L=Gi.call(Cd,p)?_.length:0;L--;){var le=_[L],Te=le.func;if(null==Te||Te==d)return le.name}return p}function jd(d){return(Gi.call(Se,"placeholder")?Se:d).placeholder}function Pn(){var d=Se.iteratee||Ou;return d=d===Ou?WT:d,arguments.length?d(arguments[0],arguments[1]):d}function Us(d,p){var _=d.__data__;return function(d){var p=typeof d;return"string"==p||"number"==p||"symbol"==p||"boolean"==p?"__proto__"!==d:null===d}(p)?_["string"==typeof p?"string":"hash"]:_.map}function Qo(d){for(var p=As(d),_=p.length;_--;){var L=p[_],le=d[L];p[_]=[L,le,c1(le)]}return p}function Nc(d,p){var _=function(at,It){return null==at?ee:at[It]}(d,p);return b_(_)?_:ee}var O_=Mr?function(d){return null==d?[]:(d=Hi(d),Ea(Mr(d),function(p){return cp.call(d,p)}))}:Lc,Ab=Mr?function(d){for(var p=[];d;)Br(p,O_(d)),d=Ca(d);return p}:Lc,zs=xs;function Db(d,p,_){for(var L=-1,le=(p=Ic(p,d)).length,Te=!1;++L<le;){var He=ei(p[L]);if(!(Te=null!=d&&_(d,He)))break;d=d[He]}return Te||++L!=le?Te:!!(le=null==d?0:d.length)&&sy(le)&&No(He,le)&&(Dn(d)||ll(d))}function Ib(d){return"function"!=typeof d.constructor||Fp(d)?{}:yu(Ca(d))}function l1(d){return Dn(d)||ll(d)||!!(TT&&d&&d[TT])}function No(d,p){var _=typeof d;return!!(p=null==p?Ce:p)&&("number"==_||"symbol"!=_&&ji.test(d))&&d>-1&&d%1==0&&d<p}function Hs(d,p,_){if(!wr(_))return!1;var L=typeof p;return!!("number"==L?go(_)&&No(p,_.length):"string"==L&&p in _)&&An(_[p],d)}function Zo(d,p){if(Dn(d))return!1;var _=typeof d;return!("number"!=_&&"symbol"!=_&&"boolean"!=_&&null!=d&&!ia(d))||ge.test(d)||!ht.test(d)||null!=p&&d in Hi(p)}function Pp(d){var p=Np(d),_=Se[p];if("function"!=typeof _||!(p in ai.prototype))return!1;if(d===_)return!0;var L=I_(_);return!!L&&d===L[0]}(Es&&zs(new Es(new ArrayBuffer(1)))!=St||fo&&zs(new fo)!=Fe||hp&&zs(hp.resolve())!=de||Ta&&zs(new Ta)!=pt||Do&&zs(new Do)!=V)&&(zs=function(d){var p=xs(d),_=p==pe?d.constructor:ee,L=_?Du(_):"";if(L)switch(L){case IT:return St;case a_:return Fe;case l_:return de;case sb:return pt;case c_:return V}return p});var Rb=lp?na:My;function Fp(d){var p=d&&d.constructor;return d===("function"==typeof p&&p.prototype||mu)}function c1(d){return d==d&&!wr(d)}function u1(d,p){return function(_){return null!=_&&_[d]===p&&(p!==ee||d in Hi(_))}}function d1(d,p,_){return p=Vr(p===ee?d.length-1:p,0),function(){for(var L=arguments,le=-1,Te=Vr(L.length-p,0),He=Et(Te);++le<Te;)He[le]=L[p+le];le=-1;for(var Ye=Et(p+1);++le<p;)Ye[le]=L[le];return Ye[p]=_(He),ns(d,this,Ye)}}function F_(d,p){return p.length<2?d:qo(d,Cs(p,0,-1))}function h1(d,p){for(var _=d.length,L=hs(p.length,_),le=Zs(d);L--;){var Te=p[L];d[L]=No(Te,_)?le[Te]:ee}return d}function L_(d,p){if(("constructor"!==p||"function"!=typeof d[p])&&"__proto__"!=p)return d[p]}var Nb=k_(E_),Qh=MT||function(d,p){return Li.setTimeout(d,p)},Lp=k_(Oo);function Zh(d,p,_){var L=p+"";return Lp(d,function(d,p){var _=p.length;if(!_)return d;var L=_-1;return p[L]=(_>1?"& ":"")+p[L],p=p.join(_>2?", ":" "),d.replace(Mt,"{\n/* [wrapped with "+p+"] */\n")}(L,function(d,p){return Bs(st,function(_){var L="_."+_[0];p&_[1]&&!Nl(d,L)&&d.push(L)}),d.sort()}(function(d){var p=d.match(Dt);return p?p[1].split(Xt):[]}(L),_)))}function k_(d){var p=0,_=0;return function(){var L=YF(),le=16-(L-_);if(_=L,le>0){if(++p>=800)return arguments[0]}else p=0;return d.apply(ee,arguments)}}function Ud(d,p){var _=-1,L=d.length,le=L-1;for(p=p===ee?L:p;++_<p;){var Te=Ll(_,le),He=d[Te];d[Te]=d[_],d[_]=He}return d.length=p,d}var p,_,Pb=(p=rf(function(d){var p=[];return 46===d.charCodeAt(0)&&p.push(""),d.replace(be,function(_,L,le,Te){p.push(le?Te.replace(On,"$1"):L||_)}),p},function(L){return 500===_.size&&_.clear(),L}),_=p.cache,p);function ei(d){if("string"==typeof d||ia(d))return d;var p=d+"";return"0"==p&&1/d==-te?"-0":p}function Du(d){if(null!=d){try{return vr.call(d)}catch(p){}try{return d+""}catch(p){}}return""}function kp(d){if(d instanceof ai)return d.clone();var p=new Io(d.__wrapped__,d.__chain__);return p.__actions__=Zs(d.__actions__),p.__index__=d.__index__,p.__values__=d.__values__,p}var m1=li(function(d,p){return br(d)?Cc(d,Ss(p,1,br,!0)):[]}),_1=li(function(d,p){var _=Jo(p);return br(_)&&(_=ee),br(d)?Cc(d,Ss(p,1,br,!0),Pn(_,2)):[]}),y1=li(function(d,p){var _=Jo(p);return br(_)&&(_=ee),br(d)?Cc(d,Ss(p,1,br,!0),ee,_):[]});function V_(d,p,_){var L=null==d?0:d.length;if(!L)return-1;var le=null==_?0:Qn(_);return le<0&&(le=Vr(L+le,0)),bd(d,Pn(p,3),le)}function j_(d,p,_){var L=null==d?0:d.length;if(!L)return-1;var le=L-1;return _!==ee&&(le=Qn(_),le=_<0?Vr(L+le,0):hs(le,L-1)),bd(d,Pn(p,3),le,!0)}function Ts(d){return null!=d&&d.length?Ss(d,1):[]}function Lb(d){return d&&d.length?d[0]:ee}var Bb=li(function(d){var p=Ui(d,Dc);return p.length&&p[0]===d[0]?bu(p):[]}),w1=li(function(d){var p=Jo(d),_=Ui(d,Dc);return p===Jo(_)?p=ee:_.pop(),_.length&&_[0]===d[0]?bu(_,Pn(p,2)):[]}),Vb=li(function(d){var p=Jo(d),_=Ui(d,Dc);return(p="function"==typeof p?p:ee)&&_.pop(),_.length&&_[0]===d[0]?bu(_,ee,p):[]});function Jo(d){var p=null==d?0:d.length;return p?d[p-1]:ee}var z_=li(H_);function H_(d,p){return d&&d.length&&p&&p.length?Xo(d,p):d}var Ub=sl(function(d,p){var _=null==d?0:d.length,L=g_(d,p);return Yh(d,Ui(p,function(le){return No(le,_)?+le:le}).sort(Oc)),L});function G_(d){return null==d?d:dp.call(d)}var Gb=li(function(d){return Mc(Ss(d,1,br,!0))}),N1=li(function(d){var p=Jo(d);return br(p)&&(p=ee),Mc(Ss(d,1,br,!0),Pn(p,2))}),P1=li(function(d){var p=Jo(d);return p="function"==typeof p?p:ee,Mc(Ss(d,1,br,!0),ee,p)});function $b(d){if(!d||!d.length)return[];var p=0;return d=Ea(d,function(_){if(br(_))return p=Vr(_.length,p),!0}),Ed(p,function(_){return Ui(d,Xm(_))})}function L1(d,p){if(!d||!d.length)return[];var _=$b(d);return null==p?_:Ui(_,function(L){return ns(p,ee,L)})}var Wb=li(function(d,p){return br(d)?Cc(d,p):[]}),p2=li(function(d){return xu(Ea(d,br))}),Po=li(function(d){var p=Jo(d);return br(p)&&(p=ee),xu(Ea(d,br),Pn(p,2))}),$_=li(function(d){var p=Jo(d);return p="function"==typeof p?p:ee,xu(Ea(d,br),ee,p)}),W_=li($b),tf=li(function(d){var p=d.length,_=p>1?d[p-1]:ee;return _="function"==typeof _?(d.pop(),_):ee,L1(d,_)});function q_(d){var p=Se(d);return p.__chain__=!0,p}function Hd(d,p){return p(d)}var Y_=sl(function(d){var p=d.length,_=p?d[0]:0,L=this.__wrapped__,le=function(Te){return g_(Te,d)};return!(p>1||this.__actions__.length)&&L instanceof ai&&No(_)?((L=L.slice(_,+_+(p?1:0))).__actions__.push({func:Hd,args:[le],thisArg:ee}),new Io(L,this.__chain__).thru(function(Te){return p&&!Te.length&&Te.push(ee),Te})):this.thru(le)}),V1=Xr(function(d,p,_){Gi.call(d,_)?++d[_]:tl(d,_,1)}),z1=bb(V_),H1=bb(j_);function Z_(d,p){return(Dn(d)?Bs:Tc)(d,Pn(p,3))}function jp(d,p){return(Dn(d)?yd:__)(d,Pn(p,3))}var $1=Xr(function(d,p,_){Gi.call(d,_)?d[_].push(p):tl(d,_,[p])}),Zb=li(function(d,p,_){var L=-1,le="function"==typeof p,Te=go(d)?Et(d.length):[];return Tc(d,function(He){Te[++L]=le?ns(p,He,_):Da(He,p,_)}),Te}),Jb=Xr(function(d,p,_){tl(d,_,p)});function al(d,p){return(Dn(d)?Ui:qT)(d,Pn(p,3))}var tw=Xr(function(d,p,_){d[_?0:1].push(p)},function(){return[[],[]]}),zp=li(function(d,p){if(null==d)return[];var _=p.length;return _>1&&Hs(d,p[0],p[1])?p=[]:_>2&&Hs(p[0],p[1],p[2])&&(p=[p[0]]),qh(d,Ss(p,1),[])}),Iu=AT||function(){return Li.Date.now()};function Hp(d,p,_){return p=_?ee:p,Vl(d,K,ee,ee,ee,ee,p=d&&null==p?d.length:p)}function ey(d,p){var _;if("function"!=typeof p)throw new xa(xe);return d=Qn(d),function(){return--d>0&&(_=p.apply(this,arguments)),d<=1&&(p=ee),_}}var nf=li(function(d,p,_){var L=1;if(_.length){var le=gu(_,jd(nf));L|=z}return Vl(d,L,p,_,le)}),$d=li(function(d,p,_){var L=3;if(_.length){var le=gu(_,jd($d));L|=z}return Vl(p,L,d,_,le)});function lw(d,p,_){var L,le,Te,He,Ye,ct,Nt=0,Pt=!1,zt=!1,en=!0;if("function"!=typeof d)throw new xa(xe);function vn(Bi){var hl=L,kc=le;return L=le=ee,Nt=Bi,He=d.apply(kc,hl)}function Fn(Bi){return Nt=Bi,Ye=Qh(ui,p),Pt?vn(Bi):He}function kn(Bi){var hl=Bi-ct;return ct===ee||hl>=p||hl<0||zt&&Bi-Nt>=Te}function ui(){var Bi=Iu();if(kn(Bi))return wi(Bi);Ye=Qh(ui,function(Bi){var JA=p-(Bi-ct);return zt?hs(JA,Te-(Bi-Nt)):JA}(Bi))}function wi(Bi){return Ye=ee,en&&L?vn(Bi):(L=le=ee,He)}function ra(){var Bi=Iu(),hl=kn(Bi);if(L=arguments,le=this,ct=Bi,hl){if(Ye===ee)return Fn(ct);if(zt)return JT(Ye),Ye=Qh(ui,p),vn(ct)}return Ye===ee&&(Ye=Qh(ui,p)),He}return p=mo(p)||0,wr(_)&&(Pt=!!_.leading,Te=(zt="maxWait"in _)?Vr(mo(_.maxWait)||0,p):Te,en="trailing"in _?!!_.trailing:en),ra.cancel=function(){Ye!==ee&&JT(Ye),Nt=0,L=ct=le=Ye=ee},ra.flush=function(){return Ye===ee?He:wi(Iu())},ra}var K1=li(function(d,p){return Gh(d,1,p)}),cw=li(function(d,p,_){return Gh(d,mo(p)||0,_)});function rf(d,p){if("function"!=typeof d||null!=p&&"function"!=typeof p)throw new xa(xe);var _=function(){var L=arguments,le=p?p.apply(this,L):L[0],Te=_.cache;if(Te.has(le))return Te.get(le);var He=d.apply(this,L);return _.cache=Te.set(le,He)||Te,He};return _.cache=new(rf.Cache||Ja),_}function iy(d){if("function"!=typeof d)throw new xa(xe);return function(){var p=arguments;switch(p.length){case 0:return!d.call(this);case 1:return!d.call(this,p[0]);case 2:return!d.call(this,p[0],p[1]);case 3:return!d.call(this,p[0],p[1],p[2])}return!d.apply(this,p)}}rf.Cache=Ja;var X1=ZT(function(d,p){var _=(p=1==p.length&&Dn(p[0])?Ui(p[0],Wo(Pn())):Ui(Ss(p,1),Wo(Pn()))).length;return li(function(L){for(var le=-1,Te=hs(L.length,_);++le<Te;)L[le]=p[le].call(this,L[le]);return ns(d,this,L)})}),Gp=li(function(d,p){var _=gu(p,jd(Gp));return Vl(d,z,ee,p,_)}),dw=li(function(d,p){var _=gu(p,jd(dw));return Vl(d,64,ee,p,_)}),Q1=sl(function(d,p){return Vl(d,256,ee,ee,ee,p)});function An(d,p){return d===p||d!=d&&p!=p}var Qt=Ip(Yo),pw=Ip(function(d,p){return d>=p}),ll=HT(function(){return arguments}())?HT:function(d){return Er(d)&&Gi.call(d,"callee")&&!cp.call(d,"callee")},Dn=Et.isArray,gw=rn?Wo(rn):function(d){return Er(d)&&xs(d)==Ze};function go(d){return null!=d&&sy(d.length)&&!na(d)}function br(d){return Er(d)&&go(d)}var cl=is||My,mw=oi?Wo(oi):function(d){return Er(d)&&xs(d)==ke};function Ra(d){if(!Er(d))return!1;var p=xs(d);return p==Ae||"[object DOMException]"==p||"string"==typeof d.message&&"string"==typeof d.name&&!qp(d)}function na(d){if(!wr(d))return!1;var p=xs(d);return p==Ue||p==qe||"[object AsyncFunction]"==p||"[object Proxy]"==p}function Wp(d){return"number"==typeof d&&d==Qn(d)}function sy(d){return"number"==typeof d&&d>-1&&d%1==0&&d<=Ce}function wr(d){var p=typeof d;return null!=d&&("object"==p||"function"==p)}function Er(d){return null!=d&&"object"==typeof d}var oA=or?Wo(or):function(d){return Er(d)&&zs(d)==Fe};function cA(d){return"number"==typeof d||Er(d)&&xs(d)==q}function qp(d){if(!Er(d)||xs(d)!=pe)return!1;var p=Ca(d);if(null===p)return!0;var _=Gi.call(p,"constructor")&&p.constructor;return"function"==typeof _&&_ instanceof _&&vr.call(_)==CT}var bw=ho?Wo(ho):function(d){return Er(d)&&xs(d)==_t},uA=wc?Wo(wc):function(d){return Er(d)&&zs(d)==pt};function ay(d){return"string"==typeof d||!Dn(d)&&Er(d)&&xs(d)==we}function ia(d){return"symbol"==typeof d||Er(d)&&xs(d)==B}var sf=ts?Wo(ts):function(d){return Er(d)&&sy(d.length)&&!!_n[xs(d)]},Pc=Ip(fb),ly=Ip(function(d,p){return d<=p});function ww(d){if(!d)return[];if(go(d))return ay(d)?Qa(d):Zs(d);if(Fh&&d[Fh])return function(at){for(var It,Et=[];!(It=at.next()).done;)Et.push(It.value);return Et}(d[Fh]());var p=zs(d);return(p==Fe?eb:p==pt?Jm:Xd)(d)}function ul(d){return d?(d=mo(d))===te||d===-te?17976931348623157e292*(d<0?-1:1):d==d?d:0:0===d?d:0}function Qn(d){var p=ul(d),_=p%1;return p==p?_?p-_:p:0}function cy(d){return d?vu(Qn(d),0,ye):0}function mo(d){if("number"==typeof d)return d;if(ia(d))return NaN;if(wr(d)){var p="function"==typeof d.valueOf?d.valueOf():d;d=wr(p)?p+"":p}if("string"!=typeof d)return 0===d?d:+d;d=Jv(d);var _=tr.test(d);return _||Yn.test(d)?Zv(d.slice(2),_?2:8):Sn.test(d)?NaN:+d}function Ew(d){return Ia(d,eo(d))}function ki(d){return null==d?"":Ro(d)}var dA=kl(function(d,p){if(Fp(p)||go(p))Ia(p,As(p),d);else for(var _ in p)Gi.call(p,_)&&el(d,_,p[_])}),hA=kl(function(d,p){Ia(p,eo(p),d)}),Wd=kl(function(d,p,_,L){Ia(p,eo(p),d,L)}),fA=kl(function(d,p,_,L){Ia(p,As(p),d,L)}),Sw=sl(g_),gA=li(function(d,p){d=Hi(d);var _=-1,L=p.length,le=L>2?p[2]:ee;for(le&&Hs(p[0],p[1],le)&&(L=1);++_<L;)for(var Te=p[_],He=eo(Te),Ye=-1,ct=He.length;++Ye<ct;){var Nt=He[Ye],Pt=d[Nt];(Pt===ee||An(Pt,mu[Nt])&&!Gi.call(d,Nt))&&(d[Nt]=Te[Nt])}return d}),of=li(function(d){return d.push(ee,n1),ns(Dw,ee,d)});function lf(d,p,_){var L=null==d?ee:qo(d,p);return L===ee?_:L}function Yp(d,p){return null!=d&&Db(d,p,Rd)}var Kp=wb(function(d,p,_){null!=p&&"function"!=typeof p.toString&&(p=Xs.call(p)),d[p]=_},Sy(to)),_A=wb(function(d,p,_){null!=p&&"function"!=typeof p.toString&&(p=Xs.call(p)),Gi.call(d,p)?d[p].push(_):d[p]=[_]},Pn),Tw=li(Da);function As(d){return go(d)?Hh(d):hb(d)}function eo(d){return go(d)?Hh(d,!0):function(d){if(!wr(d))return function(d){var p=[];if(null!=d)for(var _ in Hi(d))p.push(_);return p}(d);var p=Fp(d),_=[];for(var L in d)"constructor"==L&&(p||!Gi.call(d,L))||_.push(L);return _}(d)}var Mw=kl(function(d,p,_){w_(d,p,_)}),Dw=kl(function(d,p,_,L){w_(d,p,_,L)}),vA=sl(function(d,p){var _={};if(null==d)return _;var L=!1;p=Ui(p,function(Te){return Te=Ic(Te,d),L||(L=Te.length>1),Te}),Ia(d,D_(d),_),L&&(_=js(_,7,Op));for(var le=p.length;le--;)Eu(_,p[le]);return _}),bA=sl(function(d,p){return null==d?{}:function(d,p){return pb(d,p,function(_,L){return Yp(d,L)})}(d,p)});function Iw(d,p){if(null==d)return{};var _=Ui(D_(d),function(L){return[L]});return p=Pn(p),pb(d,_,function(L,le){return p(L,le[0])})}var wA=Mu(As),Rw=Mu(eo);function Xd(d){return null==d?[]:Zm(d,As(d))}var TA=Bl(function(d,p,_){return p=p.toLowerCase(),d+(_?fy(p):p)});function fy(d){return Qp(ki(d).toLowerCase())}function py(d){return(d=ki(d))&&d.replace(va,VF).replace(Ym,"")}var MA=Bl(function(d,p,_){return d+(_?"-":"")+p.toLowerCase()}),DA=Bl(function(d,p,_){return d+(_?" ":"")+p.toLowerCase()}),C2=Ap("toLowerCase"),PA=Bl(function(d,p,_){return d+(_?"_":"")+p.toLowerCase()}),_y=Bl(function(d,p,_){return d+(_?" ":"")+Qp(p)}),Bw=Bl(function(d,p,_){return d+(_?" ":"")+p.toUpperCase()}),Qp=Ap("toUpperCase");function wy(d,p,_){return d=ki(d),(p=_?ee:p)===ee?function(at){return Ol.test(at)}(d)?function(at){return at.match(Yv)||[]}(d):function(at){return at.match(Un)||[]}(d):d.match(p)||[]}var Ey=li(function(d,p){try{return ns(d,ee,p)}catch(_){return Ra(_)?_:new Tn(_)}}),Vw=sl(function(d,p){return Bs(p,function(_){_=ei(_),tl(d,_,nf(d[_],d))}),d});function Sy(d){return function(){return d}}var A2=Au(),Qd=Au(!0);function to(d){return d}function Ou(d){return WT("function"==typeof d?d:js(d,1))}var xy=li(function(d,p){return function(_){return Da(_,d,p)}}),jw=li(function(d,p){return function(_){return Da(d,_,p)}});function Cy(d,p,_){var L=As(p),le=Wh(p,L);null==_&&(!wr(p)||!le.length&&L.length)&&(_=p,p=d,d=this,le=Wh(p,As(p)));var Te=!(wr(_)&&"chain"in _&&!_.chain),He=na(d);return Bs(le,function(Ye){var ct=p[Ye];d[Ye]=ct,He&&(d.prototype[Ye]=function(){var Nt=this.__chain__;if(Te||Nt){var Pt=d(this.__wrapped__),zt=Pt.__actions__=Zs(this.__actions__);return zt.push({func:ct,args:arguments,thisArg:d}),Pt.__chain__=Nt,Pt}return ct.apply(d,Br([this.value()],arguments))})}),d}function Ty(){}var UA=Mp(Ui),zA=Mp(Jn),zw=Mp(Mo);function Ru(d){return Zo(d)?Xm(ei(d)):function(d){return function(p){return qo(p,d)}}(d)}var HA=Eb(),GA=Eb(!0);function Lc(){return[]}function My(){return!1}var zn=A_(function(d,p){return d+p},0),Dy=Vd("ceil"),D2=A_(function(d,p){return d/p},1),Hl=Vd("floor"),Ww=A_(function(d,p){return d*p},1),qw=Vd("round"),Yw=A_(function(d,p){return d-p},0);return Se.after=function(d,p){if("function"!=typeof p)throw new xa(xe);return d=Qn(d),function(){if(--d<1)return p.apply(this,arguments)}},Se.ary=Hp,Se.assign=dA,Se.assignIn=hA,Se.assignInWith=Wd,Se.assignWith=fA,Se.at=Sw,Se.before=ey,Se.bind=nf,Se.bindAll=Vw,Se.bindKey=$d,Se.castArray=function(){if(!arguments.length)return[];var d=arguments[0];return Dn(d)?d:[d]},Se.chain=q_,Se.chunk=function(d,p,_){p=(_?Hs(d,p,_):p===ee)?1:Vr(Qn(p),0);var L=null==d?0:d.length;if(!L||p<1)return[];for(var le=0,Te=0,He=Et(Vt(L/p));le<L;)He[Te++]=Cs(d,le,le+=p);return He},Se.compact=function(d){for(var p=-1,_=null==d?0:d.length,L=0,le=[];++p<_;){var Te=d[p];Te&&(le[L++]=Te)}return le},Se.concat=function(){var d=arguments.length;if(!d)return[];for(var p=Et(d-1),_=arguments[0],L=d;L--;)p[L-1]=arguments[L];return Br(Dn(_)?Zs(_):[_],Ss(p,1))},Se.cond=function(d){var p=null==d?0:d.length,_=Pn();return d=p?Ui(d,function(L){if("function"!=typeof L[1])throw new xa(xe);return[_(L[0]),L[1]]}):[],li(function(L){for(var le=-1;++le<p;){var Te=d[le];if(ns(Te[0],this,L))return ns(Te[1],this,L)}})},Se.conforms=function(d){return function(d){var p=As(d);return function(_){return vp(_,d,p)}}(js(d,1))},Se.constant=Sy,Se.countBy=V1,Se.create=function(d,p){var _=yu(d);return null==p?_:zT(_,p)},Se.curry=function aw(d,p,_){var L=Vl(d,8,ee,ee,ee,ee,ee,p=_?ee:p);return L.placeholder=aw.placeholder,L},Se.curryRight=function ty(d,p,_){var L=Vl(d,16,ee,ee,ee,ee,ee,p=_?ee:p);return L.placeholder=ty.placeholder,L},Se.debounce=lw,Se.defaults=gA,Se.defaultsDeep=of,Se.defer=K1,Se.delay=cw,Se.difference=m1,Se.differenceBy=_1,Se.differenceWith=y1,Se.drop=function(d,p,_){var L=null==d?0:d.length;return L?Cs(d,(p=_||p===ee?1:Qn(p))<0?0:p,L):[]},Se.dropRight=function(d,p,_){var L=null==d?0:d.length;return L?Cs(d,0,(p=L-(p=_||p===ee?1:Qn(p)))<0?0:p):[]},Se.dropRightWhile=function(d,p){return d&&d.length?Su(d,Pn(p,3),!0,!0):[]},Se.dropWhile=function(d,p){return d&&d.length?Su(d,Pn(p,3),!0):[]},Se.fill=function(d,p,_,L){var le=null==d?0:d.length;return le?(_&&"number"!=typeof _&&Hs(d,p,_)&&(_=0,L=le),function(d,p,_,L){var le=d.length;for((_=Qn(_))<0&&(_=-_>le?0:le+_),(L=L===ee||L>le?le:Qn(L))<0&&(L+=le),L=_>L?0:cy(L);_<L;)d[_++]=p;return d}(d,p,_,L)):[]},Se.filter=function(d,p){return(Dn(d)?Ea:db)(d,Pn(p,3))},Se.flatMap=function(d,p){return Ss(al(d,p),1)},Se.flatMapDeep=function(d,p){return Ss(al(d,p),te)},Se.flatMapDepth=function(d,p,_){return _=_===ee?1:Qn(_),Ss(al(d,p),_)},Se.flatten=Ts,Se.flattenDeep=function(d){return null!=d&&d.length?Ss(d,te):[]},Se.flattenDepth=function(d,p){return null!=d&&d.length?Ss(d,p=p===ee?1:Qn(p)):[]},Se.flip=function(d){return Vl(d,512)},Se.flow=A2,Se.flowRight=Qd,Se.fromPairs=function(d){for(var p=-1,_=null==d?0:d.length,L={};++p<_;){var le=d[p];L[le[0]]=le[1]}return L},Se.functions=function(d){return null==d?[]:Wh(d,As(d))},Se.functionsIn=function(d){return null==d?[]:Wh(d,eo(d))},Se.groupBy=$1,Se.initial=function(d){return null!=d&&d.length?Cs(d,0,-1):[]},Se.intersection=Bb,Se.intersectionBy=w1,Se.intersectionWith=Vb,Se.invert=Kp,Se.invertBy=_A,Se.invokeMap=Zb,Se.iteratee=Ou,Se.keyBy=Jb,Se.keys=As,Se.keysIn=eo,Se.map=al,Se.mapKeys=function(d,p){var _={};return p=Pn(p,3),nl(d,function(L,le,Te){tl(_,p(L,le,Te),L)}),_},Se.mapValues=function(d,p){var _={};return p=Pn(p,3),nl(d,function(L,le,Te){tl(_,le,p(L,le,Te))}),_},Se.matches=function(d){return KT(js(d,1))},Se.matchesProperty=function(d,p){return Pd(d,js(p,1))},Se.memoize=rf,Se.merge=Mw,Se.mergeWith=Dw,Se.method=xy,Se.methodOf=jw,Se.mixin=Cy,Se.negate=iy,Se.nthArg=function(d){return d=Qn(d),li(function(p){return wu(p,d)})},Se.omit=vA,Se.omitBy=function(d,p){return Iw(d,iy(Pn(p)))},Se.once=function(d){return ey(2,d)},Se.orderBy=function(d,p,_,L){return null==d?[]:(Dn(p)||(p=null==p?[]:[p]),Dn(_=L?ee:_)||(_=null==_?[]:[_]),qh(d,p,_))},Se.over=UA,Se.overArgs=X1,Se.overEvery=zA,Se.overSome=zw,Se.partial=Gp,Se.partialRight=dw,Se.partition=tw,Se.pick=bA,Se.pickBy=Iw,Se.property=Ru,Se.propertyOf=function(d){return function(p){return null==d?ee:qo(d,p)}},Se.pull=z_,Se.pullAll=H_,Se.pullAllBy=function(d,p,_){return d&&d.length&&p&&p.length?Xo(d,p,Pn(_,2)):d},Se.pullAllWith=function(d,p,_){return d&&d.length&&p&&p.length?Xo(d,p,ee,_):d},Se.pullAt=Ub,Se.range=HA,Se.rangeRight=GA,Se.rearg=Q1,Se.reject=function(d,p){return(Dn(d)?Ea:db)(d,iy(Pn(p,3)))},Se.remove=function(d,p){var _=[];if(!d||!d.length)return _;var L=-1,le=[],Te=d.length;for(p=Pn(p,3);++L<Te;){var He=d[L];p(He,L,d)&&(_.push(He),le.push(L))}return Yh(d,le),_},Se.rest=function(d,p){if("function"!=typeof d)throw new xa(xe);return li(d,p=p===ee?p:Qn(p))},Se.reverse=G_,Se.sampleSize=function(d,p,_){return p=(_?Hs(d,p,_):p===ee)?1:Qn(p),(Dn(d)?ab:r2)(d,p)},Se.set=function(d,p,_){return null==d?d:Sp(d,p,_)},Se.setWith=function(d,p,_,L){return L="function"==typeof L?L:ee,null==d?d:Sp(d,p,_,L)},Se.shuffle=function(d){return(Dn(d)?Ad:S_)(d)},Se.slice=function(d,p,_){var L=null==d?0:d.length;return L?(_&&"number"!=typeof _&&Hs(d,p,_)?(p=0,_=L):(p=null==p?0:Qn(p),_=_===ee?L:Qn(_)),Cs(d,p,_)):[]},Se.sortBy=zp,Se.sortedUniq=function(d){return d&&d.length?gb(d):[]},Se.sortedUniqBy=function(d,p){return d&&d.length?gb(d,Pn(p,2)):[]},Se.split=function(d,p,_){return _&&"number"!=typeof _&&Hs(d,p,_)&&(p=_=ee),(_=_===ee?ye:_>>>0)?(d=ki(d))&&("string"==typeof p||null!=p&&!bw(p))&&!(p=Ro(p))&&Oh(d)?il(Qa(d),0,_):d.split(p,_):[]},Se.spread=function(d,p){if("function"!=typeof d)throw new xa(xe);return p=null==p?0:Vr(Qn(p),0),li(function(_){var L=_[p],le=il(_,0,p);return L&&Br(le,L),ns(d,this,le)})},Se.tail=function(d){var p=null==d?0:d.length;return p?Cs(d,1,p):[]},Se.take=function(d,p,_){return d&&d.length?Cs(d,0,(p=_||p===ee?1:Qn(p))<0?0:p):[]},Se.takeRight=function(d,p,_){var L=null==d?0:d.length;return L?Cs(d,(p=L-(p=_||p===ee?1:Qn(p)))<0?0:p,L):[]},Se.takeRightWhile=function(d,p){return d&&d.length?Su(d,Pn(p,3),!1,!0):[]},Se.takeWhile=function(d,p){return d&&d.length?Su(d,Pn(p,3)):[]},Se.tap=function(d,p){return p(d),d},Se.throttle=function(d,p,_){var L=!0,le=!0;if("function"!=typeof d)throw new xa(xe);return wr(_)&&(L="leading"in _?!!_.leading:L,le="trailing"in _?!!_.trailing:le),lw(d,p,{leading:L,maxWait:p,trailing:le})},Se.thru=Hd,Se.toArray=ww,Se.toPairs=wA,Se.toPairsIn=Rw,Se.toPath=function(d){return Dn(d)?Ui(d,ei):ia(d)?[d]:Zs(Pb(ki(d)))},Se.toPlainObject=Ew,Se.transform=function(d,p,_){var L=Dn(d),le=L||cl(d)||sf(d);if(p=Pn(p,4),null==_){var Te=d&&d.constructor;_=le?L?new Te:[]:wr(d)&&na(Te)?yu(Ca(d)):{}}return(le?Bs:nl)(d,function(He,Ye,ct){return p(_,He,Ye,ct)}),_},Se.unary=function(d){return Hp(d,1)},Se.union=Gb,Se.unionBy=N1,Se.unionWith=P1,Se.uniq=function(d){return d&&d.length?Mc(d):[]},Se.uniqBy=function(d,p){return d&&d.length?Mc(d,Pn(p,2)):[]},Se.uniqWith=function(d,p){return p="function"==typeof p?p:ee,d&&d.length?Mc(d,ee,p):[]},Se.unset=function(d,p){return null==d||Eu(d,p)},Se.unzip=$b,Se.unzipWith=L1,Se.update=function(d,p,_){return null==d?d:xp(d,p,C_(_))},Se.updateWith=function(d,p,_,L){return L="function"==typeof L?L:ee,null==d?d:xp(d,p,C_(_),L)},Se.values=Xd,Se.valuesIn=function(d){return null==d?[]:Zm(d,eo(d))},Se.without=Wb,Se.words=wy,Se.wrap=function(d,p){return Gp(C_(p),d)},Se.xor=p2,Se.xorBy=Po,Se.xorWith=$_,Se.zip=W_,Se.zipObject=function(d,p){return Cp(d||[],p||[],el)},Se.zipObjectDeep=function(d,p){return Cp(d||[],p||[],Sp)},Se.zipWith=tf,Se.entries=wA,Se.entriesIn=Rw,Se.extend=hA,Se.extendWith=Wd,Cy(Se,Se),Se.add=zn,Se.attempt=Ey,Se.camelCase=TA,Se.capitalize=fy,Se.ceil=Dy,Se.clamp=function(d,p,_){return _===ee&&(_=p,p=ee),_!==ee&&(_=(_=mo(_))==_?_:0),p!==ee&&(p=(p=mo(p))==p?p:0),vu(mo(d),p,_)},Se.clone=function(d){return js(d,4)},Se.cloneDeep=function(d){return js(d,5)},Se.cloneDeepWith=function(d,p){return js(d,5,p="function"==typeof p?p:ee)},Se.cloneWith=function(d,p){return js(d,4,p="function"==typeof p?p:ee)},Se.conformsTo=function(d,p){return null==p||vp(d,p,As(p))},Se.deburr=py,Se.defaultTo=function(d,p){return null==d||d!=d?p:d},Se.divide=D2,Se.endsWith=function(d,p,_){d=ki(d),p=Ro(p);var L=d.length,le=_=_===ee?L:vu(Qn(_),0,L);return(_-=p.length)>=0&&d.slice(_,le)==p},Se.eq=An,Se.escape=function(d){return(d=ki(d))&&Jt.test(d)?d.replace(ya,jF):d},Se.escapeRegExp=function(d){return(d=ki(d))&&ut.test(d)?d.replace(Be,"\\$&"):d},Se.every=function(d,p,_){var L=Dn(d)?Jn:cb;return _&&Hs(d,p,_)&&(p=ee),L(d,Pn(p,3))},Se.find=z1,Se.findIndex=V_,Se.findKey=function(d,p){return Dh(d,Pn(p,3),nl)},Se.findLast=H1,Se.findLastIndex=j_,Se.findLastKey=function(d,p){return Dh(d,Pn(p,3),bp)},Se.floor=Hl,Se.forEach=Z_,Se.forEachRight=jp,Se.forIn=function(d,p){return null==d?d:Dd(d,Pn(p,3),eo)},Se.forInRight=function(d,p){return null==d?d:Id(d,Pn(p,3),eo)},Se.forOwn=function(d,p){return d&&nl(d,Pn(p,3))},Se.forOwnRight=function(d,p){return d&&bp(d,Pn(p,3))},Se.get=lf,Se.gt=Qt,Se.gte=pw,Se.has=function(d,p){return null!=d&&Db(d,p,Od)},Se.hasIn=Yp,Se.head=Lb,Se.identity=to,Se.includes=function(d,p,_,L){d=go(d)?d:Xd(d),_=_&&!L?Qn(_):0;var le=d.length;return _<0&&(_=Vr(le+_,0)),ay(d)?_<=le&&d.indexOf(p,_)>-1:!!le&&Xa(d,p,_)>-1},Se.indexOf=function(d,p,_){var L=null==d?0:d.length;if(!L)return-1;var le=null==_?0:Qn(_);return le<0&&(le=Vr(L+le,0)),Xa(d,p,le)},Se.inRange=function(d,p,_){return p=ul(p),_===ee?(_=p,p=0):_=ul(_),function(d,p,_){return d>=hs(p,_)&&d<Vr(p,_)}(d=mo(d),p,_)},Se.invoke=Tw,Se.isArguments=ll,Se.isArray=Dn,Se.isArrayBuffer=gw,Se.isArrayLike=go,Se.isArrayLikeObject=br,Se.isBoolean=function(d){return!0===d||!1===d||Er(d)&&xs(d)==ze},Se.isBuffer=cl,Se.isDate=mw,Se.isElement=function(d){return Er(d)&&1===d.nodeType&&!qp(d)},Se.isEmpty=function(d){if(null==d)return!0;if(go(d)&&(Dn(d)||"string"==typeof d||"function"==typeof d.splice||cl(d)||sf(d)||ll(d)))return!d.length;var p=zs(d);if(p==Fe||p==pt)return!d.size;if(Fp(d))return!hb(d).length;for(var _ in d)if(Gi.call(d,_))return!1;return!0},Se.isEqual=function(d,p){return wp(d,p)},Se.isEqualWith=function(d,p,_){var L=(_="function"==typeof _?_:ee)?_(d,p):ee;return L===ee?wp(d,p,ee,_):!!L},Se.isError=Ra,Se.isFinite=function(d){return"number"==typeof d&&o_(d)},Se.isFunction=na,Se.isInteger=Wp,Se.isLength=sy,Se.isMap=oA,Se.isMatch=function(d,p){return d===p||v_(d,p,Qo(p))},Se.isMatchWith=function(d,p,_){return _="function"==typeof _?_:ee,v_(d,p,Qo(p),_)},Se.isNaN=function(d){return cA(d)&&d!=+d},Se.isNative=function(d){if(Rb(d))throw new Tn("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return b_(d)},Se.isNil=function(d){return null==d},Se.isNull=function(d){return null===d},Se.isNumber=cA,Se.isObject=wr,Se.isObjectLike=Er,Se.isPlainObject=qp,Se.isRegExp=bw,Se.isSafeInteger=function(d){return Wp(d)&&d>=-Ce&&d<=Ce},Se.isSet=uA,Se.isString=ay,Se.isSymbol=ia,Se.isTypedArray=sf,Se.isUndefined=function(d){return d===ee},Se.isWeakMap=function(d){return Er(d)&&zs(d)==V},Se.isWeakSet=function(d){return Er(d)&&"[object WeakSet]"==xs(d)},Se.join=function(d,p){return null==d?"":Lh.call(d,p)},Se.kebabCase=MA,Se.last=Jo,Se.lastIndexOf=function(d,p,_){var L=null==d?0:d.length;if(!L)return-1;var le=L;return _!==ee&&(le=(le=Qn(_))<0?Vr(L+le,0):hs(le,L-1)),p==p?function(at,It,Et){for(var cn=Et+1;cn--;)if(at[cn]===It)return cn;return cn}(d,p,le):bd(d,Ec,le,!0)},Se.lowerCase=DA,Se.lowerFirst=C2,Se.lt=Pc,Se.lte=ly,Se.max=function(d){return d&&d.length?$h(d,to,Yo):ee},Se.maxBy=function(d,p){return d&&d.length?$h(d,Pn(p,2),Yo):ee},Se.mean=function(d){return ws(d,to)},Se.meanBy=function(d,p){return ws(d,Pn(p,2))},Se.min=function(d){return d&&d.length?$h(d,to,fb):ee},Se.minBy=function(d,p){return d&&d.length?$h(d,Pn(p,2),fb):ee},Se.stubArray=Lc,Se.stubFalse=My,Se.stubObject=function(){return{}},Se.stubString=function(){return""},Se.stubTrue=function(){return!0},Se.multiply=Ww,Se.nth=function(d,p){return d&&d.length?wu(d,Qn(p)):ee},Se.noConflict=function(){return Li._===this&&(Li._=r_),this},Se.noop=Ty,Se.now=Iu,Se.pad=function(d,p,_){d=ki(d);var L=(p=Qn(p))?Rh(d):0;if(!p||L>=p)return d;var le=(p-L)/2;return Dp(pi(le),_)+d+Dp(Vt(le),_)},Se.padEnd=function(d,p,_){d=ki(d);var L=(p=Qn(p))?Rh(d):0;return p&&L<p?d+Dp(p-L,_):d},Se.padStart=function(d,p,_){d=ki(d);var L=(p=Qn(p))?Rh(d):0;return p&&L<p?Dp(p-L,_)+d:d},Se.parseInt=function(d,p,_){return _||null==p?p=0:p&&(p=+p),DT(ki(d).replace(Je,""),p||0)},Se.random=function(d,p,_){if(_&&"boolean"!=typeof _&&Hs(d,p,_)&&(p=_=ee),_===ee&&("boolean"==typeof p?(_=p,p=ee):"boolean"==typeof d&&(_=d,d=ee)),d===ee&&p===ee?(d=0,p=1):(d=ul(d),p===ee?(p=d,d=0):p=ul(p)),d>p){var L=d;d=p,p=L}if(_||d%1||p%1){var le=kh();return hs(d+le*(p-d+_T("1e-"+((le+"").length-1))),p)}return Ll(d,p)},Se.reduce=function(d,p,_){var L=Dn(d)?pu:$o,le=arguments.length<3;return L(d,Pn(p,4),_,le,Tc)},Se.reduceRight=function(d,p,_){var L=Dn(d)?vd:$o,le=arguments.length<3;return L(d,Pn(p,4),_,le,__)},Se.repeat=function(d,p,_){return p=(_?Hs(d,p,_):p===ee)?1:Qn(p),Ep(ki(d),p)},Se.replace=function(){var d=arguments,p=ki(d[0]);return d.length<3?p:p.replace(d[1],d[2])},Se.result=function(d,p,_){var L=-1,le=(p=Ic(p,d)).length;for(le||(le=1,d=ee);++L<le;){var Te=null==d?ee:d[ei(p[L])];Te===ee&&(L=le,Te=_),d=na(Te)?Te.call(d):Te}return d},Se.round=qw,Se.runInContext=at,Se.sample=function(d){return(Dn(d)?f_:XT)(d)},Se.size=function(d){if(null==d)return 0;if(go(d))return ay(d)?Rh(d):d.length;var p=zs(d);return p==Fe||p==pt?d.size:hb(d).length},Se.snakeCase=PA,Se.some=function(d,p,_){var L=Dn(d)?Mo:s2;return _&&Hs(d,p,_)&&(p=ee),L(d,Pn(p,3))},Se.sortedIndex=function(d,p){return Kh(d,p)},Se.sortedIndexBy=function(d,p,_){return x_(d,p,Pn(_,2))},Se.sortedIndexOf=function(d,p){var _=null==d?0:d.length;if(_){var L=Kh(d,p);if(L<_&&An(d[L],p))return L}return-1},Se.sortedLastIndex=function(d,p){return Kh(d,p,!0)},Se.sortedLastIndexBy=function(d,p,_){return x_(d,p,Pn(_,2),!0)},Se.sortedLastIndexOf=function(d,p){if(null!=d&&d.length){var L=Kh(d,p,!0)-1;if(An(d[L],p))return L}return-1},Se.startCase=_y,Se.startsWith=function(d,p,_){return d=ki(d),_=null==_?0:vu(Qn(_),0,d.length),p=Ro(p),d.slice(_,_+p.length)==p},Se.subtract=Yw,Se.sum=function(d){return d&&d.length?wd(d,to):0},Se.sumBy=function(d,p){return d&&d.length?wd(d,Pn(p,2)):0},Se.template=function(d,p,_){var L=Se.templateSettings;_&&Hs(d,p,_)&&(p=ee),d=ki(d),p=Wd({},p,L,xb);var Ye,ct,le=Wd({},p.imports,L.imports,xb),Te=As(le),He=Zm(le,Te),Nt=0,Pt=p.interpolate||Wr,zt="__p += '",en=n_((p.escape||Wr).source+"|"+Pt.source+"|"+(Pt===lt?gn:Wr).source+"|"+(p.evaluate||Wr).source+"|$","g"),vn="//# sourceURL="+(Gi.call(p,"sourceURL")?(p.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++mT+"]")+"\n";d.replace(en,function(kn,ui,wi,_o,Gs,ra){return wi||(wi=_o),zt+=d.slice(Nt,ra).replace(re,UF),ui&&(Ye=!0,zt+="' +\n__e("+ui+") +\n'"),Gs&&(ct=!0,zt+="';\n"+Gs+";\n__p += '"),wi&&(zt+="' +\n((__t = ("+wi+")) == null ? '' : __t) +\n'"),Nt=ra+kn.length,kn}),zt+="';\n";var Fn=Gi.call(p,"variable")&&p.variable;if(Fn){if(ii.test(Fn))throw new Tn("Invalid `variable` option passed into `_.template`")}else zt="with (obj) {\n"+zt+"\n}\n";zt=(ct?zt.replace(Fs,""):zt).replace($r,"$1").replace(_a,"$1;"),zt="function("+(Fn||"obj")+") {\n"+(Fn?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(Ye?", __e = _.escape":"")+(ct?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+zt+"return __p\n}";var ci=Ey(function(){return Ni(Te,vn+"return "+zt).apply(ee,He)});if(ci.source=zt,Ra(ci))throw ci;return ci},Se.times=function(d,p){if((d=Qn(d))<1||d>Ce)return[];var _=ye,L=hs(d,ye);p=Pn(p),d-=ye;for(var le=Ed(L,p);++_<d;)p(_);return le},Se.toFinite=ul,Se.toInteger=Qn,Se.toLength=cy,Se.toLower=function(d){return ki(d).toLowerCase()},Se.toNumber=mo,Se.toSafeInteger=function(d){return d?vu(Qn(d),-Ce,Ce):0===d?d:0},Se.toString=ki,Se.toUpper=function(d){return ki(d).toUpperCase()},Se.trim=function(d,p,_){if((d=ki(d))&&(_||p===ee))return Jv(d);if(!d||!(p=Ro(p)))return d;var L=Qa(d),le=Qa(p);return il(L,bT(L,le),wT(L,le)+1).join("")},Se.trimEnd=function(d,p,_){if((d=ki(d))&&(_||p===ee))return d.slice(0,Sc(d)+1);if(!d||!(p=Ro(p)))return d;var L=Qa(d);return il(L,0,wT(L,Qa(p))+1).join("")},Se.trimStart=function(d,p,_){if((d=ki(d))&&(_||p===ee))return d.replace(Je,"");if(!d||!(p=Ro(p)))return d;var L=Qa(d);return il(L,bT(L,Qa(p))).join("")},Se.truncate=function(d,p){var _=30,L="...";if(wr(p)){var le="separator"in p?p.separator:le;_="length"in p?Qn(p.length):_,L="omission"in p?Ro(p.omission):L}var Te=(d=ki(d)).length;if(Oh(d)){var He=Qa(d);Te=He.length}if(_>=Te)return d;var Ye=_-Rh(L);if(Ye<1)return L;var ct=He?il(He,0,Ye).join(""):d.slice(0,Ye);if(le===ee)return ct+L;if(He&&(Ye+=ct.length-Ye),bw(le)){if(d.slice(Ye).search(le)){var Nt,Pt=ct;for(le.global||(le=n_(le.source,ki(Wn.exec(le))+"g")),le.lastIndex=0;Nt=le.exec(Pt);)var zt=Nt.index;ct=ct.slice(0,zt===ee?Ye:zt)}}else if(d.indexOf(Ro(le),Ye)!=Ye){var en=ct.lastIndexOf(le);en>-1&&(ct=ct.slice(0,en))}return ct+L},Se.unescape=function(d){return(d=ki(d))&&ys.test(d)?d.replace(Ml,t_):d},Se.uniqueId=function(d){var p=++qF;return ki(d)+p},Se.upperCase=Bw,Se.upperFirst=Qp,Se.each=Z_,Se.eachRight=jp,Se.first=Lb,Cy(Se,function(){var d={};return nl(Se,function(p,_){Gi.call(Se.prototype,_)||(d[_]=p)}),d}(),{chain:!1}),Se.VERSION="4.17.21",Bs(["bind","bindKey","curry","curryRight","partial","partialRight"],function(d){Se[d].placeholder=Se}),Bs(["drop","take"],function(d,p){ai.prototype[d]=function(_){_=_===ee?1:Vr(Qn(_),0);var L=this.__filtered__&&!p?new ai(this):this.clone();return L.__filtered__?L.__takeCount__=hs(_,L.__takeCount__):L.__views__.push({size:hs(_,ye),type:d+(L.__dir__<0?"Right":"")}),L},ai.prototype[d+"Right"]=function(_){return this.reverse()[d](_).reverse()}}),Bs(["filter","map","takeWhile"],function(d,p){var _=p+1,L=1==_||3==_;ai.prototype[d]=function(le){var Te=this.clone();return Te.__iteratees__.push({iteratee:Pn(le,3),type:_}),Te.__filtered__=Te.__filtered__||L,Te}}),Bs(["head","last"],function(d,p){var _="take"+(p?"Right":"");ai.prototype[d]=function(){return this[_](1).value()[0]}}),Bs(["initial","tail"],function(d,p){var _="drop"+(p?"":"Right");ai.prototype[d]=function(){return this.__filtered__?new ai(this):this[_](1)}}),ai.prototype.compact=function(){return this.filter(to)},ai.prototype.find=function(d){return this.filter(d).head()},ai.prototype.findLast=function(d){return this.reverse().find(d)},ai.prototype.invokeMap=li(function(d,p){return"function"==typeof d?new ai(this):this.map(function(_){return Da(_,d,p)})}),ai.prototype.reject=function(d){return this.filter(iy(Pn(d)))},ai.prototype.slice=function(d,p){d=Qn(d);var _=this;return _.__filtered__&&(d>0||p<0)?new ai(_):(d<0?_=_.takeRight(-d):d&&(_=_.drop(d)),p!==ee&&(_=(p=Qn(p))<0?_.dropRight(-p):_.take(p-d)),_)},ai.prototype.takeRightWhile=function(d){return this.reverse().takeWhile(d).reverse()},ai.prototype.toArray=function(){return this.take(ye)},nl(ai.prototype,function(d,p){var _=/^(?:filter|find|map|reject)|While$/.test(p),L=/^(?:head|last)$/.test(p),le=Se[L?"take"+("last"==p?"Right":""):p],Te=L||/^find/.test(p);!le||(Se.prototype[p]=function(){var He=this.__wrapped__,Ye=L?[1]:arguments,ct=He instanceof ai,Nt=Ye[0],Pt=ct||Dn(He),zt=function(ui){var wi=le.apply(Se,Br([ui],Ye));return L&&en?wi[0]:wi};Pt&&_&&"function"==typeof Nt&&1!=Nt.length&&(ct=Pt=!1);var en=this.__chain__,vn=!!this.__actions__.length,Fn=Te&&!en,ci=ct&&!vn;if(!Te&&Pt){He=ci?He:new ai(this);var kn=d.apply(He,Ye);return kn.__actions__.push({func:Hd,args:[zt],thisArg:ee}),new Io(kn,en)}return Fn&&ci?d.apply(this,Ye):(kn=this.thru(zt),Fn?L?kn.value()[0]:kn.value():kn)})}),Bs(["pop","push","shift","sort","splice","unshift"],function(d){var p=ar[d],_=/^(?:push|sort|unshift)$/.test(d)?"tap":"thru",L=/^(?:pop|shift)$/.test(d);Se.prototype[d]=function(){var le=arguments;if(L&&!this.__chain__){var Te=this.value();return p.apply(Dn(Te)?Te:[],le)}return this[_](function(He){return p.apply(Dn(He)?He:[],le)})}}),nl(ai.prototype,function(d,p){var _=Se[p];if(_){var L=_.name+"";Gi.call(Cd,L)||(Cd[L]=[]),Cd[L].push({name:p,func:_})}}),Cd[Rc(ee,2).name]=[{name:"wrapper",func:ee}],ai.prototype.clone=function(){var d=new ai(this.__wrapped__);return d.__actions__=Zs(this.__actions__),d.__dir__=this.__dir__,d.__filtered__=this.__filtered__,d.__iteratees__=Zs(this.__iteratees__),d.__takeCount__=this.__takeCount__,d.__views__=Zs(this.__views__),d},ai.prototype.reverse=function(){if(this.__filtered__){var d=new ai(this);d.__dir__=-1,d.__filtered__=!0}else(d=this.clone()).__dir__*=-1;return d},ai.prototype.value=function(){var d=this.__wrapped__.value(),p=this.__dir__,_=Dn(d),L=p<0,le=_?d.length:0,Te=function(d,p,_){for(var L=-1,le=_.length;++L<le;){var Te=_[L],He=Te.size;switch(Te.type){case"drop":d+=He;break;case"dropRight":p-=He;break;case"take":p=hs(p,d+He);break;case"takeRight":d=Vr(d,p-He)}}return{start:d,end:p}}(0,le,this.__views__),He=Te.start,Ye=Te.end,ct=Ye-He,Nt=L?Ye:He-1,Pt=this.__iteratees__,zt=Pt.length,en=0,vn=hs(ct,this.__takeCount__);if(!_||!L&&le==ct&&vn==ct)return QT(d,this.__actions__);var Fn=[];e:for(;ct--&&en<vn;){for(var ci=-1,kn=d[Nt+=p];++ci<zt;){var ui=Pt[ci],_o=ui.type,Gs=(0,ui.iteratee)(kn);if(2==_o)kn=Gs;else if(!Gs){if(1==_o)continue e;break e}}Fn[en++]=kn}return Fn},Se.prototype.at=Y_,Se.prototype.chain=function(){return q_(this)},Se.prototype.commit=function(){return new Io(this.value(),this.__chain__)},Se.prototype.next=function(){this.__values__===ee&&(this.__values__=ww(this.value()));var d=this.__index__>=this.__values__.length;return{done:d,value:d?ee:this.__values__[this.__index__++]}},Se.prototype.plant=function(d){for(var p,_=this;_ instanceof Uh;){var L=kp(_);L.__index__=0,L.__values__=ee,p?le.__wrapped__=L:p=L;var le=L;_=_.__wrapped__}return le.__wrapped__=d,p},Se.prototype.reverse=function(){var d=this.__wrapped__;if(d instanceof ai){var p=d;return this.__actions__.length&&(p=new ai(this)),(p=p.reverse()).__actions__.push({func:Hd,args:[G_],thisArg:ee}),new Io(p,this.__chain__)}return this.thru(G_)},Se.prototype.toJSON=Se.prototype.valueOf=Se.prototype.value=function(){return QT(this.__wrapped__,this.__actions__)},Se.prototype.first=Se.prototype.head,Fh&&(Se.prototype[Fh]=function(){return this}),Se}();Li._=Nh,(yt=function(){return Nh}.call(it,et,it,Ut))!==ee&&(Ut.exports=yt)}.call(this)},5478:function(Ut){Ut.exports=function(){"use strict";function it(rt,lt){for(var ht=0;ht<lt.length;ht++){var ge=lt[ht];ge.enumerable=ge.enumerable||!1,ge.configurable=!0,"value"in ge&&(ge.writable=!0),Object.defineProperty(rt,ge.key,ge)}}function ee(rt,lt){(null==lt||lt>rt.length)&&(lt=rt.length);for(var ht=0,ge=new Array(lt);ht<lt;ht++)ge[ht]=rt[ht];return ge}function At(rt,lt){var ht="undefined"!=typeof Symbol&&rt[Symbol.iterator]||rt["@@iterator"];if(ht)return(ht=ht.call(rt)).next.bind(ht);if(Array.isArray(rt)||(ht=function(rt,lt){if(rt){if("string"==typeof rt)return ee(rt,lt);var ht=Object.prototype.toString.call(rt).slice(8,-1);if("Object"===ht&&rt.constructor&&(ht=rt.constructor.name),"Map"===ht||"Set"===ht)return Array.from(rt);if("Arguments"===ht||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ht))return ee(rt,lt)}}(rt))||lt&&rt&&"number"==typeof rt.length){ht&&(rt=ht);var ge=0;return function(){return ge>=rt.length?{done:!0}:{done:!1,value:rt[ge++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var dt={exports:{}};function Y(){return{baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}dt.exports={defaults:{baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1},getDefaults:Y,changeDefaults:function(rt){dt.exports.defaults=rt}};var he=/[&<>"']/,W=/[&<>"']/g,j=/[<>"']|&(?!#?\w+;)/,F=/[<>"']|&(?!#?\w+;)/g,Q={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},H=function(lt){return Q[lt]};var C=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi;function R(rt){return rt.replace(C,function(lt,ht){return"colon"===(ht=ht.toLowerCase())?":":"#"===ht.charAt(0)?"x"===ht.charAt(1)?String.fromCharCode(parseInt(ht.substring(2),16)):String.fromCharCode(+ht.substring(1)):""})}var T=/(^|[^\[])\^/g;var y=/[^\w:]/g,x=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;var z={},N=/^[^:]+:\/*[^/]*$/,K=/^([^:]+:)[\s\S]*$/,ue=/^([^:]+:\/*[^/]*)[\s\S]*$/;function I(rt,lt){z[" "+rt]||(z[" "+rt]=N.test(rt)?rt+"/":$(rt,"/",!0));var ht=-1===(rt=z[" "+rt]).indexOf(":");return"//"===lt.substring(0,2)?ht?lt:rt.replace(K,"$1")+lt:"/"===lt.charAt(0)?ht?lt:rt.replace(ue,"$1")+lt:rt+lt}function $(rt,lt,ht){var ge=rt.length;if(0===ge)return"";for(var be=0;be<ge;){var Be=rt.charAt(ge-be-1);if(Be!==lt||ht){if(Be===lt||!ht)break;be++}else be++}return rt.substr(0,ge-be)}var te_escape=function(rt,lt){if(lt){if(he.test(rt))return rt.replace(W,H)}else if(j.test(rt))return rt.replace(F,H);return rt},te_unescape=R,te_edit=function(rt,lt){rt=rt.source||rt,lt=lt||"";var ht={replace:function(be,Be){return Be=(Be=Be.source||Be).replace(T,"$1"),rt=rt.replace(be,Be),ht},getRegex:function(){return new RegExp(rt,lt)}};return ht},te_cleanUrl=function(rt,lt,ht){if(rt){var ge;try{ge=decodeURIComponent(R(ht)).replace(y,"").toLowerCase()}catch(be){return null}if(0===ge.indexOf("javascript:")||0===ge.indexOf("vbscript:")||0===ge.indexOf("data:"))return null}lt&&!x.test(ht)&&(ht=I(lt,ht));try{ht=encodeURI(ht).replace(/%25/g,"%")}catch(be){return null}return ht},te_noopTest={exec:function(){}},te_merge=function(rt){for(var ht,ge,lt=1;lt<arguments.length;lt++)for(ge in ht=arguments[lt])Object.prototype.hasOwnProperty.call(ht,ge)&&(rt[ge]=ht[ge]);return rt},te_checkSanitizeDeprecation=function(rt){rt&&rt.sanitize&&!rt.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")},te_repeatString=function(rt,lt){if(lt<1)return"";for(var ht="";lt>1;)1&lt&&(ht+=rt),lt>>=1,rt+=rt;return ht+rt},Ce=dt.exports.defaults,me=$,ne=function(rt,lt){var ge=rt.replace(/\|/g,function(Be,ut,Je){for(var Tt=!1,Mt=ut;--Mt>=0&&"\\"===Je[Mt];)Tt=!Tt;return Tt?"|":" |"}).split(/ \|/),be=0;if(ge.length>lt)ge.splice(lt);else for(;ge.length<lt;)ge.push("");for(;be<ge.length;be++)ge[be]=ge[be].trim().replace(/\\\|/g,"|");return ge},ye=te_escape,Oe=function(rt,lt){if(-1===rt.indexOf(lt[1]))return-1;for(var ht=rt.length,ge=0,be=0;be<ht;be++)if("\\"===rt[be])be++;else if(rt[be]===lt[0])ge++;else if(rt[be]===lt[1]&&--ge<0)return be;return-1};function $e(rt,lt,ht){var ge=lt.href,be=lt.title?ye(lt.title):null,Be=rt[1].replace(/\\([\[\]])/g,"$1");return"!"!==rt[0].charAt(0)?{type:"link",raw:ht,href:ge,title:be,text:Be}:{type:"image",raw:ht,href:ge,title:be,text:ye(Be)}}var Qe=function(){function rt(ht){this.options=ht||Ce}var lt=rt.prototype;return lt.space=function(ge){var be=this.rules.block.newline.exec(ge);if(be)return be[0].length>1?{type:"space",raw:be[0]}:{raw:"\n"}},lt.code=function(ge){var be=this.rules.block.code.exec(ge);if(be){var Be=be[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:be[0],codeBlockStyle:"indented",text:this.options.pedantic?Be:me(Be,"\n")}}},lt.fences=function(ge){var be=this.rules.block.fences.exec(ge);if(be){var Be=be[0],ut=function(rt,lt){var ht=rt.match(/^(\s+)(?:```)/);if(null===ht)return lt;var ge=ht[1];return lt.split("\n").map(function(be){var Be=be.match(/^\s+/);return null===Be?be:Be[0].length>=ge.length?be.slice(ge.length):be}).join("\n")}(Be,be[3]||"");return{type:"code",raw:Be,lang:be[2]?be[2].trim():be[2],text:ut}}},lt.heading=function(ge){var be=this.rules.block.heading.exec(ge);if(be){var Be=be[2].trim();if(/#$/.test(Be)){var ut=me(Be,"#");(this.options.pedantic||!ut||/ $/.test(ut))&&(Be=ut.trim())}return{type:"heading",raw:be[0],depth:be[1].length,text:Be}}},lt.nptable=function(ge){var be=this.rules.block.nptable.exec(ge);if(be){var Be={type:"table",header:ne(be[1].replace(/^ *| *\| *$/g,"")),align:be[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:be[3]?be[3].replace(/\n$/,"").split("\n"):[],raw:be[0]};if(Be.header.length===Be.align.length){var Je,ut=Be.align.length;for(Je=0;Je<ut;Je++)Be.align[Je]=/^ *-+: *$/.test(Be.align[Je])?"right":/^ *:-+: *$/.test(Be.align[Je])?"center":/^ *:-+ *$/.test(Be.align[Je])?"left":null;for(ut=Be.cells.length,Je=0;Je<ut;Je++)Be.cells[Je]=ne(Be.cells[Je],Be.header.length);return Be}}},lt.hr=function(ge){var be=this.rules.block.hr.exec(ge);if(be)return{type:"hr",raw:be[0]}},lt.blockquote=function(ge){var be=this.rules.block.blockquote.exec(ge);if(be){var Be=be[0].replace(/^ *> ?/gm,"");return{type:"blockquote",raw:be[0],text:Be}}},lt.list=function(ge){var be=this.rules.block.list.exec(ge);if(be){var Xt,Un,ii,On,gn,Wn,Sn,tr,nr,Be=be[0],ut=be[2],Je=ut.length>1,Tt={type:"list",raw:Be,ordered:Je,start:Je?+ut.slice(0,-1):"",loose:!1,items:[]},Mt=be[0].match(this.rules.block.item),Dt=!1,Yn=Mt.length;ii=this.rules.block.listItemStart.exec(Mt[0]);for(var ji=0;ji<Yn;ji++){if(Be=Xt=Mt[ji],this.options.pedantic||(nr=Xt.match(new RegExp("\\n\\s*\\n {0,"+(ii[0].length-1)+"}\\S")))&&(gn=Xt.length-nr.index+Mt.slice(ji+1).join("\n").length,Tt.raw=Tt.raw.substring(0,Tt.raw.length-gn),Be=Xt=Xt.substring(0,nr.index),Yn=ji+1),ji!==Yn-1){if(On=this.rules.block.listItemStart.exec(Mt[ji+1]),this.options.pedantic?On[1].length>ii[1].length:On[1].length>=ii[0].length||On[1].length>3){Mt.splice(ji,2,Mt[ji]+(!this.options.pedantic&&On[1].length<ii[0].length&&!Mt[ji].match(/\n$/)?"":"\n")+Mt[ji+1]),ji--,Yn--;continue}(!this.options.pedantic||this.options.smartLists?On[2][On[2].length-1]!==ut[ut.length-1]:Je===(1===On[2].length))&&(gn=Mt.slice(ji+1).join("\n").length,Tt.raw=Tt.raw.substring(0,Tt.raw.length-gn),ji=Yn-1),ii=On}Un=Xt.length,~(Xt=Xt.replace(/^ *([*+-]|\d+[.)]) ?/,"")).indexOf("\n ")&&(Un-=Xt.length,Xt=Xt.replace(this.options.pedantic?/^ {1,4}/gm:new RegExp("^ {1,"+Un+"}","gm"),"")),Xt=me(Xt,"\n"),ji!==Yn-1&&(Be+="\n"),Wn=Dt||/\n\n(?!\s*$)/.test(Be),ji!==Yn-1&&(Dt="\n\n"===Be.slice(-2),Wn||(Wn=Dt)),Wn&&(Tt.loose=!0),this.options.gfm&&(tr=void 0,(Sn=/^\[[ xX]\] /.test(Xt))&&(tr=" "!==Xt[1],Xt=Xt.replace(/^\[[ xX]\] +/,""))),Tt.items.push({type:"list_item",raw:Be,task:Sn,checked:tr,loose:Wn,text:Xt})}return Tt}},lt.html=function(ge){var be=this.rules.block.html.exec(ge);if(be)return{type:this.options.sanitize?"paragraph":"html",raw:be[0],pre:!this.options.sanitizer&&("pre"===be[1]||"script"===be[1]||"style"===be[1]),text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(be[0]):ye(be[0]):be[0]}},lt.def=function(ge){var be=this.rules.block.def.exec(ge);if(be)return be[3]&&(be[3]=be[3].substring(1,be[3].length-1)),{type:"def",tag:be[1].toLowerCase().replace(/\s+/g," "),raw:be[0],href:be[2],title:be[3]}},lt.table=function(ge){var be=this.rules.block.table.exec(ge);if(be){var Be={type:"table",header:ne(be[1].replace(/^ *| *\| *$/g,"")),align:be[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:be[3]?be[3].replace(/\n$/,"").split("\n"):[]};if(Be.header.length===Be.align.length){Be.raw=be[0];var Je,ut=Be.align.length;for(Je=0;Je<ut;Je++)Be.align[Je]=/^ *-+: *$/.test(Be.align[Je])?"right":/^ *:-+: *$/.test(Be.align[Je])?"center":/^ *:-+ *$/.test(Be.align[Je])?"left":null;for(ut=Be.cells.length,Je=0;Je<ut;Je++)Be.cells[Je]=ne(Be.cells[Je].replace(/^ *\| *| *\| *$/g,""),Be.header.length);return Be}}},lt.lheading=function(ge){var be=this.rules.block.lheading.exec(ge);if(be)return{type:"heading",raw:be[0],depth:"="===be[2].charAt(0)?1:2,text:be[1]}},lt.paragraph=function(ge){var be=this.rules.block.paragraph.exec(ge);if(be)return{type:"paragraph",raw:be[0],text:"\n"===be[1].charAt(be[1].length-1)?be[1].slice(0,-1):be[1]}},lt.text=function(ge){var be=this.rules.block.text.exec(ge);if(be)return{type:"text",raw:be[0],text:be[0]}},lt.escape=function(ge){var be=this.rules.inline.escape.exec(ge);if(be)return{type:"escape",raw:be[0],text:ye(be[1])}},lt.tag=function(ge,be,Be){var ut=this.rules.inline.tag.exec(ge);if(ut)return!be&&/^<a /i.test(ut[0])?be=!0:be&&/^<\/a>/i.test(ut[0])&&(be=!1),!Be&&/^<(pre|code|kbd|script)(\s|>)/i.test(ut[0])?Be=!0:Be&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(ut[0])&&(Be=!1),{type:this.options.sanitize?"text":"html",raw:ut[0],inLink:be,inRawBlock:Be,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(ut[0]):ye(ut[0]):ut[0]}},lt.link=function(ge){var be=this.rules.inline.link.exec(ge);if(be){var Be=be[2].trim();if(!this.options.pedantic&&/^</.test(Be)){if(!/>$/.test(Be))return;var ut=me(Be.slice(0,-1),"\\");if((Be.length-ut.length)%2==0)return}else{var Je=Oe(be[2],"()");if(Je>-1){var Mt=(0===be[0].indexOf("!")?5:4)+be[1].length+Je;be[2]=be[2].substring(0,Je),be[0]=be[0].substring(0,Mt).trim(),be[3]=""}}var Dt=be[2],Xt="";if(this.options.pedantic){var Un=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(Dt);Un&&(Dt=Un[1],Xt=Un[3])}else Xt=be[3]?be[3].slice(1,-1):"";return Dt=Dt.trim(),/^</.test(Dt)&&(Dt=this.options.pedantic&&!/>$/.test(Be)?Dt.slice(1):Dt.slice(1,-1)),$e(be,{href:Dt&&Dt.replace(this.rules.inline._escapes,"$1"),title:Xt&&Xt.replace(this.rules.inline._escapes,"$1")},be[0])}},lt.reflink=function(ge,be){var Be;if((Be=this.rules.inline.reflink.exec(ge))||(Be=this.rules.inline.nolink.exec(ge))){var ut=(Be[2]||Be[1]).replace(/\s+/g," ");if(!(ut=be[ut.toLowerCase()])||!ut.href){var Je=Be[0].charAt(0);return{type:"text",raw:Je,text:Je}}return $e(Be,ut,Be[0])}},lt.emStrong=function(ge,be,Be){void 0===Be&&(Be="");var ut=this.rules.inline.emStrong.lDelim.exec(ge);if(ut&&(!ut[3]||!Be.match(/(?:[0-9A-Za-z\xAA\xB2\xB3\xB5\xB9\xBA\xBC-\xBE\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u0660-\u0669\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07C0-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08C7\u0904-\u0939\u093D\u0950\u0958-\u0961\u0966-\u096F\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09E6-\u09F1\u09F4-\u09F9\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A66-\u0A6F\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AE6-\u0AEF\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B66-\u0B6F\u0B71-\u0B77\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0BE6-\u0BF2\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C66-\u0C6F\u0C78-\u0C7E\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CE6-\u0CEF\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D58-\u0D61\u0D66-\u0D78\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DE6-\u0DEF\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F20-\u0F33\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F-\u1049\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u1090-\u1099\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1369-\u137C\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u17E0-\u17E9\u17F0-\u17F9\u1810-\u1819\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A16\u1A20-\u1A54\u1A80-\u1A89\u1A90-\u1A99\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B50-\u1B59\u1B83-\u1BA0\u1BAE-\u1BE5\u1C00-\u1C23\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2070\u2071\u2074-\u2079\u207F-\u2089\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2150-\u2189\u2460-\u249B\u24EA-\u24FF\u2776-\u2793\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2CFD\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u3192-\u3195\u31A0-\u31BF\u31F0-\u31FF\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\u3400-\u4DBF\u4E00-\u9FFC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7BF\uA7C2-\uA7CA\uA7F5-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA830-\uA835\uA840-\uA873\uA882-\uA8B3\uA8D0-\uA8D9\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA900-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF-\uA9D9\uA9E0-\uA9E4\uA9E6-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA50-\uAA59\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD07-\uDD33\uDD40-\uDD78\uDD8A\uDD8B\uDE80-\uDE9C\uDEA0-\uDED0\uDEE1-\uDEFB\uDF00-\uDF23\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC58-\uDC76\uDC79-\uDC9E\uDCA7-\uDCAF\uDCE0-\uDCF2\uDCF4\uDCF5\uDCFB-\uDD1B\uDD20-\uDD39\uDD80-\uDDB7\uDDBC-\uDDCF\uDDD2-\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE40-\uDE48\uDE60-\uDE7E\uDE80-\uDE9F\uDEC0-\uDEC7\uDEC9-\uDEE4\uDEEB-\uDEEF\uDF00-\uDF35\uDF40-\uDF55\uDF58-\uDF72\uDF78-\uDF91\uDFA9-\uDFAF]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDCFA-\uDD23\uDD30-\uDD39\uDE60-\uDE7E\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF27\uDF30-\uDF45\uDF51-\uDF54\uDFB0-\uDFCB\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC52-\uDC6F\uDC83-\uDCAF\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD03-\uDD26\uDD36-\uDD3F\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDD0-\uDDDA\uDDDC\uDDE1-\uDDF4\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDEF0-\uDEF9\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC50-\uDC59\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE50-\uDE59\uDE80-\uDEAA\uDEB8\uDEC0-\uDEC9\uDF00-\uDF1A\uDF30-\uDF3B]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCF2\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDD50-\uDD59\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC50-\uDC6C\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD50-\uDD59\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDDA0-\uDDA9\uDEE0-\uDEF2\uDFB0\uDFC0-\uDFD4]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF50-\uDF59\uDF5B-\uDF61\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE96\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82C[\uDC00-\uDD1E\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD834[\uDEE0-\uDEF3\uDF60-\uDF78]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD838[\uDD00-\uDD2C\uDD37-\uDD3D\uDD40-\uDD49\uDD4E\uDEC0-\uDEEB\uDEF0-\uDEF9]|\uD83A[\uDC00-\uDCC4\uDCC7-\uDCCF\uDD00-\uDD43\uDD4B\uDD50-\uDD59]|\uD83B[\uDC71-\uDCAB\uDCAD-\uDCAF\uDCB1-\uDCB4\uDD01-\uDD2D\uDD2F-\uDD3D\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD83C[\uDD00-\uDD0C]|\uD83E[\uDFF0-\uDFF9]|\uD869[\uDC00-\uDEDD\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])/))){var Je=ut[1]||ut[2]||"";if(!Je||Je&&(""===Be||this.rules.inline.punctuation.exec(Be))){var Mt,Dt,Tt=ut[0].length-1,Xt=Tt,Un=0,ii="*"===ut[0][0]?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(ii.lastIndex=0,be=be.slice(-1*ge.length+Tt);null!=(ut=ii.exec(be));)if(Mt=ut[1]||ut[2]||ut[3]||ut[4]||ut[5]||ut[6]){if(Dt=Mt.length,ut[3]||ut[4]){Xt+=Dt;continue}if((ut[5]||ut[6])&&Tt%3&&!((Tt+Dt)%3)){Un+=Dt;continue}if(!((Xt-=Dt)>0))return Dt=Math.min(Dt,Dt+Xt+Un),Math.min(Tt,Dt)%2?{type:"em",raw:ge.slice(0,Tt+ut.index+Dt+1),text:ge.slice(1,Tt+ut.index+Dt)}:{type:"strong",raw:ge.slice(0,Tt+ut.index+Dt+1),text:ge.slice(2,Tt+ut.index+Dt-1)}}}}},lt.codespan=function(ge){var be=this.rules.inline.code.exec(ge);if(be){var Be=be[2].replace(/\n/g," "),ut=/[^ ]/.test(Be),Je=/^ /.test(Be)&&/ $/.test(Be);return ut&&Je&&(Be=Be.substring(1,Be.length-1)),Be=ye(Be,!0),{type:"codespan",raw:be[0],text:Be}}},lt.br=function(ge){var be=this.rules.inline.br.exec(ge);if(be)return{type:"br",raw:be[0]}},lt.del=function(ge){var be=this.rules.inline.del.exec(ge);if(be)return{type:"del",raw:be[0],text:be[2]}},lt.autolink=function(ge,be){var ut,Je,Be=this.rules.inline.autolink.exec(ge);if(Be)return Je="@"===Be[2]?"mailto:"+(ut=ye(this.options.mangle?be(Be[1]):Be[1])):ut=ye(Be[1]),{type:"link",raw:Be[0],text:ut,href:Je,tokens:[{type:"text",raw:ut,text:ut}]}},lt.url=function(ge,be){var Be;if(Be=this.rules.inline.url.exec(ge)){var ut,Je;if("@"===Be[2])Je="mailto:"+(ut=ye(this.options.mangle?be(Be[0]):Be[0]));else{var Tt;do{Tt=Be[0],Be[0]=this.rules.inline._backpedal.exec(Be[0])[0]}while(Tt!==Be[0]);ut=ye(Be[0]),Je="www."===Be[1]?"http://"+ut:ut}return{type:"link",raw:Be[0],text:ut,href:Je,tokens:[{type:"text",raw:ut,text:ut}]}}},lt.inlineText=function(ge,be,Be){var Je,ut=this.rules.inline.text.exec(ge);if(ut)return Je=be?this.options.sanitize?this.options.sanitizer?this.options.sanitizer(ut[0]):ye(ut[0]):ut[0]:ye(this.options.smartypants?Be(ut[0]):ut[0]),{type:"text",raw:ut[0],text:Je}},rt}(),tt=te_noopTest,Ke=te_edit,ze=te_merge,ke={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?:\n+|$)|$)/,hr:/^ {0,3}((?:- *){3,}|(?:_ *){3,}|(?:\* *){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3})(bull) [\s\S]+?(?:hr|def|\n{2,}(?! )(?! {0,3}bull )\n*|\s*$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *\n? *<?([^\s>]+)>?(?:(?: +\n? *| *\n *)(title))? *(?:\n+|$)/,nptable:tt,table:tt,lheading:/^([^\n]+)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html| +\n)[^\n]+)*)/,text:/^[^\n]+/,_label:/(?!\s*\])(?:\\[\[\]]|[^\[\]])+/,_title:/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/};ke.def=Ke(ke.def).replace("label",ke._label).replace("title",ke._title).getRegex(),ke.bullet=/(?:[*+-]|\d{1,9}[.)])/,ke.item=/^( *)(bull) ?[^\n]*(?:\n(?! *bull ?)[^\n]*)*/,ke.item=Ke(ke.item,"gm").replace(/bull/g,ke.bullet).getRegex(),ke.listItemStart=Ke(/^( *)(bull) */).replace("bull",ke.bullet).getRegex(),ke.list=Ke(ke.list).replace(/bull/g,ke.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+ke.def.source+")").getRegex(),ke._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",ke._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/,ke.html=Ke(ke.html,"i").replace("comment",ke._comment).replace("tag",ke._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),ke.paragraph=Ke(ke._paragraph).replace("hr",ke.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ke._tag).getRegex(),ke.blockquote=Ke(ke.blockquote).replace("paragraph",ke.paragraph).getRegex(),ke.normal=ze({},ke),ke.gfm=ze({},ke.normal,{nptable:"^ *([^|\\n ].*\\|.*)\\n {0,3}([-:]+ *\\|[-| :]*)(?:\\n((?:(?!\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)",table:"^ *\\|(.+)\\n {0,3}\\|?( *[-:]+[-| :]*)(?:\\n *((?:(?!\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"}),ke.gfm.nptable=Ke(ke.gfm.nptable).replace("hr",ke.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ke._tag).getRegex(),ke.gfm.table=Ke(ke.gfm.table).replace("hr",ke.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ke._tag).getRegex(),ke.pedantic=ze({},ke.normal,{html:Ke("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",ke._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:tt,paragraph:Ke(ke.normal._paragraph).replace("hr",ke.hr).replace("heading"," *#{1,6} *[^\n]").replace("lheading",ke.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()});var Xe={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:tt,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(?!\s*\])((?:\\[\[\]]?|[^\[\]\\])+)\]/,nolink:/^!?\[(?!\s*\])((?:\[[^\[\]]*\]|\\[\[\]]|[^\[\]])*)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/\_\_[^_*]*?\*[^_*]*?\_\_|[punct_](\*+)(?=[\s]|$)|[^punct*_\s](\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|[^punct*_\s](\*+)(?=[^punct*_\s])/,rDelimUnd:/\*\*[^_*]*?\_[^_*]*?\*\*|[punct*](\_+)(?=[\s]|$)|[^punct*_\s](\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:tt,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/,_punctuation:"!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~"};Xe.punctuation=Ke(Xe.punctuation).replace(/punctuation/g,Xe._punctuation).getRegex(),Xe.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g,Xe.escapedEmSt=/\\\*|\\_/g,Xe._comment=Ke(ke._comment).replace("(?:--\x3e|$)","--\x3e").getRegex(),Xe.emStrong.lDelim=Ke(Xe.emStrong.lDelim).replace(/punct/g,Xe._punctuation).getRegex(),Xe.emStrong.rDelimAst=Ke(Xe.emStrong.rDelimAst,"g").replace(/punct/g,Xe._punctuation).getRegex(),Xe.emStrong.rDelimUnd=Ke(Xe.emStrong.rDelimUnd,"g").replace(/punct/g,Xe._punctuation).getRegex(),Xe._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g,Xe._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,Xe._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,Xe.autolink=Ke(Xe.autolink).replace("scheme",Xe._scheme).replace("email",Xe._email).getRegex(),Xe._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/,Xe.tag=Ke(Xe.tag).replace("comment",Xe._comment).replace("attribute",Xe._attribute).getRegex(),Xe._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,Xe._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/,Xe._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/,Xe.link=Ke(Xe.link).replace("label",Xe._label).replace("href",Xe._href).replace("title",Xe._title).getRegex(),Xe.reflink=Ke(Xe.reflink).replace("label",Xe._label).getRegex(),Xe.reflinkSearch=Ke(Xe.reflinkSearch,"g").replace("reflink",Xe.reflink).replace("nolink",Xe.nolink).getRegex(),Xe.normal=ze({},Xe),Xe.pedantic=ze({},Xe.normal,{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:Ke(/^!?\[(label)\]\((.*?)\)/).replace("label",Xe._label).getRegex(),reflink:Ke(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Xe._label).getRegex()}),Xe.gfm=ze({},Xe.normal,{escape:Ke(Xe.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/}),Xe.gfm.url=Ke(Xe.gfm.url,"i").replace("email",Xe.gfm._extended_email).getRegex(),Xe.breaks=ze({},Xe.gfm,{br:Ke(Xe.br).replace("{2,}","*").getRegex(),text:Ke(Xe.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()});var Ae={block:ke,inline:Xe},Ue=Qe,qe=dt.exports.defaults,Fe=Ae.block,q=Ae.inline,G=te_repeatString;function pe(rt){return rt.replace(/---/g,"\u2014").replace(/--/g,"\u2013").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1\u2018").replace(/'/g,"\u2019").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1\u201c").replace(/"/g,"\u201d").replace(/\.{3}/g,"\u2026")}function de(rt){var ht,ge,lt="",be=rt.length;for(ht=0;ht<be;ht++)ge=rt.charCodeAt(ht),Math.random()>.5&&(ge="x"+ge.toString(16)),lt+="&#"+ge+";";return lt}var je=function(){function rt(ht){this.tokens=[],this.tokens.links=Object.create(null),this.options=ht||qe,this.options.tokenizer=this.options.tokenizer||new Ue,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options;var ge={block:Fe.normal,inline:q.normal};this.options.pedantic?(ge.block=Fe.pedantic,ge.inline=q.pedantic):this.options.gfm&&(ge.block=Fe.gfm,ge.inline=this.options.breaks?q.breaks:q.gfm),this.tokenizer.rules=ge}rt.lex=function(ge,be){return new rt(be).lex(ge)},rt.lexInline=function(ge,be){return new rt(be).inlineTokens(ge)};var lt=rt.prototype;return lt.lex=function(ge){return ge=ge.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    "),this.blockTokens(ge,this.tokens,!0),this.inline(this.tokens),this.tokens},lt.blockTokens=function(ge,be,Be){var Je,Tt,Mt,Dt,Xt,Un,ut=this;for(void 0===be&&(be=[]),void 0===Be&&(Be=!0),this.options.pedantic&&(ge=ge.replace(/^ +$/gm,""));ge;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(function(On){return!!(Je=On.call(ut,ge,be))&&(ge=ge.substring(Je.raw.length),be.push(Je),!0)}))){if(Je=this.tokenizer.space(ge)){ge=ge.substring(Je.raw.length),Je.type&&be.push(Je);continue}if(Je=this.tokenizer.code(ge)){ge=ge.substring(Je.raw.length),(Dt=be[be.length-1])&&"paragraph"===Dt.type?(Dt.raw+="\n"+Je.raw,Dt.text+="\n"+Je.text):be.push(Je);continue}if(Je=this.tokenizer.fences(ge)){ge=ge.substring(Je.raw.length),be.push(Je);continue}if(Je=this.tokenizer.heading(ge)){ge=ge.substring(Je.raw.length),be.push(Je);continue}if(Je=this.tokenizer.nptable(ge)){ge=ge.substring(Je.raw.length),be.push(Je);continue}if(Je=this.tokenizer.hr(ge)){ge=ge.substring(Je.raw.length),be.push(Je);continue}if(Je=this.tokenizer.blockquote(ge)){ge=ge.substring(Je.raw.length),Je.tokens=this.blockTokens(Je.text,[],Be),be.push(Je);continue}if(Je=this.tokenizer.list(ge)){for(ge=ge.substring(Je.raw.length),Mt=Je.items.length,Tt=0;Tt<Mt;Tt++)Je.items[Tt].tokens=this.blockTokens(Je.items[Tt].text,[],!1);be.push(Je);continue}if(Je=this.tokenizer.html(ge)){ge=ge.substring(Je.raw.length),be.push(Je);continue}if(Be&&(Je=this.tokenizer.def(ge))){ge=ge.substring(Je.raw.length),this.tokens.links[Je.tag]||(this.tokens.links[Je.tag]={href:Je.href,title:Je.title});continue}if(Je=this.tokenizer.table(ge)){ge=ge.substring(Je.raw.length),be.push(Je);continue}if(Je=this.tokenizer.lheading(ge)){ge=ge.substring(Je.raw.length),be.push(Je);continue}if(Xt=ge,this.options.extensions&&this.options.extensions.startBlock&&function(){var On=1/0,gn=ge.slice(1),Wn=void 0;ut.options.extensions.startBlock.forEach(function(Sn){"number"==typeof(Wn=Sn.call(this,gn))&&Wn>=0&&(On=Math.min(On,Wn))}),On<1/0&&On>=0&&(Xt=ge.substring(0,On+1))}(),Be&&(Je=this.tokenizer.paragraph(Xt))){Dt=be[be.length-1],Un&&"paragraph"===Dt.type?(Dt.raw+="\n"+Je.raw,Dt.text+="\n"+Je.text):be.push(Je),Un=Xt.length!==ge.length,ge=ge.substring(Je.raw.length);continue}if(Je=this.tokenizer.text(ge)){ge=ge.substring(Je.raw.length),(Dt=be[be.length-1])&&"text"===Dt.type?(Dt.raw+="\n"+Je.raw,Dt.text+="\n"+Je.text):be.push(Je);continue}if(ge){var ii="Infinite loop on byte: "+ge.charCodeAt(0);if(this.options.silent){console.error(ii);break}throw new Error(ii)}}return be},lt.inline=function(ge){var be,Be,ut,Je,Tt,Mt,Dt=ge.length;for(be=0;be<Dt;be++)switch(Mt=ge[be],Mt.type){case"paragraph":case"text":case"heading":Mt.tokens=[],this.inlineTokens(Mt.text,Mt.tokens);break;case"table":for(Mt.tokens={header:[],cells:[]},Je=Mt.header.length,Be=0;Be<Je;Be++)Mt.tokens.header[Be]=[],this.inlineTokens(Mt.header[Be],Mt.tokens.header[Be]);for(Je=Mt.cells.length,Be=0;Be<Je;Be++)for(Tt=Mt.cells[Be],Mt.tokens.cells[Be]=[],ut=0;ut<Tt.length;ut++)Mt.tokens.cells[Be][ut]=[],this.inlineTokens(Tt[ut],Mt.tokens.cells[Be][ut]);break;case"blockquote":this.inline(Mt.tokens);break;case"list":for(Je=Mt.items.length,Be=0;Be<Je;Be++)this.inline(Mt.items[Be].tokens)}return ge},lt.inlineTokens=function(ge,be,Be,ut){var Je=this;void 0===be&&(be=[]),void 0===Be&&(Be=!1),void 0===ut&&(ut=!1);var Tt,Mt,Dt,Un,ii,On,Xt=ge;if(this.tokens.links){var gn=Object.keys(this.tokens.links);if(gn.length>0)for(;null!=(Un=this.tokenizer.rules.inline.reflinkSearch.exec(Xt));)gn.includes(Un[0].slice(Un[0].lastIndexOf("[")+1,-1))&&(Xt=Xt.slice(0,Un.index)+"["+G("a",Un[0].length-2)+"]"+Xt.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;null!=(Un=this.tokenizer.rules.inline.blockSkip.exec(Xt));)Xt=Xt.slice(0,Un.index)+"["+G("a",Un[0].length-2)+"]"+Xt.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;null!=(Un=this.tokenizer.rules.inline.escapedEmSt.exec(Xt));)Xt=Xt.slice(0,Un.index)+"++"+Xt.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex);for(;ge;)if(ii||(On=""),ii=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(function(Sn){return!!(Tt=Sn.call(Je,ge,be))&&(ge=ge.substring(Tt.raw.length),be.push(Tt),!0)}))){if(Tt=this.tokenizer.escape(ge)){ge=ge.substring(Tt.raw.length),be.push(Tt);continue}if(Tt=this.tokenizer.tag(ge,Be,ut)){ge=ge.substring(Tt.raw.length),Be=Tt.inLink,ut=Tt.inRawBlock,(Mt=be[be.length-1])&&"text"===Tt.type&&"text"===Mt.type?(Mt.raw+=Tt.raw,Mt.text+=Tt.text):be.push(Tt);continue}if(Tt=this.tokenizer.link(ge)){ge=ge.substring(Tt.raw.length),"link"===Tt.type&&(Tt.tokens=this.inlineTokens(Tt.text,[],!0,ut)),be.push(Tt);continue}if(Tt=this.tokenizer.reflink(ge,this.tokens.links)){ge=ge.substring(Tt.raw.length),Mt=be[be.length-1],"link"===Tt.type?(Tt.tokens=this.inlineTokens(Tt.text,[],!0,ut),be.push(Tt)):Mt&&"text"===Tt.type&&"text"===Mt.type?(Mt.raw+=Tt.raw,Mt.text+=Tt.text):be.push(Tt);continue}if(Tt=this.tokenizer.emStrong(ge,Xt,On)){ge=ge.substring(Tt.raw.length),Tt.tokens=this.inlineTokens(Tt.text,[],Be,ut),be.push(Tt);continue}if(Tt=this.tokenizer.codespan(ge)){ge=ge.substring(Tt.raw.length),be.push(Tt);continue}if(Tt=this.tokenizer.br(ge)){ge=ge.substring(Tt.raw.length),be.push(Tt);continue}if(Tt=this.tokenizer.del(ge)){ge=ge.substring(Tt.raw.length),Tt.tokens=this.inlineTokens(Tt.text,[],Be,ut),be.push(Tt);continue}if(Tt=this.tokenizer.autolink(ge,de)){ge=ge.substring(Tt.raw.length),be.push(Tt);continue}if(!Be&&(Tt=this.tokenizer.url(ge,de))){ge=ge.substring(Tt.raw.length),be.push(Tt);continue}if(Dt=ge,this.options.extensions&&this.options.extensions.startInline&&function(){var Sn=1/0,tr=ge.slice(1),nr=void 0;Je.options.extensions.startInline.forEach(function(Yn){"number"==typeof(nr=Yn.call(this,tr))&&nr>=0&&(Sn=Math.min(Sn,nr))}),Sn<1/0&&Sn>=0&&(Dt=ge.substring(0,Sn+1))}(),Tt=this.tokenizer.inlineText(Dt,ut,pe)){ge=ge.substring(Tt.raw.length),"_"!==Tt.raw.slice(-1)&&(On=Tt.raw.slice(-1)),ii=!0,(Mt=be[be.length-1])&&"text"===Mt.type?(Mt.raw+=Tt.raw,Mt.text+=Tt.text):be.push(Tt);continue}if(ge){var Wn="Infinite loop on byte: "+ge.charCodeAt(0);if(this.options.silent){console.error(Wn);break}throw new Error(Wn)}}return be},function(rt,lt,ht){lt&&it(rt.prototype,lt),ht&&it(rt,ht)}(rt,null,[{key:"rules",get:function(){return{block:Fe,inline:q}}}]),rt}(),_t=dt.exports.defaults,pt=te_cleanUrl,we=te_escape,B=function(){function rt(ht){this.options=ht||_t}var lt=rt.prototype;return lt.code=function(ge,be,Be){var ut=(be||"").match(/\S*/)[0];if(this.options.highlight){var Je=this.options.highlight(ge,ut);null!=Je&&Je!==ge&&(Be=!0,ge=Je)}return ge=ge.replace(/\n$/,"")+"\n",ut?'<pre><code class="'+this.options.langPrefix+we(ut,!0)+'">'+(Be?ge:we(ge,!0))+"</code></pre>\n":"<pre><code>"+(Be?ge:we(ge,!0))+"</code></pre>\n"},lt.blockquote=function(ge){return"<blockquote>\n"+ge+"</blockquote>\n"},lt.html=function(ge){return ge},lt.heading=function(ge,be,Be,ut){return this.options.headerIds?"<h"+be+' id="'+this.options.headerPrefix+ut.slug(Be)+'">'+ge+"</h"+be+">\n":"<h"+be+">"+ge+"</h"+be+">\n"},lt.hr=function(){return this.options.xhtml?"<hr/>\n":"<hr>\n"},lt.list=function(ge,be,Be){var ut=be?"ol":"ul";return"<"+ut+(be&&1!==Be?' start="'+Be+'"':"")+">\n"+ge+"</"+ut+">\n"},lt.listitem=function(ge){return"<li>"+ge+"</li>\n"},lt.checkbox=function(ge){return"<input "+(ge?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "},lt.paragraph=function(ge){return"<p>"+ge+"</p>\n"},lt.table=function(ge,be){return be&&(be="<tbody>"+be+"</tbody>"),"<table>\n<thead>\n"+ge+"</thead>\n"+be+"</table>\n"},lt.tablerow=function(ge){return"<tr>\n"+ge+"</tr>\n"},lt.tablecell=function(ge,be){var Be=be.header?"th":"td";return(be.align?"<"+Be+' align="'+be.align+'">':"<"+Be+">")+ge+"</"+Be+">\n"},lt.strong=function(ge){return"<strong>"+ge+"</strong>"},lt.em=function(ge){return"<em>"+ge+"</em>"},lt.codespan=function(ge){return"<code>"+ge+"</code>"},lt.br=function(){return this.options.xhtml?"<br/>":"<br>"},lt.del=function(ge){return"<del>"+ge+"</del>"},lt.link=function(ge,be,Be){if(null===(ge=pt(this.options.sanitize,this.options.baseUrl,ge)))return Be;var ut='<a href="'+we(ge)+'"';return be&&(ut+=' title="'+be+'"'),ut+">"+Be+"</a>"},lt.image=function(ge,be,Be){if(null===(ge=pt(this.options.sanitize,this.options.baseUrl,ge)))return Be;var ut='<img src="'+ge+'" alt="'+Be+'"';return be&&(ut+=' title="'+be+'"'),ut+(this.options.xhtml?"/>":">")},lt.text=function(ge){return ge},rt}(),P=function(){function rt(){}var lt=rt.prototype;return lt.strong=function(ge){return ge},lt.em=function(ge){return ge},lt.codespan=function(ge){return ge},lt.del=function(ge){return ge},lt.html=function(ge){return ge},lt.text=function(ge){return ge},lt.link=function(ge,be,Be){return""+Be},lt.image=function(ge,be,Be){return""+Be},lt.br=function(){return""},rt}(),V=function(){function rt(){this.seen={}}var lt=rt.prototype;return lt.serialize=function(ge){return ge.toLowerCase().trim().replace(/<[!\/a-z].*?>/gi,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")},lt.getNextSafeSlug=function(ge,be){var Be=ge,ut=0;if(this.seen.hasOwnProperty(Be)){ut=this.seen[ge];do{Be=ge+"-"+ ++ut}while(this.seen.hasOwnProperty(Be))}return be||(this.seen[ge]=ut,this.seen[Be]=0),Be},lt.slug=function(ge,be){void 0===be&&(be={});var Be=this.serialize(ge);return this.getNextSafeSlug(Be,be.dryrun)},rt}(),Re=B,Ze=P,St=V,Rt=dt.exports.defaults,Mn=te_unescape,$n=je,bi=function(){function rt(ht){this.options=ht||Rt,this.options.renderer=this.options.renderer||new Re,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new Ze,this.slugger=new St}rt.parse=function(ge,be){return new rt(be).parse(ge)},rt.parseInline=function(ge,be){return new rt(be).parseInline(ge)};var lt=rt.prototype;return lt.parse=function(ge,be){void 0===be&&(be=!0);var ut,Je,Tt,Mt,Dt,Xt,Un,ii,On,gn,Wn,Sn,tr,nr,Yn,ji,va,Wr,re,Be="",fe=ge.length;for(ut=0;ut<fe;ut++)if(gn=ge[ut],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[gn.type]&&(!1!==(re=this.options.extensions.renderers[gn.type].call(this,gn))||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(gn.type)))Be+=re||"";else switch(gn.type){case"space":continue;case"hr":Be+=this.renderer.hr();continue;case"heading":Be+=this.renderer.heading(this.parseInline(gn.tokens),gn.depth,Mn(this.parseInline(gn.tokens,this.textRenderer)),this.slugger);continue;case"code":Be+=this.renderer.code(gn.text,gn.lang,gn.escaped);continue;case"table":for(ii="",Un="",Mt=gn.header.length,Je=0;Je<Mt;Je++)Un+=this.renderer.tablecell(this.parseInline(gn.tokens.header[Je]),{header:!0,align:gn.align[Je]});for(ii+=this.renderer.tablerow(Un),On="",Mt=gn.cells.length,Je=0;Je<Mt;Je++){for(Un="",Dt=(Xt=gn.tokens.cells[Je]).length,Tt=0;Tt<Dt;Tt++)Un+=this.renderer.tablecell(this.parseInline(Xt[Tt]),{header:!1,align:gn.align[Tt]});On+=this.renderer.tablerow(Un)}Be+=this.renderer.table(ii,On);continue;case"blockquote":On=this.parse(gn.tokens),Be+=this.renderer.blockquote(On);continue;case"list":for(Wn=gn.ordered,Sn=gn.start,tr=gn.loose,Mt=gn.items.length,On="",Je=0;Je<Mt;Je++)ji=(Yn=gn.items[Je]).checked,va=Yn.task,nr="",Yn.task&&(Wr=this.renderer.checkbox(ji),tr?Yn.tokens.length>0&&"text"===Yn.tokens[0].type?(Yn.tokens[0].text=Wr+" "+Yn.tokens[0].text,Yn.tokens[0].tokens&&Yn.tokens[0].tokens.length>0&&"text"===Yn.tokens[0].tokens[0].type&&(Yn.tokens[0].tokens[0].text=Wr+" "+Yn.tokens[0].tokens[0].text)):Yn.tokens.unshift({type:"text",text:Wr}):nr+=Wr),nr+=this.parse(Yn.tokens,tr),On+=this.renderer.listitem(nr,va,ji);Be+=this.renderer.list(On,Wn,Sn);continue;case"html":Be+=this.renderer.html(gn.text);continue;case"paragraph":Be+=this.renderer.paragraph(this.parseInline(gn.tokens));continue;case"text":for(On=gn.tokens?this.parseInline(gn.tokens):gn.text;ut+1<fe&&"text"===ge[ut+1].type;)On+="\n"+((gn=ge[++ut]).tokens?this.parseInline(gn.tokens):gn.text);Be+=be?this.renderer.paragraph(On):On;continue;default:var se='Token with "'+gn.type+'" type was not found.';if(this.options.silent)return void console.error(se);throw new Error(se)}return Be},lt.parseInline=function(ge,be){be=be||this.renderer;var ut,Je,Tt,Be="",Mt=ge.length;for(ut=0;ut<Mt;ut++)if(Je=ge[ut],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[Je.type]&&(!1!==(Tt=this.options.extensions.renderers[Je.type].call(this,Je))||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(Je.type)))Be+=Tt||"";else switch(Je.type){case"escape":Be+=be.text(Je.text);break;case"html":Be+=be.html(Je.text);break;case"link":Be+=be.link(Je.href,Je.title,this.parseInline(Je.tokens,be));break;case"image":Be+=be.image(Je.href,Je.title,Je.text);break;case"strong":Be+=be.strong(this.parseInline(Je.tokens,be));break;case"em":Be+=be.em(this.parseInline(Je.tokens,be));break;case"codespan":Be+=be.codespan(Je.text);break;case"br":Be+=be.br();break;case"del":Be+=be.del(this.parseInline(Je.tokens,be));break;case"text":Be+=be.text(Je.text);break;default:var Dt='Token with "'+Je.type+'" type was not found.';if(this.options.silent)return void console.error(Dt);throw new Error(Dt)}return Be},rt}(),fi=Qe,Gr=B,Ps=P,ds=V,Fs=te_merge,$r=te_checkSanitizeDeprecation,_a=te_escape,Ml=dt.exports.getDefaults,ya=dt.exports.changeDefaults,ys=dt.exports.defaults;function Jt(rt,lt,ht){if(null==rt)throw new Error("marked(): input parameter is undefined or null");if("string"!=typeof rt)throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(rt)+", string expected");if("function"==typeof lt&&(ht=lt,lt=null),lt=Fs({},Jt.defaults,lt||{}),$r(lt),ht){var be,ge=lt.highlight;try{be=$n.lex(rt,lt)}catch(Tt){return ht(Tt)}var Be=function(Mt){var Dt;if(!Mt)try{lt.walkTokens&&Jt.walkTokens(be,lt.walkTokens),Dt=bi.parse(be,lt)}catch(Xt){Mt=Xt}return lt.highlight=ge,Mt?ht(Mt):ht(null,Dt)};if(!ge||ge.length<3||(delete lt.highlight,!be.length))return Be();var ut=0;return Jt.walkTokens(be,function(Tt){"code"===Tt.type&&(ut++,setTimeout(function(){ge(Tt.text,Tt.lang,function(Mt,Dt){if(Mt)return Be(Mt);null!=Dt&&Dt!==Tt.text&&(Tt.text=Dt,Tt.escaped=!0),0==--ut&&Be()})},0))}),void(0===ut&&Be())}try{var Je=$n.lex(rt,lt);return lt.walkTokens&&Jt.walkTokens(Je,lt.walkTokens),bi.parse(Je,lt)}catch(Tt){if(Tt.message+="\nPlease report this to https://github.com/markedjs/marked.",lt.silent)return"<p>An error occurred:</p><pre>"+_a(Tt.message+"",!0)+"</pre>";throw Tt}}return Jt.options=Jt.setOptions=function(rt){return Fs(Jt.defaults,rt),ya(Jt.defaults),Jt},Jt.getDefaults=Ml,Jt.defaults=ys,Jt.use=function(){for(var rt=this,lt=arguments.length,ht=new Array(lt),ge=0;ge<lt;ge++)ht[ge]=arguments[ge];var ut,be=Fs.apply(void 0,[{}].concat(ht)),Be=Jt.defaults.extensions||{renderers:{},childTokens:{}};ht.forEach(function(Je){if(Je.extensions&&(ut=!0,Je.extensions.forEach(function(Mt){if(!Mt.name)throw new Error("extension name required");if(Mt.renderer){var Dt=Be.renderers?Be.renderers[Mt.name]:null;Be.renderers[Mt.name]=Dt?function(){for(var Xt=arguments.length,Un=new Array(Xt),ii=0;ii<Xt;ii++)Un[ii]=arguments[ii];var On=Mt.renderer.apply(this,Un);return!1===On&&(On=Dt.apply(this,Un)),On}:Mt.renderer}if(Mt.tokenizer){if(!Mt.level||"block"!==Mt.level&&"inline"!==Mt.level)throw new Error("extension level must be 'block' or 'inline'");Be[Mt.level]?Be[Mt.level].unshift(Mt.tokenizer):Be[Mt.level]=[Mt.tokenizer],Mt.start&&("block"===Mt.level?Be.startBlock?Be.startBlock.push(Mt.start):Be.startBlock=[Mt.start]:"inline"===Mt.level&&(Be.startInline?Be.startInline.push(Mt.start):Be.startInline=[Mt.start]))}Mt.childTokens&&(Be.childTokens[Mt.name]=Mt.childTokens)})),Je.renderer&&function(){var Mt=Jt.defaults.renderer||new Gr,Dt=function(ii){var On=Mt[ii];Mt[ii]=function(){for(var gn=arguments.length,Wn=new Array(gn),Sn=0;Sn<gn;Sn++)Wn[Sn]=arguments[Sn];var tr=Je.renderer[ii].apply(Mt,Wn);return!1===tr&&(tr=On.apply(Mt,Wn)),tr}};for(var Xt in Je.renderer)Dt(Xt);be.renderer=Mt}(),Je.tokenizer&&function(){var Mt=Jt.defaults.tokenizer||new fi,Dt=function(ii){var On=Mt[ii];Mt[ii]=function(){for(var gn=arguments.length,Wn=new Array(gn),Sn=0;Sn<gn;Sn++)Wn[Sn]=arguments[Sn];var tr=Je.tokenizer[ii].apply(Mt,Wn);return!1===tr&&(tr=On.apply(Mt,Wn)),tr}};for(var Xt in Je.tokenizer)Dt(Xt);be.tokenizer=Mt}(),Je.walkTokens){var Tt=Jt.defaults.walkTokens;be.walkTokens=function(Mt){Je.walkTokens.call(rt,Mt),Tt&&Tt(Mt)}}ut&&(be.extensions=Be),Jt.setOptions(be)})},Jt.walkTokens=function(rt,lt){for(var be,ht=function(){var ut=be.value;switch(lt(ut),ut.type){case"table":for(var Tt,Je=At(ut.tokens.header);!(Tt=Je()).done;)Jt.walkTokens(Tt.value,lt);for(var Xt,Dt=At(ut.tokens.cells);!(Xt=Dt()).done;)for(var On,ii=At(Xt.value);!(On=ii()).done;)Jt.walkTokens(On.value,lt);break;case"list":Jt.walkTokens(ut.items,lt);break;default:Jt.defaults.extensions&&Jt.defaults.extensions.childTokens&&Jt.defaults.extensions.childTokens[ut.type]?Jt.defaults.extensions.childTokens[ut.type].forEach(function(Wn){Jt.walkTokens(ut[Wn],lt)}):ut.tokens&&Jt.walkTokens(ut.tokens,lt)}},ge=At(rt);!(be=ge()).done;)ht()},Jt.parseInline=function(rt,lt){if(null==rt)throw new Error("marked.parseInline(): input parameter is undefined or null");if("string"!=typeof rt)throw new Error("marked.parseInline(): input parameter is of type "+Object.prototype.toString.call(rt)+", string expected");lt=Fs({},Jt.defaults,lt||{}),$r(lt);try{var ht=$n.lexInline(rt,lt);return lt.walkTokens&&Jt.walkTokens(ht,lt.walkTokens),bi.parseInline(ht,lt)}catch(ge){if(ge.message+="\nPlease report this to https://github.com/markedjs/marked.",lt.silent)return"<p>An error occurred:</p><pre>"+_a(ge.message+"",!0)+"</pre>";throw ge}},Jt.Parser=bi,Jt.parser=bi.parse,Jt.Renderer=Gr,Jt.TextRenderer=Ps,Jt.Lexer=$n,Jt.lexer=$n.lex,Jt.Tokenizer=fi,Jt.Slugger=ds,Jt.parse=Jt,Jt}()},9369:(Ut,it,et)=>{var yt=et(6284),ee=et(7830);function At(){this.clear()}At.prototype.clear=function(){this.items=[],this.offset=0,this.size=0},At.prototype.enqueue=function(dt){return this.items.push(dt),++this.size},At.prototype.dequeue=function(){if(this.size){var dt=this.items[this.offset];return 2*++this.offset>=this.items.length&&(this.items=this.items.slice(this.offset),this.offset=0),this.size--,dt}},At.prototype.peek=function(){if(this.size)return this.items[this.offset]},At.prototype.forEach=function(dt,Y){Y=arguments.length>1?Y:this;for(var xe=this.offset,he=0,W=this.items.length;xe<W;xe++,he++)dt.call(Y,this.items[xe],he,this)},At.prototype.toArray=function(){return this.items.slice(this.offset)},At.prototype.values=function(){var dt=this.items,Y=this.offset;return new yt(function(){if(Y>=dt.length)return{done:!0};var xe=dt[Y];return Y++,{value:xe,done:!1}})},At.prototype.entries=function(){var dt=this.items,Y=this.offset,xe=0;return new yt(function(){if(Y>=dt.length)return{done:!0};var he=dt[Y];return Y++,{value:[xe++,he],done:!1}})},"undefined"!=typeof Symbol&&(At.prototype[Symbol.iterator]=At.prototype.values),At.prototype.toString=function(){return this.toArray().join(",")},At.prototype.toJSON=function(){return this.toArray()},At.prototype.inspect=function(){var dt=this.toArray();return Object.defineProperty(dt,"constructor",{value:At,enumerable:!1}),dt},"undefined"!=typeof Symbol&&(At.prototype[Symbol.for("nodejs.util.inspect.custom")]=At.prototype.inspect),At.from=function(dt){var Y=new At;return ee(dt,function(xe){Y.enqueue(xe)}),Y},At.of=function(){return At.from(arguments)},Ut.exports=At},7830:Ut=>{var it="undefined"!=typeof ArrayBuffer,et="undefined"!=typeof Symbol;function yt(ee,At){var dt,Y,xe,he,W;if(!ee)throw new Error("obliterator/forEach: invalid iterable.");if("function"!=typeof At)throw new Error("obliterator/forEach: expecting a callback.");if(Array.isArray(ee)||it&&ArrayBuffer.isView(ee)||"string"==typeof ee||"[object Arguments]"===ee.toString())for(xe=0,he=ee.length;xe<he;xe++)At(ee[xe],xe);else if("function"!=typeof ee.forEach)if(et&&Symbol.iterator in ee&&"function"!=typeof ee.next&&(ee=ee[Symbol.iterator]()),"function"!=typeof ee.next)for(Y in ee)ee.hasOwnProperty(Y)&&At(ee[Y],Y);else for(dt=ee,xe=0;!0!==(W=dt.next()).done;)At(W.value,xe),xe++;else ee.forEach(At)}yt.forEachWithNullKeys=function(ee,At){var dt,Y,xe,he,W;if(!ee)throw new Error("obliterator/forEachWithNullKeys: invalid iterable.");if("function"!=typeof At)throw new Error("obliterator/forEachWithNullKeys: expecting a callback.");if(Array.isArray(ee)||it&&ArrayBuffer.isView(ee)||"string"==typeof ee||"[object Arguments]"===ee.toString())for(xe=0,he=ee.length;xe<he;xe++)At(ee[xe],null);else if(ee instanceof Set)ee.forEach(function(j){At(j,null)});else if("function"!=typeof ee.forEach)if(et&&Symbol.iterator in ee&&"function"!=typeof ee.next&&(ee=ee[Symbol.iterator]()),"function"!=typeof ee.next)for(Y in ee)ee.hasOwnProperty(Y)&&At(ee[Y],Y);else for(dt=ee,xe=0;!0!==(W=dt.next()).done;)At(W.value,null),xe++;else ee.forEach(At)},Ut.exports=yt},6284:Ut=>{function it(et){Object.defineProperty(this,"_next",{writable:!1,enumerable:!1,value:et}),this.done=!1}it.prototype.next=function(){if(this.done)return{done:!0};var et=this._next();return et.done&&(this.done=!0),et},"undefined"!=typeof Symbol&&(it.prototype[Symbol.iterator]=function(){return this}),it.of=function(){var et=arguments,yt=et.length,ee=0;return new it(function(){return ee>=yt?{done:!0}:{done:!1,value:et[ee++]}})},it.empty=function(){var et=new it(null);return et.done=!0,et},it.is=function(et){return et instanceof it||"object"==typeof et&&null!==et&&"function"==typeof et.next},Ut.exports=it},7310:(Ut,it,et)=>{"use strict";var yt=et(1948);Object.defineProperty(it,"__esModule",{value:!0}),it.isMobile=function(){return void 0!==ee.window.orientation},it.default=function(he){if(!he&&!(0,At.default)())return"Node";if((0,dt.default)(he))return"Electron";var W="undefined"!=typeof navigator?navigator:{},j=he||W.userAgent||"";if(j.indexOf("Edge")>-1)return"Edge";var F=-1!==j.indexOf("MSIE "),Q=-1!==j.indexOf("Trident/");return F||Q?"IE":ee.window.chrome?"Chrome":ee.window.safari?"Safari":ee.window.mozInnerScreenX?"Firefox":"Unknown"};var ee=et(1151),At=yt(et(1602)),dt=yt(et(2344))},1151:(Ut,it,et)=>{"use strict";var yt=et(1948);Object.defineProperty(it,"__esModule",{value:!0}),it.console=it.process=it.document=it.global=it.window=it.self=void 0;var ee=yt(et(4321)),At={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document,process:"object"===("undefined"==typeof process?"undefined":(0,ee.default)(process))&&process};it.self=At.self||At.window||At.global,it.window=At.window||At.self||At.global,it.global=At.global||At.self||At.window,it.document=At.document||{},it.process=At.process||{};var j=console;it.console=j},4761:(Ut,it,et)=>{"use strict";var ee=et(1948),At=et(4321);Object.defineProperty(it,"CO",{enumerable:!0,get:function(){return dt.global}}),Object.defineProperty(it,"qs",{enumerable:!0,get:function(){return xe.default}});var dt=et(1151),xe=(j(et(1602)),j(et(7310)));ee(et(2344));function W(F){if("function"!=typeof WeakMap)return null;var Q=new WeakMap,H=new WeakMap;return(W=function(C){return C?H:Q})(F)}function j(F,Q){if(!Q&&F&&F.__esModule)return F;if(null===F||"object"!==At(F)&&"function"!=typeof F)return{default:F};var H=W(Q);if(H&&H.has(F))return H.get(F);var b={},C=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var R in F)if("default"!==R&&Object.prototype.hasOwnProperty.call(F,R)){var T=C?Object.getOwnPropertyDescriptor(F,R):null;T&&(T.get||T.set)?Object.defineProperty(b,R,T):b[R]=F[R]}return b.default=F,H&&H.set(F,b),b}},1602:(Ut,it,et)=>{"use strict";var yt=et(1948);Object.defineProperty(it,"__esModule",{value:!0}),it.default=dt,it.isBrowserMainThread=function(){return dt()&&"undefined"!=typeof document};var ee=yt(et(4321)),At=yt(et(2344));function dt(){return!("object"===("undefined"==typeof process?"undefined":(0,ee.default)(process))&&"[object process]"===String(process)&&!process.browser)||(0,At.default)()}},2344:(Ut,it,et)=>{"use strict";var yt=et(1948);Object.defineProperty(it,"__esModule",{value:!0}),it.default=function(dt){if("undefined"!=typeof window&&"object"===(0,ee.default)(window.process)&&"renderer"===window.process.type||"undefined"!=typeof process&&"object"===(0,ee.default)(process.versions)&&Boolean(process.versions.electron))return!0;var Y="object"===("undefined"==typeof navigator?"undefined":(0,ee.default)(navigator))&&"string"==typeof navigator.userAgent&&navigator.userAgent,xe=dt||Y;return!!(xe&&xe.indexOf("Electron")>=0)};var ee=yt(et(4321))},6991:function(Ut,it,et){"use strict";var yt=this&&this.__createBinding||(Object.create?function(At,dt,Y,xe){void 0===xe&&(xe=Y),Object.defineProperty(At,xe,{enumerable:!0,get:function(){return dt[Y]}})}:function(At,dt,Y,xe){void 0===xe&&(xe=Y),At[xe]=dt[Y]}),ee=this&&this.__exportStar||function(At,dt){for(var Y in At)"default"!==Y&&!Object.prototype.hasOwnProperty.call(dt,Y)&&yt(dt,At,Y)};Object.defineProperty(it,"__esModule",{value:!0}),ee(et(4180),it),ee(et(5103),it),ee(et(8965),it),ee(et(2595),it),ee(et(2417),it),ee(et(2451),it),ee(et(7735),it)},4180:(Ut,it)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.BlankNode=void 0,it.BlankNode=class{constructor(ee){this.termType="BlankNode",this.value=ee}equals(ee){return!!ee&&"BlankNode"===ee.termType&&ee.value===this.value}}},5103:(Ut,it,et)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.DataFactory=void 0;const yt=et(4180),ee=et(8965),At=et(2595),dt=et(2417),Y=et(2451),xe=et(7735);let he=0;it.DataFactory=class{constructor(F){this.blankNodeCounter=0,this.blankNodePrefix=(F=F||{}).blankNodePrefix||`df_${he++}_`}namedNode(F){return new dt.NamedNode(F)}blankNode(F){return new yt.BlankNode(F||`${this.blankNodePrefix}${this.blankNodeCounter++}`)}literal(F,Q){return new At.Literal(F,Q)}variable(F){return new xe.Variable(F)}defaultGraph(){return ee.DefaultGraph.INSTANCE}quad(F,Q,H,b){return new Y.Quad(F,Q,H,b||this.defaultGraph())}fromTerm(F){switch(F.termType){case"NamedNode":return this.namedNode(F.value);case"BlankNode":return this.blankNode(F.value);case"Literal":return F.language?this.literal(F.value,F.language):F.datatype.equals(At.Literal.XSD_STRING)?this.literal(F.value):this.literal(F.value,this.fromTerm(F.datatype));case"Variable":return this.variable(F.value);case"DefaultGraph":return this.defaultGraph();case"Quad":return this.quad(this.fromTerm(F.subject),this.fromTerm(F.predicate),this.fromTerm(F.object),this.fromTerm(F.graph))}}fromQuad(F){return this.fromTerm(F)}resetBlankNodeCounter(){this.blankNodeCounter=0}}},8965:(Ut,it)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.DefaultGraph=void 0;class et{constructor(){this.termType="DefaultGraph",this.value=""}equals(ee){return!!ee&&"DefaultGraph"===ee.termType}}it.DefaultGraph=et,et.INSTANCE=new et},2595:(Ut,it,et)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.Literal=void 0;const yt=et(2417);class ee{constructor(dt,Y){this.termType="Literal",this.value=dt,"string"==typeof Y?(this.language=Y,this.datatype=ee.RDF_LANGUAGE_STRING):Y?(this.language="",this.datatype=Y):(this.language="",this.datatype=ee.XSD_STRING)}equals(dt){return!!dt&&"Literal"===dt.termType&&dt.value===this.value&&dt.language===this.language&&dt.datatype.equals(this.datatype)}}it.Literal=ee,ee.RDF_LANGUAGE_STRING=new yt.NamedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"),ee.XSD_STRING=new yt.NamedNode("http://www.w3.org/2001/XMLSchema#string")},2417:(Ut,it)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.NamedNode=void 0,it.NamedNode=class{constructor(ee){this.termType="NamedNode",this.value=ee}equals(ee){return!!ee&&"NamedNode"===ee.termType&&ee.value===this.value}}},2451:(Ut,it)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.Quad=void 0,it.Quad=class{constructor(ee,At,dt,Y){this.termType="Quad",this.value="",this.subject=ee,this.predicate=At,this.object=dt,this.graph=Y}equals(ee){return!!ee&&("Quad"===ee.termType||!ee.termType)&&this.subject.equals(ee.subject)&&this.predicate.equals(ee.predicate)&&this.object.equals(ee.object)&&this.graph.equals(ee.graph)}}},7735:(Ut,it)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.Variable=void 0,it.Variable=class{constructor(ee){this.termType="Variable",this.value=ee}equals(ee){return!!ee&&"Variable"===ee.termType&&ee.value===this.value}}},1609:function(Ut,it,et){"use strict";var yt=this&&this.__createBinding||(Object.create?function(b,C,R,T){void 0===T&&(T=R),Object.defineProperty(b,T,{enumerable:!0,get:function(){return C[R]}})}:function(b,C,R,T){void 0===T&&(T=R),b[T]=C[R]}),ee=this&&this.__exportStar||function(b,C){for(var R in b)"default"!==R&&!Object.prototype.hasOwnProperty.call(C,R)&&yt(C,b,R)};Object.defineProperty(it,"__esModule",{value:!0}),it.getSupportedJavaScriptPrimitives=it.getSupportedRdfDatatypes=it.getTermRaw=it.toRdf=it.fromRdf=void 0;const At=et(6991),dt=et(9938),Y=et(6060);ee(et(9938),it),ee(et(8871),it),ee(et(6060),it);const xe=new At.DataFactory,he=new Y.Translator;function W(b,C){return he.fromRdf(b,C)}he.registerHandler(new dt.TypeHandlerString,dt.TypeHandlerString.TYPES.map(b=>xe.namedNode(b)),["string"]),he.registerHandler(new dt.TypeHandlerBoolean,[dt.TypeHandlerBoolean.TYPE].map(b=>xe.namedNode(b)),["boolean"]),he.registerHandler(new dt.TypeHandlerNumberDouble,dt.TypeHandlerNumberDouble.TYPES.map(b=>xe.namedNode(b)),["number"]),he.registerHandler(new dt.TypeHandlerNumberInteger,dt.TypeHandlerNumberInteger.TYPES.map(b=>xe.namedNode(b)),["number"]),he.registerHandler(new dt.TypeHandlerDate,dt.TypeHandlerDate.TYPES.map(b=>xe.namedNode(b)),["object"]),it.fromRdf=W,it.toRdf=function(b,C){return C&&"namedNode"in C&&(C={dataFactory:C}),(C=C||{})&&!C.dataFactory&&(C.dataFactory=xe),he.toRdf(b,C)},it.getTermRaw=function(b,C){return"Literal"===b.termType?W(b,C):b.value},it.getSupportedRdfDatatypes=function(){return he.getSupportedRdfDatatypes()},it.getSupportedJavaScriptPrimitives=function(){return he.getSupportedJavaScriptPrimitives()}},8871:(Ut,it)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0})},6060:(Ut,it)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.Translator=void 0,it.Translator=class{constructor(){this.supportedRdfDatatypes=[],this.fromRdfHandlers={},this.toRdfHandlers={}}static incorrectRdfDataType(ee){throw new Error(`Invalid RDF ${ee.datatype.value} value: '${ee.value}'`)}registerHandler(ee,At,dt){for(const Y of At)this.supportedRdfDatatypes.push(Y),this.fromRdfHandlers[Y.value]=ee;for(const Y of dt){let xe=this.toRdfHandlers[Y];xe||(this.toRdfHandlers[Y]=xe=[]),xe.push(ee)}}fromRdf(ee,At){const dt=this.fromRdfHandlers[ee.datatype.value];return dt?dt.fromRdf(ee,At):ee.value}toRdf(ee,At){const dt=this.toRdfHandlers[typeof ee];if(dt)for(const Y of dt){const xe=Y.toRdf(ee,At);if(xe)return xe}throw new Error(`Invalid JavaScript value: '${ee}'`)}getSupportedRdfDatatypes(){return this.supportedRdfDatatypes}getSupportedJavaScriptPrimitives(){return Object.keys(this.toRdfHandlers)}}},727:(Ut,it,et)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.TypeHandlerBoolean=void 0;const yt=et(6060);class ee{fromRdf(dt,Y){switch(dt.value){case"true":return!0;case"false":return!1;case"1":return!0;case"0":return!1}return Y&&yt.Translator.incorrectRdfDataType(dt),!1}toRdf(dt,{datatype:Y,dataFactory:xe}){return xe.literal(dt?"true":"false",Y||xe.namedNode(ee.TYPE))}}it.TypeHandlerBoolean=ee,ee.TYPE="http://www.w3.org/2001/XMLSchema#boolean"},2525:(Ut,it,et)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.TypeHandlerDate=void 0;const yt=et(6060);class ee{fromRdf(dt,Y){switch(Y&&!dt.value.match(ee.VALIDATORS[dt.datatype.value.substr(33,dt.datatype.value.length)])&&yt.Translator.incorrectRdfDataType(dt),dt.datatype.value){case"http://www.w3.org/2001/XMLSchema#gDay":return new Date(0,0,parseInt(dt.value,10));case"http://www.w3.org/2001/XMLSchema#gMonthDay":const xe=dt.value.split("-");return new Date(0,parseInt(xe[0],10)-1,parseInt(xe[1],10));case"http://www.w3.org/2001/XMLSchema#gYear":return new Date(dt.value+"-01-01");case"http://www.w3.org/2001/XMLSchema#gYearMonth":return new Date(dt.value+"-01");default:return new Date(dt.value)}}toRdf(dt,{datatype:Y,dataFactory:xe}){if(Y=Y||xe.namedNode(ee.TYPES[0]),!(dt instanceof Date))return null;const he=dt;let W;switch(Y.value){case"http://www.w3.org/2001/XMLSchema#gDay":W=String(he.getUTCDate());break;case"http://www.w3.org/2001/XMLSchema#gMonthDay":W=he.getUTCMonth()+1+"-"+he.getUTCDate();break;case"http://www.w3.org/2001/XMLSchema#gYear":W=String(he.getUTCFullYear());break;case"http://www.w3.org/2001/XMLSchema#gYearMonth":W=he.getUTCFullYear()+"-"+(he.getUTCMonth()+1);break;case"http://www.w3.org/2001/XMLSchema#date":W=he.toISOString().replace(/T.*$/,"");break;default:W=he.toISOString()}return xe.literal(W,Y)}}it.TypeHandlerDate=ee,ee.TYPES=["http://www.w3.org/2001/XMLSchema#dateTime","http://www.w3.org/2001/XMLSchema#date","http://www.w3.org/2001/XMLSchema#gDay","http://www.w3.org/2001/XMLSchema#gMonthDay","http://www.w3.org/2001/XMLSchema#gYear","http://www.w3.org/2001/XMLSchema#gYearMonth"],ee.VALIDATORS={date:/^[0-9]+-[0-9][0-9]-[0-9][0-9]Z?$/,dateTime:/^[0-9]+-[0-9][0-9]-[0-9][0-9]T[0-9][0-9]:[0-9][0-9]:[0-9][0-9](\.[0-9][0-9][0-9])?((Z?)|([\+-][0-9][0-9]:[0-9][0-9]))$/,gDay:/^[0-9]+$/,gMonthDay:/^[0-9]+-[0-9][0-9]$/,gYear:/^[0-9]+$/,gYearMonth:/^[0-9]+-[0-9][0-9]$/}},8554:(Ut,it,et)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.TypeHandlerNumberDouble=void 0;const yt=et(6060);class ee{fromRdf(dt,Y){const xe=parseFloat(dt.value);return Y&&isNaN(xe)&&yt.Translator.incorrectRdfDataType(dt),xe}toRdf(dt,{datatype:Y,dataFactory:xe}){return Y=Y||xe.namedNode(ee.TYPES[0]),isNaN(dt)?xe.literal("NaN",Y):isFinite(dt)?dt%1==0?null:xe.literal(dt.toExponential(15).replace(/(\d)0*e\+?/,"$1E"),Y):xe.literal(dt>0?"INF":"-INF",Y)}}it.TypeHandlerNumberDouble=ee,ee.TYPES=["http://www.w3.org/2001/XMLSchema#double","http://www.w3.org/2001/XMLSchema#decimal","http://www.w3.org/2001/XMLSchema#float"]},7750:(Ut,it,et)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.TypeHandlerNumberInteger=void 0;const yt=et(6060);class ee{fromRdf(dt,Y){const xe=parseInt(dt.value,10);return Y&&(isNaN(xe)||dt.value.indexOf(".")>=0)&&yt.Translator.incorrectRdfDataType(dt),xe}toRdf(dt,{datatype:Y,dataFactory:xe}){return xe.literal(String(dt),Y||xe.namedNode(dt<=ee.MAX_INT&&dt>=ee.MIN_INT?ee.TYPES[0]:ee.TYPES[1]))}}it.TypeHandlerNumberInteger=ee,ee.TYPES=["http://www.w3.org/2001/XMLSchema#integer","http://www.w3.org/2001/XMLSchema#long","http://www.w3.org/2001/XMLSchema#int","http://www.w3.org/2001/XMLSchema#byte","http://www.w3.org/2001/XMLSchema#short","http://www.w3.org/2001/XMLSchema#negativeInteger","http://www.w3.org/2001/XMLSchema#nonNegativeInteger","http://www.w3.org/2001/XMLSchema#nonPositiveInteger","http://www.w3.org/2001/XMLSchema#positiveInteger","http://www.w3.org/2001/XMLSchema#unsignedByte","http://www.w3.org/2001/XMLSchema#unsignedInt","http://www.w3.org/2001/XMLSchema#unsignedLong","http://www.w3.org/2001/XMLSchema#unsignedShort"],ee.MAX_INT=2147483647,ee.MIN_INT=-2147483648},4608:(Ut,it)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.TypeHandlerString=void 0;class et{fromRdf(ee){return ee.value}toRdf(ee,{datatype:At,dataFactory:dt}){return dt.literal(ee,At)}}it.TypeHandlerString=et,et.TYPES=["http://www.w3.org/2001/XMLSchema#string","http://www.w3.org/2001/XMLSchema#normalizedString","http://www.w3.org/2001/XMLSchema#anyURI","http://www.w3.org/2001/XMLSchema#base64Binary","http://www.w3.org/2001/XMLSchema#language","http://www.w3.org/2001/XMLSchema#Name","http://www.w3.org/2001/XMLSchema#NCName","http://www.w3.org/2001/XMLSchema#NMTOKEN","http://www.w3.org/2001/XMLSchema#token","http://www.w3.org/2001/XMLSchema#hexBinary","http://www.w3.org/1999/02/22-rdf-syntax-ns#langString","http://www.w3.org/2001/XMLSchema#time","http://www.w3.org/2001/XMLSchema#duration"]},9938:function(Ut,it,et){"use strict";var yt=this&&this.__createBinding||(Object.create?function(At,dt,Y,xe){void 0===xe&&(xe=Y),Object.defineProperty(At,xe,{enumerable:!0,get:function(){return dt[Y]}})}:function(At,dt,Y,xe){void 0===xe&&(xe=Y),At[xe]=dt[Y]}),ee=this&&this.__exportStar||function(At,dt){for(var Y in At)"default"!==Y&&!Object.prototype.hasOwnProperty.call(dt,Y)&&yt(dt,At,Y)};Object.defineProperty(it,"__esModule",{value:!0}),ee(et(727),it),ee(et(2525),it),ee(et(8554),it),ee(et(7750),it),ee(et(4608),it)},4668:(Ut,it,et)=>{"use strict";var yt={};et.r(yt),et.d(yt,{decode:()=>Qge,encode:()=>Zge});var ee={};et.r(ee),et.d(ee,{decode:()=>ime,encode:()=>rme});var At={};et.r(At),et.d(At,{decode:()=>sme,encode:()=>ome});var dt={};function Y(n){return"function"==typeof n}et.r(dt),et.d(dt,{decode:()=>ame,encode:()=>lme});let xe=!1;const he={Promise:void 0,set useDeprecatedSynchronousErrorHandling(n){if(n){const e=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+e.stack)}else xe&&console.log("RxJS: Back to a better error behavior. Thank you. <3");xe=n},get useDeprecatedSynchronousErrorHandling(){return xe}};function W(n){setTimeout(()=>{throw n},0)}const j={closed:!0,next(n){},error(n){if(he.useDeprecatedSynchronousErrorHandling)throw n;W(n)},complete(){}},F=Array.isArray||(n=>n&&"number"==typeof n.length);function Q(n){return null!==n&&"object"==typeof n}const b=(()=>{function n(e){return Error.call(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((t,i)=>`${i+1}) ${t.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e,this}return n.prototype=Object.create(Error.prototype),n})();class C{constructor(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._ctorUnsubscribe=!0,this._unsubscribe=e)}unsubscribe(){let e;if(this.closed)return;let{_parentOrParents:t,_ctorUnsubscribe:i,_unsubscribe:r,_subscriptions:s}=this;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,t instanceof C)t.remove(this);else if(null!==t)for(let o=0;o<t.length;++o)t[o].remove(this);if(Y(r)){i&&(this._unsubscribe=void 0);try{r.call(this)}catch(o){e=o instanceof b?R(o.errors):[o]}}if(F(s)){let o=-1,a=s.length;for(;++o<a;){const l=s[o];if(Q(l))try{l.unsubscribe()}catch(c){e=e||[],c instanceof b?e=e.concat(R(c.errors)):e.push(c)}}}if(e)throw new b(e)}add(e){let t=e;if(!e)return C.EMPTY;switch(typeof e){case"function":t=new C(e);case"object":if(t===this||t.closed||"function"!=typeof t.unsubscribe)return t;if(this.closed)return t.unsubscribe(),t;if(!(t instanceof C)){const s=t;t=new C,t._subscriptions=[s]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}let{_parentOrParents:i}=t;if(null===i)t._parentOrParents=this;else if(i instanceof C){if(i===this)return t;t._parentOrParents=[i,this]}else{if(-1!==i.indexOf(this))return t;i.push(this)}const r=this._subscriptions;return null===r?this._subscriptions=[t]:r.push(t),t}remove(e){const t=this._subscriptions;if(t){const i=t.indexOf(e);-1!==i&&t.splice(i,1)}}}var n;function R(n){return n.reduce((e,t)=>e.concat(t instanceof b?t.errors:t),[])}C.EMPTY=((n=new C).closed=!0,n);const T="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random();class y extends C{constructor(e,t,i){switch(super(),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=j;break;case 1:if(!e){this.destination=j;break}if("object"==typeof e){e instanceof y?(this.syncErrorThrowable=e.syncErrorThrowable,this.destination=e,e.add(this)):(this.syncErrorThrowable=!0,this.destination=new x(this,e));break}default:this.syncErrorThrowable=!0,this.destination=new x(this,e,t,i)}}[T](){return this}static create(e,t,i){const r=new y(e,t,i);return r.syncErrorThrowable=!1,r}next(e){this.isStopped||this._next(e)}error(e){this.isStopped||(this.isStopped=!0,this._error(e))}complete(){this.isStopped||(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe())}_next(e){this.destination.next(e)}_error(e){this.destination.error(e),this.unsubscribe()}_complete(){this.destination.complete(),this.unsubscribe()}_unsubscribeAndRecycle(){const{_parentOrParents:e}=this;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this}}class x extends y{constructor(e,t,i,r){super(),this._parentSubscriber=e;let s,o=this;Y(t)?s=t:t&&(s=t.next,i=t.error,r=t.complete,t!==j&&(o=Object.create(t),Y(o.unsubscribe)&&this.add(o.unsubscribe.bind(o)),o.unsubscribe=this.unsubscribe.bind(this))),this._context=o,this._next=s,this._error=i,this._complete=r}next(e){if(!this.isStopped&&this._next){const{_parentSubscriber:t}=this;he.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}}error(e){if(!this.isStopped){const{_parentSubscriber:t}=this,{useDeprecatedSynchronousErrorHandling:i}=he;if(this._error)i&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)i?(t.syncErrorValue=e,t.syncErrorThrown=!0):W(e),this.unsubscribe();else{if(this.unsubscribe(),i)throw e;W(e)}}}complete(){if(!this.isStopped){const{_parentSubscriber:e}=this;if(this._complete){const t=()=>this._complete.call(this._context);he.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,t),this.unsubscribe()):(this.__tryOrUnsub(t),this.unsubscribe())}else this.unsubscribe()}}__tryOrUnsub(e,t){try{e.call(this._context,t)}catch(i){if(this.unsubscribe(),he.useDeprecatedSynchronousErrorHandling)throw i;W(i)}}__tryOrSetError(e,t,i){if(!he.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,i)}catch(r){return he.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=r,e.syncErrorThrown=!0,!0):(W(r),!0)}return!1}_unsubscribe(){const{_parentSubscriber:e}=this;this._context=null,this._parentSubscriber=null,e.unsubscribe()}}const N="function"==typeof Symbol&&Symbol.observable||"@@observable";function K(n){return n}let O=(()=>{class n{constructor(t){this._isScalar=!1,t&&(this._subscribe=t)}lift(t){const i=new n;return i.source=this,i.operator=t,i}subscribe(t,i,r){const{operator:s}=this,o=function(n,e,t){if(n){if(n instanceof y)return n;if(n[T])return n[T]()}return n||e||t?new y(n,e,t):new y(j)}(t,i,r);if(o.add(s?s.call(o,this.source):this.source||he.useDeprecatedSynchronousErrorHandling&&!o.syncErrorThrowable?this._subscribe(o):this._trySubscribe(o)),he.useDeprecatedSynchronousErrorHandling&&o.syncErrorThrowable&&(o.syncErrorThrowable=!1,o.syncErrorThrown))throw o.syncErrorValue;return o}_trySubscribe(t){try{return this._subscribe(t)}catch(i){he.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=i),function(n){for(;n;){const{closed:e,destination:t,isStopped:i}=n;if(e||i)return!1;n=t&&t instanceof y?t:null}return!0}(t)?t.error(i):console.warn(i)}}forEach(t,i){return new(i=X(i))((r,s)=>{let o;o=this.subscribe(a=>{try{t(a)}catch(l){s(l),o&&o.unsubscribe()}},s,r)})}_subscribe(t){const{source:i}=this;return i&&i.subscribe(t)}[N](){return this}pipe(...t){return 0===t.length?this:function(n){return 0===n.length?K:1===n.length?n[0]:function(t){return n.reduce((i,r)=>r(i),t)}}(t)(this)}toPromise(t){return new(t=X(t))((i,r)=>{let s;this.subscribe(o=>s=o,o=>r(o),()=>i(s))})}}return n.create=e=>new n(e),n})();function X(n){if(n||(n=he.Promise||Promise),!n)throw new Error("no Promise impl found");return n}const $=(()=>{function n(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return n.prototype=Object.create(Error.prototype),n})();class Z extends C{constructor(e,t){super(),this.subject=e,this.subscriber=t,this.closed=!1}unsubscribe(){if(this.closed)return;this.closed=!0;const e=this.subject,t=e.observers;if(this.subject=null,!t||0===t.length||e.isStopped||e.closed)return;const i=t.indexOf(this.subscriber);-1!==i&&t.splice(i,1)}}class ae extends y{constructor(e){super(e),this.destination=e}}let oe=(()=>{class n extends O{constructor(){super(),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}[T](){return new ae(this)}lift(t){const i=new te(this,this);return i.operator=t,i}next(t){if(this.closed)throw new $;if(!this.isStopped){const{observers:i}=this,r=i.length,s=i.slice();for(let o=0;o<r;o++)s[o].next(t)}}error(t){if(this.closed)throw new $;this.hasError=!0,this.thrownError=t,this.isStopped=!0;const{observers:i}=this,r=i.length,s=i.slice();for(let o=0;o<r;o++)s[o].error(t);this.observers.length=0}complete(){if(this.closed)throw new $;this.isStopped=!0;const{observers:t}=this,i=t.length,r=t.slice();for(let s=0;s<i;s++)r[s].complete();this.observers.length=0}unsubscribe(){this.isStopped=!0,this.closed=!0,this.observers=null}_trySubscribe(t){if(this.closed)throw new $;return super._trySubscribe(t)}_subscribe(t){if(this.closed)throw new $;return this.hasError?(t.error(this.thrownError),C.EMPTY):this.isStopped?(t.complete(),C.EMPTY):(this.observers.push(t),new Z(this,t))}asObservable(){const t=new O;return t.source=this,t}}return n.create=(e,t)=>new te(e,t),n})();class te extends oe{constructor(e,t){super(),this.destination=e,this.source=t}next(e){const{destination:t}=this;t&&t.next&&t.next(e)}error(e){const{destination:t}=this;t&&t.error&&this.destination.error(e)}complete(){const{destination:e}=this;e&&e.complete&&this.destination.complete()}_subscribe(e){const{source:t}=this;return t?this.source.subscribe(e):C.EMPTY}}function Ce(n){return n&&"function"==typeof n.schedule}function me(n,e){return function(i){if("function"!=typeof n)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return i.lift(new ne(n,e))}}class ne{constructor(e,t){this.project=e,this.thisArg=t}call(e,t){return t.subscribe(new ye(e,this.project,this.thisArg))}}class ye extends y{constructor(e,t,i){super(e),this.project=t,this.count=0,this.thisArg=i||this}_next(e){let t;try{t=this.project.call(this.thisArg,e,this.count++)}catch(i){return void this.destination.error(i)}this.destination.next(t)}}const Oe=n=>e=>{for(let t=0,i=n.length;t<i&&!e.closed;t++)e.next(n[t]);e.complete()},Qe="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator",ke=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function Xe(n){return!!n&&"function"!=typeof n.subscribe&&"function"==typeof n.then}const Ae=n=>{if(n&&"function"==typeof n[N])return(n=>e=>{const t=n[N]();if("function"!=typeof t.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return t.subscribe(e)})(n);if(ke(n))return Oe(n);if(Xe(n))return(n=>e=>(n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,W),e))(n);if(n&&"function"==typeof n[Qe])return(n=>e=>{const t=n[Qe]();for(;;){let i;try{i=t.next()}catch(r){return e.error(r),e}if(i.done){e.complete();break}if(e.next(i.value),e.closed)break}return"function"==typeof t.return&&e.add(()=>{t.return&&t.return()}),e})(n);{const t=`You provided ${Q(n)?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.`;throw new TypeError(t)}};function Fe(n,e){return new O(t=>{const i=new C;let r=0;return i.add(e.schedule(function(){r!==n.length?(t.next(n[r++]),t.closed||i.add(this.schedule())):t.complete()})),i})}function je(n,e){return e?function(n,e){if(null!=n){if(function(n){return n&&"function"==typeof n[N]}(n))return function(n,e){return new O(t=>{const i=new C;return i.add(e.schedule(()=>{const r=n[N]();i.add(r.subscribe({next(s){i.add(e.schedule(()=>t.next(s)))},error(s){i.add(e.schedule(()=>t.error(s)))},complete(){i.add(e.schedule(()=>t.complete()))}}))})),i})}(n,e);if(Xe(n))return function(n,e){return new O(t=>{const i=new C;return i.add(e.schedule(()=>n.then(r=>{i.add(e.schedule(()=>{t.next(r),i.add(e.schedule(()=>t.complete()))}))},r=>{i.add(e.schedule(()=>t.error(r)))}))),i})}(n,e);if(ke(n))return Fe(n,e);if(function(n){return n&&"function"==typeof n[Qe]}(n)||"string"==typeof n)return function(n,e){if(!n)throw new Error("Iterable cannot be null");return new O(t=>{const i=new C;let r;return i.add(()=>{r&&"function"==typeof r.return&&r.return()}),i.add(e.schedule(()=>{r=n[Qe](),i.add(e.schedule(function(){if(t.closed)return;let s,o;try{const a=r.next();s=a.value,o=a.done}catch(a){return void t.error(a)}o?t.complete():(t.next(s),this.schedule())}))})),i})}(n,e)}throw new TypeError((null!==n&&typeof n||n)+" is not observable")}(n,e):n instanceof O?n:new O(Ae(n))}class _t extends y{constructor(e){super(),this.parent=e}_next(e){this.parent.notifyNext(e)}_error(e){this.parent.notifyError(e),this.unsubscribe()}_complete(){this.parent.notifyComplete(),this.unsubscribe()}}class we extends y{notifyNext(e){this.destination.next(e)}notifyError(e){this.destination.error(e)}notifyComplete(){this.destination.complete()}}function P(n,e){if(e.closed)return;if(n instanceof O)return n.subscribe(e);let t;try{t=Ae(n)(e)}catch(i){e.error(i)}return t}function V(n,e,t=Number.POSITIVE_INFINITY){return"function"==typeof e?i=>i.pipe(V((r,s)=>je(n(r,s)).pipe(me((o,a)=>e(r,o,s,a))),t)):("number"==typeof e&&(t=e),i=>i.lift(new Re(n,t)))}class Re{constructor(e,t=Number.POSITIVE_INFINITY){this.project=e,this.concurrent=t}call(e,t){return t.subscribe(new Ze(e,this.project,this.concurrent))}}class Ze extends we{constructor(e,t,i=Number.POSITIVE_INFINITY){super(e),this.project=t,this.concurrent=i,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}_next(e){this.active<this.concurrent?this._tryNext(e):this.buffer.push(e)}_tryNext(e){let t;const i=this.index++;try{t=this.project(e,i)}catch(r){return void this.destination.error(r)}this.active++,this._innerSub(t)}_innerSub(e){const t=new _t(this),i=this.destination;i.add(t);const r=P(e,t);r!==t&&i.add(r)}_complete(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}notifyNext(e){this.destination.next(e)}notifyComplete(){const e=this.buffer;this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}function Rt(n=Number.POSITIVE_INFINITY){return V(K,n)}function Mn(n,e){return e?Fe(n,e):new O(Oe(n))}function Nn(...n){let e=Number.POSITIVE_INFINITY,t=null,i=n[n.length-1];return Ce(i)?(t=n.pop(),n.length>1&&"number"==typeof n[n.length-1]&&(e=n.pop())):"number"==typeof i&&(e=n.pop()),null===t&&1===n.length&&n[0]instanceof O?n[0]:Rt(e)(Mn(n,t))}function $n(){return function(e){return e.lift(new bi(e))}}class bi{constructor(e){this.connectable=e}call(e,t){const{connectable:i}=this;i._refCount++;const r=new fi(e,i),s=t.subscribe(r);return r.closed||(r.connection=i.connect()),s}}class fi extends y{constructor(e,t){super(e),this.connectable=t}_unsubscribe(){const{connectable:e}=this;if(!e)return void(this.connection=null);this.connectable=null;const t=e._refCount;if(t<=0)return void(this.connection=null);if(e._refCount=t-1,t>1)return void(this.connection=null);const{connection:i}=this,r=e._connection;this.connection=null,r&&(!i||r===i)&&r.unsubscribe()}}class Gr extends O{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._refCount=0,this._isComplete=!1}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}connect(){let e=this._connection;return e||(this._isComplete=!1,e=this._connection=new C,e.add(this.source.subscribe(new ds(this.getSubject(),this))),e.closed&&(this._connection=null,e=C.EMPTY)),e}refCount(){return $n()(this)}}const Ps=(()=>{const n=Gr.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:n._subscribe},_isComplete:{value:n._isComplete,writable:!0},getSubject:{value:n.getSubject},connect:{value:n.connect},refCount:{value:n.refCount}}})();class ds extends ae{constructor(e,t){super(e),this.connectable=t}_error(e){this._unsubscribe(),super._error(e)}_complete(){this.connectable._isComplete=!0,this._unsubscribe(),super._complete()}_unsubscribe(){const e=this.connectable;if(e){this.connectable=null;const t=e._connection;e._refCount=0,e._subject=null,e._connection=null,t&&t.unsubscribe()}}}function _a(n,e){return function(i){let r;if(r="function"==typeof n?n:function(){return n},"function"==typeof e)return i.lift(new Ml(r,e));const s=Object.create(i,Ps);return s.source=i,s.subjectFactory=r,s}}class Ml{constructor(e,t){this.subjectFactory=e,this.selector=t}call(e,t){const{selector:i}=this,r=this.subjectFactory(),s=i(r).subscribe(e);return s.add(t.subscribe(r)),s}}function ya(){return new oe}function ys(){return n=>$n()(_a(ya)(n))}function Jt(n){for(let e in n)if(n[e]===Jt)return e;throw Error("Could not find renamed property on target object.")}function Ka(n,e){for(const t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function rt(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(rt).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const e=n.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function lt(n,e){return null==n||""===n?null===e?"":e:null==e||""===e?n:n+" "+e}const ht=Jt({__forward_ref__:Jt});function ge(n){return n.__forward_ref__=ge,n.toString=function(){return rt(this())},n}function be(n){return Be(n)?n():n}function Be(n){return"function"==typeof n&&n.hasOwnProperty(ht)&&n.__forward_ref__===ge}class Je extends Error{constructor(e,t){super(function(n,e){return`${n?`NG0${n}: `:""}${e}`}(e,t)),this.code=e}}function Dt(n){return"string"==typeof n?n:null==n?"":String(n)}function Xt(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():Dt(n)}function gn(n,e){const t=e?` in ${e}`:"";throw new Je("201",`No provider for ${Xt(n)} found${t}`)}function J(n,e){null==n&&function(n,e,t,i){throw new Error(`ASSERTION ERROR: ${n}`+(null==i?"":` [Expected=> ${t} ${i} ${e} <=Actual]`))}(e,n,null,"!=")}function We(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function Ct(n){return{providers:n.providers||[],imports:n.imports||[]}}function mn(n){return vs(n,co)||vs(n,Ls)}function vs(n,e){return n.hasOwnProperty(e)?n[e]:null}function Dl(n){return n&&(n.hasOwnProperty(Fr)||n.hasOwnProperty(bc))?n[Fr]:null}const co=Jt({\u0275prov:Jt}),Fr=Jt({\u0275inj:Jt}),Ls=Jt({ngInjectableDef:Jt}),bc=Jt({ngInjectorDef:Jt});var bn=(()=>((bn=bn||{})[bn.Default=0]="Default",bn[bn.Host=1]="Host",bn[bn.Self=2]="Self",bn[bn.SkipSelf=4]="SkipSelf",bn[bn.Optional=8]="Optional",bn))();let uo;function ba(n){const e=uo;return uo=n,e}function md(n,e,t){const i=mn(n);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:t&bn.Optional?null:void 0!==e?e:void gn(rt(n),"Injector")}function Me(n){return{toString:n}.toString()}var Ge=(()=>((Ge=Ge||{})[Ge.OnPush=0]="OnPush",Ge[Ge.Default=1]="Default",Ge))(),Yt=(()=>((Yt=Yt||{})[Yt.Emulated=0]="Emulated",Yt[Yt.None=2]="None",Yt[Yt.ShadowDom=3]="ShadowDom",Yt))();const ri="undefined"!=typeof globalThis&&globalThis,Lr="undefined"!=typeof window&&window,Yr="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,bs="undefined"!=typeof global&&global,ti=ri||bs||Lr||Yr,_d={},Zi=[],op=Jt({\u0275cmp:Jt}),Ym=Jt({\u0275dir:Jt}),Th=Jt({\u0275pipe:Jt}),Yv=Jt({\u0275mod:Jt}),gT=Jt({\u0275loc:Jt}),Ol=Jt({\u0275fac:Jt}),Ah=Jt({__NG_ELEMENT_ID__:Jt});let mT=0;function _n(n){return Me(()=>{const t={},i={type:n.type,providersResolver:null,decls:n.decls,vars:n.vars,factory:null,template:n.template||null,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:t,inputs:null,outputs:null,exportAs:n.exportAs||null,onPush:n.changeDetection===Ge.OnPush,directiveDefs:null,pipeDefs:null,selectors:n.selectors||Zi,viewQuery:n.viewQuery||null,features:n.features||null,data:n.data||{},encapsulation:n.encapsulation||Yt.Emulated,id:"c",styles:n.styles||Zi,_:null,setInput:null,schemas:n.schemas||null,tView:null},r=n.directives,s=n.features,o=n.pipes;return i.id+=mT++,i.inputs=Zv(n.inputs,t),i.outputs=Zv(n.outputs),s&&s.forEach(a=>a(i)),i.directiveDefs=r?()=>("function"==typeof r?r():r).map(Kv):null,i.pipeDefs=o?()=>("function"==typeof o?o():o).map(Xv):null,i})}function Kv(n){return Li(n)||function(n){return n[Ym]||null}(n)}function Xv(n){return function(n){return n[Th]||null}(n)}const Qv={};function an(n){return Me(()=>{const e={type:n.type,bootstrap:n.bootstrap||Zi,declarations:n.declarations||Zi,imports:n.imports||Zi,exports:n.exports||Zi,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null};return null!=n.id&&(Qv[n.id]=n.type),e})}function Zv(n,e){if(null==n)return _d;const t={};for(const i in n)if(n.hasOwnProperty(i)){let r=n[i],s=r;Array.isArray(r)&&(s=r[1],r=r[0]),t[r]=i,e&&(e[r]=s)}return t}const Bt=_n;function ks(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,onDestroy:n.type.prototype.ngOnDestroy||null}}function Li(n){return n[op]||null}function Ao(n,e){const t=n[Yv]||null;if(!t&&!0===e)throw new Error(`Type ${rt(n)} does not have '\u0275mod' property.`);return t}function Go(n){return Array.isArray(n)&&"object"==typeof n[1]}function $o(n){return Array.isArray(n)&&!0===n[1]}function Qm(n){return 0!=(8&n.flags)}function wd(n){return 2==(2&n.flags)}function Ed(n){return 1==(1&n.flags)}function Sa(n){return null!==n.template}function Jv(n){return 0!=(512&n[2])}function Sc(n,e){return n.hasOwnProperty(Ol)?n[Ol]:null}class t_{constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}}function zi(){return nb}function nb(n){return n.type.prototype.ngOnChanges&&(n.setInput=xT),ST}function ST(){const n=at(this),e=null==n?void 0:n.current;if(e){const t=n.previous;if(t===_d)n.previous=e;else for(let i in e)t[i]=e[i];n.current=null,this.ngOnChanges(e)}}function xT(n,e,t,i){const r=at(n)||function(n,e){return n[Nh]=e}(n,{previous:_d,current:null}),s=r.current||(r.current={}),o=r.previous,a=this.declaredInputs[t],l=o[a];s[a]=new t_(l&&l.currentValue,e,o===_d),n[i]=e}zi.ngInherit=!0;const Nh="__ngSimpleChanges__";function at(n){return n[Nh]||null}let Hi;function ar(n){return!!n.listen}const mu={createRenderer:(n,e)=>void 0!==Hi?Hi:"undefined"!=typeof document?document:void 0};function vr(n){for(;Array.isArray(n);)n=n[0];return n}function Ph(n,e){return vr(e[n])}function Xs(n,e){return vr(e[n.index])}function r_(n,e){return n.data[e]}function Sd(n,e){return n[e]}function Vs(n,e){const t=e[n];return Go(t)?t:t[0]}function Pl(n){return 4==(4&n[2])}function xd(n){return 128==(128&n[2])}function Ca(n,e){return null==e?null:n[e]}function s_(n){n[18]=0}function cp(n,e){n[5]+=e;let t=n,i=n[3];for(;null!==i&&(1===e&&1===t[5]||-1===e&&0===t[5]);)i[5]+=e,t=i,i=i[3]}const Ln={lFrame:yu(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function rb(){return Ln.bindingsEnabled}function Vt(){return Ln.lFrame.lView}function pi(){return Ln.lFrame.tView}function Mr(n){return Ln.lFrame.contextLView=n,n[8]}function is(){let n=o_();for(;null!==n&&64===n.type;)n=n.parent;return n}function o_(){return Ln.lFrame.currentTNode}function Za(n,e){const t=Ln.lFrame;t.currentTNode=n,t.isParent=e}function Vr(){return Ln.lFrame.isParent}function hs(){Ln.lFrame.isParent=!1}function kh(){return Ln.isInCheckNoChangesMode}function dp(n){Ln.isInCheckNoChangesMode=n}function Es(){const n=Ln.lFrame;let e=n.bindingRootIndex;return-1===e&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function Ta(){return Ln.lFrame.bindingIndex++}function Do(n){const e=Ln.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function Cd(n,e){const t=Ln.lFrame;t.bindingIndex=t.bindingRootIndex=n,a_(e)}function a_(n){Ln.lFrame.currentDirectiveIndex=n}function sb(){return Ln.lFrame.currentQueryIndex}function c_(n){Ln.lFrame.currentQueryIndex=n}function fp(n){const e=n[1];return 2===e.type?e.declTNode:1===e.type?n[6]:null}function Td(n,e,t){if(t&bn.SkipSelf){let r=e,s=n;for(;!(r=r.parent,null!==r||t&bn.Host||(r=fp(s),null===r||(s=s[15],10&r.type))););if(null===r)return!1;e=r,n=s}const i=Ln.lFrame=Se();return i.currentTNode=e,i.lView=n,!0}function jh(n){const e=Se(),t=n[1];Ln.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function Se(){const n=Ln.lFrame,e=null===n?null:n.child;return null===e?yu(n):e}function yu(n){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=e),e}function Uh(){const n=Ln.lFrame;return Ln.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const Io=Uh;function ai(){const n=Uh();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function Qs(){return Ln.lFrame.selectedIndex}function po(n){Ln.lFrame.selectedIndex=n}function Dr(){const n=Ln.lFrame;return r_(n.tView,n.selectedIndex)}function pp(n,e){for(let t=e.directiveStart,i=e.directiveEnd;t<i;t++){const s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:u}=s;o&&(n.contentHooks||(n.contentHooks=[])).push(-t,o),a&&((n.contentHooks||(n.contentHooks=[])).push(t,a),(n.contentCheckHooks||(n.contentCheckHooks=[])).push(t,a)),l&&(n.viewHooks||(n.viewHooks=[])).push(-t,l),c&&((n.viewHooks||(n.viewHooks=[])).push(t,c),(n.viewCheckHooks||(n.viewCheckHooks=[])).push(t,c)),null!=u&&(n.destroyHooks||(n.destroyHooks=[])).push(t,u)}}function gp(n,e,t){Ja(n,e,3,t)}function mp(n,e,t,i){(3&n[2])===t&&Ja(n,e,t,i)}function u_(n,e){let t=n[2];(3&t)===e&&(t&=2047,t+=1,n[2]=t)}function Ja(n,e,t,i){const s=null!=i?i:-1,o=e.length-1;let a=0;for(let l=void 0!==i?65535&n[18]:0;l<o;l++)if("number"==typeof e[l+1]){if(a=e[l],null!=i&&a>=i)break}else e[l]<0&&(n[18]+=65536),(a<s||-1==s)&&(BT(n,t,e,l),n[18]=(4294901760&n[18])+l+2),l++}function BT(n,e,t,i){const r=t[i]<0,s=t[i+1],a=n[r?-t[i]:t[i]];if(r){if(n[2]>>11<n[18]>>16&&(3&n[2])===e){n[2]+=2048;try{s.call(a)}finally{}}}else try{s.call(a)}finally{}}class zh{constructor(e,t,i){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=i}}function _p(n,e,t){const i=ar(n);let r=0;for(;r<t.length;){const s=t[r];if("number"==typeof s){if(0!==s)break;r++;const o=t[r++],a=t[r++],l=t[r++];i?n.setAttribute(e,a,l,o):e.setAttributeNS(o,a,l)}else{const o=s,a=t[++r];h_(o)?i&&n.setProperty(e,o,a):i?n.setAttribute(e,o,a):e.setAttribute(o,a),r++}}return r}function ob(n){return 3===n||4===n||6===n}function h_(n){return 64===n.charCodeAt(0)}function Hh(n,e){if(null!==e&&0!==e.length)if(null===n||0===n.length)n=e.slice();else{let t=-1;for(let i=0;i<e.length;i++){const r=e[i];"number"==typeof r?t=r:0===t||f_(n,t,r,null,-1===t||2===t?e[++i]:null)}}return n}function f_(n,e,t,i,r){let s=0,o=n.length;if(-1===e)o=-1;else for(;s<n.length;){const a=n[s++];if("number"==typeof a){if(a===e){o=-1;break}if(a>e){o=s-1;break}}}for(;s<n.length;){const a=n[s];if("number"==typeof a)break;if(a===t){if(null===i)return void(null!==r&&(n[s+1]=r));if(i===n[s+1])return void(n[s+2]=r)}s++,null!==i&&s++,null!==r&&s++}-1!==o&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),null!==i&&n.splice(s++,0,i),null!==r&&n.splice(s++,0,r)}function ab(n){return-1!==n}function Ad(n){return 32767&n}function el(n,e){let t=function(n){return n>>16}(n),i=e;for(;t>0;)i=i[15],t--;return i}let Md=!0;function yp(n){const e=Md;return Md=n,e}let g_=0;function js(n,e){const t=vp(n,e);if(-1!==t)return t;const i=e[1];i.firstCreatePass&&(n.injectorIndex=e.length,m_(i.data,n),m_(e,null),m_(i.blueprint,null));const r=Gh(n,e),s=n.injectorIndex;if(ab(r)){const o=Ad(r),a=el(r,e),l=a[1].data;for(let c=0;c<8;c++)e[s+c]=a[o+c]|l[o+c]}return e[s+8]=r,s}function m_(n,e){n.push(0,0,0,0,0,0,0,0,e)}function vp(n,e){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===e[n.injectorIndex+8]?-1:n.injectorIndex}function Gh(n,e){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let t=0,i=null,r=e;for(;null!==r;){const s=r[1],o=s.type;if(i=2===o?s.declTNode:1===o?r[6]:null,null===i)return-1;if(t++,r=r[15],-1!==i.injectorIndex)return i.injectorIndex|t<<16}return-1}function Cc(n,e,t){!function(n,e,t){let i;"string"==typeof t?i=t.charCodeAt(0)||0:t.hasOwnProperty(Ah)&&(i=t[Ah]),null==i&&(i=t[Ah]=g_++);const r=255&i;e.data[n+(r>>5)]|=1<<r}(n,e,t)}function __(n,e,t){if(t&bn.Optional)return n;gn(e,"NodeInjector")}function cb(n,e,t,i){if(t&bn.Optional&&void 0===i&&(i=null),0==(t&(bn.Self|bn.Host))){const r=n[9],s=ba(void 0);try{return r?r.get(e,i,t&bn.Optional):md(e,i,t&bn.Optional)}finally{ba(s)}}return __(i,e,t)}function $h(n,e,t,i=bn.Default,r){if(null!==n){const s=function(n){if("string"==typeof n)return n.charCodeAt(0)||0;const e=n.hasOwnProperty(Ah)?n[Ah]:void 0;return"number"==typeof e?e>=0?255&e:db:e}(t);if("function"==typeof s){if(!Td(e,n,i))return i&bn.Host?__(r,t,i):cb(e,t,i,r);try{const o=s(i);if(null!=o||i&bn.Optional)return o;gn(t)}finally{Io()}}else if("number"==typeof s){let o=null,a=vp(n,e),l=-1,c=i&bn.Host?e[16][6]:null;for((-1===a||i&bn.SkipSelf)&&(l=-1===a?Gh(n,e):e[a+8],-1!==l&&Wh(i,!1)?(o=e[1],a=Ad(l),e=el(l,e)):a=-1);-1!==a;){const u=e[1];if(bp(s,a,u.data)){const h=Ss(a,e,t,o,i,c);if(h!==ub)return h}l=e[a+8],-1!==l&&Wh(i,e[1].data[a+8]===c)&&bp(s,a,e)?(o=u,a=Ad(l),e=el(l,e)):a=-1}}}return cb(e,t,i,r)}const ub={};function db(){return new qo(is(),Vt())}function Ss(n,e,t,i,r,s){const o=e[1],a=o.data[n+8],u=Dd(a,o,t,null==i?wd(a)&&Md:i!=o&&0!=(3&a.type),r&bn.Host&&s===a);return null!==u?Id(e,o,u,a):ub}function Dd(n,e,t,i,r){const s=n.providerIndexes,o=e.data,a=1048575&s,l=n.directiveStart,u=s>>20,f=r?a+u:n.directiveEnd;for(let g=i?a:a+u;g<f;g++){const m=o[g];if(g<l&&t===m||g>=l&&m.type===t)return g}if(r){const g=o[l];if(g&&Sa(g)&&g.type===t)return l}return null}function Id(n,e,t,i){let r=n[t];const s=e.data;if(function(n){return n instanceof zh}(r)){const o=r;o.resolving&&function(n,e){throw new Je("200",`Circular dependency in DI detected for ${n}`)}(Xt(s[t]));const a=yp(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?ba(o.injectImpl):null;Td(n,i,bn.Default);try{r=n[t]=o.factory(void 0,s,n,i),e.firstCreatePass&&t>=i.directiveStart&&function(n,e,t){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:s}=e.type.prototype;if(i){const o=nb(e);(t.preOrderHooks||(t.preOrderHooks=[])).push(n,o),(t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n,o)}r&&(t.preOrderHooks||(t.preOrderHooks=[])).push(0-n,r),s&&((t.preOrderHooks||(t.preOrderHooks=[])).push(n,s),(t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n,s))}(t,s[t],e)}finally{null!==l&&ba(l),yp(a),o.resolving=!1,Io()}}return r}function bp(n,e,t){return!!(t[e+(n>>5)]&1<<n)}function Wh(n,e){return!(n&bn.Self||n&bn.Host&&e)}class qo{constructor(e,t){this._tNode=e,this._lView=t}get(e,t){return $h(this._tNode,this._lView,e,void 0,t)}}function $i(n){return Me(()=>{const e=n.prototype.constructor,t=e[Ol]||xs(e),i=Object.prototype;let r=Object.getPrototypeOf(n.prototype).constructor;for(;r&&r!==i;){const s=r[Ol]||xs(r);if(s&&s!==t)return s;r=Object.getPrototypeOf(r)}return s=>new s})}function xs(n){return Be(n)?()=>{const e=xs(be(n));return e&&e()}:Sc(n)}const Rd="__parameters__";function Da(n,e,t){return Me(()=>{const i=function(n){return function(...t){if(n){const i=n(...t);for(const r in i)this[r]=i[r]}}}(e);function r(...s){if(this instanceof r)return i.apply(this,s),this;const o=new r(...s);return a.annotation=o,a;function a(l,c,u){const h=l.hasOwnProperty(Rd)?l[Rd]:Object.defineProperty(l,Rd,{value:[]})[Rd];for(;h.length<=u;)h.push(null);return(h[u]=h[u]||[]).push(o),l}}return t&&(r.prototype=Object.create(t.prototype)),r.prototype.ngMetadataName=n,r.annotationCls=r,r})}class Gt{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=We({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}toString(){return`InjectionToken ${this._desc}`}}function Ko(n,e){void 0===e&&(e=n);for(let t=0;t<n.length;t++){let i=n[t];Array.isArray(i)?(e===n&&(e=n.slice(0,t)),Ko(i,e)):e!==n&&e.push(i)}return e}function Xo(n,e){n.forEach(t=>Array.isArray(t)?Xo(t,e):e(t))}function Yh(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function Ll(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function Ac(n,e){const t=[];for(let i=0;i<n;i++)t.push(e);return t}function Oo(n,e,t){let i=Cs(n,e);return i>=0?n[1|i]=t:(i=~i,function(n,e,t,i){let r=n.length;if(r==e)n.push(t,i);else if(1===r)n.push(i,n[0]),n[0]=t;else{for(r--,n.push(n[r-1],n[r]);r>e;)n[r]=n[r-2],r--;n[e]=t,n[e+1]=i}}(n,i,e,t)),i}function S_(n,e){const t=Cs(n,e);if(t>=0)return n[1|t]}function Cs(n,e){return function(n,e,t){let i=0,r=n.length>>t;for(;r!==i;){const s=i+(r-i>>1),o=n[s<<t];if(e===o)return s<<t;o>e?r=s:i=s+1}return~(r<<t)}(n,e,1)}const xu={},Cp="__NG_DI_FLAG__",Dc="ngTempTokenPath",Ic=/\n/gm,il="__source",Tp=Jt({provide:String,useValue:Jt});let Cu;function Fd(n){const e=Cu;return Cu=n,e}function e1(n,e=bn.Default){if(void 0===Cu)throw new Error("inject() must be called from an injection context");return null===Cu?md(n,void 0,e):Cu.get(n,e&bn.Optional?null:void 0,e)}function Ie(n,e=bn.Default){return(uo||e1)(be(n),e)}const Oc=Ie;function Tu(n){const e=[];for(let t=0;t<n.length;t++){const i=be(n[t]);if(Array.isArray(i)){if(0===i.length)throw new Error("Arguments array must have arguments.");let r,s=bn.Default;for(let o=0;o<i.length;o++){const a=i[o],l=_b(a);"number"==typeof l?-1===l?r=a.token:s|=l:r=a}e.push(Ie(r,s))}else e.push(Ie(i))}return e}function Ld(n,e){return n[Cp]=e,n.prototype[Cp]=e,n}function _b(n){return n[Cp]}function Zs(n,e,t,i){const r=n[Dc];throw e[il]&&r.unshift(e[il]),n.message=function(n,e,t,i=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.substr(2):n;let r=rt(e);if(Array.isArray(e))r=e.map(rt).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):rt(a)))}r=`{${s.join(", ")}}`}return`${t}${i?"("+i+")":""}[${r}]: ${n.replace(Ic,"\n  ")}`}("\n"+n.message,r,t,i),n.ngTokenPath=r,n[Dc]=null,n}const kd=Ld(Da("Inject",n=>({token:n})),-1),Xr=Ld(Da("Optional"),8),rl=Ld(Da("SkipSelf"),4);function Us(n){return n instanceof class{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}?n.changingThisBreaksApplicationSecurity:n}const j_="__ngContext__";function Ts(n,e){n[j_]=e}function U_(n){const e=function(n){return n[j_]||null}(n);return e?Array.isArray(e)?e:e.lView:null}function Bp(n){return n.ngOriginalError}function C1(n,...e){n.error(...e)}class ea{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e),i=this._findContext(e),r=function(n){return n&&n.ngErrorLogger||C1}(e);r(this._console,"ERROR",e),t&&r(this._console,"ORIGINAL ERROR",t),i&&r(this._console,"ERROR CONTEXT",i)}_findContext(e){return e?function(n){return n.ngDebugContext}(e)||this._findContext(Bp(e)):null}_findOriginalError(e){let t=e&&Bp(e);for(;t&&Bp(t);)t=Bp(t);return t||null}}const Gb=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(ti))();function ol(n){return n instanceof Function?n():n}var Po=(()=>((Po=Po||{})[Po.Important=1]="Important",Po[Po.DashCase=2]="DashCase",Po))();function W_(n,e){return undefined(n,e)}function tf(n){const e=n[3];return $o(e)?e[3]:e}function Hd(n){return Kb(n[13])}function Y_(n){return Kb(n[4])}function Kb(n){for(;null!==n&&!$o(n);)n=n[4];return n}function Gd(n,e,t,i,r){if(null!=i){let s,o=!1;$o(i)?s=i:Go(i)&&(o=!0,i=i[0]);const a=vr(i);0===n&&null!==t?null==r?ew(e,t,a):al(e,t,a,r||null,!0):1===n&&null!==t?al(e,t,a,r||null,!0):2===n?function(n,e,t){const i=Up(n,e);i&&function(n,e,t,i){ar(n)?n.removeChild(e,t,i):e.removeChild(t)}(n,i,e,t)}(e,a,o):3===n&&e.destroyNode(a),null!=s&&function(n,e,t,i,r){const s=t[7];s!==vr(t)&&Gd(e,n,i,s,r);for(let a=10;a<t.length;a++){const l=t[a];$d(l[1],l,n,e,i,s)}}(e,n,s,t,r)}}function X_(n,e,t){return ar(n)?n.createElement(e,t):null===t?n.createElement(e):n.createElementNS(t,e)}function Qb(n,e){const t=n[9],i=t.indexOf(e),r=e[3];1024&e[2]&&(e[2]&=-1025,cp(r,-1)),t.splice(i,1)}function Q_(n,e){if(n.length<=10)return;const t=10+e,i=n[t];if(i){const r=i[17];null!==r&&r!==n&&Qb(r,i),e>0&&(n[t-1][4]=i[4]);const s=Ll(n,10+e);!function(n,e){$d(n,e,e[11],2,null,null),e[0]=null,e[6]=null}(i[1],i);const o=s[19];null!==o&&o.detachView(s[1]),i[3]=null,i[4]=null,i[2]&=-129}return i}function Z_(n,e){if(!(256&e[2])){const t=e[11];ar(t)&&t.destroyNode&&$d(n,e,t,3,null,null),function(n){let e=n[13];if(!e)return jp(n[1],n);for(;e;){let t=null;if(Go(e))t=e[13];else{const i=e[10];i&&(t=i)}if(!t){for(;e&&!e[4]&&e!==n;)Go(e)&&jp(e[1],e),e=e[3];null===e&&(e=n),Go(e)&&jp(e[1],e),t=e&&e[4]}e=t}}(e)}}function jp(n,e){if(!(256&e[2])){e[2]&=-129,e[2]|=256,function(n,e){let t;if(null!=n&&null!=(t=n.destroyHooks))for(let i=0;i<t.length;i+=2){const r=e[t[i]];if(!(r instanceof zh)){const s=t[i+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=r[s[o]],l=s[o+1];try{l.call(a)}finally{}}else try{s.call(r)}finally{}}}}(n,e),function(n,e){const t=n.cleanup,i=e[7];let r=-1;if(null!==t)for(let s=0;s<t.length-1;s+=2)if("string"==typeof t[s]){const o=t[s+1],a="function"==typeof o?o(e):vr(e[o]),l=i[r=t[s+2]],c=t[s+3];"boolean"==typeof c?a.removeEventListener(t[s],l,c):c>=0?i[r=c]():i[r=-c].unsubscribe(),s+=2}else{const o=i[r=t[s+1]];t[s].call(o)}if(null!==i){for(let s=r+1;s<i.length;s++)i[s]();e[7]=null}}(n,e),1===e[1].type&&ar(e[11])&&e[11].destroy();const t=e[17];if(null!==t&&$o(e[3])){t!==e[3]&&Qb(t,e);const i=e[19];null!==i&&i.detachView(n)}}}function Zb(n,e,t){return function(n,e,t){let i=e;for(;null!==i&&40&i.type;)i=(e=i).parent;if(null===i)return t[0];if(2&i.flags){const r=n.data[i.directiveStart].encapsulation;if(r===Yt.None||r===Yt.Emulated)return null}return Xs(i,t)}(n,e.parent,t)}function al(n,e,t,i,r){ar(n)?n.insertBefore(e,t,i,r):e.insertBefore(t,i,r)}function ew(n,e,t){ar(n)?n.appendChild(e,t):e.appendChild(t)}function tw(n,e,t,i,r){null!==i?al(n,e,t,i,r):ew(n,e,t)}function Up(n,e){return ar(n)?n.parentNode(e):e.parentNode}function nw(n,e,t){return rw(n,e,t)}let rw=function(n,e,t){return 40&n.type?Xs(n,t):null};function zp(n,e,t,i){const r=Zb(n,i,e),s=e[11],a=nw(i.parent||e[6],i,e);if(null!=r)if(Array.isArray(t))for(let l=0;l<t.length;l++)tw(s,r,t[l],a,!1);else tw(s,r,t,a,!1)}function Iu(n,e){if(null!==e){const t=e.type;if(3&t)return Xs(e,n);if(4&t)return Hp(-1,n[e.index]);if(8&t){const i=e.child;if(null!==i)return Iu(n,i);{const r=n[e.index];return $o(r)?Hp(-1,r):vr(r)}}if(32&t)return W_(e,n)()||vr(n[e.index]);{const i=ow(n,e);return null!==i?Array.isArray(i)?i[0]:Iu(tf(n[16]),i):Iu(n,e.next)}}return null}function ow(n,e){return null!==e?n[16][6].projection[e.projection]:null}function Hp(n,e){const t=10+n+1;if(t<e.length){const i=e[t],r=i[1].firstChild;if(null!==r)return Iu(i,r)}return e[7]}function nf(n,e,t,i,r,s,o){for(;null!=t;){const a=i[t.index],l=t.type;if(o&&0===e&&(a&&Ts(vr(a),i),t.flags|=4),64!=(64&t.flags))if(8&l)nf(n,e,t.child,i,r,s,!1),Gd(e,n,r,a,s);else if(32&l){const c=W_(t,i);let u;for(;u=c();)Gd(e,n,r,u,s);Gd(e,n,r,a,s)}else 16&l?ty(n,e,i,t,r,s):Gd(e,n,r,a,s);t=o?t.projectionNext:t.next}}function $d(n,e,t,i,r,s){nf(t,i,n.firstChild,e,r,s,!1)}function ty(n,e,t,i,r,s){const o=t[16],l=o[6].projection[i.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++)Gd(e,n,r,l[c],s);else nf(n,e,l,o[3],r,s,!0)}function cw(n,e,t){ar(n)?n.setAttribute(e,"style",t):e.style.cssText=t}function ny(n,e,t){ar(n)?""===t?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t):e.className=t}function rf(n,e,t){let i=n.length;for(;;){const r=n.indexOf(e,t);if(-1===r)return r;if(0===r||n.charCodeAt(r-1)<=32){const s=e.length;if(r+s===i||n.charCodeAt(r+s)<=32)return r}t=r+1}}const uw="ng-template";function X1(n,e,t){let i=0;for(;i<n.length;){let r=n[i++];if(t&&"class"===r){if(r=n[i],-1!==rf(r.toLowerCase(),e,0))return!0}else if(1===r){for(;i<n.length&&"string"==typeof(r=n[i++]);)if(r.toLowerCase()===e)return!0;return!1}}return!1}function Gp(n){return 4===n.type&&n.value!==uw}function dw(n,e,t){return e===(4!==n.type||t?n.value:uw)}function Q1(n,e,t){let i=4;const r=n.attrs||[],s=function(n){for(let e=0;e<n.length;e++)if(ob(n[e]))return e;return n.length}(r);let o=!1;for(let a=0;a<e.length;a++){const l=e[a];if("number"!=typeof l){if(!o)if(4&i){if(i=2|1&i,""!==l&&!dw(n,l,t)||""===l&&1===e.length){if(Oa(i))return!1;o=!0}}else{const c=8&i?l:e[++a];if(8&i&&null!==n.attrs){if(!X1(n.attrs,c,t)){if(Oa(i))return!1;o=!0}continue}const h=Z1(8&i?"class":l,r,Gp(n),t);if(-1===h){if(Oa(i))return!1;o=!0;continue}if(""!==c){let f;f=h>s?"":r[h+1].toLowerCase();const g=8&i?f:null;if(g&&-1!==rf(g,c,0)||2&i&&c!==f){if(Oa(i))return!1;o=!0}}}}else{if(!o&&!Oa(i)&&!Oa(l))return!1;if(o&&Oa(l))continue;o=!1,i=l|1&i}}return Oa(i)||o}function Oa(n){return 0==(1&n)}function Z1(n,e,t,i){if(null===e)return-1;let r=0;if(i||!t){let s=!1;for(;r<e.length;){const o=e[r];if(o===n)return r;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=e[++r];for(;"string"==typeof a;)a=e[++r];continue}if(4===o)break;if(0===o){r+=4;continue}}r+=s?1:2}return-1}return function(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){const i=n[t];if("number"==typeof i)return-1;if(i===e)return t;t++}return-1}(e,n)}function hw(n,e,t=!1){for(let i=0;i<e.length;i++)if(Q1(n,e[i],t))return!0;return!1}function nA(n,e){e:for(let t=0;t<e.length;t++){const i=e[t];if(n.length===i.length){for(let r=0;r<n.length;r++)if(n[r]!==i[r])continue e;return!0}}return!1}function fw(n,e){return n?":not("+e.trim()+")":e}function iA(n){let e=n[0],t=1,i=2,r="",s=!1;for(;t<n.length;){let o=n[t];if("string"==typeof o)if(2&i){const a=n[++t];r+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&i?r+="."+o:4&i&&(r+=" "+o);else""!==r&&!Oa(o)&&(e+=fw(s,r),r=""),i=o,s=s||!Oa(i);t++}return""!==r&&(e+=fw(s,r)),e}const An={};function Qt(n){pw(pi(),Vt(),Qs()+n,kh())}function pw(n,e,t,i){if(!i)if(3==(3&e[2])){const s=n.preOrderCheckHooks;null!==s&&gp(e,s,t)}else{const s=n.preOrderHooks;null!==s&&mp(e,s,0,t)}po(t)}function ll(n,e){return n<<17|e<<2}function Dn(n){return n>>17&32767}function br(n){return 2|n}function Ul(n){return(131068&n)>>2}function cl(n,e){return-131069&n|e<<2}function ry(n){return 1|n}function Sw(n,e){const t=n.contentQueries;if(null!==t)for(let i=0;i<t.length;i+=2){const r=t[i],s=t[i+1];if(-1!==s){const o=n.data[s];c_(r),o.contentQueries(2,e[s],s)}}}function of(n,e,t,i,r,s,o,a,l,c){const u=e.blueprint.slice();return u[0]=r,u[2]=140|i,s_(u),u[3]=u[15]=n,u[8]=t,u[10]=o||n&&n[10],u[11]=a||n&&n[11],u[12]=l||n&&n[12]||null,u[9]=c||n&&n[9]||null,u[6]=s,u[16]=2==e.type?n[16]:u,u}function qd(n,e,t,i,r){let s=n.data[e];if(null===s)s=function(n,e,t,i,r){const s=o_(),o=Vr(),l=n.data[e]=function(n,e,t,i,r,s){return{type:t,index:i,insertBeforeIndex:null,injectorIndex:e?e.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,t,e,i,r);return null===n.firstChild&&(n.firstChild=l),null!==s&&(o?null==s.child&&null!==l.parent&&(s.child=l):null===s.next&&(s.next=l)),l}(n,e,t,i,r),Ln.lFrame.inI18n&&(s.flags|=64);else if(64&s.type){s.type=t,s.value=i,s.attrs=r;const o=function(){const n=Ln.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return Za(s,!0),s}function Yd(n,e,t,i){if(0===t)return-1;const r=e.length;for(let s=0;s<t;s++)e.push(i),n.blueprint.push(i),n.data.push(null);return r}function af(n,e,t){jh(e);try{const i=n.viewQuery;null!==i&&by(1,i,t);const r=n.template;null!==r&&xw(n,e,r,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&Sw(n,e),n.staticViewQueries&&by(2,n.viewQuery,t);const s=n.components;null!==s&&function(n,e){for(let t=0;t<e.length;t++)NA(n,e[t])}(e,s)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{e[2]&=-5,ai()}}function Kd(n,e,t,i){const r=e[2];if(256==(256&r))return;jh(e);const s=kh();try{s_(e),function(n){Ln.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==t&&xw(n,e,t,2,i);const o=3==(3&r);if(!s)if(o){const c=n.preOrderCheckHooks;null!==c&&gp(e,c,null)}else{const c=n.preOrderHooks;null!==c&&mp(e,c,0,null),u_(e,0)}if(function(n){for(let e=Hd(n);null!==e;e=Y_(e)){if(!e[2])continue;const t=e[9];for(let i=0;i<t.length;i++){const r=t[i],s=r[3];0==(1024&r[2])&&cp(s,1),r[2]|=1024}}}(e),function(n){for(let e=Hd(n);null!==e;e=Y_(e))for(let t=10;t<e.length;t++){const i=e[t],r=i[1];xd(i)&&Kd(r,i,r.template,i[8])}}(e),null!==n.contentQueries&&Sw(n,e),!s)if(o){const c=n.contentCheckHooks;null!==c&&gp(e,c)}else{const c=n.contentHooks;null!==c&&mp(e,c,1),u_(e,1)}!function(n,e){const t=n.hostBindingOpCodes;if(null!==t)try{for(let i=0;i<t.length;i++){const r=t[i];if(r<0)po(~r);else{const s=r,o=t[++i],a=t[++i];Cd(o,s),a(2,e[s])}}}finally{po(-1)}}(n,e);const a=n.components;null!==a&&function(n,e){for(let t=0;t<e.length;t++)RA(n,e[t])}(e,a);const l=n.viewQuery;if(null!==l&&by(2,l,i),!s)if(o){const c=n.viewCheckHooks;null!==c&&gp(e,c)}else{const c=n.viewHooks;null!==c&&mp(e,c,2),u_(e,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),s||(e[2]&=-73),1024&e[2]&&(e[2]&=-1025,cp(e[3],-1))}finally{ai()}}function mA(n,e,t,i){const r=e[10],s=!kh(),o=Pl(e);try{s&&!o&&r.begin&&r.begin(),o&&af(n,e,i),Kd(n,e,t,i)}finally{s&&!o&&r.end&&r.end()}}function xw(n,e,t,i,r){const s=Qs(),o=2&i;try{po(-1),o&&e.length>20&&pw(n,e,20,kh()),t(i,r)}finally{po(s)}}function lf(n,e,t){!rb()||(function(n,e,t,i){const r=t.directiveStart,s=t.directiveEnd;n.firstCreatePass||js(t,e),Ts(i,e);const o=t.initialInputs;for(let a=r;a<s;a++){const l=n.data[a],c=Sa(l);c&&AA(e,t,l);const u=Id(e,n,a,t);Ts(u,e),null!==o&&MA(0,a-r,u,l,0,o),c&&(Vs(t.index,e)[8]=u)}}(n,e,t,Xs(t,e)),128==(128&t.flags)&&function(n,e,t){const i=t.directiveStart,r=t.directiveEnd,o=t.index,a=Ln.lFrame.currentDirectiveIndex;try{po(o);for(let l=i;l<r;l++){const c=n.data[l],u=e[l];a_(l),(null!==c.hostBindings||0!==c.hostVars||null!==c.hostAttrs)&&Pw(c,u)}}finally{po(-1),a_(a)}}(n,e,t))}function dy(n,e,t=Xs){const i=e.localNames;if(null!==i){let r=e.index+1;for(let s=0;s<i.length;s+=2){const o=i[s+1],a=-1===o?t(e,n):n[o];n[r++]=a}}}function Yp(n){const e=n.tView;return null===e||e.incompleteFirstPass?n.tView=Kp(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts):e}function Kp(n,e,t,i,r,s,o,a,l,c){const u=20+i,h=u+r,f=function(n,e){const t=[];for(let i=0;i<e;i++)t.push(i<n?null:An);return t}(u,h),g="function"==typeof c?c():c;return f[1]={type:n,blueprint:f,template:t,queries:null,viewQuery:a,declTNode:e,data:f.slice().fill(null,u),bindingStartIndex:u,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:l,consts:g,incompleteFirstPass:!1}}function Aw(n,e,t,i){const r=Bw(e);null===t?r.push(i):(r.push(t),n.firstCreatePass&&Qp(n).push(i,r.length-1))}function Mw(n,e,t){for(let i in n)if(n.hasOwnProperty(i)){const r=n[i];(t=null===t?{}:t).hasOwnProperty(i)?t[i].push(e,r):t[i]=[e,r]}return t}function Fo(n,e,t,i,r,s,o,a){const l=Xs(e,t);let u,c=e.inputs;!a&&null!=c&&(u=c[i])?(Vw(n,t,u,i,r),wd(e)&&function(n,e){const t=Vs(e,n);16&t[2]||(t[2]|=64)}(t,e.index)):3&e.type&&(i=function(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(i),r=null!=o?o(r,e.value||"",i):r,ar(s)?s.setProperty(l,i,r):h_(i)||(l.setProperty?l.setProperty(i,r):l[i]=r))}function hy(n,e,t,i){let r=!1;if(rb()){const s=function(n,e,t){const i=n.directiveRegistry;let r=null;if(i)for(let s=0;s<i.length;s++){const o=i[s];hw(t,o.selectors,!1)&&(r||(r=[]),Cc(js(t,e),n,o.type),Sa(o)?(Fw(n,t),r.unshift(o)):r.push(o))}return r}(n,e,t),o=null===i?null:{"":-1};if(null!==s){r=!0,fy(t,n.data.length,s.length);for(let u=0;u<s.length;u++){const h=s[u];h.providersResolver&&h.providersResolver(h)}let a=!1,l=!1,c=Yd(n,e,s.length,null);for(let u=0;u<s.length;u++){const h=s[u];t.mergedAttrs=Hh(t.mergedAttrs,h.hostAttrs),py(n,t,e,c,h),TA(c,h,o),null!==h.contentQueries&&(t.flags|=8),(null!==h.hostBindings||null!==h.hostAttrs||0!==h.hostVars)&&(t.flags|=128);const f=h.type.prototype;!a&&(f.ngOnChanges||f.ngOnInit||f.ngDoCheck)&&((n.preOrderHooks||(n.preOrderHooks=[])).push(t.index),a=!0),!l&&(f.ngOnChanges||f.ngDoCheck)&&((n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t.index),l=!0),c++}!function(n,e){const i=e.directiveEnd,r=n.data,s=e.attrs,o=[];let a=null,l=null;for(let c=e.directiveStart;c<i;c++){const u=r[c],h=u.inputs,f=null===s||Gp(e)?null:DA(h,s);o.push(f),a=Mw(h,c,a),l=Mw(u.outputs,c,l)}null!==a&&(a.hasOwnProperty("class")&&(e.flags|=16),a.hasOwnProperty("style")&&(e.flags|=32)),e.initialInputs=o,e.inputs=a,e.outputs=l}(n,t)}o&&function(n,e,t){if(e){const i=n.localNames=[];for(let r=0;r<e.length;r+=2){const s=t[e[r+1]];if(null==s)throw new Je("301",`Export of name '${e[r+1]}' not found!`);i.push(e[r],s)}}}(t,i,o)}return t.mergedAttrs=Hh(t.mergedAttrs,t.attrs),r}function Nw(n,e,t,i,r,s){const o=s.hostBindings;if(o){let a=n.hostBindingOpCodes;null===a&&(a=n.hostBindingOpCodes=[]);const l=~e.index;(function(n){let e=n.length;for(;e>0;){const t=n[--e];if("number"==typeof t&&t<0)return t}return 0})(a)!=l&&a.push(l),a.push(i,r,o)}}function Pw(n,e){null!==n.hostBindings&&n.hostBindings(1,e)}function Fw(n,e){e.flags|=2,(n.components||(n.components=[])).push(e.index)}function TA(n,e,t){if(t){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)t[e.exportAs[i]]=n;Sa(e)&&(t[""]=n)}}function fy(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function py(n,e,t,i,r){n.data[i]=r;const s=r.factory||(r.factory=Sc(r.type)),o=new zh(s,Sa(r),null);n.blueprint[i]=o,t[i]=o,Nw(n,e,0,i,Yd(n,t,r.hostVars,An),r)}function AA(n,e,t){const i=Xs(e,n),r=Yp(t),s=n[10],o=Xp(n,of(n,r,null,t.onPush?64:16,i,e,s,s.createRenderer(i,t),null,null));n[e.index]=o}function dl(n,e,t,i,r,s){const o=Xs(n,e);!function(n,e,t,i,r,s,o){if(null==s)ar(n)?n.removeAttribute(e,r,t):e.removeAttribute(r);else{const a=null==o?Dt(s):o(s,i||"",r);ar(n)?n.setAttribute(e,r,a,t):t?e.setAttributeNS(t,r,a):e.setAttribute(r,a)}}(e[11],o,s,n.value,t,i,r)}function MA(n,e,t,i,r,s){const o=s[e];if(null!==o){const a=i.setInput;for(let l=0;l<o.length;){const c=o[l++],u=o[l++],h=o[l++];null!==a?i.setInput(t,h,c,u):t[u]=h}}}function DA(n,e){let t=null,i=0;for(;i<e.length;){const r=e[i];if(0!==r)if(5!==r){if("number"==typeof r)break;n.hasOwnProperty(r)&&(null===t&&(t=[]),t.push(r,n[r],e[i+1])),i+=2}else i+=2;else i+=4}return t}function Lw(n,e,t,i){return new Array(n,!0,!1,e,null,0,i,t,null,null)}function RA(n,e){const t=Vs(e,n);if(xd(t)){const i=t[1];80&t[2]?Kd(i,t,i.template,t[8]):t[5]>0&&my(t)}}function my(n){for(let i=Hd(n);null!==i;i=Y_(i))for(let r=10;r<i.length;r++){const s=i[r];if(1024&s[2]){const o=s[1];Kd(o,s,o.template,s[8])}else s[5]>0&&my(s)}const t=n[1].components;if(null!==t)for(let i=0;i<t.length;i++){const r=Vs(t[i],n);xd(r)&&r[5]>0&&my(r)}}function NA(n,e){const t=Vs(e,n),i=t[1];(function(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])})(i,t),af(i,t,t[8])}function Xp(n,e){return n[13]?n[14][4]=e:n[13]=e,n[14]=e,e}function _y(n){for(;n;){n[2]|=64;const e=tf(n);if(Jv(n)&&!e)return n;n=e}return null}function vy(n,e,t){const i=e[10];i.begin&&i.begin();try{Kd(n,e,n.template,t)}catch(r){throw Ey(e,r),r}finally{i.end&&i.end()}}function kw(n){!function(n){for(let e=0;e<n.components.length;e++){const t=n.components[e],i=U_(t),r=i[1];mA(r,i,r.template,t)}}(n[8])}function by(n,e,t){c_(0),e(n,t)}const BA=(()=>Promise.resolve(null))();function Bw(n){return n[7]||(n[7]=[])}function Qp(n){return n.cleanup||(n.cleanup=[])}function Ey(n,e){const t=n[9],i=t?t.get(ea,null):null;i&&i.handleError(e)}function Vw(n,e,t,i,r){for(let s=0;s<t.length;){const o=t[s++],a=t[s++],l=e[o],c=n.data[o];null!==c.setInput?c.setInput(l,r,i,a):l[a]=r}}function zl(n,e,t){const i=Ph(e,n);!function(n,e,t){ar(n)?n.setValue(e,t):e.textContent=t}(n[11],i,t)}function Zp(n,e,t){let i=t?n.styles:null,r=t?n.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?s=a:1==s?r=lt(r,a):2==s&&(i=lt(i,a+": "+e[++o]+";"))}t?n.styles=i:n.stylesWithoutHost=i,t?n.classes=r:n.classesWithoutHost=r}const Qd=new Gt("INJECTOR",-1);class to{get(e,t=xu){if(t===xu){const i=new Error(`NullInjectorError: No provider for ${rt(e)}!`);throw i.name="NullInjectorError",i}return t}}const Ou=new Gt("Set Injector scope."),cf={},jA={};let xy;function jw(){return void 0===xy&&(xy=new to),xy}function Uw(n,e=null,t=null,i){return new Ty(n,t,e||jw(),i)}class Ty{constructor(e,t,i,r=null){this.parent=i,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const s=[];t&&Xo(t,a=>this.processProvider(a,e,t)),Xo([e],a=>this.processInjectorType(a,[],s)),this.records.set(Qd,Ru(void 0,this));const o=this.records.get(Ou);this.scope=null!=o?o.value:null,this.source=r||("object"==typeof e?null:rt(e))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(e=>e.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(e,t=xu,i=bn.Default){this.assertNotDestroyed();const r=Fd(this),s=ba(void 0);try{if(!(i&bn.SkipSelf)){let a=this.records.get(e);if(void 0===a){const l=function(n){return"function"==typeof n||"object"==typeof n&&n instanceof Gt}(e)&&mn(e);a=l&&this.injectableDefInScope(l)?Ru(Ay(e),cf):null,this.records.set(e,a)}if(null!=a)return this.hydrate(e,a)}return(i&bn.Self?jw():this.parent).get(e,t=i&bn.Optional&&t===xu?null:t)}catch(o){if("NullInjectorError"===o.name){if((o[Dc]=o[Dc]||[]).unshift(rt(e)),r)throw o;return Zs(o,e,"R3InjectorError",this.source)}throw o}finally{ba(s),Fd(r)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(e=>this.get(e))}toString(){const e=[];return this.records.forEach((i,r)=>e.push(rt(r))),`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}processInjectorType(e,t,i){if(!(e=be(e)))return!1;let r=Dl(e);const s=null==r&&e.ngModule||void 0,o=void 0===s?e:s,a=-1!==i.indexOf(o);if(void 0!==s&&(r=Dl(s)),null==r)return!1;if(null!=r.imports&&!a){let u;i.push(o);try{Xo(r.imports,h=>{this.processInjectorType(h,t,i)&&(void 0===u&&(u=[]),u.push(h))})}finally{}if(void 0!==u)for(let h=0;h<u.length;h++){const{ngModule:f,providers:g}=u[h];Xo(g,m=>this.processProvider(m,f,g||Zi))}}this.injectorDefTypes.add(o);const l=Sc(o)||(()=>new o);this.records.set(o,Ru(l,cf));const c=r.providers;if(null!=c&&!a){const u=e;Xo(c,h=>this.processProvider(h,u,c))}return void 0!==s&&void 0!==e.providers}processProvider(e,t,i){let r=Lc(e=be(e))?e:be(e&&e.provide);const s=function(n,e,t){return Hw(n)?Ru(void 0,n.useValue):Ru(zw(n),cf)}(e);if(Lc(e)||!0!==e.multi)this.records.get(r);else{let o=this.records.get(r);o||(o=Ru(void 0,cf,!0),o.factory=()=>Tu(o.multi),this.records.set(r,o)),r=e,o.multi.push(e)}this.records.set(r,s)}hydrate(e,t){return t.value===cf&&(t.value=jA,t.value=t.factory()),"object"==typeof t.value&&t.value&&function(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(t.value)&&this.onDestroy.add(t.value),t.value}injectableDefInScope(e){if(!e.providedIn)return!1;const t=be(e.providedIn);return"string"==typeof t?"any"===t||t===this.scope:this.injectorDefTypes.has(t)}}function Ay(n){const e=mn(n),t=null!==e?e.factory:Sc(n);if(null!==t)return t;if(n instanceof Gt)throw new Error(`Token ${rt(n)} is missing a \u0275prov definition.`);if(n instanceof Function)return function(n){const e=n.length;if(e>0){const i=Ac(e,"?");throw new Error(`Can't resolve all parameters for ${rt(n)}: (${i.join(", ")}).`)}const t=function(n){const e=n&&(n[co]||n[Ls]);if(e){const t=function(n){if(n.hasOwnProperty("name"))return n.name;const e=(""+n).match(/^function\s*([^\s(]+)/);return null===e?"":e[1]}(n);return console.warn(`DEPRECATED: DI is instantiating a token "${t}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${t}" class.`),e}return null}(n);return null!==t?()=>t.factory(n):()=>new n}(n);throw new Error("unreachable")}function zw(n,e,t){let i;if(Lc(n)){const r=be(n);return Sc(r)||Ay(r)}if(Hw(n))i=()=>be(n.useValue);else if(function(n){return!(!n||!n.useFactory)}(n))i=()=>n.useFactory(...Tu(n.deps||[]));else if(function(n){return!(!n||!n.useExisting)}(n))i=()=>Ie(be(n.useExisting));else{const r=be(n&&(n.useClass||n.provide));if(!function(n){return!!n.deps}(n))return Sc(r)||Ay(r);i=()=>new r(...Tu(n.deps))}return i}function Ru(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function Hw(n){return null!==n&&"object"==typeof n&&Tp in n}function Lc(n){return"function"==typeof n}const Gw=function(n,e,t){return function(n,e=null,t=null,i){const r=Uw(n,e,t,i);return r._resolveInjectorDefTypes(),r}({name:t},e,n,t)};class zn{static create(e,t){return Array.isArray(e)?Gw(e,t,""):Gw(e.providers,e.parent,e.name||"")}}function Q9(n,e){pp(U_(n)[1],is())}function In(n){let e=function(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),t=!0;const i=[n];for(;e;){let r;if(Sa(n))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new Error("Directives cannot inherit Components");r=e.\u0275dir}if(r){if(t){i.push(r);const o=n;o.inputs=eM(n.inputs),o.declaredInputs=eM(n.declaredInputs),o.outputs=eM(n.outputs);const a=r.hostBindings;a&&tq(n,a);const l=r.viewQuery,c=r.contentQueries;if(l&&J9(n,l),c&&eq(n,c),Ka(n.inputs,r.inputs),Ka(n.declaredInputs,r.declaredInputs),Ka(n.outputs,r.outputs),Sa(r)&&r.data.animation){const u=n.data;u.animation=(u.animation||[]).concat(r.data.animation)}}const s=r.features;if(s)for(let o=0;o<s.length;o++){const a=s[o];a&&a.ngInherit&&a(n),a===In&&(t=!1)}}e=Object.getPrototypeOf(e)}!function(n){let e=0,t=null;for(let i=n.length-1;i>=0;i--){const r=n[i];r.hostVars=e+=r.hostVars,r.hostAttrs=Hh(r.hostAttrs,t=Hh(t,r.hostAttrs))}}(i)}function eM(n){return n===_d?{}:n===Zi?[]:n}function J9(n,e){const t=n.viewQuery;n.viewQuery=t?(i,r)=>{e(i,r),t(i,r)}:e}function eq(n,e){const t=n.contentQueries;n.contentQueries=t?(i,r,s)=>{e(i,r,s),t(i,r,s)}:e}function tq(n,e){const t=n.hostBindings;n.hostBindings=t?(i,r)=>{e(i,r),t(i,r)}:e}zn.THROW_IF_NOT_FOUND=xu,zn.NULL=new to,zn.\u0275prov=We({token:zn,providedIn:"any",factory:()=>Ie(Qd)}),zn.__NG_ELEMENT_ID__=-1;let Kw=null;function Jp(){if(!Kw){const n=ti.Symbol;if(n&&n.iterator)Kw=n.iterator;else{const e=Object.getOwnPropertyNames(Map.prototype);for(let t=0;t<e.length;++t){const i=e[t];"entries"!==i&&"size"!==i&&Map.prototype[i]===Map.prototype.entries&&(Kw=i)}}}return Kw}class Gl{constructor(e){this.wrapped=e}static wrap(e){return new Gl(e)}static unwrap(e){return Gl.isWrapped(e)?e.wrapped:e}static isWrapped(e){return e instanceof Gl}}function Ry(n){return!!tM(n)&&(Array.isArray(n)||!(n instanceof Map)&&Jp()in n)}function tM(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function Bc(n,e,t){return n[e]=t}function yo(n,e,t){return!Object.is(n[e],t)&&(n[e]=t,!0)}function Wi(n,e,t,i){const r=Vt();return yo(r,Ta(),e)&&(pi(),dl(Dr(),r,n,e,t,i)),Wi}function Ei(n,e,t,i,r,s,o,a){const l=Vt(),c=pi(),u=n+20,h=c.firstCreatePass?function(n,e,t,i,r,s,o,a,l){const c=e.consts,u=qd(e,n,4,o||null,Ca(c,a));hy(e,t,u,Ca(c,l)),pp(e,u);const h=u.tViews=Kp(2,u,i,r,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c);return null!==e.queries&&(e.queries.template(e,u),h.queries=e.queries.embeddedTView(u)),u}(u,c,l,e,t,i,r,s,o):c.data[u];Za(h,!1);const f=l[11].createComment("");zp(c,l,f,h),Ts(f,l),Xp(l,l[u]=Lw(f,l,f,h)),Ed(h)&&lf(c,l,h),null!=o&&dy(l,h,a)}function cg(n){return Sd(Ln.lFrame.contextLView,20+n)}function De(n,e=bn.Default){const t=Vt();return null===t?Ie(n,e):$h(is(),t,be(n),e)}function sn(n,e,t){const i=Vt();return yo(i,Ta(),e)&&Fo(pi(),Dr(),i,n,e,i[11],t,!1),sn}function oM(n,e,t,i,r){const o=r?"class":"style";Vw(n,t,e.inputs[o],o,i)}function Ft(n,e,t,i){const r=Vt(),s=pi(),o=20+n,a=r[11],l=r[o]=X_(a,e,Ln.lFrame.currentNamespace),c=s.firstCreatePass?function(n,e,t,i,r,s,o){const a=e.consts,c=qd(e,n,2,r,Ca(a,s));return hy(e,t,c,Ca(a,o)),null!==c.attrs&&Zp(c,c.attrs,!1),null!==c.mergedAttrs&&Zp(c,c.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,c),c}(o,s,r,0,e,t,i):s.data[o];Za(c,!0);const u=c.mergedAttrs;null!==u&&_p(a,l,u);const h=c.classes;null!==h&&ny(a,l,h);const f=c.styles;null!==f&&cw(a,l,f),64!=(64&c.flags)&&zp(s,r,l,c),0===Ln.lFrame.elementDepthCount&&Ts(l,r),Ln.lFrame.elementDepthCount++,Ed(c)&&(lf(s,r,c),function(n,e,t){if(Qm(e)){const r=e.directiveEnd;for(let s=e.directiveStart;s<r;s++){const o=n.data[s];o.contentQueries&&o.contentQueries(1,t[s],s)}}}(s,c,r)),null!==i&&dy(r,c)}function Lt(){let n=is();Vr()?hs():(n=n.parent,Za(n,!1));const e=n;Ln.lFrame.elementDepthCount--;const t=pi();t.firstCreatePass&&(pp(t,n),Qm(n)&&t.queries.elementEnd(n)),null!=e.classesWithoutHost&&function(n){return 0!=(16&n.flags)}(e)&&oM(t,e,Vt(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function(n){return 0!=(32&n.flags)}(e)&&oM(t,e,Vt(),e.stylesWithoutHost,!1)}function Ci(n,e,t,i){Ft(n,e,t,i),Lt()}function $l(){return Vt()}function Py(n){return!!n&&"function"==typeof n.then}function iL(n){return!!n&&"function"==typeof n.subscribe}const Zw=iL;function jn(n,e,t,i){const r=Vt(),s=pi(),o=is();return function(n,e,t,i,r,s,o,a){const l=Ed(i),u=n.firstCreatePass&&Qp(n),h=e[8],f=Bw(e);let g=!0;if(3&i.type||a){const S=Xs(i,e),U=a?a(S):S,D=f.length,ie=a?_e=>a(vr(_e[i.index])):i.index;if(ar(t)){let _e=null;if(!a&&l&&(_e=function(n,e,t,i){const r=n.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const o=r[s];if(o===t&&r[s+1]===i){const a=e[7],l=r[s+2];return a.length>l?a[l]:null}"string"==typeof o&&(s+=2)}return null}(n,e,r,i.index)),null!==_e)(_e.__ngLastListenerFn__||_e).__ngNextListenerFn__=s,_e.__ngLastListenerFn__=s,g=!1;else{s=aM(i,e,h,s,!1);const Ne=t.listen(U,r,s);f.push(s,Ne),u&&u.push(r,ie,D,D+1)}}else s=aM(i,e,h,s,!0),U.addEventListener(r,s,o),f.push(s),u&&u.push(r,ie,D,o)}else s=aM(i,e,h,s,!1);const m=i.outputs;let w;if(g&&null!==m&&(w=m[r])){const S=w.length;if(S)for(let U=0;U<S;U+=2){const Pe=e[w[U]][w[U+1]].subscribe(s),Ve=f.length;f.push(s,Pe),u&&u.push(r,i.index,Ve,-(Ve+1))}}}(s,r,r[11],o,n,e,!!t,i),jn}function sL(n,e,t,i){try{return!1!==t(i)}catch(r){return Ey(n,r),!1}}function aM(n,e,t,i,r){return function s(o){if(o===Function)return i;const a=2&n.flags?Vs(n.index,e):e;0==(32&e[2])&&_y(a);let l=sL(e,0,i,o),c=s.__ngNextListenerFn__;for(;c;)l=sL(e,0,c,o)&&l,c=c.__ngNextListenerFn__;return r&&!1===l&&(o.preventDefault(),o.returnValue=!1),l}}function Si(n=1){return function(n){return(Ln.lFrame.contextLView=function(n,e){for(;n>0;)e=e[15],n--;return e}(n,Ln.lFrame.contextLView))[8]}(n)}function Fq(n,e){let t=null;const i=function(n){const e=n.attrs;if(null!=e){const t=e.indexOf(5);if(0==(1&t))return e[t+1]}return null}(n);for(let r=0;r<e.length;r++){const s=e[r];if("*"!==s){if(null===i?hw(n,s,!0):nA(i,s))return r}else t=r}return t}function pL(n,e,t,i,r){const s=n[t+1],o=null===e;let a=i?Dn(s):Ul(s),l=!1;for(;0!==a&&(!1===l||o);){const u=n[a+1];Bq(n[a],e)&&(l=!0,n[a+1]=i?ry(u):br(u)),a=i?Dn(u):Ul(u)}l&&(n[t+1]=i?br(s):ry(s))}function Bq(n,e){return null===n||null==e||(Array.isArray(n)?n[1]:n)===e||!(!Array.isArray(n)||"string"!=typeof e)&&Cs(n,e)>=0}const Ms={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function gL(n){return n.substring(Ms.key,Ms.keyEnd)}function mL(n,e){const t=Ms.textEnd;return t===e?-1:(e=Ms.keyEnd=function(n,e,t){for(;e<t&&n.charCodeAt(e)>32;)e++;return e}(n,Ms.key=e,t),fg(n,e,t))}function fg(n,e,t){for(;e<t&&n.charCodeAt(e)<=32;)e++;return e}function Ti(n,e){return function(n,e,t,i){const r=Vt(),s=pi(),o=Do(2);s.firstUpdatePass&&EL(s,n,o,i),e!==An&&yo(r,o,e)&&xL(s,s.data[Qs()],r,r[11],n,r[o+1]=function(n,e){return null==n||("string"==typeof e?n+=e:"object"==typeof n&&(n=rt(Us(n)))),n}(e,t),i,o)}(n,e,null,!0),Ti}function Vc(n){!function(n,e,t,i){const r=pi(),s=Do(2);r.firstUpdatePass&&EL(r,null,s,i);const o=Vt();if(t!==An&&yo(o,s,t)){const a=r.data[Qs()];if(TL(a,i)&&!wL(r,s)){let l=i?a.classesWithoutHost:a.stylesWithoutHost;null!==l&&(t=lt(l,t||"")),oM(r,a,o,t,i)}else!function(n,e,t,i,r,s,o,a){r===An&&(r=Zi);let l=0,c=0,u=0<r.length?r[0]:null,h=0<s.length?s[0]:null;for(;null!==u||null!==h;){const f=l<r.length?r[l+1]:void 0,g=c<s.length?s[c+1]:void 0;let w,m=null;u===h?(l+=2,c+=2,f!==g&&(m=h,w=g)):null===h||null!==u&&u<h?(l+=2,m=u):(c+=2,m=h,w=g),null!==m&&xL(n,e,t,i,m,w,o,a),u=l<r.length?r[l]:null,h=c<s.length?s[c]:null}}(r,a,o,o[11],o[s+1],o[s+1]=function(n,e,t){if(null==t||""===t)return Zi;const i=[],r=Us(t);if(Array.isArray(r))for(let s=0;s<r.length;s++)n(i,r[s],!0);else if("object"==typeof r)for(const s in r)r.hasOwnProperty(s)&&n(i,s,r[s]);else"string"==typeof r&&e(i,r);return i}(n,e,t),i,s)}}(Oo,jc,n,!0)}function jc(n,e){for(let t=function(n){return function(n){Ms.key=0,Ms.keyEnd=0,Ms.value=0,Ms.valueEnd=0,Ms.textEnd=n.length}(n),mL(n,fg(n,0,Ms.textEnd))}(e);t>=0;t=mL(e,t))Oo(n,gL(e),!0)}function wL(n,e){return e>=n.expandoStartIndex}function EL(n,e,t,i){const r=n.data;if(null===r[t+1]){const s=r[Qs()],o=wL(n,t);TL(s,i)&&null===e&&!o&&(e=!1),e=function(n,e,t,i){const r=function(n){const e=Ln.lFrame.currentDirectiveIndex;return-1===e?null:n[e]}(n);let s=i?e.residualClasses:e.residualStyles;if(null===r)0===(i?e.classBindings:e.styleBindings)&&(t=Ly(t=cM(null,n,e,t,i),e.attrs,i),s=null);else{const o=e.directiveStylingLast;if(-1===o||n[o]!==r)if(t=cM(r,n,e,t,i),null===s){let l=function(n,e,t){const i=t?e.classBindings:e.styleBindings;if(0!==Ul(i))return n[Dn(i)]}(n,e,i);void 0!==l&&Array.isArray(l)&&(l=cM(null,n,e,l[1],i),l=Ly(l,e.attrs,i),function(n,e,t,i){n[Dn(t?e.classBindings:e.styleBindings)]=i}(n,e,i,l))}else s=function(n,e,t){let i;const r=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<r;s++)i=Ly(i,n[s].hostAttrs,t);return Ly(i,e.attrs,t)}(n,e,i)}return void 0!==s&&(i?e.residualClasses=s:e.residualStyles=s),t}(r,s,e,i),function(n,e,t,i,r,s){let o=s?e.classBindings:e.styleBindings,a=Dn(o),l=Ul(o);n[i]=t;let u,c=!1;if(Array.isArray(t)){const h=t;u=h[1],(null===u||Cs(h,u)>0)&&(c=!0)}else u=t;if(r)if(0!==l){const f=Dn(n[a+1]);n[i+1]=ll(f,a),0!==f&&(n[f+1]=cl(n[f+1],i)),n[a+1]=function(n,e){return 131071&n|e<<17}(n[a+1],i)}else n[i+1]=ll(a,0),0!==a&&(n[a+1]=cl(n[a+1],i)),a=i;else n[i+1]=ll(l,0),0===a?a=i:n[l+1]=cl(n[l+1],i),l=i;c&&(n[i+1]=br(n[i+1])),pL(n,u,i,!0),pL(n,u,i,!1),function(n,e,t,i,r){const s=r?n.residualClasses:n.residualStyles;null!=s&&"string"==typeof e&&Cs(s,e)>=0&&(t[i+1]=ry(t[i+1]))}(e,u,n,i,s),o=ll(a,l),s?e.classBindings=o:e.styleBindings=o}(r,s,e,t,o,i)}}function cM(n,e,t,i,r){let s=null;const o=t.directiveEnd;let a=t.directiveStylingLast;for(-1===a?a=t.directiveStart:a++;a<o&&(s=e[a],i=Ly(i,s.hostAttrs,r),s!==n);)a++;return null!==n&&(t.directiveStylingLast=a),i}function Ly(n,e,t){const i=t?1:2;let r=-1;if(null!==e)for(let s=0;s<e.length;s++){const o=e[s];"number"==typeof o?r=o:r===i&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),Oo(n,o,!!t||e[++s]))}return void 0===n?null:n}function xL(n,e,t,i,r,s,o,a){if(!(3&e.type))return;const l=n.data,c=l[a+1];tE(function(n){return 1==(1&n)}(c)?CL(l,e,t,r,Ul(c),o):void 0)||(tE(s)||function(n){return 2==(2&n)}(c)&&(s=CL(l,null,t,r,a,o)),function(n,e,t,i,r){const s=ar(n);if(e)r?s?n.addClass(t,i):t.classList.add(i):s?n.removeClass(t,i):t.classList.remove(i);else{let o=-1===i.indexOf("-")?void 0:Po.DashCase;if(null==r)s?n.removeStyle(t,i,o):t.style.removeProperty(i);else{const a="string"==typeof r&&r.endsWith("!important");a&&(r=r.slice(0,-10),o|=Po.Important),s?n.setStyle(t,i,r,o):t.style.setProperty(i,r,a?"important":"")}}}(i,o,Ph(Qs(),t),r,s))}function CL(n,e,t,i,r,s){const o=null===e;let a;for(;r>0;){const l=n[r],c=Array.isArray(l),u=c?l[1]:l,h=null===u;let f=t[r+1];f===An&&(f=h?Zi:void 0);let g=h?S_(f,i):u===i?f:void 0;if(c&&!tE(g)&&(g=S_(l,i)),tE(g)&&(a=g,o))return a;const m=n[r+1];r=o?Dn(m):Ul(m)}if(null!==e){let l=s?e.residualClasses:e.residualStyles;null!=l&&(a=S_(l,i))}return a}function tE(n){return void 0!==n}function TL(n,e){return 0!=(n.flags&(e?16:32))}function Ai(n,e=""){const t=Vt(),i=pi(),r=n+20,s=i.firstCreatePass?qd(i,r,1,e,null):i.data[r],o=t[r]=function(n,e){return ar(n)?n.createText(e):n.createTextNode(e)}(t[11],e);zp(i,t,o,s),Za(s,!1)}function Ds(n){return Uc("",n,""),Ds}function Uc(n,e,t){const i=Vt(),r=function(n,e,t,i){return yo(n,Ta(),t)?e+Dt(t)+i:An}(i,n,e,t);return r!==An&&zl(i,Qs(),r),Uc}function Nu(n,e,t){const i=Vt();return yo(i,Ta(),e)&&Fo(pi(),Dr(),i,n,e,i[11],t,!0),Nu}const df=void 0;var yY=["en",[["a","p"],["AM","PM"],df],[["AM","PM"],df,df],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],df,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],df,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",df,"{1} 'at' {0}",df],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(n){const e=Math.floor(Math.abs(n)),t=n.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===t?1:5}];let pg={};function GL(n){return n in pg||(pg[n]=ti.ng&&ti.ng.common&&ti.ng.common.locales&&ti.ng.common.locales[n]),pg[n]}var ln=(()=>((ln=ln||{})[ln.LocaleId=0]="LocaleId",ln[ln.DayPeriodsFormat=1]="DayPeriodsFormat",ln[ln.DayPeriodsStandalone=2]="DayPeriodsStandalone",ln[ln.DaysFormat=3]="DaysFormat",ln[ln.DaysStandalone=4]="DaysStandalone",ln[ln.MonthsFormat=5]="MonthsFormat",ln[ln.MonthsStandalone=6]="MonthsStandalone",ln[ln.Eras=7]="Eras",ln[ln.FirstDayOfWeek=8]="FirstDayOfWeek",ln[ln.WeekendRange=9]="WeekendRange",ln[ln.DateFormat=10]="DateFormat",ln[ln.TimeFormat=11]="TimeFormat",ln[ln.DateTimeFormat=12]="DateTimeFormat",ln[ln.NumberSymbols=13]="NumberSymbols",ln[ln.NumberFormats=14]="NumberFormats",ln[ln.CurrencyCode=15]="CurrencyCode",ln[ln.CurrencySymbol=16]="CurrencySymbol",ln[ln.CurrencyName=17]="CurrencyName",ln[ln.Currencies=18]="Currencies",ln[ln.Directionality=19]="Directionality",ln[ln.PluralCase=20]="PluralCase",ln[ln.ExtraData=21]="ExtraData",ln))();const iE="en-US";let $L=iE;function dM(n){J(n,"Expected localeId to be defined"),"string"==typeof n&&($L=n.toLowerCase().replace(/_/g,"-"))}function pM(n,e,t,i,r){if(n=be(n),Array.isArray(n))for(let s=0;s<n.length;s++)pM(n[s],e,t,i,r);else{const s=pi(),o=Vt();let a=Lc(n)?n:be(n.provide),l=zw(n);const c=is(),u=1048575&c.providerIndexes,h=c.directiveStart,f=c.providerIndexes>>20;if(Lc(n)||!n.multi){const g=new zh(l,r,De),m=mM(a,e,r?u:u+f,h);-1===m?(Cc(js(c,o),s,a),gM(s,n,e.length),e.push(a),c.directiveStart++,c.directiveEnd++,r&&(c.providerIndexes+=1048576),t.push(g),o.push(g)):(t[m]=g,o[m]=g)}else{const g=mM(a,e,u+f,h),m=mM(a,e,u,u+f),w=g>=0&&t[g],S=m>=0&&t[m];if(r&&!S||!r&&!w){Cc(js(c,o),s,a);const U=function(n,e,t,i,r){const s=new zh(n,t,De);return s.multi=[],s.index=e,s.componentProviders=0,gk(s,r,i&&!t),s}(r?gK:pK,t.length,r,i,l);!r&&S&&(t[m].providerFactory=U),gM(s,n,e.length,0),e.push(a),c.directiveStart++,c.directiveEnd++,r&&(c.providerIndexes+=1048576),t.push(U),o.push(U)}else gM(s,n,g>-1?g:m,gk(t[r?m:g],l,!r&&i));!r&&i&&S&&t[m].componentProviders++}}}function gM(n,e,t,i){const r=Lc(e);if(r||function(n){return!!n.useClass}(e)){const o=(e.useClass||e).prototype.ngOnDestroy;if(o){const a=n.destroyHooks||(n.destroyHooks=[]);if(!r&&e.multi){const l=a.indexOf(t);-1===l?a.push(t,[i,o]):a[l+1].push(i,o)}else a.push(t,o)}}}function gk(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function mM(n,e,t,i){for(let r=t;r<i;r++)if(e[r]===n)return r;return-1}function pK(n,e,t,i){return _M(this.multi,[])}function gK(n,e,t,i){const r=this.multi;let s;if(this.providerFactory){const o=this.providerFactory.componentProviders,a=Id(t,t[1],this.providerFactory.index,i);s=a.slice(0,o),_M(r,s);for(let l=o;l<a.length;l++)s.push(a[l])}else s=[],_M(r,s);return s}function _M(n,e){for(let t=0;t<n.length;t++)e.push((0,n[t])());return e}function Kn(n,e=[]){return t=>{t.providersResolver=(i,r)=>function(n,e,t){const i=pi();if(i.firstCreatePass){const r=Sa(n);pM(t,i.data,i.blueprint,r,!0),pM(e,i.data,i.blueprint,r,!1)}}(i,r?r(n):n,e)}}class mk{}const yk="ngComponent";class yK{resolveComponentFactory(e){throw function(n){const e=Error(`No component factory found for ${rt(n)}. Did you add it to @NgModule.entryComponents?`);return e[yk]=n,e}(e)}}class pl{}function lE(...n){}function mg(n,e){return new En(Xs(n,e))}pl.NULL=new yK;const wK=function(){return mg(is(),Vt())};let En=(()=>{class n{constructor(t){this.nativeElement=t}}return n.__NG_ELEMENT_ID__=wK,n})();function vk(n){return n instanceof En?n.nativeElement:n}class hf{}let vM=(()=>{class n{}return n.\u0275prov=We({token:n,providedIn:"root",factory:()=>null}),n})();class Fu{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const bk=new Fu("12.2.5");class wk{constructor(){}supports(e){return Ry(e)}create(e){return new AK(e)}}const TK=(n,e)=>e;class AK{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||TK}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,i=this._removalsHead,r=0,s=null;for(;t||i;){const o=!i||t&&t.currentIndex<Sk(i,r,s)?t:i,a=Sk(o,r,s),l=o.currentIndex;if(o===i)r--,i=i._nextRemoved;else if(t=t._next,null==o.previousIndex)r++;else{s||(s=[]);const c=a-r,u=l-r;if(c!=u){for(let f=0;f<c;f++){const g=f<s.length?s[f]:s[f]=0,m=g+f;u<=m&&m<c&&(s[f]=g+1)}s[o.previousIndex]=u-c}}a!==l&&e(o,a,l)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!Ry(e))throw new Error(`Error trying to diff '${rt(e)}'. Only arrays and iterables are allowed`);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let r,s,o,t=this._itHead,i=!1;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),null!==t&&Object.is(t.trackById,o)?(i&&(t=this._verifyReinsertion(t,s,o,a)),Object.is(t.item,s)||this._addIdentityChange(t,s)):(t=this._mismatch(t,s,o,a),i=!0),t=t._next}else r=0,function(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{const t=n[Jp()]();let i;for(;!(i=t.next()).done;)e(i.value)}}(e,a=>{o=this._trackByFn(r,a),null!==t&&Object.is(t.trackById,o)?(i&&(t=this._verifyReinsertion(t,a,o,r)),Object.is(t.item,a)||this._addIdentityChange(t,a)):(t=this._mismatch(t,a,o,r),i=!0),t=t._next,r++}),this.length=r;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,i,r){let s;return null===e?s=this._itTail:(s=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,r)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,r)):e=this._addAfter(new MK(t,i),s,r),e}_verifyReinsertion(e,t,i,r){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==s?e=this._reinsertAfter(s,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const r=e._prevRemoved,s=e._nextRemoved;return null===r?this._removalsHead=s:r._nextRemoved=s,null===s?this._removalsTail=r:s._prevRemoved=r,this._insertAfter(e,t,i),this._addToMoves(e,i),e}_moveAfter(e,t,i){return this._unlink(e),this._insertAfter(e,t,i),this._addToMoves(e,i),e}_addAfter(e,t,i){return this._insertAfter(e,t,i),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,i){const r=null===t?this._itHead:t._next;return e._next=r,e._prev=t,null===r?this._itTail=e:r._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new Ek),this._linkedRecords.put(e),e.currentIndex=i,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,i=e._next;return null===t?this._itHead=i:t._next=i,null===i?this._itTail=t:i._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new Ek),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class MK{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class DK{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===t||t<=i.currentIndex)&&Object.is(i.trackById,e))return i;return null}remove(e){const t=e._prevDup,i=e._nextDup;return null===t?this._head=i:t._nextDup=i,null===i?this._tail=t:i._prevDup=t,null===this._head}}class Ek{constructor(){this.map=new Map}put(e){const t=e.trackById;let i=this.map.get(t);i||(i=new DK,this.map.set(t,i)),i.add(e)}get(e,t){const r=this.map.get(e);return r?r.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function Sk(n,e,t){const i=n.previousIndex;if(null===i)return i;let r=0;return t&&i<t.length&&(r=t[i]),i+e+r}class xk{constructor(){}supports(e){return e instanceof Map||tM(e)}create(){return new IK}}class IK{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let t;for(t=this._mapHead;null!==t;t=t._next)e(t)}forEachPreviousItem(e){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}forEachChangedItem(e){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}diff(e){if(e){if(!(e instanceof Map||tM(e)))throw new Error(`Error trying to diff '${rt(e)}'. Only maps and objects are allowed`)}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(e,(i,r)=>{if(t&&t.key===r)this._maybeAddToChanges(t,i),this._appendAfter=t,t=t._next;else{const s=this._getOrCreateRecordForKey(r,i);t=this._insertBeforeOrAppend(t,s)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let i=t;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,t){if(e){const i=e._prev;return t._next=e,t._prev=i,e._prev=t,i&&(i._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(e,t){if(this._records.has(e)){const r=this._records.get(e);this._maybeAddToChanges(r,t);const s=r._prev,o=r._next;return s&&(s._next=o),o&&(o._prev=s),r._next=null,r._prev=null,r}const i=new OK(e);return this._records.set(e,i),i.currentValue=t,this._addToAdditions(i),i}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(i=>t(e[i],i))}}class OK{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function Ck(){return new _g([new wk])}let _g=(()=>{class n{constructor(t){this.factories=t}static create(t,i){if(null!=i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||Ck()),deps:[[n,new rl,new Xr]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(null!=i)return i;throw new Error(`Cannot find a differ supporting object '${t}' of type '${function(n){return n.name||typeof n}(t)}'`)}}return n.\u0275prov=We({token:n,providedIn:"root",factory:Ck}),n})();function Tk(){return new yg([new xk])}let yg=(()=>{class n{constructor(t){this.factories=t}static create(t,i){if(i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||Tk()),deps:[[n,new rl,new Xr]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(i)return i;throw new Error(`Cannot find a differ supporting object '${t}'`)}}return n.\u0275prov=We({token:n,providedIn:"root",factory:Tk}),n})();function cE(n,e,t,i,r=!1){for(;null!==t;){const s=e[t.index];if(null!==s&&i.push(vr(s)),$o(s))for(let a=10;a<s.length;a++){const l=s[a],c=l[1].firstChild;null!==c&&cE(l[1],l,c,i)}const o=t.type;if(8&o)cE(n,e,t.child,i);else if(32&o){const a=W_(t,e);let l;for(;l=a();)i.push(l)}else if(16&o){const a=ow(e,t);if(Array.isArray(a))i.push(...a);else{const l=tf(e[16]);cE(l[1],l,a,i,!0)}}t=r?t.projectionNext:t.next}return i}class Uy{constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const e=this._lView,t=e[1];return cE(t,e,t.firstChild,[])}get context(){return this._lView[8]}set context(e){this._lView[8]=e}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[3];if($o(e)){const t=e[8],i=t?t.indexOf(this):-1;i>-1&&(Q_(e,i),Ll(t,i))}this._attachedToViewContainer=!1}Z_(this._lView[1],this._lView)}onDestroy(e){Aw(this._lView[1],this._lView,null,e)}markForCheck(){_y(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){vy(this._lView[1],this._lView,this.context)}checkNoChanges(){!function(n,e,t){dp(!0);try{vy(n,e,t)}finally{dp(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function(n,e){$d(n,e,e[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new Error("This view is already attached to a ViewContainer!");this._appRef=e}}class NK extends Uy{constructor(e){super(e),this._view=e}detectChanges(){kw(this._view)}checkNoChanges(){!function(n){dp(!0);try{kw(n)}finally{dp(!1)}}(this._view)}get context(){return null}}const FK=function(n){return function(n,e,t){if(wd(n)&&!t){const i=Vs(n.index,e);return new Uy(i,i)}return 47&n.type?new Uy(e[16],e):null}(is(),Vt(),16==(16&n))};let ss=(()=>{class n{}return n.__NG_ELEMENT_ID__=FK,n})();const BK=[new xk],jK=new _g([new wk]),UK=new yg(BK),HK=function(){return uE(is(),Vt())};let ko=(()=>{class n{}return n.__NG_ELEMENT_ID__=HK,n})();const GK=ko,$K=class extends GK{constructor(e,t,i){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=i}createEmbeddedView(e){const t=this._declarationTContainer.tViews,i=of(this._declarationLView,t,e,16,null,t.declTNode,null,null,null,null);i[17]=this._declarationLView[this._declarationTContainer.index];const s=this._declarationLView[19];return null!==s&&(i[19]=s.createEmbeddedView(t)),af(t,i,e),new Uy(i)}};function uE(n,e){return 4&n.type?new $K(e,n,mg(n,e)):null}class zc{}const YK=function(){return Ik(is(),Vt())};let Is=(()=>{class n{}return n.__NG_ELEMENT_ID__=YK,n})();const XK=Is,Mk=class extends XK{constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return mg(this._hostTNode,this._hostLView)}get injector(){return new qo(this._hostTNode,this._hostLView)}get parentInjector(){const e=Gh(this._hostTNode,this._hostLView);if(ab(e)){const t=el(e,this._hostLView),i=Ad(e);return new qo(t[1].data[i+8],t)}return new qo(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=Dk(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-10}createEmbeddedView(e,t,i){const r=e.createEmbeddedView(t||{});return this.insert(r,i),r}createComponent(e,t,i,r,s){const o=i||this.parentInjector;if(!s&&null==e.ngModule&&o){const l=o.get(zc,null);l&&(s=l)}const a=e.create(o,r,void 0,s);return this.insert(a.hostView,t),a}insert(e,t){const i=e._lView,r=i[1];if(function(n){return $o(n[3])}(i)){const u=this.indexOf(e);if(-1!==u)this.detach(u);else{const h=i[3],f=new Mk(h,h[6],h[3]);f.detach(f.indexOf(e))}}const s=this._adjustIndex(t),o=this._lContainer;!function(n,e,t,i){const r=10+i,s=t.length;i>0&&(t[r-1][4]=e),i<s-10?(e[4]=t[r],Yh(t,10+i,e)):(t.push(e),e[4]=null),e[3]=t;const o=e[17];null!==o&&t!==o&&function(n,e){const t=n[9];e[16]!==e[3][3][16]&&(n[2]=!0),null===t?n[9]=[e]:t.push(e)}(o,e);const a=e[19];null!==a&&a.insertView(n),e[2]|=128}(r,i,o,s);const a=Hp(s,o),l=i[11],c=Up(l,o[7]);return null!==c&&function(n,e,t,i,r,s){i[0]=r,i[6]=e,$d(n,i,t,1,r,s)}(r,o[6],l,i,c,a),e.attachToViewContainerRef(),Yh(bM(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=Dk(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),i=Q_(this._lContainer,t);i&&(Ll(bM(this._lContainer),t),Z_(i[1],i))}detach(e){const t=this._adjustIndex(e,-1),i=Q_(this._lContainer,t);return i&&null!=Ll(bM(this._lContainer),t)?new Uy(i):null}_adjustIndex(e,t=0){return null==e?this.length+t:e}};function Dk(n){return n[8]}function bM(n){return n[8]||(n[8]=[])}function Ik(n,e){let t;const i=e[n.index];if($o(i))t=i;else{let r;if(8&n.type)r=vr(i);else{const s=e[11];r=s.createComment("");const o=Xs(n,e);al(s,Up(s,o),r,function(n,e){return ar(n)?n.nextSibling(e):e.nextSibling}(s,o),!1)}e[n.index]=t=Lw(i,e,r,n),Xp(e,t)}return new Mk(t,n,e)}const Eg={};class Xk extends pl{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=Li(e);return new Zk(t,this.ngModule)}}function Qk(n){const e=[];for(let t in n)n.hasOwnProperty(t)&&e.push({propName:n[t],templateName:t});return e}const WX=new Gt("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>Gb});class Zk extends mk{constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function(n){return n.map(iA).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}get inputs(){return Qk(this.componentDef.inputs)}get outputs(){return Qk(this.componentDef.outputs)}create(e,t,i,r){const s=(r=r||this.ngModule)?function(n,e){return{get:(t,i,r)=>{const s=n.get(t,Eg,r);return s!==Eg||i===Eg?s:e.get(t,i,r)}}}(e,r.injector):e,o=s.get(hf,mu),a=s.get(vM,null),l=o.createRenderer(null,this.componentDef),c=this.componentDef.selectors[0][0]||"div",u=i?function(n,e,t){if(ar(n))return n.selectRootElement(e,t===Yt.ShadowDom);let i="string"==typeof e?n.querySelector(e):e;return i.textContent="",i}(l,i,this.componentDef.encapsulation):X_(o.createRenderer(null,this.componentDef),c,function(n){const e=n.toLowerCase();return"svg"===e?"http://www.w3.org/2000/svg":"math"===e?"http://www.w3.org/1998/MathML/":null}(c)),h=this.componentDef.onPush?576:528,f=function(n,e){return{components:[],scheduler:n||Gb,clean:BA,playerHandler:e||null,flags:0}}(),g=Kp(0,null,null,1,0,null,null,null,null,null),m=of(null,g,f,h,null,null,o,l,a,s);let w,S;jh(m);try{const U=function(n,e,t,i,r,s){const o=t[1];t[20]=n;const l=qd(o,20,2,"#host",null),c=l.mergedAttrs=e.hostAttrs;null!==c&&(Zp(l,c,!0),null!==n&&(_p(r,n,c),null!==l.classes&&ny(r,n,l.classes),null!==l.styles&&cw(r,n,l.styles)));const u=i.createRenderer(n,e),h=of(t,Yp(e),null,e.onPush?64:16,t[20],l,i,u,s||null,null);return o.firstCreatePass&&(Cc(js(l,t),o,e.type),Fw(o,l),fy(l,t.length,1)),Xp(t,h),t[20]=h}(u,this.componentDef,m,o,l);if(u)if(i)_p(l,u,["ng-version",bk.full]);else{const{attrs:D,classes:ie}=function(n){const e=[],t=[];let i=1,r=2;for(;i<n.length;){let s=n[i];if("string"==typeof s)2===r?""!==s&&e.push(s,n[++i]):8===r&&t.push(s);else{if(!Oa(r))break;r=s}i++}return{attrs:e,classes:t}}(this.componentDef.selectors[0]);D&&_p(l,u,D),ie&&ie.length>0&&ny(l,u,ie.join(" "))}if(S=r_(g,20),void 0!==t){const D=S.projection=[];for(let ie=0;ie<this.ngContentSelectors.length;ie++){const _e=t[ie];D.push(null!=_e?Array.from(_e):null)}}w=function(n,e,t,i,r){const s=t[1],o=function(n,e,t){const i=is();n.firstCreatePass&&(t.providersResolver&&t.providersResolver(t),py(n,i,e,Yd(n,e,1,null),t));const r=Id(e,n,i.directiveStart,i);Ts(r,e);const s=Xs(i,e);return s&&Ts(s,e),r}(s,t,e);if(i.components.push(o),n[8]=o,r&&r.forEach(l=>l(o,e)),e.contentQueries){const l=is();e.contentQueries(1,o,l.directiveStart)}const a=is();return!s.firstCreatePass||null===e.hostBindings&&null===e.hostAttrs||(po(a.index),Nw(t[1],a,0,a.directiveStart,a.directiveEnd,e),Pw(e,o)),o}(U,this.componentDef,m,f,[Q9]),af(g,m,null)}finally{ai()}return new KX(this.componentType,w,mg(S,m),m,S)}}class KX extends class{}{constructor(e,t,i,r,s){super(),this.location=i,this._rootLView=r,this._tNode=s,this.instance=t,this.hostView=this.changeDetectorRef=new NK(r),this.componentType=e}get injector(){return new qo(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}const Sg=new Map;class ZX extends zc{constructor(e,t){super(),this._parent=t,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new Xk(this);const i=Ao(e),r=function(n){return n[gT]||null}(e);r&&dM(r),this._bootstrapComponents=ol(i.bootstrap),this._r3Injector=Uw(e,t,[{provide:zc,useValue:this},{provide:pl,useValue:this.componentFactoryResolver}],rt(e)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(e)}get(e,t=zn.THROW_IF_NOT_FOUND,i=bn.Default){return e===zn||e===zc||e===Qd?this:this._r3Injector.get(e,t,i)}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class NM extends class{}{constructor(e){super(),this.moduleType=e,null!==Ao(e)&&function(n){const e=new Set;!function t(i){const r=Ao(i,!0),s=r.id;null!==s&&(function(n,e,t){if(e&&e!==t)throw new Error(`Duplicate module registered for ${n} - ${rt(e)} vs ${rt(e.name)}`)}(s,Sg.get(s),i),Sg.set(s,i));const o=ol(r.imports);for(const a of o)e.has(a)||(e.add(a),t(a))}(n)}(e)}create(e){return new ZX(this.moduleType,e)}}function gE(n,e,t){const i=Es()+n,r=Vt();return r[i]===An?Bc(r,i,t?e.call(t):e()):function(n,e){return n[e]}(r,i)}function n3(n,e,t,i,r,s){const o=e+t;return yo(n,o,r)?Bc(n,o+1,s?i.call(s,r):i(r)):function(n,e){const t=n[e];return t===An?void 0:t}(n,o+1)}function _l(n,e){const t=pi();let i;const r=n+20;t.firstCreatePass?(i=function(n,e){if(e)for(let t=e.length-1;t>=0;t--){const i=e[t];if(n===i.name)return i}throw new Je("302",`The pipe '${n}' could not be found!`)}(e,t.pipeRegistry),t.data[r]=i,i.onDestroy&&(t.destroyHooks||(t.destroyHooks=[])).push(r,i.onDestroy)):i=t.data[r];const s=i.factory||(i.factory=Sc(i.type)),o=ba(De);try{const a=yp(!1),l=s();return yp(a),function(n,e,t,i){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=i}(t,Vt(),r,l),l}finally{ba(o)}}function yl(n,e,t){const i=n+20,r=Vt(),s=Sd(r,i);return function(n,e){Gl.isWrapped(e)&&(e=Gl.unwrap(e),n[Ln.lFrame.bindingIndex]=An);return e}(r,function(n,e){return n[1].data[e].pure}(r,i)?n3(r,Es(),e,s.transform,t,s):s.transform(t))}function PM(n){return e=>{setTimeout(n,void 0,e)}}const dn=class extends oe{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,i){var r,s,o;let a=e,l=t||(()=>null),c=i;if(e&&"object"==typeof e){const h=e;a=null===(r=h.next)||void 0===r?void 0:r.bind(h),l=null===(s=h.error)||void 0===s?void 0:s.bind(h),c=null===(o=h.complete)||void 0===o?void 0:o.bind(h)}this.__isAsync&&(l=PM(l),a&&(a=PM(a)),c&&(c=PM(c)));const u=super.subscribe({next:a,error:l,complete:c});return e instanceof C&&e.add(u),u}};function fQ(){return this._results[Jp()]()}class gf{constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=Jp(),i=gf.prototype;i[t]||(i[t]=fQ)}get changes(){return this._changes||(this._changes=new dn)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){const i=this;i.dirty=!1;const r=Ko(e);(this._changesDetected=!function(n,e,t){if(n.length!==e.length)return!1;for(let i=0;i<n.length;i++){let r=n[i],s=e[i];if(t&&(r=t(r),s=t(s)),s!==r)return!1}return!0}(i._results,r,t))&&(i._results=r,i.length=r.length,i.last=r[this.length-1],i.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;class FM{constructor(e){this.queryList=e,this.matches=null}clone(){return new FM(this.queryList)}setDirty(){this.queryList.setDirty()}}class LM{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const i=null!==e.contentQueries?e.contentQueries[0]:t.length,r=[];for(let s=0;s<i;s++){const o=t.getByIndex(s);r.push(this.queries[o.indexInDeclarationView].clone())}return new LM(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==h3(e,t).matches&&this.queries[t].setDirty()}}class l3{constructor(e,t,i=null){this.predicate=e,this.flags=t,this.read=i}}class kM{constructor(e=[]){this.queries=e}elementStart(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let i=0;i<this.length;i++){const r=null!==t?t.length:0,s=this.getByIndex(i).embeddedTView(e,r);s&&(s.indexInDeclarationView=i,null!==t?t.push(s):t=[s])}return null!==t?new kM(t):null}template(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class BM{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new BM(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let i=e.parent;for(;null!==i&&8&i.type&&i.index!==t;)i=i.parent;return t===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const s=i[r];this.matchTNodeWithReadOption(e,t,mQ(t,s)),this.matchTNodeWithReadOption(e,t,Dd(t,e,s,!1,!1))}else i===ko?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,Dd(t,e,i,!1,!1))}matchTNodeWithReadOption(e,t,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===En||r===Is||r===ko&&4&t.type)this.addMatch(t.index,-2);else{const s=Dd(t,e,r,!1,!1);null!==s&&this.addMatch(t.index,s)}else this.addMatch(t.index,i)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function mQ(n,e){const t=n.localNames;if(null!==t)for(let i=0;i<t.length;i+=2)if(t[i]===e)return t[i+1];return null}function yQ(n,e,t,i){return-1===t?function(n,e){return 11&n.type?mg(n,e):4&n.type?uE(n,e):null}(e,n):-2===t?function(n,e,t){return t===En?mg(e,n):t===ko?uE(e,n):t===Is?Ik(e,n):void 0}(n,e,i):Id(n,n[1],t,e)}function c3(n,e,t,i){const r=e[19].queries[i];if(null===r.matches){const s=n.data,o=t.matches,a=[];for(let l=0;l<o.length;l+=2){const c=o[l];a.push(c<0?null:yQ(e,s[c],o[l+1],t.metadata.read))}r.matches=a}return r.matches}function VM(n,e,t,i){const r=n.queries.getByIndex(t),s=r.matches;if(null!==s){const o=c3(n,e,r,t);for(let a=0;a<s.length;a+=2){const l=s[a];if(l>0)i.push(o[a/2]);else{const c=s[a+1],u=e[-l];for(let h=10;h<u.length;h++){const f=u[h];f[17]===f[3]&&VM(f[1],f,c,i)}if(null!==u[9]){const h=u[9];for(let f=0;f<h.length;f++){const g=h[f];VM(g[1],g,c,i)}}}}}return i}function gi(n){const e=Vt(),t=pi(),i=sb();c_(i+1);const r=h3(t,i);if(n.dirty&&Pl(e)===(2==(2&r.metadata.flags))){if(null===r.matches)n.reset([]);else{const s=r.crossesNgTemplate?VM(t,e,i,[]):c3(t,e,r,i);n.reset(s,vk),n.notifyOnChanges()}return!0}return!1}function Ir(n,e,t){const i=pi();i.firstCreatePass&&(function(n,e,t){null===n.queries&&(n.queries=new kM),n.queries.track(new BM(e,t))}(i,new l3(n,e,t),-1),2==(2&e)&&(i.staticViewQueries=!0)),function(n,e,t){const i=new gf(4==(4&t));Aw(n,e,i,i.destroy),null===e[19]&&(e[19]=new LM),e[19].queries.push(new FM(i))}(i,Vt(),e)}function mi(){return function(n,e){return n[19].queries[e].queryList}(Vt(),sb())}function h3(n,e){return n.queries.getByIndex(e)}const mf=new Gt("Application Initializer");let Cg=(()=>{class n{constructor(t){this.appInits=t,this.resolve=lE,this.reject=lE,this.initialized=!1,this.done=!1,this.donePromise=new Promise((i,r)=>{this.resolve=i,this.reject=r})}runInitializers(){if(this.initialized)return;const t=[],i=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let r=0;r<this.appInits.length;r++){const s=this.appInits[r]();if(Py(s))t.push(s);else if(Zw(s)){const o=new Promise((a,l)=>{s.subscribe({complete:a,error:l})});t.push(o)}}Promise.all(t).then(()=>{i()}).catch(r=>{this.reject(r)}),0===t.length&&i(),this.initialized=!0}}return n.\u0275fac=function(t){return new(t||n)(Ie(mf,8))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const Jy=new Gt("AppId"),KQ={provide:Jy,useFactory:function(){return`${$M()}${$M()}${$M()}`},deps:[]};function $M(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const I3=new Gt("Platform Initializer"),Hc=new Gt("Platform ID"),yE=new Gt("appBootstrapListener");let vE=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const Lu=new Gt("LocaleId"),O3=new Gt("DefaultCurrencyCode");class QQ{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}const WM=function(n){return new NM(n)},ZQ=WM,JQ=function(n){return Promise.resolve(WM(n))},R3=function(n){const e=WM(n),i=ol(Ao(n).declarations).reduce((r,s)=>{const o=Li(s);return o&&r.push(new Zk(o)),r},[]);return new QQ(e,i)},eZ=R3,tZ=function(n){return Promise.resolve(R3(n))};let _f=(()=>{class n{constructor(){this.compileModuleSync=ZQ,this.compileModuleAsync=JQ,this.compileModuleAndAllComponentsSync=eZ,this.compileModuleAndAllComponentsAsync=tZ}clearCache(){}clearCacheFor(t){}getModuleId(t){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const N3=new Gt("compilerOptions"),iZ=(()=>Promise.resolve(0))();function qM(n){"undefined"==typeof Zone?iZ.then(()=>{n&&n.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",n)}class yn{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new dn(!1),this.onMicrotaskEmpty=new dn(!1),this.onStable=new dn(!1),this.onError=new dn(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&t,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function(){let n=ti.requestAnimationFrame,e=ti.cancelAnimationFrame;if("undefined"!=typeof Zone&&n&&e){const t=n[Zone.__symbol__("OriginalDelegate")];t&&(n=t);const i=e[Zone.__symbol__("OriginalDelegate")];i&&(e=i)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function(n){const e=()=>{!function(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(ti,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,KM(n),n.isCheckStableRunning=!0,YM(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),KM(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,i,r,s,o,a)=>{try{return P3(n),t.invokeTask(r,s,o,a)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||n.shouldCoalesceRunChangeDetection)&&e(),F3(n)}},onInvoke:(t,i,r,s,o,a,l)=>{try{return P3(n),t.invoke(r,s,o,a,l)}finally{n.shouldCoalesceRunChangeDetection&&e(),F3(n)}},onHasTask:(t,i,r,s)=>{t.hasTask(r,s),i===r&&("microTask"==s.change?(n._hasPendingMicrotasks=s.microTask,KM(n),YM(n)):"macroTask"==s.change&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,i,r,s)=>(t.handleError(r,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}(r)}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!yn.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(yn.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,r){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+r,e,sZ,lE,lE);try{return s.runTask(o,t,i)}finally{s.cancelTask(o)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}}const sZ={};function YM(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function KM(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function P3(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function F3(n){n._nesting--,YM(n)}class lZ{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new dn,this.onMicrotaskEmpty=new dn,this.onStable=new dn,this.onError=new dn}run(e,t,i){return e.apply(t,i)}runGuarded(e,t,i){return e.apply(t,i)}runOutsideAngular(e){return e()}runTask(e,t,i,r){return e.apply(t,i)}}let XM=(()=>{class n{constructor(t){this._ngZone=t,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{yn.assertNotInAngularZone(),qM(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())qM(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(t)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,i,r){let s=-1;i&&i>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),t(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:t,timeoutId:s,updateCb:r})}whenStable(t,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(t,i,r){return[]}}return n.\u0275fac=function(t){return new(t||n)(Ie(yn))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),L3=(()=>{class n{constructor(){this._applications=new Map,QM.addToWindow(this)}registerApplication(t,i){this._applications.set(t,i)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,i=!0){return QM.findTestabilityInTree(this,t,i)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class cZ{addToWindow(e){}findTestabilityInTree(e,t,i){return null}}let QM=new cZ,k3=!0,B3=!1;function oa(){return B3=!0,k3}let Ql;const V3=new Gt("AllowMultipleToken");function j3(n,e,t=[]){const i=`Platform: ${e}`,r=new Gt(i);return(s=[])=>{let o=JM();if(!o||o.injector.get(V3,!1))if(n)n(t.concat(s).concat({provide:r,useValue:!0}));else{const a=t.concat(s).concat({provide:r,useValue:!0},{provide:Ou,useValue:"platform"});!function(n){if(Ql&&!Ql.destroyed&&!Ql.injector.get(V3,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");Ql=n.get(U3);const e=n.get(I3,null);e&&e.forEach(t=>t())}(zn.create({providers:a,name:i}))}return function(n){const e=JM();if(!e)throw new Error("No platform exists!");if(!e.injector.get(n,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return e}(r)}}function JM(){return Ql&&!Ql.destroyed?Ql:null}let U3=(()=>{class n{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,i){const a=function(n,e){let t;return t="noop"===n?new lZ:("zone.js"===n?void 0:n)||new yn({enableLongStackTrace:oa(),shouldCoalesceEventChangeDetection:!!(null==e?void 0:e.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==e?void 0:e.ngZoneRunCoalescing)}),t}(i?i.ngZone:void 0,{ngZoneEventCoalescing:i&&i.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:i&&i.ngZoneRunCoalescing||!1}),l=[{provide:yn,useValue:a}];return a.run(()=>{const c=zn.create({providers:l,parent:this.injector,name:t.moduleType.name}),u=t.create(c),h=u.injector.get(ea,null);if(!h)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return a.runOutsideAngular(()=>{const f=a.onError.subscribe({next:g=>{h.handleError(g)}});u.onDestroy(()=>{eD(this._modules,u),f.unsubscribe()})}),function(n,e,t){try{const i=t();return Py(i)?i.catch(r=>{throw e.runOutsideAngular(()=>n.handleError(r)),r}):i}catch(i){throw e.runOutsideAngular(()=>n.handleError(i)),i}}(h,a,()=>{const f=u.injector.get(Cg);return f.runInitializers(),f.donePromise.then(()=>(dM(u.injector.get(Lu,iE)||iE),this._moduleDoBootstrap(u),u))})})}bootstrapModule(t,i=[]){const r=z3({},i);return function(n,e,t){const i=new NM(t);return Promise.resolve(i)}(0,0,t).then(s=>this.bootstrapModuleFactory(s,r))}_moduleDoBootstrap(t){const i=t.injector.get(Jd);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!t.instance.ngDoBootstrap)throw new Error(`The module ${rt(t.instance.constructor)} was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.`);t.instance.ngDoBootstrap(i)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(t=>t.destroy()),this._destroyListeners.forEach(t=>t()),this._destroyed=!0}get destroyed(){return this._destroyed}}return n.\u0275fac=function(t){return new(t||n)(Ie(zn))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();function z3(n,e){return Array.isArray(e)?e.reduce(z3,n):Object.assign(Object.assign({},n),e)}let Jd=(()=>{class n{constructor(t,i,r,s,o){this._zone=t,this._injector=i,this._exceptionHandler=r,this._componentFactoryResolver=s,this._initStatus=o,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const a=new O(c=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{c.next(this._stable),c.complete()})}),l=new O(c=>{let u;this._zone.runOutsideAngular(()=>{u=this._zone.onStable.subscribe(()=>{yn.assertNotInAngularZone(),qM(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,c.next(!0))})})});const h=this._zone.onUnstable.subscribe(()=>{yn.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{c.next(!1)}))});return()=>{u.unsubscribe(),h.unsubscribe()}});this.isStable=Nn(a,l.pipe(ys()))}bootstrap(t,i){if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");let r;r=t instanceof mk?t:this._componentFactoryResolver.resolveComponentFactory(t),this.componentTypes.push(r.componentType);const s=function(n){return n.isBoundToModule}(r)?void 0:this._injector.get(zc),a=r.create(zn.NULL,[],i||r.selector,s),l=a.location.nativeElement,c=a.injector.get(XM,null),u=c&&a.injector.get(L3);return c&&u&&u.registerApplication(l,c),a.onDestroy(()=>{this.detachView(a.hostView),eD(this.components,a),u&&u.unregisterApplication(l)}),this._loadComponent(a),a}tick(){if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(t))}finally{this._runningTick=!1}}attachView(t){const i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){const i=t;eD(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t),this._injector.get(yE,[]).concat(this._bootstrapListeners).forEach(r=>r(t))}ngOnDestroy(){this._views.slice().forEach(t=>t.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return n.\u0275fac=function(t){return new(t||n)(Ie(yn),Ie(zn),Ie(ea),Ie(pl),Ie(Cg))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();function eD(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}const LZ=j3(null,"core",[{provide:Hc,useValue:"unknown"},{provide:U3,deps:[zn]},{provide:L3,deps:[]},{provide:vE,deps:[]}]),UZ=[{provide:Jd,useClass:Jd,deps:[yn,zn,ea,pl,Cg]},{provide:WX,deps:[yn],useFactory:function(n){let e=[];return n.onStable.subscribe(()=>{for(;e.length;)e.pop()()}),function(t){e.push(t)}}},{provide:Cg,useClass:Cg,deps:[[new Xr,mf]]},{provide:_f,useClass:_f,deps:[]},KQ,{provide:_g,useFactory:function(){return jK},deps:[]},{provide:yg,useFactory:function(){return UK},deps:[]},{provide:Lu,useFactory:function(n){return dM(n=n||"undefined"!=typeof $localize&&$localize.locale||iE),n},deps:[[new kd(Lu),new Xr,new rl]]},{provide:O3,useValue:"USD"}];let HZ=(()=>{class n{constructor(t){}}return n.\u0275fac=function(t){return new(t||n)(Ie(Jd))},n.\u0275mod=an({type:n}),n.\u0275inj=Ct({providers:UZ}),n})(),OE=null;function Gc(){return OE}const un=new Gt("DocumentToken");var fs=(()=>((fs=fs||{})[fs.Zero=0]="Zero",fs[fs.One=1]="One",fs[fs.Two=2]="Two",fs[fs.Few=3]="Few",fs[fs.Many=4]="Many",fs[fs.Other=5]="Other",fs))();const tee=function(n){return function(n){const e=function(n){return n.toLowerCase().replace(/_/g,"-")}(n);let t=GL(e);if(t)return t;const i=e.split("-")[0];if(t=GL(i),t)return t;if("en"===i)return yY;throw new Error(`Missing locale data for the locale "${n}".`)}(n)[ln.PluralCase]};class UE{}let Iee=(()=>{class n extends UE{constructor(t){super(),this.locale=t}getPluralCategory(t,i){switch(tee(i||this.locale)(t)){case fs.Zero:return"zero";case fs.One:return"one";case fs.Two:return"two";case fs.Few:return"few";case fs.Many:return"many";default:return"other"}}}return n.\u0275fac=function(t){return new(t||n)(Ie(Lu))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();function DB(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const i=t.indexOf("="),[r,s]=-1==i?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}class Ree{constructor(e,t,i,r){this.$implicit=e,this.ngForOf=t,this.index=i,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let th=(()=>{class n{constructor(t,i,r){this._viewContainer=t,this._template=i,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const t=this._ngForOf;if(!this._differ&&t)try{this._differ=this._differs.find(t).create(this.ngForTrackBy)}catch(i){throw new Error(`Cannot find a differ supporting object '${t}' of type '${function(n){return n.name||typeof n}(t)}'. NgFor only supports binding to Iterables such as Arrays.`)}}if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const i=[];t.forEachOperation((r,s,o)=>{if(null==r.previousIndex){const a=this._viewContainer.createEmbeddedView(this._template,new Ree(null,this._ngForOf,-1,-1),null===o?void 0:o),l=new IB(r,a);i.push(l)}else if(null==o)this._viewContainer.remove(null===s?void 0:s);else if(null!==s){const a=this._viewContainer.get(s);this._viewContainer.move(a,o);const l=new IB(r,a);i.push(l)}});for(let r=0;r<i.length;r++)this._perViewChange(i[r].view,i[r].record);for(let r=0,s=this._viewContainer.length;r<s;r++){const o=this._viewContainer.get(r);o.context.index=r,o.context.count=s,o.context.ngForOf=this._ngForOf}t.forEachIdentityChange(r=>{this._viewContainer.get(r.currentIndex).context.$implicit=r.item})}_perViewChange(t,i){t.context.$implicit=i.item}static ngTemplateContextGuard(t,i){return!0}}return n.\u0275fac=function(t){return new(t||n)(De(Is),De(ko),De(_g))},n.\u0275dir=Bt({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),n})();class IB{constructor(e,t){this.record=e,this.view=t}}let ju=(()=>{class n{constructor(t,i){this._viewContainer=t,this._context=new Pee,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){OB("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){OB("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,i){return!0}}return n.\u0275fac=function(t){return new(t||n)(De(Is),De(ko))},n.\u0275dir=Bt({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),n})();class Pee{constructor(){this.$implicit=null,this.ngIf=null}}function OB(n,e){if(e&&!e.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${rt(e)}'.`)}class Bee{createSubscription(e,t){return e.subscribe({next:t,error:i=>{throw i}})}dispose(e){e.unsubscribe()}onDestroy(e){e.unsubscribe()}}class Vee{createSubscription(e,t){return e.then(t,i=>{throw i})}dispose(e){}onDestroy(e){}}const jee=new Vee,Uee=new Bee;let HE=(()=>{class n{constructor(t){this._ref=t,this._latestValue=null,this._subscription=null,this._obj=null,this._strategy=null}ngOnDestroy(){this._subscription&&this._dispose()}transform(t){return this._obj?t!==this._obj?(this._dispose(),this.transform(t)):this._latestValue:(t&&this._subscribe(t),this._latestValue)}_subscribe(t){this._obj=t,this._strategy=this._selectStrategy(t),this._subscription=this._strategy.createSubscription(t,i=>this._updateLatestValue(t,i))}_selectStrategy(t){if(Py(t))return jee;if(iL(t))return Uee;throw function(n,e){return Error(`InvalidPipeArgument: '${e}' for pipe '${rt(n)}'`)}(n,t)}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(t,i){t===this._obj&&(this._latestValue=i,this._ref.markForCheck())}}return n.\u0275fac=function(t){return new(t||n)(De(ss,16))},n.\u0275pipe=ks({name:"async",type:n,pure:!1}),n})(),Zr=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=an({type:n}),n.\u0275inj=Ct({providers:[{provide:UE,useClass:Iee}]}),n})();const kB="browser";function wf(n){return n===kB}class jB{}class DD extends class extends class{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function(n){OE||(OE=n)}(new DD)}onAndCancel(e,t,i){return e.addEventListener(t,i,!1),()=>{e.removeEventListener(t,i,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=(a0=a0||document.querySelector("base"),a0?a0.getAttribute("href"):null);return null==t?null:function(n){GE=GE||document.createElement("a"),GE.setAttribute("href",n);const e=GE.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){a0=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return DB(document.cookie,e)}}let GE,a0=null;const UB=new Gt("TRANSITION_ID"),hte=[{provide:mf,useFactory:function(n,e,t){return()=>{t.get(Cg).donePromise.then(()=>{const i=Gc(),r=e.querySelectorAll(`style[ng-transition="${n}"]`);for(let s=0;s<r.length;s++)i.remove(r[s])})}},deps:[UB,un,zn],multi:!0}];class ID{static init(){!function(n){QM=n}(new ID)}addToWindow(e){ti.getAngularTestability=(i,r=!0)=>{const s=e.findTestabilityInTree(i,r);if(null==s)throw new Error("Could not find testability for element.");return s},ti.getAllAngularTestabilities=()=>e.getAllTestabilities(),ti.getAllAngularRootElements=()=>e.getAllRootElements(),ti.frameworkStabilizers||(ti.frameworkStabilizers=[]),ti.frameworkStabilizers.push(i=>{const r=ti.getAllAngularTestabilities();let s=r.length,o=!1;const a=function(l){o=o||l,s--,0==s&&i(o)};r.forEach(function(l){l.whenStable(a)})})}findTestabilityInTree(e,t,i){if(null==t)return null;const r=e.getTestability(t);return null!=r?r:i?Gc().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null}}let fte=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const l0=new Gt("EventManagerPlugins");let WE=(()=>{class n{constructor(t,i){this._zone=i,this._eventNameToPlugin=new Map,t.forEach(r=>r.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,i,r){return this._findPluginFor(i).addEventListener(t,i,r)}addGlobalEventListener(t,i,r){return this._findPluginFor(i).addGlobalEventListener(t,i,r)}getZone(){return this._zone}_findPluginFor(t){const i=this._eventNameToPlugin.get(t);if(i)return i;const r=this._plugins;for(let s=0;s<r.length;s++){const o=r[s];if(o.supports(t))return this._eventNameToPlugin.set(t,o),o}throw new Error(`No event manager plugin found for event ${t}`)}}return n.\u0275fac=function(t){return new(t||n)(Ie(l0),Ie(yn))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class OD{constructor(e){this._doc=e}addGlobalEventListener(e,t,i){const r=Gc().getGlobalEventTarget(this._doc,e);if(!r)throw new Error(`Unsupported event target ${r} for event ${t}`);return this.addEventListener(r,t,i)}}let HB=(()=>{class n{constructor(){this._stylesSet=new Set}addStyles(t){const i=new Set;t.forEach(r=>{this._stylesSet.has(r)||(this._stylesSet.add(r),i.add(r))}),this.onStylesAdded(i)}onStylesAdded(t){}getAllStyles(){return Array.from(this._stylesSet)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),c0=(()=>{class n extends HB{constructor(t){super(),this._doc=t,this._hostNodes=new Map,this._hostNodes.set(t.head,[])}_addStylesToHost(t,i,r){t.forEach(s=>{const o=this._doc.createElement("style");o.textContent=s,r.push(i.appendChild(o))})}addHost(t){const i=[];this._addStylesToHost(this._stylesSet,t,i),this._hostNodes.set(t,i)}removeHost(t){const i=this._hostNodes.get(t);i&&i.forEach(GB),this._hostNodes.delete(t)}onStylesAdded(t){this._hostNodes.forEach((i,r)=>{this._addStylesToHost(t,r,i)})}ngOnDestroy(){this._hostNodes.forEach(t=>t.forEach(GB))}}return n.\u0275fac=function(t){return new(t||n)(Ie(un))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();function GB(n){Gc().remove(n)}const RD={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},ND=/%COMP%/g;function qE(n,e,t){for(let i=0;i<e.length;i++){let r=e[i];Array.isArray(r)?qE(n,r,t):(r=r.replace(ND,n),t.push(r))}return t}function qB(n){return e=>{if("__ngUnwrap__"===e)return n;!1===n(e)&&(e.preventDefault(),e.returnValue=!1)}}let YE=(()=>{class n{constructor(t,i,r){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.rendererByCompId=new Map,this.defaultRenderer=new PD(t)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;switch(i.encapsulation){case Yt.Emulated:{let r=this.rendererByCompId.get(i.id);return r||(r=new Mte(this.eventManager,this.sharedStylesHost,i,this.appId),this.rendererByCompId.set(i.id,r)),r.applyToHost(t),r}case 1:case Yt.ShadowDom:return new Dte(this.eventManager,this.sharedStylesHost,t,i);default:if(!this.rendererByCompId.has(i.id)){const r=qE(i.id,i.styles,[]);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(i.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return n.\u0275fac=function(t){return new(t||n)(Ie(WE),Ie(c0),Ie(Jy))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class PD{constructor(e){this.eventManager=e,this.data=Object.create(null)}destroy(){}createElement(e,t){return t?document.createElementNS(RD[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){e.appendChild(t)}insertBefore(e,t,i){e&&e.insertBefore(t,i)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let i="string"==typeof e?document.querySelector(e):e;if(!i)throw new Error(`The selector "${e}" did not match any elements`);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,r){if(r){t=r+":"+t;const s=RD[r];s?e.setAttributeNS(s,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){const r=RD[i];r?e.removeAttributeNS(r,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,r){r&(Po.DashCase|Po.Important)?e.style.setProperty(t,i,r&Po.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&Po.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e[t]=i}setValue(e,t){e.nodeValue=t}listen(e,t,i){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,qB(i)):this.eventManager.addEventListener(e,t,qB(i))}}class Mte extends PD{constructor(e,t,i,r){super(e),this.component=i;const s=qE(r+"-"+i.id,i.styles,[]);t.addStyles(s),this.contentAttr=function(n){return"_ngcontent-%COMP%".replace(ND,n)}(r+"-"+i.id),this.hostAttr=function(n){return"_nghost-%COMP%".replace(ND,n)}(r+"-"+i.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,t){const i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}}class Dte extends PD{constructor(e,t,i,r){super(e),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const s=qE(r.id,r.styles,[]);for(let o=0;o<s.length;o++){const a=document.createElement("style");a.textContent=s[o],this.shadowRoot.appendChild(a)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}let Ite=(()=>{class n extends OD{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r){return t.addEventListener(i,r,!1),()=>this.removeEventListener(t,i,r)}removeEventListener(t,i,r){return t.removeEventListener(i,r)}}return n.\u0275fac=function(t){return new(t||n)(Ie(un))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const XB=["alt","control","meta","shift"],kte={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},QB={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},Bte={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let Vte=(()=>{class n extends OD{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,i,r){const s=n.parseEventName(i),o=n.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Gc().onAndCancel(t,s.domEventName,o))}static parseEventName(t){const i=t.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const s=n._normalizeKey(i.pop());let o="";if(XB.forEach(l=>{const c=i.indexOf(l);c>-1&&(i.splice(c,1),o+=l+".")}),o+=s,0!=i.length||0===s.length)return null;const a={};return a.domEventName=r,a.fullKey=o,a}static getEventFullKey(t){let i="",r=function(n){let e=n.key;if(null==e){if(e=n.keyIdentifier,null==e)return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),3===n.location&&QB.hasOwnProperty(e)&&(e=QB[e]))}return kte[e]||e}(t);return r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),XB.forEach(s=>{s!=r&&Bte[s](t)&&(i+=s+".")}),i+=r,i}static eventCallback(t,i,r){return s=>{n.getEventFullKey(s)===t&&r.runGuarded(()=>i(s))}}static _normalizeKey(t){switch(t){case"esc":return"escape";default:return t}}}return n.\u0275fac=function(t){return new(t||n)(Ie(un))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const qte=j3(LZ,"browser",[{provide:Hc,useValue:kB},{provide:I3,useValue:function(){DD.makeCurrent(),ID.init()},multi:!0},{provide:un,useFactory:function(){return function(n){Hi=n}(document),document},deps:[]}]),Yte=[[],{provide:Ou,useValue:"root"},{provide:ea,useFactory:function(){return new ea},deps:[]},{provide:l0,useClass:Ite,multi:!0,deps:[un,yn,Hc]},{provide:l0,useClass:Vte,multi:!0,deps:[un]},[],{provide:YE,useClass:YE,deps:[WE,c0,Jy]},{provide:hf,useExisting:YE},{provide:HB,useExisting:c0},{provide:c0,useClass:c0,deps:[un]},{provide:XM,useClass:XM,deps:[yn]},{provide:WE,useClass:WE,deps:[l0,yn]},{provide:jB,useClass:fte,deps:[]},[]];let kD=(()=>{class n{constructor(t){if(t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(t){return{ngModule:n,providers:[{provide:Jy,useValue:t.appId},{provide:UB,useExisting:Jy},hte]}}}return n.\u0275fac=function(t){return new(t||n)(Ie(n,12))},n.\u0275mod=an({type:n}),n.\u0275inj=Ct({providers:Yte,imports:[Zr,HZ]}),n})();"undefined"!=typeof window&&window;class nne extends C{constructor(e,t){super()}schedule(e,t=0){return this}}class KE extends nne{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){if(this.closed)return this;this.state=e;const i=this.id,r=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(r,i,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this}requestAsyncId(e,t,i=0){return setInterval(e.flush.bind(e,this),i)}recycleAsyncId(e,t,i=0){if(null!==i&&this.delay===i&&!1===this.pending)return t;clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(e,t);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r,i=!1;try{this.work(e)}catch(s){i=!0,r=!!s&&s||new Error(s)}if(i)return this.unsubscribe(),r}_unsubscribe(){const e=this.id,t=this.scheduler,i=t.actions,r=i.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&i.splice(r,1),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null}}let JB=(()=>{class n{constructor(t,i=n.now){this.SchedulerAction=t,this.now=i}schedule(t,i=0,r){return new this.SchedulerAction(this,t).schedule(r,i)}}return n.now=()=>Date.now(),n})();class nc extends JB{constructor(e,t=JB.now){super(e,()=>nc.delegate&&nc.delegate!==this?nc.delegate.now():t()),this.actions=[],this.active=!1,this.scheduled=void 0}schedule(e,t=0,i){return nc.delegate&&nc.delegate!==this?nc.delegate.schedule(e,t,i):super.schedule(e,t,i)}flush(e){const{actions:t}=this;if(this.active)return void t.push(e);let i;this.active=!0;do{if(i=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,i){for(;e=t.shift();)e.unsubscribe();throw i}}}const sne=new class extends nc{}(class extends KE{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,i=0){return null!==i&&i>0||null===i&&this.delay>0?super.requestAsyncId(e,t,i):e.flush(this)}}),$c=new O(n=>n.complete());function u0(n){return n?function(n){return new O(e=>n.schedule(()=>e.complete()))}(n):$c}function tn(...n){let e=n[n.length-1];return Ce(e)?(n.pop(),Fe(n,e)):Mn(n)}function Ig(n,e){return new O(e?t=>e.schedule(ane,0,{error:n,subscriber:t}):t=>t.error(n))}function ane({error:n,subscriber:e}){e.error(n)}class la{constructor(e,t,i){this.kind=e,this.value=t,this.error=i,this.hasValue="N"===e}observe(e){switch(this.kind){case"N":return e.next&&e.next(this.value);case"E":return e.error&&e.error(this.error);case"C":return e.complete&&e.complete()}}do(e,t,i){switch(this.kind){case"N":return e&&e(this.value);case"E":return t&&t(this.error);case"C":return i&&i()}}accept(e,t,i){return e&&"function"==typeof e.next?this.observe(e):this.do(e,t,i)}toObservable(){switch(this.kind){case"N":return tn(this.value);case"E":return Ig(this.error);case"C":return u0()}throw new Error("unexpected notification kind value")}static createNext(e){return void 0!==e?new la("N",e):la.undefinedValueNotification}static createError(e){return new la("E",void 0,e)}static createComplete(){return la.completeNotification}}la.completeNotification=new la("C"),la.undefinedValueNotification=new la("N",void 0);class XE extends y{constructor(e,t,i=0){super(e),this.scheduler=t,this.delay=i}static dispatch(e){const{notification:t,destination:i}=e;t.observe(i),this.unsubscribe()}scheduleMessage(e){this.destination.add(this.scheduler.schedule(XE.dispatch,this.delay,new cne(e,this.destination)))}_next(e){this.scheduleMessage(la.createNext(e))}_error(e){this.scheduleMessage(la.createError(e)),this.unsubscribe()}_complete(){this.scheduleMessage(la.createComplete()),this.unsubscribe()}}class cne{constructor(e,t){this.notification=e,this.destination=t}}class Sf extends oe{constructor(e=Number.POSITIVE_INFINITY,t=Number.POSITIVE_INFINITY,i){super(),this.scheduler=i,this._events=[],this._infiniteTimeWindow=!1,this._bufferSize=e<1?1:e,this._windowTime=t<1?1:t,t===Number.POSITIVE_INFINITY?(this._infiniteTimeWindow=!0,this.next=this.nextInfiniteTimeWindow):this.next=this.nextTimeWindow}nextInfiniteTimeWindow(e){if(!this.isStopped){const t=this._events;t.push(e),t.length>this._bufferSize&&t.shift()}super.next(e)}nextTimeWindow(e){this.isStopped||(this._events.push(new une(this._getNow(),e)),this._trimBufferThenGetEvents()),super.next(e)}_subscribe(e){const t=this._infiniteTimeWindow,i=t?this._events:this._trimBufferThenGetEvents(),r=this.scheduler,s=i.length;let o;if(this.closed)throw new $;if(this.isStopped||this.hasError?o=C.EMPTY:(this.observers.push(e),o=new Z(this,e)),r&&e.add(e=new XE(e,r)),t)for(let a=0;a<s&&!e.closed;a++)e.next(i[a]);else for(let a=0;a<s&&!e.closed;a++)e.next(i[a].value);return this.hasError?e.error(this.thrownError):this.isStopped&&e.complete(),o}_getNow(){return(this.scheduler||sne).now()}_trimBufferThenGetEvents(){const e=this._getNow(),t=this._bufferSize,i=this._windowTime,r=this._events,s=r.length;let o=0;for(;o<s&&!(e-r[o].time<i);)o++;return s>t&&(o=Math.max(o,s-t)),o>0&&r.splice(0,o),r}}class une{constructor(e,t){this.time=e,this.value=t}}function Jr(n,e){return"function"==typeof e?t=>t.pipe(Jr((i,r)=>je(n(i,r)).pipe(me((s,o)=>e(i,s,r,o))))):t=>t.lift(new dne(n))}class dne{constructor(e){this.project=e}call(e,t){return t.subscribe(new hne(e,this.project))}}class hne extends we{constructor(e,t){super(e),this.project=t,this.index=0}_next(e){let t;const i=this.index++;try{t=this.project(e,i)}catch(r){return void this.destination.error(r)}this._innerSub(t)}_innerSub(e){const t=this.innerSubscription;t&&t.unsubscribe();const i=new _t(this),r=this.destination;r.add(i),this.innerSubscription=P(e,i),this.innerSubscription!==i&&r.add(this.innerSubscription)}_complete(){const{innerSubscription:e}=this;(!e||e.closed)&&super._complete(),this.unsubscribe()}_unsubscribe(){this.innerSubscription=void 0}notifyComplete(){this.innerSubscription=void 0,this.isStopped&&super._complete()}notifyNext(e){this.destination.next(e)}}const QE={schedule(n,e){const t=setTimeout(n,e);return()=>clearTimeout(t)},scheduleBeforeRender(n){if("undefined"==typeof window)return QE.schedule(n,0);if(void 0===window.requestAnimationFrame)return QE.schedule(n,16);const e=window.requestAnimationFrame(n);return()=>window.cancelAnimationFrame(e)}};let VD;function Ene(n,e,t){let i=t;return function(n){return!!n&&n.nodeType===Node.ELEMENT_NODE}(n)&&e.some((r,s)=>!("*"===r||!function(n,e){if(!VD){const t=Element.prototype;VD=t.matches||t.matchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector||t.webkitMatchesSelector}return n.nodeType===Node.ELEMENT_NODE&&VD.call(n,e)}(n,r)||(i=s,0))),i}class xne{constructor(e,t){this.componentFactory=t.get(pl).resolveComponentFactory(e)}create(e){return new Cne(this.componentFactory,e)}}class Cne{constructor(e,t){this.componentFactory=e,this.injector=t,this.eventEmitters=new Sf(1),this.events=this.eventEmitters.pipe(Jr(i=>Nn(...i))),this.componentRef=null,this.viewChangeDetectorRef=null,this.inputChanges=null,this.hasInputChanges=!1,this.implementsOnChanges=!1,this.scheduledChangeDetectionFn=null,this.scheduledDestroyFn=null,this.initialInputValues=new Map,this.unchangedInputs=new Set(this.componentFactory.inputs.map(({propName:i})=>i)),this.ngZone=this.injector.get(yn),this.elementZone="undefined"==typeof Zone?null:this.ngZone.run(()=>Zone.current)}connect(e){this.runInZone(()=>{if(null!==this.scheduledDestroyFn)return this.scheduledDestroyFn(),void(this.scheduledDestroyFn=null);null===this.componentRef&&this.initializeComponent(e)})}disconnect(){this.runInZone(()=>{null===this.componentRef||null!==this.scheduledDestroyFn||(this.scheduledDestroyFn=QE.schedule(()=>{null!==this.componentRef&&(this.componentRef.destroy(),this.componentRef=null,this.viewChangeDetectorRef=null)},10))})}getInputValue(e){return this.runInZone(()=>null===this.componentRef?this.initialInputValues.get(e):this.componentRef.instance[e])}setInputValue(e,t){this.runInZone(()=>{null!==this.componentRef?function(n,e){return n===e||n!=n&&e!=e}(t,this.getInputValue(e))&&(void 0!==t||!this.unchangedInputs.has(e))||(this.recordInputChange(e,t),this.unchangedInputs.delete(e),this.hasInputChanges=!0,this.componentRef.instance[e]=t,this.scheduleDetectChanges()):this.initialInputValues.set(e,t)})}initializeComponent(e){const t=zn.create({providers:[],parent:this.injector}),i=function(n,e){const t=n.childNodes,i=e.map(()=>[]);let r=-1;e.some((s,o)=>"*"===s&&(r=o,!0));for(let s=0,o=t.length;s<o;++s){const a=t[s],l=Ene(a,e,r);-1!==l&&i[l].push(a)}return i}(e,this.componentFactory.ngContentSelectors);this.componentRef=this.componentFactory.create(t,i,e),this.viewChangeDetectorRef=this.componentRef.injector.get(ss),this.implementsOnChanges=function(n){return"function"==typeof n}(this.componentRef.instance.ngOnChanges),this.initializeInputs(),this.initializeOutputs(this.componentRef),this.detectChanges(),this.injector.get(Jd).attachView(this.componentRef.hostView)}initializeInputs(){this.componentFactory.inputs.forEach(({propName:e})=>{this.initialInputValues.has(e)&&this.setInputValue(e,this.initialInputValues.get(e))}),this.initialInputValues.clear()}initializeOutputs(e){const t=this.componentFactory.outputs.map(({propName:i,templateName:r})=>e.instance[i].pipe(me(o=>({name:r,value:o}))));this.eventEmitters.next(t)}callNgOnChanges(e){if(!this.implementsOnChanges||null===this.inputChanges)return;const t=this.inputChanges;this.inputChanges=null,e.instance.ngOnChanges(t)}markViewForCheck(e){this.hasInputChanges&&(this.hasInputChanges=!1,e.markForCheck())}scheduleDetectChanges(){this.scheduledChangeDetectionFn||(this.scheduledChangeDetectionFn=QE.scheduleBeforeRender(()=>{this.scheduledChangeDetectionFn=null,this.detectChanges()}))}recordInputChange(e,t){if(!this.implementsOnChanges)return;null===this.inputChanges&&(this.inputChanges={});const i=this.inputChanges[e];if(i)return void(i.currentValue=t);const r=this.unchangedInputs.has(e),s=r?void 0:this.getInputValue(e);this.inputChanges[e]=new t_(s,t,r)}detectChanges(){null!==this.componentRef&&(this.callNgOnChanges(this.componentRef),this.markViewForCheck(this.viewChangeDetectorRef),this.componentRef.changeDetectorRef.detectChanges())}runInZone(e){return this.elementZone&&Zone.current!==this.elementZone?this.ngZone.run(e):e()}}class Tne extends HTMLElement{constructor(){super(...arguments),this.ngElementEventsSubscription=null}}const Mne={initialConfig:{},parse:{},rename:{}};class Dne{constructor(e,t){this.configState=e,this.storedChanges={},this.options=Object.assign(Object.assign({},Mne),t)}addChanges(e){this.storedChanges=Object.assign(Object.assign({},this.storedChanges),e)}applyChanges(e,t={}){void 0===e&&(e=this.storedChanges,this.storedChanges={});const{configState:i,options:{initialConfig:r}}=this,s=i.snapshot,o=Object.assign(Object.assign(Object.assign({},r),s),t);for(const[a,l]of Object.entries(e))this.processChange(a,l,o);i.setConfig(o)}processChange(e,t,i){var r,s;const{options:{parse:o,rename:a}}=this,l=null!==(r=a[e])&&void 0!==r?r:e,c=t.currentValue,u=null!==(s=o[e])&&void 0!==s?s:o[l];if(null==c)delete i[l];else if(u)try{i[l]=u(c)}catch(h){console.warn(`Failed to parse ${e} = ${c}`,h.message)}else i[l]=c}}let Ine=(()=>{class n{constructor(t,i,r={}){this.configState=t,this.cdr=i,this.options=r,this.initialized=!1,this.configManager=new Dne(this.configState,this.options)}ngOnInit(){var t;this._init=setTimeout(()=>this.initialize(),null!==(t=this.options.initialDelay)&&void 0!==t?t:0)}ngOnDestroy(){this._init&&clearTimeout(this._init)}ngOnChanges(t){this.configManager.addChanges(t),this.initialized&&this.configManager.applyChanges()}initialize(){this._init=void 0,!this.initialized&&(this.configManager.applyChanges(),this.initialized=!0,this.cdr.markForCheck())}}return n.\u0275fac=function(t){!function(){throw new Error("invalid")}()},n.\u0275dir=Bt({type:n,features:[zi]}),n})();const jD={boolean:n=>"false"!=`${n}`,json:n=>"string"==typeof n?JSON.parse(n):n,function:n=>{if("function"!=typeof n)throw new Error("Expected a javascript function");return n}};var UD;const xf={production:!0,disableDbWorker:!0,acceptableViewerDomains:["https://portal.hubmapconsortium.org","https://portal.test.hubmapconsortium.org"],dbOptions:{ccfOwlUrl:"https://cdn.jsdelivr.net/gh/hubmapconsortium/ccf-ui@staging/assets/ccf.owl.n3store.json",ccfContextUrl:"https://hubmapconsortium.github.io/hubmap-ontology/ccf-context.jsonld",dataSources:["https://cdn.jsdelivr.net/gh/hubmapconsortium/ccf-ui@staging/assets/kpmp/data/rui_locations.jsonld","https://cdn.jsdelivr.net/gh/hubmapconsortium/ccf-ui@staging/assets/sparc/data/rui_locations.jsonld"],hubmapDataService:"",hubmapPortalUrl:"",hubmapDataUrl:"",hubmapAssetsUrl:"",hubmapToken:null!==(UD=localStorage.getItem("HUBMAP_TOKEN"))&&void 0!==UD?UD:"",useRemoteApi:!1,remoteApiEndpoint:"https://ccf-api--staging.herokuapp.com/v1"},googleAnalyticsToken:"G-ERNVZ1Q4KE"};function Or(n,e,t,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,t):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s}function tV(n,e){return function(t,i){e(t,i,n)}}function ic(n,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(n,e)}function Pi(n,e,t,i){return new(t||(t=Promise))(function(s,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?s(u.value):function(s){return s instanceof t?s:new t(function(o){o(s)})}(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})}function rV(n){if("undefined"!=typeof window&&"object"==typeof window.process&&"renderer"===window.process.type||"undefined"!=typeof process&&"object"==typeof process.versions&&Boolean(process.versions.electron))return!0;const e="object"==typeof navigator&&"string"==typeof navigator.userAgent&&navigator.userAgent,t=n||e;return!!(t&&t.indexOf("Electron")>=0)}function HD(){return!("object"==typeof process&&"[object process]"===String(process)&&!process.browser)||rV()}const sV="undefined"!=typeof __VERSION__?__VERSION__:"untranspiled source",JE=HD();class Pne{constructor(e,t,i="sessionStorage"){this.storage=function(n){try{const e=window[n],t="__storage_test__";return e.setItem(t,t),e.removeItem(t),e}catch(e){return null}}(i),this.id=e,this.config={},Object.assign(this.config,t),this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){return this.config={},this.updateConfiguration(e)}updateConfiguration(e){if(Object.assign(this.config,e),this.storage){const t=JSON.stringify(this.config);this.storage.setItem(this.id,t)}return this}_loadConfiguration(){let e={};if(this.storage){const t=this.storage.getItem(this.id);e=t?JSON.parse(t):{}}return Object.assign(this.config,e),this}}function GD(n,e,t,i=600){const r=n.src.replace(/\(/g,"%28").replace(/\)/g,"%29");n.width>i&&(t=Math.min(t,i/n.width));const s=n.width*t,o=n.height*t,a=["font-size:1px;","padding:".concat(Math.floor(o/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(o,"px;"),"background:url(".concat(r,");"),"background-size:".concat(s,"px ").concat(o,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),a]}const oV={BLACK:30,RED:31,GREEN:32,YELLOW:33,BLUE:34,MAGENTA:35,CYAN:36,WHITE:37,BRIGHT_BLACK:90,BRIGHT_RED:91,BRIGHT_GREEN:92,BRIGHT_YELLOW:93,BRIGHT_BLUE:94,BRIGHT_MAGENTA:95,BRIGHT_CYAN:96,BRIGHT_WHITE:97};function aV(n){return"string"==typeof n?oV[n.toUpperCase()]||oV.WHITE:n}function eS(n,e){if(!n)throw new Error(e||"Assertion failed")}const rc={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document,process:"object"==typeof process&&process},d0=rc.window||rc.self||rc.global,lV=rc.process||{};function Og(){let n;if(JE&&d0.performance)n=d0.performance.now();else if(lV.hrtime){const e=lV.hrtime();n=1e3*e[0]+e[1]/1e6}else n=Date.now();return n}console;const Rg={debug:JE&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},Une={enabled:!0,level:0};function wl(){}const cV={},uV={once:!0};function zne(n){for(const e in n)for(const t in n[e])return t||"untitled";return"empty"}let $D=(()=>{class n{constructor({id:t}={id:""}){this.id=t,this.VERSION=sV,this._startTs=Og(),this._deltaTs=Og(),this.LOG_THROTTLE_TIMEOUT=0,this._storage=new Pne("__probe-".concat(this.id,"__"),Une),this.userData={},this.timeStamp("".concat(this.id," started")),function(n,e=["constructor"]){const t=Object.getPrototypeOf(n),i=Object.getOwnPropertyNames(t);for(const r of i)"function"==typeof n[r]&&(e.find(s=>r===s)||(n[r]=n[r].bind(n)))}(this),Object.seal(this)}set level(t){this.setLevel(t)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((Og()-this._startTs).toPrecision(10))}getDelta(){return Number((Og()-this._deltaTs).toPrecision(10))}set priority(t){this.level=t}get priority(){return this.level}getPriority(){return this.level}enable(t=!0){return this._storage.updateConfiguration({enabled:t}),this}setLevel(t){return this._storage.updateConfiguration({level:t}),this}assert(t,i){eS(t,i)}warn(t){return this._getLogFunction(0,t,Rg.warn,arguments,uV)}error(t){return this._getLogFunction(0,t,Rg.error,arguments)}deprecated(t,i){return this.warn("`".concat(t,"` is deprecated and will be removed in a later version. Use `").concat(i,"` instead"))}removed(t,i){return this.error("`".concat(t,"` has been removed. Use `").concat(i,"` instead"))}probe(t,i){return this._getLogFunction(t,i,Rg.log,arguments,{time:!0,once:!0})}log(t,i){return this._getLogFunction(t,i,Rg.debug,arguments)}info(t,i){return this._getLogFunction(t,i,console.info,arguments)}once(t,i){return this._getLogFunction(t,i,Rg.debug||Rg.info,arguments,uV)}table(t,i,r){return i?this._getLogFunction(t,i,console.table||wl,r&&[r],{tag:zne(i)}):wl}image({logLevel:t,priority:i,image:r,message:s="",scale:o=1}){return this._shouldLog(t||i)?JE?function({image:n,message:e="",scale:t=1}){if("string"==typeof n){const r=new Image;return r.onload=()=>{const s=GD(r,e,t);console.log(...s)},r.src=n,wl}const i=n.nodeName||"";if("img"===i.toLowerCase())return console.log(...GD(n,e,t)),wl;if("canvas"===i.toLowerCase()){const r=new Image;return r.onload=()=>console.log(...GD(r,e,t)),r.src=n.toDataURL(),wl}return wl}({image:r,message:s,scale:o}):function({image:n,message:e="",scale:t=1}){let i=null;try{i=et(5307)}catch(r){}return i?()=>i(n,{fit:"box",width:"".concat(Math.round(80*t),"%")}).then(r=>console.log(r)):wl}({image:r,message:s,scale:o}):wl}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}get(t){return this._storage.config[t]}set(t,i){this._storage.updateConfiguration({[t]:i})}time(t,i){return this._getLogFunction(t,i,console.time?console.time:console.info)}timeEnd(t,i){return this._getLogFunction(t,i,console.timeEnd?console.timeEnd:console.info)}timeStamp(t,i){return this._getLogFunction(t,i,console.timeStamp||wl)}group(t,i,r={collapsed:!1}){r=hV({logLevel:t,message:i,opts:r});const{collapsed:s}=r;return r.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(r)}groupCollapsed(t,i,r={}){return this.group(t,i,Object.assign({},r,{collapsed:!0}))}groupEnd(t){return this._getLogFunction(t,"",console.groupEnd||wl)}withGroup(t,i,r){this.group(t,i)();try{r()}finally{this.groupEnd(t)()}}trace(){console.trace&&console.trace()}_shouldLog(t){return this.isEnabled()&&this.getLevel()>=dV(t)}_getLogFunction(t,i,r,s=[],o){if(this._shouldLog(t)){o=hV({logLevel:t,message:i,args:s,opts:o}),eS(r=r||o.method),o.total=this.getTotal(),o.delta=this.getDelta(),this._deltaTs=Og();const a=o.tag||o.message;if(o.once){if(cV[a])return wl;cV[a]=Og()}return i=function(n,e,t){if("string"==typeof e){const i=t.time?function(n,e=8){const t=Math.max(e-n.length,0);return"".concat(" ".repeat(t)).concat(n)}(function(n){let e;return e=n<10?"".concat(n.toFixed(2),"ms"):n<100?"".concat(n.toFixed(1),"ms"):n<1e3?"".concat(n.toFixed(0),"ms"):"".concat((n/1e3).toFixed(2),"s"),e}(t.total)):"";e=function(n,e,t){return!JE&&"string"==typeof n&&(e&&(e=aV(e),n="\x1b[".concat(e,"m").concat(n,"\x1b[39m")),t&&(e=aV(t),n="\x1b[".concat(t+10,"m").concat(n,"\x1b[49m"))),n}(e=t.time?"".concat(n,": ").concat(i,"  ").concat(e):"".concat(n,": ").concat(e),t.color,t.background)}return e}(this.id,o.message,o),r.bind(console,i,...o.args)}return wl}}return n.VERSION=sV,n})();function dV(n){if(!n)return 0;let e;switch(typeof n){case"number":e=n;break;case"object":e=n.logLevel||n.priority||0;break;default:return 0}return eS(Number.isFinite(e)&&e>=0),e}function hV(n){const{logLevel:e,message:t}=n;n.logLevel=dV(e);const i=n.args?Array.from(n.args):[];for(;i.length&&i.shift()!==t;);switch(n.args=i,typeof e){case"string":case"function":void 0!==t&&i.unshift(t),n.message=e;break;case"object":Object.assign(n,e)}"function"==typeof n.message&&(n.message=n.message());const r=typeof n.message;return eS("string"===r||"object"===r),Object.assign(n,n.opts)}const Mi=new $D({id:"deck"}),Fi={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(Fi,"IDENTITY",{get:()=>Mi.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")()||0});const Wc={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},fV={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},hn=new $D({id:"luma.gl"});function jo(n,e){if(!n)throw new Error(e||"luma.gl: assertion failed.")}function tS(n){return"undefined"!=typeof WebGLRenderingContext&&n instanceof WebGLRenderingContext||"undefined"!=typeof WebGL2RenderingContext&&n instanceof WebGL2RenderingContext||Boolean(n&&Number.isFinite(n._version))}function _i(n){return"undefined"!=typeof WebGL2RenderingContext&&n instanceof WebGL2RenderingContext||Boolean(n&&2===n._version)}function nS(n){return jo(tS(n),"Invalid WebGLRenderingContext"),n}function Eo(n){return jo(_i(n),"Requires WebGL2"),n}const h0={};const f0=function n(e){const t=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(let i=0;i<this.attribs.length;i++){const r=new n.VertexAttrib(t);this.attribs[i]=r}this.maxAttrib=0};(f0.VertexAttrib=function(e){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()}).prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const Cf=function(e){const t=this;this.gl=e,function(n){const e=n.getError;n.getError=function(){let i;do{i=e.apply(n),0!==i&&(h0[i]=!0)}while(0!==i);for(i in h0)if(h0[i])return delete h0[i],parseInt(i,10);return 0}}(e);const i=this.original={getParameter:e.getParameter,enableVertexAttribArray:e.enableVertexAttribArray,disableVertexAttribArray:e.disableVertexAttribArray,bindBuffer:e.bindBuffer,getVertexAttrib:e.getVertexAttrib,vertexAttribPointer:e.vertexAttribPointer};e.getParameter=function(s){return s===t.VERTEX_ARRAY_BINDING_OES?t.currentVertexArrayObject===t.defaultVertexArrayObject?null:t.currentVertexArrayObject:i.getParameter.apply(this,arguments)},e.enableVertexAttribArray=function(s){const o=t.currentVertexArrayObject;o.maxAttrib=Math.max(o.maxAttrib,s);const a=o.attribs[s];return a.enabled=!0,i.enableVertexAttribArray.apply(this,arguments)},e.disableVertexAttribArray=function(s){const o=t.currentVertexArrayObject;o.maxAttrib=Math.max(o.maxAttrib,s);const a=o.attribs[s];return a.enabled=!1,i.disableVertexAttribArray.apply(this,arguments)},e.bindBuffer=function(s,o){switch(s){case 34962:t.currentArrayBuffer=o;break;case 34963:t.currentVertexArrayObject.elementArrayBuffer=o}return i.bindBuffer.apply(this,arguments)},e.getVertexAttrib=function(s,o){const l=t.currentVertexArrayObject.attribs[s];switch(o){case 34975:return l.buffer;case 34338:return l.enabled;case 34339:return l.size;case 34340:return l.stride;case 34341:return l.type;case 34922:return l.normalized;default:return i.getVertexAttrib.apply(this,arguments)}},e.vertexAttribPointer=function(s,o,a,l,c,u){const h=t.currentVertexArrayObject;h.maxAttrib=Math.max(h.maxAttrib,s);const f=h.attribs[s];return f.buffer=t.currentArrayBuffer,f.size=o,f.type=a,f.normalized=l,f.stride=c,f.offset=u,f.recache(),i.vertexAttribPointer.apply(this,arguments)},e.instrumentExtension&&e.instrumentExtension(this,"OES_vertex_array_object"),e.canvas&&e.canvas.addEventListener("webglcontextrestored",()=>{globalThis.console&&globalThis.console.log&&globalThis.console.log("OESVertexArrayObject emulation library context restored"),t.reset_()},!0),this.reset_()};Cf.prototype.VERTEX_ARRAY_BINDING_OES=34229,Cf.prototype.reset_=function(){if(void 0!==this.vertexArrayObjects)for(let i=0;i<this.vertexArrayObjects.length;++i)this.vertexArrayObjects.isAlive=!1;this.maxVertexAttribs=this.gl.getParameter(34921),this.defaultVertexArrayObject=new f0(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)},Cf.prototype.createVertexArrayOES=function(){const e=new f0(this);return this.vertexArrayObjects.push(e),e},Cf.prototype.deleteVertexArrayOES=function(e){e.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(e),1),this.currentVertexArrayObject===e&&this.bindVertexArrayOES(null)},Cf.prototype.isVertexArrayOES=function(e){return!!(e&&e instanceof f0&&e.hasBeenBound&&e.ext===this)},Cf.prototype.bindVertexArrayOES=function(e){const t=this.gl;if(e&&!e.isAlive)return void function(n,e){h0[n]=!0,void 0!==e&&function(n){globalThis.console&&globalThis.console.error&&globalThis.console.error(n)}(e)}(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");const i=this.original,r=this.currentVertexArrayObject;this.currentVertexArrayObject=e||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const s=this.currentVertexArrayObject;if(r===s)return;(!r||s.elementArrayBuffer!==r.elementArrayBuffer)&&i.bindBuffer.call(t,34963,s.elementArrayBuffer);let o=this.currentArrayBuffer;const a=Math.max(r?r.maxAttrib:0,s.maxAttrib);for(let l=0;l<=a;l++){const c=s.attribs[l],u=r?r.attribs[l]:null;if((!r||c.enabled!==u.enabled)&&(c.enabled?i.enableVertexAttribArray.call(t,l):i.disableVertexAttribArray.call(t,l)),c.enabled){let h=!1;(!r||c.buffer!==u.buffer)&&(o!==c.buffer&&(i.bindBuffer.call(t,34962,c.buffer),o=c.buffer),h=!0),(h||c.cached!==u.cached)&&i.vertexAttribPointer.call(t,l,c.size,c.type,c.normalized,c.stride,c.offset)}}this.currentArrayBuffer!==o&&i.bindBuffer.call(t,34962,this.currentArrayBuffer)};const pV="OES_element_index",gV="WEBGL_draw_buffers",mV="WEBGL_debug_renderer_info",hr=n=>_i(n)?void 0:0,cie={3074:n=>_i(n)?void 0:36064,35723:n=>_i(n)?void 0:4352,35977:hr,32937:hr,36795:(n,e)=>{const t=_i(n)?n.getExtension("EXT_disjoint_timer_query_webgl2"):n.getExtension("EXT_disjoint_timer_query");return t&&t.GPU_DISJOINT_EXT?e(t.GPU_DISJOINT_EXT):0},37445:(n,e)=>{const t=n.getExtension(mV);return e(t&&t.UNMASKED_VENDOR_WEBGL||7936)},37446:(n,e)=>{const t=n.getExtension(mV);return e(t&&t.UNMASKED_RENDERER_WEBGL||7937)},34047:(n,e)=>{const t=n.luma.extensions.EXT_texture_filter_anisotropic;return t?e(t.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},32883:hr,35071:hr,37447:hr,36063:(n,e)=>{if(!_i(n)){const t=n.getExtension(gV);return t?e(t.MAX_COLOR_ATTACHMENTS_WEBGL):0}},35379:hr,35374:hr,35377:hr,34852:n=>{if(!_i(n)){const e=n.getExtension(gV);return e?e.MAX_DRAW_BUFFERS_WEBGL:0}},36203:n=>n.getExtension(pV)?2147483647:65535,33001:n=>n.getExtension(pV)?16777216:65535,33e3:n=>16777216,37157:hr,35373:hr,35657:hr,36183:hr,37137:hr,34045:hr,35978:hr,35979:hr,35968:hr,35376:hr,35375:hr,35659:hr,37154:hr,35371:hr,35658:hr,35076:hr,35077:hr,35380:hr},_V="ANGLE_instanced_arrays",yV={OES_vertex_array_object:{meta:{suffix:"OES"},createVertexArray:()=>{jo(!1,"VertexArray requires WebGL2 or OES_vertex_array_object extension")},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[_V]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(n,e){jo(0===e,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},WEBGL_draw_buffers:{meta:{suffix:"WEBGL"},drawBuffers:()=>{jo(!1)}},EXT_disjoint_timer_query:{meta:{suffix:"EXT"},createQuery:()=>{jo(!1)},deleteQuery:()=>{jo(!1)},beginQuery:()=>{jo(!1)},endQuery:()=>{},getQuery(n,e){return this.getQueryObject(n,e)},getQueryParameter(n,e){return this.getQueryObject(n,e)},getQueryObject:()=>{}}},WD={readBuffer:(n,e,t)=>{_i(n)&&e(t)},getVertexAttrib:(n,e,t,i)=>{const{webgl2:r,ext:s}=function(n,e){return{webgl2:_i(n),ext:n.getExtension("ANGLE_instanced_arrays")}}(n);let o;switch(i){case 35069:o=!!r&&void 0;break;case 35070:o=r||s?void 0:0}return void 0!==o?o:e(t,i)},getProgramParameter:(n,e,t,i)=>{if(!_i(n))switch(i){case 35967:return 35981;case 35971:case 35382:return 0}return e(t,i)},getInternalformatParameter:(n,e,t,i,r)=>{if(!_i(n))switch(r){case 32937:return new Int32Array([0])}return n.getInternalformatParameter(t,i,r)},getTexParameter(n,e,t,i){switch(i){case 34046:const{extensions:r}=n.luma,s=r.EXT_texture_filter_anisotropic;i=s&&s.TEXTURE_MAX_ANISOTROPY_EXT||34046}return e(t,i)},getParameter:function(n,e,t){const i=cie[t],r="function"==typeof i?i(n,e,t):i;return void 0!==r?r:e(t)},hint:(n,e,t,i)=>e(t,i)};function wie(n,{extension:e,target:t,target2:i}){const r=yV[e];jo(r);const{meta:s={}}=r,{suffix:o=""}=s,a=n.getExtension(e);for(const l of Object.keys(r)){const c=`${l}${o}`;let u=null;"meta"===l||"function"==typeof n[l]||(a&&"function"==typeof a[c]?u=(...h)=>a[c](...h):"function"==typeof r[l]&&(u=r[l].bind(t))),u&&(t[l]=u,i[l]=u)}}globalThis.polyfillContext=function(n){n.luma=n.luma||{};const{luma:e}=n;return e.polyfilled||(function(n){if("function"==typeof n.createVertexArray)return;const e=n.getSupportedExtensions;n.getSupportedExtensions=function(){const r=e.call(this)||[];return r.indexOf("OES_vertex_array_object")<0&&r.push("OES_vertex_array_object"),r};const t=n.getExtension;n.getExtension=function(r){return t.call(this,r)||("OES_vertex_array_object"!==r?null:(n.__OESVertexArrayObject||(this.__OESVertexArrayObject=new Cf(this)),this.__OESVertexArrayObject))}}(n),function(n){n.luma.extensions={};const e=n.getSupportedExtensions()||[];for(const t of e)n.luma[t]=n.getExtension(t)}(n),function(n,e){for(const t of Object.getOwnPropertyNames(e))"overrides"!==t&&wie(n,{extension:t,target:n.luma,target2:n})}(n,yV),function(n,{target:e,target2:t}){Object.keys(WD).forEach(i=>{if("function"==typeof WD[i]){const r=n[i]?n[i].bind(n):()=>{},s=WD[i].bind(null,n,r);e[i]=s,t[i]=s}})}(n,{target:e,target2:n}),e.polyfilled=!0),n};const qD={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,36006:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],3333:4,3317:4,37440:!1,37441:!1,37443:37444,35723:4352,36010:null,35977:!1,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},ih=(n,e,t)=>e?n.enable(t):n.disable(t),vV=(n,e,t)=>n.hint(t,e),Na=(n,e,t)=>n.pixelStorei(t,e);function p0(n){return Array.isArray(n)||ArrayBuffer.isView(n)}const xie={3042:ih,32773:(n,e)=>n.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(n,e)=>n.clearColor(...e),3107:(n,e)=>n.colorMask(...e),2884:ih,2885:(n,e)=>n.cullFace(e),2929:ih,2931:(n,e)=>n.clearDepth(e),2932:(n,e)=>n.depthFunc(e),2928:(n,e)=>n.depthRange(...e),2930:(n,e)=>n.depthMask(e),3024:ih,35723:vV,36006:(n,e)=>{const t=_i(n)?36009:36160;return n.bindFramebuffer(t,e)},2886:(n,e)=>n.frontFace(e),33170:vV,2849:(n,e)=>n.lineWidth(e),32823:ih,32824:"polygonOffset",10752:"polygonOffset",35977:ih,32938:"sampleCoverage",32939:"sampleCoverage",3089:ih,3088:(n,e)=>n.scissor(...e),2960:ih,2961:(n,e)=>n.clearStencil(e),2968:(n,e)=>n.stencilMaskSeparate(1028,e),36005:(n,e)=>n.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(n,e)=>n.viewport(...e),3333:Na,3317:Na,37440:Na,37441:Na,37443:Na,3330:Na,3332:Na,3331:Na,36010:(n,e)=>n.bindFramebuffer(36008,e),3314:Na,32878:Na,3316:Na,3315:Na,32877:Na,framebuffer:(n,e)=>n.bindFramebuffer(36160,e&&"handle"in e?e.handle:e),blend:(n,e)=>e?n.enable(3042):n.disable(3042),blendColor:(n,e)=>n.blendColor(...e),blendEquation:(n,e)=>{e=p0(e)?e:[e,e],n.blendEquationSeparate(...e)},blendFunc:(n,e)=>{e=p0(e)&&2===e.length?[...e,...e]:e,n.blendFuncSeparate(...e)},clearColor:(n,e)=>n.clearColor(...e),clearDepth:(n,e)=>n.clearDepth(e),clearStencil:(n,e)=>n.clearStencil(e),colorMask:(n,e)=>n.colorMask(...e),cull:(n,e)=>e?n.enable(2884):n.disable(2884),cullFace:(n,e)=>n.cullFace(e),depthTest:(n,e)=>e?n.enable(2929):n.disable(2929),depthFunc:(n,e)=>n.depthFunc(e),depthMask:(n,e)=>n.depthMask(e),depthRange:(n,e)=>n.depthRange(...e),dither:(n,e)=>e?n.enable(3024):n.disable(3024),derivativeHint:(n,e)=>{n.hint(35723,e)},frontFace:(n,e)=>n.frontFace(e),mipmapHint:(n,e)=>n.hint(33170,e),lineWidth:(n,e)=>n.lineWidth(e),polygonOffsetFill:(n,e)=>e?n.enable(32823):n.disable(32823),polygonOffset:(n,e)=>n.polygonOffset(...e),sampleCoverage:(n,e)=>n.sampleCoverage(...e),scissorTest:(n,e)=>e?n.enable(3089):n.disable(3089),scissor:(n,e)=>n.scissor(...e),stencilTest:(n,e)=>e?n.enable(2960):n.disable(2960),stencilMask:(n,e)=>{e=p0(e)?e:[e,e];const[t,i]=e;n.stencilMaskSeparate(1028,t),n.stencilMaskSeparate(1029,i)},stencilFunc:(n,e)=>{e=p0(e)&&3===e.length?[...e,...e]:e;const[t,i,r,s,o,a]=e;n.stencilFuncSeparate(1028,t,i,r),n.stencilFuncSeparate(1029,s,o,a)},stencilOp:(n,e)=>{e=p0(e)&&3===e.length?[...e,...e]:e;const[t,i,r,s,o,a]=e;n.stencilOpSeparate(1028,t,i,r),n.stencilOpSeparate(1029,s,o,a)},viewport:(n,e)=>n.viewport(...e)};function es(n,e,t){return void 0!==e[n]?e[n]:t[n]}const Cie={blendEquation:(n,e,t)=>n.blendEquationSeparate(es(32777,e,t),es(34877,e,t)),blendFunc:(n,e,t)=>n.blendFuncSeparate(es(32969,e,t),es(32968,e,t),es(32971,e,t),es(32970,e,t)),polygonOffset:(n,e,t)=>n.polygonOffset(es(32824,e,t),es(10752,e,t)),sampleCoverage:(n,e,t)=>n.sampleCoverage(es(32938,e,t),es(32939,e,t)),stencilFuncFront:(n,e,t)=>n.stencilFuncSeparate(1028,es(2962,e,t),es(2967,e,t),es(2963,e,t)),stencilFuncBack:(n,e,t)=>n.stencilFuncSeparate(1029,es(34816,e,t),es(36003,e,t),es(36004,e,t)),stencilOpFront:(n,e,t)=>n.stencilOpSeparate(1028,es(2964,e,t),es(2965,e,t),es(2966,e,t)),stencilOpBack:(n,e,t)=>n.stencilOpSeparate(1029,es(34817,e,t),es(34818,e,t),es(34819,e,t))},bV={enable:(n,e)=>n({[e]:!0}),disable:(n,e)=>n({[e]:!1}),pixelStorei:(n,e,t)=>n({[e]:t}),hint:(n,e,t)=>n({[e]:t}),bindFramebuffer:(n,e,t)=>{switch(e){case 36160:return n({36006:t,36010:t});case 36009:return n({36006:t});case 36008:return n({36010:t});default:return null}},blendColor:(n,e,t,i,r)=>n({32773:new Float32Array([e,t,i,r])}),blendEquation:(n,e)=>n({32777:e,34877:e}),blendEquationSeparate:(n,e,t)=>n({32777:e,34877:t}),blendFunc:(n,e,t)=>n({32969:e,32968:t,32971:e,32970:t}),blendFuncSeparate:(n,e,t,i,r)=>n({32969:e,32968:t,32971:i,32970:r}),clearColor:(n,e,t,i,r)=>n({3106:new Float32Array([e,t,i,r])}),clearDepth:(n,e)=>n({2931:e}),clearStencil:(n,e)=>n({2961:e}),colorMask:(n,e,t,i,r)=>n({3107:[e,t,i,r]}),cullFace:(n,e)=>n({2885:e}),depthFunc:(n,e)=>n({2932:e}),depthRange:(n,e,t)=>n({2928:new Float32Array([e,t])}),depthMask:(n,e)=>n({2930:e}),frontFace:(n,e)=>n({2886:e}),lineWidth:(n,e)=>n({2849:e}),polygonOffset:(n,e,t)=>n({32824:e,10752:t}),sampleCoverage:(n,e,t)=>n({32938:e,32939:t}),scissor:(n,e,t,i,r)=>n({3088:new Int32Array([e,t,i,r])}),stencilMask:(n,e)=>n({2968:e,36005:e}),stencilMaskSeparate:(n,e,t)=>n({[1028===e?2968:36005]:t}),stencilFunc:(n,e,t,i)=>n({2962:e,2967:t,2963:i,34816:e,36003:t,36004:i}),stencilFuncSeparate:(n,e,t,i,r)=>n({[1028===e?2962:34816]:t,[1028===e?2967:36003]:i,[1028===e?2963:36004]:r}),stencilOp:(n,e,t,i)=>n({2964:e,2965:t,2966:i,34817:e,34818:t,34819:i}),stencilOpSeparate:(n,e,t,i,r)=>n({[1028===e?2964:34817]:t,[1028===e?2965:34818]:i,[1028===e?2966:34819]:r}),viewport:(n,e,t,i,r)=>n({2978:[e,t,i,r]})},qc=(n,e)=>n.isEnabled(e),wV={3042:qc,2884:qc,2929:qc,3024:qc,32823:qc,32926:qc,32928:qc,3089:qc,2960:qc,35977:qc};function EV(n){for(const e in n)return!1;return!0}function Tie(n,e){if(n===e)return!0;const t=Array.isArray(n)||ArrayBuffer.isView(n),i=Array.isArray(e)||ArrayBuffer.isView(e);if(t&&i&&n.length===e.length){for(let r=0;r<n.length;++r)if(n[r]!==e[r])return!1;return!0}return!1}function SV(n,e){const t=n[e].bind(n);n[e]=function(...r){const s=r[0];return s in n.state.cache&&n.state.enable?n.state.cache[s]:t(...r)},Object.defineProperty(n[e],"name",{value:`${e}-from-cache`,configurable:!1})}function Aie(n,e,t){const i=n[e].bind(n);n[e]=function(...s){const{valueChanged:o,oldValue:a}=t(n.state._updateCache,...s);return o&&i(...s),a},Object.defineProperty(n[e],"name",{value:`${e}-to-cache`,configurable:!1})}class Die{constructor(e,{copyState:t=!1,log:i=(()=>{})}={}){this.gl=e,this.program=null,this.stateStack=[],this.enable=!0,this.cache=t?function(n,e){if("number"==typeof(e=e||qD)){const r=e,s=wV[r];return s?s(n,r):n.getParameter(r)}const t=Array.isArray(e)?e:Object.keys(e),i={};for(const r of t){const s=wV[r];i[r]=s?s(n,Number(r)):n.getParameter(Number(r))}return i}(e):Object.assign({},qD),this.log=i,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(e={}){this.stateStack.push({})}pop(){jo(this.stateStack.length>0),Uu(this.gl,this.stateStack[this.stateStack.length-1]),this.stateStack.pop()}_updateCache(e){let i,t=!1;const r=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const s in e){jo(void 0!==s);const o=e[s],a=this.cache[s];Tie(o,a)||(t=!0,i=a,r&&!(s in r)&&(r[s]=a),this.cache[s]=o)}return{valueChanged:t,oldValue:i}}}function xV(n,e={}){const{enable:t=!0,copyState:i}=e;if(jo(void 0!==i),!n.state){const{polyfillContext:r}=globalThis;r&&r(n),n.state=new Die(n,{copyState:i}),function(n){const e=n.useProgram.bind(n);n.useProgram=function(i){n.state.program!==i&&(e(i),n.state.program=i)}}(n);for(const s in bV)Aie(n,s,bV[s]);SV(n,"getParameter"),SV(n,"isEnabled")}return n.state.enable=t,n}function CV(n){jo(n.state),n.state.pop()}function Uu(n,e){if(jo(tS(n),"setParameters requires a WebGL context"),EV(e))return;const t={};for(const r in e){const s=Number(r),o=xie[r];o&&("string"==typeof o?t[o]=!0:o(n,e[r],s))}const i=n.state&&n.state.cache;if(i)for(const r in t)Cie[r](n,e,i)}function sc(n,e,t){if(EV(e))return t(n);const{nocatch:i=!0}=e;let r;if(function(n){n.state||xV(n,{copyState:!1}),n.state.push()}(n),Uu(n,e),i)r=t(n),CV(n);else try{r=t(n)}finally{CV(n)}return r}function iS(){return!("object"==typeof process&&"[object process]"===String(process)&&!process.browser)||function(n){if("undefined"!=typeof window&&"object"==typeof window.process&&"renderer"===window.process.type||"undefined"!=typeof process&&"object"==typeof process.versions&&Boolean(process.versions.electron))return!0;const e="object"==typeof navigator&&"string"==typeof navigator.userAgent&&navigator.userAgent;return!!(e&&e.indexOf("Electron")>=0)}()}function Ng(n){const{luma:e}=n;if(n.canvas&&e){const{clientWidth:t}=e.canvasSizeInfo;return t?n.drawingBufferWidth/t:1}return 1}function YD(n,e,t=!0){return function(n,e,t,i,r){const s=TV(n[0],e,t);let o=AV(n[1],e,i,r),a=TV(n[0]+1,e,t);const l=a===t-1?a:a-1;let c;return a=AV(n[1]+1,e,i,r),r?(a=0===a?a:a+1,c=o,o=a):c=a===i-1?a:a-1,{x:s,y:o,width:Math.max(l-s+1,1),height:Math.max(c-o+1,1)}}(e,Ng(n),n.drawingBufferWidth,n.drawingBufferHeight,t)}function TV(n,e,t){return Math.min(Math.round(n*e),t-1)}function AV(n,e,t,i){return i?Math.max(0,t-1-Math.round(n*e)):Math.min(Math.round(n*e),t-1)}const KD=iS(),Lie=KD&&"undefined"!=typeof document,MV={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function DV(n={}){jo(KD,"createGLContext only available in the browser.\nCreate your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils"),n=Object.assign({},MV,n);const{width:e,height:t}=n;function i(a){if(n.throwOnError)throw new Error(a);return console.error(a),null}let r;n.onError=i;const{canvas:s}=n,o=function({canvas:n,width:e=800,height:t=600,onError:i}){let r;return"string"==typeof n?(Lie&&"complete"===document.readyState||i(`createGLContext called on canvas '${n}' before page was loaded`),r=document.getElementById(n)):n?r=n:(r=document.createElement("canvas"),r.id="lumagl-canvas",r.style.width=Number.isFinite(e)?`${e}px`:"100%",r.style.height=Number.isFinite(t)?`${t}px`:"100%",document.body.insertBefore(r,document.body.firstChild)),r}({canvas:s,width:e,height:t,onError:i});return r=function(n,e){const{onError:t}=e;let i=null;const r=l=>i=l.statusMessage||i;n.addEventListener("webglcontextcreationerror",r,!1);const{webgl1:s=!0,webgl2:o=!0}=e;let a=null;return o&&(a=a||n.getContext("webgl2",e),a=a||n.getContext("experimental-webgl2",e)),s&&(a=a||n.getContext("webgl",e),a=a||n.getContext("experimental-webgl",e)),n.removeEventListener("webglcontextcreationerror",r,!1),a?(e.onContextLost&&n.addEventListener("webglcontextlost",e.onContextLost,!1),e.onContextRestored&&n.addEventListener("webglcontextrestored",e.onContextRestored,!1),a):t(`Failed to create ${o&&!s?"WebGL2":"WebGL"} context: ${i||"Unknown error"}`)}(o,n),r?(r=XD(r,n),function(n){const e=_i(n)?"WebGL2":"WebGL1",t=function(n){const e=n.getParameter(7936),t=n.getParameter(7937),i=n.getExtension("WEBGL_debug_renderer_info");return{vendor:i&&n.getParameter(i.UNMASKED_VENDOR_WEBGL||7936)||e,renderer:i&&n.getParameter(i.UNMASKED_RENDERER_WEBGL||7937)||t,vendorMasked:e,rendererMasked:t,version:n.getParameter(7938),shadingLanguageVersion:n.getParameter(35724)}}(n);hn.info(1,`${e}${n.debug?" debug":""} context ${t?`(${t.vendor},${t.renderer})`:""}`)()}(r),r):null}function XD(n,e={}){if(!n||n._instrumented)return n;n._version=n._version||function(n){return"undefined"!=typeof WebGL2RenderingContext&&n instanceof WebGL2RenderingContext?2:1}(n),n.luma=n.luma||{},n.luma.canvasSizeInfo=n.luma.canvasSizeInfo||{},e=Object.assign({},MV,e);const{manageState:t,debug:i}=e;return t&&xV(n,{copyState:!1,log:(...r)=>hn.log(1,...r)()}),KD&&i&&(globalThis.makeDebugContext?(n=globalThis.makeDebugContext(n,e),hn.level=Math.max(hn.level,1)):hn.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),n._instrumented=!0,n}function IV(){let n;if("undefined"!=typeof window&&window.performance)n=window.performance.now();else if("undefined"!=typeof process&&process.hrtime){const e=process.hrtime();n=1e3*e[0]+e[1]/1e6}else n=Date.now();return n}class OV{constructor(e,t){this.name=e,this.type=t,this.sampleSize=1,this.reset()}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=IV(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(IV()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class QD{constructor({id:e,stats:t}){this.id=e,this.stats={},this._initializeStats(t),Object.seal(this)}get(e,t="count"){return this._getOrCreate({name:e,type:t})}get size(){return Object.keys(this.stats).length}reset(){for(const e in this.stats)this.stats[e].reset();return this}forEach(e){for(const t in this.stats)e(this.stats[t])}getTable(){const e={};return this.forEach(t=>{e[t.name]={time:t.time||0,count:t.count||0,average:t.getAverageTime()||0,hz:t.getHz()||0}}),e}_initializeStats(e=[]){e.forEach(t=>this._getOrCreate(t))}_getOrCreate(e){if(!e||!e.name)return null;const{name:t,type:i}=e;return this.stats[t]||(this.stats[t]=e instanceof OV?e:new OV(t,i)),this.stats[t]}}const g0="8.5.12",Tf=new class{constructor(){this.stats=new Map}get(e){return this.stats.has(e)||this.stats.set(e,new QD({id:e})),this.stats.get(e)}};if(globalThis.luma&&globalThis.luma.VERSION!==g0)throw new Error(`luma.gl - multiple VERSIONs detected: ${globalThis.luma.VERSION} vs ${g0}`);function nn(n,e){if(!n)throw new Error(e||"luma.gl: assertion failed.")}function ZD(n,e){if("string"!=typeof e)return e;const t=Number(e);if(!isNaN(t))return t;const i=n[e=e.replace(/^.*\./,"")];return nn(void 0!==i,`Accessing undefined constant GL.${e}`),i}function rh(n,e){e=Number(e);for(const t in n)if(n[t]===e)return`GL.${t}`;return String(e)}globalThis.luma||(iS()&&hn.log(1,`luma.gl ${g0} - set luma.log.level=1 (or higher) to trace rendering`)(),globalThis.luma=globalThis.luma||{VERSION:g0,version:g0,log:hn,stats:Tf,globals:{modules:{},nodeIO:{}}}),globalThis;const JD={};function ca(n="id"){return JD[n]=JD[n]||1,`${n}-${JD[n]++}`}function RV(n){return nn("number"==typeof n,"Input must be a number"),n&&0==(n&n-1)}function Pg(n){let e=!0;for(const t in n){e=!1;break}return e}function NV(n,e,t,i){const r=`See luma.gl ${t} Upgrade Guide at https://luma.gl/docs/upgrade-guide`,s=Object.getPrototypeOf(n);i.forEach(o=>{s.methodName||(s[o]=()=>{throw hn.removed(`Calling removed method ${e}.${o}: `,r)(),new Error(o)})})}const Fg="Resource subclass must define virtual methods";class zu{get[Symbol.toStringTag](){return"Resource"}constructor(e,t={}){nS(e);const{id:i,userData:r={}}=t;this.gl=e,this.gl2=e,this.id=i||ca(this[Symbol.toStringTag]),this.userData=r,this._bound=!1,this._handle=t.handle,void 0===this._handle&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return`${this[Symbol.toStringTag]||this.constructor.name}(${this.id})`}get handle(){return this._handle}delete({deleteChildren:e=!1}={}){const t=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,t&&e&&t.filter(Boolean).forEach(i=>i.delete()),this}bind(e=this.handle){if("function"!=typeof e)return this._bindHandle(e),this;let t;return this._bound?t=e():(this._bindHandle(this.handle),this._bound=!0,t=e(),this._bound=!1,this._bindHandle(null)),t}unbind(){this.bind(null)}getParameter(e,t={}){nn(e=ZD(this.gl,e));const r=(this.constructor.PARAMETERS||{})[e];if(r){const s=_i(this.gl);if("webgl2"in r&&!s||"extension"in r&&!this.gl.getExtension(r.extension)){const a=r.webgl1,l="webgl2"in r?r.webgl2:r.webgl1;return s?l:a}}return this._getParameter(e,t)}getParameters(e={}){const{parameters:t,keys:i}=e,r=this.constructor.PARAMETERS||{},s=_i(this.gl),o={},a=t||Object.keys(r);for(const l of a){const c=r[l];if(c&&(!("webgl2"in c)||s)&&(!("extension"in c)||this.gl.getExtension(c.extension))){const h=i?rh(this.gl,l):l;o[h]=this.getParameter(l,e),i&&"GLenum"===c.type&&(o[h]=rh(this.gl,o[h]))}}return o}setParameter(e,t){nn(e=ZD(this.gl,e));const r=(this.constructor.PARAMETERS||{})[e];if(r){const s=_i(this.gl);if("webgl2"in r&&!s||"extension"in r&&!this.gl.getExtension(r.extension))throw new Error("Parameter not available on this platform");"GLenum"===r.type&&(t=ZD(t))}return this._setParameter(e,t),this}setParameters(e){for(const t in e)this.setParameter(t,e[t]);return this}stubRemovedMethods(e,t,i){return NV(this,e,t,i)}initialize(e){}_createHandle(){throw new Error(Fg)}_deleteHandle(){throw new Error(Fg)}_bindHandle(e){throw new Error(Fg)}_getOptsFromHandle(){throw new Error(Fg)}_getParameter(e,t){throw new Error(Fg)}_setParameter(e,t){throw new Error(Fg)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const e=this[Symbol.toStringTag],t=Tf.get("Resource Counts");t.get("Resources Created").incrementCount(),t.get(`${e}s Created`).incrementCount(),t.get(`${e}s Active`).incrementCount()}_removeStats(){const e=this[Symbol.toStringTag];Tf.get("Resource Counts").get(`${e}s Active`).decrementCount()}_trackAllocatedMemory(e,t=this[Symbol.toStringTag]){const i=Tf.get("Memory Usage");i.get("GPU Memory").addCount(e),i.get(`${t} Memory`).addCount(e),this.byteLength=e}_trackDeallocatedMemory(e=this[Symbol.toStringTag]){const t=Tf.get("Memory Usage");t.get("GPU Memory").subtractCount(this.byteLength),t.get(`${e} Memory`).subtractCount(this.byteLength),this.byteLength=0}}function eI(n){switch(ArrayBuffer.isView(n)?n.constructor:n){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error("Failed to deduce GL constant from typed array")}}function m0(n,{clamped:e=!0}={}){switch(n){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return e?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function Yie({data:n,width:e,height:t}){const i=Math.round(e/2),r=Math.round(t/2),s=new Uint8Array(i*r*4);for(let o=0;o<r;o++)for(let a=0;a<i;a++)for(let l=0;l<4;l++)s[4*(o*i+a)+l]=n[4*(2*o*e+2*a)+l];return{data:s,width:i,height:r}}function tI(n,e,t){const{removedProps:i={},deprecatedProps:r={},replacedProps:s={}}=t;for(const a in i)a in e&&hn.removed(`${n}.${a}`,i[a]?`${n}.${i[a]}`:"N/A")();for(const a in r)a in e&&hn.deprecated(`${n}.${a}`,`${n}.${r[a]}`)();let o=null;for(const a in s)if(a in e){const l=s[a];hn.deprecated(`${n}.${a}`,`${n}.${l}`)(),o=o||Object.assign({},e),o[l]=e[a],delete o[a]}return o||e}const Kie={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},Xie={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class ua{static getBytesPerElement(e){return m0(e.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(e){return nn(e.size),m0(e.type||5126).BYTES_PER_ELEMENT*e.size}static resolve(...e){return new ua(...[Kie,...e])}constructor(...e){e.forEach(t=>this._assign(t)),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return ua.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return ua.getBytesPerVertex(this)}_assign(e={}){return void 0!==(e=tI("Accessor",e,Xie)).type&&(this.type=e.type,(5124===e.type||5125===e.type)&&(this.integer=!0)),void 0!==e.size&&(this.size=e.size),void 0!==e.offset&&(this.offset=e.offset),void 0!==e.stride&&(this.stride=e.stride),void 0!==e.normalized&&(this.normalized=e.normalized),void 0!==e.integer&&(this.integer=e.integer),void 0!==e.divisor&&(this.divisor=e.divisor),void 0!==e.buffer&&(this.buffer=e.buffer),void 0!==e.index&&(this.index="boolean"==typeof e.index?e.index?1:0:e.index),void 0!==e.instanced&&(this.divisor=e.instanced?1:0),void 0!==e.isInstanced&&(this.divisor=e.isInstanced?1:0),this}}const FV={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},Qie={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:FV},Zie={removedProps:FV};class sr extends zu{get[Symbol.toStringTag](){return"Buffer"}constructor(e,t={}){super(e,t),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=t.target||(this.gl.webgl2?36662:34962),this.initialize(t),Object.seal(this)}getElementCount(e=this.accessor){return Math.round(this.byteLength/ua.getBytesPerElement(e))}getVertexCount(e=this.accessor){return Math.round(this.byteLength/ua.getBytesPerVertex(e))}initialize(e={}){return ArrayBuffer.isView(e)&&(e={data:e}),Number.isFinite(e)&&(e={byteLength:e}),e=tI("Buffer",e,Qie),this.usage=e.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},e,e.accessor)),e.data?this._setData(e.data,e.offset,e.byteLength):this._setByteLength(e.byteLength||0),this}setProps(e){return"accessor"in(e=tI("Buffer",e,Zie))&&this.setAccessor(e.accessor),this}setAccessor(e){return delete(e=Object.assign({},e)).buffer,this.accessor=new ua(e),this}reallocate(e){return e>this.byteLength?(this._setByteLength(e),!0):(this.bytesUsed=e,!1)}setData(e){return this.initialize(e)}subData(e){ArrayBuffer.isView(e)&&(e={data:e});const{data:t,offset:i=0,srcOffset:r=0}=e,s=e.byteLength||e.length;nn(t);const o=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(o,this.handle),0!==r||void 0!==s?(Eo(this.gl),this.gl.bufferSubData(this.target,i,t,r,s)):this.gl.bufferSubData(o,i,t),this.gl.bindBuffer(o,null),this.debugData=null,this._inferType(t),this}copyData({sourceBuffer:e,readOffset:t=0,writeOffset:i=0,size:r}){const{gl:s}=this;return Eo(s),s.bindBuffer(36662,e.handle),s.bindBuffer(36663,this.handle),s.copyBufferSubData(36662,36663,t,i,r),s.bindBuffer(36662,null),s.bindBuffer(36663,null),this.debugData=null,this}getData({dstData:e=null,srcByteOffset:t=0,dstOffset:i=0,length:r=0}={}){Eo(this.gl);const s=m0(this.accessor.type||5126,{clamped:!1}),o=this._getAvailableElementCount(t),a=i;let l,c;e?(c=e.length,l=c-a):(l=Math.min(o,r||o),c=a+l);const u=Math.min(o,l);return nn((r=r||u)<=u),e=e||new s(c),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,t,e,i,r),this.gl.bindBuffer(36662,null),e}bind({target:e=this.target,index:t=this.accessor&&this.accessor.index,offset:i=0,size:r}={}){return 35345===e||35982===e?void 0!==r?this.gl.bindBufferRange(e,t,this.handle,i,r):(nn(0===i),this.gl.bindBufferBase(e,t,this.handle)):this.gl.bindBuffer(e,this.handle),this}unbind({target:e=this.target,index:t=this.accessor&&this.accessor.index}={}){return 35345===e||35982===e?this.gl.bindBufferBase(e,t,null):this.gl.bindBuffer(e,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(10,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(e,t=0,i=e.byteLength+t){nn(ArrayBuffer.isView(e)),this._trackDeallocatedMemory();const r=this._getTarget();this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,i,this.usage),this.gl.bufferSubData(r,t,e),this.gl.bindBuffer(r,null),this.debugData=e.slice(0,10),this.bytesUsed=i,this._trackAllocatedMemory(i);const s=eI(e);return nn(s),this.setAccessor(new ua(this.accessor,{type:s})),this}_setByteLength(e,t=this.usage){nn(e>=0),this._trackDeallocatedMemory();let i=e;0===e&&(i=new Float32Array(0));const r=this._getTarget();return this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,i,t),this.gl.bindBuffer(r,null),this.usage=t,this.debugData=null,this.bytesUsed=e,this._trackAllocatedMemory(e),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(e){const i=e/m0(this.accessor.type||5126,{clamped:!1}).BYTES_PER_ELEMENT;return this.getElementCount()-i}_inferType(e){this.accessor.type||this.setAccessor(new ua(this.accessor,{type:eI(e)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(e){this.gl.bindBuffer(this.target,this.handle);const t=this.gl.getBufferParameter(this.target,e);return this.gl.bindBuffer(this.target,null),t}get type(){return hn.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return hn.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(e){return hn.deprecated("setByteLength","reallocate")(),this.reallocate(e)}updateAccessor(e){return hn.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new ua(this.accessor,e),this}}const nI={6407:{dataFormat:6407,types:[5121,33635]},6408:{dataFormat:6408,types:[5121,32819,32820]},6406:{dataFormat:6406,types:[5121]},6409:{dataFormat:6409,types:[5121]},6410:{dataFormat:6410,types:[5121]},33326:{dataFormat:6403,types:[5126],gl2:!0},33328:{dataFormat:33319,types:[5126],gl2:!0},34837:{dataFormat:6407,types:[5126],gl2:!0},34836:{dataFormat:6408,types:[5126],gl2:!0}},LV={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},kV={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1},tre=[9729,9728],BV=globalThis.WebGLBuffer||function(){};class Af extends zu{get[Symbol.toStringTag](){return"Texture"}static isSupported(e,t={}){const{format:i,linearFiltering:r}=t;let s=!0;return i&&(s=s&&function(n,e){const t=nI[e];if(!t)return!1;if(void 0===t.gl1&&void 0===t.gl2)return!0;const i=_i(n)&&t.gl2||t.gl1;return"string"==typeof i?n.getExtension(i):i}(e,i),s=s&&(!r||function(n,e){const t=nI[e];switch(t&&t.types[0]){case 5126:return n.getExtension("OES_texture_float_linear");case 5131:return n.getExtension("OES_texture_half_float_linear");default:return!0}}(e,i))),s}constructor(e,t){const{id:i=ca("texture"),handle:r,target:s}=t;super(e,{id:i,handle:r}),this.target=s,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return`Texture(${this.id},${this.width}x${this.height})`}initialize(e={}){let t=e.data;if(t instanceof Promise)return t.then(D=>this.initialize(Object.assign({},e,{pixels:D,data:D}))),this;const i="undefined"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement;if(i&&t.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,t.addEventListener("loadeddata",()=>this.initialize(e)),this;const{pixels:r=null,format:s=6408,border:o=0,recreate:a=!1,parameters:l={},pixelStore:c={},textureUnit:u}=e;t||(t=r);let{width:h,height:f,dataFormat:g,type:m,compressed:w=!1,mipmaps:S=!0}=e;const{depth:U=0}=e;return({width:h,height:f,compressed:w,dataFormat:g,type:m}=this._deduceParameters({format:s,type:m,dataFormat:g,compressed:w,data:t,width:h,height:f})),this.width=h,this.height=f,this.depth=U,this.format=s,this.type=m,this.dataFormat=g,this.border=o,this.textureUnit=u,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),S&&this._isNPOT()&&(hn.warn(`texture: ${this} is Non-Power-Of-Two, disabling mipmaping`)(),S=!1,this._updateForNPOT(l)),this.mipmaps=S,this.setImageData({data:t,width:h,height:f,depth:U,format:s,type:m,dataFormat:g,border:o,mipmaps:S,parameters:c,compressed:w}),S&&this.generateMipmap(),this.setParameters(l),a&&(this.data=t),i&&(this._video={video:t,parameters:l,lastTime:t.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?t.currentTime:-1}),this}update(){if(this._video){const{video:e,parameters:t,lastTime:i}=this._video;if(i===e.currentTime||e.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:e,parameters:t}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=e.currentTime}}resize({height:e,width:t,mipmaps:i=!1}){return t!==this.width||e!==this.height?this.initialize({width:t,height:e,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:i}):this}generateMipmap(e={}){return this._isNPOT()?(hn.warn(`texture: ${this} is Non-Power-Of-Two, disabling mipmaping`)(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),sc(this.gl,e,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this)}setImageData(e){this._trackDeallocatedMemory("Texture");const{target:t=this.target,pixels:i=null,level:r=0,format:s=this.format,border:o=this.border,offset:a=0,parameters:l={}}=e;let{data:c=null,type:u=this.type,width:h=this.width,height:f=this.height,dataFormat:g=this.dataFormat,compressed:m=!1}=e;c||(c=i),({type:u,dataFormat:g,compressed:m,width:h,height:f}=this._deduceParameters({format:s,type:u,dataFormat:g,compressed:m,data:c,width:h,height:f}));const{gl:w}=this;w.bindTexture(this.target,this.handle);let S=null;({data:c,dataType:S}=this._getDataType({data:c,compressed:m}));let U,D=0;return sc(this.gl,l,()=>{switch(S){case"null":w.texImage2D(t,r,s,h,f,o,g,u,c);break;case"typed-array":w.texImage2D(t,r,s,h,f,o,g,u,c,a);break;case"buffer":U=Eo(w),U.bindBuffer(35052,c.handle||c),U.texImage2D(t,r,s,h,f,o,g,u,a),U.bindBuffer(35052,null);break;case"browser-object":_i(w)?w.texImage2D(t,r,s,h,f,o,g,u,c):w.texImage2D(t,r,s,g,u,c);break;case"compressed":for(const[ie,_e]of c.entries())w.compressedTexImage2D(t,ie,_e.format,_e.width,_e.height,o,_e.data),D+=_e.levelSize;break;default:nn(!1,"Unknown image data type")}}),this._trackAllocatedMemory("compressed"===S?D:c&&c.byteLength?c.byteLength:this.width*this.height*(LV[this.dataFormat]||4)*(kV[this.type]||1),"Texture"),this.loaded=!0,this}setSubImageData({target:e=this.target,pixels:t=null,data:i=null,x:r=0,y:s=0,width:o=this.width,height:a=this.height,level:l=0,format:c=this.format,type:u=this.type,dataFormat:h=this.dataFormat,compressed:f=!1,offset:g=0,border:m=this.border,parameters:w={}}){if(({type:u,dataFormat:h,compressed:f,width:o,height:a}=this._deduceParameters({format:c,type:u,dataFormat:h,compressed:f,data:i,width:o,height:a})),nn(0===this.depth,"texSubImage not supported for 3D textures"),i||(i=t),i&&i.data){const S=i;i=S.data,o=S.shape[0],a=S.shape[1]}i instanceof sr&&(i=i.handle),this.gl.bindTexture(this.target,this.handle),sc(this.gl,w,()=>{if(f)this.gl.compressedTexSubImage2D(e,l,r,s,o,a,c,i);else if(null===i)this.gl.texSubImage2D(e,l,r,s,o,a,h,u,null);else if(ArrayBuffer.isView(i))this.gl.texSubImage2D(e,l,r,s,o,a,h,u,i,g);else if(i instanceof BV){const S=Eo(this.gl);S.bindBuffer(35052,i),S.texSubImage2D(e,l,r,s,o,a,h,u,g),S.bindBuffer(35052,null)}else _i(this.gl)?Eo(this.gl).texSubImage2D(e,l,r,s,o,a,h,u,i):this.gl.texSubImage2D(e,l,r,s,h,u,i)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(e={}){return hn.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(e=this.textureUnit){const{gl:t}=this;return void 0!==e&&(this.textureUnit=e,t.activeTexture(33984+e)),t.bindTexture(this.target,this.handle),e}unbind(e=this.textureUnit){const{gl:t}=this;return void 0!==e&&(this.textureUnit=e,t.activeTexture(33984+e)),t.bindTexture(this.target,null),e}_getDataType({data:e,compressed:t=!1}){return t?{data:e,dataType:"compressed"}:null===e?{data:e,dataType:"null"}:ArrayBuffer.isView(e)?{data:e,dataType:"typed-array"}:e instanceof sr?{data:e.handle,dataType:"buffer"}:e instanceof BV?{data:e,dataType:"buffer"}:{data:e,dataType:"browser-object"}}_deduceParameters(e){const{format:t,data:i}=e;let{width:r,height:s,dataFormat:o,type:a,compressed:l}=e;const c=nI[t];return o=o||c&&c.dataFormat,a=a||c&&c.types[0],l=l||c&&c.compressed,({width:r,height:s}=this._deduceImageSize(i,r,s)),{dataFormat:o,type:a,compressed:l,width:r,height:s,format:t,data:i}}_deduceImageSize(e,t,i){let r;return r="undefined"!=typeof ImageData&&e instanceof ImageData?{width:e.width,height:e.height}:"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement?{width:e.naturalWidth,height:e.naturalHeight}:"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap?{width:e.width,height:e.height}:"undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement?{width:e.videoWidth,height:e.videoHeight}:e?{width:t,height:i}:{width:t>=0?t:1,height:i>=0?i:1},nn(r,"Could not deduced texture size"),nn(void 0===t||r.width===t,"Deduced texture width does not match supplied width"),nn(void 0===i||r.height===i,"Deduced texture height does not match supplied height"),r}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(e){switch(e){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const t=this.gl.getTexParameter(this.target,e);return this.gl.bindTexture(this.target,null),t}}_setParameter(e,t){switch(this.gl.bindTexture(this.target,this.handle),t=this._getNPOTParam(e,t),e){case 33082:case 33083:this.gl.texParameterf(this.handle,e,t);break;case 4096:case 4097:nn(!1);break;default:this.gl.texParameteri(this.target,e,t)}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return!(_i(this.gl)||!this.width||!this.height||RV(this.width)&&RV(this.height))}_updateForNPOT(e){void 0===e[this.gl.TEXTURE_MIN_FILTER]&&(e[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),void 0===e[this.gl.TEXTURE_WRAP_S]&&(e[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),void 0===e[this.gl.TEXTURE_WRAP_T]&&(e[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(e,t){if(this._isNPOT())switch(e){case 10241:-1===tre.indexOf(t)&&(t=9729);break;case 10242:case 10243:33071!==t&&(t=33071)}return t}}function nre(n,e){return nn("string"==typeof n),n=""+n,new Promise((t,i)=>{try{const r=new Image;r.onload=()=>t(r),r.onerror=()=>i(new Error(`Could not load image ${n}.`)),r.crossOrigin=e&&e.crossOrigin||"anonymous",r.src=n}catch(r){i(r)}})}class da extends Af{get[Symbol.toStringTag](){return"Texture2D"}static isSupported(e,t){return Af.isSupported(e,t)}constructor(e,t={}){nS(e),(t instanceof Promise||"string"==typeof t)&&(t={data:t}),"string"==typeof t.data&&(t=Object.assign({},t,{data:nre(t.data)})),super(e,Object.assign({},t,{target:3553})),this.initialize(t),Object.seal(this)}}const Mf="EXT_color_buffer_float",VV={33189:{bpp:2},33190:{gl2:!0,bpp:3},36012:{gl2:!0,bpp:4},36168:{bpp:1},34041:{bpp:4},35056:{gl2:!0,bpp:4},36013:{gl2:!0,bpp:5},32854:{bpp:2},36194:{bpp:2},32855:{bpp:2},33321:{gl2:!0,bpp:1},33330:{gl2:!0,bpp:1},33329:{gl2:!0,bpp:1},33332:{gl2:!0,bpp:2},33331:{gl2:!0,bpp:2},33334:{gl2:!0,bpp:4},33333:{gl2:!0,bpp:4},33323:{gl2:!0,bpp:2},33336:{gl2:!0,bpp:2},33335:{gl2:!0,bpp:2},33338:{gl2:!0,bpp:4},33337:{gl2:!0,bpp:4},33340:{gl2:!0,bpp:8},33339:{gl2:!0,bpp:8},32849:{gl2:!0,bpp:3},32856:{gl2:!0,bpp:4},32857:{gl2:!0,bpp:4},36220:{gl2:!0,bpp:4},36238:{gl2:!0,bpp:4},36975:{gl2:!0,bpp:4},36214:{gl2:!0,bpp:8},36232:{gl2:!0,bpp:8},36226:{gl2:!0,bpp:16},36208:{gl2:!0,bpp:16},33325:{gl2:Mf,bpp:2},33327:{gl2:Mf,bpp:4},34842:{gl2:Mf,bpp:8},33326:{gl2:Mf,bpp:4},33328:{gl2:Mf,bpp:8},34836:{gl2:Mf,bpp:16},35898:{gl2:Mf,bpp:4}};class Lg extends zu{get[Symbol.toStringTag](){return"Renderbuffer"}static isSupported(e,{format:t}={format:null}){return!t||function(n,e,t){const i=t[e];if(!i)return!1;const r=_i(n)&&i.gl2||i.gl1;return"string"==typeof r?n.getExtension(r):r}(e,t,VV)}static getSamplesForFormat(e,{format:t}){return e.getInternalformatParameter(36161,t,32937)}constructor(e,t={}){super(e,t),this.initialize(t),Object.seal(this)}initialize({format:e,width:t=1,height:i=1,samples:r=0}){return nn(e,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),0!==r&&_i(this.gl)?this.gl.renderbufferStorageMultisample(36161,r,e,t,i):this.gl.renderbufferStorage(36161,e,t,i),this.format=e,this.width=t,this.height=i,this.samples=r,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*VV[this.format].bpp),this}resize({width:e,height:t}){return e!==this.width||t!==this.height?this.initialize({width:e,height:t,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(e){this.gl.bindRenderbuffer(36161,e)}_syncHandle(e){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(e){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,e)}}const GV="clear: bad arguments";function rI(n,{framebuffer:e=null,color:t=null,depth:i=null,stencil:r=null}={}){const s={};e&&(s.framebuffer=e);let o=0;t&&(o|=16384,!0!==t&&(s.clearColor=t)),i&&(o|=256,!0!==i&&(s.clearDepth=i)),r&&(o|=1024,!0!==i&&(s.clearStencil=i)),nn(0!==o,GV),sc(n,s,()=>{n.clear(o)})}function $V(n,e,t,i,r,s,o){try{var a=n[s](o),l=a.value}catch(c){return void t(c)}a.done?e(l):Promise.resolve(l).then(i,r)}function ni(n){return function(){var e=this,t=arguments;return new Promise(function(i,r){var s=n.apply(e,t);function o(l){$V(s,i,r,o,a,"next",l)}function a(l){$V(s,i,r,o,a,"throw",l)}o(void 0)})}}const sI=[34069,34070,34071,34072,34073,34074];let cre=(()=>{class n extends Af{get[Symbol.toStringTag](){return"TextureCube"}constructor(t,i={}){nS(t),super(t,Object.assign({},i,{target:34067})),this.initialize(i),Object.seal(this)}initialize(t={}){const{mipmaps:i=!0,parameters:r={}}=t;return this.opts=t,this.setCubeMapImageData(t).then(()=>{this.loaded=!0,i&&this.generateMipmap(t),this.setParameters(r)}),this}subImage({face:t,data:i,x:r=0,y:s=0,mipmapLevel:o=0}){return this._subImage({target:t,data:i,x:r,y:s,mipmapLevel:o})}setCubeMapImageData({width:t,height:i,pixels:r,data:s,border:o=0,format:a=6408,type:l=5121}){var c=this;return ni(function*(){const{gl:u}=c,h=r||s,f=yield Promise.all(sI.map(g=>{const m=h[g];return Promise.all(Array.isArray(m)?m:[m])}));c.bind(),sI.forEach((g,m)=>{f[m].length>1&&!1!==c.opts.mipmaps&&hn.warn(`${c.id} has mipmap and multiple LODs.`)(),f[m].forEach((w,S)=>{t&&i?u.texImage2D(g,S,a,t,i,o,a,l,w):u.texImage2D(g,S,a,a,l,w)})}),c.unbind()})()}setImageDataForFace(t){const{face:i,width:r,height:s,pixels:o,data:a,border:l=0,format:c=6408,type:u=5121}=t,{gl:h}=this,f=o||a;return this.bind(),f instanceof Promise?f.then(g=>this.setImageDataForFace(Object.assign({},t,{face:i,data:g,pixels:g}))):this.width||this.height?h.texImage2D(i,0,c,r,s,l,c,u,f):h.texImage2D(i,0,c,c,u,f),this}}return n.FACES=sI,n})();class ure extends Af{get[Symbol.toStringTag](){return"Texture3D"}static isSupported(e){return _i(e)}constructor(e,t={}){Eo(e),super(e,t=Object.assign({depth:1},t,{target:32879,unpackFlipY:!1})),this.initialize(t),Object.seal(this)}setImageData({level:e=0,dataFormat:t=6408,width:i,height:r,depth:s=1,border:o=0,format:a,type:l=5121,offset:c=0,data:u,parameters:h={}}){return this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),sc(this.gl,h,()=>{ArrayBuffer.isView(u)&&this.gl.texImage3D(this.target,e,t,i,r,s,o,a,l,u),u instanceof sr&&(this.gl.bindBuffer(35052,u.handle),this.gl.texImage3D(this.target,e,t,i,r,s,o,a,l,c))}),this._trackAllocatedMemory(u&&u.byteLength?u.byteLength:this.width*this.height*this.depth*(LV[this.dataFormat]||4)*(kV[this.type]||1),"Texture"),this.loaded=!0,this}}function WV(n,e){nn(n instanceof da||n instanceof cre||n instanceof ure);const t=n.constructor,{gl:i,width:r,height:s,format:o,type:a,dataFormat:l,border:c,mipmaps:u}=n;return new t(i,Object.assign({width:r,height:s,format:o,type:a,dataFormat:l,border:c,mipmaps:u},e))}function dre(n,e){const{gl:t,width:i,height:r,id:s}=n;return new Rs(t,Object.assign({},e,{id:`framebuffer-for-${s}`,width:i,height:r,attachments:{36064:n}}))}function rS(n,e={}){const{sourceX:t=0,sourceY:i=0,sourceFormat:r=6408}=e;let{sourceAttachment:s=36064,target:o=null,sourceWidth:a,sourceHeight:l,sourceType:c}=e;const{framebuffer:u,deleteFramebuffer:h}=_0(n);nn(u);const{gl:f,handle:g,attachments:m}=u;a=a||u.width,l=l||u.height,36064===s&&null===g&&(s=1028),nn(m[s]),c=c||m[s].type,o=function(n,e,t,i,r){if(n)return n;return new(m0(e=e||5121,{clamped:!1}))(i*r*function(n){switch(n){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return nn(!1),0}}(t))}(o,c,r,a,l),c=c||eI(o);const w=f.bindFramebuffer(36160,g);return f.readPixels(t,i,a,l,r,c,o),f.bindFramebuffer(36160,w||null),h&&u.delete(),o}function oI(n,{sourceAttachment:e=36064,targetMaxHeight:t=Number.MAX_SAFE_INTEGER}={}){let i=rS(n,{sourceAttachment:e}),{width:r,height:s}=n;for(;s>t;)({data:i,width:r,height:s}=Yie({data:i,width:r,height:s}));!function({data:n,width:e,height:t,bytesPerPixel:i=4,temp:r}){const s=e*i;r=r||new Uint8Array(s);for(let o=0;o<t/2;++o){const a=o*s,l=(t-o-1)*s;r.set(n.subarray(a,a+s)),n.copyWithin(a,l,l+s),n.set(r,l)}}({data:i,width:r,height:s});const o=document.createElement("canvas");o.width=r,o.height=s;const a=o.getContext("2d"),l=a.createImageData(r,s);return l.data.set(i),a.putImageData(l,0,0),o.toDataURL()}function _0(n){return n instanceof Rs?{framebuffer:n,deleteFramebuffer:!1}:{framebuffer:dre(n),deleteFramebuffer:!0}}const qV="Multiple render targets not supported";class Rs extends zu{get[Symbol.toStringTag](){return"Framebuffer"}static isSupported(e,t={}){const{colorBufferFloat:i,colorBufferHalfFloat:r}=t;let s=!0;return i&&(s=Boolean(e.getExtension("EXT_color_buffer_float")||e.getExtension("WEBGL_color_buffer_float")||e.getExtension("OES_texture_float"))),r&&(s=s&&Boolean(e.getExtension("EXT_color_buffer_float")||e.getExtension("EXT_color_buffer_half_float"))),s}static getDefaultFramebuffer(e){return e.luma=e.luma||{},e.luma.defaultFramebuffer=e.luma.defaultFramebuffer||new Rs(e,{id:"default-framebuffer",handle:null,attachments:{}}),e.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const e=Eo(this.gl);return e.getParameter(e.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const e=Eo(this.gl);return e.getParameter(e.MAX_DRAW_BUFFERS)}constructor(e,t={}){super(e,t),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(t),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize({width:e=1,height:t=1,attachments:i=null,color:r=!0,depth:s=!0,stencil:o=!1,check:a=!0,readBuffer:l,drawBuffers:c}){if(nn(e>=0&&t>=0,"Width and height need to be integers"),this.width=e,this.height=t,i)for(const u in i){const h=i[u];(Array.isArray(h)?h[0]:h).resize({width:e,height:t})}else i=this._createDefaultAttachments(r,s,o,e,t);this.update({clearAttachments:!0,attachments:i,readBuffer:l,drawBuffers:c}),i&&a&&this.checkStatus()}delete(){for(const e of this.ownResources)e.delete();return super.delete(),this}update({attachments:e={},readBuffer:t,drawBuffers:i,clearAttachments:r=!1,resizeAttachments:s=!0}){this.attach(e,{clearAttachments:r,resizeAttachments:s});const{gl:o}=this,a=o.bindFramebuffer(36160,this.handle);return t&&this._setReadBuffer(t),i&&this._setDrawBuffers(i),o.bindFramebuffer(36160,a||null),this}resize(e={}){let{width:t,height:i}=e;if(null===this.handle)return nn(void 0===t&&void 0===i),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;void 0===t&&(t=this.gl.drawingBufferWidth),void 0===i&&(i=this.gl.drawingBufferHeight),t!==this.width&&i!==this.height&&hn.log(2,`Resizing framebuffer ${this.id} to ${t}x${i}`)();for(const r in this.attachments)this.attachments[r].resize({width:t,height:i});return this.width=t,this.height=i,this}attach(e,{clearAttachments:t=!1,resizeAttachments:i=!0}={}){const r={};t&&Object.keys(this.attachments).forEach(o=>{r[o]=null}),Object.assign(r,e);const s=this.gl.bindFramebuffer(36160,this.handle);for(const o in r){nn(void 0!==o,"Misspelled framebuffer binding point?");const a=Number(o),l=r[a];let c=l;if(c)if(c instanceof Lg)this._attachRenderbuffer({attachment:a,renderbuffer:c});else if(Array.isArray(l)){const[u,h=0,f=0]=l;c=u,this._attachTexture({attachment:a,texture:u,layer:h,level:f})}else this._attachTexture({attachment:a,texture:c,layer:0,level:0});else this._unattach(a);i&&c&&c.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,s||null),Object.assign(this.attachments,e),Object.keys(this.attachments).filter(o=>!this.attachments[o]).forEach(o=>{delete this.attachments[o]})}checkStatus(){const t=this.getStatus();if(36053!==t)throw new Error(function(n){return(Rs.STATUS||{})[n]||`Framebuffer error ${n}`}(t));return this}getStatus(){const{gl:e}=this,t=e.bindFramebuffer(36160,this.handle),i=e.checkFramebufferStatus(36160);return e.bindFramebuffer(36160,t||null),i}clear(e={}){const{color:t,depth:i,stencil:r,drawBuffers:s=[]}=e,o=this.gl.bindFramebuffer(36160,this.handle);return(t||i||r)&&rI(this.gl,{color:t,depth:i,stencil:r}),s.forEach((a,l)=>{!function(n,{framebuffer:e=null,buffer:t=6144,drawBuffer:i=0,value:r=[0,0,0,0]}={}){Eo(n),sc(n,{framebuffer:e},()=>{switch(t){case 6144:switch(r.constructor){case Int32Array:n.clearBufferiv(t,i,r);break;case Uint32Array:n.clearBufferuiv(t,i,r);break;case Float32Array:default:n.clearBufferfv(t,i,r)}break;case 6145:n.clearBufferfv(6145,0,[r]);break;case 6146:n.clearBufferiv(6146,0,[r]);break;case 34041:const[s,o]=r;n.clearBufferfi(34041,0,s,o);break;default:nn(!1,GV)}})}(this.gl,{drawBuffer:l,value:a})}),this.gl.bindFramebuffer(36160,o||null),this}readPixels(e={}){return hn.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(e={}){return hn.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(e={}){return hn.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(e={}){return hn.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(e={}){return hn.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(e={}){return hn.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate({attachments:e=[],x:t=0,y:i=0,width:r,height:s}){const o=Eo(this.gl),a=o.bindFramebuffer(36008,this.handle);return 0===t&&0===i&&void 0===r&&void 0===s?o.invalidateFramebuffer(36008,e):o.invalidateFramebuffer(36008,e,t,i,r,s),o.bindFramebuffer(36008,a),this}getAttachmentParameter(e,t,i){let r=this._getAttachmentParameterFallback(t);return null===r&&(this.gl.bindFramebuffer(36160,this.handle),r=this.gl.getFramebufferAttachmentParameter(36160,e,t),this.gl.bindFramebuffer(36160,null)),i&&r>1e3&&(r=rh(this.gl,r)),r}getAttachmentParameters(e=36064,t,i=this.constructor.ATTACHMENT_PARAMETERS||[]){const r={};for(const s of i)r[t?rh(this.gl,s):s]=this.getAttachmentParameter(e,s,t);return r}getParameters(e=!0){const t=Object.keys(this.attachments),i={};for(const r of t){const s=Number(r);i[e?rh(this.gl,s):s]=this.getAttachmentParameters(s,e)}return i}show(){return"undefined"!=typeof window&&window.open(oI(this),"luma-debug-texture"),this}log(e=0,t=""){if(e>hn.level||"undefined"==typeof window)return this;t=t||`Framebuffer ${this.id}`;const i=oI(this,{targetMaxHeight:100});return hn.image({logLevel:e,message:t,image:i},t)(),this}bind({target:e=36160}={}){return this.gl.bindFramebuffer(e,this.handle),this}unbind({target:e=36160}={}){return this.gl.bindFramebuffer(e,null),this}_createDefaultAttachments(e,t,i,r,s){let o=null;return e&&(o=o||{},o[36064]=new da(this.gl,{id:`${this.id}-color0`,pixels:null,format:6408,type:5121,width:r,height:s,mipmaps:!1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.ownResources.push(o[36064])),t&&i?(o=o||{},o[33306]=new Lg(this.gl,{id:`${this.id}-depth-stencil`,format:35056,width:r,height:111}),this.ownResources.push(o[33306])):t?(o=o||{},o[36096]=new Lg(this.gl,{id:`${this.id}-depth`,format:33189,width:r,height:s}),this.ownResources.push(o[36096])):i&&nn(!1),o}_unattach(e){const t=this.attachments[e];!t||(t instanceof Lg?this.gl.framebufferRenderbuffer(36160,e,36161,null):this.gl.framebufferTexture2D(36160,e,3553,null,0),delete this.attachments[e])}_attachRenderbuffer({attachment:e=36064,renderbuffer:t}){const{gl:i}=this;i.framebufferRenderbuffer(36160,e,36161,t.handle),this.attachments[e]=t}_attachTexture({attachment:e=36064,texture:t,layer:i,level:r}){const{gl:s}=this;switch(s.bindTexture(t.target,t.handle),t.target){case 35866:case 32879:Eo(s).framebufferTextureLayer(36160,e,t.target,r,i);break;case 34067:const a=function(n){return n<34069?n+34069:n}(i);s.framebufferTexture2D(36160,e,a,t.handle,r);break;case 3553:s.framebufferTexture2D(36160,e,3553,t.handle,r);break;default:nn(!1,"Illegal texture type")}s.bindTexture(t.target,null),this.attachments[e]=t}_setReadBuffer(e){const t=function(n){return _i(n)?n:null}(this.gl);t?t.readBuffer(e):nn(36064===e||1029===e,qV),this.readBuffer=e}_setDrawBuffers(e){const{gl:t}=this,i=Eo(t);if(i)i.drawBuffers(e);else{const r=t.getExtension("WEBGL_draw_buffers");r?r.drawBuffersWEBGL(e):nn(1===e.length&&(36064===e[0]||1029===e[0]),qV)}this.drawBuffers=e}_getAttachmentParameterFallback(e){const t=function(n){n.luma=n.luma||{},n.luma.caps=n.luma.caps||{};for(const e in YV)void 0===n.luma.caps[e]&&(n.luma.caps[e]=XV(n,e));return n.luma.caps}(this.gl);switch(e){case 36052:return t.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return t.WEBGL2?null:8;case 33297:return t.WEBGL2?null:5125;case 33296:return t.WEBGL2||t.EXT_sRGB?null:9729;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(e){return this.gl.bindFramebuffer(36160,e)}}Rs.ATTACHMENT_PARAMETERS=[36049,36048,33296,33298,33299,33300,33301,33302,33303];const YV={WEBGL2:[!1,!0],VERTEX_ARRAY_OBJECT:["OES_vertex_array_object",!0],TIMER_QUERY:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],INSTANCED_RENDERING:["ANGLE_instanced_arrays",!0],MULTIPLE_RENDER_TARGETS:["WEBGL_draw_buffers",!0],ELEMENT_INDEX_UINT32:["OES_element_index_uint",!0],BLEND_EQUATION_MINMAX:["EXT_blend_minmax",!0],FLOAT_BLEND:["EXT_float_blend"],COLOR_ENCODING_SRGB:["EXT_sRGB",!0],TEXTURE_DEPTH:["WEBGL_depth_texture",!0],TEXTURE_FLOAT:["OES_texture_float",!0],TEXTURE_HALF_FLOAT:["OES_texture_half_float",!0],TEXTURE_FILTER_LINEAR_FLOAT:["OES_texture_float_linear"],TEXTURE_FILTER_LINEAR_HALF_FLOAT:["OES_texture_half_float_linear"],TEXTURE_FILTER_ANISOTROPIC:["EXT_texture_filter_anisotropic"],COLOR_ATTACHMENT_RGBA32F:[function(n){const e=new da(n,{format:6408,type:5126,dataFormat:6408}),t=new Rs(n,{id:"test-framebuffer",check:!1,attachments:{36064:e}}),i=t.getStatus();return e.delete(),t.delete(),36053===i},"EXT_color_buffer_float"],COLOR_ATTACHMENT_FLOAT:[!1,"EXT_color_buffer_float"],COLOR_ATTACHMENT_HALF_FLOAT:["EXT_color_buffer_half_float"],GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]};function aI(n,e){return KV(n,e)}function KV(n,e){return(e=Array.isArray(e)?e:[e]).every(t=>XV(n,t))}function XV(n,e){return n.luma=n.luma||{},n.luma.caps=n.luma.caps||{},void 0===n.luma.caps[e]&&(n.luma.caps[e]=function(n,e){const t=YV[e];let i;nn(t,e);const r=_i(n)&&t[1]||t[0];if("function"==typeof r)i=r(n);else if(Array.isArray(r)){i=!0;for(const s of r)i=i&&Boolean(n.getExtension(s))}else"string"==typeof r?i=Boolean(n.getExtension(r)):"boolean"==typeof r?i=r:nn(!1);return i}(n,e)),n.luma.caps[e]||hn.log(2,`Feature: ${e} not supported`)(),n.luma.caps[e]}class lI{constructor(e,t){this.opts=t,this.source=e}get value(){return this.source.value}getValue(){const e=this.source.getBuffer(),t=this.getAccessor();if(e)return[e,t];const{value:i}=this.source,{size:r}=t;let s=i;if(i&&i.length!==r){s=new Float32Array(r);const o=t.elementOffset||0;for(let a=0;a<r;++a)s[a]=i[o+a]}return s}getAccessor(){return ot(ot({},this.source.getAccessor()),this.opts)}}const y0=new class{constructor(e){this._pool=[],this.props={overAlloc:2,poolSize:100},this.setProps(e)}setProps(e){Object.assign(this.props,e)}allocate(e,t,{size:i=1,type:r,padding:s=0,copy:o=!1,initialize:a=!1,maxCount:l}){const c=r||e&&e.constructor||Float32Array,u=t*i+s;if(ArrayBuffer.isView(e)){if(u<=e.length)return e;if(u*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new c(e.buffer,0,u)}let h;l&&(h=l*i+s);const f=this._allocate(c,u,a,h);return e&&o?f.set(e):a||f.fill(0,0,4),this._release(e),f}release(e){this._release(e)}_allocate(e,t,i,r){let s=Math.max(Math.ceil(t*this.props.overAlloc),1);s>r&&(s=r);const o=this._pool,a=e.BYTES_PER_ELEMENT*s,l=o.findIndex(c=>c.byteLength>=a);if(l>=0){const c=new e(o.splice(l,1)[0],0,s);return i&&c.fill(0),c}return new e(s)}_release(e){if(!ArrayBuffer.isView(e))return;const t=this._pool,{buffer:i}=e,{byteLength:r}=i,s=t.findIndex(o=>o.byteLength>=r);s<0?t.push(i):(s>0||t.length<this.props.poolSize)&&t.splice(s,0,i),t.length>this.props.poolSize&&t.shift()}},Sre=1/Math.PI*180,xre=1/180*Math.PI,Sr={};function Tre(n,{precision:e=Sr.precision||4}={}){return n=function(n){return Math.round(n/Sr.EPSILON)*Sr.EPSILON}(n),`${parseFloat(n.toPrecision(e))}`}function sh(n){return Array.isArray(n)||ArrayBuffer.isView(n)&&!(n instanceof DataView)}function Hu(n,e,t){if(sh(n)){t=t||function(n){return n.clone?n.clone():new Array(n.length)}(n);for(let i=0;i<t.length&&i<n.length;++i)t[i]=e(n[i],i,t);return t}return e(n)}function QV(n){return function(n,e){return Hu(n,t=>t*xre,void 0)}(n)}function Mre(n){return function(n,e){return Hu(n,t=>t*Sre,void 0)}(n)}function Pa(n,e,t){return Hu(n,i=>Math.max(e,Math.min(t,i)))}function sS(n,e,t){return sh(n)?n.map((i,r)=>sS(i,e[r],t)):t*e+(1-t)*n}function v0(n,e,t){const i=Sr.EPSILON;t&&(Sr.EPSILON=t);try{if(n===e)return!0;if(sh(n)&&sh(e)){if(n.length!==e.length)return!1;for(let r=0;r<n.length;++r)if(!v0(n[r],e[r]))return!1;return!0}return n&&n.equals?n.equals(e):e&&e.equals?e.equals(n):!(!Number.isFinite(n)||!Number.isFinite(e))&&Math.abs(n-e)<=Sr.EPSILON*Math.max(1,Math.abs(n),Math.abs(e))}finally{Sr.EPSILON=i}}function Gu(n,e){if(!n)throw new Error(`math.gl assertion ${e}`)}Sr.EPSILON=1e-12,Sr.debug=!1,Sr.precision=4,Sr.printTypes=!1,Sr.printDegrees=!1,Sr.printRowMajor=!0;class oS extends(function(n){function e(){var t=Reflect.construct(n,Array.from(arguments));return Object.setPrototypeOf(t,Object.getPrototypeOf(this)),t}return e.prototype=Object.create(n.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,n):e.__proto__=n,e}(Array)){get ELEMENTS(){return Gu(!1),0}clone(){return(new this.constructor).copy(this)}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}fromArray(e,t=0){for(let i=0;i<this.ELEMENTS;++i)this[i]=e[i+t];return this.check()}to(e){return e===this?this:sh(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toArray(e=[],t=0){for(let i=0;i<this.ELEMENTS;++i)e[t+i]=this[i];return e}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(Sr)}formatString(e){let t="";for(let i=0;i<this.ELEMENTS;++i)t+=(i>0?", ":"")+Tre(this[i],e);return`${e.printTypes?this.constructor.name:""}[${t}]`}equals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(!v0(this[t],e[t]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(this[t]!==e[t])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,t,i){void 0===i&&(i=t,t=e,e=this);for(let r=0;r<this.ELEMENTS;++r){const s=e[r];this[r]=s+i*(t[r]-s)}return this.check()}min(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.min(e[t],this[t]);return this.check()}max(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.max(e[t],this[t]);return this.check()}clamp(e,t){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(Math.max(this[i],e[i]),t[i]);return this.check()}add(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]+=t[i];return this.check()}subtract(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]-=t[i];return this.check()}scale(e){if(Array.isArray(e))return this.multiply(e);for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}sub(e){return this.subtract(e)}setScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=e;return this.check()}addScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}divideScalar(e){return this.scale(1/e)}clampScalar(e,t){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(Math.max(this[i],e),t);return this.check()}multiplyByScalar(e){return this.scale(e)}get elements(){return this}check(){if(Sr.debug&&!this.validate())throw new Error(`math.gl: ${this.constructor.name} some fields set to invalid numbers'`);return this}validate(){let e=this.length===this.ELEMENTS;for(let t=0;t<this.ELEMENTS;++t)e=e&&Number.isFinite(this[t]);return e}}function er(n){if(!Number.isFinite(n))throw new Error(`Invalid number ${n}`);return n}function b0(n,e,t=""){if(Sr.debug&&!function(n,e){if(n.length!==e)return!1;for(let t=0;t<n.length;++t)if(!Number.isFinite(n[t]))return!1;return!0}(n,e))throw new Error(`math.gl: ${t} some fields set to invalid numbers'`);return n}const ZV={};function kg(n,e){ZV[n]||(ZV[n]=!0,console.warn(`${n} has been removed in version ${e}, see upgrade guide for more information`))}class Pre extends oS{get ELEMENTS(){return Gu(!1),0}copy(e){return Gu(!1),this}get x(){return this[0]}set x(e){this[0]=er(e)}get y(){return this[1]}set y(e){this[1]=er(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let t=0;t<this.ELEMENTS;++t)e+=this[t]*this[t];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let t=0;for(let i=0;i<this.ELEMENTS;++i){const r=this[i]-e[i];t+=r*r}return er(t)}dot(e){let t=0;for(let i=0;i<this.ELEMENTS;++i)t+=this[i]*e[i];return er(t)}normalize(){const e=this.magnitude();if(0!==e)for(let t=0;t<this.ELEMENTS;++t)this[t]/=e;return this.check()}multiply(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]*=t[i];return this.check()}divide(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]/=t[i];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return Gu(e>=0&&e<this.ELEMENTS,"index is out of range"),er(this[e])}setComponent(e,t){return Gu(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=t,this.check()}addVectors(e,t){return this.copy(e).add(t)}subVectors(e,t){return this.copy(e).subtract(t)}multiplyVectors(e,t){return this.copy(e).multiply(t)}addScaledVector(e,t){return this.add(new this.constructor(e).multiplyScalar(t))}}var Yc=1e-6,ha="undefined"!=typeof Float32Array?Float32Array:Array;function JV(){var n=new ha(3);return ha!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n}function ej(n,e,t){var i=new ha(3);return i[0]=n,i[1]=e,i[2]=t,i}function tj(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]}function w0(n,e,t){var i=e[0],r=e[1],s=e[2],o=t[0],a=t[1],l=t[2];return n[0]=r*l-s*a,n[1]=s*o-i*l,n[2]=i*a-r*o,n}function cI(n,e,t){var i=e[0],r=e[1],s=e[2],o=t[3]*i+t[7]*r+t[11]*s+t[15];return n[0]=(t[0]*i+t[4]*r+t[8]*s+t[12])/(o=o||1),n[1]=(t[1]*i+t[5]*r+t[9]*s+t[13])/o,n[2]=(t[2]*i+t[6]*r+t[10]*s+t[14])/o,n}function aS(n,e,t){var i=e[0],r=e[1],s=e[2];return n[0]=i*t[0]+r*t[3]+s*t[6],n[1]=i*t[1]+r*t[4]+s*t[7],n[2]=i*t[2]+r*t[5]+s*t[8],n}function nj(n,e,t){var i=t[0],r=t[1],s=t[2],a=e[0],l=e[1],c=e[2],u=r*c-s*l,h=s*a-i*c,f=i*l-r*a,g=r*f-s*h,m=s*u-i*f,w=i*h-r*u,S=2*t[3];return h*=S,f*=S,m*=2,w*=2,n[0]=a+(u*=S)+(g*=2),n[1]=l+h+m,n[2]=c+f+w,n}function ij(n,e,t,i){var r=[],s=[];return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],s[0]=r[0],s[1]=r[1]*Math.cos(i)-r[2]*Math.sin(i),s[2]=r[1]*Math.sin(i)+r[2]*Math.cos(i),n[0]=s[0]+t[0],n[1]=s[1]+t[1],n[2]=s[2]+t[2],n}function rj(n,e,t,i){var r=[],s=[];return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],s[0]=r[2]*Math.sin(i)+r[0]*Math.cos(i),s[1]=r[1],s[2]=r[2]*Math.cos(i)-r[0]*Math.sin(i),n[0]=s[0]+t[0],n[1]=s[1]+t[1],n[2]=s[2]+t[2],n}function sj(n,e,t,i){var r=[],s=[];return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],s[0]=r[0]*Math.cos(i)-r[1]*Math.sin(i),s[1]=r[0]*Math.sin(i)+r[1]*Math.cos(i),s[2]=r[2],n[0]=s[0]+t[0],n[1]=s[1]+t[1],n[2]=s[2]+t[2],n}function oj(n,e){var t=n[0],i=n[1],r=n[2],s=e[0],o=e[1],a=e[2],u=Math.sqrt(t*t+i*i+r*r)*Math.sqrt(s*s+o*o+a*a),h=u&&tj(n,e)/u;return Math.acos(Math.min(Math.max(h,-1),1))}Math,Math,Math.hypot||(Math.hypot=function(){for(var n=0,e=arguments.length;e--;)n+=arguments[e]*arguments[e];return Math.sqrt(n)});function aj(n,e,t){const i=e[0],r=e[1],s=e[2],o=t[3]*i+t[7]*r+t[11]*s||1;return n[0]=(t[0]*i+t[4]*r+t[8]*s)/o,n[1]=(t[1]*i+t[5]*r+t[9]*s)/o,n[2]=(t[2]*i+t[6]*r+t[10]*s)/o,n}JV();const uI=[0,0,0],lj={};class So extends Pre{static get ZERO(){return lj.ZERO=lj.ZERO||Object.freeze(new So(0,0,0,0))}constructor(e=0,t=0,i=0){super(-0,-0,-0),1===arguments.length&&sh(e)?this.copy(e):(Sr.debug&&(er(e),er(t),er(i)),this[0]=e,this[1]=t,this[2]=i)}set(e,t,i){return this[0]=e,this[1]=t,this[2]=i,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return Sr.debug&&(er(e.x),er(e.y),er(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=er(e)}angle(e){return oj(this,e)}cross(e){return w0(this,this,e),this.check()}rotateX({radians:e,origin:t=uI}){return ij(this,this,t,e),this.check()}rotateY({radians:e,origin:t=uI}){return rj(this,this,t,e),this.check()}rotateZ({radians:e,origin:t=uI}){return sj(this,this,t,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return cI(this,this,e),this.check()}transformAsVector(e){return aj(this,this,e),this.check()}transformByMatrix3(e){return aS(this,this,e),this.check()}transformByMatrix2(e){return function(n,e,t){const i=e[0],r=e[1];n[0]=t[0]*i+t[2]*r,n[1]=t[1]*i+t[3]*r,n[2]=e[2]}(this,this,e),this.check()}transformByQuaternion(e){return nj(this,this,e),this.check()}}const cj=new So;function Bg(n,e,t,i){cj.set(n,e,t);const r=cj.len();return{distance:i/r,normal:new So(-n/r,-e/r,-t/r)}}function Yre(n){return n-Math.fround(n)}let S0;function dI(n,{size:e=1,startIndex:t=0,endIndex:i}){Number.isFinite(i)||(i=n.length);const r=(i-t)/e;S0=y0.allocate(S0,r,{type:Float32Array,size:2*e});let s=t,o=0;for(;s<i;){for(let a=0;a<e;a++){const l=n[s++];S0[o+a]=l,S0[o+a+e]=Yre(l)}o+=2*e}return S0.subarray(0,r*e*2)}function lS(n){return n.stride||n.size*n.bytesPerElement}function uj(n,e){e.offset&&Mi.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const t=lS(n),s=("vertexOffset"in e?e.vertexOffset:n.vertexOffset||0)*t+(e.elementOffset||0)*n.bytesPerElement+(n.offset||0);return wn(ot({},e),{offset:s,stride:t})}function oc(n,e){if(!n)throw new Error(e||"deck.gl: assertion failed.")}const dj=[],hj=[];function cS(n,e=0,t=1/0){let i=dj;const r={index:-1,data:n,target:[]};return n?"function"==typeof n[Symbol.iterator]?i=n:n.length>0&&(hj.length=n.length,i=hj):i=dj,(e>0||Number.isFinite(t))&&(i=(Array.isArray(i)?i:Array.from(i)).slice(e,t),r.index=e-1),{iterable:i,objectInfo:r}}function fj(n){return n&&n[Symbol.asyncIterator]}function hI(n,e=(()=>!0)){return Array.isArray(n)?pj(n,e,[]):e(n)?[n]:[]}function pj(n,e,t){let i=-1;for(;++i<n.length;){const r=n[i];Array.isArray(r)?pj(r,e,t):e(r)&&t.push(r)}return t}function Zre({target:n,source:e,start:t=0,count:i=1}){const r=e.length,s=i*r;let o=0;for(let a=t;o<r;o++)n[a++]=e[o];for(;o<s;)o<s-o?(n.copyWithin(t+o,t,t+o),o*=2):(n.copyWithin(t+o,t,t+s-o),o=s);return n}const Jre=[],uS=[[0,1/0]];function fI({source:n,target:e,start:t=0,end:i,size:r,getData:s}){const o=n.length,a=(i=i||e.length)-t;if(o>a)return void e.set(n.subarray(0,a),t);if(e.set(n,t),!s)return;let l=o;for(;l<a;){const c=s(l,n);for(let u=0;u<r;u++)e[t+l]=c[u]||0,l++}}const nse={interpolation:{duration:0,easing:n=>n},spring:{stiffness:.05,damping:.5}};function gj(n,e){return n?(Number.isFinite(n)&&(n={duration:n}),n.type=n.type||"interpolation",ot(ot(ot({},nse[n.type]),e),n)):null}function mj(n,e){return e.getBuffer()?[e.getBuffer(),{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function _j(n){switch(n){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(n,'"'))}}function yj(n){n.push(n.shift())}function pI(n,e){const{doublePrecision:t,settings:i,value:r,size:s}=n,o=t&&r instanceof Float64Array?2:1;return(i.noAlloc?r.length:e*s)*o}function vj({buffer:n,numInstances:e,attribute:t,fromLength:i,fromStartIndices:r,getData:s=(o=>o)}){const o=t.doublePrecision&&t.value instanceof Float64Array?2:1,a=t.size*o,l=t.byteOffset,c=t.startIndices,u=r&&c,h=pI(t,e),f=t.state.constant;if(!u&&i>=h)return;const g=f?t.value:t.getBuffer().getData({srcByteOffset:l});if(t.settings.normalized&&!f){const U=s;s=(D,ie)=>t._normalizeConstant(U(D,ie))}const m=f?(U,D)=>s(g,D):(U,D)=>s(g.subarray(U,U+a),D),w=n.getData({length:i}),S=new Float32Array(h);(function({source:n,target:e,size:t,getData:i,sourceStartIndices:r,targetStartIndices:s}){if(!Array.isArray(s))return fI({source:n,target:e,size:t,getData:i}),e;let o=0,a=0;const l=i&&((u,h)=>i(u+a,h)),c=Math.min(r.length,s.length);for(let u=1;u<c;u++){const h=r[u]*t,f=s[u]*t;fI({source:n.subarray(o,h),target:e,start:a,end:f,size:t,getData:l}),o=h,a=f}a<e.length&&fI({source:[],target:e,start:a,size:t,getData:l})})({source:w,target:S,sourceStartIndices:r,targetStartIndices:c,size:a,getData:m}),n.byteLength<S.byteLength+l&&n.reallocate(S.byteLength+l),n.subData({data:S,offset:l})}class gI extends class{constructor(e,t){this.gl=e,this.id=t.id,this.size=t.size;const i=t.logicalType||t.type,r=5130===i;let{defaultValue:s}=t;s=Number.isFinite(s)?[s]:s||new Array(this.size).fill(0),t.defaultValue=s;let o=i;r?o=5126:!o&&t.isIndexed?o=e&&aI(e,"ELEMENT_INDEX_UINT32")?5125:5123:o||(o=5126),t.logicalType=i,t.type=o;let a=function(n){switch(n){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}(i||o||5126);this.shaderAttributes={},this.doublePrecision=r,r&&!1===t.fp64&&(a=Float32Array),t.bytesPerElement=a.BYTES_PER_ELEMENT,this.defaultType=a,this.value=null,this.settings=t,this.state={externalBuffer:null,bufferAccessor:t,allocatedValue:null,constant:!1},this._buffer=null,this.setData(t)}get buffer(){if(!this._buffer){const{isIndexed:e,type:t}=this.settings;this._buffer=new sr(this.gl,{id:this.id,target:e?34963:34962,accessor:{type:t}})}return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*lS(e):0}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),y0.release(this.state.allocatedValue)}getShaderAttributes(e,t){if(this.doublePrecision){const i={},r=this.value instanceof Float64Array,s=function(n,e){const t=uj(n,e);return{high:t,low:wn(ot({},t),{offset:t.offset+4*n.size})}}(this.getAccessor(),t||{});return i[e]=new lI(this,s.high),i["".concat(e,"64Low")]=r?new lI(this,s.low):new Float32Array(this.size),i}if(t){const i=uj(this.getAccessor(),t);return{[e]:new lI(this,i)}}return{[e]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}setData(e){const{state:t}=this;ArrayBuffer.isView(e)?e={value:e}:e instanceof sr&&(e={buffer:e});const i=ot(ot({},this.settings),e);if(t.bufferAccessor=i,e.constant){let r=e.value;if(r=this._normalizeValue(r,[],0),this.settings.normalized&&(r=this._normalizeConstant(r)),t.constant&&this._areValuesEqual(r,this.value))return!1;t.externalBuffer=null,t.constant=!0,this.value=r}else if(e.buffer){const r=e.buffer;t.externalBuffer=r,t.constant=!1,this.value=e.value;const s=e.value instanceof Float64Array;i.type=e.type||r.accessor.type,i.bytesPerElement=r.accessor.BYTES_PER_ELEMENT*(s?2:1),i.stride=lS(i)}else if(e.value){this._checkExternalBuffer(e);let r=e.value;t.externalBuffer=null,t.constant=!1,this.value=r,i.bytesPerElement=r.BYTES_PER_ELEMENT,i.stride=lS(i);const{buffer:s,byteOffset:o}=this;this.doublePrecision&&r instanceof Float64Array&&(r=dI(r,i));const a=r.byteLength+o+2*i.stride;s.byteLength<a&&s.reallocate(a),s.setAccessor(null),s.subData({data:r,offset:o}),i.type=e.type||s.accessor.type}return!0}updateSubBuffer(e={}){const{value:t}=this,{startOffset:i=0,endOffset:r}=e;this.buffer.subData({data:this.doublePrecision&&t instanceof Float64Array?dI(t,{size:this.size,startIndex:i,endIndex:r}):t.subarray(i,r),offset:i*t.BYTES_PER_ELEMENT+this.byteOffset})}allocate({numInstances:e,copy:t=!1}){const{state:i}=this,r=i.allocatedValue,s=y0.allocate(r,e+1,{size:this.size,type:this.defaultType,copy:t});this.value=s;const{buffer:o,byteOffset:a}=this;return o.byteLength<s.byteLength+a&&(o.reallocate(s.byteLength+a),t&&r&&o.subData({data:r instanceof Float64Array?dI(r,this):r,offset:a})),i.allocatedValue=s,i.constant=!1,i.externalBuffer=null,i.bufferAccessor=this.settings,!0}_checkExternalBuffer(e){const{value:t}=e;if(!e.constant&&t){const i=this.defaultType;let r=!1;if(this.doublePrecision&&(r=t.BYTES_PER_ELEMENT<4),r)throw new Error("Attribute ".concat(this.id," does not support ").concat(t.constructor.name));!(t instanceof i)&&this.settings.normalized&&!("normalized"in e)&&Mi.warn("Attribute ".concat(this.id," is normalized"))()}}_normalizeConstant(e){switch(this.settings.type){case 5120:return new Float32Array(e).map(t=>(t+128)/255*2-1);case 5122:return new Float32Array(e).map(t=>(t+32768)/65535*2-1);case 5121:return new Float32Array(e).map(t=>t/255);case 5123:return new Float32Array(e).map(t=>t/65535);default:return e}}_normalizeValue(e,t,i){const{defaultValue:r,size:s}=this.settings;if(Number.isFinite(e))return t[i]=e,t;if(!e)return t[i]=r[0],t;switch(s){case 4:t[i+3]=Number.isFinite(e[3])?e[3]:r[3];case 3:t[i+2]=Number.isFinite(e[2])?e[2]:r[2];case 2:t[i+1]=Number.isFinite(e[1])?e[1]:r[1];case 1:t[i+0]=Number.isFinite(e[0])?e[0]:r[0];break;default:let o=s;for(;--o>=0;)t[i+o]=Number.isFinite(e[o])?e[o]:r[o]}return t}_areValuesEqual(e,t){if(!e||!t)return!1;const{size:i}=this;for(let r=0;r<i;r++)if(e[r]!==t[r])return!1;return!0}}{constructor(e,t={}){super(e,t);const{transition:i=!1,noAlloc:r=!1,update:s=null,accessor:o=null,transform:a=null,startIndices:l=null}=t;Object.assign(this.settings,{transition:i,noAlloc:r,update:s||o&&this._autoUpdater,accessor:o,transform:a}),Object.assign(this.state,{lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:uS,startIndices:l}),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const t=this.state.needsRedraw;return this.state.needsRedraw=t&&!e,t}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat("function"!=typeof e&&e||[])}supportsTransition(){return Boolean(this.settings.transition)}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:t}=this.settings,i=this.settings.transition;return gj(Array.isArray(t)?e[t.find(s=>e[s])]:e[t],i)}setNeedsUpdate(e=this.id,t){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),t){const{startRow:i=0,endRow:r=1/0}=t;this.state.updateRanges=function(n,e){if(n===uS||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return n;const t=[],i=n.length;let r=0;for(let s=0;s<i;s++){const o=n[s];o[1]<e[0]?(t.push(o),r=s+1):o[0]>e[1]?t.push(o):e=[Math.min(o[0],e[0]),Math.max(o[1],e[1])]}return t.splice(r,0,e),t}(this.state.updateRanges,[i,r])}else this.state.updateRanges=uS}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=Jre}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}update(e){this.setData(e)}allocate(e){const{state:t,settings:i}=this;return!i.noAlloc&&!!i.update&&(super.allocate({numInstances:e,copy:t.updateRanges!==uS}),!0)}updateBuffer({numInstances:e,data:t,props:i,context:r}){if(!this.needsUpdate())return!1;const{state:{updateRanges:s},settings:{update:o,noAlloc:a}}=this;let l=!0;if(o){for(const[c,u]of s)o.call(r,this,{data:t,startRow:c,endRow:u,props:i,numInstances:e});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant});else for(const[c,u]of s){const h=Number.isFinite(c)?this.getVertexOffset(c):0,f=Number.isFinite(u)?this.getVertexOffset(u):a||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:h,endOffset:f})}this._checkAttributeArray()}else l=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),l}setConstantValue(e){return void 0!==e&&"function"!=typeof e&&(this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(e){const{state:t}=this;return e?(this.clearNeedsUpdate(),t.lastExternalBuffer===e||(t.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(t.lastExternalBuffer=null,!1)}setBinaryValue(e,t=null){const{state:i,settings:r}=this;return e?!r.noAlloc&&(i.binaryValue===e?(this.clearNeedsUpdate(),!0):(i.binaryValue=e,this.setNeedsRedraw(),ArrayBuffer.isView(e)&&(e={value:e}),r.transform||t!==this.startIndices?(oc(ArrayBuffer.isView(e.value),"invalid ".concat(r.accessor)),i.binaryAccessor=function(n,{size:e,stride:t,offset:i,startIndices:r,nested:s}){const o=n.BYTES_PER_ELEMENT,a=t?t/o:e,l=i?i/o:0,c=Math.floor((n.length-l)/a);return(u,{index:h,target:f})=>{if(!r){const S=h*a+l;for(let U=0;U<e;U++)f[U]=n[S+U];return f}const g=r[h],m=r[h+1]||c;let w;if(s){w=new Array(m-g);for(let S=g;S<m;S++){const U=S*a+l;f=new Array(e);for(let D=0;D<e;D++)f[D]=n[U+D];w[S-g]=f}}else if(a===e)w=n.subarray(g*e+l,m*e+l);else{w=new n.constructor((m-g)*e);let S=0;for(let U=g;U<m;U++){const D=U*a+l;for(let ie=0;ie<e;ie++)w[S++]=n[D+ie]}}return w}}(e.value,{size:e.size||this.size,stride:e.stride,offset:e.offset,startIndices:t,nested:e.size&&e.size!==this.size}),!1):(this.clearNeedsUpdate(),this.setData(e),!0))):(i.binaryValue=null,i.binaryAccessor=null,!1)}getVertexOffset(e){const{startIndices:t}=this;return(t?t[e]:e)*this.size}getShaderAttributes(){const e=this.settings.shaderAttributes||{[this.id]:null},t={};for(const i in e)Object.assign(t,super.getShaderAttributes(i,e[i]));return t}_autoUpdater(e,{data:t,startRow:i,endRow:r,props:s,numInstances:o}){if(e.constant)return;const{settings:a,state:l,value:c,size:u,startIndices:h}=e,{accessor:f,transform:g}=a,m=l.binaryAccessor||("function"==typeof f?f:s[f]);oc("function"==typeof m,'accessor "'.concat(f,'" is not a function'));let w=e.getVertexOffset(i);const{iterable:S,objectInfo:U}=cS(t,i,r);for(const D of S){U.index++;let ie=m(D,U);if(g&&(ie=g.call(this,ie)),h){const _e=(U.index<h.length-1?h[U.index+1]:o)-h[U.index];if(ie&&Array.isArray(ie[0])){let Ne=w;for(const Pe of ie)e._normalizeValue(Pe,c,Ne),Ne+=u}else ie&&ie.length>u?c.set(ie,w):(e._normalizeValue(ie,U.target,0),Zre({target:c,source:U.target,start:w,count:_e}));w+=_e*u}else e._normalizeValue(ie,c,w),w+=u}}_validateAttributeUpdaters(){const{settings:e}=this;if(!e.noAlloc&&"function"!=typeof e.update)throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:e}=this,t=Math.min(4,this.size);if(e&&e.length>=t){let i=!0;switch(t){case 4:i=i&&Number.isFinite(e[3]);case 3:i=i&&Number.isFinite(e[2]);case 2:i=i&&Number.isFinite(e[1]);case 1:i=i&&Number.isFinite(e[0]);break;default:i=!1}if(!i)throw new Error("Illegal attribute generated for ".concat(this.id))}}}let mI={};function xo(n){Mi.level>0&&mI[n]&&mI[n].call(...arguments)}function Fa(n,e){if(!n)throw new Error(e||"shadertools: assertion failed.")}const bj="out vec4 transform_output;\nvoid main() {\n  transform_output = vec4(0);\n}",sse=`#version 300 es\n${bj}`;function wj(n,e){e=Array.isArray(e)?e:[e];const t=n.replace(/^\s+/,"").split(/\s+/),[i,r,s]=t;return e.includes(i)&&r&&s?{qualifier:i,type:r,name:s.split(";")[0]}:null}function Ej(n={}){const{version:e=100,input:t,inputType:i,output:r}=n;if(!t)return 300===e?sse:e>300?`#version ${e}\n${bj}`:"void main() {gl_FragColor = vec4(0);}";const s=function(n,e){switch(e){case"float":return`vec4(${n}, 0.0, 0.0, 1.0)`;case"vec2":return`vec4(${n}, 0.0, 1.0)`;case"vec3":return`vec4(${n}, 1.0)`;case"vec4":return n;default:return Fa(!1),null}}(t,i);return e>=300?`#version ${e} ${300===e?"es":""}\nin ${i} ${t};\nout vec4 ${r};\nvoid main() {\n  ${r} = ${s};\n}`:`varying ${i} ${t};\nvoid main() {\n  gl_FragColor = ${s};\n}`}class Sj extends zu{get[Symbol.toStringTag](){return"TransformFeedback"}static isSupported(e){return _i(e)}constructor(e,t={}){Eo(e),super(e,t),this.initialize(t),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(e={}){return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,Pg(this.buffers)||this.bind(()=>this._unbindBuffers()),this.setProps(e),this}setProps(e){"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"bindOnUse"in e&&(e=e.bindOnUse),"buffers"in e&&this.setBuffers(e.buffers)}setBuffers(e={}){return this.bind(()=>{for(const t in e)this.setBuffer(t,e[t])}),this}setBuffer(e,t){const i=this._getVaryingIndex(e),{buffer:r,byteSize:s,byteOffset:o}=this._getBufferParams(t);return i<0?(this.unused[e]=r,hn.warn(()=>`${this.id} unused varying buffer ${e}`)(),this):(this.buffers[i]=t,this.bindOnUse||this._bindBuffer(i,r,o,s),this)}begin(e=0){return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(e),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(e){let t,i,r;return e instanceof sr?r=e:(r=e.buffer,i=e.byteSize,t=e.byteOffset),(void 0!==t||void 0!==i)&&(t=t||0,i=i||r.byteLength-t),{buffer:r,byteOffset:t,byteSize:i}}_getVaryingInfo(e){return this.configuration&&this.configuration.getVaryingInfo(e)}_getVaryingIndex(e){if(this.configuration)return this.configuration.getVaryingInfo(e).location;const t=Number(e);return Number.isFinite(t)?t:-1}_bindBuffers(){if(this.bindOnUse)for(const e in this.buffers){const{buffer:t,byteSize:i,byteOffset:r}=this._getBufferParams(this.buffers[e]);this._bindBuffer(e,t,r,i)}}_unbindBuffers(){if(this.bindOnUse)for(const e in this.buffers)this._bindBuffer(e,null)}_bindBuffer(e,t,i=0,r){const s=t&&t.handle;return s&&void 0!==r?this.gl.bindBufferRange(35982,e,s,i,r):this.gl.bindBufferBase(35982,e,s),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(e){this.gl.bindTransformFeedback(36386,this.handle)}}class cse{constructor(e,t={}){this.gl=e,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(t),Object.seal(this)}setupResources(e){for(const t of this.bindings)this._setupTransformFeedback(t,e)}updateModelProps(e={}){const{varyings:t}=this;return t.length>0&&(e=Object.assign({},e,{varyings:t})),e}getDrawOptions(e={}){const t=this.bindings[this.currentIndex],{sourceBuffers:i,transformFeedback:r}=t;return{attributes:Object.assign({},i,e.attributes),transformFeedback:r}}swap(){return!!this.feedbackMap&&(this.currentIndex=this._getNextIndex(),!0)}update(e={}){this._setupBuffers(e)}getBuffer(e){const{feedbackBuffers:t}=this.bindings[this.currentIndex],i=e?t[e]:null;return i?i instanceof sr?i:i.buffer:null}getData(e={}){const{varyingName:t}=e,i=this.getBuffer(t);return i?i.getData():null}delete(){for(const e in this.resources)this.resources[e].delete()}_initialize(e={}){this._setupBuffers(e),this.varyings=e.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&nn(_i(this.gl))}_getFeedbackBuffers(e){const{sourceBuffers:t={}}=e,i={};if(this.bindings[this.currentIndex]&&Object.assign(i,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const r in this.feedbackMap){const s=this.feedbackMap[r];r in t&&(i[s]=r)}Object.assign(i,e.feedbackBuffers);for(const r in i){const s=i[r];if("string"==typeof s){const o=t[s],{byteLength:a,usage:l,accessor:c}=o;i[r]=this._createNewBuffer(r,{byteLength:a,usage:l,accessor:c})}}return i}_setupBuffers(e={}){const{sourceBuffers:t=null}=e;Object.assign(this.feedbackMap,e.feedbackMap);const i=this._getFeedbackBuffers(e);this._updateBindings({sourceBuffers:t,feedbackBuffers:i})}_setupTransformFeedback(e,{model:t}){const{program:i}=t;e.transformFeedback=new Sj(this.gl,{program:i,buffers:e.feedbackBuffers})}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this.feedbackMap){const{sourceBuffers:t,feedbackBuffers:i}=this._swapBuffers(this.bindings[this.currentIndex]),r=this._getNextIndex();this.bindings[r]=this._updateBinding(this.bindings[r],{sourceBuffers:t,feedbackBuffers:i})}}_updateBinding(e,t){return e?(Object.assign(e.sourceBuffers,t.sourceBuffers),Object.assign(e.feedbackBuffers,t.feedbackBuffers),e.transformFeedback&&e.transformFeedback.setBuffers(e.feedbackBuffers),e):{sourceBuffers:Object.assign({},t.sourceBuffers),feedbackBuffers:Object.assign({},t.feedbackBuffers)}}_swapBuffers(e){if(!this.feedbackMap)return null;const t=Object.assign({},e.sourceBuffers),i=Object.assign({},e.feedbackBuffers);for(const r in this.feedbackMap){const s=this.feedbackMap[r];t[r]=e.feedbackBuffers[s],i[s]=e.sourceBuffers[r],nn(i[s]instanceof sr)}return{sourceBuffers:t,feedbackBuffers:i}}_createNewBuffer(e,t){const i=new sr(this.gl,t);return this.resources[e]&&this.resources[e].delete(),this.resources[e]=i,i}_getNextIndex(){return(this.currentIndex+1)%2}}function xj(n){let e=100;const t=n.match(/[^\s]+/g);if(t.length>=2&&"#version"===t[0]){const i=parseInt(t[1],10);Number.isFinite(i)&&(e=i)}return e}const x0="vs",hse={[x0]:"#ifdef MODULE_LOGDEPTH\n  logdepth_adjustPosition(gl_Position);\n#endif\n",fs:"#ifdef MODULE_MATERIAL\n  gl_FragColor = material_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LIGHTING\n  gl_FragColor = lighting_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_FOG\n  gl_FragColor = fog_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_PICKING\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LOGDEPTH\n  logdepth_setFragDepth();\n#endif\n"},dS="__LUMA_INJECT_DECLARATIONS__",Cj=/void\s+main\s*\([^)]*\)\s*\{\n?/,Tj=/}\n?[^{}]*$/,yI=[];function Aj(n,e,t,i=!1){const r=e===x0;for(const s in t){const o=t[s];o.sort((l,c)=>l.order-c.order),yI.length=o.length;for(let l=0,c=o.length;l<c;++l)yI[l]=o[l].injection;const a=`${yI.join("\n")}\n`;switch(s){case"vs:#decl":r&&(n=n.replace(dS,a));break;case"vs:#main-start":r&&(n=n.replace(Cj,l=>l+a));break;case"vs:#main-end":r&&(n=n.replace(Tj,l=>a+l));break;case"fs:#decl":r||(n=n.replace(dS,a));break;case"fs:#main-start":r||(n=n.replace(Cj,l=>l+a));break;case"fs:#main-end":r||(n=n.replace(Tj,l=>a+l));break;default:n=n.replace(s,l=>l+a)}}return n=n.replace(dS,""),i&&(n=n.replace(/\}\s*$/,s=>s+hse[e])),n}function vI(n){const e={};return Fa(Array.isArray(n)&&n.length>1),n.forEach(t=>{for(const i in t)e[i]=e[i]?`${e[i]}\n${t[i]}`:t[i]}),e}const fse={name:"transform",vs:"attribute float transform_elementID;\nvec2 transform_getPixelSizeHalf(vec2 size) {\n  return vec2(1.) / (2. * size);\n}\n\nvec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {\n  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);\n  float xIndex = transform_elementID - (yIndex * texSize[0]);\n  return vec2(xIndex, yIndex);\n}\nvec2 transform_getTexCoord(vec2 size) {\n  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);\n  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);\n  vec2 coord = indices / size + pixelSizeHalf;\n  return coord;\n}\nvec2 transform_getPos(vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);\n  return pos;\n}\nvec4 transform_getInput(sampler2D texSampler, vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec4 textureColor = texture2D(texSampler, texCoord);\n  return textureColor;\n}\n",fs:null},hS="transform_uSize_",Mj="transform_position";const wse={10241:9728,10240:9728,10242:33071,10243:33071};class Sse{constructor(e,t={}){this.gl=e,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(t),Object.seal(this)}updateModelProps(e={}){const t=this._processVertexShader(e);return Object.assign({},e,t)}getDrawOptions(e={}){const{sourceBuffers:t,sourceTextures:i,framebuffer:r,targetTexture:s}=this.bindings[this.currentIndex],o=Object.assign({},t,e.attributes),a=Object.assign({},e.uniforms),l=Object.assign({},e.parameters);let c=e.discard;if(this.hasSourceTextures||this.hasTargetTexture){o.transform_elementID=this.elementIDBuffer;for(const h in this.samplerTextureMap)a[h]=i[this.samplerTextureMap[h]];this._setSourceTextureParameters();const u=function({sourceTextureMap:n,targetTextureVarying:e,targetTexture:t}){const i={};let r,s;e&&(({width:r,height:s}=t),i[`${hS}${e}`]=[r,s]);for(const o in n)({width:r,height:s}=n[o]),i[`${hS}${o}`]=[r,s];return i}({sourceTextureMap:i,targetTextureVarying:this.targetTextureVarying,targetTexture:s});Object.assign(a,u)}return this.hasTargetTexture&&(c=!1,l.viewport=[0,0,r.width,r.height]),{attributes:o,framebuffer:r,uniforms:a,discard:c,parameters:l}}swap(){return!!this._swapTexture&&(this.currentIndex=this._getNextIndex(),!0)}update(e={}){this._setupTextures(e)}getTargetTexture(){const{targetTexture:e}=this.bindings[this.currentIndex];return e}getData({packed:e=!1}={}){const{framebuffer:t}=this.bindings[this.currentIndex],i=rS(t);if(!e)return i;const r=i.constructor,s=function(n){switch(n){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return Fa(!1),null}}(this.targetTextureType),o=new r(i.length*s/4);let a=0;for(let l=0;l<i.length;l+=4)for(let c=0;c<s;c++)o[a++]=i[l+c];return o}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(e={}){const{_targetTextureVarying:t,_swapTexture:i}=e;this._swapTexture=i,this.targetTextureVarying=t,this.hasTargetTexture=t,this._setupTextures(e)}_createTargetTexture(e){const{sourceTextures:t,textureOrReference:i}=e;if(i instanceof da)return i;const r=t[i];return r?(this._targetRefTexName=i,this._createNewTexture(r)):null}_setupTextures(e={}){const{sourceBuffers:t,_sourceTextures:i={},_targetTexture:r}=e,s=this._createTargetTexture({sourceTextures:i,textureOrReference:r});this.hasSourceTextures=this.hasSourceTextures||i&&Object.keys(i).length>0,this._updateBindings({sourceBuffers:t,sourceTextures:i,targetTexture:s}),"elementCount"in e&&this._updateElementIDBuffer(e.elementCount)}_updateElementIDBuffer(e){if("number"!=typeof e||this.elementCount>=e)return;const t=new Float32Array(e);t.forEach((i,r,s)=>{s[r]=r}),this.elementIDBuffer?this.elementIDBuffer.setData({data:t}):this.elementIDBuffer=new sr(this.gl,{data:t,accessor:{size:1}}),this.elementCount=e}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this._swapTexture){const{sourceTextures:t,targetTexture:i}=this._swapTextures(this.bindings[this.currentIndex]),r=this._getNextIndex();this.bindings[r]=this._updateBinding(this.bindings[r],{sourceTextures:t,targetTexture:i})}}_updateBinding(e,t){const{sourceBuffers:i,sourceTextures:r,targetTexture:s}=t;if(e||(e={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(e.sourceTextures,r),Object.assign(e.sourceBuffers,i),s){e.targetTexture=s;const{width:o,height:a}=s,{framebuffer:l}=e;l?(l.update({attachments:{36064:s},resizeAttachments:!1}),l.resize({width:o,height:a})):e.framebuffer=new Rs(this.gl,{id:"transform-framebuffer",width:o,height:a,attachments:{36064:s}})}return e}_setSourceTextureParameters(){const e=this.currentIndex,{sourceTextures:t}=this.bindings[e];for(const i in t)t[i].setParameters(wse)}_swapTextures(e){if(!this._swapTexture)return null;const t=Object.assign({},e.sourceTextures);return t[this._swapTexture]=e.targetTexture,{sourceTextures:t,targetTexture:e.sourceTextures[this._swapTexture]}}_createNewTexture(e){const t=WV(e,{parameters:{10241:9728,10240:9728,10242:33071,10243:33071},pixelStore:{37440:!1}});return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=t,t}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(e={}){const{sourceTextures:t,targetTexture:i}=this.bindings[this.currentIndex],{vs:r,uniforms:s,targetTextureType:o,inject:a,samplerTextureMap:l}=function({vs:n,sourceTextureMap:e,targetTextureVarying:t,targetTexture:i}){let s=Object.keys(e).length,o=null;const a={};let l=n,c={};if(s>0||t){const u=l.split("\n"),h=u.slice();if(u.forEach((f,g,m)=>{if(s>0){const w=function(n,e){const t={},i=function(n){return wj(n,["attribute","in"])}(n);if(!i)return null;const{type:r,name:s}=i;if(s&&e[s]){const o=`// ${n} => Replaced by Transform with a sampler`,{samplerName:a,sizeName:l,uniformDeclerations:c}=function(n){const e=`transform_uSampler_${n}`,t=`${hS}${n}`;return{samplerName:e,sizeName:t,uniformDeclerations:`  uniform sampler2D ${e};\n  uniform vec2 ${t};`}}(s),h=`  ${r} ${s} = transform_getInput(${a}, ${l}).${function(n){switch(n){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return Fa(!1),null}}(r)};\n`;return t[a]=s,{updatedLine:o,inject:{"vs:#decl":c,"vs:#main-start":h},samplerTextureMap:t}}return null}(f,e);if(w){const{updatedLine:S,inject:U}=w;h[g]=S,c=vI([c,U]),Object.assign(a,w.samplerTextureMap),s--}}t&&!o&&(o=function(n,e){const t=wj(n,["varying","out"]);return t&&t.name===e?t.type:null}(f,t))}),t){nn(i);const f=`${hS}${t}`;c=vI([c,{"vs:#decl":`uniform vec2 ${f};\n`,"vs:#main-start":`     vec2 ${Mj} = transform_getPos(${f});\n     gl_Position = vec4(${Mj}, 0, 1.);\n`}])}l=h.join("\n")}return{vs:l,targetTextureType:o,inject:c,samplerTextureMap:a}}({vs:e.vs,sourceTextureMap:t,targetTextureVarying:this.targetTextureVarying,targetTexture:i}),c=vI([e.inject||{},a]);return this.targetTextureType=o,this.samplerTextureMap=l,{vs:r,fs:e._fs||Ej({version:xj(r),input:this.targetTextureVarying,inputType:o,output:"transform_output"}),modules:this.hasSourceTextures||this.targetTextureVarying?[fse].concat(e.modules||[]):e.modules,uniforms:s,inject:c}}}const bI={number:{validate:(n,e)=>Number.isFinite(n)&&(!("max"in e)||n<=e.max)&&(!("min"in e)||n>=e.min)},array:{validate:(n,e)=>Array.isArray(n)||ArrayBuffer.isView(n)}};function Cse(n){let e=Dj(n);return"object"===e?n?"type"in n?Object.assign({},n,bI[n.type]):"value"in n?(e=Dj(n.value),Object.assign({type:e},n,bI[e])):{type:"object",value:n}:{type:"object",value:null}:Object.assign({type:e,value:n},bI[e])}function Dj(n){return Array.isArray(n)||ArrayBuffer.isView(n)?"array":typeof n}class wI{constructor({name:e,vs:t,fs:i,dependencies:r=[],uniforms:s,getUniforms:o,deprecations:a=[],defines:l={},inject:c={},vertexShader:u,fragmentShader:h}){Fa("string"==typeof e),this.name=e,this.vs=t||u,this.fs=i||h,this.getModuleUniforms=o,this.dependencies=r,this.deprecations=this._parseDeprecationDefinitions(a),this.defines=l,this.injections=function(n){const e={vs:{},fs:{}};for(const t in n){let i=n[t];const r=t.slice(0,2);"string"==typeof i&&(i={order:0,injection:i}),e[r][t]=i}return e}(c),s&&(this.uniforms=function(n){const e={};for(const t in n){const r=Cse(n[t]);e[t]=r}return e}(s))}getModuleSource(e){let t;switch(e){case"vs":t=this.vs||"";break;case"fs":t=this.fs||"";break;default:Fa(!1)}return`#define MODULE_${this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_")}\n${t}// END MODULE_${this.name}\n\n`}getUniforms(e,t){return this.getModuleUniforms?this.getModuleUniforms(e,t):this.uniforms?this._defaultGetUniforms(e):{}}getDefines(){return this.defines}checkDeprecations(e,t){this.deprecations.forEach(i=>{i.regex.test(e)&&(i.deprecated?t.deprecated(i.old,i.new)():t.removed(i.old,i.new)())})}_parseDeprecationDefinitions(e){return e.forEach(t=>{switch(t.type){case"function":t.regex=new RegExp(`\\b${t.old}\\(`);break;default:t.regex=new RegExp(`${t.type} ${t.old};`)}}),e}_defaultGetUniforms(e={}){const t={},i=this.uniforms;for(const r in i){const s=i[r];r in e&&!s.private?(s.validate&&Fa(s.validate(e[r],s),`${this.name}: invalid ${r}`),t[r]=e[r]):t[r]=s.value}return t}}function Dse(n){return function(n){const e={},t={};return EI({modules:n,level:0,moduleMap:e,moduleDepth:t}),Object.keys(t).sort((i,r)=>t[r]-t[i]).map(i=>e[i])}(Oj(n))}function EI({modules:n,level:e,moduleMap:t,moduleDepth:i}){if(e>=5)throw new Error("Possible loop in shader dependency graph");for(const r of n)t[r.name]=r,(void 0===i[r.name]||i[r.name]<e)&&(i[r.name]=e);for(const r of n)r.dependencies&&EI({modules:r.dependencies,level:e+1,moduleMap:t,moduleDepth:i})}function Oj(n,e){return n.map(t=>(t instanceof wI||(Fa("string"!=typeof t,`Shader module use by name is deprecated. Import shader module '${t}' and use it directly.`),Fa(t.name,"shader module has no name"),(t=new wI(t)).dependencies=Oj(t.dependencies)),t))}const SI={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},Df={};function kse(n,e){return n.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":n.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":n.match(/AMD/i)||e.match(/AMD/i)||n.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN GPU"}Object.keys(SI).forEach(n=>{Df[n]=n});const xI={};function Rj(n,e,t={}){const i=SI[e];if(Fa(i,e),!function(n={}){const e="undefined"!=typeof window&&window.navigator||{},t=n.userAgent||e.userAgent||"",i=-1!==t.indexOf("MSIE "),r=-1!==t.indexOf("Trident/");return i||r}(t))return!0;if(e in xI)return xI[e];const o=`#extension GL_${i[0]} : ${t.behavior||"enable"}\nvoid main(void) {}`,a=n.createShader(35633);n.shaderSource(a,o),n.compileShader(a);const l=n.getShaderParameter(a,35713);return n.deleteShader(a),xI[e]=l,l}function fS(n,e){return(e=Array.isArray(e)?e:[e]).every(t=>function(n,e){const t=SI[e];Fa(t,e);const i=function(n){return"undefined"!=typeof WebGL2RenderingContext&&n instanceof WebGL2RenderingContext||Boolean(n&&2===n._version)}(n)&&t[1]||t[0],r="string"==typeof i?Boolean(n.getExtension(i)):i;return Fa(!1===r||!0===r),r}(n,t))}function Vg(n){return new RegExp(`\\b${n}[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)`,"g")}const Nj=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,"#version 300 es\n"],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],Use=[...Nj,[Vg("attribute"),"in $1"],[Vg("varying"),"out $1"]],zse=[...Nj,[Vg("varying"),"in $1"]],Pj=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],Hse=[...Pj,[Vg("in"),"attribute $1"],[Vg("out"),"varying $1"]],Gse=[...Pj,[Vg("in"),"varying $1"]],CI="gl_FragColor",TI=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,$se=/void\s+main\s*\([^)]*\)\s*\{\n?/;function pS(n,e){for(const[t,i]of e)n=n.replace(t,i);return n}const Kse=`\n\n${dS}\n\n`,Fj={[x0]:"vertex",fs:"fragment"};function Lj(n,{id:e,source:t,type:i,modules:r,defines:s={},hookFunctions:o=[],inject:a={},transpileToGLSL100:l=!1,prologue:c=!0,log:u}){Fa("string"==typeof t,"shader source must be a string");const h=i===x0,f=t.split("\n");let g=100,m="",w=t;0===f[0].indexOf("#version ")?(g=300,m=f[0],w=f.slice(1).join("\n")):m=`#version ${g}`;const S={};r.forEach(Pe=>{Object.assign(S,Pe.getDefines())}),Object.assign(S,s);let U=c?`${m}\n${function({id:n,source:e,type:t}){return n&&"string"==typeof n&&-1===e.indexOf("SHADER_NAME")?`\n#define SHADER_NAME ${n}_${Fj[t]}\n\n`:""}({id:e,source:t,type:i})}\n${function({type:n}){return`\n#define SHADER_TYPE_${Fj[n].toUpperCase()}\n`}({type:i})}\n${function(n){switch(function(n){const e=n.getExtension("WEBGL_debug_renderer_info"),t=n.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||7936),i=n.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||7937);return{gpuVendor:kse(t,i),vendor:t,renderer:i,version:n.getParameter(7938),shadingLanguageVersion:n.getParameter(35724)}}(n).gpuVendor.toLowerCase()){case"nvidia":return"#define NVIDIA_GPU\n// Nvidia optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n";case"intel":return"#define INTEL_GPU\n// Intel optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n";case"amd":return"#define AMD_GPU\n";default:return"#define DEFAULT_GPU\n// Prevent driver from optimizing away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n"}}(n)}\n${function(n,e,t){let i="#if (__VERSION__ > 120)\n\n# define FEATURE_GLSL_DERIVATIVES\n# define FEATURE_GLSL_DRAW_BUFFERS\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FEATURE_GLSL_TEXTURE_LOD\n\n// DEPRECATED FLAGS, remove in v9\n# define FRAG_DEPTH\n# define DERIVATIVES\n# define DRAW_BUFFERS\n# define TEXTURE_LOD\n\n#endif // __VERSION\n";return fS(n,Df.GLSL_FRAG_DEPTH)&&(i+="\n// FRAG_DEPTH => gl_FragDepth is available\n#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FRAG_DEPTH\n# define gl_FragDepth gl_FragDepthEXT\n#endif\n"),fS(n,Df.GLSL_DERIVATIVES)&&Rj(n,Df.GLSL_DERIVATIVES)&&(i+="\n// DERIVATIVES => dxdF, dxdY and fwidth are available\n#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n# define FEATURE_GLSL_DERIVATIVES\n# define DERIVATIVES\n#endif\n"),fS(n,Df.GLSL_FRAG_DATA)&&Rj(n,Df.GLSL_FRAG_DATA,{behavior:"require"})&&(i+="\n// DRAW_BUFFERS => gl_FragData[] is available\n#ifdef GL_EXT_draw_buffers\n#extension GL_EXT_draw_buffers : require\n#define FEATURE_GLSL_DRAW_BUFFERS\n#define DRAW_BUFFERS\n#endif\n"),fS(n,Df.GLSL_TEXTURE_LOD)&&(i+="// TEXTURE_LOD => texture2DLod etc are available\n#ifdef GL_EXT_shader_texture_lod\n#extension GL_EXT_shader_texture_lod : enable\n\n# define FEATURE_GLSL_TEXTURE_LOD\n# define TEXTURE_LOD\n\n#endif\n"),i}(n)}\n${function(n={}){let e=0,t="";for(const i in n){0===e&&(t+="\n// APPLICATION DEFINES\n"),e++;const r=n[i];(r||Number.isFinite(r))&&(t+=`#define ${i.toUpperCase()} ${n[i]}\n`)}return 0===e&&(t+="\n"),t}(S)}\n${h?"":"precision highp float;\n\n"}\n`:`${m}\n`;const D=function(n){const e={vs:{},fs:{}};return n.forEach(t=>{let i;"string"!=typeof t?(i=t,t=i.hook):i={},t=t.trim();const[r,s]=t.split(":"),o=t.replace(/\(.+/,"");e[r][o]=Object.assign(i,{signature:s})}),e}(o),ie={},_e={},Ne={};for(const Pe in a){const Ve="string"==typeof a[Pe]?{injection:a[Pe],order:0}:a[Pe],vt=Pe.match(/^(v|f)s:(#)?([\w-]+)$/);if(vt){const xt=vt[3];vt[2]?"decl"===xt?_e[Pe]=[Ve]:Ne[Pe]=[Ve]:ie[Pe]=[Ve]}else Ne[Pe]=[Ve]}for(const Pe of r){u&&Pe.checkDeprecations(w,u),U+=Pe.getModuleSource(i,g);const vt=Pe.injections[i];for(const wt in vt){const xt=wt.match(/^(v|f)s:#([\w-]+)$/);if(xt){const $t="decl"===xt[2]?_e:Ne;$t[wt]=$t[wt]||[],$t[wt].push(vt[wt])}else ie[wt]=ie[wt]||[],ie[wt].push(vt[wt])}}return U+=Kse,U=Aj(U,i,_e),U+=function(n,e){let t="";for(const i in n){const r=n[i];if(t+=`void ${r.signature} {\n`,r.header&&(t+=`  ${r.header}`),e[i]){const s=e[i];s.sort((o,a)=>o.order-a.order);for(const o of s)t+=`  ${o.injection}\n`}r.footer&&(t+=`  ${r.footer}`),t+="}\n"}return t}(D[i],ie),U+=w,U=Aj(U,i,Ne),U=function(n,e,t){switch(e){case 300:return t?pS(n,Use):function(n){const e=(n=pS(n,zse)).match(TI);if(e){const t=e[1];n=n.replace(new RegExp(`\\b${CI}\\b`,"g"),t)}else{const t="fragmentColor";n=n.replace($se,i=>`out vec4 ${t};\n${i}`).replace(new RegExp(`\\b${CI}\\b`,"g"),t)}return n}(n);case 100:return t?pS(n,Hse):function(n){const e=(n=pS(n,Gse)).match(TI);if(e){const t=e[1];n=n.replace(TI,"").replace(new RegExp(`\\b${t}\\b`,"g"),CI)}return n}(n);default:throw new Error(`unknown GLSL version ${e}`)}}(U,l?100:g,h),U}function Zse(n){return function(t){const i={};for(const r of n){const s=r.getUniforms(t,i);Object.assign(i,s)}return i}}const roe={5126:xr.bind(null,"uniform1fv",La,1,Co),35664:xr.bind(null,"uniform2fv",La,2,Co),35665:xr.bind(null,"uniform3fv",La,3,Co),35666:xr.bind(null,"uniform4fv",La,4,Co),5124:xr.bind(null,"uniform1iv",oh,1,Co),35667:xr.bind(null,"uniform2iv",oh,2,Co),35668:xr.bind(null,"uniform3iv",oh,3,Co),35669:xr.bind(null,"uniform4iv",oh,4,Co),35670:xr.bind(null,"uniform1iv",oh,1,Co),35671:xr.bind(null,"uniform2iv",oh,2,Co),35672:xr.bind(null,"uniform3iv",oh,3,Co),35673:xr.bind(null,"uniform4iv",oh,4,Co),35674:xr.bind(null,"uniformMatrix2fv",La,4,$u),35675:xr.bind(null,"uniformMatrix3fv",La,9,$u),35676:xr.bind(null,"uniformMatrix4fv",La,16,$u),35678:no,35680:no,5125:xr.bind(null,"uniform1uiv",gS,1,Co),36294:xr.bind(null,"uniform2uiv",gS,2,Co),36295:xr.bind(null,"uniform3uiv",gS,3,Co),36296:xr.bind(null,"uniform4uiv",gS,4,Co),35685:xr.bind(null,"uniformMatrix2x3fv",La,6,$u),35686:xr.bind(null,"uniformMatrix2x4fv",La,8,$u),35687:xr.bind(null,"uniformMatrix3x2fv",La,6,$u),35688:xr.bind(null,"uniformMatrix3x4fv",La,12,$u),35689:xr.bind(null,"uniformMatrix4x2fv",La,8,$u),35690:xr.bind(null,"uniformMatrix4x3fv",La,12,$u),35678:no,35680:no,35679:no,35682:no,36289:no,36292:no,36293:no,36298:no,36299:no,36300:no,36303:no,36306:no,36307:no,36308:no,36311:no},soe={},ooe={},aoe={},kj=[0];function AI(n,e,t,i){1===e&&"boolean"==typeof n&&(n=n?1:0),Number.isFinite(n)&&(kj[0]=n,n=kj);const r=n.length;if(r%e&&hn.warn(`Uniform size should be multiples of ${e}`,n)(),n instanceof t)return n;let s=i[r];s||(s=new t(r),i[r]=s);for(let o=0;o<r;o++)s[o]=n[o];return s}function La(n,e){return AI(n,e,Float32Array,soe)}function oh(n,e){return AI(n,e,Int32Array,ooe)}function gS(n,e){return AI(n,e,Uint32Array,aoe)}function Bj(n,e,t){const i=roe[t.type];if(!i)throw new Error(`Unknown GLSL uniform type ${t.type}`);return i().bind(null,n,e)}function loe(n){if("]"!==n[n.length-1])return{name:n,length:1,isArray:!1};const t=n.match(/([^[]*)(\[[0-9]+\])?/);if(!t||t.length<2)throw new Error(`Failed to parse GLSL uniform name ${n}`);return{name:t[1],length:t[2]||1,isArray:Boolean(t[2])}}function uoe(n){return Array.isArray(n)||ArrayBuffer.isView(n)?function(n){if(0===n.length)return!1;const e=Math.min(n.length,16);for(let t=0;t<e;++t)if(!Number.isFinite(n[t]))return!1;return!0}(n):!!(isFinite(n)||!0===n||!1===n||n instanceof Af||n instanceof Lg)||n instanceof Rs&&Boolean(n.texture)}function doe(n,e,t){if(Array.isArray(t)||ArrayBuffer.isView(t))if(n[e]){const i=n[e];for(let r=0,s=t.length;r<s;++r)i[r]=t[r]}else n[e]=t.slice();else n[e]=t}function no(){let n=null;return(e,t,i)=>{const r=n!==i;return r&&(e.uniform1i(t,i),n=i),r}}function xr(n,e,t,i){let r=null,s=null;return(o,a,l)=>{const c=e(l,t),u=c.length;let h=!1;if(null===r)r=new Float32Array(u),s=u,h=!0;else{nn(s===u,"Uniform length cannot change.");for(let f=0;f<u;++f)if(c[f]!==r[f]){h=!0;break}}return h&&(i(o,n,a,c),r.set(c)),h}}function Co(n,e,t,i){n[e](t,i)}function $u(n,e,t,i){n[e](t,!1,i)}function mS(n,e="unnamed"){const i=n.match(/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/);return i?i[1]:e}function jj(n,e){let t="";for(let i=0;i<e.length;i++){const r=e[i];if((n[i+3]||n[i+2]||n[i+1])&&(t+=`${r}\n`,n[i+1])){const s=n[i+1],o=s.split(":",3),a=o[0],l=parseInt(o[1],10)||0;t+=Uj(`^^^ ${a}: ${s.substring(o.join(":").length+1).trim()}\n\n`,l)}}return t}function Uj(n,e){let t="";for(let i=0;i<e;++i)t+=" ";return`${t}${n}`}class C0 extends zu{get[Symbol.toStringTag](){return"Shader"}static getTypeName(e){switch(e){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return nn(!1),"unknown"}}constructor(e,t){nS(e),nn("string"==typeof t.source,"Shader: GLSL source code must be a JavaScript string"),super(e,{id:mS(t.source,null)||t.id||ca(`unnamed ${C0.getTypeName(t.shaderType)}`)}),this.shaderType=t.shaderType,this.source=t.source,this.initialize(t)}initialize({source:e}){const t=mS(e,null);t&&(this.id=ca(t)),this._compile(e)}getParameter(e){return this.gl.getShaderParameter(this.handle,e)}toString(){return`${C0.getTypeName(this.shaderType)}:${this.id}`}getName(){return mS(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const e=this.gl.getExtension("WEBGL_debug_shaders");return e?e.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(e=this.source){if(e.startsWith("#version ")||(e=`#version 100\n${e}`),this.source=e,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){const i=this.gl.getShaderInfoLog(this.handle),{shaderName:r,errors:s,warnings:o}=function(n,e,t,i){const r=n.split(/\r?\n/),s={},o={},a=i||mS(e)||"(unnamed)",l=`${function(n){switch(n){case 35632:return"fragment";case 35633:return"vertex";default:return"unknown type"}}(t)} shader ${a}`;for(let u=0;u<r.length;u++){const h=r[u];if(h.length<=1)continue;const f=h.split(":"),g=f[0],m=parseInt(f[2],10);if(isNaN(m))throw new Error(`GLSL compilation error in ${l}: ${n}`);"WARNING"!==g?s[m]=h:o[m]=h}const c=function(n,e=1,t=": "){const i=n.split(/\r?\n/),r=String(i.length+e-1).length;return i.map((s,o)=>{const a=String(o+e);return Uj(a,r-a.length)+t+s})}(e);return{shaderName:l,errors:jj(s,c),warnings:jj(o,c)}}(i,this.source,this.shaderType,this.id);throw hn.error(`GLSL compilation errors in ${r}\n${s}`)(),hn.warn(`GLSL compilation warnings in ${r}\n${o}`)(),new Error(`GLSL compilation errors in ${r}`)}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class MI extends C0{get[Symbol.toStringTag](){return"VertexShader"}constructor(e,t){"string"==typeof t&&(t={source:t}),super(e,Object.assign({},t,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class DI extends C0{get[Symbol.toStringTag](){return"FragmentShader"}constructor(e,t){"string"==typeof t&&(t={source:t}),super(e,Object.assign({},t,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}const Ns=5126,T0=5124,A0=5125,II={[Ns]:[Ns,1,"float"],35664:[Ns,2,"vec2"],35665:[Ns,3,"vec3"],35666:[Ns,4,"vec4"],[T0]:[T0,1,"int"],35667:[T0,2,"ivec2"],35668:[T0,3,"ivec3"],35669:[T0,4,"ivec4"],[A0]:[A0,1,"uint"],36294:[A0,2,"uvec2"],36295:[A0,3,"uvec3"],36296:[A0,4,"uvec4"],35670:[Ns,1,"bool"],35671:[Ns,2,"bvec2"],35672:[Ns,3,"bvec3"],35673:[Ns,4,"bvec4"],35674:[Ns,8,"mat2"],35685:[Ns,8,"mat2x3"],35686:[Ns,8,"mat2x4"],35675:[Ns,12,"mat3"],35687:[Ns,12,"mat3x2"],35688:[Ns,12,"mat3x4"],35676:[Ns,16,"mat4"],35689:[Ns,16,"mat4x2"],35690:[Ns,16,"mat4x3"]};function qj(n){const e=II[n];if(!e)return null;const[t,i]=e;return{type:t,components:i}}function Yj(n,e){switch(n){case 5120:case 5121:case 5122:case 5123:n=Ns}for(const t in II){const[i,r,s]=II[t];if(i===n&&r===e)return{glType:t,name:s}}return null}class $oe{constructor(e){this.id=e.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(e),this._readVaryingsFromProgram(e)}getAttributeInfo(e){const t=Number(e);return Number.isFinite(t)?this.attributeInfosByLocation[t]:this.attributeInfosByName[e]||null}getAttributeLocation(e){const t=this.getAttributeInfo(e);return t?t.location:-1}getAttributeAccessor(e){const t=this.getAttributeInfo(e);return t?t.accessor:null}getVaryingInfo(e){const t=Number(e);return Number.isFinite(t)?this.varyingInfos[t]:this.varyingInfosByName[e]||null}getVaryingIndex(e){const t=this.getVaryingInfo();return t?t.location:-1}getVaryingAccessor(e){const t=this.getVaryingInfo();return t?t.accessor:null}_readAttributesFromProgram(e){const{gl:t}=e,i=t.getProgramParameter(e.handle,35721);for(let r=0;r<i;r++){const{name:s,type:o,size:a}=t.getActiveAttrib(e.handle,r),l=t.getAttribLocation(e.handle,s);l>=0&&this._addAttribute(l,s,o,a)}this.attributeInfos.sort((r,s)=>r.location-s.location)}_readVaryingsFromProgram(e){const{gl:t}=e;if(!_i(t))return;const i=t.getProgramParameter(e.handle,35971);for(let r=0;r<i;r++){const{name:s,type:o,size:a}=t.getTransformFeedbackVarying(e.handle,r);this._addVarying(r,s,o,a)}this.varyingInfos.sort((r,s)=>r.location-s.location)}_addAttribute(e,t,i,r){const{type:s,components:o}=qj(i),a={type:s,size:r*o};this._inferProperties(e,t,a);const l={location:e,name:t,accessor:new ua(a)};this.attributeInfos.push(l),this.attributeInfosByLocation[e]=l,this.attributeInfosByName[l.name]=l}_inferProperties(e,t,i){/instance/i.test(t)&&(i.divisor=1)}_addVarying(e,t,i,r){const{type:s,components:o}=qj(i),l={location:e,name:t,accessor:new ua({type:s,size:r*o})};this.varyingInfos.push(l),this.varyingInfosByName[l.name]=l}}const Woe=35981,qoe=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class Xj extends zu{get[Symbol.toStringTag](){return"Program"}constructor(e,t={}){super(e,t),this.stubRemovedMethods("Program","v6.0",qoe),this._isCached=!1,this.initialize(t),Object.seal(this),this._setId(t.id)}initialize(e={}){const{hash:t,vs:i,fs:r,varyings:s,bufferMode:o=Woe}=e;return this.hash=t||"",this.vs="string"==typeof i?new MI(this.gl,{id:`${e.id}-vs`,source:i}):i,this.fs="string"==typeof r?new DI(this.gl,{id:`${e.id}-fs`,source:r}):r,nn(this.vs instanceof MI),nn(this.fs instanceof DI),this.uniforms={},this._textureUniforms={},s&&s.length>0&&(Eo(this.gl),this.varyings=s,this.gl2.transformFeedbackVaryings(this.handle,s,o)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new $oe(this),this.setProps(e)}delete(e={}){return this._isCached?this:super.delete(e)}setProps(e){return"uniforms"in e&&this.setUniforms(e.uniforms),this}draw({logPriority:e,drawMode:t=4,vertexCount:i,offset:r=0,start:s,end:o,isIndexed:a=!1,indexType:l=5123,instanceCount:c=0,isInstanced:u=c>0,vertexArray:h=null,transformFeedback:f,framebuffer:g,parameters:m={},uniforms:w,samplers:S}){if((w||S)&&(hn.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(w||{})),hn.priority>=e){const U=g?g.id:"default",D=`mode=${rh(this.gl,t)} verts=${i} instances=${c} indexType=${rh(this.gl,l)} isInstanced=${u} isIndexed=${a} Framebuffer=${U}`;hn.log(e,D)()}return nn(h),this.gl.useProgram(this.handle),!(!this._areTexturesRenderable()||0===i||u&&0===c||(h.bindForDraw(i,c,()=>{if(void 0!==g&&(m=Object.assign({},m,{framebuffer:g})),f){const U=function(n){switch(n){case 0:return 0;case 1:case 3:case 2:return 1;case 4:case 5:case 6:return 4;default:return nn(!1),0}}(t);f.begin(U)}this._bindTextures(),sc(this.gl,m,()=>{a&&u?this.gl2.drawElementsInstanced(t,i,l,r,c):a&&_i(this.gl)&&!isNaN(s)&&!isNaN(o)?this.gl2.drawRangeElements(t,s,o,i,l,r):a?this.gl.drawElements(t,i,l,r):u?this.gl2.drawArraysInstanced(t,r,i,c):this.gl.drawArrays(t,r,i)}),f&&f.end()}),0))}setUniforms(e={}){hn.priority>=2&&function(n,e,t){for(const i in n){const r=n[i];if((!t||Boolean(t[i]))&&!uoe(r))throw e=e?`${e} `:"",console.error(`${e} Bad uniform ${i}`,r),new Error(`${e} Bad uniform ${i}`)}}(e,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const t in e){const i=e[t],r=this._uniformSetters[t];if(r){let s=i,o=!1;if(s instanceof Rs&&(s=s.texture),s instanceof Af)if(o=this.uniforms[t]!==i,o){void 0===r.textureIndex&&(r.textureIndex=this._textureIndexCounter++);const a=s,{textureIndex:l}=r;a.bind(l),s=l,this._textureUniforms[t]=a}else s=r.textureIndex;else this._textureUniforms[t]&&delete this._textureUniforms[t];(r(s)||o)&&doe(this.uniforms,t,i)}}return this}_areTexturesRenderable(){let e=!0;for(const t in this._textureUniforms){const i=this._textureUniforms[t];i.update(),e=e&&i.loaded}return e}_bindTextures(){for(const e in this._textureUniforms)this._textureUniforms[e].bind(this._uniformSetters[e].textureIndex)}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(e){const t=this.gl.getAttachedShaders(e),i={};for(const r of t)switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:i.vs=new MI({handle:r});break;case 35632:i.fs=new DI({handle:r})}return i}_getParameter(e){return this.gl.getProgramParameter(this.handle,e)}_setId(e){if(!e){const t=this._getName();this.id=ca(t)}}_getName(){let e=this.vs.getName()||this.fs.getName();return e=e.replace(/shader/i,""),e=e?`${e}-program`:"program",e}_compileAndLink(){const{gl:e}=this;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),hn.time(4,`linkProgram for ${this._getName()}`)(),e.linkProgram(this.handle),hn.timeEnd(4,`linkProgram for ${this._getName()}`)(),e.debug||hn.level>0){if(!e.getProgramParameter(this.handle,35714))throw new Error(`Error linking: ${e.getProgramInfoLog(this.handle)}`);if(e.validateProgram(this.handle),!e.getProgramParameter(this.handle,35715))throw new Error(`Error validating: ${e.getProgramInfoLog(this.handle)}`)}}_readUniformLocationsFromLinkedProgram(){const{gl:e}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let t=0;t<this._uniformCount;t++){const i=this.gl.getActiveUniform(this.handle,t),{name:r}=loe(i.name);let s=e.getUniformLocation(this.handle,r);if(this._uniformSetters[r]=Bj(e,s,i),i.size>1)for(let o=0;o<i.size;o++)s=e.getUniformLocation(this.handle,`${r}[${o}]`),this._uniformSetters[`${r}[${o}]`]=Bj(e,s,i)}this._textureIndexCounter=0}getActiveUniforms(e,t){return this.gl2.getActiveUniforms(this.handle,e,t)}getUniformBlockIndex(e){return this.gl2.getUniformBlockIndex(this.handle,e)}getActiveUniformBlockParameter(e,t){return this.gl2.getActiveUniformBlockParameter(this.handle,e,t)}uniformBlockBinding(e,t){this.gl2.uniformBlockBinding(this.handle,e,t)}}class M0{static getDefaultProgramManager(e){return e.luma=e.luma||{},e.luma.defaultProgramManager=e.luma.defaultProgramManager||new M0(e),e.luma.defaultProgramManager}constructor(e){this.gl=e,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(e){this._defaultModules.find(t=>t.name===e.name)||this._defaultModules.push(e),this.stateHash++}removeDefaultModule(e){const t="string"==typeof e?e:e.name;this._defaultModules=this._defaultModules.filter(i=>i.name!==t),this.stateHash++}addShaderHook(e,t){t&&(e=Object.assign(t,{hook:e})),this._hookFunctions.push(e),this.stateHash++}get(e={}){const{vs:t="",fs:i="",defines:r={},inject:s={},varyings:o=[],bufferMode:a=35981,transpileToGLSL100:l=!1}=e,c=this._getModuleList(e.modules),u=this._getHash(t),h=this._getHash(i),f=c.map(ie=>this._getHash(ie.name)).sort(),g=o.map(ie=>this._getHash(ie)),m=Object.keys(r).sort(),w=Object.keys(s).sort(),S=[],U=[];for(const ie of m)S.push(this._getHash(ie)),S.push(this._getHash(r[ie]));for(const ie of w)U.push(this._getHash(ie)),U.push(this._getHash(s[ie]));const D=`${u}/${h}D${S.join("/")}M${f.join("/")}I${U.join("/")}V${g.join("/")}H${this.stateHash}B${a}${l?"T":""}`;if(!this._programCache[D]){const ie=function(n,e){const{vs:t,fs:i}=e,r=Dse(e.modules||[]);return{gl:n,vs:Lj(n,Object.assign({},e,{source:t,type:x0,modules:r})),fs:Lj(n,Object.assign({},e,{source:i,type:"fs",modules:r})),getUniforms:Zse(r)}}(this.gl,{vs:t,fs:i,modules:c,inject:s,defines:r,hookFunctions:this._hookFunctions,transpileToGLSL100:l});this._programCache[D]=new Xj(this.gl,{hash:D,vs:ie.vs,fs:ie.fs,varyings:o,bufferMode:a}),this._getUniforms[D]=ie.getUniforms||(_e=>{}),this._useCounts[D]=0}return this._useCounts[D]++,this._programCache[D]}getUniforms(e){return this._getUniforms[e.hash]||null}release(e){const t=e.hash;this._useCounts[t]--,0===this._useCounts[t]&&(this._programCache[t].delete(),delete this._programCache[t],delete this._getUniforms[t],delete this._useCounts[t])}_getHash(e){return void 0===this._hashes[e]&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}_getModuleList(e=[]){const t=new Array(this._defaultModules.length+e.length),i={};let r=0;for(let s=0,o=this._defaultModules.length;s<o;++s){const a=this._defaultModules[s],l=a.name;t[r++]=a,i[l]=!0}for(let s=0,o=e.length;s<o;++s){const a=e[s],l=a.name;i[l]||(t[r++]=a,i[l]=!0)}return t.length=r,t}}let yS=null;class ka extends zu{get[Symbol.toStringTag](){return"VertexArrayObject"}static isSupported(e,t={}){return!t.constantAttributeZero||_i(e)||"Chrome"===function(n){if(!HD())return"Node";if(rV(n))return"Electron";const t=("undefined"!=typeof navigator?navigator:{}).userAgent||"";if(t.indexOf("Edge")>-1)return"Edge";const i=-1!==t.indexOf("MSIE "),r=-1!==t.indexOf("Trident/");return i||r?"IE":d0.chrome?"Chrome":d0.safari?"Safari":d0.mozInnerScreenX?"Firefox":"Unknown"}()}static getDefaultArray(e){return e.luma=e.luma||{},e.luma.defaultVertexArray||(e.luma.defaultVertexArray=new ka(e,{handle:null,isDefaultArray:!0})),e.luma.defaultVertexArray}static getMaxAttributes(e){return ka.MAX_ATTRIBUTES=ka.MAX_ATTRIBUTES||e.getParameter(34921),ka.MAX_ATTRIBUTES}static setConstant(e,t,i){switch(i.constructor){case Float32Array:ka._setConstantFloatArray(e,t,i);break;case Int32Array:ka._setConstantIntArray(e,t,i);break;case Uint32Array:ka._setConstantUintArray(e,t,i);break;default:nn(!1)}}constructor(e,t={}){super(e,Object.assign({},t,{id:t.id||t.program&&t.program.id})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=t.isDefaultArray||!1,this.gl2=e,this.initialize(t),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return ka.getMaxAttributes(this.gl)}initialize(e={}){return this.setProps(e)}setProps(e){return this}setElementBuffer(e=null,t={}){return nn(!e||34963===e.target,"elements must be GL.ELEMENT_ARRAY_BUFFER"),this.bind(()=>{this.gl.bindBuffer(34963,e?e.handle:null)}),this}setBuffer(e,t,i){if(34963===t.target)return this.setElementBuffer(t,i);const{size:r,type:s,stride:o,offset:a,normalized:l,integer:c,divisor:u}=i,{gl:h,gl2:f}=this;return e=Number(e),this.bind(()=>{h.bindBuffer(34962,t.handle),c?(nn(_i(h)),f.vertexAttribIPointer(e,r,s,o,a)):h.vertexAttribPointer(e,r,s,l,o,a),h.enableVertexAttribArray(e),f.vertexAttribDivisor(e,u||0)}),this}enable(e,t=!0){return!t&&0===e&&!ka.isSupported(this.gl,{constantAttributeZero:!0})||(e=Number(e),this.bind(()=>t?this.gl.enableVertexAttribArray(e):this.gl.disableVertexAttribArray(e))),this}getConstantBuffer(e,t){const i=this._normalizeConstantArrayValue(t),r=i.byteLength*e,s=i.length*e;let o=!this.buffer;if(this.buffer=this.buffer||new sr(this.gl,r),o=o||this.buffer.reallocate(r),o=o||!this._compareConstantArrayValues(i,this.bufferValue),o){const a=function(n,e){return new n(function(n){return(!yS||yS.byteLength<n)&&(yS=new ArrayBuffer(n)),yS}(n.BYTES_PER_ELEMENT*e),0,e)}(t.constructor,s);(function({target:n,source:e,start:t=0,count:i=1}){const r=e.length,s=i*r;let o=0;for(let a=t;o<r;o++)n[a++]=e[o];for(;o<s;)o<s-o?(n.copyWithin(t+o,t,t+o),o*=2):(n.copyWithin(t+o,t,t+s-o),o=s)})({target:a,source:i,start:0,count:s}),this.buffer.subData(a),this.bufferValue=t}return this.buffer}_normalizeConstantArrayValue(e){return Array.isArray(e)?new Float32Array(e):e}_compareConstantArrayValues(e,t){if(!e||!t||e.length!==t.length||e.constructor!==t.constructor)return!1;for(let i=0;i<e.length;++i)if(e[i]!==t[i])return!1;return!0}static _setConstantFloatArray(e,t,i){switch(i.length){case 1:e.vertexAttrib1fv(t,i);break;case 2:e.vertexAttrib2fv(t,i);break;case 3:e.vertexAttrib3fv(t,i);break;case 4:e.vertexAttrib4fv(t,i);break;default:nn(!1)}}static _setConstantIntArray(e,t,i){switch(nn(_i(e)),i.length){case 1:e.vertexAttribI1iv(t,i);break;case 2:e.vertexAttribI2iv(t,i);break;case 3:e.vertexAttribI3iv(t,i);break;case 4:e.vertexAttribI4iv(t,i);break;default:nn(!1)}}static _setConstantUintArray(e,t,i){switch(nn(_i(e)),i.length){case 1:e.vertexAttribI1uiv(t,i);break;case 2:e.vertexAttribI2uiv(t,i);break;case 3:e.vertexAttribI3uiv(t,i);break;case 4:e.vertexAttribI4uiv(t,i);break;default:nn(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(e){return this.gl2.deleteVertexArray(e),[this.elements]}_bindHandle(e){this.gl2.bindVertexArray(e)}_getParameter(e,{location:t}){return nn(Number.isFinite(t)),this.bind(()=>{switch(e){case 34373:return this.gl.getVertexAttribOffset(t,e);default:return this.gl.getVertexAttrib(t,e)}})}}const eae=/^(.+)__LOCATION_([0-9]+)$/,tae=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class nae{constructor(e,t={}){this.id=t.id||t.program&&t.program.id,this.gl=e,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new ka(e),NV(this,"VertexArray","v6.0",tae),this.initialize(t),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(e={}){return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(e)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:e}=this.vertexArrayObject;return this.values=new Array(e).fill(null),this.accessors=new Array(e).fill(null),this.unused={},this.drawParams=null,this}setProps(e){return"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"attributes"in e&&this.setAttributes(e.attributes),"elements"in e&&this.setElementBuffer(e.elements),"bindOnUse"in e&&(e=e.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(e){return Object.assign(this.attributes,e),this.vertexArrayObject.bind(()=>{for(const t in e)this._setAttribute(t,e[t]);this.gl.bindBuffer(34962,null)}),this}setElementBuffer(e=null,t={}){return this.elements=e,this.elementsAccessor=t,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(e,t),this}setBuffer(e,t,i={}){if(34963===t.target)return this.setElementBuffer(t,i);const{location:r,accessor:s}=this._resolveLocationAndAccessor(e,t,t.accessor,i);return r>=0&&(this.values[r]=t,this.accessors[r]=s,this.clearDrawParams(),this.vertexArrayObject.setBuffer(r,t,s)),this}setConstant(e,t,i={}){const{location:r,accessor:s}=this._resolveLocationAndAccessor(e,t,Object.assign({size:t.length},i));return r>=0&&(t=this.vertexArrayObject._normalizeConstantArrayValue(t),this.values[r]=t,this.accessors[r]=s,this.clearDrawParams(),this.vertexArrayObject.enable(r,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new sr(this.gl,{accessor:{size:4}});for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this.values[e]instanceof sr&&(this.gl.disableVertexAttribArray(e),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(e,1,5126,!1,0,0))}),this}bindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.setElementBuffer(this.elements);for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++){const t=this.values[e];t instanceof sr&&this.setBuffer(e,t)}}),this}bindForDraw(e,t,i){let r;return this.vertexArrayObject.bind(()=>{this._setConstantAttributes(e,t),r=i()}),r}_resolveLocationAndAccessor(e,t,i,r){const s={location:-1,accessor:null},{location:o,name:a}=this._getAttributeIndex(e);if(!Number.isFinite(o)||o<0)return this.unused[e]=t,hn.once(3,()=>`unused value ${e} in ${this.id}`)(),s;const l=this._getAttributeInfo(a||o);if(!l)return s;const u=ua.resolve(l.accessor,this.accessors[o]||{},i,r),{size:h,type:f}=u;return nn(Number.isFinite(h)&&Number.isFinite(f)),{location:o,accessor:u}}_getAttributeInfo(e){return this.configuration&&this.configuration.getAttributeInfo(e)}_getAttributeIndex(e){const t=Number(e);if(Number.isFinite(t))return{location:t};const i=eae.exec(e),r=i?i[1]:e,s=i?Number(i[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(r)+s,name:r}:{location:-1}}_setAttribute(e,t){if(t instanceof sr)this.setBuffer(e,t);else if(Array.isArray(t)&&t.length&&t[0]instanceof sr)this.setBuffer(e,t[0],t[1]);else if(ArrayBuffer.isView(t)||Array.isArray(t))this.setConstant(e,t);else{if(!(t.buffer instanceof sr))throw new Error("VertexArray: attributes must be Buffers or constants (i.e. typed array)");this.setBuffer(e,t.buffer,t)}}_setConstantAttributes(e,t){const i=Math.max(0|e,0|t);let r=this.values[0];ArrayBuffer.isView(r)&&this._setConstantAttributeZero(r,i);for(let s=1;s<this.vertexArrayObject.MAX_ATTRIBUTES;s++)r=this.values[s],ArrayBuffer.isView(r)&&this._setConstantAttribute(s,r)}_setConstantAttributeZero(e,t){if(ka.isSupported(this.gl,{constantAttributeZero:!0}))return void this._setConstantAttribute(0,e);const i=this.vertexArrayObject.getConstantBuffer(t,e);this.vertexArrayObject.setBuffer(0,i,this.accessors[0])}_setConstantAttribute(e,t){ka.setConstant(this.gl,e,t)}_updateDrawParams(){const e={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let t=0;t<this.vertexArrayObject.MAX_ATTRIBUTES;t++)this._updateDrawParamsForLocation(e,t);return this.elements&&(e.elementCount=this.elements.getElementCount(this.elements.accessor),e.isIndexed=!0,e.indexType=this.elementsAccessor.type||this.elements.accessor.type,e.indexOffset=this.elementsAccessor.offset||0),e.indexCount===1/0&&(e.indexCount=0),e.vertexCount===1/0&&(e.vertexCount=0),e.instanceCount===1/0&&(e.instanceCount=0),e}_updateDrawParamsForLocation(e,t){const i=this.values[t],r=this.accessors[t];if(!i)return;const{divisor:s}=r,o=s>0;if(e.isInstanced=e.isInstanced||o,i instanceof sr){const a=i;if(o){const l=a.getVertexCount(r);e.instanceCount=Math.min(e.instanceCount,l)}else{const l=a.getVertexCount(r);e.vertexCount=Math.min(e.vertexCount,l)}}}setElements(e=null,t={}){return hn.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(e,t)}}function D0(n,e={}){const{isInteger:i=!1}=e;if(Array.isArray(n)||ArrayBuffer.isView(n))return function(n,e){const{maxElts:t=16,size:i=1}=e;let r="[";for(let o=0;o<n.length&&o<t;++o)o>0&&(r+=","+(o%i==0?" ":"")),r+=D0(n[o],e);return`${r}${n.length>t?"...":"]"}`}(n,e);if(!Number.isFinite(n))return String(n);if(Math.abs(n)<1e-16)return i?"0":"0.";if(i||Math.abs(n)>100&&Math.abs(n)<1e4)return n.toFixed(0);const r=n.toPrecision(2);return r.indexOf(".0")===r.length-2?r.slice(0,-1):r}function Qj(n,e,t,i){const{gl:r}=n;if(!e)return{[i]:"null","Format ":"N/A"};let c,u,h,s="NOT PROVIDED",o=1,a=0,l=0;if(t&&(s=t.type,o=t.size,s=String(s).replace("Array",""),c=-1!==s.indexOf("nt")),e instanceof sr){const f=e,{data:g,changed:m}=f.getDebugData();let w;return u=m?"*":"",h=g,l=f.byteLength,a=l/g.BYTES_PER_ELEMENT/o,t?w=`${t.divisor>0?"I ":"P "} ${a} (x${o}=${l} bytes ${rh(r,s)})`:(c=!0,w=`${l} bytes`),{[i]:`${u}${D0(h,{size:o,isInteger:c})}`,"Format ":w}}return h=e,o=e.length,s=String(e.constructor.name).replace("Array",""),c=-1!==s.indexOf("nt"),{[i]:`${D0(h,{size:o,isInteger:c})} (constant)`,"Format ":`${o}x${s} (constant)`}}function sae(n,e){const{type:t,size:i}=e,r=Yj(t,i);return r?`${n} (${r.name})`:n}function Zj({header:n="Uniforms",program:e,uniforms:t,undefinedOnly:i=!1}){nn(e);const s=".*Matrix",a={},l=Object.keys(e._uniformSetters).sort();let c=0;for(const f of l)!f.match(".*_.*")&&!f.match(s)&&OI({table:a,header:n,uniforms:t,uniformName:f,undefinedOnly:i})&&c++;for(const f of l)f.match(s)&&OI({table:a,header:n,uniforms:t,uniformName:f,undefinedOnly:i})&&c++;for(const f of l)a[f]||OI({table:a,header:n,uniforms:t,uniformName:f,undefinedOnly:i})&&c++;let u=0;const h={};if(!i)for(const f in t){const g=t[f];a[f]||(u++,h[f]={Type:`NOT USED: ${g}`,[n]:D0(g)})}return{table:a,count:c,unusedTable:h,unusedCount:u}}function OI({table:n,header:e,uniforms:t,uniformName:i,undefinedOnly:r}){const s=t[i],o=function(n){return null!=n}(s);return!(r&&o||(n[i]={[e]:o?D0(s):"N/A","Uniform Type":o?s:"NOT PROVIDED"},0))}function Jj(n){const{type:e,size:t}=n.accessor,i=Yj(e,t);return i?`${i.name} ${n.name}`:n.name}const lae={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function uae(n,e){const{attributeMap:t=lae}=e||{};return t&&t[n]||n}function dae(n,e){let t;switch(n){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":t="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":t="vectors"}switch(t){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2}nn(Number.isFinite(e.size),`attribute ${n} needs size`)}const eU=()=>{},pae={};class Hg{constructor(e,t={}){const{id:i=ca("model")}=t;nn(tS(e)),this.id=i,this.gl=e,this.id=t.id||ca("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(t)}initialize(e){this.props={},this.programManager=e.programManager||M0.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:t=null,vs:i,fs:r,modules:s,defines:o,inject:a,varyings:l,bufferMode:c,transpileToGLSL100:u}=e;this.programProps={program:t,vs:i,fs:r,modules:s,defines:o,inject:a,varyings:l,bufferMode:c,transpileToGLSL100:u},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(e.moduleSettings))),this.drawMode=void 0!==e.drawMode?e.drawMode:4,this.vertexCount=e.vertexCount||0,this.geometryBuffers={},this.isInstanced=e.isInstanced||e.instanced||e.instanceCount>0,this._setModelProps(e),this.geometry={},nn(void 0!==this.drawMode&&Number.isFinite(this.vertexCount),"Model needs drawMode and vertexCount")}setProps(e){this._setModelProps(e)}delete(){for(const e in this._attributes)this._attributes[e]!==this.attributes[e]&&this._attributes[e].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(e){const{program:t,vs:i,fs:r,modules:s,defines:o,inject:a,varyings:l,bufferMode:c,transpileToGLSL100:u}=e;this.programProps={program:t,vs:i,fs:r,modules:s,defines:o,inject:a,varyings:l,bufferMode:c,transpileToGLSL100:u},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(e){return this.drawMode=e,this}setVertexCount(e){return nn(Number.isFinite(e)),this.vertexCount=e,this}setInstanceCount(e){return nn(Number.isFinite(e)),this.instanceCount=e,this}setGeometry(e){return this.drawMode=e.drawMode,this.vertexCount=e.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=function(n,e,t){const i={};let r=e.indices;for(const s in e.attributes){const o=e.attributes[s],a=uae(s,undefined);if("indices"===s)r=o;else if(o.constant)i[a]=o.value;else{const l=o.value,c=ot({},o);delete c.value,i[a]=[new sr(n,l),c],dae(s,c)}}if(r){const s=r.value||r;nn(s instanceof Uint16Array||s instanceof Uint32Array,'attribute array for "indices" must be of integer type');const o={size:1,isIndexed:void 0===r.isIndexed||r.isIndexed};i.indices=[new sr(n,{data:s,target:34963}),o]}return i}(this.gl,e),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(e={}){if(Pg(e))return this;const t={};for(const i in e){const r=e[i];t[i]=r.getValue?r.getValue():r}return this.vertexArray.setAttributes(t),this}setUniforms(e={}){return Object.assign(this.uniforms,e),this}getModuleUniforms(e){this._checkProgram();const t=this.programManager.getUniforms(this.program);return t?t(e):{}}updateModuleSettings(e){const t=this.getModuleUniforms(e||{});return this.setUniforms(t)}clear(e){return rI(this.program.gl,e),this}draw(e={}){this._checkProgram();const{moduleSettings:t=null,framebuffer:i,uniforms:r={},attributes:s={},transformFeedback:o=this.transformFeedback,parameters:a={},vertexArray:l=this.vertexArray}=e;let c;this.setAttributes(s),this.updateModuleSettings(t),this.setUniforms(r),hn.priority>=2&&(c=this._logDrawCallStart(2));const u=this.vertexArray.getDrawParams(),{isIndexed:h=u.isIndexed,indexType:f=u.indexType,indexOffset:g=u.indexOffset,vertexArrayInstanced:m=u.isInstanced}=this.props;m&&!this.isInstanced&&hn.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:w,instanceCount:S}=this,{onBeforeRender:U=eU,onAfterRender:D=eU}=this.props;U(),this.program.setUniforms(this.uniforms);const ie=this.program.draw(Object.assign(pae,e,{logPriority:c,uniforms:null,framebuffer:i,parameters:a,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:l,transformFeedback:o,isIndexed:h,indexType:f,isInstanced:w,instanceCount:S,offset:h?g:0}));return D(),hn.priority>=2&&this._logDrawCallEnd(c,l,i),ie}transform(e={}){const{discard:t=!0,feedbackBuffers:i,unbindModels:r=[]}=e;let{parameters:s}=e;i&&this._setFeedbackBuffers(i),t&&(s=Object.assign({},s,{35977:t})),r.forEach(o=>o.vertexArray.unbindBuffers());try{this.draw(Object.assign({},e,{parameters:s}))}finally{r.forEach(o=>o.vertexArray.bindBuffers())}return this}render(e={}){return hn.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(e).draw()}_setModelProps(e){Object.assign(this.props,e),"uniforms"in e&&this.setUniforms(e.uniforms),"pickable"in e&&(this.pickable=e.pickable),"instanceCount"in e&&(this.instanceCount=e.instanceCount),"geometry"in e&&this.setGeometry(e.geometry),"attributes"in e&&this.setAttributes(e.attributes),"_feedbackBuffers"in e&&this._setFeedbackBuffers(e._feedbackBuffers)}_checkProgram(){if(!this._programDirty&&this.programManager.stateHash===this._programManagerState)return;let{program:t}=this.programProps;if(t)this._managedProgram=!1;else{const{vs:i,fs:r,modules:s,inject:o,defines:a,varyings:l,bufferMode:c,transpileToGLSL100:u}=this.programProps;t=this.programManager.get({vs:i,fs:r,modules:s,inject:o,defines:a,varyings:l,bufferMode:c,transpileToGLSL100:u}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}nn(t instanceof Xj,"Model needs a program"),this._programDirty=!1,t!==this.program&&(this.program=t,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new nae(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const e in this.geometryBuffers){const t=this.geometryBuffers[e][0]||this.geometryBuffers[e];t instanceof sr&&t.delete()}}_setAnimationProps(e){this.animated&&nn(e,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(e={}){if(Pg(e))return this;const{gl:t}=this.program;return this.transformFeedback=this.transformFeedback||new Sj(t,{program:this.program}),this.transformFeedback.setBuffers(e),this}_logDrawCallStart(e){const t=e>3?0:1e4;if(!(Date.now()-this.lastLogTime<t))return this.lastLogTime=Date.now(),hn.group(2,`>>> DRAWING MODEL ${this.id}`,{collapsed:hn.level<=2})(),e}_logDrawCallEnd(e,t,i,r){if(void 0===e)return;const s=function({vertexArray:n,header:e="Attributes"}){if(!n.configuration)return{};const t={};n.elements&&(t.ELEMENT_ARRAY_BUFFER=Qj(n,n.elements,null,e));const i=n.values;for(const r in i){const s=n._getAttributeInfo(r);if(s){let o=`${r}: ${s.name}`;const a=n.accessors[s.location];a&&(o=`${r}: ${sae(s.name,a)}`),t[o]=Qj(n,i[r],a,e)}}return t}({vertexArray:t,header:`${this.id} attributes`,attributes:this._attributes}),{table:o,unusedTable:a,unusedCount:l}=Zj({header:`${this.id} uniforms`,program:this.program,uniforms:Object.assign({},this.program.uniforms,i)}),{table:c,count:u}=Zj({header:`${this.id} uniforms`,program:this.program,uniforms:Object.assign({},this.program.uniforms,i),undefinedOnly:!0});u>0&&hn.log("MISSING UNIFORMS",Object.keys(c))(),l>0&&hn.log("UNUSED UNIFORMS",Object.keys(a))();const h=function(n){const e={},t=`Accessors for ${n.id}`;for(const i of n.attributeInfos)i&&(e[`in ${Jj(i)}`]={[t]:JSON.stringify(i.accessor)});for(const i of n.varyingInfos)i&&(e[`out ${Jj(i)}`]={[t]:JSON.stringify(i.accessor)});return e}(this.vertexArray.configuration);hn.table(e,s)(),hn.table(e,o)(),hn.table(e+1,h)(),r&&r.log({logLevel:2,message:`Rendered to ${r.id}`}),hn.groupEnd(2,`>>> DRAWING MODEL ${this.id}`)()}}class RI{static isSupported(e){return _i(e)}constructor(e,t={}){this.gl=e,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(t),Object.seal(this)}delete(){const{model:e,bufferTransform:t,textureTransform:i}=this;e&&e.delete(),t&&t.delete(),i&&i.delete()}run(e={}){const{clearRenderTarget:t=!0}=e,i=this._updateDrawOptions(e);t&&i.framebuffer&&i.framebuffer.clear({color:!0}),this.model.transform(i)}swap(){let e=!1;const t=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of t)e=e||i.swap();nn(e,"Nothing to swap")}getBuffer(e=null){return this.bufferTransform&&this.bufferTransform.getBuffer(e)}getData(e={}){const t=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of t){const r=i.getData(e);if(r)return r}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(e={}){"elementCount"in e&&this.model.setVertexCount(e.elementCount);const t=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of t)i.update(e)}_initialize(e={}){const{gl:t}=this;this._buildResourceTransforms(t,e),e=this._updateModelProps(e),this.model=new Hg(t,Object.assign({},e,{fs:e.fs||Ej({version:xj(e.vs)}),id:e.id||"transform-model",drawMode:e.drawMode||0,vertexCount:e.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(e){let t=Object.assign({},e);const i=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of i)t=r.updateModelProps(t);return t}_buildResourceTransforms(e,t){(function(n){return!(Pg(n.feedbackBuffers)&&Pg(n.feedbackMap)&&!(n.varyings&&n.varyings.length>0))})(t)&&(this.bufferTransform=new cse(e,t)),function(n){return!(Pg(n._sourceTextures)&&!n._targetTexture&&!n._targetTextureVarying)}(t)&&(this.textureTransform=new Sse(e,t)),nn(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(e){let t=Object.assign({},e);const i=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of i)t=Object.assign(t,r.getDrawOptions(t));return t}}function vS(){}const _ae={onStart:vS,onUpdate:vS,onInterrupt:vS,onEnd:vS};class I0{constructor(e){this._inProgress=!1,this._handle=null,this.timeline=e,this.settings={}}get inProgress(){return this._inProgress}start(e){this.cancel(),this.settings=ot(ot({},_ae),e),this._inProgress=!0,this.settings.onStart(this)}end(){this._inProgress&&(this.timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,this.settings.onEnd(this))}cancel(){this._inProgress&&(this.settings.onInterrupt(this),this.timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}update(){if(!this._inProgress)return!1;if(null===this._handle){const{timeline:e,settings:t}=this;this._handle=e.addChannel({delay:e.getTime(),duration:t.duration})}return this.time=this.timeline.getTime(this._handle),this._onUpdate(),this.settings.onUpdate(this),this.timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const Cae={interpolation:class{constructor({gl:e,attribute:t,timeline:i}){this.gl=e,this.type="interpolation",this.transition=new I0(i),this.attribute=t,this.attributeInTransition=new gI(e,t.settings),this.currentStartIndices=t.startIndices,this.currentLength=0,this.transform=function(n,e){const t=_j(e.size);return new RI(n,{vs:"\n#define SHADER_NAME interpolation-transition-vertex-shader\n\nuniform float time;\nattribute ATTRIBUTE_TYPE aFrom;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vCurrent;\n\nvoid main(void) {\n  vCurrent = mix(aFrom, aTo, time);\n  gl_Position = vec4(0.0);\n}\n",defines:{ATTRIBUTE_TYPE:t},varyings:["vCurrent"]})}(e,t);const r={byteLength:0,usage:35050};this.buffers=[new sr(e,r),new sr(e,r)]}get inProgress(){return this.transition.inProgress}start(e,t){if(e.duration<=0)return void this.transition.cancel();const{buffers:r,attribute:s}=this;yj(r);const o={numInstances:t,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const a of r)vj(ot({buffer:a},o));this.currentStartIndices=s.startIndices,this.currentLength=pI(s,t),this.attributeInTransition.update({buffer:r[1],value:s.value}),this.transition.start(e),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aFrom:r[0],aTo:mj(0,s)},feedbackBuffers:{vCurrent:r[1]}})}update(){const e=this.transition.update();if(e){const{time:t,settings:{duration:i,easing:r}}=this.transition,s=r(t/i);this.transform.run({uniforms:{time:s}})}return e}cancel(){for(this.transition.cancel(),this.transform.delete();this.buffers.length;)this.buffers.pop().delete()}},spring:class{constructor({gl:e,attribute:t,timeline:i}){this.gl=e,this.type="spring",this.transition=new I0(i),this.attribute=t,this.attributeInTransition=new gI(e,wn(ot({},t.settings),{normalized:!1})),this.currentStartIndices=t.startIndices,this.currentLength=0,this.texture=function(n){return new da(n,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}(e),this.framebuffer=function(n,e){return new Rs(n,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{36064:e}})}(e,this.texture),this.transform=function(n,e,t){const i=_j(e.size);return new RI(n,{framebuffer:t,vs:"\n#define SHADER_NAME spring-transition-vertex-shader\n\n#define EPSILON 0.00001\n\nuniform float stiffness;\nuniform float damping;\nattribute ATTRIBUTE_TYPE aPrev;\nattribute ATTRIBUTE_TYPE aCur;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vNext;\nvarying float vIsTransitioningFlag;\n\nATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {\n  ATTRIBUTE_TYPE velocity = cur - prev;\n  ATTRIBUTE_TYPE delta = dest - cur;\n  ATTRIBUTE_TYPE spring = delta * stiffness;\n  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;\n  return spring + damper + velocity + cur;\n}\n\nvoid main(void) {\n  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;\n  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;\n\n  vNext = getNextValue(aCur, aPrev, aTo);\n  gl_Position = vec4(0, 0, 0, 1);\n  gl_PointSize = 100.0;\n}\n",fs:"\n#define SHADER_NAME spring-transition-is-transitioning-fragment-shader\n\nvarying float vIsTransitioningFlag;\n\nvoid main(void) {\n  if (vIsTransitioningFlag == 0.0) {\n    discard;\n  }\n  gl_FragColor = vec4(1.0);\n}",defines:{ATTRIBUTE_TYPE:i},varyings:["vNext"]})}(e,t,this.framebuffer);const r={byteLength:0,usage:35050};this.buffers=[new sr(e,r),new sr(e,r),new sr(e,r)]}get inProgress(){return this.transition.inProgress}start(e,t){const{buffers:r,attribute:s}=this,o={numInstances:t,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const a of r)vj(ot({buffer:a},o));this.currentStartIndices=s.startIndices,this.currentLength=pI(s,t),this.attributeInTransition.update({buffer:r[1],value:s.value}),this.transition.start(e),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aTo:mj(0,s)}})}update(){const{buffers:e,transform:t,framebuffer:i,transition:r}=this;return!!r.update()&&(t.update({sourceBuffers:{aPrev:e[0],aCur:e[1]},feedbackBuffers:{vNext:e[2]}}),t.run({framebuffer:i,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:r.settings.stiffness,damping:r.settings.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),yj(e),this.attributeInTransition.update({buffer:e[1],value:this.attribute.value}),rS(i)[0]>0||r.end(),!0)}cancel(){for(this.transition.cancel(),this.transform.delete();this.buffers.length;)this.buffers.pop().delete();this.texture.delete(),this.texture=null,this.framebuffer.delete(),this.framebuffer=null}}};class Tae{constructor(e,{id:t,timeline:i}){this.id=t,this.gl=e,this.timeline=i,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=RI.isSupported(e)}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:t,numInstances:i}){this.numInstances=i||1;for(const r in e){const s=e[r],o=s.getTransitionSetting(t);!o||this._updateAttribute(r,s,o)}for(const r in this.transitions){const s=e[r];(!s||!s.getTransitionSetting(t))&&this._removeTransition(r)}}hasAttribute(e){const t=this.transitions[e];return t&&t.inProgress}getAttributes(){const e={};for(const t in this.transitions){const i=this.transitions[t];i.inProgress&&(e[t]=i.attributeInTransition)}return e}run(){if(!this.isSupported||0===this.numInstances)return!1;for(const t in this.transitions)this.transitions[t].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].cancel(),delete this.transitions[e]}_updateAttribute(e,t,i){const r=this.transitions[e];let s=!r||r.type!==i.type;if(s){if(!this.isSupported)return void Mi.warn("WebGL2 not supported by this browser. Transition for ".concat(e," is disabled."))();r&&this._removeTransition(e);const o=Cae[i.type];o?this.transitions[e]=new o({attribute:t,timeline:this.timeline,gl:this.gl}):(Mi.error("unsupported transition type '".concat(i.type,"'"))(),s=!1)}(s||t.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(i,this.numInstances))}}const tU="attributeManager.invalidate";class Rae{constructor(e,{id:t="attribute-manager",stats:i,timeline:r}={}){this.id=t,this.gl=e,this.attributes={},this.updateTriggers={},this.accessors={},this.needsRedraw=!0,this.userData={},this.stats=i,this.attributeTransitionManager=new Tae(e,{id:"".concat(t,"-transitions"),timeline:r}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const t=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,t&&this.id}setNeedsRedraw(e=!0){return this.needsRedraw=!0,this}add(e,t){this._add(e,t)}addInstanced(e,t){this._add(e,t,{instanced:1})}remove(e){for(let t=0;t<e.length;t++){const i=e[t];void 0!==this.attributes[i]&&(this.attributes[i].delete(),delete this.attributes[i])}}invalidate(e,t){const i=this._invalidateTrigger(e,t);xo(tU,this,e,i)}invalidateAll(e){for(const t in this.attributes)this.attributes[t].setNeedsUpdate(t,e);xo(tU,this,"all")}update({data:e,numInstances:t,startIndices:i=null,transitions:r,props:s={},buffers:o={},context:a={}}={}){let l=!1;xo("attributeManager.updateStart",this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const c in this.attributes){const u=this.attributes[c],h=u.settings.accessor;u.startIndices=i,s[c]&&Mi.removed("props.".concat(c),"data.attributes.".concat(c))(),u.setExternalBuffer(o[c])||u.setBinaryValue(o[h],e.startIndices)||!o[h]&&u.setConstantValue(s[h])||u.needsUpdate()&&(l=!0,this._updateAttribute({attribute:u,numInstances:t,data:e,props:s,context:a})),this.needsRedraw|=u.needsRedraw()}l&&xo("attributeManager.updateEnd",this,t),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:t,transitions:r})}updateTransition(){const{attributeTransitionManager:e}=this,t=e.run();return this.needsRedraw=this.needsRedraw||t,t}getAttributes(){return this.attributes}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:t,attributeTransitionManager:i}=this,r=ot({},i.getAttributes());for(const s in t){const o=t[s];o.needsRedraw(e)&&!i.hasAttribute(s)&&(r[s]=o)}return r}getShaderAttributes(e,t={}){e||(e=this.getAttributes());const i={};for(const r in e)t[r]||Object.assign(i,e[r].getShaderAttributes());return i}getAccessors(){return this.updateTriggers}_add(e,t,i={}){t&&Mi.warn("AttributeManager.add({updaters}) - updater map no longer supported")();for(const r in e)this.attributes[r]=this._createAttribute(r,e[r],i);this._mapUpdateTriggersToAttributes()}_createAttribute(e,t,i){const r=wn(ot({},t),{id:e,isIndexed:t.isIndexed||t.elements||!1,constant:t.constant||!1,size:(t.elements?1:t.size)||1,value:t.value||null,divisor:t.instanced||i.instanced?1:t.divisor||0});return new gI(this.gl,r)}_mapUpdateTriggersToAttributes(){const e={};for(const t in this.attributes)this.attributes[t].getUpdateTriggers().forEach(r=>{e[r]||(e[r]=[]),e[r].push(t)});this.updateTriggers=e}_invalidateTrigger(e,t){const{attributes:i,updateTriggers:r}=this,s=r[e];return s&&s.forEach(o=>{const a=i[o];a&&a.setNeedsUpdate(a.id,t)}),s}_updateAttribute(e){const{attribute:t,numInstances:i}=e;xo("attribute.updateStart",t),t.allocate(i)&&xo("attribute.allocate",t,i),t.updateBuffer(e)&&(this.needsRedraw=!0,xo("attribute.updateEnd",t,i))}}function iU(n,e,t,i,r){const s=e-n;return(t-e)*r+-s*i+s+e}function rU(n,e){if(Array.isArray(n)){let t=0;for(let i=0;i<n.length;i++){const r=n[i]-e[i];t+=r*r}return Math.sqrt(t)}return Math.abs(n-e)}const Lae={interpolation:class extends I0{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:t,toValue:i,duration:r,easing:s}}=this,o=s(e/r);this._value=sS(t,i,o)}},spring:class extends I0{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:t,damping:i,stiffness:r}=this.settings,{_prevValue:s=e,_currValue:o=e}=this;let a=function(n,e,t,i,r){if(Array.isArray(t)){const s=[];for(let o=0;o<t.length;o++)s[o]=iU(n[o],e[o],t[o],i,r);return s}return iU(n,e,t,i,r)}(s,o,t,i,r);const l=rU(a,t),c=rU(a,o);l<1e-5&&c<1e-5&&(a=t,this.end()),this._prevValue=o,this._currValue=a}}};class kae{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,t,i,r){const{transitions:s}=this;if(s.has(e)){const l=s.get(e),{value:c=l.settings.fromValue}=l;t=c,this.remove(e)}if(!(r=gj(r)))return;const o=Lae[r.type];if(!o)return void Mi.error("unsupported transition type '".concat(r.type,"'"))();const a=new o(this.timeline);a.start(wn(ot({},r),{fromValue:t,toValue:i})),s.set(e,a)}remove(e){const{transitions:t}=this;t.has(e)&&(t.get(e).cancel(),t.delete(e))}update(){const e={};for(const[t,i]of this.transitions)i.update(),e[t]=i.value,i.inProgress||this.remove(t);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}const bS={COMPONENT:Symbol.for("component"),ASYNC_DEFAULTS:Symbol.for("asyncPropDefaults"),ASYNC_ORIGINAL:Symbol.for("asyncPropOriginal"),ASYNC_RESOLVED:Symbol.for("asyncPropResolved")},{COMPONENT:Bae}=bS;function Uae(n,e){if(!n.transitions)return null;const t={},i=PI(n);for(const r in n.transitions){const s=i[r],o=s&&s.type;("number"===o||"color"===o||"array"===o)&&NI(n[r],e[r],s)&&(t[r]=!0)}return t}function sU({newProps:n,oldProps:e,ignoreProps:t={},propTypes:i={},triggerName:r="props"}={}){if(e===n)return null;if("object"!=typeof n||null===n||"object"!=typeof e||null===e)return"".concat(r," changed shallowly");for(const s of Object.keys(n))if(!(s in t)){if(!(s in e))return"".concat(r,".").concat(s," added");const o=NI(n[s],e[s],i[s]);if(o)return"".concat(r,".").concat(s," ").concat(o)}for(const s of Object.keys(e))if(!(s in t)){if(!(s in n))return"".concat(r,".").concat(s," dropped");if(!Object.hasOwnProperty.call(n,s)){const o=NI(n[s],e[s],i[s]);if(o)return"".concat(r,".").concat(s," ").concat(o)}}return null}function NI(n,e,t){let i=t&&t.equal;return i&&!i(n,e,t)||!i&&(i=n&&e&&n.equals,i&&!i.call(n,e))?"changed deeply":i||e===n?null:"changed shallowly"}function Gae(n,e){if(null===e)return"oldProps is null, initial diff";const t=e.extensions,{extensions:i}=n;if(i===t)return!1;if(i.length!==t.length)return!0;for(let r=0;r<i.length;r++)if(!i[r].equals(t[r]))return!0;return!1}function oU(n,e,t){let i=n.updateTriggers[t];i=null==i?{}:i;let r=e.updateTriggers[t];return r=null==r?{}:r,sU({oldProps:r,newProps:i,triggerName:t})}function PI(n){const e=n[Bae],t=e&&e.constructor;return t?t._propTypes:{}}function Xae(n,e){if(n===e)return!0;if(Array.isArray(n)){const t=n.length;if(!e||e.length!==t)return!1;for(let i=0;i<t;i++)if(n[i]!==e[i])return!1;return!0}return!1}function wS(n){let t,e={};return i=>{for(const r in i)if(!Xae(i[r],e[r])){t=n(i),e=i;break}return t}}function Qae(n,e){if(!e)return n;const t=ot(ot({},n),e);if("defines"in e&&(t.defines=ot(ot({},n.defines),e.defines)),"modules"in e&&(t.modules=(n.modules||[]).concat(e.modules),e.modules.some(i=>"project64"===i.name))){const i=t.modules.findIndex(r=>"project32"===r.name);i>=0&&t.modules.splice(i,1)}if("inject"in e)if(n.inject){const i=ot({},n.inject);for(const r in e.inject)i[r]=(i[r]||"")+e.inject[r];t.inject=i}else t.inject=e.inject;return t}function FI(n,e){var t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=e[9],f=e[10],g=e[11],m=e[12],w=e[13],S=e[14],U=e[15],D=t*a-i*o,ie=t*l-r*o,_e=t*c-s*o,Ne=i*l-r*a,Pe=i*c-s*a,Ve=r*c-s*l,vt=u*w-h*m,wt=u*S-f*m,xt=u*U-g*m,kt=h*S-f*w,$t=h*U-g*w,gt=f*U-g*S,mt=D*gt-ie*$t+_e*kt+Ne*xt-Pe*wt+Ve*vt;return mt?(n[0]=(a*gt-l*$t+c*kt)*(mt=1/mt),n[1]=(r*$t-i*gt-s*kt)*mt,n[2]=(w*Ve-S*Pe+U*Ne)*mt,n[3]=(f*Pe-h*Ve-g*Ne)*mt,n[4]=(l*xt-o*gt-c*wt)*mt,n[5]=(t*gt-r*xt+s*wt)*mt,n[6]=(S*_e-m*Ve-U*ie)*mt,n[7]=(u*Ve-f*_e+g*ie)*mt,n[8]=(o*$t-a*xt+c*vt)*mt,n[9]=(i*xt-t*$t-s*vt)*mt,n[10]=(m*Pe-w*_e+U*D)*mt,n[11]=(h*_e-u*Pe-g*D)*mt,n[12]=(a*wt-o*kt-l*vt)*mt,n[13]=(t*kt-i*wt+r*vt)*mt,n[14]=(w*ie-m*Ne-S*D)*mt,n[15]=(u*Ne-h*ie+f*D)*mt,n):null}function If(n,e,t){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],f=e[9],g=e[10],m=e[11],w=e[12],S=e[13],U=e[14],D=e[15],ie=t[0],_e=t[1],Ne=t[2],Pe=t[3];return n[0]=ie*i+_e*a+Ne*h+Pe*w,n[1]=ie*r+_e*l+Ne*f+Pe*S,n[2]=ie*s+_e*c+Ne*g+Pe*U,n[3]=ie*o+_e*u+Ne*m+Pe*D,n[4]=(ie=t[4])*i+(_e=t[5])*a+(Ne=t[6])*h+(Pe=t[7])*w,n[5]=ie*r+_e*l+Ne*f+Pe*S,n[6]=ie*s+_e*c+Ne*g+Pe*U,n[7]=ie*o+_e*u+Ne*m+Pe*D,n[8]=(ie=t[8])*i+(_e=t[9])*a+(Ne=t[10])*h+(Pe=t[11])*w,n[9]=ie*r+_e*l+Ne*f+Pe*S,n[10]=ie*s+_e*c+Ne*g+Pe*U,n[11]=ie*o+_e*u+Ne*m+Pe*D,n[12]=(ie=t[12])*i+(_e=t[13])*a+(Ne=t[14])*h+(Pe=t[15])*w,n[13]=ie*r+_e*l+Ne*f+Pe*S,n[14]=ie*s+_e*c+Ne*g+Pe*U,n[15]=ie*o+_e*u+Ne*m+Pe*D,n}function ES(n,e,t){var o,a,l,c,u,h,f,g,m,w,S,U,i=t[0],r=t[1],s=t[2];return e===n?(n[12]=e[0]*i+e[4]*r+e[8]*s+e[12],n[13]=e[1]*i+e[5]*r+e[9]*s+e[13],n[14]=e[2]*i+e[6]*r+e[10]*s+e[14],n[15]=e[3]*i+e[7]*r+e[11]*s+e[15]):(a=e[1],l=e[2],c=e[3],u=e[4],h=e[5],f=e[6],g=e[7],m=e[8],w=e[9],S=e[10],U=e[11],n[0]=o=e[0],n[1]=a,n[2]=l,n[3]=c,n[4]=u,n[5]=h,n[6]=f,n[7]=g,n[8]=m,n[9]=w,n[10]=S,n[11]=U,n[12]=o*i+u*r+m*s+e[12],n[13]=a*i+h*r+w*s+e[13],n[14]=l*i+f*r+S*s+e[14],n[15]=c*i+g*r+U*s+e[15]),n}function SS(n,e,t){var i=t[0],r=t[1],s=t[2];return n[0]=e[0]*i,n[1]=e[1]*i,n[2]=e[2]*i,n[3]=e[3]*i,n[4]=e[4]*r,n[5]=e[5]*r,n[6]=e[6]*r,n[7]=e[7]*r,n[8]=e[8]*s,n[9]=e[9]*s,n[10]=e[10]*s,n[11]=e[11]*s,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n}function aU(n,e,t){var i=Math.sin(t),r=Math.cos(t),s=e[4],o=e[5],a=e[6],l=e[7],c=e[8],u=e[9],h=e[10],f=e[11];return e!==n&&(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[4]=s*r+c*i,n[5]=o*r+u*i,n[6]=a*r+h*i,n[7]=l*r+f*i,n[8]=c*r-s*i,n[9]=u*r-o*i,n[10]=h*r-a*i,n[11]=f*r-l*i,n}function lU(n,e,t){var i=Math.sin(t),r=Math.cos(t),s=e[0],o=e[1],a=e[2],l=e[3],c=e[4],u=e[5],h=e[6],f=e[7];return e!==n&&(n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=s*r+c*i,n[1]=o*r+u*i,n[2]=a*r+h*i,n[3]=l*r+f*i,n[4]=c*r-s*i,n[5]=u*r-o*i,n[6]=h*r-a*i,n[7]=f*r-l*i,n}function uU(n,e,t){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n}function xS(n,e,t){var i=e[0],r=e[1],s=e[2],o=e[3];return n[0]=t[0]*i+t[4]*r+t[8]*s+t[12]*o,n[1]=t[1]*i+t[5]*r+t[9]*s+t[13]*o,n[2]=t[2]*i+t[6]*r+t[10]*s+t[14]*o,n[3]=t[3]*i+t[7]*r+t[11]*s+t[15]*o,n}function dU(n,e,t){var i=e[0],r=e[1],s=e[2],o=t[0],a=t[1],l=t[2],c=t[3],u=c*i+a*s-l*r,h=c*r+l*i-o*s,f=c*s+o*r-a*i,g=-o*i-a*r-l*s;return n[0]=u*c+g*-o+h*-l-f*-a,n[1]=h*c+g*-a+f*-o-u*-l,n[2]=f*c+g*-l+u*-a-h*-o,n[3]=e[3],n}!function(){var n=new ha(4);ha!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0,n[3]=0)}();const hU=[0,0,0,0],Ele=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],Sle=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],xle=[0,0,0],Cle=[0,0,0],Tle=wS(function({viewport:n,devicePixelRatio:e,coordinateSystem:t,coordinateOrigin:i}){const{projectionCenter:r,viewProjectionMatrix:s,originCommon:o,cameraPosCommon:a,shaderCoordinateOrigin:l,geospatialOrigin:c}=function(n,e,t){const{viewMatrixUncentered:i,projectionMatrix:r}=n;let{viewMatrix:s,viewProjectionMatrix:o}=n,a=hU,l=hU,c=n.cameraPosition;const{geospatialOrigin:u,shaderCoordinateOrigin:h,offsetMode:f}=fU(n,e,t);return f&&(l=n.projectPosition(u||h),c=[c[0]-l[0],c[1]-l[1],c[2]-l[2]],l[3]=1,a=xS([],l,o),s=i||s,o=If([],r,s),o=If([],o,Ele)),{viewMatrix:s,viewProjectionMatrix:o,projectionCenter:a,originCommon:l,cameraPosCommon:c,shaderCoordinateOrigin:h,geospatialOrigin:u}}(n,t,i),u=n.getDistanceScales(),h=[n.width*e,n.height*e],f=n.projectionMatrix.transform([0,0,-n.focalDistance,1])[3]||1,g={project_uCoordinateSystem:t,project_uProjectionMode:n.projectionMode,project_uCoordinateOrigin:l,project_uCommonOrigin:o.slice(0,3),project_uCenter:r,project_uViewportSize:h,project_uDevicePixelRatio:e,project_uFocalDistance:f,project_uCommonUnitsPerMeter:u.unitsPerMeter,project_uCommonUnitsPerWorldUnit:u.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:xle,project_uScale:n.scale,project_uViewProjectionMatrix:s,project_uCameraPosition:a};if(c){const m=n.getDistanceScales(c);switch(t){case Fi.METER_OFFSETS:g.project_uCommonUnitsPerWorldUnit=m.unitsPerMeter,g.project_uCommonUnitsPerWorldUnit2=m.unitsPerMeter2;break;case Fi.LNGLAT:case Fi.LNGLAT_OFFSETS:g.project_uCommonUnitsPerWorldUnit=m.unitsPerDegree,g.project_uCommonUnitsPerWorldUnit2=m.unitsPerDegree2;break;case Fi.CARTESIAN:g.project_uCommonUnitsPerWorldUnit=[1,1,m.unitsPerMeter[2]],g.project_uCommonUnitsPerWorldUnit2=[0,0,m.unitsPerMeter2[2]]}}return g});function fU(n,e,t=Cle){let r,i=t,s=!0;switch(r=e===Fi.LNGLAT_OFFSETS||e===Fi.METER_OFFSETS?t:n.isGeospatial?[Math.fround(n.longitude),Math.fround(n.latitude),0]:null,n.projectionMode){case Wc.WEB_MERCATOR:(e===Fi.LNGLAT||e===Fi.CARTESIAN)&&(s=!1);break;case Wc.WEB_MERCATOR_AUTO_OFFSET:e===Fi.LNGLAT?i=r:e===Fi.CARTESIAN&&(i=[Math.fround(n.center[0]),Math.fround(n.center[1]),0],r=n.unprojectPosition(i),i[0]-=t[0],i[1]-=t[1],i[2]-=t[2]);break;case Wc.IDENTITY:i=n.position.map(Math.fround);break;case Wc.GLOBE:s=!1,r=null;break;default:s=!1}return i[2]=i[2]||0,{geospatialOrigin:r,shaderCoordinateOrigin:i,offsetMode:s}}class pU extends oS{get ELEMENTS(){return Gu(!1),0}get RANK(){return Gu(!1),0}toString(){let e="[";if(Sr.printRowMajor){e+="row-major:";for(let t=0;t<this.RANK;++t)for(let i=0;i<this.RANK;++i)e+=` ${this[i*this.RANK+t]}`}else{e+="column-major:";for(let t=0;t<this.ELEMENTS;++t)e+=` ${this[t]}`}return e+="]",e}getElementIndex(e,t){return t*this.RANK+e}getElement(e,t){return this[t*this.RANK+e]}setElement(e,t,i){return this[t*this.RANK+e]=er(i),this}getColumn(e,t=new Array(this.RANK).fill(-0)){const i=e*this.RANK;for(let r=0;r<this.RANK;++r)t[r]=this[i+r];return t}setColumn(e,t){const i=e*this.RANK;for(let r=0;r<this.RANK;++r)this[i+r]=t[r];return this}}function CS(n,e,t){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n}function gU(n,e){return n[0]=-e[0],n[1]=-e[1],n}function mU(n,e,t,i){var r=e[0],s=e[1];return n[0]=r+i*(t[0]-r),n[1]=s+i*(t[1]-s),n}function _U(n,e,t){var i=e[0],r=e[1];return n[0]=t[0]*i+t[3]*r+t[6],n[1]=t[1]*i+t[4]*r+t[7],n}!function(){var n=new ha(2);ha!=Float32Array&&(n[0]=0,n[1]=0)}();const yU=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),Rle=Object.freeze([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Nle=Object.freeze({COL0ROW0:0,COL0ROW1:1,COL0ROW2:2,COL0ROW3:3,COL1ROW0:4,COL1ROW1:5,COL1ROW2:6,COL1ROW3:7,COL2ROW0:8,COL2ROW1:9,COL2ROW2:10,COL2ROW3:11,COL3ROW0:12,COL3ROW1:13,COL3ROW2:14,COL3ROW3:15}),$g={};class Gn extends pU{static get IDENTITY(){return $g.IDENTITY=$g.IDENTITY||Object.freeze(new Gn(yU)),$g.IDENTITY}static get ZERO(){return $g.ZERO=$g.ZERO||Object.freeze(new Gn(Rle)),$g.ZERO}get INDICES(){return Nle}get ELEMENTS(){return 16}get RANK(){return 4}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,t,i,r,s,o,a,l,c,u,h,f,g,m,w,S){return this[0]=e,this[1]=t,this[2]=i,this[3]=r,this[4]=s,this[5]=o,this[6]=a,this[7]=l,this[8]=c,this[9]=u,this[10]=h,this[11]=f,this[12]=g,this[13]=m,this[14]=w,this[15]=S,this.check()}setRowMajor(e,t,i,r,s,o,a,l,c,u,h,f,g,m,w,S){return this[0]=e,this[1]=s,this[2]=c,this[3]=g,this[4]=t,this[5]=o,this[6]=u,this[7]=m,this[8]=i,this[9]=a,this[10]=h,this[11]=w,this[12]=r,this[13]=l,this[14]=f,this[15]=S,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(yU)}fromQuaternion(e){return function(n,e){var t=e[0],i=e[1],r=e[2],s=e[3],o=t+t,a=i+i,l=r+r,c=t*o,u=i*o,h=i*a,f=r*o,g=r*a,m=r*l,w=s*o,S=s*a,U=s*l;n[0]=1-h-m,n[1]=u+U,n[2]=f-S,n[3]=0,n[4]=u-U,n[5]=1-c-m,n[6]=g+w,n[7]=0,n[8]=f+S,n[9]=g-w,n[10]=1-c-h,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1}(this,e),this.check()}frustum({left:e,right:t,bottom:i,top:r,near:s,far:o}){return o===1/0?Gn._computeInfinitePerspectiveOffCenter(this,e,t,i,r,s):function(n,e,t,i,r,s,o){var a=1/(t-e),l=1/(r-i),c=1/(s-o);n[0]=2*s*a,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=2*s*l,n[6]=0,n[7]=0,n[8]=(t+e)*a,n[9]=(r+i)*l,n[10]=(o+s)*c,n[11]=-1,n[12]=0,n[13]=0,n[14]=o*s*2*c,n[15]=0}(this,e,t,i,r,s,o),this.check()}static _computeInfinitePerspectiveOffCenter(e,t,i,r,s,o){const l=2*o/(s-r),c=(i+t)/(i-t),u=(s+r)/(s-r),g=-2*o;return e[0]=2*o/(i-t),e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=l,e[6]=0,e[7]=0,e[8]=c,e[9]=u,e[10]=-1,e[11]=-1,e[12]=0,e[13]=0,e[14]=g,e[15]=0,e}lookAt(e,t,i){return 1===arguments.length&&({eye:e,center:t,up:i}=e),function(n,e,t,i){var r,s,o,a,l,c,u,h,f,g,m=e[0],w=e[1],S=e[2],U=i[0],D=i[1],ie=i[2],_e=t[0],Ne=t[1],Pe=t[2];Math.abs(m-_e)<Yc&&Math.abs(w-Ne)<Yc&&Math.abs(S-Pe)<Yc?function(n){n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1}(n):(u=m-_e,h=w-Ne,f=S-Pe,r=D*(f*=g=1/Math.hypot(u,h,f))-ie*(h*=g),s=ie*(u*=g)-U*f,o=U*h-D*u,(g=Math.hypot(r,s,o))?(r*=g=1/g,s*=g,o*=g):(r=0,s=0,o=0),a=h*o-f*s,l=f*r-u*o,c=u*s-h*r,(g=Math.hypot(a,l,c))?(a*=g=1/g,l*=g,c*=g):(a=0,l=0,c=0),n[0]=r,n[1]=a,n[2]=u,n[3]=0,n[4]=s,n[5]=l,n[6]=h,n[7]=0,n[8]=o,n[9]=c,n[10]=f,n[11]=0,n[12]=-(r*m+s*w+o*S),n[13]=-(a*m+l*w+c*S),n[14]=-(u*m+h*w+f*S),n[15]=1)}(this,e,t=t||[0,0,0],i=i||[0,1,0]),this.check()}ortho({left:e,right:t,bottom:i,top:r,near:s=.1,far:o=500}){return function(n,e,t,i,r,s,o){var a=1/(e-t),l=1/(i-r),c=1/(s-o);n[0]=-2*a,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*l,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*c,n[11]=0,n[12]=(e+t)*a,n[13]=(r+i)*l,n[14]=(o+s)*c,n[15]=1}(this,e,t,i,r,s,o),this.check()}orthographic({fovy:e=45*Math.PI/180,aspect:t=1,focalDistance:i=1,near:r=.1,far:s=500}){if(e>2*Math.PI)throw Error("radians");const a=i*Math.tan(e/2),l=a*t;return(new Gn).ortho({left:-l,right:l,bottom:-a,top:a,near:r,far:s})}perspective({fovy:e,fov:t=45*Math.PI/180,aspect:i=1,near:r=.1,far:s=500}={}){if((e=e||t)>2*Math.PI)throw Error("radians");return function(n,e,t,i,r){var o,s=1/Math.tan(e/2);n[0]=s/t,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=s,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,null!=r&&r!==1/0?(n[10]=(r+i)*(o=1/(i-r)),n[14]=2*r*i*o):(n[10]=-1,n[14]=-2*i)}(this,e,i,r,s),this.check()}determinant(){return function(n){var e=n[0],t=n[1],i=n[2],r=n[3],s=n[4],o=n[5],a=n[6],l=n[7],c=n[8],u=n[9],h=n[10],f=n[11],g=n[12],m=n[13],w=n[14],S=n[15];return(e*o-t*s)*(h*S-f*w)-(e*a-i*s)*(u*S-f*m)+(e*l-r*s)*(u*w-h*m)+(t*a-i*o)*(c*S-f*g)-(t*l-r*o)*(c*w-h*g)+(i*l-r*a)*(c*m-u*g)}(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e=[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],t=null){const i=this.getScale(t||[-0,-0,-0]),r=1/i[0],s=1/i[1],o=1/i[2];return e[0]=this[0]*r,e[1]=this[1]*s,e[2]=this[2]*o,e[3]=0,e[4]=this[4]*r,e[5]=this[5]*s,e[6]=this[6]*o,e[7]=0,e[8]=this[8]*r,e[9]=this[9]*s,e[10]=this[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e=[-0,-0,-0,-0,-0,-0,-0,-0,-0],t=null){const i=this.getScale(t||[-0,-0,-0]),r=1/i[0],s=1/i[1],o=1/i[2];return e[0]=this[0]*r,e[1]=this[1]*s,e[2]=this[2]*o,e[3]=this[4]*r,e[4]=this[5]*s,e[5]=this[6]*o,e[6]=this[8]*r,e[7]=this[9]*s,e[8]=this[10]*o,e}transpose(){return function(n,e){if(n===e){var t=e[1],i=e[2],r=e[3],s=e[6],o=e[7],a=e[11];n[1]=e[4],n[2]=e[8],n[3]=e[12],n[4]=t,n[6]=e[9],n[7]=e[13],n[8]=i,n[9]=s,n[11]=e[14],n[12]=r,n[13]=o,n[14]=a}else n[0]=e[0],n[1]=e[4],n[2]=e[8],n[3]=e[12],n[4]=e[1],n[5]=e[5],n[6]=e[9],n[7]=e[13],n[8]=e[2],n[9]=e[6],n[10]=e[10],n[11]=e[14],n[12]=e[3],n[13]=e[7],n[14]=e[11],n[15]=e[15]}(this,this),this.check()}invert(){return FI(this,this),this.check()}multiplyLeft(e){return If(this,e,this),this.check()}multiplyRight(e){return If(this,this,e),this.check()}rotateX(e){return aU(this,this,e),this.check()}rotateY(e){return function(n,e,t){var i=Math.sin(t),r=Math.cos(t),s=e[0],o=e[1],a=e[2],l=e[3],c=e[8],u=e[9],h=e[10],f=e[11];e!==n&&(n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=s*r-c*i,n[1]=o*r-u*i,n[2]=a*r-h*i,n[3]=l*r-f*i,n[8]=s*i+c*r,n[9]=o*i+u*r,n[10]=a*i+h*r,n[11]=l*i+f*r}(this,this,e),this.check()}rotateZ(e){return lU(this,this,e),this.check()}rotateXYZ([e,t,i]){return this.rotateX(e).rotateY(t).rotateZ(i)}rotateAxis(e,t){return function(n,e,t,i){var l,c,u,h,f,g,m,w,S,U,D,ie,_e,Ne,Pe,Ve,vt,wt,xt,kt,$t,gt,mt,jt,r=i[0],s=i[1],o=i[2],a=Math.hypot(r,s,o);a<Yc||(r*=a=1/a,s*=a,o*=a,l=Math.sin(t),c=Math.cos(t),f=e[1],g=e[2],m=e[3],S=e[5],U=e[6],D=e[7],_e=e[9],Ne=e[10],Pe=e[11],xt=r*s*(u=1-c)-o*l,kt=s*s*u+c,$t=o*s*u+r*l,gt=r*o*u+s*l,mt=s*o*u-r*l,jt=o*o*u+c,n[0]=(h=e[0])*(Ve=r*r*u+c)+(w=e[4])*(vt=s*r*u+o*l)+(ie=e[8])*(wt=o*r*u-s*l),n[1]=f*Ve+S*vt+_e*wt,n[2]=g*Ve+U*vt+Ne*wt,n[3]=m*Ve+D*vt+Pe*wt,n[4]=h*xt+w*kt+ie*$t,n[5]=f*xt+S*kt+_e*$t,n[6]=g*xt+U*kt+Ne*$t,n[7]=m*xt+D*kt+Pe*$t,n[8]=h*gt+w*mt+ie*jt,n[9]=f*gt+S*mt+_e*jt,n[10]=g*gt+U*mt+Ne*jt,n[11]=m*gt+D*mt+Pe*jt,e!==n&&(n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]))}(this,this,e,t),this.check()}scale(e){return Array.isArray(e)?SS(this,this,e):SS(this,this,[e,e,e]),this.check()}translate(e){return ES(this,this,e),this.check()}transform(e,t){return 4===e.length?(b0(t=xS(t||[-0,-0,-0,-0],e,this),4),t):this.transformAsPoint(e,t)}transformAsPoint(e,t){const{length:i}=e;switch(i){case 2:t=function(n,e,t){var i=e[0],r=e[1];return n[0]=t[0]*i+t[4]*r+t[12],n[1]=t[1]*i+t[5]*r+t[13],n}(t||[-0,-0],e,this);break;case 3:t=cI(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return b0(t,e.length),t}transformAsVector(e,t){switch(e.length){case 2:t=function(n,e,t){const i=e[0],r=e[1],s=t[3]*i+t[7]*r||1;return n[0]=(t[0]*i+t[4]*r)/s,n[1]=(t[1]*i+t[5]*r)/s,n}(t||[-0,-0],e,this);break;case 3:t=aj(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return b0(t,e.length),t}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,t,i){return this.identity().translate([e,t,i])}transformPoint(e,t){return kg("Matrix4.transformPoint","3.0"),this.transformAsPoint(e,t)}transformVector(e,t){return kg("Matrix4.transformVector","3.0"),this.transformAsPoint(e,t)}transformDirection(e,t){return kg("Matrix4.transformDirection","3.0"),this.transformAsVector(e,t)}}function Wg(n,e){const t=xS([],e,n);return uU(t,t,1/t[3]),t}function vU(n,e){const t=n%e;return t<0?e+t:t}function bU(n,e,t){return n<e?e:n>t?t:n}const LI=Math.log2||function(n){return Math.log(n)*Math.LOG2E};function Wu(n,e){if(!n)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const ac=Math.PI,wU=ac/4,lc=ac/180,kI=180/ac,BI=4003e4,TS=85.051129;function AS([n,e]){return Wu(Number.isFinite(n)),Wu(Number.isFinite(e)&&e>=-90&&e<=90,"invalid latitude"),[512*(n*lc+ac)/(2*ac),512*(ac+Math.log(Math.tan(wU+e*lc*.5)))/(2*ac)]}function qg([n,e]){const t=n/512*(2*ac)-ac,i=2*(Math.atan(Math.exp(e/512*(2*ac)-ac))-wU);return[t*kI,i*kI]}function VI({latitude:n,longitude:e,highPrecision:t=!1}){Wu(Number.isFinite(n)&&Number.isFinite(e));const i={},s=Math.cos(n*lc),o=512/360,a=o/s,l=512/BI/s;if(i.unitsPerMeter=[l,l,l],i.metersPerUnit=[1/l,1/l,1/l],i.unitsPerDegree=[o,a,l],i.degreesPerUnit=[1/o,1/a,1/l],t){const c=lc*Math.tan(n*lc)/s,h=512/BI*c,f=h/a*l;i.unitsPerDegree2=[0,o*c/2,h],i.unitsPerMeter2=[f,0,f]}return i}function EU(n,e){const[t,i,r]=n,[s,o,a]=e,{unitsPerMeter:l,unitsPerMeter2:c}=VI({longitude:t,latitude:i,highPrecision:!0}),u=AS(n);u[0]+=s*(l[0]+c[0]*o),u[1]+=o*(l[1]+c[1]*o);const h=qg(u),f=(r||0)+(a||0);return Number.isFinite(r)||Number.isFinite(a)?[h[0],h[1],f]:h}function xU(n){return 2*Math.atan(.5/n)*kI}function CU(n,e){const[t,i,r=0]=n;return Wu(Number.isFinite(t)&&Number.isFinite(i)&&Number.isFinite(r)),Wg(e,[t,i,r,1])}function R0(n,e,t=0){const[i,r,s]=n;if(Wu(Number.isFinite(i)&&Number.isFinite(r),"invalid pixel coordinate"),Number.isFinite(s))return Wg(e,[i,r,s,1]);const o=Wg(e,[i,r,0,1]),a=Wg(e,[i,r,1,1]),l=o[2],c=a[2];return mU([],o,a,l===c?0:((t||0)-l)/(c-l))}const TU=Math.PI/180;function AU(n,e,t){const{pixelUnprojectionMatrix:i}=n,r=Wg(i,[e,0,1,1]),s=Wg(i,[e,n.height,1,1]),c=qg(mU([],r,s,(t*n.distanceScales.unitsPerMeter[2]-r[2])/(s[2]-r[2])));return c[2]=t,c}const $le=Math.PI/180,Wle=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],UI=[0,0,0],Yle={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};let Yg=(()=>{class n{constructor(t={}){const{id:i=null,x:r=0,y:s=0,width:o=1,height:a=1}=t;this.id=i||this.constructor.displayName||"viewport",this.x=r,this.y=s,this.width=o||1,this.height=a||1,this._frustumPlanes={},this._initViewMatrix(t),this._initProjectionMatrix(t),this._initPixelMatrices(),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?Wc.WEB_MERCATOR:Wc.WEB_MERCATOR_AUTO_OFFSET:Wc.IDENTITY}equals(t){return t instanceof n&&(this===t||t.width===this.width&&t.height===this.height&&t.scale===this.scale&&v0(t.projectionMatrix,this.projectionMatrix)&&v0(t.viewMatrix,this.viewMatrix))}project(t,{topLeft:i=!0}={}){const s=CU(this.projectPosition(t),this.pixelProjectionMatrix),[o,a]=s,l=i?a:this.height-a;return 2===t.length?[o,l]:[o,l,s[2]]}unproject(t,{topLeft:i=!0,targetZ:r}={}){const[s,o,a]=t,u=R0([s,i?o:this.height-o,a],this.pixelUnprojectionMatrix,r&&r*this.distanceScales.unitsPerMeter[2]),[h,f,g]=this.unprojectPosition(u);return Number.isFinite(a)?[h,f,g]:Number.isFinite(r)?[h,f,r]:[h,f]}projectPosition(t){const[i,r]=this.projectFlat(t);return[i,r,(t[2]||0)*this.distanceScales.unitsPerMeter[2]]}unprojectPosition(t){const[i,r]=this.unprojectFlat(t);return[i,r,(t[2]||0)*this.distanceScales.metersPerUnit[2]]}projectFlat(t){return this.isGeospatial?AS(t):t}unprojectFlat(t){return this.isGeospatial?qg(t):t}getBounds(t={}){const i={targetZ:t.z||0},r=this.unproject([0,0],i),s=this.unproject([this.width,0],i),o=this.unproject([0,this.height],i),a=this.unproject([this.width,this.height],i);return[Math.min(r[0],s[0],o[0],a[0]),Math.min(r[1],s[1],o[1],a[1]),Math.max(r[0],s[0],o[0],a[0]),Math.max(r[1],s[1],o[1],a[1])]}getDistanceScales(t=null){return t?VI({longitude:t[0],latitude:t[1],highPrecision:!0}):this.distanceScales}containsPixel({x:t,y:i,width:r=1,height:s=1}){return t<this.x+this.width&&this.x<t+r&&i<this.y+this.height&&this.y<i+s}getFrustumPlanes(){return this._frustumPlanes.near||Object.assign(this._frustumPlanes,function(n){const e={};return e.left=Bg(n[3]+n[0],n[7]+n[4],n[11]+n[8],n[15]+n[12]),e.right=Bg(n[3]-n[0],n[7]-n[4],n[11]-n[8],n[15]-n[12]),e.bottom=Bg(n[3]+n[1],n[7]+n[5],n[11]+n[9],n[15]+n[13]),e.top=Bg(n[3]-n[1],n[7]-n[5],n[11]-n[9],n[15]-n[13]),e.near=Bg(n[3]+n[2],n[7]+n[6],n[11]+n[10],n[15]+n[14]),e.far=Bg(n[3]-n[2],n[7]-n[6],n[11]-n[10],n[15]-n[14]),e}(this.viewProjectionMatrix)),this._frustumPlanes}panByPosition(t,i){return null}getCameraPosition(){return this.cameraPosition}getCameraDirection(){return this.cameraDirection}getCameraUp(){return this.cameraUp}_createProjectionMatrix({orthographic:t,fovyRadians:i,aspect:r,focalDistance:s,near:o,far:a}){return t?(new Gn).orthographic({fovy:i,aspect:r,focalDistance:s,near:o,far:a}):(new Gn).perspective({fovy:i,aspect:r,near:o,far:a})}_initViewMatrix(t){const{viewMatrix:i=Wle,longitude:r=null,latitude:s=null,zoom:o=null,position:a=null,modelMatrix:l=null,focalDistance:c=1,distanceScales:u=null}=t;this.isGeospatial=Number.isFinite(s)&&Number.isFinite(r),this.zoom=o,Number.isFinite(this.zoom)||(this.zoom=this.isGeospatial?function({latitude:n}){Wu(Number.isFinite(n));const e=Math.cos(n*lc);return function(n){return LI(n)}(BI*e)-9}({latitude:s})+Math.log2(c):0);const h=Math.pow(2,this.zoom);this.scale=h,this.distanceScales=this.isGeospatial?VI({latitude:s,longitude:r}):u||Yle,this.focalDistance=c,this.distanceScales.metersPerUnit=new So(this.distanceScales.metersPerUnit),this.distanceScales.unitsPerMeter=new So(this.distanceScales.unitsPerMeter),this.position=UI,this.meterOffset=UI,a&&(this.position=a,this.modelMatrix=l,this.meterOffset=l?l.transformVector(a):a),this.isGeospatial?(this.longitude=r,this.latitude=s,this.center=this._getCenterInWorld({longitude:r,latitude:s})):this.center=a?this.projectPosition(a):[0,0,0],this.viewMatrixUncentered=i,this.viewMatrix=(new Gn).multiplyRight(this.viewMatrixUncentered).translate(new So(this.center||UI).negate())}_getCenterInWorld({longitude:t,latitude:i}){const{meterOffset:r,distanceScales:s}=this,o=new So(this.projectPosition([t,i,0]));if(r){const a=new So(r).scale(s.unitsPerMeter);o.add(a)}return o}_initProjectionMatrix(t){const{projectionMatrix:i=null,orthographic:r=!1,fovyRadians:s,fovy:o=75,near:a=.1,far:l=1e3,focalDistance:c=1}=t;this.projectionMatrix=i||this._createProjectionMatrix({orthographic:r,fovyRadians:s||o*$le,aspect:this.width/this.height,focalDistance:c,near:a,far:l})}_initPixelMatrices(){const t=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];If(t,t,this.projectionMatrix),If(t,t,this.viewMatrix),this.viewProjectionMatrix=t,this.viewMatrixInverse=FI([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=function(n){return[n[12],n[13],n[14]]}(this.viewMatrixInverse);const i=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],r=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];SS(i,i,[this.width/2,-this.height/2,1]),ES(i,i,[1,-1,0]),If(r,i,this.viewProjectionMatrix),this.pixelProjectionMatrix=r,this.viewportMatrix=i,this.pixelUnprojectionMatrix=FI([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||Mi.warn("Pixel project matrix not invertible")()}}return n.displayName="Viewport",n})(),RU=(()=>{class n extends Yg{constructor(t={}){const{latitude:i=0,longitude:r=0,zoom:s=11,pitch:o=0,bearing:a=0,nearZMultiplier:l=.1,farZMultiplier:c=1.01,orthographic:u=!1,repeat:h=!1,worldOffset:f=0}=t;let{width:g,height:m,altitude:w=1.5}=t;const S=Math.pow(2,s);g=g||1,m=m||1,w=Math.max(.75,w);const{fov:U,aspect:D,focalDistance:ie,near:_e,far:Ne}=function({width:n,height:e,fovy:t=xU(1.5),altitude:i,pitch:r=0,nearZMultiplier:s=1,farZMultiplier:o=1}){void 0!==i&&(t=xU(i));const a=.5*t*lc,l=function(n){return.5/Math.tan(.5*n*lc)}(t),c=r*lc,u=Math.sin(a)*l/Math.sin(Math.min(Math.max(Math.PI/2-c-a,.01),Math.PI-.01));return{fov:2*a,aspect:n/e,focalDistance:l,near:s,far:(Math.sin(c)*u+l)*o}}({width:g,height:m,pitch:o,altitude:w,nearZMultiplier:l,farZMultiplier:c});let Pe=function({height:n,pitch:e,bearing:t,altitude:i,scale:r,center:s=null}){const o=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return ES(o,o,[0,0,-i]),aU(o,o,-e*lc),lU(o,o,t*lc),SS(o,o,[r/=n,r,r]),s&&ES(o,o,function(n,e){return n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n}([],s)),o}({height:m,pitch:o,bearing:a,scale:S,altitude:w});f&&(Pe=(new Gn).translate([512*f,0,0]).multiplyLeft(Pe)),super(wn(ot({},t),{width:g,height:m,viewMatrix:Pe,longitude:r,latitude:i,zoom:s,orthographic:u,fovyRadians:U,aspect:D,focalDistance:ie,near:_e,far:Ne})),this.latitude=i,this.longitude=r,this.zoom=s,this.pitch=o,this.bearing=a,this.altitude=w,this.orthographic=u,this._subViewports=h?[]:null,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const t=this.getBounds(),i=Math.floor((t[0]+180)/360),r=Math.ceil((t[2]-180)/360);for(let s=i;s<=r;s++){const o=s?new n(wn(ot({},this),{worldOffset:s})):this;this._subViewports.push(o)}}return this._subViewports}addMetersToLngLat(t,i){return EU(t,i)}panByPosition(t,i){const r=R0(i,this.pixelUnprojectionMatrix),o=CS([],this.projectFlat(t),gU([],r)),a=CS([],this.center,o),[l,c]=this.unprojectFlat(a);return{longitude:l,latitude:c}}getBounds(t={}){const i=function(n,e=0){const{width:t,height:i,unproject:r}=n,s={targetZ:e},o=r([0,i],s),a=r([t,i],s);let l,c;return(n.fovy?.5*n.fovy*TU:Math.atan(.5/n.altitude))>(90-n.pitch)*TU-.01?(l=AU(n,0,e),c=AU(n,t,e)):(l=r([0,0],s),c=r([t,0],s)),[o,a,c,l]}(this,t.z||0);return[Math.min(i[0][0],i[1][0],i[2][0],i[3][0]),Math.min(i[0][1],i[1][1],i[2][1],i[3][1]),Math.max(i[0][0],i[1][0],i[2][0],i[3][0]),Math.max(i[0][1],i[1][1],i[2][1],i[3][1])]}fitBounds(t,i={}){const{width:r,height:s}=this,{longitude:o,latitude:a,zoom:l}=function({width:n,height:e,bounds:t,minExtent:i=0,maxZoom:r=24,padding:s=0,offset:o=[0,0]}){const[[a,l],[c,u]]=t;Number.isFinite(s)?s={top:s,bottom:s,left:s,right:s}:Wu(Number.isFinite(s.top)&&Number.isFinite(s.bottom)&&Number.isFinite(s.left)&&Number.isFinite(s.right));const h=AS([a,bU(u,-TS,TS)]),f=AS([c,bU(l,-TS,TS)]),g=[Math.max(Math.abs(f[0]-h[0]),i),Math.max(Math.abs(f[1]-h[1]),i)],m=[n-s.left-s.right-2*Math.abs(o[0]),e-s.top-s.bottom-2*Math.abs(o[1])];Wu(m[0]>0&&m[1]>0);const w=m[0]/g[0],S=m[1]/g[1],_e=qg([(f[0]+h[0])/2+(s.right-s.left)/2/w,(f[1]+h[1])/2+(s.bottom-s.top)/2/S]),Ne=Math.min(r,LI(Math.abs(Math.min(w,S))));return Wu(Number.isFinite(Ne)),{longitude:_e[0],latitude:_e[1],zoom:Ne}}(ot({width:r,height:s,bounds:t},i));return new n({width:r,height:s,longitude:o,latitude:a,zoom:l})}}return n.displayName="WebMercatorViewport",n})();function zI(n,e,t=!1){const i=e.projectPosition(n);if(t&&e instanceof RU){const[r,s,o=0]=n,a=e.getDistanceScales([r,s]);i[2]=o*a.unitsPerMeter[2]}return i}function NU(n,{viewport:e,modelMatrix:t,coordinateSystem:i,coordinateOrigin:r,offsetMode:s}){let[o,a,l=0]=n;switch(t&&([o,a,l]=xS([],[o,a,l,1],t)),i){case Fi.LNGLAT:return zI([o,a,l],e,s);case Fi.LNGLAT_OFFSETS:return zI([o+r[0],a+r[1],l+(r[2]||0)],e,s);case Fi.METER_OFFSETS:return zI(EU(r,[o,a,l]),e,s);case Fi.CARTESIAN:default:return e.isGeospatial?[o+r[0],a+r[1],l+r[2]]:e.projectPosition([o,a,l])}}const Qle={10241:9987,10240:9729,10242:33071,10243:33071},HI={},ece={boolean:{validate:(n,e)=>!0,equal:(n,e,t)=>Boolean(n)===Boolean(e)},number:{validate:(n,e)=>Number.isFinite(n)&&(!("max"in e)||n<=e.max)&&(!("min"in e)||n>=e.min)},color:{validate:(n,e)=>e.optional&&!n||P0(n)&&(3===n.length||4===n.length),equal:(n,e,t)=>GI(n,e)},accessor:{validate(n,e){const t=MS(n);return"function"===t||t===MS(e.value)},equal:(n,e,t)=>"function"==typeof e||GI(n,e)},array:{validate:(n,e)=>e.optional&&!n||P0(n),equal:(n,e,t)=>t.compare?GI(n,e):n===e},function:{validate:(n,e)=>e.optional&&!n||"function"==typeof n,equal:(n,e,t)=>!t.compare||n===e},data:{transform:(n,e,t)=>{const{dataTransform:i}=t?t.props:{};return i&&n?i(n):n}},image:{transform:(n,e,t)=>function(n,e){const t=n.context&&n.context.gl;if(!t||!e)return null;if(e instanceof da)return e;e.constructor&&"Object"!==e.constructor.name&&(e={data:e});let i=null;e.compressed&&(i={10241:e.data.length>1?9985:9729});const r=new da(t,wn(ot({},e),{parameters:ot(ot(ot({},Qle),i),n.props.textureParameters)}));return HI[r.id]=!0,r}(t,n),release:n=>{!function(n){!n||!(n instanceof da)||HI[n.id]&&(n.delete(),delete HI[n.id])}(n)}}};function GI(n,e){if(n===e)return!0;if(!P0(n)||!P0(e))return!1;const t=n.length;if(t!==e.length)return!1;for(let i=0;i<t;i++)if(n[i]!==e[i])return!1;return!0}function nce(n,e){switch(MS(e)){case"object":return N0(n,e);case"array":return N0(n,{type:"array",value:e,compare:!1});case"boolean":return N0(n,{type:"boolean",value:e});case"number":return N0(n,{type:"number",value:e});case"function":return N0(n,{type:"function",value:e,compare:!0});default:return{name:n,type:"unknown",value:e}}}function N0(n,e){return"type"in e?ot(ot({name:n},ece[e.type]),e):"value"in e?ot({name:n,type:MS(e.value)},e):{name:n,type:"object",value:e}}function P0(n){return Array.isArray(n)||ArrayBuffer.isView(n)}function MS(n){return P0(n)?"array":null===n?"null":typeof n}const{COMPONENT:$I,ASYNC_ORIGINAL:DS,ASYNC_RESOLVED:F0,ASYNC_DEFAULTS:IS}=bS;function ice(){const n=this,e=PU(n.constructor),t=Object.create(e);t[$I]=n,t[DS]={},t[F0]={};for(let i=0;i<arguments.length;++i){const r=arguments[i];for(const s in r)t[s]=r[s]}return Object.freeze(t),t}function PU(n){return OS(n,"_mergedDefaultProps")||(function(n){if(!n.prototype)return;const t=Object.getPrototypeOf(n),i=PU(t),s=function(n){const e={},t={},i={};for(const[r,s]of Object.entries(n))if(s&&s.deprecatedFor)i[r]=Array.isArray(s.deprecatedFor)?s.deprecatedFor:[s.deprecatedFor];else{const o=nce(r,s);e[r]=o,t[r]=o.value}return{propTypes:e,defaultProps:t,deprecatedProps:i}}(OS(n,"defaultProps")||{}),o=function(n,e,t){const i=Object.create(null);Object.assign(i,e,n);const r=function(n){const e=OS(n,"layerName")||OS(n,"componentName");return e||Mi.once(0,"".concat(n.name,".componentName not specified"))(),e||n.name}(t);return delete n.id,Object.defineProperties(i,{id:{writable:!0,value:r}}),i}(s.defaultProps,i,n),a=ot(ot({},t._propTypes),s.propTypes);!function(n,e){const t={},i={};for(const r in e){const s=e[r],{name:o,value:a}=s;s.async&&(t[o]=a,i[o]=lce(o))}n[IS]=t,n[DS]={},Object.defineProperties(n,i)}(o,a);const l=ot(ot({},t._deprecatedProps),s.deprecatedProps);(function(n,e){for(const t in e)Object.defineProperty(n,t,{enumerable:!1,set(i){const r="".concat(this.id,": ").concat(t);for(const s of e[t])FU(this,s)||(this[s]=i);Mi.deprecated(r,e[t].join("/"))()}})})(o,l),n._mergedDefaultProps=o,n._propTypes=a,n._deprecatedProps=l}(n),n._mergedDefaultProps)}function lce(n){return{enumerable:!0,set(e){"string"==typeof e||e instanceof Promise||fj(e)?this[DS][n]=e:this[F0][n]=e},get(){if(this[F0]){if(n in this[F0])return this[F0][n]||this[IS][n];if(n in this[DS]){const e=this[$I]&&this[$I].internalState;if(e&&e.hasAsyncProp(n))return e.getAsyncProp(n)||this[IS][n]}}return this[IS][n]}}}function FU(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function OS(n,e){return FU(n,e)&&n[e]}function WI(n){var e;if("undefined"!=typeof Symbol&&(Symbol.asyncIterator&&(e=n[Symbol.asyncIterator]),null==e&&Symbol.iterator&&(e=n[Symbol.iterator])),null==e&&(e=n["@@asyncIterator"]),null==e&&(e=n["@@iterator"]),null==e)throw new TypeError("Object is not async iterable");return e.call(n)}const{ASYNC_ORIGINAL:uce,ASYNC_RESOLVED:dce,ASYNC_DEFAULTS:hce}=bS,fce=Object.freeze({});class LU{constructor(e=null){this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=fce,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const t=this.asyncProps[e];t.type&&t.type.release&&t.type.release(t.resolvedValue,t.type,this.component)}}getOldProps(){return this.oldAsyncProps||this.oldProps}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component.props}freezeAsyncOldProps(){if(!this.oldAsyncProps){this.oldProps=this.oldProps||this.component.props,this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const t=this.asyncProps[e];return t&&t.resolvedValue}isAsyncPropLoading(e){if(e){const t=this.asyncProps[e];return Boolean(t&&t.pendingLoadCount>0&&t.pendingLoadCount!==t.resolvedLoadCount)}for(const t in this.asyncProps)if(this.isAsyncPropLoading(t))return!0;return!1}reloadAsyncProp(e,t){this._watchPromise(e,Promise.resolve(t))}setAsyncProps(e){const t=e[dce]||{},i=e[uce]||e,r=e[hce]||{};for(const s in t){const o=t[s];this._createAsyncPropData(s,r[s]),this._updateAsyncProp(s,o),t[s]=this.getAsyncProp(s)}for(const s in i){const o=i[s];this._createAsyncPropData(s,r[s]),this._updateAsyncProp(s,o)}}_updateAsyncProp(e,t){if(this._didAsyncInputValueChange(e,t)){if("string"==typeof t){var i;const r=null===(i=this.layer)||void 0===i?void 0:i.props.fetch;r&&(t=r(t,{propName:e,layer:this.layer}))}if(t instanceof Promise)return void this._watchPromise(e,t);if(fj(t))return void this._resolveAsyncIterable(e,t);this._setPropValue(e,t)}}_didAsyncInputValueChange(e,t){const i=this.asyncProps[e];return t!==i.resolvedValue&&t!==i.lastValue&&(i.lastValue=t,!0)}_setPropValue(e,t){const i=this.asyncProps[e];t=this._postProcessValue(i,t),i.resolvedValue=t,i.pendingLoadCount++,i.resolvedLoadCount=i.pendingLoadCount}_setAsyncPropValue(e,t,i){const r=this.asyncProps[e];r&&i>=r.resolvedLoadCount&&void 0!==t&&(this.freezeAsyncOldProps(),r.resolvedValue=t,r.resolvedLoadCount=i,this.onAsyncPropUpdated(e,t))}_watchPromise(e,t){const i=this.asyncProps[e];i.pendingLoadCount++;const r=i.pendingLoadCount;t.then(s=>{var o;s=this._postProcessValue(i,s),this._setAsyncPropValue(e,s,r);const a=null===(o=this.layer)||void 0===o?void 0:o.props.onDataLoad;"data"===e&&a&&a(s,{propName:e,layer:this.layer})}).catch(s=>{var o;null===(o=this.layer)||void 0===o||o.raiseError(s,"loading ".concat(e," of ").concat(this.layer))})}_resolveAsyncIterable(e,t){var i=this;return ni(function*(){var r;"data"!==e&&i._setPropValue(e,t);const s=i.asyncProps[e];s.pendingLoadCount++;const o=s.pendingLoadCount;let a=[],l=0;var h,c=!0,u=!1;try{for(var g,m,f=WI(t);c=(g=yield f.next()).done,m=yield g.value,!c;c=!0){const S=m,{dataTransform:U}=i.component?i.component.props:{};a=U?U(S,a):a.concat(S),Object.defineProperty(a,"__diff",{enumerable:!1,value:[{startRow:l,endRow:a.length}]}),l=a.length,i._setAsyncPropValue(e,a,o)}}catch(S){u=!0,h=S}finally{try{!c&&null!=f.return&&(yield f.return())}finally{if(u)throw h}}const w=null===(r=i.layer)||void 0===r?void 0:r.props.onDataLoad;w&&w(a,{propName:e,layer:i.layer})})()}_postProcessValue(e,t){const i=e.type;return i&&(i.release&&i.release(e.resolvedValue,i,this.component),i.transform)?i.transform(t,i,this.component):t}_createAsyncPropData(e,t){if(!this.asyncProps[e]){const r=this.component&&this.component.constructor._propTypes;this.asyncProps[e]={type:r&&r[e],lastValue:null,resolvedValue:t,pendingLoadCount:0,resolvedLoadCount:0}}}}const{ASYNC_ORIGINAL:kU,ASYNC_RESOLVED:BU,ASYNC_DEFAULTS:pce}=bS,gce={};let mce=0,_ce=(()=>{class n{constructor(){this.props=ice.apply(this,arguments),this.id=this.props.id,this.count=mce++,this.lifecycle="Awaiting state",this.parent=null,this.context=null,this.state=null,this.internalState=null,Object.seal(this)}clone(t){const{props:i}=this,r={};for(const s in i[pce])s in i[BU]?r[s]=i[BU][s]:s in i[kU]&&(r[s]=i[kU][s]);return new this.constructor(ot(ot(ot({},i),r),t))}get stats(){return this.internalState.stats}_initState(){this.internalState=new LU({})}}return n.componentName="Component",n.defaultProps=gce,n})();class yce extends LU{constructor({attributeManager:e,layer:t}){super(t),this.attributeManager=e,this.model=null,this.needsRedraw=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}set layer(e){this.component=e}}const cc=n=>"function"==typeof n,ah=n=>null!==n&&"object"==typeof n,jU=n=>ah(n)&&n.constructor==={}.constructor,vce=n=>n&&"function"==typeof n[Symbol.iterator],bce=n=>n&&"function"==typeof n[Symbol.asyncIterator],L0=n=>"undefined"!=typeof Response&&n instanceof Response||n&&n.arrayBuffer&&n.text&&n.json,Kg=n=>"undefined"!=typeof Blob&&n instanceof Blob,UU=n=>(n=>"undefined"!=typeof ReadableStream&&n instanceof ReadableStream||ah(n)&&cc(n.tee)&&cc(n.cancel)&&cc(n.getReader))(n)||(n=>ah(n)&&cc(n.read)&&cc(n.pipe)&&(n=>"boolean"==typeof n)(n.readable))(n);function Of(n,e){if(!n)throw new Error(e||"loader assertion failed.")}function qI(n){var e;return!!n&&(Array.isArray(n)&&(n=n[0]),Array.isArray(null===(e=n)||void 0===e?void 0:e.extensions))}function YI(n){var e,t;let i;return Of(n,"null loader"),Of(qI(n),"invalid loader"),Array.isArray(n)&&(i=n[1],n=wn(ot({},n=n[0]),{options:ot(ot({},n.options),i)})),(null!==(e=n)&&void 0!==e&&e.parseTextSync||null!==(t=n)&&void 0!==t&&t.parseText)&&(n.text=!0),n.text||(n.binary=!0),n}const Kc={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document},KI=Kc.global||Kc.self||Kc.window||{},Tce="object"!=typeof process||"[object process]"!==String(process)||process.browser,zU="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version);zU&&parseFloat(zU[1]);const QI={};function Ace(n){for(const e in QI)n.startsWith(e)&&(n=n.replace(e,QI[e]));return!n.startsWith("http://")&&!n.startsWith("https://")&&(n=`${n}`),n}const Mce=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,Dce=/^([-\w.]+\/[-\w.+]+)/;function Ice(n){const e=Dce.exec(n);return e?e[1]:n}function HU(n){const e=Mce.exec(n);return e?e[1]:""}const Oce=/\?.*/;function RS(n){if(L0(n)){const e=ZI(n.url||"");return{url:e,type:Ice(n.headers.get("content-type")||"")||HU(e)}}return Kg(n)?{url:ZI(n.name||""),type:n.type||""}:"string"==typeof n?{url:ZI(n),type:HU(n)}:{url:"",type:""}}function Rce(n){return L0(n)?n.headers["content-length"]||-1:Kg(n)?n.size:"string"==typeof n?n.length:n instanceof ArrayBuffer||ArrayBuffer.isView(n)?n.byteLength:-1}function ZI(n){return n.replace(Oce,"")}function GU(n){return JI.apply(this,arguments)}function JI(){return(JI=ni(function*(n){if(L0(n))return n;const e={},t=Rce(n);t>=0&&(e["content-length"]=String(t));const{url:i,type:r}=RS(n);r&&(e["content-type"]=r);const s=yield Fce(n);s&&(e["x-first-bytes"]=s),"string"==typeof n&&(n=(new TextEncoder).encode(n));const o=new Response(n,{headers:e});return Object.defineProperty(o,"url",{value:i}),o})).apply(this,arguments)}function Nce(n){return eO.apply(this,arguments)}function eO(){return(eO=ni(function*(n){if(!n.ok){const e=yield Pce(n);throw new Error(e)}})).apply(this,arguments)}function Pce(n){return tO.apply(this,arguments)}function tO(){return(tO=ni(function*(n){let e=`Failed to fetch resource ${n.url} (${n.status}): `;try{const t=n.headers.get("Content-Type");let i=n.statusText;t.includes("application/json")&&(i+=` ${yield n.text()}`),e+=i,e=e.length>60?`${e.slice(60)}...`:e}catch(t){}return e})).apply(this,arguments)}function Fce(n){return nO.apply(this,arguments)}function nO(){return(nO=ni(function*(n){if("string"==typeof n)return`data:,${n.slice(0,5)}`;if(n instanceof Blob){const t=n.slice(0,5);return yield new Promise(i=>{const r=new FileReader;r.onload=s=>{var o;return i(null==s||null===(o=s.target)||void 0===o?void 0:o.result)},r.readAsDataURL(t)})}return n instanceof ArrayBuffer?`data:base64,${Lce(n.slice(0,5))}`:null})).apply(this,arguments)}function Lce(n){let e="";const t=new Uint8Array(n);for(let i=0;i<t.byteLength;i++)e+=String.fromCharCode(t[i]);return btoa(e)}function $U(n,e){return iO.apply(this,arguments)}function iO(){return(iO=ni(function*(n,e){if("string"==typeof n){n=Ace(n);let t=e;return null!=e&&e.fetch&&"function"!=typeof(null==e?void 0:e.fetch)&&(t=e.fetch),yield fetch(n,t)}return yield GU(n)})).apply(this,arguments)}function qn(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}const WU=new $D({id:"loaders.gl"});class kce{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}const qU={fetch:null,mimeType:void 0,nothrow:!1,log:new class{constructor(){qn(this,"console",void 0),this.console=console}log(...e){return this.console.log.bind(this.console,...e)}info(...e){return this.console.info.bind(this.console,...e)}warn(...e){return this.console.warn.bind(this.console,...e)}error(...e){return this.console.error.bind(this.console,...e)}},CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},Vce={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function rO(){KI.loaders=KI.loaders||{};const{loaders:n}=KI;return n._state=n._state||{},n._state}const sO=()=>{const n=rO();return n.globalOptions=n.globalOptions||ot({},qU),n.globalOptions};function jce(n,e,t,i){return t=t||[],function(n,e){KU(n,null,qU,Vce,e);for(const t of e)KU(n&&n[t.id]||{},t.id,t.options&&t.options[t.id]||{},t.deprecatedOptions&&t.deprecatedOptions[t.id]||{},e)}(n,t=Array.isArray(t)?t:[t]),function(n,e,t){const r=ot({},n.options||{});return function(n,e){e&&!("baseUri"in n)&&(n.baseUri=e)}(r,t),null===r.log&&(r.log=new kce),QU(r,sO()),QU(r,e),r}(e,n,i)}function YU(n,e){const t=sO(),i=n||t;return"function"==typeof i.fetch?i.fetch:ah(i.fetch)?r=>$U(r,i):null!=e&&e.fetch?null==e?void 0:e.fetch:$U}function KU(n,e,t,i,r){const s=e||"Top level",o=e?`${e}.`:"";for(const a in n){const l=!e&&ah(n[a]),c="baseUri"===a&&!e,u="workerUrl"===a&&e;if(!(a in t)&&!c&&!u)if(a in i)WU.warn(`${s} loader option '${o}${a}' no longer supported, use '${i[a]}'`)();else if(!l){const h=zce(a,r);WU.warn(`${s} loader option '${o}${a}' not recognized. ${h}`)()}}}function zce(n,e){const t=n.toLowerCase();let i="";for(const r of e)for(const s in r.options){if(n===s)return`Did you mean '${r.id}.${s}'?`;const o=s.toLowerCase();(t.startsWith(o)||o.startsWith(t))&&(i=i||`Did you mean '${r.id}.${s}'?`)}return i}function QU(n,e){for(const t in e)t in e&&(n[t]=jU(e[t])&&jU(n[t])?ot(ot({},n[t]),e[t]):e[t])}function Xc(n,e){if(!n)throw new Error(e||"loaders.gl assertion failed.")}function $ce(n,e="3.0.12"){return Xc(n,"no worker provided"),!(!e||!n.version)}const Qc={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document},Wce=Qc.global||Qc.self||Qc.window||{},oO="object"!=typeof process||"[object process]"!==String(process)||process.browser,aO="function"==typeof importScripts,qce="undefined"!=typeof window&&void 0!==window.orientation,ZU="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version),lO=(ZU&&parseFloat(ZU[1]),new Map);function JU(n){const e=new Blob([n],{type:"application/javascript"});return URL.createObjectURL(e)}function ez(n,e=!0,t){const i=t||new Set;if(n)if(tz(n))i.add(n);else if(tz(n.buffer))i.add(n.buffer);else if(!ArrayBuffer.isView(n)&&e&&"object"==typeof n)for(const r in n)ez(n[r],e,i);return void 0===t?Array.from(i):[]}function tz(n){return!!n&&(n instanceof ArrayBuffer||"undefined"!=typeof MessagePort&&n instanceof MessagePort||"undefined"!=typeof ImageBitmap&&n instanceof ImageBitmap||"undefined"!=typeof OffscreenCanvas&&n instanceof OffscreenCanvas)}const cO=()=>{};class nz{static isSupported(){return"undefined"!=typeof Worker}constructor(e){qn(this,"name",void 0),qn(this,"source",void 0),qn(this,"url",void 0),qn(this,"terminated",!1),qn(this,"worker",void 0),qn(this,"onMessage",void 0),qn(this,"onError",void 0),qn(this,"_loadableURL","");const{name:t,source:i,url:r}=e;Xc(i||r),this.name=t,this.source=i,this.url=r,this.onMessage=cO,this.onError=s=>console.log(s),this.worker=this._createBrowserWorker()}destroy(){this.onMessage=cO,this.onError=cO,this.worker.terminate(),this.terminated=!0}get isRunning(){return Boolean(this.onMessage)}postMessage(e,t){t=t||ez(e),this.worker.postMessage(e,t)}_getErrorFromErrorEvent(e){let t="Failed to load ";return t+=`worker ${this.name}. `,e.message&&(t+=`${e.message} in `),e.lineno&&(t+=`:${e.lineno}:${e.colno}`),new Error(t)}_createBrowserWorker(){this._loadableURL=function(n){Xc(n.source&&!n.url||!n.source&&n.url);let e=lO.get(n.source||n.url);return e||(n.url&&(e=function(n){return n.startsWith("http")?JU(function(n){return`try {\n  importScripts('${n}');\n} catch (error) {\n  console.error(error);\n  throw error;\n}`}(n)):n}(n.url),lO.set(n.url,e)),n.source&&(e=JU(n.source),lO.set(n.source,e))),Xc(e),e}({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=t=>{t.data?this.onMessage(t.data):this.onError(new Error("No data received"))},e.onerror=t=>{this.onError(this._getErrorFromErrorEvent(t)),this.terminated=!0},e.onmessageerror=t=>console.error(t),e}}class Qce{constructor(e,t){qn(this,"name",void 0),qn(this,"workerThread",void 0),qn(this,"isRunning",void 0),qn(this,"result",void 0),qn(this,"_resolve",void 0),qn(this,"_reject",void 0),this.name=e,this.workerThread=t,this.isRunning=!0,this._resolve=()=>{},this._reject=()=>{},this.result=new Promise((i,r)=>{this._resolve=i,this._reject=r})}postMessage(e,t){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:t})}done(e){Xc(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){Xc(this.isRunning),this.isRunning=!1,this._reject(e)}}class Zce{constructor(e){qn(this,"name","unnamed"),qn(this,"source",void 0),qn(this,"url",void 0),qn(this,"maxConcurrency",1),qn(this,"maxMobileConcurrency",1),qn(this,"onDebug",()=>{}),qn(this,"reuseWorkers",!0),qn(this,"props",{}),qn(this,"jobQueue",[]),qn(this,"idleQueue",[]),qn(this,"count",0),qn(this,"isDestroyed",!1),this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props=ot(ot({},this.props),e),void 0!==e.name&&(this.name=e.name),void 0!==e.maxConcurrency&&(this.maxConcurrency=e.maxConcurrency),void 0!==e.maxMobileConcurrency&&(this.maxMobileConcurrency=e.maxMobileConcurrency),void 0!==e.reuseWorkers&&(this.reuseWorkers=e.reuseWorkers),void 0!==e.onDebug&&(this.onDebug=e.onDebug)}startJob(e,t=((r,s,o)=>r.done(o)),i=((r,s)=>r.error(s))){var r=this;return ni(function*(){const s=new Promise(o=>(r.jobQueue.push({name:e,onMessage:t,onError:i,onStart:o}),r));return r._startQueuedJob(),yield s})()}_startQueuedJob(){var e=this;return ni(function*(){if(!e.jobQueue.length)return;const t=e._getAvailableWorker();if(!t)return;const i=e.jobQueue.shift();if(i){e.onDebug({message:"Starting job",name:i.name,workerThread:t,backlog:e.jobQueue.length});const r=new Qce(i.name,t);t.onMessage=s=>i.onMessage(r,s.type,s.payload),t.onError=s=>i.onError(r,s),i.onStart(r);try{yield r.result}finally{e.returnWorkerToQueue(t)}}})()}returnWorkerToQueue(e){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e=`${this.name.toLowerCase()} (#${this.count} of ${this.maxConcurrency})`;return new nz({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return qce?this.maxMobileConcurrency:this.maxConcurrency}}const Jce={maxConcurrency:3,maxMobileConcurrency:1,onDebug:()=>{},reuseWorkers:!0};class qu{static isSupported(){return nz.isSupported()}static getWorkerFarm(e={}){return qu._workerFarm=qu._workerFarm||new qu({}),qu._workerFarm.setProps(e),qu._workerFarm}constructor(e){qn(this,"props",void 0),qn(this,"workerPools",new Map),this.props=ot({},Jce),this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy()}setProps(e){this.props=ot(ot({},this.props),e);for(const t of this.workerPools.values())t.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:t,source:i,url:r}=e;let s=this.workerPools.get(t);return s||(s=new Zce({name:t,source:i,url:r}),s.setProps(this._getWorkerPoolProps()),this.workerPools.set(t,s)),s}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}function tue(n,e={}){const i=`${n.id}-worker.js`;let r=(e[n.id]||{}).workerUrl;if("test"===e._workerType&&(r=`modules/${n.module}/dist/${i}`),!r){let s=n.version;"latest"===s&&(s="latest"),r=`https://unpkg.com/@loaders.gl/${n.module}${s?`@${s}`:""}/dist/${i}`}return Xc(r),r}function nue(n,e){return!!qu.isSupported()&&n.worker&&(null==e?void 0:e.worker)}function iue(n,e,t,i,r){return uO.apply(this,arguments)}function uO(){return(uO=ni(function*(n,e,t,i,r){const s=n.id,o=tue(n,t),l=qu.getWorkerFarm(t).getWorkerPool({name:s,url:o});t=JSON.parse(JSON.stringify(t));const c=yield l.startJob("process-on-worker",rue.bind(null,r));return c.postMessage("process",{input:e,options:t}),yield(yield c.result).result})).apply(this,arguments)}function rue(n,e,t,i){return dO.apply(this,arguments)}function dO(){return(dO=ni(function*(n,e,t,i){switch(t){case"done":e.done(i);break;case"error":e.error(i.error);break;case"process":const{id:r,input:s,options:o}=i;try{const a=yield n(s,o);e.postMessage("done",{id:r,result:a})}catch(a){const l=a instanceof Error?a.message:"unknown error";e.postMessage("error",{id:r,error:l})}break;default:console.warn(`parse-with-worker unknown message ${t}`)}})).apply(this,arguments)}qn(qu,"_workerFarm",void 0);var rz=et(9521);function sz(n){if(function(n){return n&&"object"==typeof n&&n.isBuffer}(n)&&(n=function(n){return rz.toArrayBuffer?rz.toArrayBuffer(n):n}(n)),n instanceof ArrayBuffer)return n;if(ArrayBuffer.isView(n))return 0===n.byteOffset&&n.byteLength===n.buffer.byteLength?n.buffer:n.buffer.slice(n.byteOffset,n.byteOffset+n.byteLength);if("string"==typeof n){const e=n;return(new TextEncoder).encode(e).buffer}if(n&&"object"==typeof n&&n._toArrayBuffer)return n._toArrayBuffer();throw new Error("toArrayBuffer")}function lue(...n){const e=n.map(s=>s instanceof ArrayBuffer?new Uint8Array(s):s),t=e.reduce((s,o)=>s+o.byteLength,0),i=new Uint8Array(t);let r=0;for(const s of e)i.set(s,r),r+=s.byteLength;return i.buffer}function oz(n,e,t){const i=void 0!==t?new Uint8Array(n).subarray(e,e+t):new Uint8Array(n).subarray(e);return new Uint8Array(i).buffer}function cue(n){return fO.apply(this,arguments)}function fO(){return(fO=ni(function*(n){const e=[];var r,t=!0,i=!1;try{for(var o,a,s=WI(n);t=(o=yield s.next()).done,a=yield o.value,!t;t=!0)e.push(a)}catch(l){i=!0,r=l}finally{try{!t&&null!=s.return&&(yield s.return())}finally{if(i)throw r}}return lue(...e)})).apply(this,arguments)}const hue=262144;function az(n){this.wrapped=n}function k0(n){return new az(n)}function B0(n){var e,t;function r(o,a){try{var l=n[o](a),c=l.value,u=c instanceof az;Promise.resolve(u?c.wrapped:c).then(function(h){u?r("return"===o?"return":"next",h):s(l.done?"return":"normal",h)},function(h){r("throw",h)})}catch(h){s("throw",h)}}function s(o,a){switch(o){case"return":e.resolve({value:a,done:!0});break;case"throw":e.reject(a);break;default:e.resolve({value:a,done:!1})}(e=e.next)?r(e.key,e.arg):t=null}this._invoke=function(o,a){return new Promise(function(l,c){var u={key:o,arg:a,resolve:l,reject:c,next:null};t?t=t.next=u:(e=t=u,r(o,a))})},"function"!=typeof n.return&&(this.return=void 0)}function gO(n){return function(){return new B0(n.apply(this,arguments))}}function mO(){return(mO=gO(function*(n,e){const t=(null==e?void 0:e.chunkSize)||1048576;let i=0;for(;i<n.size;){const r=i+t,s=yield k0(n.slice(i,r).arrayBuffer());i=r,yield s}})).apply(this,arguments)}function lz(n,e){return Tce?function(n,e){return _O.apply(this,arguments)}(n,e):function(n,e){return yO.apply(this,arguments)}(n,e)}function _O(){return(_O=gO(function*(n,e){const t=n.getReader();let i;try{for(;;){const r=i||t.read();null!=e&&e._streamReadAhead&&(i=t.read());const{done:s,value:o}=yield k0(r);if(s)return;yield sz(o)}}catch(r){t.releaseLock()}})).apply(this,arguments)}function yO(){return(yO=gO(function*(n,e){var r,t=!0,i=!1;try{for(var o,a,s=WI(n);t=(o=yield k0(s.next())).done,a=yield k0(o.value),!t;t=!0)yield sz(a)}catch(l){i=!0,r=l}finally{try{!t&&null!=s.return&&(yield k0(s.return()))}finally{if(i)throw r}}})).apply(this,arguments)}function yue(n,e){if("string"==typeof n)return function*(n,e){const t=(null==e?void 0:e.chunkSize)||262144;let i=0;const r=new TextEncoder;for(;i<n.length;){const s=Math.min(n.length-i,t),o=n.slice(i,i+s);i+=s,yield r.encode(o)}}(n,e);if(n instanceof ArrayBuffer)return function*(n,e={}){const{chunkSize:t=hue}=e;let i=0;for(;i<n.byteLength;){const r=Math.min(n.byteLength-i,t),s=new ArrayBuffer(r),o=new Uint8Array(n,i,r);new Uint8Array(s).set(o),i+=r,yield s}}(n,e);if(Kg(n))return function(n,e){return mO.apply(this,arguments)}(n,e);if(UU(n))return lz(n,e);if(L0(n))return lz(n.body,e);throw new Error("makeIterator")}B0.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},B0.prototype.next=function(n){return this._invoke("next",n)},B0.prototype.throw=function(n){return this._invoke("throw",n)},B0.prototype.return=function(n){return this._invoke("return",n)};const vO="Cannot convert supplied data type";function vue(n,e,t){if(e.text&&"string"==typeof n)return n;if((n=>n&&"object"==typeof n&&n.isBuffer)(n)&&(n=n.buffer),n instanceof ArrayBuffer){const i=n;return e.text&&!e.binary?new TextDecoder("utf8").decode(i):i}if(ArrayBuffer.isView(n)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(n);let i=n.buffer;const r=n.byteLength||n.length;return(0!==n.byteOffset||r!==i.byteLength)&&(i=i.slice(n.byteOffset,n.byteOffset+r)),i}throw new Error(vO)}function bue(n,e,t){return bO.apply(this,arguments)}function bO(){return(bO=ni(function*(n,e,t){const i=n instanceof ArrayBuffer||ArrayBuffer.isView(n);if("string"==typeof n||i)return vue(n,e);if(Kg(n)&&(n=yield GU(n)),L0(n)){const r=n;return yield Nce(r),e.binary?yield r.arrayBuffer():yield r.text()}if(UU(n)&&(n=yue(n,t)),vce(n)||bce(n))return cue(n);throw new Error(vO)})).apply(this,arguments)}function Eue(n,e,t=null){if(t)return t;const i=ot({fetch:YU(e,n)},n);return Array.isArray(i.loaders)||(i.loaders=null),i}function Sue(n,e){if(!e&&n&&!Array.isArray(n))return n;let t;if(n&&(t=Array.isArray(n)?n:[n]),e&&e.loaders){const i=Array.isArray(e.loaders)?e.loaders:[e.loaders];t=t?[...t,...i]:i}return t&&t.length?t:null}const cz=()=>{const n=rO();return n.loaderRegistry=n.loaderRegistry||[],n.loaderRegistry};function uz(n){const e=cz();n=Array.isArray(n)?n:[n];for(const t of n){const i=YI(t);e.find(r=>i===r)||e.unshift(i)}}const Cue=/\.([^.]+)$/;function Tue(n){return SO.apply(this,arguments)}function SO(){return(SO=ni(function*(n,e=[],t,i){if(!hz(n))return null;let r=dz(n,e,wn(ot({},t),{nothrow:!0}),i);if(r)return r;if(Kg(n)&&(r=dz(n=yield n.slice(0,10).arrayBuffer(),e,t,i)),!(r||null!=t&&t.nothrow))throw new Error(fz(n));return r})).apply(this,arguments)}function dz(n,e=[],t,i){if(!hz(n))return null;if(e&&!Array.isArray(e))return YI(e);let r=[];e&&(r=r.concat(e)),null!=t&&t.ignoreRegisteredLoaders||r.push(...cz()),function(n){for(const e of n)YI(e)}(r);const s=function(n,e,t,i){const{url:r,type:s}=RS(n),o=r||(null==i?void 0:i.url);let a=null;return null!=t&&t.mimeType&&(a=xO(e,null==t?void 0:t.mimeType)),a=a||function(n,e){const t=e&&Cue.exec(e),i=t&&t[1];return i?function(n,e){e=e.toLowerCase();for(const t of n)for(const i of t.extensions)if(i.toLowerCase()===e)return t;return null}(n,i):null}(e,o),a=a||xO(e,s),a=a||function(n,e){if(!e)return null;for(const t of n)if("string"==typeof e){if(Rue(e,t))return t}else if(ArrayBuffer.isView(e)){if(pz(e.buffer,e.byteOffset,t))return t}else if(e instanceof ArrayBuffer&&pz(e,0,t))return t;return null}(e,n),a=a||xO(e,null==t?void 0:t.fallbackMimeType),a}(n,r,t,i);if(!(s||null!=t&&t.nothrow))throw new Error(fz(n));return s}function hz(n){return!(n instanceof Response&&204===n.status)}function fz(n){const{url:e,type:t}=RS(n);let i="No valid loader found";return n&&(i+=` data: "${function(n,e=5){return"string"==typeof n?n.slice(0,e):ArrayBuffer.isView(n)?CO(n.buffer,n.byteOffset,e):n instanceof ArrayBuffer?CO(n,0,e):""}(n)}", contentType: "${t}"`),e&&(i+=` url: ${e}`),i}function xO(n,e){for(const t of n)if(t.mimeTypes&&t.mimeTypes.includes(e)||e===`application/x.${t.id}`)return t;return null}function Rue(n,e){return e.testText?e.testText(n):(Array.isArray(e.tests)?e.tests:[e.tests]).some(i=>n.startsWith(i))}function pz(n,e,t){return(Array.isArray(t.tests)?t.tests:[t.tests]).some(r=>function(n,e,t,i){if(i instanceof ArrayBuffer)return function(n,e,t){if(n.byteLength<(t=t||n.byteLength)||e.byteLength<t)return!1;const i=new Uint8Array(n),r=new Uint8Array(e);for(let s=0;s<i.length;++s)if(i[s]!==r[s])return!1;return!0}(i,n,i.byteLength);switch(typeof i){case"function":return i(n,t);case"string":return i===CO(n,e,i.length);default:return!1}}(n,e,t,r))}function CO(n,e,t){if(n.byteLength<e+t)return"";const i=new DataView(n);let r="";for(let s=0;s<t;s++)r+=String.fromCharCode(i.getUint8(e+s));return r}function NS(n,e,t,i){return TO.apply(this,arguments)}function TO(){return(TO=ni(function*(n,e,t,i){Xc(!i||"object"==typeof i),e&&!Array.isArray(e)&&!qI(e)&&(i=void 0,t=e,e=void 0),n=yield n,t=t||{};const{url:r}=RS(n),o=Sue(e,i),a=yield Tue(n,o,t);return a?(i=Eue({url:r,parse:NS,loaders:o},t=jce(t,a,o,r),i),yield Fue(a,n,t,i)):null})).apply(this,arguments)}function Fue(n,e,t,i){return AO.apply(this,arguments)}function AO(){return(AO=ni(function*(n,e,t,i){if($ce(n),e=yield bue(e,n,t),n.parseTextSync&&"string"==typeof e)return t.dataType="text",n.parseTextSync(e,t,i,n);if(nue(n,t))return yield iue(n,e,t,i,NS);if(n.parseText&&"string"==typeof e)return yield n.parseText(e,t,i,n);if(n.parse)return yield n.parse(e,t,i,n);throw Xc(!n.parseSync),new Error(`${n.id} loader - no parser found and worker is disabled`)})).apply(this,arguments)}function V0(n,e,t,i){return MO.apply(this,arguments)}function MO(){return(MO=ni(function*(n,e,t,i){!Array.isArray(e)&&!qI(e)&&(t=e,e=void 0);const r=YU(t);let s=n;return"string"==typeof n&&(s=yield r(n)),Kg(n)&&(s=yield r(n)),yield NS(s,e,t)})).apply(this,arguments)}const gz=_r(2,24)-1,Uue=Object.freeze([]),zue=wS(({oldViewport:n,viewport:e})=>n.equals(e));let Zc=new Uint8ClampedArray(0);const Hue={data:{type:"data",value:Uue,async:!0},dataComparator:null,_dataDiff:{type:"function",value:n=>n&&n.__diff,compare:!1,optional:!0},dataTransform:{type:"function",value:null,compare:!1,optional:!0},onDataLoad:{type:"function",value:null,compare:!1,optional:!0},onError:{type:"function",value:null,compare:!1,optional:!0},fetch:{type:"function",value:(n,{propName:e,layer:t,loaders:i,loadOptions:r,signal:s})=>{const{resourceManager:o}=t.context;var a;r=r||t.getLoadOptions(),i=i||t.props.loaders,s&&(r=wn(ot({},r),{fetch:wn(ot({},null===(a=r)||void 0===a?void 0:a.fetch),{signal:s})}));let l=o.contains(n);return!l&&!r&&(o.add({resourceId:n,data:V0(n,i),persistent:!1}),l=!0),l?o.subscribe({resourceId:n,onChange:c=>t.internalState.reloadAsyncProp(e,c),consumerId:t.id,requestId:e}):V0(n,i,r)},compare:!1},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},onHover:{type:"function",value:null,compare:!1,optional:!0},onClick:{type:"function",value:null,compare:!1,optional:!0},onDragStart:{type:"function",value:null,compare:!1,optional:!0},onDrag:{type:"function",value:null,compare:!1,optional:!0},onDragEnd:{type:"function",value:null,compare:!1,optional:!0},coordinateSystem:Fi.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,compare:!0},getPolygonOffset:{type:"function",value:({layerIndex:n})=>[0,100*-n],compare:!1},highlightedObjectIndex:-1,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};let j0=(()=>{class n extends _ce{toString(){return"".concat(this.constructor.layerName||this.constructor.name,"({id: '").concat(this.props.id,"'})")}raiseError(t,i){var r,s,o,a;i&&(t.message="".concat(i,": ").concat(t.message)),(null===(r=(s=this.props).onError)||void 0===r?void 0:r.call(s,t))||null===(o=this.context)||void 0===o||null===(a=o.onError)||void 0===a||a.call(o,t,this)}setState(t){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,t),this.setNeedsRedraw()}setNeedsRedraw(t=!0){this.internalState&&(this.internalState.needsRedraw=t)}setNeedsUpdate(){this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0}getNeedsRedraw(t={clearRedrawFlags:!1}){return this._getNeedsRedraw(t)}needsUpdate(){return this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams())}hasUniformTransition(){return this.internalState.uniformTransitions.active}get isLoaded(){return this.internalState&&!this.internalState.isAsyncPropLoading()}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||(this.state.model?[this.state.model]:[]))}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}project(t){const{viewport:i}=this.context,r=NU(t,{viewport:i,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[s,o,a]=CU(r,i.pixelProjectionMatrix);return 2===t.length?[s,o]:[s,o,a]}unproject(t){const{viewport:i}=this.context;return i.unproject(t)}projectPosition(t){return function(n,e){const{viewport:t,coordinateSystem:i,coordinateOrigin:r,modelMatrix:s,fromCoordinateSystem:o,fromCoordinateOrigin:a}=function(n){const e=ot({},n);let{coordinateSystem:t}=n;const{viewport:i,coordinateOrigin:r,fromCoordinateSystem:s,fromCoordinateOrigin:o}=n;return t===Fi.DEFAULT&&(t=i.isGeospatial?Fi.LNGLAT:Fi.CARTESIAN),void 0===s&&(e.fromCoordinateSystem=t),void 0===o&&(e.fromCoordinateOrigin=r),e.coordinateSystem=t,e}(e),{geospatialOrigin:l,shaderCoordinateOrigin:c,offsetMode:u}=fU(t,i,r),h=NU(n,{viewport:t,modelMatrix:s,coordinateSystem:o,coordinateOrigin:a,offsetMode:u});u&&function(n,e,t){n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2]}(h,h,t.projectPosition(l||c));return h}(t,{viewport:this.context.viewport,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem})}use64bitPositions(){const{coordinateSystem:t}=this.props;return t===Fi.DEFAULT||t===Fi.LNGLAT||t===Fi.CARTESIAN}onHover(t,i){return!!this.props.onHover&&this.props.onHover(t,i)}onClick(t,i){return!!this.props.onClick&&this.props.onClick(t,i)}nullPickingColor(){return[0,0,0]}encodePickingColor(t,i=[]){return i[0]=t+1&255,i[1]=t+1>>8&255,i[2]=t+1>>8>>8&255,i}decodePickingColor(t){oc(t instanceof Uint8Array);const[i,r,s]=t;return i+256*r+65536*s-1}initializeState(){throw new Error("Layer ".concat(this," has not defined initializeState"))}getShaders(t){for(const i of this.props.extensions)t=Qae(t,i.getShaders.call(this,i));return t}shouldUpdateState({changeFlags:s}){return s.propsOrDataChanged}updateState({oldProps:t,props:i,changeFlags:s}){const o=this.getAttributeManager();if(s.dataChanged&&o){const{dataChanged:c}=s;if(Array.isArray(c))for(const u of c)o.invalidateAll(u);else o.invalidateAll()}const l=i.highlightedObjectIndex>=0||i.pickable;if((t.highlightedObjectIndex>=0||t.pickable)!==l&&o){const{pickingColors:c,instancePickingColors:u}=o.attributes,h=c||u;h&&(l&&h.constant&&(h.constant=!1,o.invalidate(h.id)),!h.value&&!l&&(h.constant=!0,h.value=[0,0,0]))}}finalizeState(){for(const i of this.getModels())i.delete();const t=this.getAttributeManager();t&&t.finalize(),this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState.uniformTransitions.clear(),this.internalState.finalize()}draw(t){for(const i of this.getModels())i.draw(t)}getPickingInfo({info:t}){const{index:r}=t;return r>=0&&Array.isArray(this.props.data)&&(t.object=this.props.data[r]),t}activateViewport(t){const i=this.internalState.viewport;this.internalState.viewport=t,(!i||!zue({oldViewport:i,viewport:t}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(t="all",i=""){const r=this.getAttributeManager();!r||("all"===t?r.invalidateAll():r.invalidate(t))}updateAttributes(t){for(const i of this.getModels())this._setModelAttributes(i,t)}_updateAttributes(t){const i=this.getAttributeManager();if(!i)return;const r=this.getNumInstances(t),s=this.getStartIndices(t);i.update({data:t.data,numInstances:r,startIndices:s,props:t,transitions:t.transitions,buffers:t.data.attributes,context:this,ignoreUnknownAttributes:!0});const o=i.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(o)}_updateAttributeTransition(){const t=this.getAttributeManager();t&&t.updateTransition()}_updateUniformTransition(){const{uniformTransitions:t}=this.internalState;if(t.active){const i=t.update(),r=Object.create(this.props);for(const s in i)Object.defineProperty(r,s,{value:i[s]});return r}return this.props}calculateInstancePickingColors(t,{numInstances:i}){if(t.constant)return;const r=Math.floor(Zc.length/3);if(this.internalState.usesPickingColorCache=!0,r<i){i>gz&&Mi.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),Zc=y0.allocate(Zc,i,{size:3,copy:!0,maxCount:Math.max(i,gz)});const s=Math.floor(Zc.length/3),o=[];for(let a=r;a<s;a++)this.encodePickingColor(a,o),Zc[3*a+0]=o[0],Zc[3*a+1]=o[1],Zc[3*a+2]=o[2]}t.value=Zc.subarray(0,3*i)}_setModelAttributes(t,i){const o=this.getAttributeManager().getShaderAttributes(i,t.userData.excludeAttributes||{});t.setAttributes(o)}disablePickingIndex(t){this._disablePickingIndex(t)}_disablePickingIndex(t){const{pickingColors:i,instancePickingColors:r}=this.getAttributeManager().attributes,s=i||r,o=s.getVertexOffset(t),a=s.getVertexOffset(t+1);s.buffer.subData({data:new Uint8Array(a-o),offset:o})}restorePickingColors(){const{pickingColors:t,instancePickingColors:i}=this.getAttributeManager().attributes,r=t||i;this.internalState.usesPickingColorCache&&r.value.buffer!==Zc.buffer&&(r.value=Zc.subarray(0,r.value.length)),r.updateSubBuffer({startOffset:0})}getNumInstances(t){return void 0!==(t=t||this.props).numInstances?t.numInstances:this.state&&void 0!==this.state.numInstances?this.state.numInstances:function(n){if(!function(n){return null!==n&&"object"==typeof n}(n))throw new Error("count(): argument not an object");if("function"==typeof n.count)return n.count();if(Number.isFinite(n.size))return n.size;if(Number.isFinite(n.length))return n.length;if(function(n){return null!==n&&"object"==typeof n&&n.constructor===Object}(n))return Object.keys(n).length;throw new Error("count(): argument not a container")}(t.data)}getStartIndices(t){return void 0!==(t=t||this.props).startIndices?t.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}_initialize(){xo("layer.initialize",this),this._initState(),this.initializeState(this.context);for(const t of this.props.extensions)t.initializeState.call(this,this.context,t);this.setChangeFlags({dataChanged:!0,propsChanged:!0,viewportChanged:!0,extensionsChanged:!0}),this._updateState()}_update(){const t=this.needsUpdate();xo("layer.update",this,t),t&&this._updateState()}_updateState(){const t=this.props,i=this.context.viewport,r=this._updateUniformTransition();this.internalState.propsInTransition=r,this.context.viewport=this.internalState.viewport||i,this.props=r;try{const s=this._getUpdateParams(),o=this.getModels();if(this.context.gl)this.updateState(s);else try{this.updateState(s)}catch(l){}for(const l of this.props.extensions)l.updateState.call(this,s,l);const a=this.getModels()[0]!==o[0];this._updateModules(s,a),this.isComposite?this._renderLayers(s):(this.setNeedsRedraw(),this._updateAttributes(this.props),this.state.model&&this.state.model.setInstanceCount(this.getNumInstances()))}finally{this.context.viewport=i,this.props=t,this.clearChangeFlags(),this.internalState.needsUpdate=!1,this.internalState.resetOldProps()}}_finalize(){xo("layer.finalize",this),this.finalizeState(this.context);for(const t of this.props.extensions)t.finalizeState.call(this,t)}drawLayer({moduleParameters:t=null,uniforms:i={},parameters:r={}}){this._updateAttributeTransition();const s=this.props;this.props=this.internalState.propsInTransition||s;const{opacity:o}=this.props;i.opacity=Math.pow(o,1/2.2);try{t&&this.setModuleParameters(t);const{getPolygonOffset:a}=this.props,l=a&&a(i)||[0,0];Uu(this.context.gl,{polygonOffset:l}),sc(this.context.gl,r,()=>{const c={moduleParameters:t,uniforms:i,parameters:r,context:this.context};for(const u of this.props.extensions)u.draw.call(this,c,u);this.draw(c)})}finally{this.props=s}}getChangeFlags(){return this.internalState.changeFlags}setChangeFlags(t){const{changeFlags:i}=this.internalState;for(const s in t)if(t[s]){let o=!1;switch(s){case"dataChanged":Array.isArray(i[s])&&(i[s]=Array.isArray(t[s])?i[s].concat(t[s]):t[s],o=!0);default:i[s]||(i[s]=t[s],o=!0)}o&&xo("layer.changeFlag",this,s,t)}const r=i.dataChanged||i.updateTriggersChanged||i.propsChanged||i.extensionsChanged;i.propsOrDataChanged=r,i.somethingChanged=r||t.viewportChanged||t.stateChanged}clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}diffProps(t,i){const r=function(n,e){const t=sU({newProps:n,oldProps:e,propTypes:PI(n),ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),i=function(n,e){if(null===e)return"oldProps is null, initial diff";let t=null;const{dataComparator:i,_dataDiff:r}=n;return i?i(n.data,e.data)||(t="Data comparator detected a change"):n.data!==e.data&&(t="A new data container was supplied"),t&&r&&(t=r(n.data,e.data)||t),t}(n,e);let r=!1;return i||(r=function(n,e){if(null===e)return"oldProps is null, initial diff";if("all"in n.updateTriggers&&oU(n,e,"all"))return{all:!0};const t={};let i=!1;for(const r in n.updateTriggers)"all"!==r&&oU(n,e,r)&&(t[r]=!0,i=t);return i}(n,e)),{dataChanged:i,propsChanged:t,updateTriggersChanged:r,extensionsChanged:Gae(n,e),transitionsChanged:Uae(n,e)}}(t,i);if(r.updateTriggersChanged)for(const s in r.updateTriggersChanged)r.updateTriggersChanged[s]&&this.invalidateAttribute(s);if(r.transitionsChanged)for(const s in r.transitionsChanged)this.internalState.uniformTransitions.add(s,i[s],t[s],t.transitions[s]);return this.setChangeFlags(r)}validateProps(){!function(n){const e=PI(n);for(const t in e){const i=e[t],{validate:r}=i;if(r&&!r(n[t],i))throw new Error("Invalid prop ".concat(t,": ").concat(n[t]))}}(this.props)}setModuleParameters(t){for(const i of this.getModels())i.updateModuleSettings(t)}updateAutoHighlight(t){this.props.autoHighlight&&this._updateAutoHighlight(t)}_updateAutoHighlight(t){const i={pickingSelectedColor:t.picked?t.color:null},{highlightColor:r}=this.props;t.picked&&"function"==typeof r&&(i.pickingHighlightColor=r(t)),this.setModuleParameters(i),this.setNeedsRedraw()}_updateModules({props:t,oldProps:i},r){const{autoHighlight:s,highlightedObjectIndex:o,highlightColor:a}=t;if(r||i.autoHighlight!==s||i.highlightedObjectIndex!==o||i.highlightColor!==a){const l={};s||(l.pickingSelectedColor=null),Array.isArray(a)&&(l.pickingHighlightColor=a),Number.isInteger(o)&&(l.pickingSelectedColor=o>=0?this.encodePickingColor(o):null),this.setModuleParameters(l)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(t){if(!this.internalState)return!1;let i=!1;i=i||this.internalState.needsRedraw&&this.id,this.internalState.needsRedraw=this.internalState.needsRedraw&&!t.clearRedrawFlags;const r=this.getAttributeManager(),s=r&&r.getNeedsRedraw(t);return i=i||s,i}_getAttributeManager(){return new Rae(this.context.gl,{id:this.props.id,stats:this.context.stats,timeline:this.context.timeline})}_initState(){oc(!this.internalState&&!this.state),oc(isFinite(this.props.coordinateSystem));const t=this._getAttributeManager();t&&t.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new yce({attributeManager:t,layer:this}),this.clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(Mi.deprecated("layer.state.attributeManager","layer.getAttributeManager()"),t)}),this.internalState.layer=this,this.internalState.uniformTransitions=new kae(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props)}_transferState(t){xo("layer.matched",this,this===t);const{state:i,internalState:r}=t;this!==t&&(this.internalState=r,this.internalState.layer=this,this.state=i,this.internalState.setAsyncProps(this.props),this.diffProps(this.props,this.internalState.getOldProps()))}_onAsyncPropUpdated(){this.diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}return n.layerName="Layer",n.defaultProps=Hue,n})(),mz=(()=>{class n extends j0{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(t=>t.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(){}setState(t){super.setState(t),this.setNeedsUpdate()}getPickingInfo({info:t}){const{object:i}=t;return i&&i.__source&&i.__source.parent&&i.__source.parent.id===this.id&&(t.object=i.__source.object,t.index=i.__source.index),t}renderLayers(){return null}filterSubLayer(t){return!0}shouldRenderSubLayer(t,i){return i&&i.length}getSubLayerClass(t,i){const{_subLayerProps:r}=this.props;return r&&r[t]&&r[t].type||i}getSubLayerRow(t,i,r){return t.__source={parent:this,object:i,index:r},t}getSubLayerAccessor(t){if("function"==typeof t){const i={data:this.props.data,target:[]};return(r,s)=>r&&r.__source?(i.index=r.__source.index,t(r.__source.object,i)):t(r,s)}return t}getSubLayerProps(t={}){const{opacity:i,pickable:r,visible:s,parameters:o,getPolygonOffset:a,highlightedObjectIndex:l,autoHighlight:c,highlightColor:u,coordinateSystem:h,coordinateOrigin:f,wrapLongitude:g,positionFormat:m,modelMatrix:w,extensions:S,fetch:U,_subLayerProps:D}=this.props,ie={opacity:i,pickable:r,visible:s,parameters:o,getPolygonOffset:a,highlightedObjectIndex:l,autoHighlight:c,highlightColor:u,coordinateSystem:h,coordinateOrigin:f,wrapLongitude:g,positionFormat:m,modelMatrix:w,extensions:S,fetch:U},_e=D&&D[t.id],Ne=_e&&_e.updateTriggers,Pe=t.id||"sublayer";if(_e){const Ve=this.constructor._propTypes,vt=t.type?t.type._propTypes:{};for(const wt in _e){const xt=vt[wt]||Ve[wt];xt&&"accessor"===xt.type&&(_e[wt]=this.getSubLayerAccessor(_e[wt]))}}Object.assign(ie,t,_e),ie.id="".concat(this.props.id,"-").concat(Pe),ie.updateTriggers=ot(ot({all:this.props.updateTriggers.all},t.updateTriggers),Ne);for(const Ve of S){const vt=Ve.getSubLayerProps.call(this,Ve);vt&&Object.assign(ie,vt,{updateTriggers:Object.assign(ie.updateTriggers,vt.updateTriggers)})}return ie}_updateAutoHighlight(t){for(const i of this.getSubLayers())i.updateAutoHighlight(t)}_getAttributeManager(){return null}_renderLayers(){let{subLayers:t}=this.internalState;const i=!t||this.needsUpdate();i&&(t=this.renderLayers(),t=hI(t,Boolean),this.internalState.subLayers=t),xo("compositeLayer.renderLayers",this,i,t);for(const r of t)r.parent=this}}return n.layerName="CompositeLayer",n})();const $ue=/([0-9]+\.?[0-9]*)(%|px)/;function PS(n){switch(typeof n){case"number":return{position:n,relative:!1};case"string":const e=n.match($ue);if(e&&e.length>=3){const t="%"===e[2],i=parseFloat(e[1]);return{position:t?i/100:i,relative:t}}default:throw new Error("Could not parse position string ".concat(n))}}function FS(n,e){return n.relative?Math.round(n.position*e):n.position}function U0(n,e){if(n===e)return!0;if(!n||!e)return!1;for(const t in n){const i=n[t],r=e[t];if(!(i===r||Array.isArray(i)&&Array.isArray(r)&&U0(i,r)))return!1}return!0}class DO{constructor(e={}){const{id:t=null,x:i=0,y:r=0,width:s="100%",height:o="100%",projectionMatrix:a=null,fovy:l=50,near:c=.1,far:u=1e3,modelMatrix:h=null,viewportInstance:f=null,type:g=Yg}=e;oc(!f||f instanceof Yg),this.viewportInstance=f,this.id=t||this.constructor.displayName||"view",this.type=g,this.props=wn(ot({},e),{id:this.id,projectionMatrix:a,fovy:l,near:c,far:u,modelMatrix:h}),this._parseDimensions({x:i,y:r,width:s,height:o}),this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e||(this.viewportInstance?e.viewportInstance&&this.viewportInstance.equals(e.viewportInstance):U0(this.props,e.props))}makeViewport({width:e,height:t,viewState:i}){if(this.viewportInstance)return this.viewportInstance;i=this.filterViewState(i);const r=this.getDimensions({width:e,height:t});return this._getViewport(i,r)}getViewStateId(){switch(typeof this.props.viewState){case"string":return this.props.viewState;case"object":return this.props.viewState&&this.props.viewState.id;default:return this.id}}filterViewState(e){if(this.props.viewState&&"object"==typeof this.props.viewState){if(!this.props.viewState.id)return this.props.viewState;const t=ot({},e);for(const i in this.props.viewState)"id"!==i&&(t[i]=this.props.viewState[i]);return t}return e}getDimensions({width:e,height:t}){return{x:FS(this._x,e),y:FS(this._y,t),width:FS(this._width,e),height:FS(this._height,t)}}_getControllerProps(e){let t=this.props.controller;return t?!0===t?e:("function"==typeof t&&(t={type:t}),ot(ot({},e),t)):null}_getViewport(e,t){const{type:i}=this;return new i(ot(ot(ot({},e),this.props),t))}_parseDimensions({x:e,y:t,width:i,height:r}){this._x=PS(e),this._y=PS(t),this._width=PS(i),this._height=PS(r)}}const z0=()=>{},_z={transitionEasing:n=>n,transitionInterruption:1,onTransitionStart:z0,onTransitionInterrupt:z0,onTransitionEnd:z0};class Wue{constructor(e,t={}){this.ControllerState=e,this.props=ot(ot({},_z),t),this.propsInTransition=null,this.transition=new I0(t.timeline),this.onViewStateChange=t.onViewStateChange||z0,this.onStateChange=t.onStateChange||z0,this._onTransitionUpdate=this._onTransitionUpdate.bind(this)}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let t=!1;const i=this.props;if(e=ot(ot({},_z),e),this.props=e,this._shouldIgnoreViewportChange(i,e))return t;if(this._isTransitionEnabled(e)){const{interruption:r,endProps:s}=this.transition.settings,o=ot(ot({},i),2===r?s:this.propsInTransition||i);this._triggerTransition(o,e),t=!0}else this.transition.cancel();return t}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:t,transitionInterpolator:i}=e;return(t>0||"auto"===t)&&Boolean(i)}_isUpdateDueToCurrentTransition(e){return!!this.transition.inProgress&&this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition)}_shouldIgnoreViewportChange(e,t){return this.transition.inProgress?3===this.transition.settings.interruption||this._isUpdateDueToCurrentTransition(t):!this._isTransitionEnabled(t)||t.transitionInterpolator.arePropsEqual(e,t)}_triggerTransition(e,t){const i=new this.ControllerState(e),r=new this.ControllerState(t).shortestPathFrom(i),{transitionInterpolator:s}=t,o=s.getDuration?s.getDuration(e,t):t.transitionDuration;if(0===o)return;const a=t.transitionInterpolator.initializeProps(e,r);this.propsInTransition={},this.duration=o,this.transition.start({duration:o,easing:t.transitionEasing,interpolator:t.transitionInterpolator,interruption:t.transitionInterruption,startProps:a.start,endProps:a.end,onStart:t.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(t.onTransitionInterrupt),onEnd:this._onTransitionEnd(t.onTransitionEnd)}),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return t=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e(t)}}_onTransitionUpdate(e){const{time:t,settings:{interpolator:i,startProps:r,endProps:s,duration:o,easing:a}}=e,l=a(t/o),c=i.interpolateProps(r,s,l);this.propsInTransition=new this.ControllerState(ot(ot({},this.props),c)).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})}}const yz=["longitude","latitude","zoom","bearing","pitch"],Yue=["longitude","latitude","zoom"];class vz extends class{constructor(e={}){Array.isArray(e)&&(e={compare:e,extract:e,required:e});const{compare:t,extract:i,required:r}=e;this._propsToCompare=t,this._propsToExtract=i,this._requiredProps=r}arePropsEqual(e,t){for(const i of this._propsToCompare||Object.keys(t))if(!(i in e)||!(i in t)||!v0(e[i],t[i]))return!1;return!0}initializeProps(e,t){let i;if(this._propsToExtract){const r={},s={};for(const o of this._propsToExtract)r[o]=e[o],s[o]=t[o];i={start:r,end:s}}else i={start:e,end:t};return this._checkRequiredProps(i.start),this._checkRequiredProps(i.end),i}interpolateProps(e,t,i){return t}getDuration(e,t){return t.transitionDuration}_checkRequiredProps(e){!this._requiredProps||this._requiredProps.forEach(t=>{const i=e[t];oc(Number.isFinite(i)||Array.isArray(i),"".concat(t," is required for transition"))})}}{constructor(e={}){super((Array.isArray(e)?e:e.transitionProps)||{compare:yz,extract:yz,required:Yue}),this.opts=e}initializeProps(e,t){const i=super.initializeProps(e,t),{makeViewport:r,around:s}=this.opts;if(r&&s){const o=r(e),a=r(t),l=o.unproject(s);i.start.around=s,Object.assign(i.end,{around:a.project(l),aroundPosition:l,width:t.width,height:t.height})}return i}interpolateProps(e,t,i){const r={};for(const s of this._propsToExtract)r[s]=sS(e[s]||0,t[s]||0,i);if(t.aroundPosition){const s=this.opts.makeViewport(ot(ot({},t),r));Object.assign(r,s.panByPosition(t.aroundPosition,sS(e.around,t.around,i)))}return r}}const lh={transitionDuration:0},Kue={transitionDuration:300,transitionEasing:n=>n,transitionInterruption:1},kS=n=>1-(1-n)*(1-n),Xg_WHEEL=["wheel"],Xg_PAN=["panstart","panmove","panend"],Xg_PINCH=["pinchstart","pinchmove","pinchend"],Xg_TRIPLE_PAN=["tripanstart","tripanmove","tripanend"],Xg_DOUBLE_TAP=["doubletap"],Xg_KEYBOARD=["keydown"];class IO{constructor(e,t={}){this.ControllerState=e,this.controllerState=null,this.controllerStateProps=null,this.eventManager=null,this.transitionManager=new Wue(e,wn(ot({},t),{onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}));const i=this.linearTransitionProps;this._transition=i&&wn(ot({},Kue),{transitionInterpolator:new vz({transitionProps:i})}),this._events=null,this._interactionState={isDragging:!1},this._customEvents=[],this.onViewStateChange=null,this.onStateChange=null,this.handleEvent=this.handleEvent.bind(this),this.setProps(t)}get linearTransitionProps(){return null}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.setProps(this.controllerStateProps)}finalize(){for(const e in this._events)this._events[e]&&this.eventManager.off(e,this.handleEvent);this.transitionManager.finalize()}handleEvent(e){const{ControllerState:t}=this;this.controllerState=new t(ot(ot({makeViewport:this.makeViewport},this.controllerStateProps),this._state));const i=this._eventStartBlocked;switch(e.type){case"panstart":return!i&&this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return!i&&this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"tripanstart":return!i&&this._onTriplePanStart(e);case"tripanmove":return this._onTriplePan(e);case"tripanend":return this._onTriplePanEnd(e);case"doubletap":return this._onDoubleTap(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}getCenter(e){const{x:t,y:i}=this.controllerStateProps,{offsetCenter:r}=e;return[r.x-t,r.y-i]}isPointInBounds(e,t){const{width:i,height:r}=this.controllerStateProps;if(t&&t.handled)return!1;const s=e[0]>=0&&e[0]<=i&&e[1]>=0&&e[1]<=r;return s&&t&&t.stopPropagation(),s}isFunctionKeyPressed(e){const{srcEvent:t}=e;return Boolean(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}isDragging(){return this._interactionState.isDragging}blockEvents(e){const t=setTimeout(()=>{this._eventStartBlocked===t&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=t}setProps(e){"onViewStateChange"in e&&(this.onViewStateChange=e.onViewStateChange),"onStateChange"in e&&(this.onStateChange=e.onStateChange),"makeViewport"in e&&(this.makeViewport=e.makeViewport),"dragMode"in e&&(this.dragMode=e.dragMode),this.controllerStateProps=e,"eventManager"in e&&this.eventManager!==e.eventManager&&(this.eventManager=e.eventManager,this._events={},this.toggleEvents(this._customEvents,!0)),"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);let{inertia:t}=e;!0===t&&(t=300),this.inertia=t;const{scrollZoom:i=!0,dragPan:r=!0,dragRotate:s=!0,doubleClickZoom:o=!0,touchZoom:a=!0,touchRotate:l=!1,keyboard:c=!0}=e,u=Boolean(this.onViewStateChange);this.toggleEvents(Xg_WHEEL,u&&i),this.toggleEvents(Xg_PAN,u&&(r||s)),this.toggleEvents(Xg_PINCH,u&&(a||l)),this.toggleEvents(Xg_TRIPLE_PAN,u&&l),this.toggleEvents(Xg_DOUBLE_TAP,u&&o),this.toggleEvents(Xg_KEYBOARD,u&&c),this.scrollZoom=i,this.dragPan=r,this.dragRotate=s,this.doubleClickZoom=o,this.touchZoom=a,this.touchRotate=l,this.keyboard=c}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,t){this.eventManager&&e.forEach(i=>{this._events[i]!==t&&(this._events[i]=t,t?this.eventManager.on(i,this.handleEvent):this.eventManager.off(i,this.handleEvent))})}updateViewport(e,t={},i={}){const r=ot(ot({},e.getViewportProps()),t),s=this.controllerState!==e;if(this._state=e.getState(),this._setInteractionState(i),s){const o=this.controllerState?this.controllerState.getViewportProps():null;this.onViewStateChange&&this.onViewStateChange({viewState:r,interactionState:this._interactionState,oldViewState:o})}}_onTransition(e){this.onViewStateChange&&(e.interactionState=this._interactionState,this.onViewStateChange(e))}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange&&this.onStateChange(this._interactionState)}_onPanStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;let i=this.isFunctionKeyPressed(e)||e.rightButton;(this.invertPan||"pan"===this.dragMode)&&(i=!i);const r=this.controllerState[i?"panStart":"rotateStart"]({pos:t});return this._panMove=i,this.updateViewport(r,lh,{isDragging:!0}),!0}_onPan(e){return!!this.isDragging()&&(this._panMove?this._onPanMove(e):this._onPanRotate(e))}_onPanEnd(e){return!!this.isDragging()&&(this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e))}_onPanMove(e){if(!this.dragPan)return!1;const t=this.getCenter(e),i=this.controllerState.pan({pos:t});return this.updateViewport(i,lh,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:t}=this;if(this.dragPan&&t&&e.velocity){const i=this.getCenter(e),s=this.controllerState.pan({pos:[i[0]+e.velocityX*t/2,i[1]+e.velocityY*t/2]}).panEnd();this.updateViewport(s,wn(ot({},this._getTransitionProps()),{transitionDuration:t,transitionEasing:kS}),{isDragging:!1,isPanning:!0})}else{const i=this.controllerState.panEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const t=this.getCenter(e),i=this.controllerState.rotate({pos:t});return this.updateViewport(i,lh,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:t}=this;if(this.dragRotate&&t&&e.velocity){const i=this.getCenter(e),s=this.controllerState.rotate({pos:[i[0]+e.velocityX*t/2,i[1]+e.velocityY*t/2]}).rotateEnd();this.updateViewport(s,wn(ot({},this._getTransitionProps()),{transitionDuration:t,transitionEasing:kS}),{isDragging:!1,isRotating:!0})}else{const i=this.controllerState.rotateEnd();this.updateViewport(i,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;e.preventDefault();const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const{speed:i=.01,smooth:r=!1}=this.scrollZoom,{delta:s}=e;let o=2/(1+Math.exp(-Math.abs(s*i)));s<0&&0!==o&&(o=1/o);const a=this.controllerState.zoom({pos:t,scale:o});return this.updateViewport(a,wn(ot({},this._getTransitionProps({around:t})),{transitionDuration:r?250:1}),{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const i=this.controllerState.rotateStart({pos:t});return this.updateViewport(i,lh,{isDragging:!0}),!0}_onTriplePan(e){if(!this.touchRotate||!this.isDragging())return!1;const t=this.getCenter(e);t[0]-=e.deltaX;const i=this.controllerState.rotate({pos:t});return this.updateViewport(i,lh,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(e){if(!this.isDragging())return!1;const{inertia:t}=this;if(this.touchRotate&&t&&e.velocityY){const i=this.getCenter(e),r=[i[0],i[1]+=e.velocityY*t/2],s=this.controllerState.rotate({pos:r});this.updateViewport(s,wn(ot({},this._getTransitionProps()),{transitionDuration:t,transitionEasing:kS}),{isDragging:!1,isRotating:!0}),this.blockEvents(t)}else{const i=this.controllerState.rotateEnd();this.updateViewport(i,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const i=this.controllerState.zoomStart({pos:t}).rotateStart({pos:t});return this._startPinchRotation=e.rotation,this._lastPinchEvent=e,this.updateViewport(i,lh,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let t=this.controllerState;if(this.touchZoom){const{scale:i}=e,r=this.getCenter(e);t=t.zoom({pos:r,scale:i})}if(this.touchRotate){const{rotation:i}=e;t=t.rotate({deltaAngleX:this._startPinchRotation-i})}return this.updateViewport(t,lh,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),this._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:t,_lastPinchEvent:i}=this;if(this.touchZoom&&t&&i&&e.scale!==i.scale){const r=this.getCenter(e);let s=this.controllerState.rotateEnd();const o=Math.log2(e.scale),a=(o-Math.log2(i.scale))/(e.deltaTime-i.deltaTime),l=Math.pow(2,o+a*t/2);s=s.zoom({pos:r,scale:l}).zoomEnd(),this.updateViewport(s,wn(ot({},this._getTransitionProps({around:r})),{transitionDuration:t,transitionEasing:kS}),{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(t)}else{const r=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(r,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return this._startPinchRotation=null,this._lastPinchEvent=null,!0}_onDoubleTap(e){if(!this.doubleClickZoom)return!1;const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const i=this.isFunctionKeyPressed(e),r=this.controllerState.zoom({pos:t,scale:i?.5:2});return this.updateViewport(r,this._getTransitionProps({around:t}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const t=this.isFunctionKeyPressed(e),{zoomSpeed:i,moveSpeed:r,rotateSpeedX:s,rotateSpeedY:o}=this.keyboard,{controllerState:a}=this;let l;const c={};switch(e.srcEvent.code){case"Minus":l=t?a.zoomOut(i).zoomOut(i):a.zoomOut(i),c.isZooming=!0;break;case"Equal":l=t?a.zoomIn(i).zoomIn(i):a.zoomIn(i),c.isZooming=!0;break;case"ArrowLeft":t?(l=a.rotateLeft(s),c.isRotating=!0):(l=a.moveLeft(r),c.isPanning=!0);break;case"ArrowRight":t?(l=a.rotateRight(s),c.isRotating=!0):(l=a.moveRight(r),c.isPanning=!0);break;case"ArrowUp":t?(l=a.rotateUp(o),c.isRotating=!0):(l=a.moveUp(r),c.isPanning=!0);break;case"ArrowDown":t?(l=a.rotateDown(o),c.isRotating=!0):(l=a.moveDown(r),c.isPanning=!0);break;default:return!1}return this.updateViewport(l,this._getTransitionProps(),c),!0}_getTransitionProps(e){const{_transition:t}=this;return t?e?wn(ot({},t),{transitionInterpolator:new vz(wn(ot({},e),{transitionProps:this.linearTransitionProps,makeViewport:this.controllerState.makeViewport}))}):t:lh}}class bz{constructor(e){this._viewportProps=this._applyConstraints(e)}getViewportProps(){return this._viewportProps}getState(){return this._state}shortestPathFrom(e){return this._viewportProps}_applyConstraints(e){return e}}const ch_target=[0,0,0];class BS extends bz{constructor({makeViewport:e,width:t,height:i,rotationX:r=0,rotationOrbit:s=0,target:o=ch_target,zoom:a=0,minRotationX:l=-90,maxRotationX:c=90,minZoom:u=-(1/0),maxZoom:h=Infinity,startPanPosition:f,startRotatePos:g,startRotationX:m,startRotationOrbit:w,startZoomPosition:S,startZoom:U}){super({width:t,height:i,rotationX:r,rotationOrbit:s,target:o,zoom:a,minRotationX:l,maxRotationX:c,minZoom:u,maxZoom:h}),this._state={startPanPosition:f,startRotatePos:g,startRotationX:m,startRotationOrbit:w,startZoomPosition:S,startZoom:U},this.makeViewport=e}panStart({pos:e}){return this._getUpdatedState({startPanPosition:this._unproject(e)})}pan({pos:e,startPosition:t}){const i=this._state.startPanPosition||t;if(!i)return this;const s=this.makeViewport(this._viewportProps).panByPosition(i,e);return this._getUpdatedState(s)}panEnd(){return this._getUpdatedState({startPanPosition:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startRotationX:this._viewportProps.rotationX,startRotationOrbit:this._viewportProps.rotationOrbit})}rotate({pos:e,deltaAngleX:t=0,deltaAngleY:i=0}){const{startRotatePos:r,startRotationX:s,startRotationOrbit:o}=this._state,{width:a,height:l}=this._viewportProps;if(!r||!Number.isFinite(s)||!Number.isFinite(o))return this;let c;if(e){let u=(e[0]-r[0])/a;(s<-90||s>90)&&(u*=-1),c={rotationX:s+(e[1]-r[1])/l*180,rotationOrbit:o+180*u}}else c={rotationX:s+i,rotationOrbit:o+t};return this._getUpdatedState(c)}rotateEnd(){return this._getUpdatedState({startRotationX:null,startRotationOrbit:null})}shortestPathFrom(e){const t=e.getViewportProps(),i=ot({},this._viewportProps),{rotationOrbit:r}=i;return Math.abs(r-t.rotationOrbit)>180&&(i.rotationOrbit=r<0?r+360:r-360),i}zoomStart({pos:e}){return this._getUpdatedState({startZoomPosition:this._unproject(e),startZoom:this._viewportProps.zoom})}zoom({pos:e,startPos:t,scale:i}){const{zoom:r}=this._viewportProps;let{startZoom:s,startZoomPosition:o}=this._state;Number.isFinite(s)||(s=r,o=this._unproject(t)||this._unproject(e));const a=this._calculateNewZoom({scale:i,startZoom:s}),l=this.makeViewport(wn(ot({},this._viewportProps),{zoom:a}));return this._getUpdatedState(ot({zoom:a},l.panByPosition(o,e)))}zoomEnd(){return this._getUpdatedState({startZoomPosition:null,startZoom:null})}zoomIn(e=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:e})})}zoomOut(e=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:1/e})})}moveLeft(e=50){return this._panFromCenter([-e,0])}moveRight(e=50){return this._panFromCenter([e,0])}moveUp(e=50){return this._panFromCenter([0,-e])}moveDown(e=50){return this._panFromCenter([0,e])}rotateLeft(e=15){return this._getUpdatedState({rotationOrbit:this._viewportProps.rotationOrbit-e})}rotateRight(e=15){return this._getUpdatedState({rotationOrbit:this._viewportProps.rotationOrbit+e})}rotateUp(e=10){return this._getUpdatedState({rotationX:this._viewportProps.rotationX-e})}rotateDown(e=10){return this._getUpdatedState({rotationX:this._viewportProps.rotationX+e})}_unproject(e){const t=this.makeViewport(this._viewportProps);return e&&t.unproject(e)}_calculateNewZoom({scale:e,startZoom:t}){const{maxZoom:i,minZoom:r}=this._viewportProps;return Number.isFinite(t)||(t=this._viewportProps.zoom),Pa(t+Math.log2(e),r,i)}_panFromCenter(e){const{width:t,height:i,target:r}=this._viewportProps;return this.pan({startPosition:r,pos:[t/2+e[0],i/2+e[1]]})}_getUpdatedState(e){return new BS(ot(ot(ot({},this._viewportProps),this._state),e))}_applyConstraints(e){const{maxZoom:t,minZoom:i,zoom:r,maxRotationX:s,minRotationX:o,rotationOrbit:a}=e;return e.zoom=Pa(r,i,t),e.rotationX=Pa(e.rotationX,o,s),(a<-180||a>180)&&(e.rotationOrbit=function(n,e){const t=n%360;return t<0?360+t:t}(a+180)-180),e}}class Que extends IO{constructor(e){super(BS,e)}get linearTransitionProps(){return["target","zoom","rotationX","rotationOrbit"]}}class Zue extends IO{constructor(e){e.dragMode=e.dragMode||"pan",super(BS,e)}_onPanRotate(e){return!1}get linearTransitionProps(){return["target","zoom"]}}const Jue=(new Gn).lookAt({eye:[0,0,1]});function ede({width:n,height:e,near:t,far:i}){return n=n||1,e=e||1,(new Gn).ortho({left:-n/2,right:n/2,bottom:-e/2,top:e/2,near:t,far:i})}class tde extends Yg{constructor(e){const{width:t,height:i,near:r=.1,far:s=1e3,zoom:o=0,target:a=[0,0,0],flipY:l=!0}=e,c=Math.pow(2,o);super(wn(ot({},e),{longitude:null,position:a,viewMatrix:Jue.clone().scale([c,c*(l?-1:1),c]),projectionMatrix:ede({width:t,height:i,near:r,far:s}),zoom:o}))}panByPosition(e,t){const r=CS([],e,gU([],R0(t,this.pixelUnprojectionMatrix)));return{target:CS([],this.center,r)}}}let nde=(()=>{class n extends DO{constructor(t){super(wn(ot({},t),{type:tde}))}get controller(){return this._getControllerProps({type:Zue})}}return n.displayName="OrthographicView",n})();const VS=Math.PI/180;function ide({height:n,fovy:e,orbitAxis:t,rotationX:i,rotationOrbit:r,zoom:s}){const o=.5/Math.tan(e*VS/2),a="Z"===t?[0,0,1]:[0,1,0],l="Z"===t?[0,-o,0]:[0,0,o],c=(new Gn).lookAt({eye:l,up:a});c.rotateX(i*VS),"Z"===t?c.rotateZ(r*VS):c.rotateY(r*VS);const u=Math.pow(2,s)/(n||1);return c.scale(u),c}class rde extends Yg{constructor(e){const{height:t,fovy:i,orbitAxis:r,target:s=[0,0,0],rotationX:o=0,rotationOrbit:a=0,zoom:l=0}=e;super(wn(ot({},e),{longitude:null,viewMatrix:ide({height:t,fovy:i,orbitAxis:r,rotationX:o,rotationOrbit:a,zoom:l}),fovy:i,position:s,zoom:l})),this.projectedCenter=this.project(this.center)}unproject(e,{topLeft:t=!0}={}){const[i,r,s=this.projectedCenter[2]]=e,o=t?r:this.height-r,[a,l,c]=R0([i,o,s],this.pixelUnprojectionMatrix);return[a,l,c]}panByPosition(e,t){const i=this.project(e);return{target:this.unproject([this.width/2+i[0]-t[0],this.height/2+i[1]-t[1],this.projectedCenter[2]])}}}let sde=(()=>{class n extends DO{constructor(t={}){const{orbitAxis:i="Z"}=t;super(wn(ot({},t),{orbitAxis:i,type:rde}))}get controller(){return this._getControllerProps({type:Que})}}return n.displayName="OrbitView",n})();const ode=[255,255,255],ade=1;let lde=0;class wz{constructor(e={}){const{color:t=ode}=e,{intensity:i=ade}=e;this.id=e.id||"ambient-".concat(lde++),this.color=t,this.intensity=i,this.type="ambient"}}const cde=[255,255,255],ude=1,dde=[0,0,-1];let hde=0;class Ez{constructor(e={}){const{color:t=cde}=e,{intensity:i=ude}=e,{direction:r=dde}=e,{_shadow:s=!1}=e;this.id=e.id||"directional-".concat(hde++),this.color=t,this.intensity=i,this.type="directional",this.direction=new So(r).normalize().toArray(),this.shadow=s}getProjectedLight(){return this}}class Sz{constructor(e={}){const{id:t="effect"}=e;this.id=t,this.props=ot({},e)}preRender(){}getModuleParameters(){}cleanup(){}}class OO extends class{constructor(e,t={}){const{id:i="pass"}=t;this.id=i,this.gl=e,this.props=ot({},t)}setProps(e){Object.assign(this.props,e)}render(){}cleanup(){}}{render(e){return Uu(this.gl,{framebuffer:e.target}),this._drawLayers(e)}_drawLayers(e){const{viewports:t,views:i,onViewportActive:r,clearCanvas:s=!0}=e;e.pass=e.pass||"unknown";const o=this.gl;s&&function(n){Uu(n,{viewport:[0,0,n.drawingBufferWidth,n.drawingBufferHeight]}),n.clear(16640)}(o);const a=[];for(const l of t){const c=l.viewport||l,u=i&&i[c.id];r(c);const h=this._getDrawLayerParams(c,e);e.view=u;const f=c.subViewports||[c];for(const g of f){e.viewport=g;const m=this._drawLayersInViewport(o,e,h);a.push(m)}}return a}_getDrawLayerParams(e,{layers:t,pass:i,layerFilter:r,effects:s,moduleParameters:o}){const a=[],l=xz(),c={viewport:e,isPicking:i.startsWith("picking"),renderPass:i};for(let u=0;u<t.length;u++){const h=t[u],f=this._shouldDrawLayer(h,c,r),m={shouldDrawLayer:f,layerRenderIndex:l(h,f)};f&&(m.moduleParameters=this._getModuleParameters(h,s,i,o),m.layerParameters=this.getLayerParameters(h,u)),a[u]=m}return a}_drawLayersInViewport(e,{layers:t,pass:i,viewport:r,view:s},o){const a=function(n,{viewport:e}){const t=n.canvas?n.canvas.clientHeight||n.canvas.height:100,i=e,r=Ng(n);return[i.x*r,(t-i.y-i.height)*r,i.width*r,i.height*r]}(e,{viewport:r});if(s&&s.props.clear){const c=!0===s.props.clear?{color:!0,depth:!0}:s.props.clear;sc(e,{scissorTest:!0,scissor:a},()=>rI(e,c))}const l={totalCount:t.length,visibleCount:0,compositeCount:0,pickableCount:0};Uu(e,{viewport:a});for(let c=0;c<t.length;c++){const u=t[c],{shouldDrawLayer:h,layerRenderIndex:f,moduleParameters:g,layerParameters:m}=o[c];if(h&&u.props.pickable&&l.pickableCount++,u.isComposite)l.compositeCount++;else if(h){l.visibleCount++,g.viewport=r;try{u.drawLayer({moduleParameters:g,uniforms:{layerIndex:f},parameters:m})}catch(w){u.raiseError(w,"drawing ".concat(u," to ").concat(i))}}}return l}shouldDrawLayer(e){return!0}getModuleParameters(e,t){return null}getLayerParameters(e,t){return e.props.parameters}_shouldDrawLayer(e,t,i){if(!this.shouldDrawLayer(e)||!e.props.visible||(t.layer=e,i&&!i(t)))return!1;let s=e.parent;for(;s;){if(!s.filterSubLayer(t))return!1;t.layer=s,s=s.parent}return e.activateViewport(t.viewport),!0}_getModuleParameters(e,t,i,r){const s=Object.assign(Object.create(e.props),{autoWrapLongitude:e.wrapLongitude,viewport:e.context.viewport,mousePosition:e.context.mousePosition,pickingActive:0,devicePixelRatio:Ng(this.gl)});if(t)for(const o of t)Object.assign(s,o.getModuleParameters(e));return Object.assign(s,this.getModuleParameters(e,t),r)}}function xz(n=0,e={}){const t={},i=(r,s)=>{const o=r.props._offset,a=r.id,l=r.parent&&r.parent.id;let c;if(l&&!(l in e)&&i(r.parent,!1),l in t){const u=t[l]=t[l]||xz(e[l],e);c=u(r,s),t[a]=u}else Number.isFinite(o)?(c=o+(e[l]||0),t[a]=null):c=n;return s&&c>=n&&(n=c+1),e[a]=c,c};return i}class mde extends OO{constructor(e,t){super(e,t),this.shadowMap=new da(e,{width:1,height:1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.depthBuffer=new Lg(e,{format:33189,width:1,height:1}),this.fbo=new Rs(e,{id:"shadowmap",width:1,height:1,attachments:{36064:this.shadowMap,36096:this.depthBuffer}})}render(e){const t=this.fbo;sc(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},()=>{const i=e.viewports[0],r=Ng(this.gl),s=i.width*r,o=i.height*r;(s!==t.width||o!==t.height)&&t.resize({width:s,height:o}),super.render(wn(ot({},e),{target:t,pass:"shadow"}))})}shouldDrawLayer(e){return!1!==e.props.shadowEnabled}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}const yde=Object.keys(Fi).map(n=>"const int COORDINATE_SYSTEM_".concat(n," = ").concat(Fi[n],";")).join(""),vde=Object.keys(Wc).map(n=>"const int PROJECTION_MODE_".concat(n," = ").concat(Wc[n],";")).join(""),bde="".concat(yde,"\n").concat(vde,"\n\nuniform int project_uCoordinateSystem;\nuniform int project_uProjectionMode;\nuniform float project_uScale;\nuniform bool project_uWrapLongitude;\nuniform vec3 project_uCommonUnitsPerMeter;\nuniform vec3 project_uCommonUnitsPerWorldUnit;\nuniform vec3 project_uCommonUnitsPerWorldUnit2;\nuniform vec4 project_uCenter;\nuniform mat4 project_uModelMatrix;\nuniform mat4 project_uViewProjectionMatrix;\nuniform vec2 project_uViewportSize;\nuniform float project_uDevicePixelRatio;\nuniform float project_uFocalDistance;\nuniform vec3 project_uCameraPosition;\nuniform vec3 project_uCoordinateOrigin;\nuniform vec3 project_uCommonOrigin;\n\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / (PI * 2.0);\nconst vec3 ZERO_64_LOW = vec3(0.0);\nconst float EARTH_RADIUS = 6370972.0;\nconst float GLOBE_RADIUS = 256.0;\nfloat project_size(float meters) {\n  return meters * project_uCommonUnitsPerMeter.z;\n}\n\nvec2 project_size(vec2 meters) {\n  return meters * project_uCommonUnitsPerMeter.xy;\n}\n\nvec3 project_size(vec3 meters) {\n  return meters * project_uCommonUnitsPerMeter;\n}\n\nvec4 project_size(vec4 meters) {\n  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);\n}\nvec3 project_normal(vec3 vector) {\n  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);\n  return normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);\n}\n\nvec4 project_offset_(vec4 offset) {\n  float dy = offset.y;\n  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;\n  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);\n}\nvec2 project_mercator_(vec2 lnglat) {\n  float x = lnglat.x;\n  if (project_uWrapLongitude) {\n    x = mod(x + 180., 360.0) - 180.;\n  }\n  float y = clamp(lnglat.y, -89.9, 89.9);\n  return vec2(\n    radians(x) + PI,\n    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))\n  ) * WORLD_SCALE;\n}\n\nvec3 project_globe_(vec3 lnglatz) {\n  float lambda = radians(lnglatz.x);\n  float phi = radians(lnglatz.y);\n  float cosPhi = cos(phi);\n  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;\n\n  return vec3(\n    sin(lambda) * cosPhi,\n    -cos(lambda) * cosPhi,\n    sin(phi)\n  ) * D;\n}\nvec4 project_position(vec4 position, vec3 position64Low) {\n  vec4 position_world = project_uModelMatrix * position;\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_mercator_(position_world.xy),\n        project_size(position_world.z),\n        position_world.w\n      );\n    }\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {\n      position_world.xyz += project_uCoordinateOrigin;\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_globe_(position_world.xyz),\n        position_world.w\n      );\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {\n        return vec4(\n          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,\n          project_size(position_world.z),\n          position_world.w\n        );\n      }\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||\n    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&\n    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {\n    position_world.xyz -= project_uCoordinateOrigin;\n  }\n  return project_offset_(position_world + project_uModelMatrix * vec4(position64Low, 0.0));\n}\n\nvec4 project_position(vec4 position) {\n  return project_position(position, ZERO_64_LOW);\n}\n\nvec3 project_position(vec3 position, vec3 position64Low) {\n  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);\n  return projected_position.xyz;\n}\n\nvec3 project_position(vec3 position) {\n  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);\n  return projected_position.xyz;\n}\n\nvec2 project_position(vec2 position) {\n  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);\n  return projected_position.xy;\n}\n\nvec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {\n  return viewProjectionMatrix * position + center;\n}\nvec4 project_common_position_to_clipspace(vec4 position) {\n  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);\n}\nvec2 project_pixel_size_to_clipspace(vec2 pixels) {\n  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;\n  return offset * project_uFocalDistance;\n}\n\nfloat project_size_to_pixel(float meters) {\n  return project_size(meters) * project_uScale;\n}\nfloat project_pixel_size(float pixels) {\n  return pixels / project_uScale;\n}\nvec2 project_pixel_size(vec2 pixels) {\n  return pixels / project_uScale;\n}\nmat3 project_get_orientation_matrix(vec3 up) {\n  vec3 uz = normalize(up);\n  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));\n  vec3 uy = cross(uz, ux);\n  return mat3(ux, uy, uz);\n}\n\nbool project_needs_rotation(vec3 commonPosition, out mat3 transform) {\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    transform = project_get_orientation_matrix(commonPosition);\n    return true;\n  }\n  return false;\n}\n"),wde={},RO={name:"project",dependencies:[{name:"fp32",vs:"#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\nconst float TWO_PI = 6.2831854820251465;\nconst float PI_2 = 1.5707963705062866;\nconst float PI_16 = 0.1963495463132858;\n\nconst float SIN_TABLE_0 = 0.19509032368659973;\nconst float SIN_TABLE_1 = 0.3826834261417389;\nconst float SIN_TABLE_2 = 0.5555702447891235;\nconst float SIN_TABLE_3 = 0.7071067690849304;\n\nconst float COS_TABLE_0 = 0.9807852506637573;\nconst float COS_TABLE_1 = 0.9238795042037964;\nconst float COS_TABLE_2 = 0.8314695954322815;\nconst float COS_TABLE_3 = 0.7071067690849304;\n\nconst float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;\nconst float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;\nconst float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;\nconst float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;\n\nfloat sin_taylor_fp32(float a) {\n  float r, s, t, x;\n\n  if (a == 0.0) {\n    return 0.0;\n  }\n\n  x = -a * a;\n  s = a;\n  r = a;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_3;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_5;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_7;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_9;\n  s = s + t;\n\n  return s;\n}\n\nvoid sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {\n  if (a == 0.0) {\n    sin_t = 0.0;\n    cos_t = 1.0;\n  }\n  sin_t = sin_taylor_fp32(a);\n  cos_t = sqrt(1.0 - sin_t * sin_t);\n}\n\nfloat tan_taylor_fp32(float a) {\n    float sin_a;\n    float cos_a;\n\n    if (a == 0.0) {\n        return 0.0;\n    }\n    float z = floor(a / TWO_PI);\n    float r = a - TWO_PI * z;\n\n    float t;\n    float q = floor(r / PI_2 + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return 1.0 / 0.0;\n    }\n\n    t = r - PI_2 * q;\n\n    q = floor(t / PI_16 + 0.5);\n    int k = int(q);\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return 1.0 / 0.0;\n    } else {\n        t = t - PI_16 * q;\n    }\n\n    float u = 0.0;\n    float v = 0.0;\n\n    float sin_t, cos_t;\n    float s, c;\n    sincos_taylor_fp32(t, sin_t, cos_t);\n\n    if (k == 0) {\n        s = sin_t;\n        c = cos_t;\n    } else {\n        if (abs(float(abs_k) - 1.0) < 0.5) {\n            u = COS_TABLE_0;\n            v = SIN_TABLE_0;\n        } else if (abs(float(abs_k) - 2.0) < 0.5) {\n            u = COS_TABLE_1;\n            v = SIN_TABLE_1;\n        } else if (abs(float(abs_k) - 3.0) < 0.5) {\n            u = COS_TABLE_2;\n            v = SIN_TABLE_2;\n        } else if (abs(float(abs_k) - 4.0) < 0.5) {\n            u = COS_TABLE_3;\n            v = SIN_TABLE_3;\n        }\n        if (k > 0) {\n            s = u * sin_t + v * cos_t;\n            c = u * cos_t - v * sin_t;\n        } else {\n            s = u * sin_t - v * cos_t;\n            c = u * cos_t + v * sin_t;\n        }\n    }\n\n    if (j == 0) {\n        sin_a = s;\n        cos_a = c;\n    } else if (j == 1) {\n        sin_a = c;\n        cos_a = -s;\n    } else if (j == -1) {\n        sin_a = -c;\n        cos_a = s;\n    } else {\n        sin_a = -s;\n        cos_a = -c;\n    }\n    return sin_a / cos_a;\n}\n#endif\n\nfloat tan_fp32(float a) {\n#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\n  return tan_taylor_fp32(a);\n#else\n  return tan(a);\n#endif\n}\n",fs:null}],vs:bde,getUniforms:function(n=wde){return n.viewport?function({viewport:n,devicePixelRatio:e=1,modelMatrix:t=null,coordinateSystem:i=Fi.DEFAULT,coordinateOrigin:r,autoWrapLongitude:s=!1}={}){i===Fi.DEFAULT&&(i=n.isGeospatial?Fi.LNGLAT:Fi.CARTESIAN);const o=Tle({viewport:n,devicePixelRatio:e,coordinateSystem:i,coordinateOrigin:r});return o.project_uWrapLongitude=s,o.project_uModelMatrix=t||Sle,o}(n):{}}},Cde=wS(function({viewport:n,center:e}){return new Gn(n.viewProjectionMatrix).invert().transform(e)}),Tde=wS(function({viewport:n,shadowMatrices:e}){const t=[],i=n.pixelUnprojectionMatrix,r=n.isGeospatial?void 0:1,s=[[0,0,r],[n.width,0,r],[0,n.height,r],[n.width,n.height,r],[0,0,-1],[n.width,0,-1],[0,n.height,-1],[n.width,n.height,-1]].map(o=>function(n,e){const[t,i,r]=n,s=R0([t,i,r],e);return Number.isFinite(r)?s:[s[0],s[1],0]}(o,i));for(const o of e){const a=o.clone().translate(new So(n.center).negate()),l=s.map(u=>a.transform(u)),c=(new Gn).ortho({left:Math.min(...l.map(u=>u[0])),right:Math.max(...l.map(u=>u[0])),bottom:Math.min(...l.map(u=>u[1])),top:Math.max(...l.map(u=>u[1])),near:Math.min(...l.map(u=>-u[2])),far:Math.max(...l.map(u=>-u[2]))});t.push(c.multiplyRight(o))}return t}),Ade=[0,0,0,1],Mde=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],NO={name:"shadow",dependencies:[RO],vs:"\nconst int max_lights = 2;\nuniform mat4 shadow_uViewProjectionMatrices[max_lights];\nuniform vec4 shadow_uProjectCenters[max_lights];\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform int shadow_uLightId;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nvec4 shadow_setVertexPosition(vec4 position_commonspace) {\n  if (shadow_uDrawShadowMap) {\n    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);\n  }\n  if (shadow_uUseShadowMap) {\n    for (int i = 0; i < max_lights; i++) {\n      if(i < int(shadow_uLightCount)) {\n        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);\n        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;\n      }\n    }\n  }\n  return gl_Position;\n}\n",fs:"\nconst int max_lights = 2;\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform sampler2D shadow_uShadowMap0;\nuniform sampler2D shadow_uShadowMap1;\nuniform vec4 shadow_uColor;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nconst vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);\nconst vec4 bitUnpackShift = 1.0 / bitPackShift;\nconst vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);\n\nfloat shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {\n  vec4 rgbaDepth = texture2D(shadowMap, position.xy);\n\n  float z = dot(rgbaDepth, bitUnpackShift);\n  return smoothstep(0.001, 0.01, position.z - z);\n}\n\nvec4 shadow_filterShadowColor(vec4 color) {\n  if (shadow_uDrawShadowMap) {\n    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);\n    rgbaDepth -= rgbaDepth.gbaa * bitMask;\n    return rgbaDepth;\n  }\n  if (shadow_uUseShadowMap) {\n    float shadowAlpha = 0.0;\n    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);\n    if(shadow_uLightCount > 1.0) {\n      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);\n    }\n    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;\n    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);\n\n    return vec4(\n      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),\n      blendedAlpha\n    );\n  }\n  return color;\n}\n",inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    position = shadow_setVertexPosition(geometry.position);\n    ","fs:DECKGL_FILTER_COLOR":"\n    color = shadow_filterShadowColor(color);\n    "},getUniforms:(n={},e={})=>{if(n.drawToShadowMap||n.shadowMaps&&n.shadowMaps.length>0){const{shadowEnabled:t=!0}=n;return t&&n.shadowMatrices&&n.shadowMatrices.length>0?function(n={},e={}){const t={shadow_uDrawShadowMap:Boolean(n.drawToShadowMap),shadow_uUseShadowMap:!!n.shadowMaps&&n.shadowMaps.length>0,shadow_uColor:n.shadowColor||Ade,shadow_uLightId:n.shadowLightId||0,shadow_uLightCount:n.shadowMatrices.length},i=Cde({viewport:n.viewport,center:e.project_uCenter}),r=[],s=Tde({shadowMatrices:n.shadowMatrices,viewport:n.viewport}).slice();for(let o=0;o<n.shadowMatrices.length;o++){const a=s[o],l=a.clone().translate(new So(n.viewport.center).negate());e.project_uCoordinateSystem===Fi.LNGLAT&&e.project_uProjectionMode===Wc.WEB_MERCATOR?(s[o]=l,r[o]=i):(s[o]=a.clone().multiplyRight(Mde),r[o]=l.transform(i))}for(let o=0;o<s.length;o++)t["shadow_uViewProjectionMatrices[".concat(o,"]")]=s[o],t["shadow_uProjectCenters[".concat(o,"]")]=r[o],t["shadow_uShadowMap".concat(o)]=n.shadowMaps&&n.shadowMaps.length>0?n.shadowMaps[o]:n.dummyShadowMap;return t}(n,e):{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1}}return{}}},Nde={color:[255,255,255],intensity:1},Cz=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],Pde=[0,0,0,200/255];class PO extends Sz{constructor(e){super(e),this.ambientLight=null,this.directionalLights=[],this.pointLights=[],this.shadowColor=Pde,this.shadowPasses=[],this.shadowMaps=[],this.dummyShadowMap=null,this.shadow=!1,this.programManager=null;for(const t in e){const i=e[t];switch(i.type){case"ambient":this.ambientLight=i;break;case"directional":this.directionalLights.push(i);break;case"point":this.pointLights.push(i)}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(t=>t.shadow)}preRender(e,{layers:t,layerFilter:i,viewports:r,onViewportActive:s,views:o}){if(this.shadow){this.shadowMatrices=this._createLightMatrix(),0===this.shadowPasses.length&&this._createShadowPasses(e),this.programManager||(this.programManager=M0.getDefaultProgramManager(e),NO&&this.programManager.addDefaultModule(NO)),this.dummyShadowMap||(this.dummyShadowMap=new da(e,{width:1,height:1}));for(let a=0;a<this.shadowPasses.length;a++)this.shadowPasses[a].render({layers:t,layerFilter:i,viewports:r,onViewportActive:s,views:o,moduleParameters:{shadowLightId:a,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(e){const t=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return t.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(i=>i.getProjectedLight({layer:e})),pointLights:this.pointLights.map(i=>i.getProjectedLight({layer:e}))},t}cleanup(){for(const e of this.shadowPasses)e.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(NO),this.programManager=null)}_createLightMatrix(){const e=[];for(const t of this.directionalLights){const i=(new Gn).lookAt({eye:new So(t.direction).negate()});e.push(i)}return e}_createShadowPasses(e){for(let t=0;t<this.directionalLights.length;t++){const i=new mde(e);this.shadowPasses[t]=i,this.shadowMaps[t]=i.shadowMap}}_applyDefaultLights(){const{ambientLight:e,pointLights:t,directionalLights:i}=this;!e&&0===t.length&&0===i.length&&(this.ambientLight=new wz(Nde),this.directionalLights.push(new Ez(Cz[0]),new Ez(Cz[1])))}}let Fde=1,Lde=1;class Tz{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(e){const{delay:t=0,duration:i=Number.POSITIVE_INFINITY,rate:r=1,repeat:s=1}=e,o=Fde++,a={time:0,delay:t,duration:i,rate:r,repeat:s};return this._setChannelTime(a,this.time),this.channels.set(o,a),o}removeChannel(e){this.channels.delete(e);for(const[t,i]of this.animations)i.channel===e&&this.detachAnimation(t)}isFinished(e){const t=this.channels.get(e);return void 0!==t&&this.time>=t.delay+t.duration*t.repeat}getTime(e){if(void 0===e)return this.time;const t=this.channels.get(e);return void 0===t?-1:t.time}setTime(e){this.time=Math.max(0,e);const t=this.channels.values();for(const r of t)this._setChannelTime(r,this.time);const i=this.animations.values();for(const r of i){const{animation:s,channel:o}=r;s.setTime(this.getTime(o))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,t){const i=Lde++;return this.animations.set(i,{animation:e,channel:t}),e.setTime(this.getTime(t)),i}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(-1===this.lastEngineTime&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,t){const i=t-e.delay;i>=e.duration*e.repeat?e.time=e.duration*e.rate:(e.time=Math.max(0,i)%e.duration,e.time*=e.rate)}}class kde{constructor(e,t,i){this.id=e,this.context=i,this._loadCount=0,this._subscribers=new Set,this.setData(t)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,t){if(e===this._data&&!t)return;this._data=e;const i=++this._loadCount;let r=e;"string"==typeof e&&(r=V0(e)),r instanceof Promise?(this.isLoaded=!1,this._loader=r.then(s=>{this._loadCount===i&&(this.isLoaded=!0,this._error=null,this._content=s)}).catch(s=>{this._loadCount===i&&(this.isLoaded=!0,this._error=s||!0)})):(this.isLoaded=!0,this._error=null,this._content=e);for(const s of this._subscribers)s.onChange(this.getData())}}class Bde{constructor({gl:e,protocol:t}){this.protocol=t||"resource://",this._context={gl:e,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return!!e.startsWith(this.protocol)||e in this._resources}add({resourceId:e,data:t,forceUpdate:i=!1,persistent:r=!0}){let s=this._resources[e];s?s.setData(t,i):(s=new kde(e,t,this._context),this._resources[e]=s),s.persistent=r}remove(e){const t=this._resources[e];t&&(t.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const t=this._consumers[e];if(t){for(const i in t){const r=t[i];r.resource&&r.resource.unsubscribe(r)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:t,consumerId:i,requestId:r="default"}){const{_resources:s,protocol:o}=this;e.startsWith(o)&&(s[e=e.replace(o,"")]||this.add({resourceId:e,data:null,persistent:!1}));const a=s[e];if(this._track(i,r,a,t),a)return a.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,t,i,r){const s=this._consumers,o=s[e]=s[e]||{},a=o[t]||{};a.resource&&(a.resource.unsubscribe(a),a.resource=null,this.prune()),i&&(o[t]=a,a.onChange=r,a.resource=i,i.subscribe(a))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const t=this._resources[e];!t.persistent&&!t.inUse()&&(t.delete(),delete this._resources[e])}}}const Vde=[{name:"geometry",vs:"\nstruct VertexGeometry {\n  vec4 position;\n  vec3 worldPosition;\n  vec3 worldPositionAlt;\n  vec3 normal;\n  vec2 uv;\n  vec3 pickingColor;\n} geometry;\n",fs:"\n#define SMOOTH_EDGE_RADIUS 0.5\n\nstruct FragmentGeometry {\n  vec2 uv;\n} geometry;\n\nfloat smoothedge(float edge, float x) {\n  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);\n}\n"},RO],jde=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function Ude(n){const e=M0.getDefaultProgramManager(n);for(const t of Vde)e.addDefaultModule(t);for(const t of jde)e.addShaderHook(t);return e}const Gde=Object.seal({layerManager:null,resourceManager:null,deck:null,gl:null,stats:null,shaderCache:null,pickingFBO:null,mousePosition:null,userData:{}});class $de{constructor(e,{deck:t,stats:i,viewport:r,timeline:s}={}){this.lastRenderedLayers=[],this.layers=[],this.resourceManager=new Bde({gl:e,protocol:"deck://"}),this.context=wn(ot({},Gde),{layerManager:this,gl:e,deck:t,programManager:e&&Ude(e),stats:i||new QD({id:"deck.gl"}),viewport:r||new Yg({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:s||new Tz,resourceManager:this.resourceManager}),this._nextLayers=null,this._needsRedraw="Initial render",this._needsUpdate=!1,this._debug=!1,this.activateViewport=this.activateViewport.bind(this),Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let t=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const i of this.layers){const r=i.getNeedsRedraw(e);t=t||r}return t}needsUpdate(){return this._nextLayers&&this._nextLayers!==this.lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e=null}={}){return e?this.layers.filter(t=>e.find(i=>0===t.id.indexOf(i))):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,t){xo("layerManager.setLayers",this,t,e),this.lastRenderedLayers=e,e=hI(e,Boolean);for(const i of e)i.context=this.context;return this._updateLayers(this.layers,e),this}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw("updating layers: ".concat(e)),this.setLayers(this._nextLayers||this.lastRenderedLayers,e)),this._nextLayers=null}activateViewport(e){return xo("layerManager.activateViewport",this,e),e&&(this.context.viewport=e),this}_handleError(e,t,i){i.raiseError(t,"".concat(e," of ").concat(i))}_updateLayers(e,t){const i={};for(const o of e)i[o.id]?Mi.warn("Multiple old layers with same id ".concat(o.id))():i[o.id]=o;const r=[];this._updateSublayersRecursively(t,i,r),this._finalizeOldLayers(i);let s=!1;for(const o of r)if(o.hasUniformTransition()){s=!0;break}this._needsUpdate=s,this.layers=r}_updateSublayersRecursively(e,t,i){for(const r of e){r.context=this.context;const s=t[r.id];null===s&&Mi.warn("Multiple new layers with same id ".concat(r.id))(),t[r.id]=null;let o=null;try{this._debug&&s!==r&&r.validateProps(),s?(this._transferLayerState(s,r),this._updateLayer(r)):this._initializeLayer(r),i.push(r),o=r.isComposite&&r.getSubLayers()}catch(a){this._handleError("matching",a,r)}o&&this._updateSublayersRecursively(o,t,i)}}_finalizeOldLayers(e){for(const t in e){const i=e[t];i&&this._finalizeLayer(i)}}_initializeLayer(e){try{e._initialize(),e.lifecycle="Initialized"}catch(t){this._handleError("initialization",t,e)}}_transferLayerState(e,t){t._transferState(e),t.lifecycle="Matched. State transferred from previous layer",t!==e&&(e.lifecycle="Discarded. Awaiting garbage collection")}_updateLayer(e){try{e._update()}catch(t){this._handleError("update",t,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||"finalized ".concat(e),e.lifecycle="No longer matched. Awaiting garbage collection";try{e._finalize(),e.lifecycle="Finalized! Awaiting garbage collection"}catch(t){this._handleError("finalization",t,e)}}}class Wde{constructor(e={}){this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="Initial render",this._needsUpdate=!0,this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers)this.controllers[e]&&this.controllers[e].finalize();this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const t=this.controllers[e];t&&t.updateTransition()}}getViewports(e){return e?this._viewports.filter(t=>t.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(t=>{e[t.id]=t}),e}getView(e){return"string"==typeof e?this.views.find(t=>t.id===e):e}getViewState(e){const t=this.getView(e),i=t&&this.viewState[t.getViewStateId()]||this.viewState;return t?t.filterViewState(i):i}getViewport(e){return this._viewportMap[e]}unproject(e,t){const i=this.getViewports(),r={x:e[0],y:e[1]};for(let s=i.length-1;s>=0;--s){const o=i[s];if(o.containsPixel(r)){const a=e.slice();return a[0]-=o.x,a[1]-=o.y,o.unproject(a,t)}}return null}setProps(e){"views"in e&&this._setViews(e.views),"viewState"in e&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,t){(e!==this.width||t!==this.height)&&(this.width=e,this.height=t,this.setNeedsUpdate("Size changed"))}_setViews(e){e=hI(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!U0(e,this.viewState)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):Mi.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(e,t){t.viewId=e,this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange(t)}_createController(e,t){return new(0,t.type)(ot({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,t.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:s=>e._getViewport(s,{width:s.width,height:s.height})},t))}_updateController(e,t,i,r){let s=e.controller;return s?(s=wn(ot(ot(ot({},t),e.props),s),{id:e.id,x:i.x,y:i.y,width:i.width,height:i.height}),r?r.setProps(s):r=this._createController(e,s),r):null}_rebuildViewports(){const{width:e,height:t,views:i}=this,r=this.controllers;this._viewports=[],this.controllers={};let s=!1;for(let o=i.length;o--;){const a=i[o],l=this.getViewState(a),c=a.makeViewport({width:e,height:t,viewState:l});let u=r[a.id];a.controller&&!u&&(s=!0),(s||!a.controller)&&u&&(u.finalize(),u=null),this.controllers[a.id]=this._updateController(a,l,c,u),this._viewports.unshift(c)}for(const o in r)r[o]&&!this.controllers[o]&&r[o].finalize();this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,t){return e.length!==t.length||e.some((i,r)=>!e[r].equals(t[r]))}}class Yde extends bz{constructor({makeViewport:e,width:t,height:i,latitude:r,longitude:s,zoom:o,bearing:a=0,pitch:l=0,altitude:c=1.5,maxZoom:u=20,minZoom:h=0,maxPitch:f=60,minPitch:g=0,startPanLngLat:m,startZoomLngLat:w,startRotatePos:S,startBearing:U,startPitch:D,startZoom:ie,normalize:_e}={}){oc(Number.isFinite(s)),oc(Number.isFinite(r)),oc(Number.isFinite(o)),super({width:t,height:i,latitude:r,longitude:s,zoom:o,bearing:a,pitch:l,altitude:c,maxZoom:u,minZoom:h,maxPitch:f,minPitch:g,normalize:_e}),this._state={startPanLngLat:m,startZoomLngLat:w,startRotatePos:S,startBearing:U,startPitch:D,startZoom:ie},this.makeViewport=e}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:t}){const i=this._state.startPanLngLat||this._unproject(t);if(!i)return this;const s=this.makeViewport(this._viewportProps).panByPosition(i,e);return this._getUpdatedState(s)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this._viewportProps.bearing,startPitch:this._viewportProps.pitch})}rotate({pos:e,deltaAngleX:t=0,deltaAngleY:i=0}){const{startRotatePos:r,startBearing:s,startPitch:o}=this._state;if(!r||!Number.isFinite(s)||!Number.isFinite(o))return this;let a;return a=e?this._calculateNewPitchAndBearing(wn(ot({},this._getRotationParams(e,r)),{startBearing:s,startPitch:o})):{bearing:s+t,pitch:o+i},this._getUpdatedState(a)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this._viewportProps.zoom})}zoom({pos:e,startPos:t,scale:i}){let{startZoom:r,startZoomLngLat:s}=this._state;Number.isFinite(r)||(r=this._viewportProps.zoom,s=this._unproject(t)||this._unproject(e));const o=this._calculateNewZoom({scale:i,startZoom:r}),a=this.makeViewport(wn(ot({},this._viewportProps),{zoom:o}));return this._getUpdatedState(ot({zoom:o},a.panByPosition(s,e)))}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this._viewportProps.bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this._viewportProps.bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this._viewportProps.pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this._viewportProps.pitch-e})}shortestPathFrom(e){const t=e.getViewportProps(),i=ot({},this._viewportProps),{bearing:r,longitude:s}=i;return Math.abs(r-t.bearing)>180&&(i.bearing=r<0?r+360:r-360),Math.abs(s-t.longitude)>180&&(i.longitude=s<0?s+360:s-360),i}_zoomFromCenter(e){const{width:t,height:i}=this._viewportProps;return this.zoom({pos:[t/2,i/2],scale:e})}_panFromCenter(e){const{width:t,height:i}=this._viewportProps;return this.pan({startPos:[t/2,i/2],pos:[t/2+e[0],i/2+e[1]]})}_getUpdatedState(e){return new this.constructor(ot(ot(ot({makeViewport:this.makeViewport},this._viewportProps),this._state),e))}_applyConstraints(e){const{maxZoom:t,minZoom:i,zoom:r}=e;e.zoom=Pa(r,i,t);const{maxPitch:s,minPitch:o,pitch:a}=e;e.pitch=Pa(a,o,s);const{normalize:l=!0}=e;return l&&Object.assign(e,function({width:n,height:e,longitude:t,latitude:i,zoom:r,pitch:s=0,bearing:o=0}){(t<-180||t>180)&&(t=vU(t+180,360)-180),(o<-180||o>180)&&(o=vU(o+180,360)-180);const a=LI(e/512);if(r<=a)r=a,i=0;else{const l=e/2/Math.pow(2,r),c=qg([0,l])[1];if(i<c)i=c;else{const u=qg([0,512-l])[1];i>u&&(i=u)}}return{width:n,height:e,longitude:t,latitude:i,zoom:r,pitch:s,bearing:o}}(e)),e}_unproject(e){const t=this.makeViewport(this._viewportProps);return e&&t.unproject(e)}_calculateNewZoom({scale:e,startZoom:t}){const{maxZoom:i,minZoom:r}=this._viewportProps;return Pa(t+Math.log2(e),r,i)}_calculateNewPitchAndBearing({deltaScaleX:e,deltaScaleY:t,startBearing:i,startPitch:r}){t=Pa(t,-1,1);const{minPitch:s,maxPitch:o}=this._viewportProps;let l=r;return t>0?l=r+t*(o-r):t<0&&(l=r-t*(s-r)),{pitch:l,bearing:i+180*e}}_getRotationParams(e,t){const i=e[0]-t[0],r=e[1]-t[1],s=e[1],o=t[1],{width:a,height:l}=this._viewportProps,c=i/a;let u=0;return r>0?Math.abs(l-o)>5&&(u=r/(o-l)*1.2):r<0&&o>5&&(u=1-s/o),u=Math.min(1,Math.max(-1,u)),{deltaScaleX:c,deltaScaleY:u}}}class Kde extends IO{constructor(e){e.dragMode=e.dragMode||"pan",super(Yde,e)}setProps(e){const t=this.controllerStateProps;super.setProps(e),(!t||t.height!==e.height)&&this.updateViewport(new this.ControllerState(ot(ot({makeViewport:this.makeViewport},this.controllerStateProps),this._state)))}get linearTransitionProps(){return["longitude","latitude","zoom","bearing","pitch"]}}let Xde=(()=>{class n extends DO{constructor(t){super(wn(ot({},t),{type:RU}))}get controller(){return this._getControllerProps({type:Kde})}}return n.displayName="MapView",n})();const Qde=new PO;class Zde{constructor(){this.effects=[],this._internalEffects=[],this._needsRedraw="Initial render",this.setEffects()}setProps(e){"effects"in e&&(e.effects.length!==this.effects.length||!U0(e.effects,this.effects))&&(this.setEffects(e.effects),this._needsRedraw="effects changed")}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}getEffects(){return this._internalEffects}finalize(){this.cleanup()}setEffects(e=[]){this.cleanup(),this.effects=e,this._createInternalEffects()}cleanup(){for(const e of this.effects)e.cleanup();for(const e of this._internalEffects)e.cleanup();this.effects.length=0,this._internalEffects.length=0}_createInternalEffects(){this._internalEffects=this.effects.slice(),this.effects.some(e=>e instanceof PO)||this._internalEffects.push(Qde)}}class Jde extends OO{}const Mz={blendFunc:[1,0,32771,0],blendEquation:32774};class Dz extends OO{render(e){e.pickingFBO?(this.useAlpha=!0,this._drawPickingBuffer(e)):(this.useAlpha=!1,super.render(e))}_drawPickingBuffer({layers:e,layerFilter:t,views:i,viewports:r,onViewportActive:s,pickingFBO:o,deviceRect:{x:a,y:l,width:c,height:u},pass:h="picking",redrawReason:f,pickZ:g}){const m=this.gl;return this.pickZ=g,sc(m,wn(ot({scissorTest:!0,scissor:[a,l,c,u],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0]},Mz),{blend:!g}),()=>{super.render({target:o,layers:e,layerFilter:t,views:i,viewports:r,onViewportActive:s,pass:h,redrawReason:f})})}shouldDrawLayer(e){return e.props.pickable}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(e,t){const i=this.pickZ?{blend:!1}:wn(ot({},Mz),{blend:!0,blendColor:[0,0,0,this.useAlpha?(t+1)/255:1]});return ot(ot({},e.props.parameters),i)}}class the{constructor(e){this.gl=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new Jde(e),this.pickLayersPass=new Dz(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){"layerFilter"in e&&this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),"drawPickingColors"in e&&this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){const t=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass;e.layerFilter=this.layerFilter,e.effects=e.effects||[],e.target=e.target||Rs.getDefaultFramebuffer(this.gl),this._preRender(e.effects,e);const i=this.lastPostProcessEffect?this.renderBuffers[0]:e.target,r=t.render(wn(ot({},e),{target:i}));this._postRender(e.effects,e),this.renderCount++,xo("deckRenderer.renderLayers",this,r,e)}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}finalize(){const{renderBuffers:e}=this;for(const t of e)t.delete();e.length=0}_preRender(e,t){let i=null;for(const r of e)r.preRender(this.gl,t),r.postRender&&(i=r);i&&this._resizeRenderBuffers(),this.lastPostProcessEffect=i}_resizeRenderBuffers(){const{renderBuffers:e}=this;0===e.length&&e.push(new Rs(this.gl),new Rs(this.gl));for(const t of e)t.resize()}_postRender(e,t){const{renderBuffers:i}=this,r={inputBuffer:i[0],swapBuffer:i[1],target:null};for(const s of e)if(s.postRender){if(s===this.lastPostProcessEffect){r.target=t.target,s.postRender(this.gl,r);break}const o=s.postRender(this.gl,r);r.inputBuffer=o,r.swapBuffer=o===i[0]?i[1]:i[0]}}}const nhe={pickedColor:null,pickedLayer:null,pickedObjectIndex:-1};function ihe({pickedColors:n,layers:e,deviceX:t,deviceY:i,deviceRadius:r,deviceRect:s}){if(n){const{x:o,y:a,width:l,height:c}=s;let u=r*r,h=-1,f=0;for(let g=0;g<c;g++){const m=g+a-i,w=m*m;if(w>u)f+=4*l;else for(let S=0;S<l;S++){if(n[f+3]-1>=0){const D=S+o-t,ie=D*D+w;ie<=u&&(u=ie,h=f)}f+=4}}if(h>=0){const g=n[h+3]-1,m=n.slice(h,h+4),w=e[g];if(w){const S=w.decodePickingColor(m),U=Math.floor(h/4/l);return{pickedColor:m,pickedLayer:w,pickedObjectIndex:S,pickedX:o+(h/4-U*l),pickedY:a+U}}Mi.error("Picked non-existent layer. Is picking buffer corrupt?")()}}return nhe}function Iz({pickInfo:n,mode:e,viewports:t,layerFilter:i,pixelRatio:r,x:s,y:o,z:a}){const l=n&&n.pickedLayer,u=function(n,e,t){for(let i=n.length-1;i>=0;i--){const r=n[i];if(r.containsPixel(e)&&(!t||t(r)))return r}return n[0]}(t,{x:s,y:o},i&&l&&(f=>i({layer:l,viewport:f,isPicking:!0,renderPass:"picking:".concat(e)}))),h=u&&u.unproject([s-u.x,o-u.y],{targetZ:a});return{color:null,layer:null,viewport:u,index:-1,picked:!1,x:s,y:o,pixel:[s,o],coordinate:h,devicePixel:n&&[n.pickedX,n.pickedY],pixelRatio:r}}function she(n){const{pickInfo:e,lastPickedInfo:t,mode:i,layers:r}=n,{pickedColor:s,pickedLayer:o,pickedObjectIndex:a}=e,l=o?[o]:[];if("hover"===i){const h=t.index,f=t.layerId,g=o&&o.props.id;if(g!==f||a!==h){if(g!==f){const m=r.find(w=>w.props.id===f);m&&l.unshift(m)}t.layerId=g,t.index=a,t.info=null}}const c=Iz(n),u=new Map;return u.set(null,c),l.forEach(h=>{let f=ot({},c);h===o&&(f.color=s,f.index=a,f.picked=!0),f=Oz({layer:h,info:f,mode:i}),h===o&&"hover"===i&&(t.info=f),u.set(f.layer.id,f),"hover"===i&&f.layer.updateAutoHighlight(f)}),u}function Oz({layer:n,info:e,mode:t}){for(;n&&e;){const i=e.layer||null;e.sourceLayer=i,e.layer=n,e=n.getPickingInfo({info:e,mode:t,sourceLayer:i}),n=n.parent}return e}class ahe{constructor(e){this.gl=e,this.pickingFBO=null,this.pickLayersPass=new Dz(e),this.layerFilter=null,this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:t,layers:i,viewports:r},s=this.lastPickedInfo.info){const o=s&&s.layer&&s.layer.id,a=s&&s.viewport&&s.viewport.id,l=o?i.find(f=>f.id===o):null,c=a&&r.find(f=>f.id===a)||r[0],u=c&&c.unproject([e-c.x,t-c.y]),h={x:e,y:t,viewport:c,coordinate:u,layer:l};return l?ot(ot({},s),h):Object.assign(h,{color:null,object:null,index:-1})}_resizeBuffer(){const{gl:e}=this;return this.pickingFBO||(this.pickingFBO=new Rs(e),Rs.isSupported(e,{colorBufferFloat:!0})&&(this.depthFBO=new Rs(e),this.depthFBO.attach({36064:new da(e,{format:_i(e)?34836:6408,type:5126})}))),this.pickingFBO.resize({width:e.canvas.width,height:e.canvas.height}),this.depthFBO&&this.depthFBO.resize({width:e.canvas.width,height:e.canvas.height}),this.pickingFBO}_getPickable(e){if(!1===this._pickable)return null;const t=e.filter(i=>i.isPickable()&&!i.isComposite);return t.length>255?(Mi.warn("Too many pickable layers, only picking the first 255")(),t.slice(0,255)):t.length?t:null}_pickClosestObject({layers:e,views:t,viewports:i,x:r,y:s,radius:o=0,depth:a=1,mode:l="query",unproject3D:c,onViewportActive:u}){if(!(e=this._getPickable(e)))return{result:[],emptyInfo:Iz({viewports:i,x:r,y:s})};this._resizeBuffer();const h=Ng(this.gl),f=YD(this.gl,[r,s],!0),g=[f.x+Math.floor(f.width/2),f.y+Math.floor(f.height/2)],m=Math.round(o*h),{width:w,height:S}=this.pickingFBO,U=this._getPickingRect({deviceX:g[0],deviceY:g[1],deviceRadius:m,deviceWidth:w,deviceHeight:S});let D;const ie=[],_e={};for(let Ne=0;Ne<a;Ne++){const Ve=ihe({pickedColors:U&&this._drawAndSample({layers:e,views:t,viewports:i,onViewportActive:u,deviceRect:U,pass:"picking:".concat(l),redrawReason:l}),layers:e,deviceX:g[0],deviceY:g[1],deviceRadius:m,deviceRect:U});let vt;if(Ve.pickedLayer&&c&&this.depthFBO&&(vt=this._drawAndSample({layers:[Ve.pickedLayer],views:t,viewports:i,onViewportActive:u,deviceRect:{x:Ve.pickedX,y:Ve.pickedY,width:1,height:1},pass:"picking:".concat(l),redrawReason:"pick-z",pickZ:!0})[0]*i[0].distanceScales.metersPerUnit[2]+i[0].position[2]),Ve.pickedColor&&Ne+1<a){const wt=Ve.pickedColor[3]-1;_e[wt]=!0,e[wt].disablePickingIndex(Ve.pickedObjectIndex)}D=she({pickInfo:Ve,lastPickedInfo:this.lastPickedInfo,mode:l,layers:e,layerFilter:this.layerFilter,viewports:i,x:r,y:s,z:vt,pixelRatio:h});for(const wt of D.values())wt.layer&&ie.push(wt);if(!Ve.pickedColor)break}for(const Ne in _e)e[Ne].restorePickingColors();return{result:ie,emptyInfo:D&&D.get(null)}}_pickVisibleObjects({layers:e,views:t,viewports:i,x:r,y:s,width:o=1,height:a=1,mode:l="query",maxObjects:c=null,onViewportActive:u}){if(!(e=this._getPickable(e)))return[];this._resizeBuffer();const h=Ng(this.gl),f=YD(this.gl,[r,s],!0),g=f.x,m=f.y+f.height,w=YD(this.gl,[r+o,s+a],!0),U=w.y,_e=function({pickedColors:n,layers:e}){const t=new Map;if(n)for(let i=0;i<n.length;i+=4){const r=n[i+3]-1;if(r>=0){const s=n.slice(i,i+4),o=s.join(",");if(!t.has(o)){const a=e[r];a?t.set(o,{pickedColor:s,pickedLayer:a,pickedObjectIndex:a.decodePickingColor(s)}):Mi.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(t.values())}({pickedColors:this._drawAndSample({layers:e,views:t,viewports:i,onViewportActive:u,deviceRect:{x:g,y:U,width:w.x+w.width-g,height:m-U},pass:"picking:".concat(l),redrawReason:l}),layers:e}),Ne=new Map,Pe=Number.isFinite(c);for(let Ve=0;Ve<_e.length&&!(Pe&&Ne.size>=c);Ve++){const vt=_e[Ve];let wt={color:vt.pickedColor,layer:null,index:vt.pickedObjectIndex,picked:!0,x:r,y:s,width:o,height:a,pixelRatio:h};wt=Oz({layer:vt.pickedLayer,info:wt,mode:l}),Ne.has(wt.object)||Ne.set(wt.object,wt)}return Array.from(Ne.values())}_drawAndSample({layers:e,views:t,viewports:i,onViewportActive:r,deviceRect:s,pass:o,redrawReason:a,pickZ:l}){if(e.length<1)return null;const c=l?this.depthFBO:this.pickingFBO;this.pickLayersPass.render({layers:e,layerFilter:this.layerFilter,views:t,viewports:i,onViewportActive:r,pickingFBO:c,deviceRect:s,pass:o,redrawReason:a,pickZ:l});const{x:u,y:h,width:f,height:g}=s,m=new(l?Float32Array:Uint8Array)(f*g*4);return rS(c,{sourceX:u,sourceY:h,sourceWidth:f,sourceHeight:g,target:m}),m}_getPickingRect({deviceX:e,deviceY:t,deviceRadius:i,deviceWidth:r,deviceHeight:s}){const o=Math.max(0,e-i),a=Math.max(0,t-i),l=Math.min(r,e+i+1)-o,c=Math.min(s,t+i+1)-a;return l<=0||c<=0?null:{x:o,y:a,width:l,height:c}}}const lhe={zIndex:1,position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:0,left:0,display:"none"};class che{constructor(e){const t=e.parentElement;t&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,lhe),t.appendChild(this.el)),this.isVisible=!1}setTooltip(e,t,i){const r=this.el;if("string"==typeof e)r.innerText=e;else{if(!e)return this.isVisible=!1,void(r.style.display="none");"text"in e&&(r.innerText=e.text),"html"in e&&(r.innerHTML=e.html),"className"in e&&(r.className=e.className),Object.assign(r.style,e.style)}this.isVisible=!0,r.style.display="block",r.style.transform="translate(".concat(t,"px, ").concat(i,"px)")}remove(){this.el&&this.el.remove()}}function Rz(n,e){if(!n)throw new Error(e)}const Jc={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document},Nz=Jc.global||Jc.self||Jc.window,dhe="object"!=typeof process||"[object process]"!==String(process)||process.browser,Pz="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version),{_parseImageNode:hhe}=(Pz&&parseFloat(Pz[1]),Nz),FO="undefined"!=typeof Image,LO="undefined"!=typeof ImageBitmap,fhe=Boolean(hhe),kO=!!dhe||fhe;function Fz(n){const e=function(n){return"undefined"!=typeof ImageBitmap&&n instanceof ImageBitmap?"imagebitmap":"undefined"!=typeof Image&&n instanceof Image?"image":n&&"object"==typeof n&&n.data&&n.width&&n.height?"data":null}(n);if(!e)throw new Error("Not an image");return e}function Lz(n){switch(Fz(n)){case"data":return n;case"image":case"imagebitmap":const e=document.createElement("canvas"),t=e.getContext("2d");if(!t)throw new Error("getImageData");return e.width=n.width,e.height=n.height,t.drawImage(n,0,0),t.getImageData(0,0,n.width,n.height);default:throw new Error("getImageData")}}const mhe=/^data:image\/svg\+xml/,_he=/\.svg((\?|#).*)?$/;function BO(n){return n&&(mhe.test(n)||_he.test(n))}function yhe(n,e){if(BO(e)){let i=(new TextDecoder).decode(n);try{"function"==typeof unescape&&"function"==typeof encodeURIComponent&&(i=unescape(encodeURIComponent(i)))}catch(s){throw new Error(s.message)}return`data:image/svg+xml;base64,${btoa(i)}`}return Bz(n,e)}function Bz(n,e){if(BO(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(n)])}function Vz(n,e,t){return VO.apply(this,arguments)}function VO(){return(VO=ni(function*(n,e,t){const i=yhe(n,t),r=self.URL||self.webkitURL,s="string"!=typeof i&&r.createObjectURL(i);try{return yield vhe(s||i,e)}finally{s&&r.revokeObjectURL(s)}})).apply(this,arguments)}function vhe(n,e){return jO.apply(this,arguments)}function jO(){return(jO=ni(function*(n,e){const t=new Image;return t.src=n,e.image&&e.image.decode&&t.decode?(yield t.decode(),t):yield new Promise((i,r)=>{try{t.onload=()=>i(t),t.onerror=s=>r(new Error(`Could not load image ${n}: ${s}`))}catch(s){r(s)}})})).apply(this,arguments)}const bhe={};let jz=!0;function whe(n,e,t){return UO.apply(this,arguments)}function UO(){return(UO=ni(function*(n,e,t){let i;i=BO(t)?yield Vz(n,e,t):Bz(n,t);const r=e&&e.imagebitmap;return yield Ehe(i,r)})).apply(this,arguments)}function Ehe(n){return zO.apply(this,arguments)}function zO(){return(zO=ni(function*(n,e=null){if((She(e)||!jz)&&(e=null),e)try{return yield createImageBitmap(n,e)}catch(t){console.warn(t),jz=!1}return yield createImageBitmap(n)})).apply(this,arguments)}function She(n){for(const e in n||bhe)return!1;return!0}const eu=!1,H0=!0;function HO(n){const e=G0(n);return function(n){const e=G0(n);return e.byteLength>=24&&2303741511===e.getUint32(0,eu)?{mimeType:"image/png",width:e.getUint32(16,eu),height:e.getUint32(20,eu)}:null}(e)||function(n){const e=G0(n);if(!(e.byteLength>=3&&65496===e.getUint16(0,eu)&&255===e.getUint8(2)))return null;const{tableMarkers:i,sofMarkers:r}=function(){const n=new Set([65499,65476,65484,65501,65534]);for(let t=65504;t<65520;++t)n.add(t);return{tableMarkers:n,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}();let s=2;for(;s+9<e.byteLength;){const o=e.getUint16(s,eu);if(r.has(o))return{mimeType:"image/jpeg",height:e.getUint16(s+5,eu),width:e.getUint16(s+7,eu)};if(!i.has(o))return null;s+=2,s+=e.getUint16(s,eu)}return null}(e)||function(n){const e=G0(n);return e.byteLength>=10&&1195984440===e.getUint32(0,eu)?{mimeType:"image/gif",width:e.getUint16(6,H0),height:e.getUint16(8,H0)}:null}(e)||function(n){const e=G0(n);return e.byteLength>=14&&16973===e.getUint16(0,eu)&&e.getUint32(2,H0)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,H0),height:e.getUint32(22,H0)}:null}(e)}function G0(n){if(n instanceof DataView)return n;if(ArrayBuffer.isView(n))return new DataView(n.buffer);if(n instanceof ArrayBuffer)return new DataView(n);throw new Error("toDataView")}function Dhe(n,e){const{mimeType:t}=HO(n)||{},{_parseImageNode:i}=Nz;return Rz(i),i(n,t,e)}function GO(){return(GO=ni(function*(n,e,t){const r=((e=e||{}).image||{}).type||"auto",{url:s}=t||{};let a;switch(Ohe(r)){case"imagebitmap":a=yield whe(n,e,s);break;case"image":a=yield Vz(n,e,s);break;case"data":a=yield Dhe(n,e);break;default:Rz(!1)}return"data"===r&&(a=Lz(a)),a})).apply(this,arguments)}function Ohe(n){switch(n){case"auto":case"data":return function(){if(LO)return"imagebitmap";if(FO)return"image";if(kO)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}();default:return function(n){switch(n){case"auto":return LO||FO||kO;case"imagebitmap":return LO;case"image":return FO;case"data":return kO;default:throw new Error(`@loaders.gl/images: image ${n} not supported in this environment`)}}(n),n}}const $O={id:"image",module:"images",name:"Images",version:"3.0.12",mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],extensions:["png","jpg","jpeg","gif","webp","bmp","ico","svg"],parse:function(n,e,t){return GO.apply(this,arguments)},tests:[n=>Boolean(HO(new DataView(n)))],options:{image:{type:"auto",decode:!0}}};var Qg=et(4761);const Nhe={name:"JSON",extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:function(n){const e=n[0],t=n[n.length-1];return"{"===e&&"}"===t||"["===e&&"]"===t},parseTextSync:JSON.parse},$0="8.5.8",jS=Qg.CO.deck&&Qg.CO.deck.VERSION;if(jS&&jS!==$0)throw new Error("deck.gl - multiple versions detected: ".concat(jS," vs ").concat($0));jS||(Mi.log(1,"deck.gl ".concat($0))(),Qg.CO.deck=Object.assign(Qg.CO.deck||{},{VERSION:$0,version:$0,log:Mi,_registerLoggers:function(n){mI=n}}),uz([Nhe,[$O,{imagebitmap:{premultiplyAlpha:"none"}}]]));const Phe=Qg.CO.deck;class US extends zu{get[Symbol.toStringTag](){return"Query"}static isSupported(e,t=[]){const i=_i(e),r=KV(e,"TIMER_QUERY");let s=i||r;for(const o of t)switch(o){case"queries":s=s&&i;break;case"timers":s=s&&r;break;default:nn(!1)}return s}constructor(e,t={}){super(e,t),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(35007)}beginOcclusionQuery({conservative:e=!1}={}){return this.begin(e?36202:35887)}beginTransformFeedbackQuery(){return this.begin(35976)}begin(e){return this._queryPending||(this.target=e,this.gl2.beginQuery(this.target,this.handle)),this}end(){return this._queryPending||this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this}isResultAvailable(){if(!this._queryPending)return!1;const e=this.gl2.getQueryParameter(this.handle,34919);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.gl2.getParameter(36795)}getResult(){return this.gl2.getQueryParameter(this.handle,34918)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(e=Number.POSITIVE_INFINITY){if(this._pollingPromise)return this._pollingPromise;let t=0;return this._pollingPromise=new Promise((i,r)=>{const s=()=>{this.isResultAvailable()?(i(this.getResult()),this._pollingPromise=null):t++>e?(r("Timed out"),this._pollingPromise=null):requestAnimationFrame(s)};requestAnimationFrame(s)}),this._pollingPromise}_createHandle(){return US.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}const Uz=iS()&&"undefined"!=typeof document;let Ghe=0;class $he{constructor(e={}){const{onCreateContext:t=(S=>DV(S)),onAddHTML:i=null,onInitialize:r=(()=>{}),onRender:s=(()=>{}),onFinalize:o=(()=>{}),onError:a,gl:l=null,glOptions:c={},debug:u=!1,createFramebuffer:h=!1,autoResizeViewport:f=!0,autoResizeDrawingBuffer:g=!0,stats:m=Tf.get("animation-loop-"+Ghe++)}=e;let{useDevicePixels:w=!0}=e;"useDevicePixelRatio"in e&&(hn.deprecated("useDevicePixelRatio","useDevicePixels")(),w=e.useDevicePixelRatio),this.props={onCreateContext:t,onAddHTML:i,onInitialize:r,onRender:s,onFinalize:o,onError:a,gl:l,glOptions:c,debug:u,createFramebuffer:h},this.gl=l,this.needsRedraw=null,this.timeline=null,this.stats=m,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:f,autoResizeDrawingBuffer:g,useDevicePixels:w}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(e){return nn("string"==typeof e),this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.autoResizeViewport=e.autoResizeViewport),"autoResizeDrawingBuffer"in e&&(this.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer),"useDevicePixels"in e&&(this.useDevicePixels=e.useDevicePixels),this}start(e={}){if(this._running)return this;this._running=!0;const t=this._getPageLoadPromise().then(()=>!this._running||this._initialized?null:(this._createWebGLContext(e),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=US.isSupported(this.gl,["timers"])?new US(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps))).then(i=>{this._running&&(this._addCallbackData(i||{}),!1!==i&&this._startLoop())});return this.props.onError&&t.catch(this.props.onError),this}redraw(){return this.isContextLost()||(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers()),this}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}toDataURL(){var e=this;return ni(function*(){return e.setNeedsRedraw("toDataURL"),yield e.waitForRender(),e.gl.canvas.toDataURL()})()}isContextLost(){return this.gl.isContextLost()}onCreateContext(...e){return this.props.onCreateContext(...e)}onInitialize(...e){return this.props.onInitialize(...e)}onRender(...e){return this.props.onRender(...e)}onFinalize(...e){return this.props.onFinalize(...e)}getHTMLControlValue(e,t=1){const i=document.getElementById(e);return i?Number(i.value):t}setViewParameters(){return hn.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const e=()=>{!this._running||(this.redraw(),this._animationFrameId=this._requestAnimationFrame(e))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(e)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=Uz?new Promise((e,t)=>{Uz&&"complete"===document.readyState?e(document):window.addEventListener("load",()=>{e(document)})}):Promise.resolve({})),this._pageLoadPromise}_setDisplay(e){this.display&&(this.display.delete(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_cancelAnimationFrame(e){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(e):function(n){return"undefined"!=typeof window&&window.cancelAnimationFrame?window.cancelAnimationFrame(n):clearTimeout(n)}(e)}_requestAnimationFrame(e){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(e):function(n){return"undefined"!=typeof window&&window.requestAnimationFrame?window.requestAnimationFrame(n):setTimeout(n,1e3/60)}(e)}_renderFrame(...e){this.display?this.display._renderFrame(...e):this.onRender(...e)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:e,height:t,aspect:i}=this._getSizeAndAspect();(e!==this.animationProps.width||t!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),i!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=t,this.animationProps.aspect=i,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(e){"object"==typeof e&&null!==e&&(this.animationProps=Object.assign({},this.animationProps,e))}_createWebGLContext(e){if(this.offScreen=e.canvas&&"undefined"!=typeof OffscreenCanvas&&e.canvas instanceof OffscreenCanvas,e=Object.assign({},e,this.props.glOptions),this.gl=this.props.gl?XD(this.props.gl,e):this.onCreateContext(e),!tS(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");(function(n){Uu(n,qD)})(this.gl),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const t=document.createElement("div");t.style.position="absolute",t.style.left="10px",t.style.bottom="10px",t.style.width="300px",t.style.background="white",e.appendChild(this.gl.canvas),e.appendChild(t);const i=this.props.onAddHTML(t);i&&(t.innerHTML=i)}}_getSizeAndAspect(){const e=this.gl.drawingBufferWidth,t=this.gl.drawingBufferHeight;let i=1;const{canvas:r}=this.gl;return r&&r.clientHeight?i=r.clientWidth/r.clientHeight:e>0&&t>0&&(i=e/t),{width:e,height:t,aspect:i}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&function(n,e={}){if(n.canvas)return void function(n,e,t){let i="width"in t?t.width:n.canvas.clientWidth,r="height"in t?t.height:n.canvas.clientHeight;(!i||!r)&&(hn.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,i=n.canvas.width||1,r=n.canvas.height||1),n.luma=n.luma||{},n.luma.canvasSizeInfo=n.luma.canvasSizeInfo||{};const s=n.luma.canvasSizeInfo;if(s.clientWidth!==i||s.clientHeight!==r||s.devicePixelRatio!==e){let o=e;const a=Math.floor(i*o),l=Math.floor(r*o);n.canvas.width=a,n.canvas.height=l,(n.drawingBufferWidth!==a||n.drawingBufferHeight!==l)&&(hn.warn("Device pixel ratio clamped")(),o=Math.min(n.drawingBufferWidth/i,n.drawingBufferHeight/r),n.canvas.width=Math.floor(i*o),n.canvas.height=Math.floor(r*o)),Object.assign(n.luma.canvasSizeInfo,{clientWidth:i,clientHeight:r,devicePixelRatio:e})}}(n,function(n){const e="undefined"==typeof window?1:window.devicePixelRatio||1;return Number.isFinite(n)?n<=0?1:n:n?e:1}(e.useDevicePixels),e);const t=n.getExtension("STACKGL_resize_drawingbuffer");t&&"width"in e&&"height"in e&&t.resize(e.width,e.height)}(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new Rs(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:e}=this.gl;e&&(e.addEventListener("mousemove",this._onMousemove),e.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(e){this.animationProps._mousePosition=[e.offsetX,e.offsetY]}_onMouseleave(e){this.animationProps._mousePosition=null}}var Whe=et(1524),zS=et.n(Whe);const qhe={mousedown:1,mousemove:2,mouseup:4};(function(n){const e=n.prototype.handler;n.prototype.handler=function(i){const r=this.store;i.button>0&&"pointerdown"===i.type&&(function(n,e){for(let t=0;t<n.length;t++)if(n[t].pointerId===i.pointerId)return!0;return!1}(r)||r.push(i)),e.call(this,i)}})(zS().PointerEventInput),function(n){n.prototype.handler=function(t){let i=qhe[t.type];1&i&&t.button>=0&&(this.pressed=!0),2&i&&0===t.which&&(i=4),this.pressed&&(4&i&&(this.pressed=!1),this.callback(this.manager,i,{pointers:[t],changedPointers:[t],pointerType:"mouse",srcEvent:t}))}}(zS().MouseInput);const Qhe=zS().Manager,tu=zS(),Zhe=tu?[[tu.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[tu.Rotate,{enable:!1}],[tu.Pinch,{enable:!1}],[tu.Swipe,{enable:!1}],[tu.Pan,{threshold:0,enable:!1}],[tu.Press,{enable:!1}],[tu.Tap,{event:"doubletap",taps:2,enable:!1}],[tu.Tap,{event:"anytap",enable:!1}],[tu.Tap,{enable:!1}]]:null,Gz={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},Jhe={doubletap:["tap"]},efe={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},qO={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},tfe={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},$z={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},nfe="undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",Zg="undefined"!=typeof window?window:global;"undefined"!=typeof global?global:window,"undefined"!=typeof document&&document;let Wz=!1;try{const n={get passive(){return Wz=!0,!0}};Zg.addEventListener("test",n,n),Zg.removeEventListener("test",n,n)}catch(n){}const ife=-1!==nfe.indexOf("firefox"),{WHEEL_EVENTS:rfe}=qO,Yz=4.000244140625;class afe{constructor(e,t,i={}){this.element=e,this.callback=t,this.options=Object.assign({enable:!0},i),this.events=rfe.concat(i.events||[]),this.handleEvent=this.handleEvent.bind(this),this.events.forEach(r=>e.addEventListener(r,this.handleEvent,!!Wz&&{passive:!1}))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){"wheel"===e&&(this.options.enable=t)}handleEvent(e){if(!this.options.enable)return;let t=e.deltaY;Zg.WheelEvent&&(ife&&e.deltaMode===Zg.WheelEvent.DOM_DELTA_PIXEL&&(t/=Zg.devicePixelRatio),e.deltaMode===Zg.WheelEvent.DOM_DELTA_LINE&&(t*=40));const i={x:e.clientX,y:e.clientY};0!==t&&t%Yz==0&&(t=Math.floor(t/Yz)),e.shiftKey&&t&&(t*=.25),this._onWheel(e,-t,i)}_onWheel(e,t,i){this.callback({type:"wheel",center:i,delta:t,srcEvent:e,pointerType:"mouse",target:e.target})}}const{MOUSE_EVENTS:lfe}=qO,Kz="pointermove",Xz="pointerover",Qz="pointerout",Zz="pointerleave";class cfe{constructor(e,t,i={}){this.element=e,this.callback=t,this.pressed=!1,this.options=Object.assign({enable:!0},i),this.enableMoveEvent=this.options.enable,this.enableLeaveEvent=this.options.enable,this.enableOutEvent=this.options.enable,this.enableOverEvent=this.options.enable,this.events=lfe.concat(i.events||[]),this.handleEvent=this.handleEvent.bind(this),this.events.forEach(r=>e.addEventListener(r,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){e===Kz&&(this.enableMoveEvent=t),e===Xz&&(this.enableOverEvent=t),e===Qz&&(this.enableOutEvent=t),e===Zz&&(this.enableLeaveEvent=t)}handleEvent(e){this.handleOverEvent(e),this.handleOutEvent(e),this.handleLeaveEvent(e),this.handleMoveEvent(e)}handleOverEvent(e){this.enableOverEvent&&"mouseover"===e.type&&this.callback({type:Xz,srcEvent:e,pointerType:"mouse",target:e.target})}handleOutEvent(e){this.enableOutEvent&&"mouseout"===e.type&&this.callback({type:Qz,srcEvent:e,pointerType:"mouse",target:e.target})}handleLeaveEvent(e){this.enableLeaveEvent&&"mouseleave"===e.type&&this.callback({type:Zz,srcEvent:e,pointerType:"mouse",target:e.target})}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":0===e.which&&(this.pressed=!1),this.pressed||this.callback({type:Kz,srcEvent:e,pointerType:"mouse",target:e.target});break;case"mouseup":this.pressed=!1}}}const{KEY_EVENTS:ufe}=qO,Jz="keydown";class dfe{constructor(e,t,i={}){this.element=e,this.callback=t,this.options=Object.assign({enable:!0},i),this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=ufe.concat(i.events||[]),this.handleEvent=this.handleEvent.bind(this),e.tabIndex=i.tabIndex||0,e.style.outline="none",this.events.forEach(r=>e.addEventListener(r,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){e===Jz&&(this.enableDownEvent=t),"keyup"===e&&(this.enableUpEvent=t)}handleEvent(e){const t=e.target||e.srcElement;"INPUT"===t.tagName&&"text"===t.type||"TEXTAREA"===t.tagName||(this.enableDownEvent&&"keydown"===e.type&&this.callback({type:Jz,srcEvent:e,key:e.key,target:e.target}),this.enableUpEvent&&"keyup"===e.type&&this.callback({type:"keyup",srcEvent:e,key:e.key,target:e.target}))}}const t4="contextmenu";class hfe{constructor(e,t,i={}){this.element=e,this.callback=t,this.options=Object.assign({enable:!0},i),this.handleEvent=this.handleEvent.bind(this),e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,t){e===t4&&(this.options.enable=t)}handleEvent(e){!this.options.enable||this.callback({type:t4,center:{x:e.clientX,y:e.clientY},srcEvent:e,pointerType:"mouse",target:e.target})}}const ffe={pointerdown:1,pointermove:2,pointerup:4,mousedown:1,mousemove:2,mouseup:4},n4={srcElement:"root",priority:0};class Cfe{constructor(e){this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this.handleEvent=this.handleEvent.bind(this),this._active=!1}isEmpty(){return!this._active}add(e,t,i,r=!1,s=!1){const{handlers:o,handlersByElement:a}=this;i&&("object"!=typeof i||i.addEventListener)&&(i={srcElement:i}),i=i?Object.assign({},n4,i):n4;let l=a.get(i.srcElement);l||(l=[],a.set(i.srcElement,l));const c={type:e,handler:t,srcElement:i.srcElement,priority:i.priority};r&&(c.once=!0),s&&(c.passive=!0),o.push(c),this._active=this._active||!c.passive;let u=l.length-1;for(;u>=0&&!(l[u].priority>=c.priority);)u--;l.splice(u+1,0,c)}remove(e,t){const{handlers:i,handlersByElement:r}=this;for(let s=i.length-1;s>=0;s--){const o=i[s];if(o.type===e&&o.handler===t){i.splice(s,1);const a=r.get(o.srcElement);a.splice(a.indexOf(o),1),0===a.length&&r.delete(o.srcElement)}}this._active=i.some(s=>!s.passive)}handleEvent(e){if(this.isEmpty())return;const t=this._normalizeEvent(e);let i=e.srcEvent.target;for(;i&&i!==t.rootElement;){if(this._emit(t,i),t.handled)return;i=i.parentNode}this._emit(t,"root")}_emit(e,t){const i=this.handlersByElement.get(t);if(i){let r=!1;const s=()=>{e.handled=!0},o=()=>{e.handled=!0,r=!0},a=[];for(let l=0;l<i.length;l++){const{type:c,handler:u,once:h}=i[l];if(u(Object.assign({},e,{type:c,stopPropagation:s,stopImmediatePropagation:o})),h&&a.push(i[l]),r)break}for(let l=0;l<a.length;l++){const{type:c,handler:u}=a[l];this.remove(c,u)}}}_normalizeEvent(e){const t=this.eventManager.element;return Object.assign({},e,function(n){const e=ffe[n.srcEvent.type];if(!e)return null;const{buttons:t,button:i,which:r}=n.srcEvent;let s=!1,o=!1,a=!1;return 4===e||2===e&&!Number.isFinite(t)?(s=1===r,o=2===r,a=3===r):2===e?(s=Boolean(1&t),o=Boolean(4&t),a=Boolean(2&t)):1===e&&(s=0===i,o=1===i,a=2===i),{leftButton:s,middleButton:o,rightButton:a}}(e),function(n,e){const{srcEvent:t}=n;if(!n.center&&!Number.isFinite(t.clientX))return null;const i=n.center||{x:t.clientX,y:t.clientY},r=e.getBoundingClientRect();return{center:i,offsetCenter:{x:(i.x-r.left-e.clientLeft)/(r.width/e.offsetWidth||1),y:(i.y-r.top-e.clientTop)/(r.height/e.offsetHeight||1)}}}(e,t),{handled:!1,rootElement:t})}}const Tfe={events:null,recognizers:null,recognizerOptions:{},Manager:Qhe,touchAction:"none",tabIndex:0};class Afe{constructor(e=null,t={}){this.options=Object.assign({},Tfe,t),this.events=new Map,this._onBasicInput=this._onBasicInput.bind(this),this._onOtherEvent=this._onOtherEvent.bind(this),this.setElement(e);const{events:i}=t;i&&this.on(i)}setElement(e){if(this.element&&this.destroy(),this.element=e,!e)return;const{options:t}=this;this.manager=new(0,t.Manager)(e,{touchAction:t.touchAction,recognizers:t.recognizers||Zhe}).on("hammer.input",this._onBasicInput),t.recognizers||Object.keys(Gz).forEach(r=>{const s=this.manager.get(r);s&&Gz[r].forEach(o=>{s.recognizeWith(o)})});for(const r in t.recognizerOptions){const s=this.manager.get(r);if(s){const o=t.recognizerOptions[r];delete o.enable,s.set(o)}}this.wheelInput=new afe(e,this._onOtherEvent,{enable:!1}),this.moveInput=new cfe(e,this._onOtherEvent,{enable:!1}),this.keyInput=new dfe(e,this._onOtherEvent,{enable:!1,tabIndex:t.tabIndex}),this.contextmenuInput=new hfe(e,this._onOtherEvent,{enable:!1});for(const[r,s]of this.events)s.isEmpty()||(this._toggleRecognizer(s.recognizerName,!0),this.manager.on(r,s.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(e,t,i){this._addEventHandler(e,t,i,!1)}once(e,t,i){this._addEventHandler(e,t,i,!0)}watch(e,t,i){this._addEventHandler(e,t,i,!1,!0)}off(e,t){this._removeEventHandler(e,t)}_toggleRecognizer(e,t){const{manager:i}=this;if(!i)return;const r=i.get(e);if(r&&r.options.enable!==t){r.set({enable:t});const s=Jhe[e];s&&!this.options.recognizers&&s.forEach(o=>{const a=i.get(o);t?(a.requireFailure(e),r.dropRequireFailure(o)):a.dropRequireFailure(e)})}this.wheelInput.enableEventType(e,t),this.moveInput.enableEventType(e,t),this.keyInput.enableEventType(e,t),this.contextmenuInput.enableEventType(e,t)}_addEventHandler(e,t,i,r,s){if("string"!=typeof e){i=t;for(const u in e)this._addEventHandler(u,e[u],i,r,s);return}const{manager:o,events:a}=this,l=$z[e]||e;let c=a.get(l);c||(c=new Cfe(this),a.set(l,c),c.recognizerName=tfe[l]||l,o&&o.on(l,c.handleEvent)),c.add(e,t,i,r,s),c.isEmpty()||this._toggleRecognizer(c.recognizerName,!0)}_removeEventHandler(e,t){if("string"!=typeof e){for(const o in e)this._removeEventHandler(o,e[o]);return}const{events:i}=this,s=i.get($z[e]||e);if(s&&(s.remove(e,t),s.isEmpty())){const{recognizerName:o}=s;let a=!1;for(const l of i.values())if(l.recognizerName===o&&!l.isEmpty()){a=!0;break}a||this._toggleRecognizer(o,!1)}}_onBasicInput(e){const{srcEvent:t}=e,i=efe[t.type];i&&this.manager.emit(i,e)}_onOtherEvent(e){this.manager.emit(e.type,e)}}function Nf(){}const i4={id:"",width:"100%",height:"100%",pickingRadius:0,layerFilter:null,glOptions:{},gl:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},onWebGLInitialized:Nf,onResize:Nf,onViewStateChange:Nf,onInteractionStateChange:Nf,onBeforeRender:Nf,onAfterRender:Nf,onLoad:Nf,onError:(n,e)=>Mi.error(n)(),_onMetrics:null,getCursor:({isDragging:n})=>n?"grabbing":"grab",debug:!1,drawPickingColors:!1};class GS{constructor(e){e=ot(ot({},i4),e),this.props={},this.width=0,this.height=0,this.viewManager=null,this.layerManager=null,this.effectManager=null,this.deckRenderer=null,this.deckPicker=null,this._needsRedraw=!0,this._pickRequest={},this._lastPointerDownInfo=null,this.viewState=null,this.interactiveState={isHovering:!1,isDragging:!1},this._onEvent=this._onEvent.bind(this),this._onPointerDown=this._onPointerDown.bind(this),this._onPointerMove=this._onPointerMove.bind(this),e.viewState&&e.initialViewState&&Mi.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),"IE"===(0,Qg.qs)()&&Mi.warn("IE 11 support will be deprecated in v8.0")(),e.gl||"undefined"!=typeof document&&(this.canvas=this._createCanvas(e)),this.animationLoop=this._createAnimationLoop(e),this.stats=new QD({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(e),e._typedArrayManagerProps&&y0.setProps(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){this.animationLoop.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,this.layerManager&&(this.layerManager.finalize(),this.layerManager=null,this.viewManager.finalize(),this.viewManager=null,this.effectManager.finalize(),this.effectManager=null,this.deckRenderer.finalize(),this.deckRenderer=null,this.deckPicker.finalize(),this.deckPicker=null,this.eventManager.destroy(),this.eventManager=null,this.tooltip.remove(),this.tooltip=null),!this.props.canvas&&!this.props.gl&&this.canvas&&(this.canvas.parentElement.removeChild(this.canvas),this.canvas=null)}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&Mi.removed("onLayerHover","onHover")(),"onLayerClick"in e&&Mi.removed("onLayerClick","onClick")(),e.initialViewState&&!U0(this.props.initialViewState,e.initialViewState)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const t=Object.create(this.props);Object.assign(t,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(t),this.layerManager&&(this.viewManager.setProps(t),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(t),this.effectManager.setProps(t),this.deckRenderer.setProps(t),this.deckPicker.setProps(t)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(this.props._animate)return"Deck._animate";let t=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const i=this.viewManager.needsRedraw(e),r=this.layerManager.needsRedraw(e),s=this.effectManager.needsRedraw(e),o=this.deckRenderer.needsRedraw(e);return t=t||i||r||s||o,t}redraw(e){if(!this.layerManager)return;const t=e||this.needsRedraw({clearRedrawFlags:!0});!t||(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(t):this._drawLayers(t))}getViews(){return this.viewManager.views}getViewports(e){return this.viewManager.getViewports(e)}pickObject(e){const t=this._pick("pickObject","pickObject Time",e).result;return t.length?t[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,t=!1){for(const i in e)this.layerManager.resourceManager.add({resourceId:i,data:e[i],forceUpdate:t})}_removeResources(e){for(const t of e)this.layerManager.resourceManager.remove(t)}_pick(e,t,i){const{stats:r}=this;r.get("Pick Count").incrementCount(),r.get(t).timeStart();const s=this.deckPicker[e](ot({layers:this.layerManager.getLayers(i),views:this.viewManager.getViews(),viewports:this.getViewports(i),onViewportActive:this.layerManager.activateViewport},i));return r.get(t).timeEnd(),s}_createCanvas(e){let t=e.canvas;return"string"==typeof t&&(t=document.getElementById(t),oc(t)),t||(t=document.createElement("canvas"),t.id=e.id||"deckgl-overlay",(e.parent||document.body).appendChild(t)),Object.assign(t.style,e.style),t}_setCanvasSize(e){if(!this.canvas)return;let{width:t,height:i}=e;(t||0===t)&&(t=Number.isFinite(t)?"".concat(t,"px"):t,this.canvas.style.width=t),(i||0===i)&&(i=Number.isFinite(i)?"".concat(i,"px"):i,this.canvas.style.position="absolute",this.canvas.style.height=i)}_updateCanvasSize(){if(this._checkForCanvasSizeChange()){const{width:e,height:t}=this;this.viewManager.setProps({width:e,height:t}),this.props.onResize({width:this.width,height:this.height})}}_checkForCanvasSizeChange(){const{canvas:e}=this;if(!e)return!1;const t=e.clientWidth||e.width,i=e.clientHeight||e.height;return(t!==this.width||i!==this.height)&&(this.width=t,this.height=i,!0)}_createAnimationLoop(e){const{width:t,height:i,gl:r,glOptions:s,debug:o,onError:a,onBeforeRender:l,onAfterRender:c,useDevicePixels:u,autoResizeDrawingBuffer:h}=e;return new $he({width:t,height:i,useDevicePixels:u,autoResizeDrawingBuffer:h,autoResizeViewport:!1,gl:r,onCreateContext:f=>DV(wn(ot(ot({},s),f),{canvas:this.canvas,debug:o,onContextLost:()=>this._onContextLost()})),onInitialize:f=>this._setGLContext(f.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:l,onAfterRender:c,onError:a})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let e=this.props.views||[new Xde({id:"default-view"})];return e=Array.isArray(e)?e:[e],e.length&&this.props.controller&&(e[0].props.controller=this.props.controller),e}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_onPointerMove(e){const{_pickRequest:t}=this;if("pointerleave"===e.type)t.x=-1,t.y=-1,t.radius=0;else{if(e.leftButton||e.rightButton)return;{const i=e.offsetCenter;if(!i)return;t.x=i.x,t.y=i.y,t.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:t.x,y:t.y}),t.event=e,t.mode="hover"}_pickAndCallback(){const{_pickRequest:e}=this;if(e.event){const{result:t,emptyInfo:i}=this._pick("pickObject","pickObject Time",e);this.interactiveState.isHovering=t.length>0;let r=i,s=!1;for(const o of t)r=o,s=o.layer.onHover(o,e.event);if(!s&&this.props.onHover&&this.props.onHover(r,e.event),this.props.getTooltip){const o=this.props.getTooltip(r);this.tooltip.setTooltip(o,r.x,r.y)}e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.interactiveState))}_setGLContext(e){if(this.layerManager)return;this.canvas||(this.canvas=e.canvas,XD(e,{enable:!0,copyState:!0})),this.tooltip=new che(this.canvas),Uu(e,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(e);const t=new Tz;t.play(),this.animationLoop.attachTimeline(t),this.eventManager=new Afe(this.props.parent||e.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const r in fV)this.eventManager.on(r,this._onEvent);this.viewManager=new Wde({timeline:t,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const i=this.viewManager.getViewports()[0];this.layerManager=new $de(e,{deck:this,stats:this.stats,viewport:i,timeline:t}),this.effectManager=new Zde,this.deckRenderer=new the(e),this.deckPicker=new ahe(e),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,t){const{gl:i}=this.layerManager.context;Uu(i,this.props.parameters),this.props.onBeforeRender({gl:i}),this.deckRenderer.renderLayers(ot({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",redrawReason:e,effects:this.effectManager.getEffects()},t)),this.props.onAfterRender({gl:i})}_onRenderFrame(e){this._getFrameStats(),this._metricsCounter++%60==0&&(this._getMetrics(),this.stats.reset(),Mi.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(!1),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const t=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState=wn(ot({},this.viewState),{[e.viewId]:t}),this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.interactiveState.isDragging=e.isDragging,this.props.onInteractionStateChange(e)}_onEvent(e){const t=fV[e.type],i=e.offsetCenter;if(!t||!i)return;const r=this.layerManager.getLayers(),s=this.deckPicker.getLastPickedObject({x:i.x,y:i.y,layers:r,viewports:this.getViewports(i)},this._lastPointerDownInfo),{layer:o}=s,a=o&&(o[t.handler]||o.props[t.handler]),l=this.props[t.handler];let c=!1;a&&(c=a.call(o,s,e)),!c&&l&&l(s,e)}_onPointerDown(e){const t=e.offsetCenter;this._lastPointerDownInfo=this.pickObject({x:t.x,y:t.y,radius:this.props.pickingRadius})}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const t=this.animationLoop.stats;e.get("GPU Time").addTime(t.get("GPU Time").lastTiming),e.get("CPU Time").addTime(t.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:t}=this;e.fps=t.get("frameRate").getHz(),e.setPropsTime=t.get("setProps Time").time,e.updateAttributesTime=t.get("Update Attributes").time,e.framesRedrawn=t.get("Redraw Count").count,e.pickTime=t.get("pickObject Time").time+t.get("pickMultipleObjects Time").time+t.get("pickObjects Time").time,e.pickCount=t.get("Pick Count").count,e.gpuTime=t.get("GPU Time").time,e.cpuTime=t.get("CPU Time").time,e.gpuTimePerFrame=t.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=t.get("CPU Time").getAverageTime();const i=Tf.get("Memory Usage");e.bufferMemory=i.get("Buffer Memory").count,e.textureMemory=i.get("Texture Memory").count,e.renderbufferMemory=i.get("Renderbuffer Memory").count,e.gpuMemory=i.get("GPU Memory").count}}GS.getPropTypes=function(n){return{id:n.string,width:n.oneOfType([n.number,n.string]),height:n.oneOfType([n.number,n.string]),layers:n.oneOfType([n.object,n.array]),layerFilter:n.func,views:n.oneOfType([n.object,n.array]),viewState:n.object,effects:n.arrayOf(n.instanceOf(Sz)),controller:n.oneOfType([n.func,n.bool,n.object]),gl:n.object,glOptions:n.object,parameters:n.object,pickingRadius:n.number,useDevicePixels:n.oneOfType([n.bool,n.number]),touchAction:n.string,eventRecognizerOptions:n.object,onWebGLInitialized:n.func,onResize:n.func,onViewStateChange:n.func,onInteractionStateChange:n.func,onBeforeRender:n.func,onAfterRender:n.func,onLoad:n.func,onError:n.func,debug:n.bool,drawPickingColors:n.bool,_framebuffer:n.object,_animate:n.bool,_pickable:n.bool,_typedArrayManagerProps:n.object}},GS.defaultProps=i4,GS.VERSION=Phe.VERSION;const $S={name:"project32",dependencies:[RO],vs:"\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition\n) {\n  vec3 projectedPosition = project_position(position, position64Low);\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    // offset is specified as ENU\n    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe\n    mat3 rotation = project_get_orientation_matrix(projectedPosition);\n    offset = rotation * offset;\n  }\n  commonPosition = vec4(projectedPosition + offset, 1.0);\n  return project_common_position_to_clipspace(commonPosition);\n}\n\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset\n) {\n  vec4 commonPosition;\n  return project_position_to_clipspace(position, position64Low, offset, commonPosition);\n}\n"},Ofe={pickingSelectedColor:null,pickingHighlightColor:new Uint8Array([0,255,255,255]),pickingActive:!1,pickingAttribute:!1},WS=ot({inject:{"vs:DECKGL_FILTER_COLOR":"\n  picking_setPickingColor(geometry.pickingColor);\n  // for picking depth values\n  picking_setPickingAttribute(geometry.position.z);\n  ","fs:DECKGL_FILTER_COLOR":{order:99,injection:"\n  // use highlight color if this fragment belongs to the selected object.\n  color = picking_filterHighlightColor(color);\n\n  // use picking color if rendering to picking FBO.\n  color = picking_filterPickingColor(color);\n    "}}},{name:"picking",vs:"uniform bool picking_uActive;\nuniform bool picking_uAttribute;\nuniform vec3 picking_uSelectedColor;\nuniform bool picking_uSelectedColorValid;\n\nout vec4 picking_vRGBcolor_Avalid;\n\nconst float COLOR_SCALE = 1. / 255.;\n\nbool picking_isColorValid(vec3 color) {\n  return dot(color, vec3(1.0)) > 0.001;\n}\n\nbool isVertexPicked(vec3 vertexColor) {\n  return\n    picking_uSelectedColorValid &&\n    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));\n}\n\nvoid picking_setPickingColor(vec3 pickingColor) {\n  if (picking_uActive) {\n    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));\n\n    if (!picking_uAttribute) {\n      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;\n    }\n  } else {\n    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));\n  }\n}\n\nvoid picking_setPickingAttribute(float value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.r = value;\n  }\n}\nvoid picking_setPickingAttribute(vec2 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rg = value;\n  }\n}\nvoid picking_setPickingAttribute(vec3 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rgb = value;\n  }\n}\n",fs:"uniform bool picking_uActive;\nuniform vec3 picking_uSelectedColor;\nuniform vec4 picking_uHighlightColor;\n\nin vec4 picking_vRGBcolor_Avalid;\nvec4 picking_filterHighlightColor(vec4 color) {\n  if (picking_uActive) {\n    return color;\n  }\n  bool selected = bool(picking_vRGBcolor_Avalid.a);\n\n  if (selected) {\n    float highLightAlpha = picking_uHighlightColor.a;\n    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);\n    float highLightRatio = highLightAlpha / blendedAlpha;\n\n    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);\n    return vec4(blendedRGB, blendedAlpha);\n  } else {\n    return color;\n  }\n}\nvec4 picking_filterPickingColor(vec4 color) {\n  if (picking_uActive) {\n    if (picking_vRGBcolor_Avalid.a == 0.0) {\n      discard;\n    }\n    return picking_vRGBcolor_Avalid;\n  }\n  return color;\n}\nvec4 picking_filterColor(vec4 color) {\n  vec4 highightColor = picking_filterHighlightColor(color);\n  return picking_filterPickingColor(highightColor);\n}\n\n",getUniforms:function(n=Ofe){const e={};if(void 0!==n.pickingSelectedColor)if(n.pickingSelectedColor){const t=n.pickingSelectedColor.slice(0,3);e.picking_uSelectedColorValid=1,e.picking_uSelectedColor=t}else e.picking_uSelectedColorValid=0;if(n.pickingHighlightColor){const t=Array.from(n.pickingHighlightColor,i=>i/255);Number.isFinite(t[3])||(t[3]=1),e.picking_uHighlightColor=t}return void 0!==n.pickingActive&&(e.picking_uActive=Boolean(n.pickingActive),e.picking_uAttribute=Boolean(n.pickingAttribute)),e}}),r4={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class uh{static get DRAW_MODE(){return r4}constructor(e={}){const{id:t=ca("geometry"),drawMode:i=r4.TRIANGLES,attributes:r={},indices:s=null,vertexCount:o=null}=e;this.id=t,this.drawMode=0|i,this.attributes={},this.userData={},this._setAttributes(r,s),this.vertexCount=o||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?ot({indices:this.indices},this.attributes):this.attributes}_print(e){return`Geometry ${this.id} attribute ${e}`}_setAttributes(e,t){t&&(this.indices=ArrayBuffer.isView(t)?{value:t,size:1}:t);for(const i in e){let r=e[i];r=ArrayBuffer.isView(r)?{value:r}:r,nn(ArrayBuffer.isView(r.value),`${this._print(i)}: must be typed array or object with value as typed array`),("POSITION"===i||"positions"===i)&&!r.size&&(r.size=3),"indices"===i?(nn(!this.indices),this.indices=r):this.attributes[i]=r}return this.indices&&void 0!==this.indices.isIndexed&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(e,t){if(t)return t.value.length;let i=1/0;for(const r in e){const s=e[r],{value:o,size:a,constant:l}=s;!l&&o&&a>=1&&(i=Math.min(i,o.length/a))}return nn(Number.isFinite(i)),i}}const s4=()=>{},kfe={10241:9987,10240:9729,10242:33071,10243:33071};function Bfe(n){return Math.pow(2,Math.ceil(Math.log2(n)))}function Vfe(n,e,t,i){return t===e.width&&i===e.height?e:(n.canvas.height=i,n.canvas.width=t,n.clearRect(0,0,n.canvas.width,n.canvas.height),n.drawImage(e,0,0,e.width,e.height,0,0,t,i),n.canvas)}function W0(n){return n&&(n.id||n.url)}function o4(n,e,t){for(let i=0;i<e.length;i++){const{icon:r,xOffset:s}=e[i];n[W0(r)]=wn(ot({},r),{x:s,y:t})}}class Hfe{constructor(e,{onUpdate:t=s4,onError:i=s4}){this.gl=e,this.onUpdate=t,this.onError=i,this._loadOptions=null,this._getIcon=null,this._texture=null,this._externalTexture=null,this._mapping={},this._pendingCount=0,this._autoPacking=!1,this._xOffset=0,this._yOffset=0,this._rowHeight=0,this._buffer=4,this._canvasWidth=1024,this._canvasHeight=0,this._canvas=null}finalize(){var e;null===(e=this._texture)||void 0===e||e.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping(e){const t=this._autoPacking?W0(e):e;return this._mapping[t]||{}}setProps({loadOptions:e,autoPacking:t,iconAtlas:i,iconMapping:r,data:s,getIcon:o}){e&&(this._loadOptions=e),void 0!==t&&(this._autoPacking=t),o&&(this._getIcon=o),r&&(this._mapping=r),i&&this._updateIconAtlas(i),this._autoPacking&&(s||o)&&"undefined"!=typeof document&&(this._canvas=this._canvas||document.createElement("canvas"),this._updateAutoPacking(s))}get isLoaded(){return 0===this._pendingCount}_updateIconAtlas(e){var t;null===(t=this._texture)||void 0===t||t.delete(),this._texture=null,this._externalTexture=e,this.onUpdate()}_updateAutoPacking(e){const t=Object.values(function(n,e,t){if(!n||!e)return null;t=t||{};const i={},{iterable:r,objectInfo:s}=cS(n);for(const o of r){s.index++;const a=e(o,s),l=W0(a);if(!a)throw new Error("Icon is missing.");if(!a.url)throw new Error("Icon url is missing.");!i[l]&&(!t[l]||a.url!==t[l].url)&&(i[l]=wn(ot({},a),{source:o,sourceIndex:s.index}))}return i}(e,this._getIcon,this._mapping)||{});if(t.length>0){const{mapping:i,xOffset:r,yOffset:s,rowHeight:o,canvasHeight:a}=function({icons:n,buffer:e,mapping:t={},xOffset:i=0,yOffset:r=0,rowHeight:s=0,canvasWidth:o}){let a=[];for(let l=0;l<n.length;l++){const c=n[l];if(!t[W0(c)]){const{height:h,width:f}=c;i+f+e>o&&(o4(t,a,r),i=0,r=s+r+e,s=0,a=[]),a.push({icon:c,xOffset:i}),i=i+f+e,s=Math.max(s,h)}}return a.length>0&&o4(t,a,r),{mapping:t,rowHeight:s,xOffset:i,yOffset:r,canvasWidth:o,canvasHeight:Bfe(s+r+e)}}({icons:t,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});this._rowHeight=o,this._mapping=i,this._xOffset=r,this._yOffset=s,this._canvasHeight=a,this._texture||(this._texture=new da(this.gl,{width:this._canvasWidth,height:this._canvasHeight,parameters:kfe})),this._texture.height!==this._canvasHeight&&(this._texture=function(n,e,t,i){const r=e.width,s=e.height,o=WV(e,{width:t,height:i});return function(n,e,t={}){const{sourceX:i=0,sourceY:r=0,targetMipmaplevel:s=0,targetInternalFormat:o=6408}=t;let{targetX:a,targetY:l,targetZ:c,width:u,height:h}=t;const{framebuffer:f,deleteFramebuffer:g}=_0(n);nn(f);const{gl:m,handle:w}=f,S=void 0!==a||void 0!==l||void 0!==c;a=a||0,l=l||0,c=c||0;const U=m.bindFramebuffer(36160,w);nn(e);let D=null;if(e instanceof Af&&(D=e,u=Number.isFinite(u)?u:D.width,h=Number.isFinite(h)?h:D.height,D.bind(0),e=D.target),S)switch(e){case 3553:case 34067:m.copyTexSubImage2D(e,s,a,l,i,r,u,h);break;case 35866:case 32879:Eo(m).copyTexSubImage3D(e,s,a,l,c,i,r,u,h)}else m.copyTexImage2D(e,s,o,i,r,u,h,0);D&&D.unbind(),m.bindFramebuffer(36160,U||null),g&&f.delete()}(e,o,{targetY:0,width:r,height:s}),e.delete(),o}(0,this._texture,this._canvasWidth,this._canvasHeight)),this.onUpdate(),this._loadIcons(t)}}_loadIcons(e){const t=this._canvas.getContext("2d");for(const i of e)this._pendingCount++,V0(i.url,$O,this._loadOptions).then(r=>{const s=W0(i),{x:o,y:a,width:l,height:c}=this._mapping[s],u=Vfe(t,r,l,c);this._texture.setSubImageData({data:u,x:o,y:a,width:l,height:c}),this._texture.generateMipmap(),this.onUpdate()}).catch(r=>{this.onError({url:i.url,source:i.source,sourceIndex:i.sourceIndex,loadOptions:this._loadOptions,error:r})}).finally(()=>{this._pendingCount--})}}const a4=[0,0,0,255],Gfe={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:n=>n.position},getIcon:{type:"accessor",value:n=>n.icon},getColor:{type:"accessor",value:a4},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,compare:!1,optional:!0}};let $fe=(()=>{class n extends j0{getShaders(){return super.getShaders({vs:"#define SHADER_NAME icon-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute float instanceSizes;\nattribute float instanceAngles;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\nattribute vec4 instanceIconFrames;\nattribute float instanceColorModes;\nattribute vec2 instanceOffsets;\nattribute vec2 instancePixelOffset;\n\nuniform float sizeScale;\nuniform vec2 iconsTextureDim;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform bool billboard;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvec2 rotate_by_angle(vec2 vertex, float angle) {\n  float angle_radian = angle * PI / 180.0;\n  float cos_angle = cos(angle_radian);\n  float sin_angle = sin(angle_radian);\n  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\n  return rotationMatrix * vertex;\n}\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = positions;\n  geometry.pickingColor = instancePickingColors;\n  uv = positions;\n\n  vec2 iconSize = instanceIconFrames.zw;\n  float sizePixels = clamp(\n    project_size_to_pixel(instanceSizes * sizeScale), \n    sizeMinPixels, sizeMaxPixels\n  );\n  float instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;\n  vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;\n  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;\n  pixelOffset += instancePixelOffset;\n  pixelOffset.y *= -1.0;\n\n  if (billboard)  {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    vec3 offset = vec3(pixelOffset, 0.0);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n\n  } else {\n    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\n    DECKGL_FILTER_SIZE(offset_common, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position); \n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  vTextureCoords = mix(\n    instanceIconFrames.xy,\n    instanceIconFrames.xy + iconSize,\n    (positions.xy + 1.0) / 2.0\n  ) / iconsTextureDim;\n\n  vColor = instanceColors;\n  DECKGL_FILTER_COLOR(vColor, geometry);\n\n  vColorMode = instanceColorModes;\n}\n",fs:"#define SHADER_NAME icon-layer-fragment-shader\n\nprecision highp float;\n\nuniform float opacity;\nuniform sampler2D iconsTexture;\nuniform float alphaCutoff;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  vec4 texColor = texture2D(iconsTexture, vTextureCoords);\n  vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);\n  float a = texColor.a * opacity * vColor.a;\n\n  if (a < alphaCutoff) {\n    discard;\n  }\n\n  gl_FragColor = vec4(color, a);\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[$S,WS]})}initializeState(){this.state={iconManager:new Hfe(this.context.gl,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})},this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:5121,accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:a4},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}updateState({oldProps:t,props:i,changeFlags:r}){super.updateState({props:i,oldProps:t,changeFlags:r});const s=this.getAttributeManager(),{iconAtlas:o,iconMapping:a,data:l,getIcon:c}=i,{iconManager:u}=this.state;u.setProps({loadOptions:i.loadOptions});let h=!1;if(o||this.internalState.isAsyncPropLoading("iconAtlas")?(t.iconAtlas!==i.iconAtlas&&u.setProps({iconAtlas:o,autoPacking:!1}),t.iconMapping!==i.iconMapping&&(u.setProps({iconMapping:a}),h=!0)):u.setProps({autoPacking:!0}),(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getIcon))&&u.setProps({data:l,getIcon:c}),h&&(s.invalidate("instanceOffsets"),s.invalidate("instanceIconFrames"),s.invalidate("instanceColorModes")),r.extensionsChanged){var g;const{gl:m}=this.context;null===(g=this.state.model)||void 0===g||g.delete(),this.state.model=this._getModel(m),s.invalidateAll()}}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState(){super.finalizeState(),this.state.iconManager.finalize()}draw({uniforms:t}){const{sizeScale:i,sizeMinPixels:r,sizeMaxPixels:s,sizeUnits:o,billboard:a,alphaCutoff:l}=this.props,{iconManager:c}=this.state,{viewport:u}=this.context,h=c.getTexture();h&&this.state.model.setUniforms(t).setUniforms({iconsTexture:h,iconsTextureDim:[h.width,h.height],sizeScale:i*("pixels"===o?u.metersPerPixel:1),sizeMinPixels:r,sizeMaxPixels:s,billboard:a,alphaCutoff:l}).draw()}_getModel(t){return new Hg(t,wn(ot({},this.getShaders()),{id:this.props.id,geometry:new uh({drawMode:6,attributes:{positions:{size:2,value:new Float32Array([-1,-1,-1,1,1,1,1,-1])}}}),isInstanced:!0}))}_onUpdate(){this.setNeedsRedraw()}_onError(t){const{onIconError:i}=this.getCurrentLayer().props;i?i(t):Mi.error(t.error)()}getInstanceOffset(t){const i=this.state.iconManager.getIconMapping(t);return[i.width/2-i.anchorX||0,i.height/2-i.anchorY||0]}getInstanceColorMode(t){return this.state.iconManager.getIconMapping(t).mask?1:0}getInstanceIconFrame(t){const i=this.state.iconManager.getIconMapping(t);return[i.x||0,i.y||0,i.width||0,i.height||0]}}return n.layerName="IconLayer",n.defaultProps=Gfe,n})();const c4=[],qfe={getIconOffsets:{type:"accessor",value:n=>n.offsets},alphaCutoff:.001,smoothing:.1,outlineWidth:0,outlineColor:{type:"color",value:[0,0,0,255]}};let Yfe=(()=>{class n extends $fe{getShaders(){return wn(ot({},super.getShaders()),{fs:"#define SHADER_NAME multi-icon-layer-fragment-shader\n\nprecision highp float;\n\nuniform float opacity;\nuniform sampler2D iconsTexture;\nuniform float gamma;\nuniform bool sdf;\nuniform float alphaCutoff;\nuniform float buffer;\nuniform float outlineBuffer;\nuniform vec4 outlineColor;\n\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  if (!picking_uActive) {\n    float alpha = texture2D(iconsTexture, vTextureCoords).a;\n    vec4 color = vColor;\n    if (sdf) {\n      float distance = alpha;\n      alpha = smoothstep(buffer - gamma, buffer + gamma, distance);\n\n      if (outlineBuffer > 0.0) {\n        float inFill = alpha;\n        float inBorder = smoothstep(outlineBuffer - gamma, outlineBuffer + gamma, distance);\n        color = mix(outlineColor, vColor, inFill);\n        alpha = inBorder;\n      }\n    }\n    float a = alpha * color.a;\n    \n    if (a < alphaCutoff) {\n      discard;\n    }\n\n    gl_FragColor = vec4(color.rgb, a * opacity);\n  }\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n"})}initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:5121,size:3,accessor:(i,{index:r,target:s})=>this.encodePickingColor(r,s)}})}updateState(t){super.updateState(t);const{props:i,oldProps:r}=t;let{outlineColor:s}=i;s!==r.outlineColor&&(s=s.map(o=>o/255),s[3]=Number.isFinite(s[3])?s[3]:1,this.setState({outlineColor:s})),!i.sdf&&i.outlineWidth&&Mi.warn("".concat(this.id,": fontSettings.sdf is required to render outline"))()}draw(t){const{sdf:i,smoothing:r,outlineWidth:s}=this.props,{outlineColor:o}=this.state;t.uniforms=wn(ot({},t.uniforms),{buffer:.75,outlineBuffer:s?Math.max(r,.75*(1-s)):-1,gamma:r,sdf:Boolean(i),outlineColor:o}),super.draw(t)}getInstanceOffset(t){return t?Array.from(t).map(i=>super.getInstanceOffset(i)):c4}getInstanceColorMode(t){return 1}getInstanceIconFrame(t){return t?Array.from(t).map(i=>super.getInstanceIconFrame(i)):c4}}return n.layerName="MultiIconLayer",n.defaultProps=qfe,n})();var Kfe=et(1002),Xfe=et.n(Kfe);const Zfe=[];function Jfe(n){return Math.pow(2,Math.ceil(Math.log2(n)))}function u4(n,e,t,i){let r=0;for(let s=e;s<t;s++){const o=n[s];let a=null;const l=i&&i[o];l&&(a=l.width),r+=a}return r}function d4(n,e,t,i,r,s){let o=e,a=0;for(let l=e;l<t;l++){const c=u4(n,l,l+1,r);a+c>i&&(o<l&&s.push(l),o=l,a=0),a+=c}return a}function npe(n,e,t,i,r=0,s){void 0===s&&(s=n.length);const o=[];return"break-all"===e?d4(n,r,s,t,i,o):function(n,e,t,i,r,s){let o=e,a=e,l=e,c=0;for(let u=e;u<t;u++)if((" "===n[u]||" "===n[u+1]||u+1===t)&&(l=u+1),l>a){let h=u4(n,a,l,r);c+h>i&&(o<a&&(s.push(a),o=a,c=0),h>i&&(h=d4(n,a,l,i,r,s),o=s[s.length-1])),a=l,c+=h}}(n,r,s,t,i,o),o}function ipe(n,e,t,i,r,s){let o=0,a=0;for(let l=e;l<t;l++){const c=n[l],u=i[c];u?(a||(a=u.height),r[l]=o+u.width/2,o+=u.width):(Mi.warn("Missing character: ".concat(c," (").concat(c.codePointAt(0),")"))(),r[l]=o,o+=32)}s[0]=o,s[1]=a}function h4(n,e,t,i,r){const s=(n=Array.from(n)).length,o=new Array(s),a=new Array(s),l=new Array(s),c=("break-word"===t||"break-all"===t)&&isFinite(i)&&i>0,u=[0,0],h=[];let f=0,g=0,m=0;for(let w=0;w<=s;w++){const S=n[w];if(("\n"===S||w===s)&&(m=w),m>g){const U=c?npe(n,t,i,r,g,m):Zfe;for(let D=0;D<=U.length;D++){const ie=0===D?g:U[D-1],_e=D<U.length?U[D]:m;ipe(n,ie,_e,r,o,h);for(let Ne=ie;Ne<_e;Ne++)a[Ne]=f+h[1]/2,l[Ne]=h[0];f+=h[1]*e,u[0]=Math.max(u[0],h[0])}g=m}"\n"===S&&(o[g]=0,a[g]=0,l[g]=0,g++)}return u[1]=f,{x:o,y:a,rowWidth:l,size:u}}const f4=function(){const n=[];for(let e=32;e<128;e++)n.push(String.fromCharCode(e));return n}(),p4="Monaco, monospace",XO=new class{constructor(e=5){this.limit=e,this.clear()}clear(){this._cache={},this._order=[]}get(e){const t=this._cache[e];return t&&(this._deleteOrder(e),this._appendOrder(e)),t}set(e,t){this._cache[e]?(this.delete(e),this._cache[e]=t,this._appendOrder(e)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[e]=t,this._appendOrder(e))}delete(e){this._cache[e]&&(this._deleteCache(e),this._deleteOrder(e))}_deleteCache(e){delete this._cache[e]}_deleteOrder(e){const t=this._order.findIndex(i=>i===e);t>=0&&this._order.splice(t,1)}_appendOrder(e){this._order.push(e)}}(3),cpe=["fontFamily","fontWeight","characterSet","fontSize","sdf","buffer","cutoff","radius"];function dpe(n,e){for(let t=0;t<n.length;t++)e.data[4*t+3]=n[t]}function E4(n,e,t,i){n.font="".concat(i," ").concat(t,"px ").concat(e),n.fillStyle="#000",n.textBaseline="baseline",n.textAlign="left"}class hpe{constructor(){this.props={fontFamily:p4,fontWeight:"normal",characterSet:f4,fontSize:64,buffer:4,sdf:!1,cutoff:.25,radius:12},this._key=null,this._atlas=null}get texture(){return this._atlas}get mapping(){return this._atlas&&this._atlas.mapping}get scale(){return 1.2}setProps(e={}){cpe.forEach(o=>{o in e&&(this.props[o]=e[o])});const t=this._key;this._key=this._getKey();const i=function(n,e){const t=XO.get(n);if(!t)return e;const i=[];let s=Object.keys(t.mapping);s=new Set(s);let o=e;return o instanceof Array&&(o=new Set(o)),o.forEach(a=>{s.has(a)||i.push(a)}),i}(this._key,this.props.characterSet),r=XO.get(this._key);if(r&&0===i.length)return void(this._key!==t&&(this._atlas=r));const s=this._generateFontAtlas(this._key,i,r);this._atlas=s,XO.set(this._key,s)}_generateFontAtlas(e,t,i){const{fontFamily:r,fontWeight:s,fontSize:o,buffer:a,sdf:l,radius:c,cutoff:u}=this.props;let h=i&&i.data;h||(h=document.createElement("canvas"),h.width=1024);const f=h.getContext("2d");E4(f,r,o,s);const{mapping:g,canvasHeight:m,xOffset:w,yOffset:S}=function({characterSet:n,getFontWidth:e,fontHeight:t,buffer:i,maxCanvasWidth:r,mapping:s={},xOffset:o=0,yOffset:a=0}){let l=0,c=o,u=0;for(const f of n)if(!s[f]){const g=e(f,u++);c+g+2*i>r&&(c=0,l++),s[f]={x:c+i,y:a+l*(t+2*i)+i,width:g,height:t},c+=g+2*i}const h=t+2*i;return{mapping:s,xOffset:c,yOffset:a+l*h,canvasHeight:Jfe(a+(l+1)*h)}}(ot({getFontWidth:U=>f.measureText(U).width,fontHeight:1.2*o,buffer:a,characterSet:t,maxCanvasWidth:1024},i&&{mapping:i.mapping,xOffset:i.xOffset,yOffset:i.yOffset}));if(h.height!==m){const U=f.getImageData(0,0,h.width,h.height);h.height=m,f.putImageData(U,0,0)}if(E4(f,r,o,s),l){const U=new(Xfe())(o,a,c,u,r,s),D=f.getImageData(0,0,U.size,U.size);for(const ie of t)dpe(U.draw(ie),D),f.putImageData(D,g[ie].x-a,g[ie].y+a)}else for(const U of t)f.fillText(U,g[U].x,g[U].y+.9*o);return{xOffset:w,yOffset:S,mapping:g,data:h,width:h.width,height:h.height}}_getKey(){const{fontFamily:e,fontWeight:t,fontSize:i,buffer:r,sdf:s,radius:o,cutoff:a}=this.props;return s?"".concat(e," ").concat(t," ").concat(i," ").concat(r," ").concat(o," ").concat(a):"".concat(e," ").concat(t," ").concat(i," ").concat(r)}}const gpe={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,padding:{type:"array",value:[0,0,0,0]},getPosition:{type:"accessor",value:n=>n.position},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},getBoundingRect:{type:"accessor",value:[0,0,0,0]},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1}};let mpe=(()=>{class n extends j0{getShaders(){return super.getShaders({vs:"#define SHADER_NAME text-background-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute vec4 instanceRects;\nattribute float instanceSizes;\nattribute float instanceAngles;\nattribute vec2 instancePixelOffsets;\nattribute float instanceLineWidths;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\nuniform bool billboard;\nuniform float opacity;\nuniform float sizeScale;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform vec4 padding;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying float vLineWidth;\nvarying vec2 uv;\nvarying vec2 dimensions;\n\nvec2 rotate_by_angle(vec2 vertex, float angle) {\n  float angle_radian = radians(angle);\n  float cos_angle = cos(angle_radian);\n  float sin_angle = sin(angle_radian);\n  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\n  return rotationMatrix * vertex;\n}\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = positions;\n  geometry.pickingColor = instancePickingColors;\n  uv = positions;\n  vLineWidth = instanceLineWidths;\n  float sizePixels = clamp(\n    project_size_to_pixel(instanceSizes * sizeScale),\n    sizeMinPixels, sizeMaxPixels\n  );\n\n  dimensions = instanceRects.zw * sizePixels + padding.xy + padding.zw;\n\n  vec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-padding.xy, padding.zw, positions);\n  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles);\n  pixelOffset += instancePixelOffsets;\n  pixelOffset.y *= -1.0;\n\n  if (billboard)  {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    vec3 offset = vec3(pixelOffset, 0.0);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n  } else {\n    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\n    DECKGL_FILTER_SIZE(offset_common, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);\n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);\n  DECKGL_FILTER_COLOR(vFillColor, geometry);\n  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);\n  DECKGL_FILTER_COLOR(vLineColor, geometry);\n}\n",fs:"#define SHADER_NAME text-background-layer-fragment-shader\n\nprecision highp float;\n\nuniform bool stroked;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying float vLineWidth;\nvarying vec2 uv;\nvarying vec2 dimensions;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  vec2 pixelPosition = uv * dimensions;\n  if (stroked) {\n    float distToEdge = min(\n      min(pixelPosition.x, dimensions.x - pixelPosition.x),\n      min(pixelPosition.y, dimensions.y - pixelPosition.y)\n    );\n    float isBorder = smoothedge(distToEdge, vLineWidth);\n    gl_FragColor = mix(vFillColor, vLineColor, isBorder);\n  } else {\n    gl_FragColor = vFillColor;\n  }\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[$S,WS]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instanceRects:{size:4,accessor:"getBoundingRect"},instancePixelOffsets:{size:2,transition:!0,accessor:"getPixelOffset"},instanceFillColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState({props:t,oldProps:i,changeFlags:r}){if(super.updateState({props:t,oldProps:i,changeFlags:r}),r.extensionsChanged){var s;const{gl:o}=this.context;null===(s=this.state.model)||void 0===s||s.delete(),this.state.model=this._getModel(o),this.getAttributeManager().invalidateAll()}}draw({uniforms:t}){const{viewport:i}=this.context,{billboard:r,sizeScale:s,sizeUnits:o,sizeMinPixels:a,sizeMaxPixels:l,getLineWidth:c}=this.props;let{padding:u}=this.props;const h="pixels"===o?i.metersPerPixel:1;u.length<4&&(u=[u[0],u[1],u[0],u[1]]),this.state.model.setUniforms(t).setUniforms({billboard:r,stroked:Boolean(c),padding:u,sizeScale:s*h,sizeMinPixels:a,sizeMaxPixels:l}).draw()}_getModel(t){return new Hg(t,wn(ot({},this.getShaders()),{id:this.props.id,geometry:new uh({drawMode:6,vertexCount:4,attributes:{positions:{size:2,value:new Float32Array([0,0,1,0,1,1,0,1])}}}),isInstanced:!0}))}}return n.layerName="TextBackgroundLayer",n.defaultProps=gpe,n})();const S4={fontSize:64,buffer:4,sdf:!1,radius:12,cutoff:.25,smoothing:.1},x4={start:1,middle:0,end:-1},C4={top:1,center:0,bottom:-1},QO=[0,0,0,255],ype=["fontSize","buffer","sdf","radius","cutoff"],vpe={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:"accessor",value:[255,255,255,255]},getBorderColor:{type:"accessor",value:QO},getBorderWidth:{type:"accessor",value:0},backgroundPadding:{type:"array",value:[0,0,0,0]},characterSet:{type:"object",value:f4},fontFamily:p4,fontWeight:"normal",lineHeight:1,outlineWidth:{type:"number",value:0,min:0},outlineColor:{type:"color",value:QO},fontSettings:{},wordBreak:"break-word",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:n=>n.text},getPosition:{type:"accessor",value:n=>n.position},getColor:{type:"accessor",value:QO},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]},backgroundColor:{deprecatedFor:["background","getBackgroundColor"]}};let bpe=(()=>{class n extends mz{initializeState(){this.state={styleVersion:0,fontAtlasManager:new hpe}}updateState({props:t,oldProps:i,changeFlags:r}){const o=this.state.characterSet;(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getText))&&this._updateText();const a=o!==this.state.characterSet||this._fontChanged(i,t);a&&this._updateFontAtlas(i,t),(a||t.lineHeight!==i.lineHeight||t.wordBreak!==i.wordBreak||t.maxWidth!==i.maxWidth)&&this.setState({styleVersion:this.state.styleVersion+1})}getPickingInfo({info:t}){return t.object=t.index>=0?this.props.data[t.index]:null,t}_updateFontAtlas(t,i){const{fontSettings:r,fontFamily:s,fontWeight:o}=i,{fontAtlasManager:a,characterSet:l}=this.state;a.setProps(wn(ot(ot({},S4),r),{characterSet:l,fontFamily:s,fontWeight:o}))}_fontChanged(t,i){if(t.fontFamily!==i.fontFamily||t.fontWeight!==i.fontWeight)return!0;if(t.fontSettings===i.fontSettings)return!1;const r=t.fontSettings||{},s=i.fontSettings||{};return ype.some(o=>r[o]!==s[o])}_updateText(){const{data:t,characterSet:i}=this.props,r=t.attributes&&t.attributes.getText;let a,{getText:s}=this.props,{startIndices:o}=t;const l="auto"===i&&new Set;if(r&&o){const{texts:c,characterCount:u}=function({value:n,length:e,stride:t,offset:i,startIndices:r,characterSet:s}){const o=n.BYTES_PER_ELEMENT,a=t?t/o:1,l=i?i/o:0,c=r[e]||Math.ceil((n.length-l)/a),u=s&&new Set,h=new Array(e);let f=n;if(a>1||l>0){f=new n.constructor(c);for(let g=0;g<c;g++)f[g]=n[g*a+l]}for(let g=0;g<e;g++){const S=f.subarray(r[g],r[g+1]||c);h[g]=String.fromCodePoint.apply(null,S),u&&S.forEach(u.add,u)}if(u)for(const g of u)s.add(String.fromCodePoint(g));return{texts:h,characterCount:c}}(wn(ot({},ArrayBuffer.isView(r)?{value:r}:r),{length:t.length,startIndices:o,characterSet:l}));a=u,s=(h,{index:f})=>c[f]}else{const{iterable:c,objectInfo:u}=cS(t);o=[0],a=0;for(const h of c){u.index++;const f=Array.from(s(h,u)||"");l&&f.forEach(l.add,l),a+=f.length,o.push(a)}}this.setState({getText:s,startIndices:o,numInstances:a,characterSet:l||i})}getBoundingRect(t,i){const r=this.state.fontAtlasManager.mapping,{getText:s}=this.state,{wordBreak:o,maxWidth:a,lineHeight:l,getTextAnchor:c,getAlignmentBaseline:u}=this.props,h=s(t,i)||"",{size:[f,g]}=h4(h,l,o,a,r);return[(x4["function"==typeof c?c(t,i):c]-1)*f/2,(C4["function"==typeof u?u(t,i):u]-1)*g/2,f,g]}getIconOffsets(t,i){const r=this.state.fontAtlasManager.mapping,{getText:s}=this.state,{wordBreak:o,maxWidth:a,lineHeight:l,getTextAnchor:c,getAlignmentBaseline:u}=this.props,h=s(t,i)||"",{x:f,y:g,rowWidth:m,size:[w,S]}=h4(h,l,o,a,r),U=x4["function"==typeof c?c(t,i):c],D=C4["function"==typeof u?u(t,i):u],ie=f.length,_e=new Array(2*ie);let Ne=0;for(let Pe=0;Pe<ie;Pe++)_e[Ne++]=(U-1)*w/2+(1-U)*(w-m[Pe])/2+f[Pe],_e[Ne++]=(D-1)*S/2+g[Pe];return _e}renderLayers(){const{startIndices:t,numInstances:i,getText:r,fontAtlasManager:{scale:s,texture:o,mapping:a},styleVersion:l}=this.state,{data:c,_dataDiff:u,getPosition:h,getColor:f,getSize:g,getAngle:m,getPixelOffset:w,getBackgroundColor:S,getBorderColor:U,getBorderWidth:D,backgroundPadding:ie,background:_e,billboard:Ne,fontSettings:Pe,outlineWidth:Ve,outlineColor:vt,sizeScale:wt,sizeUnits:xt,sizeMinPixels:kt,sizeMaxPixels:$t,transitions:gt,updateTriggers:mt}=this.props,jt=this.getSubLayerClass("characters",Yfe),ft=this.getSubLayerClass("background",mpe);return[_e&&new ft({getFillColor:S,getLineColor:U,getLineWidth:D,padding:ie,getPosition:h,getSize:g,getAngle:m,getPixelOffset:w,billboard:Ne,sizeScale:wt/this.state.fontAtlasManager.props.fontSize,sizeUnits:xt,sizeMinPixels:kt,sizeMaxPixels:$t,transitions:gt&&{getPosition:gt.getPosition,getAngle:gt.getAngle,getSize:gt.getSize,getFillColor:gt.getBackgroundColor,getLineColor:gt.getBorderColor,getLineWidth:gt.getBorderWidth,getPixelOffset:gt.getPixelOffset}},this.getSubLayerProps({id:"background",updateTriggers:{getPosition:mt.getPosition,getAngle:mt.getAngle,getSize:mt.getSize,getFillColor:mt.getBackgroundColor,getLineColor:mt.getBorderColor,getLineWidth:mt.getBorderWidth,getPixelOffset:mt.getPixelOffset,getBoundingRect:{getText:mt.getText,getTextAnchor:mt.getTextAnchor,getAlignmentBaseline:mt.getAlignmentBaseline,styleVersion:l}}}),{data:c.attributes?{length:c.length,attributes:c.attributes.background||{}}:c,_dataDiff:u,autoHighlight:!1,getBoundingRect:this.getBoundingRect.bind(this)}),new jt({sdf:Pe.sdf,smoothing:Number.isFinite(Pe.smoothing)?Pe.smoothing:S4.smoothing,outlineWidth:Ve,outlineColor:vt,iconAtlas:o,iconMapping:a,getPosition:h,getColor:f,getSize:g,getAngle:m,getPixelOffset:w,billboard:Ne,sizeScale:wt*s,sizeUnits:xt,sizeMinPixels:kt*s,sizeMaxPixels:$t*s,transitions:gt&&{getPosition:gt.getPosition,getAngle:gt.getAngle,getColor:gt.getColor,getSize:gt.getSize,getPixelOffset:gt.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{getIcon:mt.getText,getPosition:mt.getPosition,getAngle:mt.getAngle,getColor:mt.getColor,getSize:mt.getSize,getPixelOffset:mt.getPixelOffset,getIconOffsets:{getText:mt.getText,getTextAnchor:mt.getTextAnchor,getAlignmentBaseline:mt.getAlignmentBaseline,styleVersion:l}}}),{data:c,_dataDiff:u,startIndices:t,numInstances:i,getIconOffsets:this.getIconOffsets.bind(this),getIcon:r})]}}return n.layerName="TextLayer",n.defaultProps=vpe,n})();const T4="#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))\n\nstruct AmbientLight {\n vec3 color;\n};\n\nstruct PointLight {\n vec3 color;\n vec3 position;\n vec3 attenuation;\n};\n\nstruct DirectionalLight {\n  vec3 color;\n  vec3 direction;\n};\n\nuniform AmbientLight lighting_uAmbientLight;\nuniform PointLight lighting_uPointLight[MAX_LIGHTS];\nuniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];\nuniform int lighting_uPointLightCount;\nuniform int lighting_uDirectionalLightCount;\n\nuniform bool lighting_uEnabled;\n\nfloat getPointLightAttenuation(PointLight pointLight, float distance) {\n  return pointLight.attenuation.x\n       + pointLight.attenuation.y * distance\n       + pointLight.attenuation.z * distance * distance;\n}\n\n#endif\n",wpe={lightSources:{}};function ZO({color:n=[0,0,0],intensity:e=1}={}){return n.map(t=>t*e/255)}const JO={name:"lights",vs:T4,fs:T4,getUniforms:function A4(n=wpe){if("lightSources"in n){const{ambientLight:e,pointLights:t,directionalLights:i}=n.lightSources||{};return e||t&&t.length>0||i&&i.length>0?Object.assign({},function({ambientLight:n,pointLights:e=[],directionalLights:t=[]}){const i={};return i["lighting_uAmbientLight.color"]=n?ZO(n):[0,0,0],e.forEach((r,s)=>{i[`lighting_uPointLight[${s}].color`]=ZO(r),i[`lighting_uPointLight[${s}].position`]=r.position,i[`lighting_uPointLight[${s}].attenuation`]=r.attenuation||[1,0,0]}),i.lighting_uPointLightCount=e.length,t.forEach((r,s)=>{i[`lighting_uDirectionalLight[${s}].color`]=ZO(r),i[`lighting_uDirectionalLight[${s}].direction`]=r.direction}),i.lighting_uDirectionalLightCount=t.length,i}({ambientLight:e,pointLights:t,directionalLights:i}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in n){const e={pointLights:[],directionalLights:[]};for(const t of n.lights||[])switch(t.type){case"ambient":e.ambientLight=t;break;case"directional":e.directionalLights.push(t);break;case"point":e.pointLights.push(t)}return A4({lightSources:e})}return{}},defines:{MAX_LIGHTS:3}},Spe={};const Cpe={name:"phong-lighting",dependencies:[JO],fs:"\nuniform float lighting_uAmbient;\nuniform float lighting_uDiffuse;\nuniform float lighting_uShininess;\nuniform vec3  lighting_uSpecularColor;\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {\n    vec3 halfway_direction = normalize(light_direction + view_direction);\n    float lambertian = dot(light_direction, normal_worldspace);\n    float specular = 0.0;\n    if (lambertian > 0.0) {\n      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);\n      specular = pow(specular_angle, lighting_uShininess);\n    }\n    lambertian = max(lambertian, 0.0);\n    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;\n}\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = surfaceColor;\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n\nvec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = vec3(0, 0, 0);\n  vec3 surfaceColor = vec3(0, 0, 0);\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n",defines:{LIGHTING_FRAGMENT:1},getUniforms:function(n=Spe){if(!("material"in n))return{};const{material:e}=n;return e?function(n){const{ambient:e=.35,diffuse:t=.6,shininess:i=32,specularColor:r=[30,30,30]}=n;return{lighting_uAmbient:e,lighting_uDiffuse:t,lighting_uShininess:i,lighting_uSpecularColor:r.map(s=>s/255)}}(e):{lighting_uEnabled:!1}}},eR=Math.PI/180,qS=new Float32Array(16),I4=new Float32Array(12);function O4(n,e,t){const i=e[0]*eR,r=e[1]*eR,s=e[2]*eR,o=Math.sin(s),a=Math.sin(i),l=Math.sin(r),c=Math.cos(s),u=Math.cos(i),h=Math.cos(r),f=t[0],g=t[1],m=t[2];n[0]=f*h*u,n[1]=f*l*u,n[2]=f*-a,n[3]=g*(-l*c+h*a*o),n[4]=g*(h*c+l*a*o),n[5]=g*u*o,n[6]=m*(l*o+h*a*c),n[7]=m*(-h*o+l*a*c),n[8]=m*u*c}function R4(n){return n[0]=n[0],n[1]=n[1],n[2]=n[2],n[3]=n[4],n[4]=n[5],n[5]=n[6],n[6]=n[8],n[7]=n[9],n[8]=n[10],n[9]=n[12],n[10]=n[13],n[11]=n[14],n.subarray(0,12)}const N4={size:12,accessor:["getOrientation","getScale","getTranslation","getTransformMatrix"],shaderAttributes:{instanceModelMatrix__LOCATION_0:{size:3,elementOffset:0},instanceModelMatrix__LOCATION_1:{size:3,elementOffset:3},instanceModelMatrix__LOCATION_2:{size:3,elementOffset:6},instanceTranslation:{size:3,elementOffset:9}},update(n,{startRow:e,endRow:t}){const{data:i,getOrientation:r,getScale:s,getTranslation:o,getTransformMatrix:a}=this.props,l=Array.isArray(a),c=l&&16===a.length,u=Array.isArray(s),h=Array.isArray(r),f=Array.isArray(o),g=c||!l&&Boolean(a(i[0]));n.constant=g?c:h&&u&&f;const m=n.value;if(n.constant){let w;g?(qS.set(a),w=R4(qS)):(w=I4,O4(w,r,s),w.set(o,9)),n.value=new Float32Array(w)}else{let w=e*n.size;const{iterable:S,objectInfo:U}=cS(i,e,t);for(const D of S){let ie;U.index++,g?(qS.set(c?a:a(D,U)),ie=R4(qS)):(ie=I4,O4(ie,h?r:r(D,U),u?s:s(D,U)),ie.set(f?o:o(D,U),9)),m[w++]=ie[0],m[w++]=ie[1],m[w++]=ie[2],m[w++]=ie[3],m[w++]=ie[4],m[w++]=ie[5],m[w++]=ie[6],m[w++]=ie[7],m[w++]=ie[8],m[w++]=ie[9],m[w++]=ie[10],m[w++]=ie[11]}}}};function P4(n,e){return e===Fi.CARTESIAN||e===Fi.METER_OFFSETS||e===Fi.DEFAULT&&!n.isGeospatial}function F4(n,e){(n.COLOR_0||n.colors)&&e||(n.colors={constant:!0,value:new Float32Array([1,1,1])}),Mi.assert(n.positions||n.POSITION,'no "postions" or "POSITION" attribute in mesh')}function Mpe(n,e){if(n.attributes)return F4(n.attributes,e),n instanceof uh?n:new uh(n);if(n.positions||n.POSITION)return F4(n,e),new uh({attributes:n});throw Error("Invalid mesh")}const Dpe={mesh:{value:null,type:"object",async:!0},texture:{type:"image",value:null,async:!0},sizeScale:{type:"number",value:1,min:0},_useMeshColors:{type:"boolean",value:!1},_instanced:!0,wireframe:!1,material:!0,getPosition:{type:"accessor",value:n=>n.position},getColor:{type:"accessor",value:[0,0,0,255]},getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]}};let Ipe=(()=>{class n extends j0{getShaders(){const t=!_i(this.context.gl),i={};return aI(this.context.gl,"GLSL_DERIVATIVES")&&(i.DERIVATIVES_AVAILABLE=1),super.getShaders({vs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-vs\nuniform float sizeScale;\nuniform bool composeModelMatrix;\nin vec3 positions;\nin vec3 normals;\nin vec3 colors;\nin vec2 texCoords;\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin mat3 instanceModelMatrix;\nin vec3 instanceTranslation;\nout vec2 vTexCoord;\nout vec3 cameraPosition;\nout vec3 normals_commonspace;\nout vec4 position_commonspace;\nout vec4 vColor;\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = texCoords;\n  geometry.pickingColor = instancePickingColors;\n\n  vTexCoord = texCoords;\n  cameraPosition = project_uCameraPosition;\n  normals_commonspace = project_normal(instanceModelMatrix * normals);\n  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);\n  geometry.normal = normals_commonspace;\n\n  vec3 pos = (instanceModelMatrix * positions) * sizeScale + instanceTranslation;\n\n  if (composeModelMatrix) {\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), position_commonspace);\n  }\n  else {\n    pos = project_size(pos);\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, position_commonspace);\n  }\n\n  geometry.position = position_commonspace;\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-fs\n\nprecision highp float;\n\nuniform bool hasTexture;\nuniform sampler2D sampler;\nuniform bool flatShading;\nuniform float opacity;\n\nin vec2 vTexCoord;\nin vec3 cameraPosition;\nin vec3 normals_commonspace;\nin vec4 position_commonspace;\nin vec4 vColor;\n\nout vec4 fragColor;\n\nvoid main(void) {\n  geometry.uv = vTexCoord;\n\n  vec3 normal;\n  if (flatShading) {\n#ifdef DERIVATIVES_AVAILABLE\n    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));\n#else\n    normal = vec3(0.0, 0.0, 1.0);\n#endif\n  } else {\n    normal = normals_commonspace;\n  }\n\n  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;\n  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);\n  fragColor = vec4(lightColor, color.a * opacity);\n\n  DECKGL_FILTER_COLOR(fragColor, geometry);\n}\n",modules:[$S,Cpe,WS],transpileToGLSL100:t,defines:i})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{transition:!0,type:5130,fp64:this.use64bitPositions(),size:3,accessor:"getPosition"},instanceColors:{type:5121,transition:!0,size:this.props.colorFormat.length,normalized:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceModelMatrix:N4}),this.setState({emptyTexture:new da(this.context.gl,{data:new Uint8Array(4),width:1,height:1})})}updateState({props:t,oldProps:i,changeFlags:r}){if(super.updateState({props:t,oldProps:i,changeFlags:r}),t.mesh!==i.mesh||r.extensionsChanged){var s;if(null===(s=this.state.model)||void 0===s||s.delete(),t.mesh){this.state.model=this.getModel(t.mesh);const o=t.mesh.attributes||t.mesh;this.setState({hasNormals:Boolean(o.NORMAL||o.normals)})}this.getAttributeManager().invalidateAll()}t.texture!==i.texture&&this.setTexture(t.texture),this.state.model&&this.state.model.setDrawMode(this.props.wireframe?3:4)}finalizeState(){super.finalizeState(),this.state.emptyTexture.delete()}draw({uniforms:t}){if(!this.state.model)return;const{viewport:i}=this.context,{sizeScale:r,coordinateSystem:s,_instanced:o}=this.props;this.state.model.setUniforms(t).setUniforms({sizeScale:r,composeModelMatrix:!o||P4(i,s),flatShading:!this.state.hasNormals}).draw()}getModel(t){const i=new Hg(this.context.gl,wn(ot({},this.getShaders()),{id:this.props.id,geometry:Mpe(t,this.props._useMeshColors),isInstanced:!0})),{texture:r}=this.props,{emptyTexture:s}=this.state;return i.setUniforms({sampler:r||s,hasTexture:Boolean(r)}),i}setTexture(t){const{emptyTexture:i,model:r}=this.state;null==r||r.setUniforms({sampler:t||i,hasTexture:Boolean(t)})}}return n.layerName="SimpleMeshLayer",n.defaultProps=Dpe,n})();const L4={name:"pbr",vs:"uniform mat4 u_MVPMatrix;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_NormalMatrix;\n\nvarying vec3 pbr_vPosition;\nvarying vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n# ifdef HAS_TANGENTS\nvarying mat3 pbr_vTBN;\n# else\nvarying vec3 pbr_vNormal;\n# endif\n#endif\n\nvoid pbr_setPositionNormalTangentUV(vec4 position, vec4 normal, vec4 tangent, vec2 uv)\n{\n  vec4 pos = u_ModelMatrix * position;\n  pbr_vPosition = vec3(pos.xyz) / pos.w;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\n  vec3 normalW = normalize(vec3(u_NormalMatrix * vec4(normal.xyz, 0.0)));\n  vec3 tangentW = normalize(vec3(u_ModelMatrix * vec4(tangent.xyz, 0.0)));\n  vec3 bitangentW = cross(normalW, tangentW) * tangent.w;\n  pbr_vTBN = mat3(tangentW, bitangentW, normalW);\n#else\n  pbr_vNormal = normalize(vec3(u_ModelMatrix * vec4(normal.xyz, 0.0)));\n#endif\n#endif\n\n#ifdef HAS_UV\n  pbr_vUV = uv;\n#else\n  pbr_vUV = vec2(0.,0.);\n#endif\n}\n",fs:"#if defined(USE_TEX_LOD) && !defined(FEATURE_GLSL_TEXTURE_LOD)\n# error PBR fragment shader: Texture LOD is not available\n#endif\n\n#if !defined(HAS_TANGENTS) && !defined(FEATURE_GLSL_DERIVATIVES)\n# error PBR fragment shader: Derivatives are not available\n#endif\n\n\n#if (__VERSION__ < 300)\n  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL1COND; INCR)\n#else\n  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL2COND; INCR)\n#endif\n\nprecision highp float;\n\nuniform bool pbr_uUnlit;\n\n#ifdef USE_IBL\nuniform samplerCube u_DiffuseEnvSampler;\nuniform samplerCube u_SpecularEnvSampler;\nuniform sampler2D u_brdfLUT;\nuniform vec2 u_ScaleIBLAmbient;\n#endif\n\n#ifdef HAS_BASECOLORMAP\nuniform sampler2D u_BaseColorSampler;\n#endif\n#ifdef HAS_NORMALMAP\nuniform sampler2D u_NormalSampler;\nuniform float u_NormalScale;\n#endif\n#ifdef HAS_EMISSIVEMAP\nuniform sampler2D u_EmissiveSampler;\nuniform vec3 u_EmissiveFactor;\n#endif\n#ifdef HAS_METALROUGHNESSMAP\nuniform sampler2D u_MetallicRoughnessSampler;\n#endif\n#ifdef HAS_OCCLUSIONMAP\nuniform sampler2D u_OcclusionSampler;\nuniform float u_OcclusionStrength;\n#endif\n\n#ifdef ALPHA_CUTOFF\nuniform float u_AlphaCutoff;\n#endif\n\nuniform vec2 u_MetallicRoughnessValues;\nuniform vec4 u_BaseColorFactor;\n\nuniform vec3 u_Camera;\n#ifdef PBR_DEBUG\nuniform vec4 u_ScaleDiffBaseMR;\nuniform vec4 u_ScaleFGDSpec;\n#endif\n\nvarying vec3 pbr_vPosition;\n\nvarying vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\nvarying mat3 pbr_vTBN;\n#else\nvarying vec3 pbr_vNormal;\n#endif\n#endif\n\n\nstruct PBRInfo\n{\n  float NdotL;\n  float NdotV;\n  float NdotH;\n  float LdotH;\n  float VdotH;\n  float perceptualRoughness;\n  float metalness;\n  vec3 reflectance0;\n  vec3 reflectance90;\n  float alphaRoughness;\n  vec3 diffuseColor;\n  vec3 specularColor;\n  vec3 n;\n  vec3 v;\n};\n\nconst float M_PI = 3.141592653589793;\nconst float c_MinRoughness = 0.04;\n\nvec4 SRGBtoLINEAR(vec4 srgbIn)\n{\n#ifdef MANUAL_SRGB\n#ifdef SRGB_FAST_APPROXIMATION\n  vec3 linOut = pow(srgbIn.xyz,vec3(2.2));\n#else\n  vec3 bLess = step(vec3(0.04045),srgbIn.xyz);\n  vec3 linOut = mix( srgbIn.xyz/vec3(12.92), pow((srgbIn.xyz+vec3(0.055))/vec3(1.055),vec3(2.4)), bLess );\n#endif\n  return vec4(linOut,srgbIn.w);;\n#else\n  return srgbIn;\n#endif\n}\n\nvec3 getNormal()\n{\n#ifndef HAS_TANGENTS\n  vec3 pos_dx = dFdx(pbr_vPosition);\n  vec3 pos_dy = dFdy(pbr_vPosition);\n  vec3 tex_dx = dFdx(vec3(pbr_vUV, 0.0));\n  vec3 tex_dy = dFdy(vec3(pbr_vUV, 0.0));\n  vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);\n\n#ifdef HAS_NORMALS\n  vec3 ng = normalize(pbr_vNormal);\n#else\n  vec3 ng = cross(pos_dx, pos_dy);\n#endif\n\n  t = normalize(t - ng * dot(ng, t));\n  vec3 b = normalize(cross(ng, t));\n  mat3 tbn = mat3(t, b, ng);\n#else\n  mat3 tbn = pbr_vTBN;\n#endif\n\n#ifdef HAS_NORMALMAP\n  vec3 n = texture2D(u_NormalSampler, pbr_vUV).rgb;\n  n = normalize(tbn * ((2.0 * n - 1.0) * vec3(u_NormalScale, u_NormalScale, 1.0)));\n#else\n  vec3 n = normalize(tbn[2].xyz);\n#endif\n\n  return n;\n}\n\n\n#ifdef USE_IBL\nvec3 getIBLContribution(PBRInfo pbrInputs, vec3 n, vec3 reflection)\n{\n  float mipCount = 9.0;\n  float lod = (pbrInputs.perceptualRoughness * mipCount);\n  vec3 brdf = SRGBtoLINEAR(texture2D(u_brdfLUT,\n    vec2(pbrInputs.NdotV, 1.0 - pbrInputs.perceptualRoughness))).rgb;\n  vec3 diffuseLight = SRGBtoLINEAR(textureCube(u_DiffuseEnvSampler, n)).rgb;\n\n#ifdef USE_TEX_LOD\n  vec3 specularLight = SRGBtoLINEAR(textureCubeLod(u_SpecularEnvSampler, reflection, lod)).rgb;\n#else\n  vec3 specularLight = SRGBtoLINEAR(textureCube(u_SpecularEnvSampler, reflection)).rgb;\n#endif\n\n  vec3 diffuse = diffuseLight * pbrInputs.diffuseColor;\n  vec3 specular = specularLight * (pbrInputs.specularColor * brdf.x + brdf.y);\n  diffuse *= u_ScaleIBLAmbient.x;\n  specular *= u_ScaleIBLAmbient.y;\n\n  return diffuse + specular;\n}\n#endif\n\n\nvec3 diffuse(PBRInfo pbrInputs)\n{\n  return pbrInputs.diffuseColor / M_PI;\n}\n\nvec3 specularReflection(PBRInfo pbrInputs)\n{\n  return pbrInputs.reflectance0 +\n    (pbrInputs.reflectance90 - pbrInputs.reflectance0) *\n    pow(clamp(1.0 - pbrInputs.VdotH, 0.0, 1.0), 5.0);\n}\n\n\n\nfloat geometricOcclusion(PBRInfo pbrInputs)\n{\n  float NdotL = pbrInputs.NdotL;\n  float NdotV = pbrInputs.NdotV;\n  float r = pbrInputs.alphaRoughness;\n\n  float attenuationL = 2.0 * NdotL / (NdotL + sqrt(r * r + (1.0 - r * r) * (NdotL * NdotL)));\n  float attenuationV = 2.0 * NdotV / (NdotV + sqrt(r * r + (1.0 - r * r) * (NdotV * NdotV)));\n  return attenuationL * attenuationV;\n}\n\n\n\n\n\nfloat microfacetDistribution(PBRInfo pbrInputs)\n{\n  float roughnessSq = pbrInputs.alphaRoughness * pbrInputs.alphaRoughness;\n  float f = (pbrInputs.NdotH * roughnessSq - pbrInputs.NdotH) * pbrInputs.NdotH + 1.0;\n  return roughnessSq / (M_PI * f * f);\n}\n\nvoid PBRInfo_setAmbientLight(inout PBRInfo pbrInputs) {\n  pbrInputs.NdotL = 1.0;\n  pbrInputs.NdotH = 0.0;\n  pbrInputs.LdotH = 0.0;\n  pbrInputs.VdotH = 1.0;\n}\n\nvoid PBRInfo_setDirectionalLight(inout PBRInfo pbrInputs, vec3 lightDirection) {\n  vec3 n = pbrInputs.n;\n  vec3 v = pbrInputs.v;\n  vec3 l = normalize(lightDirection);\n  vec3 h = normalize(l+v);\n\n  pbrInputs.NdotL = clamp(dot(n, l), 0.001, 1.0);\n  pbrInputs.NdotH = clamp(dot(n, h), 0.0, 1.0);\n  pbrInputs.LdotH = clamp(dot(l, h), 0.0, 1.0);\n  pbrInputs.VdotH = clamp(dot(v, h), 0.0, 1.0);\n}\n\nvoid PBRInfo_setPointLight(inout PBRInfo pbrInputs, PointLight pointLight) {\n  vec3 light_direction = normalize(pointLight.position - pbr_vPosition);\n  PBRInfo_setDirectionalLight(pbrInputs, light_direction);\n}\n\nvec3 calculateFinalColor(PBRInfo pbrInputs, vec3 lightColor) {\n  vec3 F = specularReflection(pbrInputs);\n  float G = geometricOcclusion(pbrInputs);\n  float D = microfacetDistribution(pbrInputs);\n  vec3 diffuseContrib = (1.0 - F) * diffuse(pbrInputs);\n  vec3 specContrib = F * G * D / (4.0 * pbrInputs.NdotL * pbrInputs.NdotV);\n  return pbrInputs.NdotL * lightColor * (diffuseContrib + specContrib);\n}\n\nvec4 pbr_filterColor(vec4 colorUnused)\n{\n#ifdef HAS_BASECOLORMAP\n  vec4 baseColor = SRGBtoLINEAR(texture2D(u_BaseColorSampler, pbr_vUV)) * u_BaseColorFactor;\n#else\n  vec4 baseColor = u_BaseColorFactor;\n#endif\n\n#ifdef ALPHA_CUTOFF\n  if (baseColor.a < u_AlphaCutoff) {\n    discard;\n  }\n#endif\n\n  vec3 color = vec3(0, 0, 0);\n\n  if(pbr_uUnlit){\n    color.rgb = baseColor.rgb;\n  }\n  else{\n\n\n    float perceptualRoughness = u_MetallicRoughnessValues.y;\n    float metallic = u_MetallicRoughnessValues.x;\n#ifdef HAS_METALROUGHNESSMAP\n\n    vec4 mrSample = texture2D(u_MetallicRoughnessSampler, pbr_vUV);\n    perceptualRoughness = mrSample.g * perceptualRoughness;\n    metallic = mrSample.b * metallic;\n#endif\n    perceptualRoughness = clamp(perceptualRoughness, c_MinRoughness, 1.0);\n    metallic = clamp(metallic, 0.0, 1.0);\n\n    float alphaRoughness = perceptualRoughness * perceptualRoughness;\n\n    vec3 f0 = vec3(0.04);\n    vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);\n    diffuseColor *= 1.0 - metallic;\n    vec3 specularColor = mix(f0, baseColor.rgb, metallic);\n    float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);\n\n\n\n    float reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);\n    vec3 specularEnvironmentR0 = specularColor.rgb;\n    vec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;\n\n    vec3 n = getNormal();\n    vec3 v = normalize(u_Camera - pbr_vPosition);\n\n    float NdotV = clamp(abs(dot(n, v)), 0.001, 1.0);\n    vec3 reflection = -normalize(reflect(v, n));\n\n    PBRInfo pbrInputs = PBRInfo(\n      0.0,\n      NdotV,\n      0.0,\n      0.0,\n      0.0,\n      perceptualRoughness,\n      metallic,\n      specularEnvironmentR0,\n      specularEnvironmentR90,\n      alphaRoughness,\n      diffuseColor,\n      specularColor,\n      n,\n      v\n    );\n\n#ifdef USE_LIGHTS\n    PBRInfo_setAmbientLight(pbrInputs);\n    color += calculateFinalColor(pbrInputs, lighting_uAmbientLight.color);\n    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uDirectionalLightCount, i++) {\n      if (i < lighting_uDirectionalLightCount) {\n        PBRInfo_setDirectionalLight(pbrInputs, lighting_uDirectionalLight[i].direction);\n        color += calculateFinalColor(pbrInputs, lighting_uDirectionalLight[i].color);\n      }\n    }\n    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uPointLightCount, i++) {\n      if (i < lighting_uPointLightCount) {\n        PBRInfo_setPointLight(pbrInputs, lighting_uPointLight[i]);\n        float attenuation = getPointLightAttenuation(lighting_uPointLight[i], distance(lighting_uPointLight[i].position, pbr_vPosition));\n        color += calculateFinalColor(pbrInputs, lighting_uPointLight[i].color / attenuation);\n      }\n    }\n#endif\n#ifdef USE_IBL\n    color += getIBLContribution(pbrInputs, n, reflection);\n#endif\n#ifdef HAS_OCCLUSIONMAP\n    float ao = texture2D(u_OcclusionSampler, pbr_vUV).r;\n    color = mix(color, color * ao, u_OcclusionStrength);\n#endif\n\n#ifdef HAS_EMISSIVEMAP\n    vec3 emissive = SRGBtoLINEAR(texture2D(u_EmissiveSampler, pbr_vUV)).rgb * u_EmissiveFactor;\n    color += emissive;\n#endif\n\n#ifdef PBR_DEBUG\n\n\n\n\n\n    color = mix(color, baseColor.rgb, u_ScaleDiffBaseMR.y);\n    color = mix(color, vec3(metallic), u_ScaleDiffBaseMR.z);\n    color = mix(color, vec3(perceptualRoughness), u_ScaleDiffBaseMR.w);\n#endif\n\n  }\n\n  return vec4(pow(color,vec3(1.0/2.2)), baseColor.a);\n}\n",defines:{LIGHTING_FRAGMENT:1},dependencies:[JO]};class Jg{constructor(e={}){const{id:t}=e;this.id=t||ca(this.constructor.name),this.display=!0,this.position=new So,this.rotation=new So,this.scale=new So(1,1,1),this.matrix=new Gn,this.userData={},this.props={},this._setScenegraphNodeProps(e)}delete(){}setProps(e){return this._setScenegraphNodeProps(e),this}toString(){return`{type: ScenegraphNode, id: ${this.id})}`}setPosition(e){return nn(3===e.length,"setPosition requires vector argument"),this.position=e,this}setRotation(e){return nn(3===e.length,"setRotation requires vector argument"),this.rotation=e,this}setScale(e){return nn(3===e.length,"setScale requires vector argument"),this.scale=e,this}setMatrix(e,t=!0){t?this.matrix.copy(e):this.matrix=e}setMatrixComponents({position:e,rotation:t,scale:i,update:r=!0}){return e&&this.setPosition(e),t&&this.setRotation(t),i&&this.setScale(i),r&&this.updateMatrix(),this}updateMatrix(){const e=this.position,t=this.rotation,i=this.scale;return this.matrix.identity(),this.matrix.translate(e),this.matrix.rotateXYZ(t),this.matrix.scale(i),this}update(e={}){const{position:t,rotation:i,scale:r}=e;return t&&this.setPosition(t),i&&this.setRotation(i),r&&this.setScale(r),this.updateMatrix(),this}getCoordinateUniforms(e,t){nn(e),t=t||this.matrix;const i=new Gn(e).multiplyRight(t),r=i.invert(),s=r.transpose();return{viewMatrix:e,modelMatrix:t,objectMatrix:t,worldMatrix:i,worldInverseMatrix:r,worldInverseTransposeMatrix:s}}_setScenegraphNodeProps(e){"display"in e&&(this.display=e.display),"position"in e&&this.setPosition(e.position),"rotation"in e&&this.setRotation(e.rotation),"scale"in e&&this.setScale(e.scale),"matrix"in e&&this.setMatrix(e.matrix),Object.assign(this.props,e)}}class q0 extends Jg{constructor(e={}){e=Array.isArray(e)?{children:e}:e;const{children:t=[]}=e;hn.assert(t.every(i=>i instanceof Jg),"every child must an instance of ScenegraphNode"),super(e),this.children=t}add(...e){for(const t of e)Array.isArray(t)?this.add(...t):this.children.push(t);return this}remove(e){const t=this.children,i=t.indexOf(e);return i>-1&&t.splice(i,1),this}removeAll(){return this.children=[],this}delete(){this.children.forEach(e=>e.delete()),this.removeAll(),super.delete()}traverse(e,{worldMatrix:t=new Gn}={}){const i=new Gn(t).multiplyRight(this.matrix);for(const r of this.children)r instanceof q0?r.traverse(e,{worldMatrix:i}):e(r,{worldMatrix:i})}}function k4(n,e){if(n===e){var t=e[1],i=e[2],r=e[5];n[1]=e[3],n[2]=e[6],n[3]=t,n[5]=e[7],n[6]=i,n[7]=r}else n[0]=e[0],n[1]=e[3],n[2]=e[6],n[3]=e[1],n[4]=e[4],n[5]=e[7],n[6]=e[2],n[7]=e[5],n[8]=e[8];return n}function B4(n,e){var t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=u*o-a*c,f=-u*s+a*l,g=c*s-o*l,m=t*h+i*f+r*g;return m?(n[0]=h*(m=1/m),n[1]=(-u*i+r*c)*m,n[2]=(a*i-r*o)*m,n[3]=f*m,n[4]=(u*t-r*l)*m,n[5]=(-a*t+r*s)*m,n[6]=g*m,n[7]=(-c*t+i*l)*m,n[8]=(o*t-i*s)*m,n):null}function V4(n){var r=n[3],s=n[4],o=n[5],a=n[6],l=n[7],c=n[8];return n[0]*(c*s-o*l)+n[1]*(-c*r+o*a)+n[2]*(l*r-s*a)}function YS(n,e,t){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],f=t[0],g=t[1],m=t[2],w=t[3],S=t[4],U=t[5],D=t[6],ie=t[7],_e=t[8];return n[0]=f*i+g*o+m*c,n[1]=f*r+g*a+m*u,n[2]=f*s+g*l+m*h,n[3]=w*i+S*o+U*c,n[4]=w*r+S*a+U*u,n[5]=w*s+S*l+U*h,n[6]=D*i+ie*o+_e*c,n[7]=D*r+ie*a+_e*u,n[8]=D*s+ie*l+_e*h,n}function j4(n,e,t){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],f=t[0],g=t[1];return n[0]=i,n[1]=r,n[2]=s,n[3]=o,n[4]=a,n[5]=l,n[6]=f*i+g*o+c,n[7]=f*r+g*a+u,n[8]=f*s+g*l+h,n}function U4(n,e,t){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],f=Math.sin(t),g=Math.cos(t);return n[0]=g*i+f*o,n[1]=g*r+f*a,n[2]=g*s+f*l,n[3]=g*o-f*i,n[4]=g*a-f*r,n[5]=g*l-f*s,n[6]=c,n[7]=u,n[8]=h,n}function KS(n,e,t){var i=t[0],r=t[1];return n[0]=i*e[0],n[1]=i*e[1],n[2]=i*e[2],n[3]=r*e[3],n[4]=r*e[4],n[5]=r*e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n}function z4(n,e){var t=e[0],i=e[1],r=e[2],s=e[3],o=t+t,a=i+i,l=r+r,c=t*o,u=i*o,h=i*a,f=r*o,g=r*a,m=r*l,w=s*o,S=s*a,U=s*l;return n[0]=1-h-m,n[3]=u-U,n[6]=f+S,n[1]=u+U,n[4]=1-c-m,n[7]=g-w,n[2]=f-S,n[5]=g+w,n[8]=1-c-h,n}function H4(){var n=new ha(4);return ha!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n[3]=1,n}function G4(n){return n[0]=0,n[1]=0,n[2]=0,n[3]=1,n}function tR(n,e,t){t*=.5;var i=Math.sin(t);return n[0]=i*e[0],n[1]=i*e[1],n[2]=i*e[2],n[3]=Math.cos(t),n}function XS(n,e,t){var i=e[0],r=e[1],s=e[2],o=e[3],a=t[0],l=t[1],c=t[2],u=t[3];return n[0]=i*u+o*a+r*c-s*l,n[1]=r*u+o*l+s*a-i*c,n[2]=s*u+o*c+i*l-r*a,n[3]=o*u-i*a-r*l-s*c,n}function $4(n,e,t){t*=.5;var i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(t),l=Math.cos(t);return n[0]=i*l+o*a,n[1]=r*l+s*a,n[2]=s*l-r*a,n[3]=o*l-i*a,n}function W4(n,e,t){t*=.5;var i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(t),l=Math.cos(t);return n[0]=i*l-s*a,n[1]=r*l+o*a,n[2]=s*l+i*a,n[3]=o*l-r*a,n}function q4(n,e,t){t*=.5;var i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(t),l=Math.cos(t);return n[0]=i*l+r*a,n[1]=r*l-i*a,n[2]=s*l+o*a,n[3]=o*l-s*a,n}function Y4(n,e){var t=e[0],i=e[1],r=e[2];return n[0]=t,n[1]=i,n[2]=r,n[3]=Math.sqrt(Math.abs(1-t*t-i*i-r*r)),n}function Y0(n,e,t,i){var f,g,m,w,S,r=e[0],s=e[1],o=e[2],a=e[3],l=t[0],c=t[1],u=t[2],h=t[3];return(g=r*l+s*c+o*u+a*h)<0&&(g=-g,l=-l,c=-c,u=-u,h=-h),1-g>Yc?(f=Math.acos(g),m=Math.sin(f),w=Math.sin((1-i)*f)/m,S=Math.sin(i*f)/m):(w=1-i,S=i),n[0]=w*r+S*l,n[1]=w*s+S*c,n[2]=w*o+S*u,n[3]=w*a+S*h,n}function K4(n,e){var t=e[0],i=e[1],r=e[2],s=e[3],o=t*t+i*i+r*r+s*s,a=o?1/o:0;return n[0]=-t*a,n[1]=-i*a,n[2]=-r*a,n[3]=s*a,n}function X4(n,e){return n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n[3]=e[3],n}function nR(n,e){var i,t=e[0]+e[4]+e[8];if(t>0)i=Math.sqrt(t+1),n[3]=.5*i,n[0]=(e[5]-e[7])*(i=.5/i),n[1]=(e[6]-e[2])*i,n[2]=(e[1]-e[3])*i;else{var r=0;e[4]>e[0]&&(r=1),e[8]>e[3*r+r]&&(r=2);var s=(r+1)%3,o=(r+2)%3;i=Math.sqrt(e[3*r+r]-e[3*s+s]-e[3*o+o]+1),n[r]=.5*i,n[3]=(e[3*s+o]-e[3*o+s])*(i=.5/i),n[s]=(e[3*s+r]+e[3*r+s])*i,n[o]=(e[3*o+r]+e[3*r+o])*i}return n}var Q4=function(n,e,t){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3],n},iR=uU,rR=function(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]+n[3]*e[3]},Z4=function(n,e,t,i){var r=e[0],s=e[1],o=e[2],a=e[3];return n[0]=r+i*(t[0]-r),n[1]=s+i*(t[1]-s),n[2]=o+i*(t[2]-o),n[3]=a+i*(t[3]-a),n},J4=function(n){return Math.hypot(n[0],n[1],n[2],n[3])},eH=function(n){var e=n[0],t=n[1],i=n[2],r=n[3];return e*e+t*t+i*i+r*r},nH=function(){var n=JV(),e=ej(1,0,0),t=ej(0,1,0);return function(i,r,s){var o=tj(r,s);return o<-.999999?(w0(n,e,r),function(n){return Math.hypot(n[0],n[1],n[2])}(n)<1e-6&&w0(n,t,r),function(n,e){var t=e[0],i=e[1],r=e[2],s=t*t+i*i+r*r;s>0&&(s=1/Math.sqrt(s)),n[0]=e[0]*s,n[1]=e[1]*s,n[2]=e[2]*s}(n,n),tR(i,n,Math.PI),i):o>.999999?(i[0]=0,i[1]=0,i[2]=0,i[3]=1,i):(w0(n,r,s),i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=1+o,function(n,e){var t=e[0],i=e[1],r=e[2],s=e[3],o=t*t+i*i+r*r+s*s;return o>0&&(o=1/Math.sqrt(o)),n[0]=t*o,n[1]=i*o,n[2]=r*o,n[3]=s*o,n}(i,i))}}();H4(),H4(),function(){var n=new ha(9);ha!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[5]=0,n[6]=0,n[7]=0),n[0]=1,n[4]=1,n[8]=1}();const Ppe=[0,0,0,1];class sR extends oS{constructor(e=0,t=0,i=0,r=1){super(-0,-0,-0,-0),Array.isArray(e)&&1===arguments.length?this.copy(e):this.set(e,t,i,r)}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}set(e,t,i,r){return this[0]=e,this[1]=t,this[2]=i,this[3]=r,this.check()}fromMatrix3(e){return nR(this,e),this.check()}identity(){return G4(this),this.check()}fromAxisRotation(e,t){return tR(this,e,t),this.check()}setAxisAngle(e,t){return this.fromAxisRotation(e,t)}get ELEMENTS(){return 4}get x(){return this[0]}set x(e){this[0]=er(e)}get y(){return this[1]}set y(e){this[1]=er(e)}get z(){return this[2]}set z(e){this[2]=er(e)}get w(){return this[3]}set w(e){this[3]=er(e)}len(){return J4(this)}lengthSquared(){return eH(this)}dot(e,t){if(void 0!==t)throw new Error("Quaternion.dot only takes one argument");return rR(this,e)}rotationTo(e,t){return nH(this,e,t),this.check()}add(e,t){if(void 0!==t)throw new Error("Quaternion.add only takes one argument");return Q4(this,this,e),this.check()}calculateW(){return Y4(this,this),this.check()}conjugate(){return X4(this,this),this.check()}invert(){return K4(this,this),this.check()}lerp(e,t,i){return Z4(this,e,t,i),this.check()}multiplyRight(e,t){return Gu(!t),XS(this,this,e),this.check()}multiplyLeft(e,t){return Gu(!t),XS(this,e,this),this.check()}normalize(){const e=this.len(),t=e>0?1/e:0;return this[0]=this[0]*t,this[1]=this[1]*t,this[2]=this[2]*t,this[3]=this[3]*t,0===e&&(this[3]=1),this.check()}rotateX(e){return $4(this,this,e),this.check()}rotateY(e){return W4(this,this,e),this.check()}rotateZ(e){return q4(this,this,e),this.check()}scale(e){return iR(this,this,e),this.check()}slerp(e,t,i){switch(arguments.length){case 1:({start:e=Ppe,target:t,ratio:i}=arguments[0]);break;case 2:[t,i]=arguments,e=this}return Y0(this,e,t,i),this.check()}transformVector4(e,t=e){return dU(t,e,this),b0(t,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(e,t){return this.setAxisAngle(e,t)}premultiply(e,t){return this.multiplyLeft(e,t)}multiply(e,t){return this.multiplyRight(e,t)}}const Fpe={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Lpe={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function iH(n){if(!n._animation){const e=Lpe[n.componentType],t=Fpe[n.type],i=t*n.count,{buffer:r,byteOffset:s}=n.bufferView.data,o=new e(r,s+(n.byteOffset||0),i);if(1===t)n._animation=Array.from(o);else{const a=[];for(let l=0;l<o.length;l+=t)a.push(Array.from(o.slice(l,l+t)));n._animation=a}}return n._animation}const kpe=new Gn,oR=new sR;class Hpe{constructor(e){this.startTime=0,this.playing=!0,this.speed=1,this.channels=[],Object.assign(this,e)}animate(e){if(!this.playing)return;const i=(e/1e3-this.startTime)*this.speed;this.channels.forEach(({sampler:r,target:s,path:o})=>{(function(n,{input:e,interpolation:t,output:i},r,s){const a=n%e[e.length-1],l=e.findIndex(f=>f>=a),c=Math.max(0,l-1);if(!Array.isArray(r[s]))switch(s){case"translation":r[s]=[0,0,0];break;case"rotation":r[s]=[0,0,0,1];break;case"scale":r[s]=[1,1,1];break;default:hn.warn(`Bad animation path ${s}`)()}nn(r[s].length===i[c].length);const u=e[c],h=e[l];switch(t){case"STEP":!function(n,e,t){for(let i=0;i<t.length;i++)n[e][i]=t[i]}(r,s,i[c]);break;case"LINEAR":h>u&&function(n,e,t,i,r){if("rotation"===e){oR.slerp({start:t,target:i,ratio:r});for(let s=0;s<oR.length;s++)n[e][s]=oR[s]}else for(let s=0;s<t.length;s++)n[e][s]=r*i[s]+(1-r)*t[s]}(r,s,i[c],i[l],(a-u)/(h-u));break;case"CUBICSPLINE":h>u&&function(n,e,{p0:t,outTangent0:i,inTangent1:r,p1:s,tDiff:o,ratio:a}){for(let l=0;l<n[e].length;l++){const c=i[l]*o,u=r[l]*o;n[e][l]=(2*Math.pow(a,3)-3*Math.pow(a,2)+1)*t[l]+(Math.pow(a,3)-2*Math.pow(a,2)+a)*c+(-2*Math.pow(a,3)+3*Math.pow(a,2))*s[l]+(Math.pow(a,3)-Math.pow(a,2))*u}}(r,s,{p0:i[3*c+1],outTangent0:i[3*c+2],inTangent1:i[3*l+0],p1:i[3*l+1],tDiff:h-u,ratio:(a-u)/(h-u)});break;default:hn.warn(`Interpolation ${t} not supported`)()}})(i,r,s,o),function(n,e){if(e.matrix.identity(),n.translation&&e.matrix.translate(n.translation),n.rotation){const t=kpe.fromQuaternion(n.rotation);e.matrix.multiplyRight(t)}n.scale&&e.matrix.scale(n.scale)}(s,s._node)})}}class Gpe{constructor(e){this.animations=e.animations.map((t,i)=>{const r=t.name||`Animation-${i}`,s=t.samplers.map(({input:a,interpolation:l="LINEAR",output:c})=>({input:iH(e.accessors[a]),interpolation:l,output:iH(e.accessors[c])})),o=t.channels.map(({sampler:a,target:l})=>({sampler:s[a],target:e.nodes[l.node],path:l.path}));return new Hpe({name:r,channels:o})})}animate(e){this.setTime(e)}setTime(e){this.animations.forEach(t=>t.animate(e))}getAnimations(){return this.animations}}class $pe extends Jg{constructor(e,t={}){super(t),this.onBeforeRender=null,this.AfterRender=null,e instanceof Hg?(this.model=e,this._setModelNodeProps(t)):this.model=new Hg(e,t),this.managedResources=t.managedResources||[]}setProps(e){return super.setProps(e),this._setModelNodeProps(e),this}delete(){this.model&&(this.model.delete(),this.model=null),this.managedResources.forEach(e=>e.delete()),this.managedResources=[]}draw(...e){return this.model.draw(...e)}setUniforms(...e){return this.model.setUniforms(...e),this}setAttributes(...e){return this.model.setAttributes(...e),this}updateModuleSettings(...e){return this.model.updateModuleSettings(...e),this}_setModelNodeProps(e){this.model.setProps(e)}}class Wpe{constructor(e,{attributes:t,material:i,pbrDebug:r,imageBasedLightingEnvironment:s,lights:o,useTangents:a}){this.gl=e,this.defines={MANUAL_SRGB:1,SRGB_FAST_APPROXIMATION:1},aI(e,"GLSL_TEXTURE_LOD")&&(this.defines.USE_TEX_LOD=1),this.uniforms={u_Camera:[0,0,0],u_MetallicRoughnessValues:[1,1]},this.parameters={},this.generatedTextures=[],s&&(this.uniforms.u_DiffuseEnvSampler=s.getDiffuseEnvSampler(),this.uniforms.u_SpecularEnvSampler=s.getSpecularEnvSampler(),this.uniforms.u_brdfLUT=s.getBrdfTexture(),this.uniforms.u_ScaleIBLAmbient=[1,1]),r&&(this.uniforms.u_ScaleDiffBaseMR=[0,0,0,0],this.uniforms.u_ScaleFGDSpec=[0,0,0,0]),this.defineIfPresent(t.NORMAL,"HAS_NORMALS"),this.defineIfPresent(t.TANGENT&&a,"HAS_TANGENTS"),this.defineIfPresent(t.TEXCOORD_0,"HAS_UV"),this.defineIfPresent(s,"USE_IBL"),this.defineIfPresent(o,"USE_LIGHTS"),this.defineIfPresent(r,"PBR_DEBUG"),i&&this.parseMaterial(i)}defineIfPresent(e,t){e&&(this.defines[t]=1)}parseTexture(e,t,i=null){const s=e.texture.source.image;let o,a={};s.compressed?(o=s,a={[this.gl.TEXTURE_MIN_FILTER]:s.data.length>1?this.gl.LINEAR_MIPMAP_NEAREST:this.gl.LINEAR}):o={data:s};const l=new da(this.gl,ot({id:e.name||e.id,parameters:ot(ot({},e.texture&&e.texture.sampler&&e.texture.sampler.parameters||{}),a),pixelStore:{[this.gl.UNPACK_FLIP_Y_WEBGL]:!1}},o));this.uniforms[t]=l,this.defineIfPresent(i,i),this.generatedTextures.push(l)}parsePbrMetallicRoughness(e){e.baseColorTexture&&this.parseTexture(e.baseColorTexture,"u_BaseColorSampler","HAS_BASECOLORMAP"),this.uniforms.u_BaseColorFactor=e.baseColorFactor||[1,1,1,1],e.metallicRoughnessTexture&&this.parseTexture(e.metallicRoughnessTexture,"u_MetallicRoughnessSampler","HAS_METALROUGHNESSMAP");const{metallicFactor:t=1,roughnessFactor:i=1}=e;this.uniforms.u_MetallicRoughnessValues=[t,i]}parseMaterial(e){if(this.uniforms.pbr_uUnlit=Boolean(e.unlit),e.pbrMetallicRoughness&&this.parsePbrMetallicRoughness(e.pbrMetallicRoughness),e.normalTexture){this.parseTexture(e.normalTexture,"u_NormalSampler","HAS_NORMALMAP");const{scale:t=1}=e.normalTexture;this.uniforms.u_NormalScale=t}if(e.occlusionTexture){this.parseTexture(e.occlusionTexture,"u_OcclusionSampler","HAS_OCCLUSIONMAP");const{strength:t=1}=e.occlusionTexture;this.uniforms.u_OcclusionStrength=t}if(e.emissiveTexture&&(this.parseTexture(e.emissiveTexture,"u_EmissiveSampler","HAS_EMISSIVEMAP"),this.uniforms.u_EmissiveFactor=e.emissiveFactor||[0,0,0]),"MASK"===e.alphaMode){const{alphaCutoff:t=.5}=e;this.defines.ALPHA_CUTOFF=1,this.uniforms.u_AlphaCutoff=t}else"BLEND"===e.alphaMode&&(hn.warn("BLEND alphaMode might not work well because it requires mesh sorting")(),Object.assign(this.parameters,{blend:!0,blendEquation:this.gl.FUNC_ADD,blendFunc:[this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA]}))}}function rH(n,e){return _i(n)?`#version 300 es\n${e}`:e}const Xpe={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Qpe={modelOptions:{},pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0,useTangents:!1};class Zpe{constructor(e,t={}){this.gl=e,this.options=Object.assign({},Qpe,t)}instantiate(e){return this.gltf=e,(e.scenes||[]).map(i=>this.createScene(i))}createAnimator(){return Array.isArray(this.gltf.animations)?new Gpe(this.gltf):null}createScene(e){const i=(e.nodes||[]).map(s=>this.createNode(s));return new q0({id:e.name||e.id,children:i})}createNode(e){if(!e._node){const i=(e.children||[]).map(s=>this.createNode(s));e.mesh&&i.push(this.createMesh(e.mesh));const r=new q0({id:e.name||e.id,children:i});if(e.matrix)r.setMatrix(e.matrix);else{if(r.matrix.identity(),e.translation&&r.matrix.translate(e.translation),e.rotation){const s=(new Gn).fromQuaternion(e.rotation);r.matrix.multiplyRight(s)}e.scale&&r.matrix.scale(e.scale)}e._node=r}return e._node}createMesh(e){if(!e._mesh){const i=(e.primitives||[]).map((s,o)=>this.createPrimitive(s,o,e)),r=new q0({id:e.name||e.id,children:i});e._mesh=r}return e._mesh}getVertexCount(e){hn.warn("getVertexCount() not found")()}createPrimitive(e,t,i){return function(n,e){const{id:t,drawMode:i,vertexCount:r,attributes:s,modelOptions:o}=e,a=new Wpe(n,e);hn.info(4,"createGLTFModel defines: ",a.defines)();const l=[];l.push(...a.generatedTextures),l.push(...Object.values(s).map(u=>u.buffer));const c=new $pe(n,Object.assign({id:t,drawMode:i,vertexCount:r,modules:[L4],defines:a.defines,parameters:a.parameters,vs:rH(n,"\n#if (__VERSION__ < 300)\n  #define _attr attribute\n#else\n  #define _attr in\n#endif\n\n  _attr vec4 POSITION;\n\n  #ifdef HAS_NORMALS\n    _attr vec4 NORMAL;\n  #endif\n\n  #ifdef HAS_TANGENTS\n    _attr vec4 TANGENT;\n  #endif\n\n  #ifdef HAS_UV\n    _attr vec2 TEXCOORD_0;\n  #endif\n\n  void main(void) {\n    vec4 _NORMAL = vec4(0.);\n    vec4 _TANGENT = vec4(0.);\n    vec2 _TEXCOORD_0 = vec2(0.);\n\n    #ifdef HAS_NORMALS\n      _NORMAL = NORMAL;\n    #endif\n\n    #ifdef HAS_TANGENTS\n      _TANGENT = TANGENT;\n    #endif\n\n    #ifdef HAS_UV\n      _TEXCOORD_0 = TEXCOORD_0;\n    #endif\n\n    pbr_setPositionNormalTangentUV(POSITION, _NORMAL, _TANGENT, _TEXCOORD_0);\n    gl_Position = u_MVPMatrix * POSITION;\n  }\n"),fs:rH(n,"\n#if (__VERSION__ < 300)\n  #define fragmentColor gl_FragColor\n#else\n  out vec4 fragmentColor;\n#endif\n\n  void main(void) {\n    fragmentColor = pbr_filterColor(vec4(0));\n  }\n"),managedResources:l},o));return c.setProps({attributes:s}),c.setUniforms(a.uniforms),c}(this.gl,Object.assign({id:e.name||`${i.name||i.id}-primitive-${t}`,drawMode:e.mode||4,vertexCount:e.indices?e.indices.count:this.getVertexCount(e.attributes),attributes:this.createAttributes(e.attributes,e.indices),material:e.material},this.options))}createAttributes(e,t){const i={};return Object.keys(e).forEach(r=>{i[r]=this.createAccessor(e[r],this.createBuffer(e[r],this.gl.ARRAY_BUFFER))}),t&&(i.indices=this.createAccessor(t,this.createBuffer(t,this.gl.ELEMENT_ARRAY_BUFFER))),hn.info(4,"glTF Attributes",{attributes:e,indices:t,generated:i})(),i}createBuffer(e,t){e.bufferView||(e.bufferView={});const{bufferView:i}=e;return i.lumaBuffers||(i.lumaBuffers={}),i.lumaBuffers[t]||(i.lumaBuffers[t]=new sr(this.gl,{id:`from-${i.id}`,data:i.data||e.value,target:t})),i.lumaBuffers[t]}createAccessor(e,t){return new ua({buffer:t,offset:e.byteOffset||0,stride:e.bufferView.byteStride||0,type:e.componentType,size:Xpe[e.type]})}createSampler(e){return e}needsPOT(){return!1}}function sH(n,e,t){if(n.byteLength<=e+t)return"";const i=new DataView(n);let r="";for(let s=0;s<t;s++)r+=String.fromCharCode(i.getUint8(e+s));return r}function Ba(n,e){if(!n)throw new Error(e||"assert failed: gltf")}function oH(n,e){if(n.startsWith("data:")||n.startsWith("http:")||n.startsWith("https:"))return n;const i=e.baseUri||e.uri;if(!i)throw new Error(`'baseUri' must be provided to resolve relative url ${n}`);return i.substr(0,i.lastIndexOf("/")+1)+n}function aH(n,e,t){const i=n.bufferViews[t];Ba(i);const s=e[i.buffer];return Ba(s),new Uint8Array(s.arrayBuffer,(i.byteOffset||0)+s.byteOffset,i.byteLength)}const lH={name:"Draco",id:"draco",module:"draco",version:"3.0.12",worker:!0,extensions:["drc"],mimeTypes:["application/octet-stream"],binary:!0,tests:["DRACO"],options:{draco:{decoderType:"object"==typeof WebAssembly?"wasm":"js",libraryPath:"libs/",extraAttributes:{},attributeNameEntry:void 0}}};class em{constructor(e,t){qn(this,"fields",void 0),qn(this,"metadata",void 0),function(n,e){if(!n)throw new Error("loader assertion failed.")}(Array.isArray(e)),function(n){const e={};for(const t of n)e[t.name]&&console.warn("Schema: duplicated field name",t.name,t),e[t.name]=!0}(e),this.fields=e,this.metadata=t||new Map}compareTo(e){if(this.metadata!==e.metadata||this.fields.length!==e.fields.length)return!1;for(let t=0;t<this.fields.length;++t)if(!this.fields[t].compareTo(e.fields[t]))return!1;return!0}select(...e){const t=Object.create(null);for(const r of e)t[r]=!0;const i=this.fields.filter(r=>t[r.name]);return new em(i,this.metadata)}selectAt(...e){const t=e.map(i=>this.fields[i]).filter(Boolean);return new em(t,this.metadata)}assign(e){let t,i=this.metadata;if(e instanceof em){const o=e;t=o.fields,i=cH(cH(new Map,this.metadata),o.metadata)}else t=e;const r=Object.create(null);for(const o of this.fields)r[o.name]=o;for(const o of t)r[o.name]=o;const s=Object.values(r);return new em(s,i)}}function cH(n,e){return new Map([...n||new Map,...e||new Map])}let Rr,uH,dH,hH,fH,pH,gH,mH;!function(n){n[n.NONE=0]="NONE",n[n.Null=1]="Null",n[n.Int=2]="Int",n[n.Float=3]="Float",n[n.Binary=4]="Binary",n[n.Utf8=5]="Utf8",n[n.Bool=6]="Bool",n[n.Decimal=7]="Decimal",n[n.Date=8]="Date",n[n.Time=9]="Time",n[n.Timestamp=10]="Timestamp",n[n.Interval=11]="Interval",n[n.List=12]="List",n[n.Struct=13]="Struct",n[n.Union=14]="Union",n[n.FixedSizeBinary=15]="FixedSizeBinary",n[n.FixedSizeList=16]="FixedSizeList",n[n.Map=17]="Map",n[n.Dictionary=-1]="Dictionary",n[n.Int8=-2]="Int8",n[n.Int16=-3]="Int16",n[n.Int32=-4]="Int32",n[n.Int64=-5]="Int64",n[n.Uint8=-6]="Uint8",n[n.Uint16=-7]="Uint16",n[n.Uint32=-8]="Uint32",n[n.Uint64=-9]="Uint64",n[n.Float16=-10]="Float16",n[n.Float32=-11]="Float32",n[n.Float64=-12]="Float64",n[n.DateDay=-13]="DateDay",n[n.DateMillisecond=-14]="DateMillisecond",n[n.TimestampSecond=-15]="TimestampSecond",n[n.TimestampMillisecond=-16]="TimestampMillisecond",n[n.TimestampMicrosecond=-17]="TimestampMicrosecond",n[n.TimestampNanosecond=-18]="TimestampNanosecond",n[n.TimeSecond=-19]="TimeSecond",n[n.TimeMillisecond=-20]="TimeMillisecond",n[n.TimeMicrosecond=-21]="TimeMicrosecond",n[n.TimeNanosecond=-22]="TimeNanosecond",n[n.DenseUnion=-23]="DenseUnion",n[n.SparseUnion=-24]="SparseUnion",n[n.IntervalDayTime=-25]="IntervalDayTime",n[n.IntervalYearMonth=-26]="IntervalYearMonth"}(Rr||(Rr={}));class aR{static isNull(e){return e&&e.typeId===Rr.Null}static isInt(e){return e&&e.typeId===Rr.Int}static isFloat(e){return e&&e.typeId===Rr.Float}static isBinary(e){return e&&e.typeId===Rr.Binary}static isUtf8(e){return e&&e.typeId===Rr.Utf8}static isBool(e){return e&&e.typeId===Rr.Bool}static isDecimal(e){return e&&e.typeId===Rr.Decimal}static isDate(e){return e&&e.typeId===Rr.Date}static isTime(e){return e&&e.typeId===Rr.Time}static isTimestamp(e){return e&&e.typeId===Rr.Timestamp}static isInterval(e){return e&&e.typeId===Rr.Interval}static isList(e){return e&&e.typeId===Rr.List}static isStruct(e){return e&&e.typeId===Rr.Struct}static isUnion(e){return e&&e.typeId===Rr.Union}static isFixedSizeBinary(e){return e&&e.typeId===Rr.FixedSizeBinary}static isFixedSizeList(e){return e&&e.typeId===Rr.FixedSizeList}static isMap(e){return e&&e.typeId===Rr.Map}static isDictionary(e){return e&&e.typeId===Rr.Dictionary}get typeId(){return Rr.NONE}compareTo(e){return this===e}}Symbol,Symbol,uH=Symbol.toStringTag;class tm extends aR{constructor(e,t){super(),qn(this,"isSigned",void 0),qn(this,"bitWidth",void 0),this.isSigned=e,this.bitWidth=t}get typeId(){return Rr.Int}get[uH](){return"Int"}toString(){return`${this.isSigned?"I":"Ui"}nt${this.bitWidth}`}}class lge extends tm{constructor(){super(!0,8)}}class cge extends tm{constructor(){super(!0,16)}}class uge extends tm{constructor(){super(!0,32)}}class dge extends tm{constructor(){super(!1,8)}}class hge extends tm{constructor(){super(!1,16)}}class fge extends tm{constructor(){super(!1,32)}}dH=Symbol.toStringTag;class _H extends aR{constructor(e){super(),qn(this,"precision",void 0),this.precision=e}get typeId(){return Rr.Float}get[dH](){return"Float"}toString(){return`Float${this.precision}`}}class pge extends _H{constructor(){super(32)}}class gge extends _H{constructor(){super(64)}}Symbol,Symbol,hH=Symbol.toStringTag,fH=Symbol.toStringTag,pH=Symbol.toStringTag,gH=Symbol.toStringTag,mH=Symbol.toStringTag;class mge extends aR{constructor(e,t){super(),qn(this,"listSize",void 0),qn(this,"children",void 0),this.listSize=e,this.children=[t]}get typeId(){return Rr.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get[mH](){return"FixedSizeList"}toString(){return`FixedSizeList[${this.listSize}]<${this.valueType}>`}}class QS{constructor(e,t,i=!1,r=new Map){qn(this,"name",void 0),qn(this,"type",void 0),qn(this,"nullable",void 0),qn(this,"metadata",void 0),this.name=e,this.type=t,this.nullable=i,this.metadata=r}get typeId(){return this.type&&this.type.typeId}clone(){return new QS(this.name,this.type,this.nullable,this.metadata)}compareTo(e){return this.name===e.name&&this.type===e.type&&this.nullable===e.nullable&&this.metadata===e.metadata}toString(){return`${this.type}${this.nullable?", nullable":""}${this.metadata?`, metadata: ${this.metadata}`:""}`}}function yH(n,e,t){const i=t?vH(t.metadata):void 0,r=function(n){switch(n.constructor){case Int8Array:return new lge;case Uint8Array:return new dge;case Int16Array:return new cge;case Uint16Array:return new hge;case Int32Array:return new uge;case Uint32Array:return new fge;case Float32Array:return new pge;case Float64Array:return new gge;default:throw new Error("array type not supported")}}(e.value);return new QS(n,new mge(e.size,new QS("value",r)),!1,i)}function vH(n){const e=new Map;for(const t in n)e.set(`${t}.string`,JSON.stringify(n[t]));return e}const bH={POSITION:"POSITION",NORMAL:"NORMAL",COLOR:"COLOR_0",TEX_COORD:"TEXCOORD_0"},bge={1:Int8Array,2:Uint8Array,3:Int16Array,4:Uint16Array,5:Int32Array,6:Uint32Array,9:Float32Array};class Ege{constructor(e){qn(this,"draco",void 0),qn(this,"decoder",void 0),qn(this,"metadataQuerier",void 0),this.draco=e,this.decoder=new this.draco.Decoder,this.metadataQuerier=new this.draco.MetadataQuerier}destroy(){this.draco.destroy(this.decoder),this.draco.destroy(this.metadataQuerier)}parseSync(e,t={}){const i=new this.draco.DecoderBuffer;i.Init(new Int8Array(e),e.byteLength),this._disableAttributeTransforms(t);const r=this.decoder.GetEncodedGeometryType(i),s=r===this.draco.TRIANGULAR_MESH?new this.draco.Mesh:new this.draco.PointCloud;try{let o;switch(r){case this.draco.TRIANGULAR_MESH:o=this.decoder.DecodeBufferToMesh(i,s);break;case this.draco.POINT_CLOUD:o=this.decoder.DecodeBufferToPointCloud(i,s);break;default:throw new Error("DRACO: Unknown geometry type.")}if(!o.ok()||!s.ptr){const f=`DRACO decompression failed: ${o.error_msg()}`;throw new Error(f)}const a=this._getDracoLoaderData(s,r,t),l=this._getMeshData(s,a,t),c=function(n){let e=1/0,t=1/0,i=1/0,r=-1/0,s=-1/0,o=-1/0;const a=n.POSITION?n.POSITION.value:[],l=a&&a.length;for(let c=0;c<l;c+=3){const u=a[c],h=a[c+1],f=a[c+2];e=u<e?u:e,t=h<t?h:t,i=f<i?f:i,r=u>r?u:r,s=h>s?h:s,o=f>o?f:o}return[[e,t,i],[r,s,o]]}(l.attributes),u=function(n,e,t){const i=vH(e.metadata),r=[],s=function(n){const e={};for(const t in n){const i=n[t];e[i.name||"undefined"]=i}return e}(e.attributes);for(const o in n){const l=yH(o,n[o],s[o]);r.push(l)}if(t){const o=yH("indices",t);r.push(o)}return new em(r,i)}(l.attributes,a,l.indices);return wn(ot({loader:"draco",loaderData:a,header:{vertexCount:s.num_points(),boundingBox:c}},l),{schema:u})}finally{this.draco.destroy(i),s&&this.draco.destroy(s)}}_getDracoLoaderData(e,t,i){const r=this._getTopLevelMetadata(e),s=this._getDracoAttributes(e,i);return{geometry_type:t,num_attributes:e.num_attributes(),num_points:e.num_points(),num_faces:e instanceof this.draco.Mesh?e.num_faces():0,metadata:r,attributes:s}}_getDracoAttributes(e,t){const i={};for(let r=0;r<e.num_attributes();r++){const s=this.decoder.GetAttribute(e,r),o=this._getAttributeMetadata(e,r);i[s.unique_id()]={unique_id:s.unique_id(),attribute_type:s.attribute_type(),data_type:s.data_type(),num_components:s.num_components(),byte_offset:s.byte_offset(),byte_stride:s.byte_stride(),normalized:s.normalized(),attribute_index:r,metadata:o};const a=this._getQuantizationTransform(s,t);a&&(i[s.unique_id()].quantization_transform=a);const l=this._getOctahedronTransform(s,t);l&&(i[s.unique_id()].octahedron_transform=l)}return i}_getMeshData(e,t,i){const r=this._getMeshAttributes(t,e,i);if(!r.POSITION)throw new Error("DRACO: No position attribute found.");if(e instanceof this.draco.Mesh)switch(i.topology){case"triangle-strip":return{topology:"triangle-strip",mode:4,attributes:r,indices:{value:this._getTriangleStripIndices(e),size:1}};case"triangle-list":default:return{topology:"triangle-list",mode:5,attributes:r,indices:{value:this._getTriangleListIndices(e),size:1}}}return{topology:"point-list",mode:0,attributes:r}}_getMeshAttributes(e,t,i){const r={};for(const s of Object.values(e.attributes)){const o=this._deduceAttributeName(s,i);s.name=o;const{value:a,size:l}=this._getAttributeValues(t,s);r[o]={value:a,size:l,byteOffset:s.byte_offset,byteStride:s.byte_stride,normalized:s.normalized}}return r}_getTriangleListIndices(e){const i=3*e.num_faces(),r=4*i,s=this.draco._malloc(r);try{return this.decoder.GetTrianglesUInt32Array(e,r,s),new Uint32Array(this.draco.HEAPF32.buffer,s,i).slice()}finally{this.draco._free(s)}}_getTriangleStripIndices(e){const t=new this.draco.DracoInt32Array;try{return this.decoder.GetTriangleStripsFromMesh(e,t),function(n){const e=n.size(),t=new Int32Array(e);for(let i=0;i<e;i++)t[i]=n.GetValue(i);return t}(t)}finally{this.draco.destroy(t)}}_getAttributeValues(e,t){const i=bge[t.data_type],r=t.num_components,o=e.num_points()*r,a=o*i.BYTES_PER_ELEMENT,l=function(n,e){switch(e){case Float32Array:return n.DT_FLOAT32;case Int8Array:return n.DT_INT8;case Int16Array:return n.DT_INT16;case Int32Array:return n.DT_INT32;case Uint8Array:return n.DT_UINT8;case Uint16Array:return n.DT_UINT16;case Uint32Array:return n.DT_UINT32;default:return n.DT_INVALID}}(this.draco,i);let c;const u=this.draco._malloc(a);try{const h=this.decoder.GetAttribute(e,t.attribute_index);this.decoder.GetAttributeDataArrayForAllPoints(e,h,l,a,u),c=new i(this.draco.HEAPF32.buffer,u,o).slice()}finally{this.draco._free(u)}return{value:c,size:r}}_deduceAttributeName(e,t){const i=e.unique_id;for(const[o,a]of Object.entries(t.extraAttributes||{}))if(a===i)return o;const r=e.attribute_type;for(const o in bH)if(this.draco[o]===r)return bH[o];const s=t.attributeNameEntry||"name";return e.metadata[s]?e.metadata[s].string:`CUSTOM_ATTRIBUTE_${i}`}_getTopLevelMetadata(e){const t=this.decoder.GetMetadata(e);return this._getDracoMetadata(t)}_getAttributeMetadata(e,t){const i=this.decoder.GetAttributeMetadata(e,t);return this._getDracoMetadata(i)}_getDracoMetadata(e){if(!e||!e.ptr)return{};const t={},i=this.metadataQuerier.NumEntries(e);for(let r=0;r<i;r++){const s=this.metadataQuerier.GetEntryName(e,r);t[s]=this._getDracoMetadataField(e,s)}return t}_getDracoMetadataField(e,t){const i=new this.draco.DracoInt32Array;try{this.metadataQuerier.GetIntEntryArray(e,t,i);const r=function(n){const e=n.size(),t=new Int32Array(e);for(let i=0;i<e;i++)t[i]=n.GetValue(i);return t}(i);return{int:this.metadataQuerier.GetIntEntry(e,t),string:this.metadataQuerier.GetStringEntry(e,t),double:this.metadataQuerier.GetDoubleEntry(e,t),intArray:r}}finally{this.draco.destroy(i)}}_disableAttributeTransforms(e){const{quantizedAttributes:t=[],octahedronAttributes:i=[]}=e,r=[...t,...i];for(const s of r)this.decoder.SkipAttributeTransform(this.draco[s])}_getQuantizationTransform(e,t){const{quantizedAttributes:i=[]}=t,r=e.attribute_type();if(i.map(o=>this.decoder[o]).includes(r)){const o=new this.draco.AttributeQuantizationTransform;try{if(o.InitFromAttribute(e))return{quantization_bits:o.quantization_bits(),range:o.range(),min_values:new Float32Array([1,2,3]).map(a=>o.min_value(a))}}finally{this.draco.destroy(o)}}return null}_getOctahedronTransform(e,t){const{octahedronAttributes:i=[]}=t,r=e.attribute_type();if(i.map(o=>this.decoder[o]).includes(r)){const o=new this.draco.AttributeQuantizationTransform;try{if(o.InitFromAttribute(e))return{quantization_bits:o.quantization_bits()}}finally{this.draco.destroy(o)}}return null}}var ZS=et(9125);const dR={};function hR(n){return fR.apply(this,arguments)}function fR(){return(fR=ni(function*(n,e=null,t={}){return e&&(n=Age(n,e,t)),dR[n]=dR[n]||Mge(n),yield dR[n]})).apply(this,arguments)}function Age(n,e,t){if(n.startsWith("http"))return n;const i=t.modules||{};return i[n]?i[n]:oO?t.CDN?(Xc(t.CDN.startsWith("http")),`${t.CDN}/${e}@3.0.12/dist/libs/${n}`):aO?`../src/libs/${n}`:`modules/${e}/src/libs/${n}`:`modules/${e}/dist/libs/${n}`}function Mge(n){return pR.apply(this,arguments)}function pR(){return(pR=ni(function*(n){return n.endsWith("wasm")?yield(yield fetch(n)).arrayBuffer():oO?aO?importScripts(n):Dge(yield(yield fetch(n)).text(),n):ZS.requireFromFile&&(yield ZS.requireFromFile(n))})).apply(this,arguments)}function Dge(n,e){if(!oO)return ZS.requireFromString&&ZS.requireFromString(n,e);if(aO)return eval.call(Wce,n),null;const t=document.createElement("script");t.id=e;try{t.appendChild(document.createTextNode(n))}catch(i){t.text=n}return document.body.appendChild(t),null}const Ige="https://www.gstatic.com/draco/versioned/decoders/1.4.1/draco_decoder.js",Oge="https://www.gstatic.com/draco/versioned/decoders/1.4.1/draco_wasm_wrapper.js",Rge="https://www.gstatic.com/draco/versioned/decoders/1.4.1/draco_decoder.wasm";let K0;function Pge(n){return gR.apply(this,arguments)}function gR(){return(gR=ni(function*(n){const e=n.modules||{};return K0=e.draco3d?K0||e.draco3d.createDecoderModule({}).then(t=>({draco:t})):K0||Fge(n),yield K0})).apply(this,arguments)}function Fge(n){return _R.apply(this,arguments)}function _R(){return(_R=ni(function*(n){let e,t;switch(n.draco&&n.draco.decoderType){case"js":e=yield hR(Ige,"draco",n);break;case"wasm":default:[e,t]=yield Promise.all([yield hR(Oge,"draco",n),yield hR(Rge,"draco",n)])}return e=e||globalThis.DracoDecoderModule,yield Lge(e,t)})).apply(this,arguments)}function Lge(n,e){const t={};return e&&(t.wasmBinary=e),new Promise(i=>{n(wn(ot({},t),{onModuleLoaded:r=>i({draco:r})}))})}const vR=wn(ot({},lH),{parse:function(n,e){return bR.apply(this,arguments)}});function bR(){return(bR=ni(function*(n,e){const{draco:t}=yield Pge(e),i=new Ege(t);try{return i.parseSync(n,null==e?void 0:e.draco)}finally{i.destroy()}})).apply(this,arguments)}function Q0(n,e){return Of(n>=0),Of(e>0),n+(e-1)&~(e-1)}function Vge(n,e,t){let i;return i=n instanceof ArrayBuffer?new Uint8Array(n):new Uint8Array(n.buffer||n.arrayBuffer,n.byteOffset,n.byteLength),e.set(i,t),t+Q0(i.byteLength,4)}const wH=["SCALAR","VEC2","VEC3","VEC4"],jge=[[Int8Array,5120],[Uint8Array,5121],[Int16Array,5122],[Uint16Array,5123],[Uint32Array,5125],[Float32Array,5126],[Float64Array,5130]],Uge=new Map(jge),zge={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Hge={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},Gge={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function EH(n){return wH[n-1]||wH[0]}function SH(n){const e=Uge.get(n.constructor);if(!e)throw new Error("Illegal typed array");return e}function xH(n,e){const t=Gge[n.componentType],i=zge[n.type],s=n.count*i,o=n.count*i*Hge[n.componentType];return Ba(o>=0&&o<=e.byteLength),{ArrayType:t,length:s,byteLength:o}}const $ge={asset:{version:"2.0",generator:"loaders.gl"},buffers:[]};class hh{constructor(e){qn(this,"gltf",void 0),qn(this,"sourceBuffers",void 0),qn(this,"byteLength",void 0),this.gltf=e||{json:ot({},$ge),buffers:[]},this.sourceBuffers=[],this.byteLength=0,this.gltf.buffers&&this.gltf.buffers[0]&&(this.byteLength=this.gltf.buffers[0].byteLength,this.sourceBuffers=[this.gltf.buffers[0]])}get json(){return this.gltf.json}getApplicationData(e){return this.json[e]}getExtraData(e){return(this.json.extras||{})[e]}getExtension(e){return this.getUsedExtensions().find(r=>r===e)?(this.json.extensions||{})[e]||!0:null}getRequiredExtension(e){return this.getRequiredExtensions().find(i=>i===e)?this.getExtension(e):null}getRequiredExtensions(){return this.json.extensionsRequired||[]}getUsedExtensions(){return this.json.extensionsUsed||[]}getObjectExtension(e,t){return(e.extensions||{})[t]}getScene(e){return this.getObject("scenes",e)}getNode(e){return this.getObject("nodes",e)}getSkin(e){return this.getObject("skins",e)}getMesh(e){return this.getObject("meshes",e)}getMaterial(e){return this.getObject("materials",e)}getAccessor(e){return this.getObject("accessors",e)}getTexture(e){return this.getObject("textures",e)}getSampler(e){return this.getObject("samplers",e)}getImage(e){return this.getObject("images",e)}getBufferView(e){return this.getObject("bufferViews",e)}getBuffer(e){return this.getObject("buffers",e)}getObject(e,t){if("object"==typeof t)return t;const i=this.json[e]&&this.json[e][t];if(!i)throw new Error(`glTF file error: Could not find ${e}[${t}]`);return i}getTypedArrayForBufferView(e){e=this.getBufferView(e);const i=this.gltf.buffers[e.buffer];return Ba(i),new Uint8Array(i.arrayBuffer,(e.byteOffset||0)+i.byteOffset,e.byteLength)}getTypedArrayForAccessor(e){e=this.getAccessor(e);const t=this.getBufferView(e.bufferView),r=this.getBuffer(t.buffer).data,{ArrayType:s,length:o}=xH(e,t);return new s(r,t.byteOffset+e.byteOffset,o)}getTypedArrayForImageData(e){e=this.getAccessor(e);const t=this.getBufferView(e.bufferView),r=this.getBuffer(t.buffer).data;return new Uint8Array(r,t.byteOffset||0,t.byteLength)}addApplicationData(e,t){return this.json[e]=t,this}addExtraData(e,t){return this.json.extras=this.json.extras||{},this.json.extras[e]=t,this}addObjectExtension(e,t,i){return e.extensions=e.extensions||{},e.extensions[t]=i,this.registerUsedExtension(t),this}setObjectExtension(e,t,i){(e.extensions||{})[t]=i}removeObjectExtension(e,t){const i=e.extensions||{},r=i[t];return delete i[t],r}addExtension(e,t={}){return Ba(t),this.json.extensions=this.json.extensions||{},this.json.extensions[e]=t,this.registerUsedExtension(e),t}addRequiredExtension(e,t={}){return Ba(t),this.addExtension(e,t),this.registerRequiredExtension(e),t}registerUsedExtension(e){this.json.extensionsUsed=this.json.extensionsUsed||[],this.json.extensionsUsed.find(t=>t===e)||this.json.extensionsUsed.push(e)}registerRequiredExtension(e){this.registerUsedExtension(e),this.json.extensionsRequired=this.json.extensionsRequired||[],this.json.extensionsRequired.find(t=>t===e)||this.json.extensionsRequired.push(e)}removeExtension(e){this.json.extensionsRequired&&this._removeStringFromArray(this.json.extensionsRequired,e),this.json.extensionsUsed&&this._removeStringFromArray(this.json.extensionsUsed,e),this.json.extensions&&delete this.json.extensions[e]}setDefaultScene(e){this.json.scene=e}addScene(e){const{nodeIndices:t}=e;return this.json.scenes=this.json.scenes||[],this.json.scenes.push({nodes:t}),this.json.scenes.length-1}addNode(e){const{meshIndex:t,matrix:i}=e;this.json.nodes=this.json.nodes||[];const r={mesh:t};return i&&(r.matrix=i),this.json.nodes.push(r),this.json.nodes.length-1}addMesh(e){const{attributes:t,indices:i,material:r,mode:s=4}=e,a={primitives:[{attributes:this._addAttributes(t),mode:s}]};if(i){const l=this._addIndices(i);a.primitives[0].indices=l}return Number.isFinite(r)&&(a.primitives[0].material=r),this.json.meshes=this.json.meshes||[],this.json.meshes.push(a),this.json.meshes.length-1}addPointCloud(e){const i={primitives:[{attributes:this._addAttributes(e),mode:0}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(i),this.json.meshes.length-1}addImage(e,t){const i=HO(e),r=t||(null==i?void 0:i.mimeType),o={bufferView:this.addBufferView(e),mimeType:r};return this.json.images=this.json.images||[],this.json.images.push(o),this.json.images.length-1}addBufferView(e){const t=e.byteLength;Ba(Number.isFinite(t)),this.sourceBuffers=this.sourceBuffers||[],this.sourceBuffers.push(e);const i={buffer:0,byteOffset:this.byteLength,byteLength:t};return this.byteLength+=Q0(t,4),this.json.bufferViews=this.json.bufferViews||[],this.json.bufferViews.push(i),this.json.bufferViews.length-1}addAccessor(e,t){const i={bufferView:e,type:EH(t.size),componentType:t.componentType,count:t.count,max:t.max,min:t.min};return this.json.accessors=this.json.accessors||[],this.json.accessors.push(i),this.json.accessors.length-1}addBinaryBuffer(e,t={size:3}){const i=this.addBufferView(e);let r={min:t.min,max:t.max};(!r.min||!r.max)&&(r=this._getAccessorMinMax(e,t.size));const s={size:t.size,componentType:SH(e),count:Math.round(e.length/t.size),min:r.min,max:r.max};return this.addAccessor(i,Object.assign(s,t))}addTexture(e){const{imageIndex:t}=e,i={source:t};return this.json.textures=this.json.textures||[],this.json.textures.push(i),this.json.textures.length-1}addMaterial(e){return this.json.materials=this.json.materials||[],this.json.materials.push(e),this.json.materials.length-1}createBinaryChunk(){var e,t;this.gltf.buffers=[];const i=this.byteLength,r=new ArrayBuffer(i),s=new Uint8Array(r);let o=0;for(const a of this.sourceBuffers||[])o=Vge(a,s,o);null!==(e=this.json)&&void 0!==e&&null!==(t=e.buffers)&&void 0!==t&&t[0]?this.json.buffers[0].byteLength=i:this.json.buffers=[{byteLength:i}],this.gltf.binary=r,this.sourceBuffers=[r]}_removeStringFromArray(e,t){let i=!0;for(;i;){const r=e.indexOf(t);r>-1?e.splice(r,1):i=!1}}_addAttributes(e={}){const t={};for(const i in e){const r=e[i],s=this._getGltfAttributeName(i),o=this.addBinaryBuffer(r.value,r);t[s]=o}return t}_addIndices(e){return this.addBinaryBuffer(e,{size:1})}_getGltfAttributeName(e){switch(e.toLowerCase()){case"position":case"positions":case"vertices":return"POSITION";case"normal":case"normals":return"NORMAL";case"color":case"colors":return"COLOR_0";case"texcoord":case"texcoords":return"TEXCOORD_0";default:return e}}_getAccessorMinMax(e,t){const i={min:null,max:null};if(e.length<t)return i;i.min=[],i.max=[];const r=e.subarray(0,t);for(const s of r)i.min.push(s),i.max.push(s);for(let s=t;s<e.length;s+=t)for(let o=0;o<t;o++)i.min[0+o]=Math.min(i.min[0+o],e[s+o]),i.max[0+o]=Math.max(i.max[0+o],e[s+o]);return i}}const CH="KHR_binary_glTF",Z0="KHR_draco_mesh_compression",nm="KHR_lights_punctual",ex="KHR_materials_unlit",tx="KHR_techniques_webgl";function Yge(n){const e={};for(const t in n){const i=n[t];if("indices"!==t){const r=TH(i);e[t]=r}}return e}function TH(n){const{buffer:e,size:t,count:i}=function(n){let e=n,t=1,i=0;return n&&n.value&&(e=n.value,t=n.size||1),e&&(ArrayBuffer.isView(e)||(e=function(n,e,t=!1){return n?Array.isArray(n)?new e(n):!t||n instanceof e?n:new e(n):null}(e,Float32Array)),i=e.length/t),{buffer:e,size:t,count:i}}(n);return{value:e,size:t,byteOffset:0,count:i,type:EH(t),componentType:SH(e)}}function Qge(n,e,t){return wR.apply(this,arguments)}function wR(){return(wR=ni(function*(n,e,t){var i;if(null==e||null===(i=e.gltf)||void 0===i||!i.decompressMeshes)return;const r=new hh(n),s=[];for(const o of nme(r))r.getObjectExtension(o,Z0)&&s.push(Jge(r,o,e,t));yield Promise.all(s),r.removeExtension(Z0)})).apply(this,arguments)}function Zge(n,e={}){const t=new hh(n);for(const i of t.json.meshes||[])eme(i),t.addRequiredExtension(Z0)}function Jge(n,e,t,i){return ER.apply(this,arguments)}function ER(){return(ER=ni(function*(n,e,t,i){const r=n.getObjectExtension(e,Z0);if(!r)return;const s=n.getTypedArrayForBufferView(r.bufferView),o=oz(s.buffer,s.byteOffset),{parse:a}=i,l=ot({},t);delete l["3d-tiles"];const c=yield a(o,vR,l,i),u=Yge(c.attributes);for(const[h,f]of Object.entries(u))if(h in e.attributes){const m=n.getAccessor(e.attributes[h]);null!=m&&m.min&&null!=m&&m.max&&(f.min=m.min,f.max=m.max)}e.attributes=u,c.indices&&(e.indices=TH(c.indices)),tme(e)})).apply(this,arguments)}function eme(n,e,t=4,i,r){var s;if(!i.DracoWriter)throw new Error("options.gltf.DracoWriter not provided");const o=i.DracoWriter.encodeSync({attributes:n}),a=null==r||null===(s=r.parseSync)||void 0===s?void 0:s.call(r,{attributes:n}),l=i._addFauxAttributes(a.attributes),c=i.addBufferView(o);return{primitives:[{attributes:l,mode:t,extensions:{[Z0]:{bufferView:c,attributes:l}}}]}}function tme(n){if(!n.attributes&&Object.keys(n.attributes).length>0)throw new Error("glTF: Empty primitive detected: Draco decompression failure?")}function*nme(n){for(const e of n.json.meshes||[])for(const t of e.primitives)yield t}function ime(n){return SR.apply(this,arguments)}function SR(){return(SR=ni(function*(n){const e=new hh(n),{json:t}=e;e.removeExtension(ex);for(const i of t.materials||[])i.extensions&&i.extensions.KHR_materials_unlit&&(i.unlit=!0),e.removeObjectExtension(i,ex)})).apply(this,arguments)}function rme(n){const e=new hh(n),{json:t}=e;if(e.materials)for(const i of t.materials||[])i.unlit&&(delete i.unlit,e.addObjectExtension(i,ex,{}),e.addExtension(ex))}function sme(n){return xR.apply(this,arguments)}function xR(){return(xR=ni(function*(n){const e=new hh(n),{json:t}=e,i=e.getExtension(nm);i&&(e.json.lights=i.lights,e.removeExtension(nm));for(const r of t.nodes||[]){const s=e.getObjectExtension(r,nm);s&&(r.light=s.light),e.removeObjectExtension(r,nm)}})).apply(this,arguments)}function ome(n){return CR.apply(this,arguments)}function CR(){return(CR=ni(function*(n){const e=new hh(n),{json:t}=e;if(t.lights){const i=e.addExtension(nm);Ba(!i.lights),i.lights=t.lights,delete t.lights}if(e.json.lights){for(const i of e.json.lights)e.addObjectExtension(i.node,nm,i);delete e.json.lights}})).apply(this,arguments)}function ame(n){return TR.apply(this,arguments)}function TR(){return(TR=ni(function*(n){const e=new hh(n),{json:t}=e,i=e.getExtension(tx);if(i){const r=cme(i,e);for(const s of t.materials||[]){const o=e.getObjectExtension(s,tx);o&&(s.technique=Object.assign({},o,r[o.technique]),s.technique.values=ume(s.technique,e)),e.removeObjectExtension(s,tx)}e.removeExtension(tx)}})).apply(this,arguments)}function lme(n,e){return AR.apply(this,arguments)}function AR(){return(AR=ni(function*(n,e){})).apply(this,arguments)}function cme(n,e){const{programs:t=[],shaders:i=[],techniques:r=[]}=n,s=new TextDecoder;return i.forEach(o=>{if(!Number.isFinite(o.bufferView))throw new Error("KHR_techniques_webgl: no shader code");o.code=s.decode(e.getTypedArrayForBufferView(o.bufferView))}),t.forEach(o=>{o.fragmentShader=i[o.fragmentShader],o.vertexShader=i[o.vertexShader]}),r.forEach(o=>{o.program=t[o.program]}),r}function ume(n,e){const t=Object.assign({},n.values);return Object.keys(n.uniforms||{}).forEach(i=>{n.uniforms[i].value&&!(i in t)&&(t[i]=n.uniforms[i].value)}),Object.keys(t).forEach(i=>{"object"==typeof t[i]&&void 0!==t[i].index&&(t[i].texture=e.getTexture(t[i].index))}),t}const AH={KHR_draco_mesh_compression:yt,KHR_materials_unlit:ee,KHR_lights_punctual:At,KHR_techniques_webgl:dt};function dme(n){return MR.apply(this,arguments)}function MR(){return(MR=ni(function*(n,e={},t){for(const r in AH){var i;const s=(null==e||null===(i=e.gltf)||void 0===i?void 0:i.excludeExtensions)||{};r in s&&!s[r]||(yield AH[r].decode(n,e,t))}})).apply(this,arguments)}const MH={accessors:"accessor",animations:"animation",buffers:"buffer",bufferViews:"bufferView",images:"image",materials:"material",meshes:"mesh",nodes:"node",samplers:"sampler",scenes:"scene",skins:"skin",textures:"texture"},fme={accessor:"accessors",animations:"animation",buffer:"buffers",bufferView:"bufferViews",image:"images",material:"materials",mesh:"meshes",node:"nodes",sampler:"samplers",scene:"scenes",skin:"skins",texture:"textures"};class pme{constructor(e){this.idToIndexMap={animations:{},accessors:{},buffers:{},bufferViews:{},images:{},materials:{},meshes:{},nodes:{},samplers:{},scenes:{},skins:{},textures:{}}}normalize(e,t){this.json=e.json;const i=e.json;switch(i.asset&&i.asset.version){case"2.0":return;case void 0:case"1.0":break;default:return void console.warn(`glTF: Unknown version ${i.asset.version}`)}if(!t.normalize)throw new Error("glTF v1 is not supported.");console.warn("Converting glTF v1 to glTF v2 format. This is experimental and may fail."),this._addAsset(i),this._convertTopLevelObjectsToArrays(i),function(n){const e=new hh(n),{json:t}=e;for(const i of t.images||[]){const r=e.removeObjectExtension(i,CH);r&&Object.assign(i,r)}t.buffers&&t.buffers[0]&&delete t.buffers[0].uri,e.removeExtension(CH)}(e),this._convertObjectIdsToArrayIndices(i),this._updateObjects(i),this._updateMaterial(i)}_addAsset(e){e.asset=e.asset||{},e.asset.version="2.0",e.asset.generator=e.asset.generator||"Normalized to glTF 2.0 by loaders.gl"}_convertTopLevelObjectsToArrays(e){for(const t in MH)this._convertTopLevelObjectToArray(e,t)}_convertTopLevelObjectToArray(e,t){const i=e[t];if(i&&!Array.isArray(i)){e[t]=[];for(const r in i){const s=i[r];s.id=s.id||r;const o=e[t].length;e[t].push(s),this.idToIndexMap[t][r]=o}}}_convertObjectIdsToArrayIndices(e){for(const t in MH)this._convertIdsToIndices(e,t);"scene"in e&&(e.scene=this._convertIdToIndex(e.scene,"scene"));for(const t of e.textures)this._convertTextureIds(t);for(const t of e.meshes)this._convertMeshIds(t);for(const t of e.nodes)this._convertNodeIds(t);for(const t of e.scenes)this._convertSceneIds(t)}_convertTextureIds(e){e.source&&(e.source=this._convertIdToIndex(e.source,"image"))}_convertMeshIds(e){for(const t of e.primitives){const{attributes:i,indices:r,material:s}=t;for(const o in i)i[o]=this._convertIdToIndex(i[o],"accessor");r&&(t.indices=this._convertIdToIndex(r,"accessor")),s&&(t.material=this._convertIdToIndex(s,"material"))}}_convertNodeIds(e){e.children&&(e.children=e.children.map(t=>this._convertIdToIndex(t,"node"))),e.meshes&&(e.meshes=e.meshes.map(t=>this._convertIdToIndex(t,"mesh")))}_convertSceneIds(e){e.nodes&&(e.nodes=e.nodes.map(t=>this._convertIdToIndex(t,"node")))}_convertIdsToIndices(e,t){e[t]||(console.warn(`gltf v1: json doesn't contain attribute ${t}`),e[t]=[]);for(const i of e[t])for(const r in i){const o=this._convertIdToIndex(i[r],r);i[r]=o}}_convertIdToIndex(e,t){const i=fme[t];if(i in this.idToIndexMap){const r=this.idToIndexMap[i][e];if(!Number.isFinite(r))throw new Error(`gltf v1: failed to resolve ${t} with id ${e}`);return r}return e}_updateObjects(e){for(const t of this.json.buffers)delete t.type}_updateMaterial(e){for(const t of e.materials){t.pbrMetallicRoughness={baseColorFactor:[1,1,1,1],metallicFactor:1,roughnessFactor:1};const i=t.values&&t.values.tex,r=e.textures.findIndex(s=>s.id===i);-1!==r&&(t.pbrMetallicRoughness.baseColorTexture={index:r})}}}function gme(n,e={}){return(new pme).normalize(n,e)}const mme={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},_me={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},El={TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,REPEAT:10497,LINEAR:9729,NEAREST_MIPMAP_LINEAR:9986},yme={magFilter:El.TEXTURE_MAG_FILTER,minFilter:El.TEXTURE_MIN_FILTER,wrapS:El.TEXTURE_WRAP_S,wrapT:El.TEXTURE_WRAP_T},vme={[El.TEXTURE_MAG_FILTER]:El.LINEAR,[El.TEXTURE_MIN_FILTER]:El.NEAREST_MIPMAP_LINEAR,[El.TEXTURE_WRAP_S]:El.REPEAT,[El.TEXTURE_WRAP_]:El.REPEAT};class Eme{postProcess(e,t={}){const{json:i,buffers:r=[],images:s=[],baseUri:o=""}=e;return Ba(i),this.baseUri=o,this.json=i,this.buffers=r,this.images=s,this._resolveTree(this.json,t),this.json}_resolveTree(e,t={}){e.bufferViews&&(e.bufferViews=e.bufferViews.map((i,r)=>this._resolveBufferView(i,r))),e.images&&(e.images=e.images.map((i,r)=>this._resolveImage(i,r))),e.samplers&&(e.samplers=e.samplers.map((i,r)=>this._resolveSampler(i,r))),e.textures&&(e.textures=e.textures.map((i,r)=>this._resolveTexture(i,r))),e.accessors&&(e.accessors=e.accessors.map((i,r)=>this._resolveAccessor(i,r))),e.materials&&(e.materials=e.materials.map((i,r)=>this._resolveMaterial(i,r))),e.meshes&&(e.meshes=e.meshes.map((i,r)=>this._resolveMesh(i,r))),e.nodes&&(e.nodes=e.nodes.map((i,r)=>this._resolveNode(i,r))),e.skins&&(e.skins=e.skins.map((i,r)=>this._resolveSkin(i,r))),e.scenes&&(e.scenes=e.scenes.map((i,r)=>this._resolveScene(i,r))),void 0!==e.scene&&(e.scene=e.scenes[this.json.scene])}getScene(e){return this._get("scenes",e)}getNode(e){return this._get("nodes",e)}getSkin(e){return this._get("skins",e)}getMesh(e){return this._get("meshes",e)}getMaterial(e){return this._get("materials",e)}getAccessor(e){return this._get("accessors",e)}getCamera(e){return null}getTexture(e){return this._get("textures",e)}getSampler(e){return this._get("samplers",e)}getImage(e){return this._get("images",e)}getBufferView(e){return this._get("bufferViews",e)}getBuffer(e){return this._get("buffers",e)}_get(e,t){if("object"==typeof t)return t;const i=this.json[e]&&this.json[e][t];return i||console.warn(`glTF file error: Could not find ${e}[${t}]`),i}_resolveScene(e,t){return e.id=e.id||`scene-${t}`,e.nodes=(e.nodes||[]).map(i=>this.getNode(i)),e}_resolveNode(e,t){return e.id=e.id||`node-${t}`,e.children&&(e.children=e.children.map(i=>this.getNode(i))),void 0!==e.mesh?e.mesh=this.getMesh(e.mesh):void 0!==e.meshes&&e.meshes.length&&(e.mesh=e.meshes.reduce((i,r)=>{const s=this.getMesh(r);return i.id=s.id,i.primitives=i.primitives.concat(s.primitives),i},{primitives:[]})),void 0!==e.camera&&(e.camera=this.getCamera(e.camera)),void 0!==e.skin&&(e.skin=this.getSkin(e.skin)),e}_resolveSkin(e,t){return e.id=e.id||`skin-${t}`,e.inverseBindMatrices=this.getAccessor(e.inverseBindMatrices),e}_resolveMesh(e,t){return e.id=e.id||`mesh-${t}`,e.primitives&&(e.primitives=e.primitives.map(i=>{const r=(i=ot({},i)).attributes;i.attributes={};for(const s in r)i.attributes[s]=this.getAccessor(r[s]);return void 0!==i.indices&&(i.indices=this.getAccessor(i.indices)),void 0!==i.material&&(i.material=this.getMaterial(i.material)),i})),e}_resolveMaterial(e,t){if(e.id=e.id||`material-${t}`,e.normalTexture&&(e.normalTexture=ot({},e.normalTexture),e.normalTexture.texture=this.getTexture(e.normalTexture.index)),e.occlusionTexture&&(e.occlustionTexture=ot({},e.occlustionTexture),e.occlusionTexture.texture=this.getTexture(e.occlusionTexture.index)),e.emissiveTexture&&(e.emmisiveTexture=ot({},e.emmisiveTexture),e.emissiveTexture.texture=this.getTexture(e.emissiveTexture.index)),e.emissiveFactor||(e.emissiveFactor=e.emmisiveTexture?[1,1,1]:[0,0,0]),e.pbrMetallicRoughness){e.pbrMetallicRoughness=ot({},e.pbrMetallicRoughness);const i=e.pbrMetallicRoughness;i.baseColorTexture&&(i.baseColorTexture=ot({},i.baseColorTexture),i.baseColorTexture.texture=this.getTexture(i.baseColorTexture.index)),i.metallicRoughnessTexture&&(i.metallicRoughnessTexture=ot({},i.metallicRoughnessTexture),i.metallicRoughnessTexture.texture=this.getTexture(i.metallicRoughnessTexture.index))}return e}_resolveAccessor(e,t){if(e.id=e.id||`accessor-${t}`,void 0!==e.bufferView&&(e.bufferView=this.getBufferView(e.bufferView)),e.bytesPerComponent=function(n){return _me[n]}(e.componentType),e.components=function(n){return mme[n]}(e.type),e.bytesPerElement=e.bytesPerComponent*e.components,e.bufferView){const i=e.bufferView.buffer,{ArrayType:r,byteLength:s}=xH(e,e.bufferView),o=(e.bufferView.byteOffset||0)+(e.byteOffset||0)+i.byteOffset,a=i.arrayBuffer.slice(o,o+s);e.value=new r(a)}return e}_resolveTexture(e,t){return e.id=e.id||`texture-${t}`,e.sampler="sampler"in e?this.getSampler(e.sampler):vme,e.source=this.getImage(e.source),e}_resolveSampler(e,t){e.id=e.id||`sampler-${t}`,e.parameters={};for(const i in e){const r=this._enumSamplerParameter(i);void 0!==r&&(e.parameters[r]=e[i])}return e}_enumSamplerParameter(e){return yme[e]}_resolveImage(e,t){e.id=e.id||`image-${t}`,void 0!==e.bufferView&&(e.bufferView=this.getBufferView(e.bufferView));const i=this.images[t];return i&&(e.image=i),e}_resolveBufferView(e,t){e.id=e.id||`bufferView-${t}`;const i=e.buffer;e.buffer=this.buffers[i];let s=this.buffers[i].byteOffset||0;return"byteOffset"in e&&(s+=e.byteOffset),e.data=new Uint8Array(this.buffers[i].arrayBuffer,s,e.byteLength),e}_resolveCamera(e,t){return e.id=e.id||`camera-${t}`,e}}function Sme(n,e){return(new Eme).postProcess(n,e)}const DH=1735152710,im=!0;function IR(n,e,t,i){const r=new Uint8Array(e.buffer,t,i),o=new TextDecoder("utf8").decode(r);return n.json=JSON.parse(o),Q0(i,4)}function OR(n,e,t,i){return n.header.hasBinChunk=!0,n.binChunks.push({byteOffset:t,byteLength:i,arrayBuffer:e.buffer}),Q0(i,4)}function Fme(n,e){return RR.apply(this,arguments)}function RR(){return(RR=ni(function*(n,e,t=0,i,r){var s,o,a,l;Lme(n,e,t,i),gme(n,{normalize:null==i||null===(s=i.gltf)||void 0===s?void 0:s.normalize});const c=[];if(null!=i&&null!==(o=i.gltf)&&void 0!==o&&o.loadBuffers&&n.json.buffers&&(yield kme(n,i,r)),null!=i&&null!==(a=i.gltf)&&void 0!==a&&a.loadImages){const h=Bme(n,i,r);c.push(h)}const u=dme(n,i,r);return c.push(u),yield Promise.all(c),null!=i&&null!==(l=i.gltf)&&void 0!==l&&l.postProcess?Sme(n,i):n})).apply(this,arguments)}function Lme(n,e,t,i){if(i.uri&&(n.baseUri=i.uri),e instanceof ArrayBuffer&&!function(n,e=0,t={}){const i=new DataView(n),{magic:r=DH}=t,s=i.getUint32(e,!1);return s===r||s===DH}(e,t,i)&&(e=(new TextDecoder).decode(e)),"string"==typeof e)n.json=function(n){try{return JSON.parse(n)}catch(e){throw new Error(`Failed to parse JSON from data starting with "${function(n,e=5){return"string"==typeof n?n.slice(0,e):ArrayBuffer.isView(n)?sH(n.buffer,n.byteOffset,e):n instanceof ArrayBuffer?sH(n,0,e):""}(n)}"`)}}(e);else if(e instanceof ArrayBuffer){const o={};t=function(n,e,t=0,i={}){const r=new DataView(e),s=function(n,e=0){return`${String.fromCharCode(n.getUint8(e+0))}${String.fromCharCode(n.getUint8(e+1))}${String.fromCharCode(n.getUint8(e+2))}${String.fromCharCode(n.getUint8(e+3))}`}(r,t+0),o=r.getUint32(t+4,im),a=r.getUint32(t+8,im);switch(Object.assign(n,{header:{byteOffset:t,byteLength:a,hasBinChunk:!1},type:s,version:o,json:{},binChunks:[]}),t+=12,n.version){case 1:return function(n,e,t){Of(n.header.byteLength>20);const i=e.getUint32(t+0,im),r=e.getUint32(t+4,im);return t+=8,Of(0===r),IR(n,e,t,i),(t+=i)+OR(n,e,t,n.header.byteLength)}(n,r,t);case 2:return function(n,e,t,i){return Of(n.header.byteLength>20),function(n,e,t,i){for(;t+8<=n.header.byteLength;){const r=e.getUint32(t+0,im),s=e.getUint32(t+4,im);switch(t+=8,s){case 1313821514:IR(n,e,t,r);break;case 5130562:OR(n,e,t,r);break;case 0:i.strict||IR(n,e,t,r);break;case 1:i.strict||OR(n,e,t,r)}t+=Q0(r,4)}}(n,e,t,{}),t+n.header.byteLength}(n,r,t);default:throw new Error(`Invalid GLB version ${n.version}. Only supports v1 and v2.`)}}(o,e,t,i.glb),Ba("glTF"===o.type,`Invalid GLB magic string ${o.type}`),n._glb=o,n.json=o.json}else Ba(!1,"GLTF: must be ArrayBuffer or string");if(n.buffers=new Array((n.json.buffers||[]).length).fill(null),n._glb&&n._glb.header.hasBinChunk){const{binChunks:o}=n._glb;n.buffers[0]={arrayBuffer:o[0].arrayBuffer,byteOffset:o[0].byteOffset,byteLength:o[0].byteLength}}n.images=new Array((n.json.images||[]).length).fill({})}function kme(n,e,t){return NR.apply(this,arguments)}function NR(){return(NR=ni(function*(n,e,t){for(let s=0;s<n.json.buffers.length;++s){const o=n.json.buffers[s];if(o.uri){var i,r;const{fetch:a}=t;Ba(a);const l=oH(o.uri,e),c=yield null==t||null===(i=t.fetch)||void 0===i?void 0:i.call(t,l),u=yield null==c||null===(r=c.arrayBuffer)||void 0===r?void 0:r.call(c);n.buffers[s]={arrayBuffer:u,byteOffset:0,byteLength:u.byteLength},delete o.uri}}})).apply(this,arguments)}function Bme(n,e,t){return PR.apply(this,arguments)}function PR(){return(PR=ni(function*(n,e,t){const i=n.json.images||[],r=[];for(let s=0;s<i.length;++s)r.push(Vme(n,i[s],s,e,t));return yield Promise.all(r)})).apply(this,arguments)}function Vme(n,e,t,i,r){return FR.apply(this,arguments)}function FR(){return(FR=ni(function*(n,e,t,i,r){const{fetch:s,parse:o}=r;let a;if(e.uri){const c=oH(e.uri,i);a=yield(yield s(c)).arrayBuffer()}if(Number.isFinite(e.bufferView)){const c=aH(n.json,n.buffers,e.bufferView);a=oz(c.buffer,c.byteOffset,c.byteLength)}Ba(a,"glTF image has no data");const l=yield o(a,$O,{},r);n.images[t]=l})).apply(this,arguments)}const rm={name:"glTF",id:"gltf",module:"gltf",version:"3.0.12",extensions:["gltf","glb"],mimeTypes:["model/gltf+json","model/gltf-binary"],text:!0,binary:!0,tests:["glTF"],parse:function(n){return LR.apply(this,arguments)},options:{gltf:{normalize:!0,loadBuffers:!0,loadImages:!0,decompressMeshes:!0,postProcess:!0},log:console},deprecatedOptions:{fetchImages:"gltf.loadImages",createImages:"gltf.loadImages",decompress:"gltf.decompressMeshes",postProcess:"gltf.postProcess",gltf:{decompress:"gltf.decompressMeshes"}}};function LR(){return(LR=ni(function*(n,e={},t){(e=ot(ot({},rm.options),e)).gltf=ot(ot({},rm.options.gltf),e.gltf);const{byteOffset:i=0}=e;return yield Fme({},n,i,e,t)})).apply(this,arguments)}function kR(){return(kR=ni(function*(n){const e=[];return n.scenes.forEach(t=>{t.traverse(i=>{Object.values(i.model.getUniforms()).forEach(r=>{!1===r.loaded&&e.push(r)})})}),yield zme(()=>e.some(t=>!t.loaded))})).apply(this,arguments)}function zme(n){return BR.apply(this,arguments)}function BR(){return(BR=ni(function*(n){for(;n();)yield new Promise(e=>requestAnimationFrame(e))})).apply(this,arguments)}const IH=[255,255,255,255],$me={scenegraph:{type:"object",value:null,async:!0},getScene:n=>n&&n.scenes?"object"==typeof n.scene?n.scene:n.scenes[n.scene||0]:n,getAnimator:n=>n&&n.animator,_animations:null,sizeScale:{type:"number",value:1,min:0},sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},getPosition:{type:"accessor",value:n=>n.position},getColor:{type:"accessor",value:IH},_lighting:"flat",_imageBasedLightingEnvironment:null,getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},loaders:[rm]};let Wme=(()=>{class n extends j0{getShaders(){const t=[$S,WS];return"pbr"===this.props._lighting&&t.push(L4),{vs:"#version 300 es\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin mat3 instanceModelMatrix;\nin vec3 instanceTranslation;\nuniform float sizeScale;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform mat4 sceneModelMatrix;\nuniform bool composeModelMatrix;\nin vec4 POSITION;\n\n#ifdef HAS_UV\n  in vec2 TEXCOORD_0;\n#endif\n\n#ifdef MODULE_PBR\n  #ifdef HAS_NORMALS\n    in vec4 NORMAL;\n  #endif\n#endif\nout vec4 vColor;\n#ifndef MODULE_PBR\n  #ifdef HAS_UV\n    out vec2 vTEXCOORD_0;\n  #endif\n#endif\nvoid main(void) {\n  #if defined(HAS_UV) && !defined(MODULE_PBR)\n    vTEXCOORD_0 = TEXCOORD_0;\n    geometry.uv = vTEXCOORD_0;\n  #endif\n\n  geometry.worldPosition = instancePositions;\n  geometry.pickingColor = instancePickingColors;\n\n  #ifdef MODULE_PBR\n    #ifdef HAS_NORMALS\n      pbr_vNormal = project_normal(instanceModelMatrix * (sceneModelMatrix * vec4(NORMAL.xyz, 0.0)).xyz);\n      geometry.normal = pbr_vNormal;\n    #endif\n\n    #ifdef HAS_UV\n      pbr_vUV = TEXCOORD_0;\n    #else\n      pbr_vUV = vec2(0., 0.);\n    #endif\n    geometry.uv = pbr_vUV;\n  #endif\n\n  float originalSize = project_size_to_pixel(sizeScale);\n  float clampedSize = clamp(originalSize, sizeMinPixels, sizeMaxPixels);\n\n  vec3 pos = (instanceModelMatrix * (sceneModelMatrix * POSITION).xyz) * sizeScale * (clampedSize / originalSize) + instanceTranslation;\n  if(composeModelMatrix) {\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n  }\n  else {\n    pos = project_size(pos);\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, geometry.position);\n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  #ifdef MODULE_PBR\n    pbr_vPosition = geometry.position.xyz;\n  #endif\n\n  vColor = instanceColors;\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\nuniform float opacity;\nin vec4 vColor;\n\nout vec4 fragmentColor;\n#ifndef MODULE_PBR\n  #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)\n    in vec2 vTEXCOORD_0;\n    uniform sampler2D u_BaseColorSampler;\n  #endif\n#endif\n\nvoid main(void) {\n  #ifdef MODULE_PBR\n    fragmentColor = vColor * pbr_filterColor(vec4(0));\n    geometry.uv = pbr_vUV;\n  #else\n    #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)\n      fragmentColor = vColor * texture2D(u_BaseColorSampler, vTEXCOORD_0);\n      geometry.uv = vTEXCOORD_0;\n    #else\n      fragmentColor = vColor;\n    #endif\n  #endif\n\n  fragmentColor.a *= opacity;\n  DECKGL_FILTER_COLOR(fragmentColor, geometry);\n}\n",modules:t}}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),accessor:"getPosition",transition:!0},instanceColors:{type:5121,size:this.props.colorFormat.length,accessor:"getColor",normalized:!0,defaultValue:IH,transition:!0},instanceModelMatrix:N4})}updateState(t){super.updateState(t);const{props:i,oldProps:r}=t;i.scenegraph!==r.scenegraph?this._updateScenegraph(i):i._animations!==r._animations&&this._applyAnimationsProp(this.state.scenegraph,this.state.animator,i._animations)}finalizeState(){super.finalizeState(),this._deleteScenegraph()}_updateScenegraph(t){const{gl:i}=this.context;let r=null;if(t.scenegraph instanceof Jg)r={scenes:[t.scenegraph]};else if(t.scenegraph&&!t.scenegraph.gltf){const l=t.scenegraph,c=function(n,e,t){const i=new Zpe(n,t);return{scenes:i.instantiate(e),animator:i.createAnimator()}}(i,l,this._getModelOptions());r=ot({gltf:l},c),function(n){return kR.apply(this,arguments)}(c).then(()=>this.setNeedsRedraw())}else t.scenegraph&&(Mi.deprecated("ScenegraphLayer.props.scenegraph","Use GLTFLoader instead of GLTFScenegraphLoader")(),r=t.scenegraph);const s={layer:this,gl:i},o=t.getScene(r,s),a=t.getAnimator(r,s);o instanceof Jg?(this._deleteScenegraph(),this._applyAllAttributes(o),this._applyAnimationsProp(o,a,t._animations),this.setState({scenegraph:o,animator:a})):null!==o&&Mi.warn("invalid scenegraph:",o)()}_applyAllAttributes(t){if(this.state.attributesAvailable){const i=this.getAttributeManager().getAttributes();t.traverse(r=>{this._setModelAttributes(r.model,i)})}}_applyAnimationsProp(t,i,r){if(!t||!i||!r)return;const s=i.getAnimations();Object.keys(r).sort().forEach(o=>{const a=r[o];if("*"===o)s.forEach(l=>{Object.assign(l,a)});else if(Number.isFinite(Number(o))){const l=Number(o);l>=0&&l<s.length?Object.assign(s[l],a):Mi.warn("animation ".concat(o," not found"))()}else{const l=s.find(({name:c})=>c===o);l?Object.assign(l,a):Mi.warn("animation ".concat(o," not found"))()}})}_deleteScenegraph(){const{scenegraph:t}=this.state;t instanceof Jg&&t.delete()}_getModelOptions(){const{_imageBasedLightingEnvironment:t}=this.props;let i=null;return t&&(i="function"==typeof t?t({gl:this.context.gl,layer:this}):t),{gl:this.context.gl,waitForFullLoad:!0,imageBasedLightingEnvironment:i,modelOptions:ot({isInstanced:!0,transpileToGLSL100:!_i(this.context.gl)},this.getShaders()),useTangents:!1}}updateAttributes(t){this.setState({attributesAvailable:!0}),this.state.scenegraph&&this.state.scenegraph.traverse(i=>{this._setModelAttributes(i.model,t)})}draw({moduleParameters:t=null,parameters:i={},context:r}){if(!this.state.scenegraph)return;this.props._animations&&this.state.animator&&(this.state.animator.animate(r.timeline.getTime()),this.setNeedsRedraw());const{viewport:s}=this.context,{sizeScale:o,sizeMinPixels:a,sizeMaxPixels:l,opacity:c,coordinateSystem:u}=this.props,h=this.getNumInstances();this.state.scenegraph.traverse((f,{worldMatrix:g})=>{f.model.setInstanceCount(h),f.updateModuleSettings(t),f.draw({parameters:i,uniforms:{sizeScale:o,opacity:c,sizeMinPixels:a,sizeMaxPixels:l,composeModelMatrix:P4(s,u),sceneModelMatrix:g,u_Camera:f.model.getUniforms().project_uCameraPosition}})})}}return n.layerName="ScenegraphLayer",n.defaultProps=$me,n})();class qme extends uh{constructor(e={}){const{id:t=ca("sphere-geometry")}=e,{indices:i,attributes:r}=function(n){const{nlat:e=10,nlong:t=10}=n;let{radius:i=1}=n;const o=Math.PI-0,c=2*Math.PI-0,u=(e+1)*(t+1);if("number"==typeof i){const U=i;i=(D,ie,_e,Ne,Pe)=>U}const h=new Float32Array(3*u),f=new Float32Array(3*u),g=new Float32Array(2*u),w=new(u>65535?Uint32Array:Uint16Array)(e*t*6);for(let U=0;U<=e;U++)for(let D=0;D<=t;D++){const ie=D/t,_e=U/e,Ne=D+U*(t+1),Pe=2*Ne,Ve=3*Ne,vt=c*ie,wt=o*_e,xt=Math.sin(vt),kt=Math.cos(vt),$t=Math.sin(wt),mt=kt*$t,jt=Math.cos(wt),ft=xt*$t,qt=i(mt,jt,ft,ie,_e);h[Ve+0]=qt*mt,h[Ve+1]=qt*jt,h[Ve+2]=qt*ft,f[Ve+0]=mt,f[Ve+1]=jt,f[Ve+2]=ft,g[Pe+0]=ie,g[Pe+1]=1-_e}const S=t+1;for(let U=0;U<t;U++)for(let D=0;D<e;D++){const ie=6*(U*e+D);w[ie+0]=D*S+U,w[ie+1]=D*S+U+1,w[ie+2]=(D+1)*S+U,w[ie+3]=(D+1)*S+U,w[ie+4]=D*S+U+1,w[ie+5]=(D+1)*S+U+1}return{indices:{size:1,value:w},attributes:{POSITION:{size:3,value:h},NORMAL:{size:3,value:f},TEXCOORD_0:{size:2,value:g}}}}(e);super(wn(ot({},e),{id:t,indices:i,attributes:ot(ot({},r),e.attributes)}))}}const Kme={x:[2,0,1],y:[0,1,2],z:[1,2,0]};class OH extends uh{constructor(e={}){const{id:t=ca("truncated-code-geometry")}=e,{indices:i,attributes:r}=function(n){const{bottomRadius:e=0,topRadius:t=0,height:i=1,nradial:r=10,nvertical:s=10,verticalAxis:o="y",topCap:a=!1,bottomCap:l=!1}=n,c=(a?2:0)+(l?2:0),u=(r+1)*(s+1+c),h=Math.atan2(e-t,i),f=Math.sin,g=Math.cos,m=Math.PI,w=g(h),S=f(h),U=a?-2:0,D=s+(l?2:0),ie=r+1,_e=new Uint16Array(r*(s+c)*6),Ne=Kme[o],Pe=new Float32Array(3*u),Ve=new Float32Array(3*u),vt=new Float32Array(2*u);let wt=0,xt=0;for(let kt=U;kt<=D;kt++){let mt,$t=kt/s,gt=i*$t;kt<0?(gt=0,$t=1,mt=e):kt>s?(gt=i,$t=1,mt=t):mt=e+kt/s*(t-e),(-2===kt||kt===s+2)&&(mt=0,$t=0),gt-=i/2;for(let jt=0;jt<ie;jt++){const ft=f(jt*m*2/r),qt=g(jt*m*2/r);Pe[wt+Ne[0]]=ft*mt,Pe[wt+Ne[1]]=gt,Pe[wt+Ne[2]]=qt*mt,Ve[wt+Ne[0]]=kt<0||kt>s?0:ft*w,Ve[wt+Ne[1]]=kt<0?-1:kt>s?1:S,Ve[wt+Ne[2]]=kt<0||kt>s?0:qt*w,vt[xt+0]=jt/r,vt[xt+1]=$t,xt+=2,wt+=3}}for(let kt=0;kt<s+c;kt++)for(let $t=0;$t<r;$t++){const gt=6*(kt*r+$t);_e[gt+0]=ie*(kt+0)+0+$t,_e[gt+1]=ie*(kt+0)+1+$t,_e[gt+2]=ie*(kt+1)+1+$t,_e[gt+3]=ie*(kt+0)+0+$t,_e[gt+4]=ie*(kt+1)+1+$t,_e[gt+5]=ie*(kt+1)+0+$t}return{indices:_e,attributes:{POSITION:{size:3,value:Pe},NORMAL:{size:3,value:Ve},TEXCOORD_0:{size:2,value:vt}}}}(e);super(wn(ot({},e),{id:t,indices:i,attributes:ot(ot({},r),e.attributes)}))}}class Qme extends OH{constructor(e={}){const{id:t=ca("cone-geometry"),radius:i=1,cap:r=!0}=e;super(wn(ot({},e),{id:t,topRadius:0,topCap:Boolean(r),bottomCap:Boolean(r),bottomRadius:i}))}}class Zme extends OH{constructor(e={}){const{id:t=ca("cylinder-geometry"),radius:i=1}=e;super(wn(ot({},e),{id:t,bottomRadius:i,topRadius:i}))}}const Jme=new Uint16Array([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),e_e=new Float32Array([-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1]),t_e=new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0]),n_e=new Float32Array([0,0,1,0,1,1,0,1,1,0,1,1,0,1,0,0,0,1,0,0,1,0,1,1,1,1,0,1,0,0,1,0,1,0,1,1,0,1,0,0,0,0,1,0,1,1,0,1]),i_e={POSITION:{size:3,value:new Float32Array(e_e)},NORMAL:{size:3,value:new Float32Array(t_e)},TEXCOORD_0:{size:2,value:new Float32Array(n_e)}};class r_e extends uh{constructor(e={}){const{id:t=ca("cube-geometry")}=e;super(wn(ot({},e),{id:t,indices:{size:1,value:new Uint16Array(Jme)},attributes:ot(ot({},i_e),e.attributes)}))}}class nu{constructor(e=[0,0,0,0,0,0,0,0,0]){this.elements=void 0,this.elements=e}identity(){const e=this.elements;e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1}setZero(){const e=this.elements;e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e[8]=0}setTrace(e){const t=this.elements;t[0]=e.x,t[4]=e.y,t[8]=e.z}getTrace(e=new ce){const t=this.elements;return e.x=t[0],e.y=t[4],e.z=t[8],e}vmult(e,t=new ce){const i=this.elements,r=e.x,s=e.y,o=e.z;return t.x=i[0]*r+i[1]*s+i[2]*o,t.y=i[3]*r+i[4]*s+i[5]*o,t.z=i[6]*r+i[7]*s+i[8]*o,t}smult(e){for(let t=0;t<this.elements.length;t++)this.elements[t]*=e}mmult(e,t=new nu){const i=this.elements,r=e.elements,s=t.elements,o=i[0],a=i[1],l=i[2],c=i[3],u=i[4],h=i[5],f=i[6],g=i[7],m=i[8],w=r[0],S=r[1],U=r[2],D=r[3],ie=r[4],_e=r[5],Ne=r[6],Pe=r[7],Ve=r[8];return s[0]=o*w+a*D+l*Ne,s[1]=o*S+a*ie+l*Pe,s[2]=o*U+a*_e+l*Ve,s[3]=c*w+u*D+h*Ne,s[4]=c*S+u*ie+h*Pe,s[5]=c*U+u*_e+h*Ve,s[6]=f*w+g*D+m*Ne,s[7]=f*S+g*ie+m*Pe,s[8]=f*U+g*_e+m*Ve,t}scale(e,t=new nu){const i=this.elements,r=t.elements;for(let s=0;3!==s;s++)r[3*s+0]=e.x*i[3*s+0],r[3*s+1]=e.y*i[3*s+1],r[3*s+2]=e.z*i[3*s+2];return t}solve(e,t=new ce){const s=[];let o,a;for(o=0;o<12;o++)s.push(0);for(o=0;o<3;o++)for(a=0;a<3;a++)s[o+4*a]=this.elements[o+3*a];s[3]=e.x,s[7]=e.y,s[11]=e.z;let l=3;const c=l;let u,f;do{if(o=c-l,0===s[o+4*o])for(a=o+1;a<c;a++)if(0!==s[o+4*a]){u=4;do{f=4-u,s[f+4*o]+=s[f+4*a]}while(--u);break}if(0!==s[o+4*o])for(a=o+1;a<c;a++){const g=s[o+4*a]/s[o+4*o];u=4;do{f=4-u,s[f+4*a]=f<=o?0:s[f+4*a]-s[f+4*o]*g}while(--u)}}while(--l);if(t.z=s[11]/s[10],t.y=(s[7]-s[6]*t.z)/s[5],t.x=(s[3]-s[2]*t.z-s[1]*t.y)/s[0],isNaN(t.x)||isNaN(t.y)||isNaN(t.z)||t.x===1/0||t.y===1/0||t.z===1/0)throw"Could not solve equation! Got x=["+t.toString()+"], b=["+e.toString()+"], A=["+this.toString()+"]";return t}e(e,t,i){if(void 0===i)return this.elements[t+3*e];this.elements[t+3*e]=i}copy(e){for(let t=0;t<e.elements.length;t++)this.elements[t]=e.elements[t];return this}toString(){let e="";for(let i=0;i<9;i++)e+=this.elements[i]+",";return e}reverse(e=new nu){const r=s_e;let s,o;for(s=0;s<3;s++)for(o=0;o<3;o++)r[s+6*o]=this.elements[s+3*o];r[3]=1,r[9]=0,r[15]=0,r[4]=0,r[10]=1,r[16]=0,r[5]=0,r[11]=0,r[17]=1;let a=3;const l=a;let c,h;do{if(s=l-a,0===r[s+6*s])for(o=s+1;o<l;o++)if(0!==r[s+6*o]){c=6;do{h=6-c,r[h+6*s]+=r[h+6*o]}while(--c);break}if(0!==r[s+6*s])for(o=s+1;o<l;o++){const f=r[s+6*o]/r[s+6*s];c=6;do{h=6-c,r[h+6*o]=h<=s?0:r[h+6*o]-r[h+6*s]*f}while(--c)}}while(--a);s=2;do{o=s-1;do{const f=r[s+6*o]/r[s+6*s];c=6;do{h=6-c,r[h+6*o]=r[h+6*o]-r[h+6*s]*f}while(--c)}while(o--)}while(--s);s=2;do{const f=1/r[s+6*s];c=6;do{h=6-c,r[h+6*s]=r[h+6*s]*f}while(--c)}while(s--);s=2;do{o=2;do{if(h=r[3+o+6*s],isNaN(h)||h===1/0)throw"Could not reverse! A=["+this.toString()+"]";e.e(s,o,h)}while(o--)}while(s--);return e}setRotationFromQuaternion(e){const t=e.x,i=e.y,r=e.z,s=e.w,o=t+t,a=i+i,l=r+r,c=t*o,u=t*a,h=t*l,f=i*a,g=i*l,m=r*l,w=s*o,S=s*a,U=s*l,D=this.elements;return D[0]=1-(f+m),D[1]=u-U,D[2]=h+S,D[3]=u+U,D[4]=1-(c+m),D[5]=g-w,D[6]=h-S,D[7]=g+w,D[8]=1-(c+f),this}transpose(e=new nu){const t=this.elements,i=e.elements;let r;return i[0]=t[0],i[4]=t[4],i[8]=t[8],r=t[1],i[1]=t[3],i[3]=r,r=t[2],i[2]=t[6],i[6]=r,r=t[5],i[5]=t[7],i[7]=r,e}}const s_e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];class ce{constructor(e=0,t=0,i=0){this.x=void 0,this.y=void 0,this.z=void 0,this.x=e,this.y=t,this.z=i}cross(e,t=new ce){const i=e.x,r=e.y,s=e.z,o=this.x,a=this.y,l=this.z;return t.x=a*s-l*r,t.y=l*i-o*s,t.z=o*r-a*i,t}set(e,t,i){return this.x=e,this.y=t,this.z=i,this}setZero(){this.x=this.y=this.z=0}vadd(e,t){if(!t)return new ce(this.x+e.x,this.y+e.y,this.z+e.z);t.x=e.x+this.x,t.y=e.y+this.y,t.z=e.z+this.z}vsub(e,t){if(!t)return new ce(this.x-e.x,this.y-e.y,this.z-e.z);t.x=this.x-e.x,t.y=this.y-e.y,t.z=this.z-e.z}crossmat(){return new nu([0,-this.z,this.y,this.z,0,-this.x,-this.y,this.x,0])}normalize(){const e=this.x,t=this.y,i=this.z,r=Math.sqrt(e*e+t*t+i*i);if(r>0){const s=1/r;this.x*=s,this.y*=s,this.z*=s}else this.x=0,this.y=0,this.z=0;return r}unit(e=new ce){const t=this.x,i=this.y,r=this.z;let s=Math.sqrt(t*t+i*i+r*r);return s>0?(s=1/s,e.x=t*s,e.y=i*s,e.z=r*s):(e.x=1,e.y=0,e.z=0),e}length(){const e=this.x,t=this.y,i=this.z;return Math.sqrt(e*e+t*t+i*i)}lengthSquared(){return this.dot(this)}distanceTo(e){const t=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z;return Math.sqrt((s-t)*(s-t)+(o-i)*(o-i)+(a-r)*(a-r))}distanceSquared(e){const t=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z;return(s-t)*(s-t)+(o-i)*(o-i)+(a-r)*(a-r)}scale(e,t=new ce){const r=this.y,s=this.z;return t.x=e*this.x,t.y=e*r,t.z=e*s,t}vmul(e,t=new ce){return t.x=e.x*this.x,t.y=e.y*this.y,t.z=e.z*this.z,t}addScaledVector(e,t,i=new ce){return i.x=this.x+e*t.x,i.y=this.y+e*t.y,i.z=this.z+e*t.z,i}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}isZero(){return 0===this.x&&0===this.y&&0===this.z}negate(e=new ce){return e.x=-this.x,e.y=-this.y,e.z=-this.z,e}tangents(e,t){const i=this.length();if(i>0){const r=o_e,s=1/i;r.set(this.x*s,this.y*s,this.z*s);const o=a_e;Math.abs(r.x)<.9?(o.set(1,0,0),r.cross(o,e)):(o.set(0,1,0),r.cross(o,e)),r.cross(e,t)}else e.set(1,0,0),t.set(0,1,0)}toString(){return this.x+","+this.y+","+this.z}toArray(){return[this.x,this.y,this.z]}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}lerp(e,t,i){const r=this.x,s=this.y,o=this.z;i.x=r+(e.x-r)*t,i.y=s+(e.y-s)*t,i.z=o+(e.z-o)*t}almostEquals(e,t=1e-6){return!(Math.abs(this.x-e.x)>t||Math.abs(this.y-e.y)>t||Math.abs(this.z-e.z)>t)}almostZero(e=1e-6){return!(Math.abs(this.x)>e||Math.abs(this.y)>e||Math.abs(this.z)>e)}isAntiparallelTo(e,t){return this.negate(RH),RH.almostEquals(e,t)}clone(){return new ce(this.x,this.y,this.z)}}ce.ZERO=void 0,ce.UNIT_X=void 0,ce.UNIT_Y=void 0,ce.UNIT_Z=void 0,ce.ZERO=new ce(0,0,0),ce.UNIT_X=new ce(1,0,0),ce.UNIT_Y=new ce(0,1,0),ce.UNIT_Z=new ce(0,0,1);const o_e=new ce,a_e=new ce,RH=new ce;class cr{constructor(e={}){this.lowerBound=void 0,this.upperBound=void 0,this.lowerBound=new ce,this.upperBound=new ce,e.lowerBound&&this.lowerBound.copy(e.lowerBound),e.upperBound&&this.upperBound.copy(e.upperBound)}setFromPoints(e,t,i,r){const s=this.lowerBound,o=this.upperBound,a=i;s.copy(e[0]),a&&a.vmult(s,s),o.copy(s);for(let l=1;l<e.length;l++){let c=e[l];a&&(a.vmult(c,NH),c=NH),c.x>o.x&&(o.x=c.x),c.x<s.x&&(s.x=c.x),c.y>o.y&&(o.y=c.y),c.y<s.y&&(s.y=c.y),c.z>o.z&&(o.z=c.z),c.z<s.z&&(s.z=c.z)}return t&&(t.vadd(s,s),t.vadd(o,o)),r&&(s.x-=r,s.y-=r,s.z-=r,o.x+=r,o.y+=r,o.z+=r),this}copy(e){return this.lowerBound.copy(e.lowerBound),this.upperBound.copy(e.upperBound),this}clone(){return(new cr).copy(this)}extend(e){this.lowerBound.x=Math.min(this.lowerBound.x,e.lowerBound.x),this.upperBound.x=Math.max(this.upperBound.x,e.upperBound.x),this.lowerBound.y=Math.min(this.lowerBound.y,e.lowerBound.y),this.upperBound.y=Math.max(this.upperBound.y,e.upperBound.y),this.lowerBound.z=Math.min(this.lowerBound.z,e.lowerBound.z),this.upperBound.z=Math.max(this.upperBound.z,e.upperBound.z)}overlaps(e){const t=this.lowerBound,i=this.upperBound,r=e.lowerBound,s=e.upperBound;return(r.x<=i.x&&i.x<=s.x||t.x<=s.x&&s.x<=i.x)&&(r.y<=i.y&&i.y<=s.y||t.y<=s.y&&s.y<=i.y)&&(r.z<=i.z&&i.z<=s.z||t.z<=s.z&&s.z<=i.z)}volume(){const e=this.lowerBound,t=this.upperBound;return(t.x-e.x)*(t.y-e.y)*(t.z-e.z)}contains(e){const t=this.lowerBound,i=this.upperBound,r=e.lowerBound,s=e.upperBound;return t.x<=r.x&&i.x>=s.x&&t.y<=r.y&&i.y>=s.y&&t.z<=r.z&&i.z>=s.z}getCorners(e,t,i,r,s,o,a,l){const c=this.lowerBound,u=this.upperBound;e.copy(c),t.set(u.x,c.y,c.z),i.set(u.x,u.y,c.z),r.set(c.x,u.y,u.z),s.set(u.x,c.y,u.z),o.set(c.x,u.y,c.z),a.set(c.x,c.y,u.z),l.copy(u)}toLocalFrame(e,t){const i=PH;this.getCorners(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7]);for(let f=0;8!==f;f++){const g=i[f];e.pointToLocal(g,g)}return t.setFromPoints(i)}toWorldFrame(e,t){const i=PH;this.getCorners(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7]);for(let f=0;8!==f;f++){const g=i[f];e.pointToWorld(g,g)}return t.setFromPoints(i)}overlapsRay(e){const{direction:t,from:i}=e,r=1/t.x,s=1/t.y,o=1/t.z,a=(this.lowerBound.x-i.x)*r,l=(this.upperBound.x-i.x)*r,c=(this.lowerBound.y-i.y)*s,u=(this.upperBound.y-i.y)*s,h=(this.lowerBound.z-i.z)*o,f=(this.upperBound.z-i.z)*o,g=Math.max(Math.max(Math.min(a,l),Math.min(c,u)),Math.min(h,f)),m=Math.min(Math.min(Math.max(a,l),Math.max(c,u)),Math.max(h,f));return!(m<0||g>m)}}const NH=new ce,PH=[new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce];class as{constructor(e=0,t=0,i=0,r=1){this.x=void 0,this.y=void 0,this.z=void 0,this.w=void 0,this.x=e,this.y=t,this.z=i,this.w=r}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}toString(){return this.x+","+this.y+","+this.z+","+this.w}toArray(){return[this.x,this.y,this.z,this.w]}setFromAxisAngle(e,t){const i=Math.sin(.5*t);return this.x=e.x*i,this.y=e.y*i,this.z=e.z*i,this.w=Math.cos(.5*t),this}toAxisAngle(e=new ce){this.normalize();const t=2*Math.acos(this.w),i=Math.sqrt(1-this.w*this.w);return i<.001?(e.x=this.x,e.y=this.y,e.z=this.z):(e.x=this.x/i,e.y=this.y/i,e.z=this.z/i),[e,t]}setFromVectors(e,t){if(e.isAntiparallelTo(t)){const i=c_e;e.tangents(i,u_e),this.setFromAxisAngle(i,Math.PI)}else{const i=e.cross(t);this.x=i.x,this.y=i.y,this.z=i.z,this.w=Math.sqrt(_r(e.length(),2)*_r(t.length(),2))+e.dot(t),this.normalize()}return this}mult(e,t=new as){const i=this.x,r=this.y,s=this.z,o=this.w,a=e.x,l=e.y,c=e.z,u=e.w;return t.x=i*u+o*a+r*c-s*l,t.y=r*u+o*l+s*a-i*c,t.z=s*u+o*c+i*l-r*a,t.w=o*u-i*a-r*l-s*c,t}inverse(e=new as){const t=this.x,i=this.y,r=this.z,s=this.w;this.conjugate(e);const o=1/(t*t+i*i+r*r+s*s);return e.x*=o,e.y*=o,e.z*=o,e.w*=o,e}conjugate(e=new as){return e.x=-this.x,e.y=-this.y,e.z=-this.z,e.w=this.w,e}normalize(){let e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return 0===e?(this.x=0,this.y=0,this.z=0,this.w=0):(e=1/e,this.x*=e,this.y*=e,this.z*=e,this.w*=e),this}normalizeFast(){const e=(3-(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w))/2;return 0===e?(this.x=0,this.y=0,this.z=0,this.w=0):(this.x*=e,this.y*=e,this.z*=e,this.w*=e),this}vmult(e,t=new ce){const i=e.x,r=e.y,s=e.z,o=this.x,a=this.y,l=this.z,c=this.w,u=c*i+a*s-l*r,h=c*r+l*i-o*s,f=c*s+o*r-a*i,g=-o*i-a*r-l*s;return t.x=u*c+g*-o+h*-l-f*-a,t.y=h*c+g*-a+f*-o-u*-l,t.z=f*c+g*-l+u*-a-h*-o,t}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this}toEuler(e,t="YZX"){let i,r,s;const o=this.x,a=this.y,l=this.z,c=this.w;switch(t){case"YZX":const u=o*a+l*c;if(u>.499&&(i=2*Math.atan2(o,c),r=Math.PI/2,s=0),u<-.499&&(i=-2*Math.atan2(o,c),r=-Math.PI/2,s=0),void 0===i){const h=o*o,g=l*l;i=Math.atan2(2*a*c-2*o*l,1-a*a*2-2*g),r=Math.asin(2*u),s=Math.atan2(2*o*c-2*a*l,1-2*h-2*g)}break;default:throw new Error("Euler order "+t+" not supported yet.")}e.y=i,e.z=r,e.x=s}setFromEuler(e,t,i,r="XYZ"){const s=Math.cos(e/2),o=Math.cos(t/2),a=Math.cos(i/2),l=Math.sin(e/2),c=Math.sin(t/2),u=Math.sin(i/2);return"XYZ"===r?(this.x=l*o*a+s*c*u,this.y=s*c*a-l*o*u,this.z=s*o*u+l*c*a,this.w=s*o*a-l*c*u):"YXZ"===r?(this.x=l*o*a+s*c*u,this.y=s*c*a-l*o*u,this.z=s*o*u-l*c*a,this.w=s*o*a+l*c*u):"ZXY"===r?(this.x=l*o*a-s*c*u,this.y=s*c*a+l*o*u,this.z=s*o*u+l*c*a,this.w=s*o*a-l*c*u):"ZYX"===r?(this.x=l*o*a-s*c*u,this.y=s*c*a+l*o*u,this.z=s*o*u-l*c*a,this.w=s*o*a+l*c*u):"YZX"===r?(this.x=l*o*a+s*c*u,this.y=s*c*a+l*o*u,this.z=s*o*u-l*c*a,this.w=s*o*a-l*c*u):"XZY"===r&&(this.x=l*o*a-s*c*u,this.y=s*c*a-l*o*u,this.z=s*o*u+l*c*a,this.w=s*o*a+l*c*u),this}clone(){return new as(this.x,this.y,this.z,this.w)}slerp(e,t,i=new as){const r=this.x,s=this.y,o=this.z,a=this.w;let f,g,m,w,S,l=e.x,c=e.y,u=e.z,h=e.w;return g=r*l+s*c+o*u+a*h,g<0&&(g=-g,l=-l,c=-c,u=-u,h=-h),1-g>1e-6?(f=Math.acos(g),m=Math.sin(f),w=Math.sin((1-t)*f)/m,S=Math.sin(t*f)/m):(w=1-t,S=t),i.x=w*r+S*l,i.y=w*s+S*c,i.z=w*o+S*u,i.w=w*a+S*h,i}integrate(e,t,i,r=new as){const s=e.x*i.x,o=e.y*i.y,a=e.z*i.z,l=this.x,c=this.y,u=this.z,h=this.w,f=.5*t;return r.x+=f*(s*h+o*u-a*c),r.y+=f*(o*h+a*l-s*u),r.z+=f*(a*h+s*c-o*l),r.w+=f*(-s*l-o*c-a*u),r}}const c_e=new ce,u_e=new ce,d_e={SPHERE:1,PLANE:2,BOX:4,COMPOUND:8,CONVEXPOLYHEDRON:16,HEIGHTFIELD:32,PARTICLE:64,CYLINDER:128,TRIMESH:256};let fn=(()=>{class n{constructor(t={}){this.id=void 0,this.type=void 0,this.boundingSphereRadius=void 0,this.collisionResponse=void 0,this.collisionFilterGroup=void 0,this.collisionFilterMask=void 0,this.material=void 0,this.body=void 0,this.id=n.idCounter++,this.type=t.type||0,this.boundingSphereRadius=0,this.collisionResponse=!t.collisionResponse||t.collisionResponse,this.collisionFilterGroup=void 0!==t.collisionFilterGroup?t.collisionFilterGroup:1,this.collisionFilterMask=void 0!==t.collisionFilterMask?t.collisionFilterMask:-1,this.material=t.material?t.material:null,this.body=null}updateBoundingSphereRadius(){throw"computeBoundingSphereRadius() not implemented for shape type "+this.type}volume(){throw"volume() not implemented for shape type "+this.type}calculateLocalInertia(t,i){throw"calculateLocalInertia() not implemented for shape type "+this.type}calculateWorldAABB(t,i,r,s){throw"calculateWorldAABB() not implemented for shape type "+this.type}}return n.idCounter=0,n.types=d_e,n})();class Vi{constructor(e={}){this.position=void 0,this.quaternion=void 0,this.position=new ce,this.quaternion=new as,e.position&&this.position.copy(e.position),e.quaternion&&this.quaternion.copy(e.quaternion)}pointToLocal(e,t){return Vi.pointToLocalFrame(this.position,this.quaternion,e,t)}pointToWorld(e,t){return Vi.pointToWorldFrame(this.position,this.quaternion,e,t)}vectorToWorldFrame(e,t=new ce){return this.quaternion.vmult(e,t),t}static pointToLocalFrame(e,t,i,r=new ce){return i.vsub(e,r),t.conjugate(LH),LH.vmult(r,r),r}static pointToWorldFrame(e,t,i,r=new ce){return t.vmult(i,r),r.vadd(e,r),r}static vectorToWorldFrame(e,t,i=new ce){return e.vmult(t,i),i}static vectorToLocalFrame(e,t,i,r=new ce){return t.w*=-1,t.vmult(i,r),t.w*=-1,r}}const LH=new as;class Pf extends fn{constructor(e={}){const{vertices:t=[],faces:i=[],normals:r=[],axes:s,boundingSphereRadius:o}=e;super({type:fn.types.CONVEXPOLYHEDRON}),this.vertices=void 0,this.faces=void 0,this.faceNormals=void 0,this.worldVertices=void 0,this.worldVerticesNeedsUpdate=void 0,this.worldFaceNormals=void 0,this.worldFaceNormalsNeedsUpdate=void 0,this.uniqueAxes=void 0,this.uniqueEdges=void 0,this.vertices=t,this.faces=i,this.faceNormals=r,0===this.faceNormals.length&&this.computeNormals(),o?this.boundingSphereRadius=o:this.updateBoundingSphereRadius(),this.worldVertices=[],this.worldVerticesNeedsUpdate=!0,this.worldFaceNormals=[],this.worldFaceNormalsNeedsUpdate=!0,this.uniqueAxes=s?s.slice():null,this.uniqueEdges=[],this.computeEdges()}computeEdges(){const e=this.faces,t=this.vertices,i=this.uniqueEdges;i.length=0;const r=new ce;for(let s=0;s!==e.length;s++){const o=e[s],a=o.length;for(let l=0;l!==a;l++){t[o[l]].vsub(t[o[(l+1)%a]],r),r.normalize();let u=!1;for(let h=0;h!==i.length;h++)if(i[h].almostEquals(r)||i[h].almostEquals(r)){u=!0;break}u||i.push(r.clone())}}}computeNormals(){this.faceNormals.length=this.faces.length;for(let e=0;e<this.faces.length;e++){for(let r=0;r<this.faces[e].length;r++)if(!this.vertices[this.faces[e][r]])throw new Error("Vertex "+this.faces[e][r]+" not found!");const t=this.faceNormals[e]||new ce;if(this.getFaceNormal(e,t),t.negate(t),this.faceNormals[e]=t,t.dot(this.vertices[this.faces[e][0]])<0){console.error(".faceNormals["+e+"] = Vec3("+t.toString()+") looks like it points into the shape? The vertices follow. Make sure they are ordered CCW around the normal, using the right hand rule.");for(let r=0;r<this.faces[e].length;r++)console.warn(".vertices["+this.faces[e][r]+"] = Vec3("+this.vertices[this.faces[e][r]].toString()+")")}}}getFaceNormal(e,t){const i=this.faces[e];Pf.computeNormal(this.vertices[i[0]],this.vertices[i[1]],this.vertices[i[2]],t)}static computeNormal(e,t,i,r){const s=new ce,o=new ce;t.vsub(e,o),i.vsub(t,s),s.cross(o,r),r.isZero()||r.normalize()}clipAgainstHull(e,t,i,r,s,o,a,l,c){const u=new ce;let h=-1,f=-Number.MAX_VALUE;for(let m=0;m<i.faces.length;m++){u.copy(i.faceNormals[m]),s.vmult(u,u);const w=u.dot(o);w>f&&(f=w,h=m)}const g=[];for(let m=0;m<i.faces[h].length;m++){const w=i.vertices[i.faces[h][m]],S=new ce;S.copy(w),s.vmult(S,S),r.vadd(S,S),g.push(S)}h>=0&&this.clipFaceAgainstHull(o,e,t,g,a,l,c)}findSeparatingAxis(e,t,i,r,s,o,a,l){const c=new ce,u=new ce,h=new ce,f=new ce,g=new ce,m=new ce;let w=Number.MAX_VALUE;const S=this;if(S.uniqueAxes)for(let U=0;U!==S.uniqueAxes.length;U++){i.vmult(S.uniqueAxes[U],c);const D=S.testSepAxis(c,e,t,i,r,s);if(!1===D)return!1;D<w&&(w=D,o.copy(c))}else{const U=a?a.length:S.faces.length;for(let D=0;D<U;D++){c.copy(S.faceNormals[a?a[D]:D]),i.vmult(c,c);const _e=S.testSepAxis(c,e,t,i,r,s);if(!1===_e)return!1;_e<w&&(w=_e,o.copy(c))}}if(e.uniqueAxes)for(let U=0;U!==e.uniqueAxes.length;U++){s.vmult(e.uniqueAxes[U],u);const D=S.testSepAxis(u,e,t,i,r,s);if(!1===D)return!1;D<w&&(w=D,o.copy(u))}else{const U=l?l.length:e.faces.length;for(let D=0;D<U;D++){u.copy(e.faceNormals[l?l[D]:D]),s.vmult(u,u);const _e=S.testSepAxis(u,e,t,i,r,s);if(!1===_e)return!1;_e<w&&(w=_e,o.copy(u))}}for(let U=0;U!==S.uniqueEdges.length;U++){i.vmult(S.uniqueEdges[U],f);for(let D=0;D!==e.uniqueEdges.length;D++)if(s.vmult(e.uniqueEdges[D],g),f.cross(g,m),!m.almostZero()){m.normalize();const ie=S.testSepAxis(m,e,t,i,r,s);if(!1===ie)return!1;ie<w&&(w=ie,o.copy(m))}}return r.vsub(t,h),h.dot(o)>0&&o.negate(o),!0}testSepAxis(e,t,i,r,s,o){Pf.project(this,e,i,r,VR),Pf.project(t,e,s,o,jR);const l=VR[0],c=VR[1],u=jR[0],h=jR[1];if(l<h||u<c)return!1;const f=l-h,g=u-c;return f<g?f:g}calculateLocalInertia(e,t){const i=new ce,r=new ce;this.computeLocalAABB(r,i);const s=i.x-r.x,o=i.y-r.y,a=i.z-r.z;t.x=1/12*e*(2*o*2*o+2*a*2*a),t.y=1/12*e*(2*s*2*s+2*a*2*a),t.z=1/12*e*(2*o*2*o+2*s*2*s)}getPlaneConstantOfFace(e){return-this.faceNormals[e].dot(this.vertices[this.faces[e][0]])}clipFaceAgainstHull(e,t,i,r,s,o,a){const l=new ce,c=new ce,u=new ce,h=new ce,f=new ce,g=new ce,m=new ce,w=new ce,S=this,D=r,ie=[];let _e=-1,Ne=Number.MAX_VALUE;for(let xt=0;xt<S.faces.length;xt++){l.copy(S.faceNormals[xt]),i.vmult(l,l);const kt=l.dot(e);kt<Ne&&(Ne=kt,_e=xt)}if(_e<0)return;const Pe=S.faces[_e];Pe.connectedFaces=[];for(let xt=0;xt<S.faces.length;xt++)for(let kt=0;kt<S.faces[xt].length;kt++)-1!==Pe.indexOf(S.faces[xt][kt])&&xt!==_e&&-1===Pe.connectedFaces.indexOf(xt)&&Pe.connectedFaces.push(xt);const Ve=Pe.length;for(let xt=0;xt<Ve;xt++){const kt=S.vertices[Pe[xt]];kt.vsub(S.vertices[Pe[(xt+1)%Ve]],c),u.copy(c),i.vmult(u,u),t.vadd(u,u),h.copy(this.faceNormals[_e]),i.vmult(h,h),t.vadd(h,h),u.cross(h,f),f.negate(f),g.copy(kt),i.vmult(g,g),t.vadd(g,g);const gt=Pe.connectedFaces[xt];m.copy(this.faceNormals[gt]);const mt=this.getPlaneConstantOfFace(gt);w.copy(m),i.vmult(w,w);const jt=mt-w.dot(t);for(this.clipFaceAgainstPlane(D,ie,w,jt);D.length;)D.shift();for(;ie.length;)D.push(ie.shift())}m.copy(this.faceNormals[_e]);const vt=this.getPlaneConstantOfFace(_e);w.copy(m),i.vmult(w,w);const wt=vt-w.dot(t);for(let xt=0;xt<D.length;xt++){let kt=w.dot(D[xt])+wt;if(kt<=s&&(console.log("clamped: depth="+kt+" to minDist="+s),kt=s),kt<=o){const $t=D[xt];kt<=1e-6&&a.push({point:$t,normal:w,depth:kt})}}}clipFaceAgainstPlane(e,t,i,r){let s,o;const a=e.length;if(a<2)return t;let l=e[e.length-1],c=e[0];s=i.dot(l)+r;for(let u=0;u<a;u++){if(c=e[u],o=i.dot(c)+r,s<0)if(o<0){const h=new ce;h.copy(c),t.push(h)}else{const h=new ce;l.lerp(c,s/(s-o),h),t.push(h)}else if(o<0){const h=new ce;l.lerp(c,s/(s-o),h),t.push(h),t.push(c)}l=c,s=o}return t}computeWorldVertices(e,t){for(;this.worldVertices.length<this.vertices.length;)this.worldVertices.push(new ce);const i=this.vertices,r=this.worldVertices;for(let s=0;s!==this.vertices.length;s++)t.vmult(i[s],r[s]),e.vadd(r[s],r[s]);this.worldVerticesNeedsUpdate=!1}computeLocalAABB(e,t){const i=this.vertices;e.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),t.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(let r=0;r<this.vertices.length;r++){const s=i[r];s.x<e.x?e.x=s.x:s.x>t.x&&(t.x=s.x),s.y<e.y?e.y=s.y:s.y>t.y&&(t.y=s.y),s.z<e.z?e.z=s.z:s.z>t.z&&(t.z=s.z)}}computeWorldFaceNormals(e){const t=this.faceNormals.length;for(;this.worldFaceNormals.length<t;)this.worldFaceNormals.push(new ce);const i=this.faceNormals,r=this.worldFaceNormals;for(let s=0;s!==t;s++)e.vmult(i[s],r[s]);this.worldFaceNormalsNeedsUpdate=!1}updateBoundingSphereRadius(){let e=0;const t=this.vertices;for(let i=0;i!==t.length;i++){const r=t[i].lengthSquared();r>e&&(e=r)}this.boundingSphereRadius=Math.sqrt(e)}calculateWorldAABB(e,t,i,r){const s=this.vertices;let o,a,l,c,u,h,f=new ce;for(let g=0;g<s.length;g++){f.copy(s[g]),t.vmult(f,f),e.vadd(f,f);const m=f;(void 0===o||m.x<o)&&(o=m.x),(void 0===c||m.x>c)&&(c=m.x),(void 0===a||m.y<a)&&(a=m.y),(void 0===u||m.y>u)&&(u=m.y),(void 0===l||m.z<l)&&(l=m.z),(void 0===h||m.z>h)&&(h=m.z)}i.set(o,a,l),r.set(c,u,h)}volume(){return 4*Math.PI*this.boundingSphereRadius/3}getAveragePointLocal(e=new ce){const t=this.vertices;for(let i=0;i<t.length;i++)e.vadd(t[i],e);return e.scale(1/t.length,e),e}transformAllPoints(e,t){const i=this.vertices.length,r=this.vertices;if(t){for(let s=0;s<i;s++){const o=r[s];t.vmult(o,o)}for(let s=0;s<this.faceNormals.length;s++){const o=this.faceNormals[s];t.vmult(o,o)}}if(e)for(let s=0;s<i;s++){const o=r[s];o.vadd(e,o)}}pointIsInside(e){const t=this.vertices,i=this.faces,r=this.faceNormals,s=new ce;this.getAveragePointLocal(s);for(let o=0;o<this.faces.length;o++){let a=r[o];const l=t[i[o][0]],c=new ce;e.vsub(l,c);const u=a.dot(c),h=new ce;s.vsub(l,h);const f=a.dot(h);if(u<0&&f>0||u>0&&f<0)return!1}return-1}static project(e,t,i,r,s){const o=e.vertices.length,a=h_e;let l=0,c=0;const u=f_e,h=e.vertices;u.setZero(),Vi.vectorToLocalFrame(i,r,t,a),Vi.pointToLocalFrame(i,r,u,u);const f=u.dot(a);c=l=h[0].dot(a);for(let g=1;g<o;g++){const m=h[g].dot(a);m>l&&(l=m),m<c&&(c=m)}if(c-=f,l-=f,c>l){const g=c;c=l,l=g}s[0]=l,s[1]=c}}const VR=[],jR=[],h_e=new ce,f_e=new ce;class ix extends fn{constructor(e){super({type:fn.types.BOX}),this.halfExtents=void 0,this.convexPolyhedronRepresentation=void 0,this.halfExtents=e,this.convexPolyhedronRepresentation=null,this.updateConvexPolyhedronRepresentation(),this.updateBoundingSphereRadius()}updateConvexPolyhedronRepresentation(){const e=this.halfExtents.x,t=this.halfExtents.y,i=this.halfExtents.z,r=ce,s=[new r(-e,-t,-i),new r(e,-t,-i),new r(e,t,-i),new r(-e,t,-i),new r(-e,-t,i),new r(e,-t,i),new r(e,t,i),new r(-e,t,i)],a=[new r(0,0,1),new r(0,1,0),new r(1,0,0)],l=new Pf({vertices:s,faces:[[3,2,1,0],[4,5,6,7],[5,4,0,1],[2,3,7,6],[0,4,7,3],[1,2,6,5]],axes:a});this.convexPolyhedronRepresentation=l,l.material=this.material}calculateLocalInertia(e,t=new ce){return ix.calculateInertia(this.halfExtents,e,t),t}static calculateInertia(e,t,i){const r=e;i.x=1/12*t*(2*r.y*2*r.y+2*r.z*2*r.z),i.y=1/12*t*(2*r.x*2*r.x+2*r.z*2*r.z),i.z=1/12*t*(2*r.y*2*r.y+2*r.x*2*r.x)}getSideNormals(e,t){const i=e,r=this.halfExtents;if(i[0].set(r.x,0,0),i[1].set(0,r.y,0),i[2].set(0,0,r.z),i[3].set(-r.x,0,0),i[4].set(0,-r.y,0),i[5].set(0,0,-r.z),void 0!==t)for(let s=0;s!==i.length;s++)t.vmult(i[s],i[s]);return i}volume(){return 8*this.halfExtents.x*this.halfExtents.y*this.halfExtents.z}updateBoundingSphereRadius(){this.boundingSphereRadius=this.halfExtents.length()}forEachWorldCorner(e,t,i){const r=this.halfExtents,s=[[r.x,r.y,r.z],[-r.x,r.y,r.z],[-r.x,-r.y,r.z],[-r.x,-r.y,-r.z],[r.x,-r.y,-r.z],[r.x,r.y,-r.z],[-r.x,r.y,-r.z],[r.x,-r.y,r.z]];for(let o=0;o<s.length;o++)fh.set(s[o][0],s[o][1],s[o][2]),t.vmult(fh,fh),e.vadd(fh,fh),i(fh.x,fh.y,fh.z)}calculateWorldAABB(e,t,i,r){const s=this.halfExtents;iu[0].set(s.x,s.y,s.z),iu[1].set(-s.x,s.y,s.z),iu[2].set(-s.x,-s.y,s.z),iu[3].set(-s.x,-s.y,-s.z),iu[4].set(s.x,-s.y,-s.z),iu[5].set(s.x,s.y,-s.z),iu[6].set(-s.x,s.y,-s.z),iu[7].set(s.x,-s.y,s.z);const o=iu[0];t.vmult(o,o),e.vadd(o,o),r.copy(o),i.copy(o);for(let a=1;a<8;a++){const l=iu[a];t.vmult(l,l),e.vadd(l,l);const c=l.x,u=l.y,h=l.z;c>r.x&&(r.x=c),u>r.y&&(r.y=u),h>r.z&&(r.z=h),c<i.x&&(i.x=c),u<i.y&&(i.y=u),h<i.z&&(i.z=h)}}}const fh=new ce,iu=[new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce];class pn extends class{constructor(){this._listeners=void 0}addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const i=this._listeners;return void 0===i[e]&&(i[e]=[]),i[e].includes(t)||i[e].push(t),this}hasEventListener(e,t){if(void 0===this._listeners)return!1;const i=this._listeners;return!(void 0===i[e]||!i[e].includes(t))}hasAnyEventListener(e){return void 0!==this._listeners&&void 0!==this._listeners[e]}removeEventListener(e,t){if(void 0===this._listeners)return this;const i=this._listeners;if(void 0===i[e])return this;const r=i[e].indexOf(t);return-1!==r&&i[e].splice(r,1),this}dispatchEvent(e){if(void 0===this._listeners)return this;const i=this._listeners[e.type];if(void 0!==i){e.target=this;for(let r=0,s=i.length;r<s;r++)i[r].call(this,e)}return this}}{constructor(e={}){super(),this.id=void 0,this.index=void 0,this.world=void 0,this.preStep=void 0,this.postStep=void 0,this.vlambda=void 0,this.collisionFilterGroup=void 0,this.collisionFilterMask=void 0,this.collisionResponse=void 0,this.position=void 0,this.previousPosition=void 0,this.interpolatedPosition=void 0,this.initPosition=void 0,this.velocity=void 0,this.initVelocity=void 0,this.force=void 0,this.mass=void 0,this.invMass=void 0,this.material=void 0,this.linearDamping=void 0,this.type=void 0,this.allowSleep=void 0,this.sleepState=void 0,this.sleepSpeedLimit=void 0,this.sleepTimeLimit=void 0,this.timeLastSleepy=void 0,this.wakeUpAfterNarrowphase=void 0,this.torque=void 0,this.quaternion=void 0,this.initQuaternion=void 0,this.previousQuaternion=void 0,this.interpolatedQuaternion=void 0,this.angularVelocity=void 0,this.initAngularVelocity=void 0,this.shapes=void 0,this.shapeOffsets=void 0,this.shapeOrientations=void 0,this.inertia=void 0,this.invInertia=void 0,this.invInertiaWorld=void 0,this.invMassSolve=void 0,this.invInertiaSolve=void 0,this.invInertiaWorldSolve=void 0,this.fixedRotation=void 0,this.angularDamping=void 0,this.linearFactor=void 0,this.angularFactor=void 0,this.aabb=void 0,this.aabbNeedsUpdate=void 0,this.boundingRadius=void 0,this.wlambda=void 0,this.isTrigger=void 0,this.id=pn.idCounter++,this.index=-1,this.world=null,this.preStep=null,this.postStep=null,this.vlambda=new ce,this.collisionFilterGroup="number"==typeof e.collisionFilterGroup?e.collisionFilterGroup:1,this.collisionFilterMask="number"==typeof e.collisionFilterMask?e.collisionFilterMask:-1,this.collisionResponse="boolean"!=typeof e.collisionResponse||e.collisionResponse,this.position=new ce,this.previousPosition=new ce,this.interpolatedPosition=new ce,this.initPosition=new ce,e.position&&(this.position.copy(e.position),this.previousPosition.copy(e.position),this.interpolatedPosition.copy(e.position),this.initPosition.copy(e.position)),this.velocity=new ce,e.velocity&&this.velocity.copy(e.velocity),this.initVelocity=new ce,this.force=new ce;const t="number"==typeof e.mass?e.mass:0;this.mass=t,this.invMass=t>0?1/t:0,this.material=e.material||null,this.linearDamping="number"==typeof e.linearDamping?e.linearDamping:.01,this.type=t<=0?pn.STATIC:pn.DYNAMIC,typeof e.type==typeof pn.STATIC&&(this.type=e.type),this.allowSleep=void 0===e.allowSleep||e.allowSleep,this.sleepState=pn.AWAKE,this.sleepSpeedLimit=void 0!==e.sleepSpeedLimit?e.sleepSpeedLimit:.1,this.sleepTimeLimit=void 0!==e.sleepTimeLimit?e.sleepTimeLimit:1,this.timeLastSleepy=0,this.wakeUpAfterNarrowphase=!1,this.torque=new ce,this.quaternion=new as,this.initQuaternion=new as,this.previousQuaternion=new as,this.interpolatedQuaternion=new as,e.quaternion&&(this.quaternion.copy(e.quaternion),this.initQuaternion.copy(e.quaternion),this.previousQuaternion.copy(e.quaternion),this.interpolatedQuaternion.copy(e.quaternion)),this.angularVelocity=new ce,e.angularVelocity&&this.angularVelocity.copy(e.angularVelocity),this.initAngularVelocity=new ce,this.shapes=[],this.shapeOffsets=[],this.shapeOrientations=[],this.inertia=new ce,this.invInertia=new ce,this.invInertiaWorld=new nu,this.invMassSolve=0,this.invInertiaSolve=new ce,this.invInertiaWorldSolve=new nu,this.fixedRotation=void 0!==e.fixedRotation&&e.fixedRotation,this.angularDamping=void 0!==e.angularDamping?e.angularDamping:.01,this.linearFactor=new ce(1,1,1),e.linearFactor&&this.linearFactor.copy(e.linearFactor),this.angularFactor=new ce(1,1,1),e.angularFactor&&this.angularFactor.copy(e.angularFactor),this.aabb=new cr,this.aabbNeedsUpdate=!0,this.boundingRadius=0,this.wlambda=new ce,this.isTrigger=Boolean(e.isTrigger),e.shape&&this.addShape(e.shape),this.updateMassProperties()}wakeUp(){const e=this.sleepState;this.sleepState=pn.AWAKE,this.wakeUpAfterNarrowphase=!1,e===pn.SLEEPING&&this.dispatchEvent(pn.wakeupEvent)}sleep(){this.sleepState=pn.SLEEPING,this.velocity.set(0,0,0),this.angularVelocity.set(0,0,0),this.wakeUpAfterNarrowphase=!1}sleepTick(e){if(this.allowSleep){const t=this.sleepState,i=this.velocity.lengthSquared()+this.angularVelocity.lengthSquared(),r=_r(this.sleepSpeedLimit,2);t===pn.AWAKE&&i<r?(this.sleepState=pn.SLEEPY,this.timeLastSleepy=e,this.dispatchEvent(pn.sleepyEvent)):t===pn.SLEEPY&&i>r?this.wakeUp():t===pn.SLEEPY&&e-this.timeLastSleepy>this.sleepTimeLimit&&(this.sleep(),this.dispatchEvent(pn.sleepEvent))}}updateSolveMassProperties(){this.sleepState===pn.SLEEPING||this.type===pn.KINEMATIC?(this.invMassSolve=0,this.invInertiaSolve.setZero(),this.invInertiaWorldSolve.setZero()):(this.invMassSolve=this.invMass,this.invInertiaSolve.copy(this.invInertia),this.invInertiaWorldSolve.copy(this.invInertiaWorld))}pointToLocalFrame(e,t=new ce){return e.vsub(this.position,t),this.quaternion.conjugate().vmult(t,t),t}vectorToLocalFrame(e,t=new ce){return this.quaternion.conjugate().vmult(e,t),t}pointToWorldFrame(e,t=new ce){return this.quaternion.vmult(e,t),t.vadd(this.position,t),t}vectorToWorldFrame(e,t=new ce){return this.quaternion.vmult(e,t),t}addShape(e,t,i){const r=new ce,s=new as;return t&&r.copy(t),i&&s.copy(i),this.shapes.push(e),this.shapeOffsets.push(r),this.shapeOrientations.push(s),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,e.body=this,this}removeShape(e){const t=this.shapes.indexOf(e);return-1===t?(console.warn("Shape does not belong to the body"),this):(this.shapes.splice(t,1),this.shapeOffsets.splice(t,1),this.shapeOrientations.splice(t,1),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,e.body=null,this)}updateBoundingRadius(){const e=this.shapes,t=this.shapeOffsets,i=e.length;let r=0;for(let s=0;s!==i;s++){const o=e[s];o.updateBoundingSphereRadius();const a=t[s].length(),l=o.boundingSphereRadius;a+l>r&&(r=a+l)}this.boundingRadius=r}updateAABB(){const e=this.shapes,t=this.shapeOffsets,i=this.shapeOrientations,r=e.length,s=p_e,o=g_e,a=this.quaternion,l=this.aabb,c=m_e;for(let u=0;u!==r;u++){const h=e[u];a.vmult(t[u],s),s.vadd(this.position,s),a.mult(i[u],o),h.calculateWorldAABB(s,o,c.lowerBound,c.upperBound),0===u?l.copy(c):l.extend(c)}this.aabbNeedsUpdate=!1}updateInertiaWorld(e){const t=this.invInertia;if(t.x!==t.y||t.y!==t.z||e){const i=__e,r=y_e;i.setRotationFromQuaternion(this.quaternion),i.transpose(r),i.scale(t,i),i.mmult(r,this.invInertiaWorld)}}applyForce(e,t=new ce){if(this.type!==pn.DYNAMIC)return;this.sleepState===pn.SLEEPING&&this.wakeUp();const i=v_e;t.cross(e,i),this.force.vadd(e,this.force),this.torque.vadd(i,this.torque)}applyLocalForce(e,t=new ce){if(this.type!==pn.DYNAMIC)return;const i=b_e,r=w_e;this.vectorToWorldFrame(e,i),this.vectorToWorldFrame(t,r),this.applyForce(i,r)}applyTorque(e){this.type===pn.DYNAMIC&&(this.sleepState===pn.SLEEPING&&this.wakeUp(),this.torque.vadd(e,this.torque))}applyImpulse(e,t=new ce){if(this.type!==pn.DYNAMIC)return;this.sleepState===pn.SLEEPING&&this.wakeUp();const i=t,r=E_e;r.copy(e),r.scale(this.invMass,r),this.velocity.vadd(r,this.velocity);const s=S_e;i.cross(e,s),this.invInertiaWorld.vmult(s,s),this.angularVelocity.vadd(s,this.angularVelocity)}applyLocalImpulse(e,t=new ce){if(this.type!==pn.DYNAMIC)return;const i=x_e,r=C_e;this.vectorToWorldFrame(e,i),this.vectorToWorldFrame(t,r),this.applyImpulse(i,r)}updateMassProperties(){const e=T_e;this.invMass=this.mass>0?1/this.mass:0;const t=this.inertia,i=this.fixedRotation;this.updateAABB(),e.set((this.aabb.upperBound.x-this.aabb.lowerBound.x)/2,(this.aabb.upperBound.y-this.aabb.lowerBound.y)/2,(this.aabb.upperBound.z-this.aabb.lowerBound.z)/2),ix.calculateInertia(e,this.mass,t),this.invInertia.set(t.x>0&&!i?1/t.x:0,t.y>0&&!i?1/t.y:0,t.z>0&&!i?1/t.z:0),this.updateInertiaWorld(!0)}getVelocityAtWorldPoint(e,t){const i=new ce;return e.vsub(this.position,i),this.angularVelocity.cross(i,t),this.velocity.vadd(t,t),t}integrate(e,t,i){if(this.previousPosition.copy(this.position),this.previousQuaternion.copy(this.quaternion),this.type!==pn.DYNAMIC&&this.type!==pn.KINEMATIC||this.sleepState===pn.SLEEPING)return;const r=this.velocity,s=this.angularVelocity,o=this.position,a=this.force,l=this.torque,c=this.quaternion,h=this.invInertiaWorld,f=this.linearFactor,g=this.invMass*e;r.x+=a.x*g*f.x,r.y+=a.y*g*f.y,r.z+=a.z*g*f.z;const m=h.elements,w=this.angularFactor,S=l.x*w.x,U=l.y*w.y,D=l.z*w.z;s.x+=e*(m[0]*S+m[1]*U+m[2]*D),s.y+=e*(m[3]*S+m[4]*U+m[5]*D),s.z+=e*(m[6]*S+m[7]*U+m[8]*D),o.x+=r.x*e,o.y+=r.y*e,o.z+=r.z*e,c.integrate(this.angularVelocity,e,this.angularFactor,c),t&&(i?c.normalizeFast():c.normalize()),this.aabbNeedsUpdate=!0,this.updateInertiaWorld()}}pn.idCounter=0,pn.COLLIDE_EVENT_NAME="collide",pn.DYNAMIC=1,pn.STATIC=2,pn.KINEMATIC=4,pn.AWAKE=0,pn.SLEEPY=1,pn.SLEEPING=2,pn.wakeupEvent={type:"wakeup"},pn.sleepyEvent={type:"sleepy"},pn.sleepEvent={type:"sleep"};const p_e=new ce,g_e=new as,m_e=new cr,__e=new nu,y_e=new nu,v_e=new ce,b_e=new ce,w_e=new ce,E_e=new ce,S_e=new ce,x_e=new ce,C_e=new ce,T_e=new ce;new ce,new ce;class rx{constructor(){this.rayFromWorld=void 0,this.rayToWorld=void 0,this.hitNormalWorld=void 0,this.hitPointWorld=void 0,this.hasHit=void 0,this.shape=void 0,this.body=void 0,this.hitFaceIndex=void 0,this.distance=void 0,this.shouldStop=void 0,this.rayFromWorld=new ce,this.rayToWorld=new ce,this.hitNormalWorld=new ce,this.hitPointWorld=new ce,this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}reset(){this.rayFromWorld.setZero(),this.rayToWorld.setZero(),this.hitNormalWorld.setZero(),this.hitPointWorld.setZero(),this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}abort(){this.shouldStop=!0}set(e,t,i,r,s,o,a){this.rayFromWorld.copy(e),this.rayToWorld.copy(t),this.hitNormalWorld.copy(i),this.hitPointWorld.copy(r),this.shape=s,this.body=o,this.distance=a}}let kH,BH,VH,jH,UH,zH,HH;kH=fn.types.SPHERE,BH=fn.types.PLANE,VH=fn.types.BOX,jH=fn.types.CYLINDER,UH=fn.types.CONVEXPOLYHEDRON,zH=fn.types.HEIGHTFIELD,HH=fn.types.TRIMESH;class gs{get[kH](){return this._intersectSphere}get[BH](){return this._intersectPlane}get[VH](){return this._intersectBox}get[jH](){return this._intersectConvex}get[UH](){return this._intersectConvex}get[zH](){return this._intersectHeightfield}get[HH](){return this._intersectTrimesh}constructor(e=new ce,t=new ce){this.from=void 0,this.to=void 0,this.direction=void 0,this.precision=void 0,this.checkCollisionResponse=void 0,this.skipBackfaces=void 0,this.collisionFilterMask=void 0,this.collisionFilterGroup=void 0,this.mode=void 0,this.result=void 0,this.hasHit=void 0,this.callback=void 0,this.from=e.clone(),this.to=t.clone(),this.direction=new ce,this.precision=1e-4,this.checkCollisionResponse=!0,this.skipBackfaces=!1,this.collisionFilterMask=-1,this.collisionFilterGroup=-1,this.mode=gs.ANY,this.result=new rx,this.hasHit=!1,this.callback=i=>{}}intersectWorld(e,t){return this.mode=t.mode||gs.ANY,this.result=t.result||new rx,this.skipBackfaces=!!t.skipBackfaces,this.collisionFilterMask=void 0!==t.collisionFilterMask?t.collisionFilterMask:-1,this.collisionFilterGroup=void 0!==t.collisionFilterGroup?t.collisionFilterGroup:-1,this.checkCollisionResponse=void 0===t.checkCollisionResponse||t.checkCollisionResponse,t.from&&this.from.copy(t.from),t.to&&this.to.copy(t.to),this.callback=t.callback||(()=>{}),this.hasHit=!1,this.result.reset(),this.updateDirection(),this.getAABB(GH),GR.length=0,e.broadphase.aabbQuery(e,GH,GR),this.intersectBodies(GR),this.hasHit}intersectBody(e,t){t&&(this.result=t,this.updateDirection());const i=this.checkCollisionResponse;if(i&&!e.collisionResponse||0==(this.collisionFilterGroup&e.collisionFilterMask)||0==(e.collisionFilterGroup&this.collisionFilterMask))return;const r=N_e,s=P_e;for(let o=0,a=e.shapes.length;o<a;o++){const l=e.shapes[o];if((!i||l.collisionResponse)&&(e.quaternion.mult(e.shapeOrientations[o],s),e.quaternion.vmult(e.shapeOffsets[o],r),r.vadd(e.position,r),this.intersectShape(l,s,r,e),this.result.shouldStop))break}}intersectBodies(e,t){t&&(this.result=t,this.updateDirection());for(let i=0,r=e.length;!this.result.shouldStop&&i<r;i++)this.intersectBody(e[i])}updateDirection(){this.to.vsub(this.from,this.direction),this.direction.normalize()}intersectShape(e,t,i,r){if(function(n,e,t){t.vsub(n,Ff);const i=Ff.dot(e);return e.scale(i,ox),ox.vadd(n,ox),t.distanceTo(ox)}(this.from,this.direction,i)>e.boundingSphereRadius)return;const a=this[e.type];a&&a.call(this,e,t,i,r,e)}_intersectBox(e,t,i,r,s){return this._intersectConvex(e.convexPolyhedronRepresentation,t,i,r,s)}_intersectPlane(e,t,i,r,s){const o=this.from,a=this.to,l=this.direction,c=new ce(0,0,1);t.vmult(c,c);const u=new ce;o.vsub(i,u);const h=u.dot(c);if(a.vsub(i,u),h*u.dot(c)>0||o.distanceTo(a)<h)return;const g=c.dot(l);if(Math.abs(g)<this.precision)return;const m=new ce,w=new ce,S=new ce;o.vsub(i,m);const U=-c.dot(m)/g;l.scale(U,w),o.vadd(w,S),this.reportIntersection(c,S,s,r,-1)}getAABB(e){const{lowerBound:t,upperBound:i}=e,r=this.to,s=this.from;t.x=Math.min(r.x,s.x),t.y=Math.min(r.y,s.y),t.z=Math.min(r.z,s.z),i.x=Math.max(r.x,s.x),i.y=Math.max(r.y,s.y),i.z=Math.max(r.z,s.z)}_intersectHeightfield(e,t,i,r,s){const o=F_e;o.from.copy(this.from),o.to.copy(this.to),Vi.pointToLocalFrame(i,t,o.from,o.from),Vi.pointToLocalFrame(i,t,o.to,o.to),o.updateDirection();const a=L_e;let l,c,u,h;l=c=0,u=h=e.data.length-1;const f=new cr;o.getAABB(f),e.getIndexOfPosition(f.lowerBound.x,f.lowerBound.y,a,!0),l=Math.max(l,a[0]),c=Math.max(c,a[1]),e.getIndexOfPosition(f.upperBound.x,f.upperBound.y,a,!0),u=Math.min(u,a[0]+1),h=Math.min(h,a[1]+1);for(let g=l;g<u;g++)for(let m=c;m<h;m++){if(this.result.shouldStop)return;if(e.getAabbAtIndex(g,m,f),f.overlapsRay(o)){if(e.getConvexTrianglePillar(g,m,!1),Vi.pointToWorldFrame(i,t,e.pillarOffset,sx),this._intersectConvex(e.pillarConvex,t,sx,r,s,$H),this.result.shouldStop)return;e.getConvexTrianglePillar(g,m,!0),Vi.pointToWorldFrame(i,t,e.pillarOffset,sx),this._intersectConvex(e.pillarConvex,t,sx,r,s,$H)}}}_intersectSphere(e,t,i,r,s){const o=this.from,a=this.to,l=e.radius,c=_r(a.x-o.x,2)+_r(a.y-o.y,2)+_r(a.z-o.z,2),u=2*((a.x-o.x)*(o.x-i.x)+(a.y-o.y)*(o.y-i.y)+(a.z-o.z)*(o.z-i.z)),h=_r(o.x-i.x,2)+_r(o.y-i.y,2)+_r(o.z-i.z,2)-_r(l,2),f=_r(u,2)-4*c*h,g=k_e,m=B_e;if(!(f<0))if(0===f)o.lerp(a,f,g),g.vsub(i,m),m.normalize(),this.reportIntersection(m,g,s,r,-1);else{const w=(-u-Math.sqrt(f))/(2*c),S=(-u+Math.sqrt(f))/(2*c);if(w>=0&&w<=1&&(o.lerp(a,w,g),g.vsub(i,m),m.normalize(),this.reportIntersection(m,g,s,r,-1)),this.result.shouldStop)return;S>=0&&S<=1&&(o.lerp(a,S,g),g.vsub(i,m),m.normalize(),this.reportIntersection(m,g,s,r,-1))}}_intersectConvex(e,t,i,r,s,o){const a=V_e,l=WH,c=o&&o.faceList||null,u=e.faces,h=e.vertices,f=e.faceNormals,g=this.direction,m=this.from,S=m.distanceTo(this.to),U=c?c.length:u.length,D=this.result;for(let ie=0;!D.shouldStop&&ie<U;ie++){const _e=c?c[ie]:ie,Ne=u[_e],Pe=f[_e],Ve=t,vt=i;l.copy(h[Ne[0]]),Ve.vmult(l,l),l.vadd(vt,l),l.vsub(m,l),Ve.vmult(Pe,a);const wt=g.dot(a);if(Math.abs(wt)<this.precision)continue;const xt=a.dot(l)/wt;if(!(xt<0)){g.scale(xt,fa),fa.vadd(m,fa),uc.copy(h[Ne[0]]),Ve.vmult(uc,uc),vt.vadd(uc,uc);for(let kt=1;!D.shouldStop&&kt<Ne.length-1;kt++){ru.copy(h[Ne[kt]]),su.copy(h[Ne[kt+1]]),Ve.vmult(ru,ru),Ve.vmult(su,su),vt.vadd(ru,ru),vt.vadd(su,su);const $t=fa.distanceTo(m);!gs.pointInTriangle(fa,uc,ru,su)&&!gs.pointInTriangle(fa,ru,uc,su)||$t>S||this.reportIntersection(a,fa,s,r,_e)}}}}_intersectTrimesh(e,t,i,r,s,o){const a=j_e,l=W_e,c=q_e,u=WH,h=U_e,f=z_e,g=H_e,m=$_e,w=G_e,S=e.indices,U=this.from,D=this.to,ie=this.direction;c.position.copy(i),c.quaternion.copy(t),Vi.vectorToLocalFrame(i,t,ie,h),Vi.pointToLocalFrame(i,t,U,f),Vi.pointToLocalFrame(i,t,D,g),g.x*=e.scale.x,g.y*=e.scale.y,g.z*=e.scale.z,f.x*=e.scale.x,f.y*=e.scale.y,f.z*=e.scale.z,g.vsub(f,h),h.normalize();const _e=f.distanceSquared(g);e.tree.rayQuery(this,c,l);for(let Ne=0,Pe=l.length;!this.result.shouldStop&&Ne!==Pe;Ne++){const Ve=l[Ne];e.getNormal(Ve,a),e.getVertex(S[3*Ve],uc),uc.vsub(f,u);const vt=h.dot(a),wt=a.dot(u)/vt;if(wt<0)continue;h.scale(wt,fa),fa.vadd(f,fa),e.getVertex(S[3*Ve+1],ru),e.getVertex(S[3*Ve+2],su);const xt=fa.distanceSquared(f);!gs.pointInTriangle(fa,ru,uc,su)&&!gs.pointInTriangle(fa,uc,ru,su)||xt>_e||(Vi.vectorToWorldFrame(t,a,w),Vi.pointToWorldFrame(i,t,fa,m),this.reportIntersection(w,m,s,r,Ve))}l.length=0}reportIntersection(e,t,i,r,s){const o=this.from,a=this.to,l=o.distanceTo(t),c=this.result;if(!(this.skipBackfaces&&e.dot(this.direction)>0))switch(c.hitFaceIndex=void 0!==s?s:-1,this.mode){case gs.ALL:this.hasHit=!0,c.set(o,a,e,t,i,r,l),c.hasHit=!0,this.callback(c);break;case gs.CLOSEST:(l<c.distance||!c.hasHit)&&(this.hasHit=!0,c.hasHit=!0,c.set(o,a,e,t,i,r,l));break;case gs.ANY:this.hasHit=!0,c.hasHit=!0,c.set(o,a,e,t,i,r,l),c.shouldStop=!0}}static pointInTriangle(e,t,i,r){r.vsub(t,Ff),i.vsub(t,J0),e.vsub(t,$R);const s=Ff.dot(Ff),o=Ff.dot(J0),a=Ff.dot($R),l=J0.dot(J0),c=J0.dot($R);let u,h;return(u=l*a-o*c)>=0&&(h=s*c-o*a)>=0&&u+h<s*l-o*o}}gs.CLOSEST=1,gs.ANY=2,gs.ALL=4;const GH=new cr,GR=[],J0=new ce,$R=new ce,N_e=new ce,P_e=new as,fa=new ce,uc=new ce,ru=new ce,su=new ce,$H={faceList:[0]},sx=new ce,F_e=new gs,L_e=[],k_e=new ce,B_e=new ce,V_e=new ce,WH=new ce,j_e=new ce,U_e=new ce,z_e=new ce,H_e=new ce,G_e=new ce,$_e=new ce;new cr;const W_e=[],q_e=new Vi,Ff=new ce,ox=new ce;let a8,l8,c8,u8,d8,h8,f8,p8,g8,m8,_8,y8,v8,b8,w8,E8,S8,x8,C8,T8,A8,M8,D8,I8,O8;new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new gs,new ce,new ce,new ce(1,0,0),new ce(0,1,0),new ce(0,0,1),new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new cr,new ce,new cr,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new cr,new ce,new Vi,new cr;const Cr={sphereSphere:fn.types.SPHERE,spherePlane:fn.types.SPHERE|fn.types.PLANE,boxBox:fn.types.BOX|fn.types.BOX,sphereBox:fn.types.SPHERE|fn.types.BOX,planeBox:fn.types.PLANE|fn.types.BOX,convexConvex:fn.types.CONVEXPOLYHEDRON,sphereConvex:fn.types.SPHERE|fn.types.CONVEXPOLYHEDRON,planeConvex:fn.types.PLANE|fn.types.CONVEXPOLYHEDRON,boxConvex:fn.types.BOX|fn.types.CONVEXPOLYHEDRON,sphereHeightfield:fn.types.SPHERE|fn.types.HEIGHTFIELD,boxHeightfield:fn.types.BOX|fn.types.HEIGHTFIELD,convexHeightfield:fn.types.CONVEXPOLYHEDRON|fn.types.HEIGHTFIELD,sphereParticle:fn.types.PARTICLE|fn.types.SPHERE,planeParticle:fn.types.PLANE|fn.types.PARTICLE,boxParticle:fn.types.BOX|fn.types.PARTICLE,convexParticle:fn.types.PARTICLE|fn.types.CONVEXPOLYHEDRON,cylinderCylinder:fn.types.CYLINDER,sphereCylinder:fn.types.SPHERE|fn.types.CYLINDER,planeCylinder:fn.types.PLANE|fn.types.CYLINDER,boxCylinder:fn.types.BOX|fn.types.CYLINDER,convexCylinder:fn.types.CONVEXPOLYHEDRON|fn.types.CYLINDER,heightfieldCylinder:fn.types.HEIGHTFIELD|fn.types.CYLINDER,particleCylinder:fn.types.PARTICLE|fn.types.CYLINDER,sphereTrimesh:fn.types.SPHERE|fn.types.TRIMESH,planeTrimesh:fn.types.PLANE|fn.types.TRIMESH};a8=Cr.sphereSphere,l8=Cr.spherePlane,c8=Cr.boxBox,u8=Cr.sphereBox,d8=Cr.planeBox,h8=Cr.convexConvex,f8=Cr.sphereConvex,p8=Cr.planeConvex,g8=Cr.boxConvex,m8=Cr.sphereHeightfield,_8=Cr.boxHeightfield,y8=Cr.convexHeightfield,v8=Cr.sphereParticle,b8=Cr.planeParticle,w8=Cr.boxParticle,E8=Cr.convexParticle,S8=Cr.cylinderCylinder,x8=Cr.sphereCylinder,C8=Cr.planeCylinder,T8=Cr.boxCylinder,A8=Cr.convexCylinder,M8=Cr.heightfieldCylinder,D8=Cr.particleCylinder,I8=Cr.sphereTrimesh,O8=Cr.planeTrimesh,new ce,new ce,new ce,new ce,new ce,new as,new as,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new cr,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new as,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new cr,new gs;const qs=globalThis.performance||{};if(!qs.now){let n=Date.now();qs.timing&&qs.timing.navigationStart&&(n=qs.timing.navigationStart),qs.now=()=>Date.now()-n}var Vf=et(4517);class Nr extends oe{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return t&&!t.closed&&e.next(this._value),t}getValue(){if(this.hasError)throw this.thrownError;if(this.closed)throw new $;return this._value}next(e){super.next(this._value=e)}}function lm(n,e,t){e||(e=new Gn(Gn.IDENTITY));const i=new Gn(Gn.IDENTITY);if(!n)return!0;if(n.matrix)i.copy(n.matrix);else{if(i.identity(),n.translation&&i.translate(n.translation),n.rotation){const s=new Gn(Gn.IDENTITY).fromQuaternion(n.rotation);i.multiplyRight(s)}n.scale&&i.scale(n.scale)}const r=new Gn(e).multiplyRight(i);if(!1===t(n,r,e))return!1;for(const s of n.nodes||n.children||[])if(!1===lm(s,r,t))return!1;return!0}function k8(){uz([lH,rm])}function B8(n,e){var t;const i=null===(t=e.nodes)||void 0===t?void 0:t.find(r=>r.name===n);if(i){let r=!1;for(const s of e.scenes)r||lm(s,new Gn(Gn.IDENTITY),(o,a)=>o!==i||(o.matrix=a,o.translation=void 0,o.rotation=void 0,o.scale=void 0,r=!0,!1));return e.scene={id:n,name:n,nodes:[i]},e.scenes=[e.scene],{scene:e.scene,scenes:e.scenes}}return e}function YR(n,e){return Pi(this,void 0,void 0,function*(){const t=n.scenegraph;let i;i=e?e[t]||(e[t]=fetch(t).then(s=>s.blob())):fetch(t);const r=yield NS(i,rm,{DracoLoader:vR,gltf:{decompressMeshes:!0,postProcess:!0}});return r.nodes||console.log("WARNING: Empty Scene",t,r),B8(n.scenegraphNode,r)})}function Yve(n,e){return Pi(this,void 0,void 0,function*(){return B8(n,yield e)})}function KR(n,e,t){if(e&&0!==e.length){let i;switch(t.geometry){case"sphere":i=new qme;break;case"cone":i=new Qme;break;case"cylinder":i=new Zme;break;case"cube":default:i=new r_e}return new Ipe(Object.assign({id:n,pickable:!0,autoHighlight:!1,highlightColor:[30,136,229,255],coordinateSystem:Fi.CARTESIAN,data:e,mesh:i,wireframe:!1,getTransformMatrix:r=>r.transformMatrix,getColor:r=>r.color||[255,255,255,229.5]},t))}}function V8(n,e,t){if(e&&0!==e.length)return new bpe(Object.assign({id:n,pickable:!0,data:e.map(i=>Object.assign(Object.assign({},i),{position:new Gn(i.transformMatrix).getTranslation()})),getText:i=>i.text,getPosition:i=>i.position,getColor:i=>i.color},t))}let Xve=(()=>{class n extends mz{initializeState(){const{data:t}=this.props;this.setState({data:null!=t?t:[],zoomOpacity:.8,doCollisions:!1}),k8()}renderLayers(){var t,i;const r=this.state,s={sphere:[],cone:[],cylinder:[],cube:[],text:[],wireframe:[],scenegraph:[]};for(const l of r.data){const c=null!==(t=l.geometry)&&void 0!==t?t:"cube";l.scenegraph?s.scenegraph.push(l):void 0!==s[c]&&s[c].push(l)}const o={};for(const l of s.scenegraph)l.scenegraph&&l.scenegraphNode&&!Object.prototype.hasOwnProperty.call(o,l.scenegraph)&&(o[l.scenegraph]=YR({scenegraph:l.scenegraph},n.gltfCache));const a=[];for(const[l,c]of Object.entries(s))if("scenegraph"===l)for(const u of c)a.push(new Wme({id:"models-"+u["@id"],opacity:u.zoomBasedOpacity?r.zoomOpacity:void 0!==u.opacity?u.opacity:1,pickable:!u.unpickable,coordinateSystem:Fi.CARTESIAN,data:[u],scenegraph:u.scenegraphNode?Yve(u.scenegraphNode,o[u.scenegraph]):u.scenegraph,_lighting:u._lighting,getTransformMatrix:u.transformMatrix,getColor:null!==(i=u.color)&&void 0!==i?i:[0,255,0,127.5],parameters:{depthMask:!u.zoomBasedOpacity&&(void 0===u.opacity||1===u.opacity)}}));else"text"===l?(a.push(V8("text",c.filter(u=>u.unpickable),{pickable:!1})),a.push(V8("textPickable",c.filter(u=>!u.unpickable),{pickable:!0}))):"wireframe"===l?a.push(KR(l,c,{wireframe:!0,pickable:!1,geometry:l})):(a.push(KR(l,c.filter(u=>u.unpickable),{wireframe:!1,pickable:!1,geometry:l})),a.push(KR(`${l}Pickable`,c.filter(u=>!u.unpickable),{wireframe:!1,pickable:!0,geometry:l})));return r.doCollisions&&function(n){Pi(this,void 0,void 0,function*(){console.log("Starting Collisioning");const e=n.filter(o=>!o.scenegraph&&"wireframe"!==o.geometry).map(o=>{const a=new Gn(o.transformMatrix),l=a.transformAsPoint([-1,-1,-1],[]),c=a.transformAsPoint([1,1,1],[]);return{"@id":o["@id"],name:o.tooltip,entityId:o.entityId,bbox:new cr({lowerBound:new ce(...l.map((u,h)=>Math.min(u,c[h]))),upperBound:new ce(...c.map((u,h)=>Math.max(u,l[h])))})}}),t=[];for(const o of n.filter(a=>!!a.scenegraph)){const a=yield V0(o.scenegraph,rm,{DracoLoader:vR,decompress:!0,postProcess:!0});for(const l of a.scenes)lm(l,new Gn(o.transformMatrix),(c,u)=>{if(c.mesh&&c.mesh.primitives&&c.mesh.primitives.length>0)for(const h of c.mesh.primitives)if(h.attributes.POSITION&&h.attributes.POSITION.min){const f=u.transformAsPoint(h.attributes.POSITION.min,[]),g=u.transformAsPoint(h.attributes.POSITION.max,[]);t.push({"@id":o["@id"],name:c.name,entityId:o.entityId,bbox:new cr({lowerBound:new ce(...f.map((m,w)=>Math.min(m,g[w]))),upperBound:new ce(...g.map((m,w)=>Math.max(m,f[w])))}),gltf:a})}return!0})}const i=[],r=[];for(const o of e){const a=[];for(const l of t)o.bbox.overlaps(l.bbox)&&a.push({"@id":l["@id"],name:l.name});a.length>0?i.push({"@id":o.entityId,name:o.name,hits:a}):r.push(o)}console.log({sourceBoxes:e,targetBoxes:t,report:i,sad:r,maxHits:Math.max(...i.map(o=>o.hits.length))});const s=[];for(const o of i){s.push({"Tissue ID":o["@id"],"Tissue Name":o.name,"Hit ID":"","Hit Name":""});for(const a of o.hits)s.push({"Tissue ID":o["@id"],"Tissue Name":o.name,"Hit ID":a["@id"],"Hit Name":a.name})}return console.log(s),i})}(r.data),a.filter(l=>!!l)}getPickingInfo(t){return t.info}}return n.layerName="BodyUILayer",n.gltfCache={},n})();function j8(n,e=[]){for(const t of n.nodes||n.children||[])e.push(t.name),j8(t,e);return e}let Zve=(()=>{class n{constructor(t){var i,r,s,o,a;this.deckProps=t,this.bodyUILayer=new Xve({}),this.nodeClickSubject=new oe,this.nodeHoverStartSubject=new oe,this.nodeHoverStopSubject=new oe,this.sceneRotationSubject=new Nr([0,0]),this.nodeDragStartSubject=new oe,this.nodeDragSubject=new oe,this.nodeDragEndSubject=new oe,this.nodeClick$=this.nodeClickSubject.pipe(ys()),this.nodeHoverStart$=this.nodeHoverStartSubject.pipe(ys()),this.nodeHoverStop$=this.nodeHoverStopSubject.pipe(ys()),this.sceneRotation$=this.sceneRotationSubject.pipe(ys()),this.nodeDragStart$=this.nodeDragStartSubject.pipe(ys()),this.nodeDrag$=this.nodeDragSubject.pipe(ys()),this.nodeDragEnd$=this.nodeDragEndSubject.pipe(ys());const l=Object.assign(Object.assign({},t),{views:["orthographic"===t.camera?new nde({flipY:!1,near:-1e3}):new sde({orbitAxis:"Y"})],controller:void 0===t.interactive||t.interactive,layers:[this.bodyUILayer],onHover:this._onHover,onClick:this._onClick,onViewStateChange:this._onViewStateChange,onDragStart:this._onDragStart,onDrag:this._onDrag,onDragEnd:this._onDragEnd,getCursor:c=>{var u;return null!==(u=this.cursor)&&void 0!==u?u:c.isDragging?"grabbing":"grab"}});t.legacyLighting&&(l.effects=[new PO({ambientLight:new wz({color:[255,255,255],intensity:10})})]),this.deck=new GS(l),this.deck.setProps({viewState:{orbitAxis:"Y",minRotationX:null!==(i=t.minRotationX)&&void 0!==i?i:-15,maxRotationX:null!==(r=t.maxRotationX)&&void 0!==r?r:15,target:null!==(s=t.target)&&void 0!==s?s:[.5,.5,0],rotationX:0,rotationOrbit:null!==(o=t.rotation)&&void 0!==o?o:0,zoom:null!==(a=t.zoom)&&void 0!==a?a:9.5,camera:t.camera}}),t.rotation&&this.sceneRotationSubject.next([t.rotation,0])}initialize(){return Pi(this,void 0,void 0,function*(){for(;!this.bodyUILayer.state;)yield new Promise(t=>{setTimeout(t,200)})})}finalize(){this.deck.finalize()}setScene(t){if((null==t?void 0:t.length)>0){let i=this.bodyUILayer.state.zoomOpacity,r=!1;for(const s of t)s.zoomToOnLoad&&(this.zoomTo(s),r=!0);i=r?.05:i,this.deckProps.debugSceneNodeProcessing?this.debugSceneNodeProcessing(t,i):this.bodyUILayer.setState({data:t,zoomOpacity:i})}}debugSceneNodeProcessing(t,i){const r="https://hubmapconsortium.github.io/ccf-3d-reference-object-library/VH_Female/United/VHF_United_Color.glb",s=new Gn([.076,0,0,0,0,.076,16875389974302382e-33,0,0,-16875389974302382e-33,.076,0,.49,.034,.11,1]);(function(n,e,t){return Pi(this,void 0,void 0,function*(){k8();const i=yield YR({scenegraph:n,scenegraphNode:"VHF_Kidney_L_Low1"}),r={},s=[];for(const o of i.scenes)lm(o,e=new Gn(e||Gn.IDENTITY),(a,l)=>{const c={"@id":a.name||a.id,"@type":"ProcessedNode",transformMatrix:new Gn(l),geometry:"wireframe",node:a};if(s.push({"@id":`GLTF:${c["@id"]}`,"@type":"GLTFNode",scenegraph:n,scenegraphNode:c["@id"],transformMatrix:new Gn(e||Gn.IDENTITY),tooltip:a.name||a.id,color:[255,255,255,255],_lighting:"pbr",zoomBasedOpacity:!0,node:a}),a.mesh&&a.mesh.primitives&&a.mesh.primitives.length>0)for(const u of a.mesh.primitives)if(u.attributes.POSITION&&u.attributes.POSITION.min){const h=l.transformAsPoint(u.attributes.POSITION.min,[]),f=l.transformAsPoint(u.attributes.POSITION.max,[]);c.bbox=new cr({lowerBound:new ce(...h.map((g,m)=>Math.min(g,f[m]))),upperBound:new ce(...f.map((g,m)=>Math.max(g,h[m])))})}return r[c["@id"]]=c,!0});for(const o of Object.values(r).filter(a=>!a.bbox)){for(const a of j8(o.node).map(l=>r[l]).filter(l=>l.bbox))o.bbox?o.bbox.extend(a.bbox):o.bbox=a.bbox.clone();o.bbox||delete r[o["@id"]]}for(const o of Object.values(r)){const a=o.bbox.lowerBound,u=(o.size=o.bbox.upperBound.clone().vsub(a)).clone().vmul(new ce(.5,.5,.5)),h=o.center=a.clone().vadd(u);o.transformMatrix=new Gn(Gn.IDENTITY).translate(h.toArray()).scale(u.toArray())}for(const o of s)r[o["@id"]]=o;return r})})(r,s).then(o=>{console.log("results",o),console.log("data",t),(t=t.concat(Object.values(o))).push({"@id":"TEST","@type":"TEST",scenegraph:r,scenegraphNode:"VHF_Kidney_R_Low",transformMatrix:s,color:[255,255,255,200],_lighting:"pbr",zoomBasedOpacity:!1}),this.bodyUILayer.setState({data:t,zoomOpacity:i})})}zoomTo(t){const i=new Gn(t.transformMatrix);this.deck.setProps({viewState:Object.assign(Object.assign({},this.deck.props.viewState),{target:i.getTranslation(),rotationX:0,rotationOrbit:0,zoom:11.5})})}setRotation(t){this.deck.setProps({viewState:Object.assign(Object.assign({},this.deck.props.viewState),{rotationOrbit:t})})}setRotationX(t){this.deck.setProps({viewState:Object.assign(Object.assign({},this.deck.props.viewState),{rotationX:t})})}setZoom(t){this.deck.setProps({viewState:Object.assign(Object.assign({},this.deck.props.viewState),{zoom:t})})}setTarget(t){this.deck.setProps({viewState:Object.assign(Object.assign({},this.deck.props.viewState),{target:t})})}setInteractive(t){this.deck.setProps({controller:t})}_onHover(t){const{lastHovered:i}=this;this.cursor=t.picked?"pointer":void 0,t.picked&&t.object&&t.object["@id"]?i!==t.object&&(i&&this.nodeHoverStopSubject.next(i),this.lastHovered=t.object,this.nodeHoverStartSubject.next(t.object)):i&&(this.nodeHoverStopSubject.next(i),this.lastHovered=void 0)}_onClick(t,i){var r,s;t.picked&&t.object&&t.object["@id"]&&this.nodeClickSubject.next({node:t.object,ctrlClick:null!==(s=null===(r=null==i?void 0:i.srcEvent)||void 0===r?void 0:r.ctrlKey)&&void 0!==s?s:void 0})}_onViewStateChange(t){var i;if(null===(i=t.interactionState)||void 0===i?void 0:i.isZooming){const r=this.bodyUILayer.state,s=Math.min(Math.max(1-(t.viewState.zoom-8.9)/2,.05),1);r.zoomOpacity!==s&&this.bodyUILayer.setState({data:r.data,zoomOpacity:s})}this.deck.setProps({viewState:Object.assign({},t.viewState)}),this.sceneRotationSubject.next([t.viewState.rotationOrbit,t.viewState.rotationX])}_onDragStart(t,i){this._dragEvent(t,i,this.nodeDragStartSubject)}_onDrag(t,i){this._dragEvent(t,i,this.nodeDragSubject)}_onDragEnd(t,i){this._dragEvent(t,i,this.nodeDragEndSubject)}_dragEvent(t,i,r){var s;(null===(s=null==t?void 0:t.object)||void 0===s?void 0:s["@id"])&&r.next({node:t.object,info:t,e:i})}}return Or([Vf.ZP],n.prototype,"_onHover",null),Or([Vf.ZP],n.prototype,"_onClick",null),Or([Vf.ZP],n.prototype,"_onViewStateChange",null),Or([Vf.ZP],n.prototype,"_onDragStart",null),Or([Vf.ZP],n.prototype,"_onDrag",null),Or([Vf.ZP],n.prototype,"_onDragEnd",null),n})();class U8 extends y{notifyNext(e,t,i,r,s){this.destination.next(t)}notifyError(e,t){this.destination.error(e)}notifyComplete(e){this.destination.complete()}}class Jve extends y{constructor(e,t,i){super(),this.parent=e,this.outerValue=t,this.outerIndex=i,this.index=0}_next(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)}_error(e){this.parent.notifyError(e,this),this.unsubscribe()}_complete(){this.parent.notifyComplete(this),this.unsubscribe()}}function z8(n,e,t,i,r=new Jve(n,t,i)){if(!r.closed)return e instanceof O?e.subscribe(r):Ae(e)(r)}const H8={};class G8{constructor(e){this.resultSelector=e}call(e,t){return t.subscribe(new ebe(e,this.resultSelector))}}class ebe extends U8{constructor(e,t){super(e),this.resultSelector=t,this.active=0,this.values=[],this.observables=[]}_next(e){this.values.push(H8),this.observables.push(e)}_complete(){const e=this.observables,t=e.length;if(0===t)this.destination.complete();else{this.active=t,this.toRespond=t;for(let i=0;i<t;i++)this.add(z8(this,e[i],void 0,i))}}notifyComplete(e){0==(this.active-=1)&&this.destination.complete()}notifyNext(e,t,i){const r=this.values,o=this.toRespond?r[i]===H8?--this.toRespond:this.toRespond:0;r[i]=t,0===o&&(this.resultSelector?this._tryResultSelector(r):this.destination.next(r.slice()))}_tryResultSelector(e){let t;try{t=this.resultSelector.apply(this,e)}catch(i){return void this.destination.error(i)}this.destination.next(t)}}function nbe(n,e){return n===e}function ibe(n,e,t){if(null===e||null===t||e.length!==t.length)return!1;const i=e.length;for(let r=0;r<i;r++)if(!n(e[r],t[r]))return!1;return!0}function $8(n,e=nbe){let t=null,i=null;function r(){return ibe(e,t,arguments)||(i=n.apply(null,arguments)),t=arguments,i}return r.reset=function(){t=null,i=null},r}const sbe=$8(function(){const n=JM();if(!n)return!1;const e=n.injector.get(N3,null);return!!e&&e.some(i=>(i&&i.providers||[]).some(s=>s&&s.provide&&"MockNgModuleResolver"===s.provide.name||!1))});let XR=(()=>{class n{constructor(){this.bootstrap$=new Sf(1)}get appBootstrapped$(){return this.bootstrap$.asObservable()}bootstrap(){this.bootstrap$.next(!0),this.bootstrap$.complete()}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const QR=new Gt("INITIAL_STATE_TOKEN");let obe=(()=>{class n{static set(t){this.value=t}static pop(){const t=this.value;return this.value={},t}}return n.value={},n})();const W8=new Gt("Internals.StateContextFactory"),q8=new Gt("Internals.StateFactory");function sv(...n){if(1===n.length){const e=n[0];if(F(e))return fx(e,null);if(Q(e)&&Object.getPrototypeOf(e)===Object.prototype){const t=Object.keys(e);return fx(t.map(i=>e[i]),t)}}if("function"==typeof n[n.length-1]){const e=n.pop();return fx(n=1===n.length&&F(n[0])?n[0]:n,null).pipe(me(t=>e(...t)))}return fx(n,null)}function fx(n,e){return new O(t=>{const i=n.length;if(0===i)return void t.complete();const r=new Array(i);let s=0,o=0;for(let a=0;a<i;a++){const l=je(n[a]);let c=!1;t.add(l.subscribe({next:u=>{c||(c=!0,o++),r[a]=u},error:u=>t.error(u),complete:()=>{s++,(s===i||!c)&&(o===i&&t.next(e?e.reduce((u,h,f)=>(u[h]=r[f],u),{}):r),t.complete())}}))}})}function qi(n,e){return function(i){return i.lift(new abe(n,e))}}class abe{constructor(e,t){this.predicate=e,this.thisArg=t}call(e,t){return t.subscribe(new lbe(e,this.predicate,this.thisArg))}}class lbe extends y{constructor(e,t,i){super(e),this.predicate=t,this.thisArg=i,this.count=0}_next(e){let t;try{t=this.predicate.call(this.thisArg,e,this.count++)}catch(i){return void this.destination.error(i)}t&&this.destination.next(e)}}function Va(n,e,t){let i;return i=n&&"object"==typeof n?n:{bufferSize:n,windowTime:e,refCount:!1,scheduler:t},r=>r.lift(function({bufferSize:n=Number.POSITIVE_INFINITY,windowTime:e=Number.POSITIVE_INFINITY,refCount:t,scheduler:i}){let r,o,s=0,a=!1,l=!1;return function(u){let h;s++,!r||a?(a=!1,r=new Sf(n,e,i),h=r.subscribe(this),o=u.subscribe({next(f){r.next(f)},error(f){a=!0,r.error(f)},complete(){l=!0,o=void 0,r.complete()}}),l&&(o=void 0)):h=r.subscribe(this),this.add(()=>{s--,h.unsubscribe(),h=void 0,o&&!l&&t&&0===s&&(o.unsubscribe(),o=void 0,r=void 0)})}}(i))}const Y8=(()=>{function n(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return n.prototype=Object.create(Error.prototype),n})();function zr(n){return e=>0===n?u0():e.lift(new ube(n))}class ube{constructor(e){if(this.total=e,this.total<0)throw new Y8}call(e,t){return t.subscribe(new dbe(e,this.total))}}class dbe extends y{constructor(e,t){super(e),this.total=t,this.count=0}_next(e){const t=this.total,i=++this.count;i<=t&&(this.destination.next(e),i===t&&(this.destination.complete(),this.unsubscribe()))}}function K8(n,e){return e?t=>t.pipe(K8((i,r)=>je(n(i,r)).pipe(me((s,o)=>e(i,s,r,o))))):t=>t.lift(new hbe(n))}class hbe{constructor(e){this.project=e}call(e,t){return t.subscribe(new fbe(e,this.project))}}class fbe extends we{constructor(e,t){super(e),this.project=t,this.hasSubscription=!1,this.hasCompleted=!1,this.index=0}_next(e){this.hasSubscription||this.tryNext(e)}tryNext(e){let t;const i=this.index++;try{t=this.project(e,i)}catch(r){return void this.destination.error(r)}this.hasSubscription=!0,this._innerSub(t)}_innerSub(e){const t=new _t(this),i=this.destination;i.add(t);const r=P(e,t);r!==t&&i.add(r)}_complete(){this.hasCompleted=!0,this.hasSubscription||this.destination.complete(),this.unsubscribe()}notifyNext(e){this.destination.next(e)}notifyError(e){this.destination.error(e)}notifyComplete(){this.hasSubscription=!1,this.hasCompleted&&this.destination.complete()}}function px(n=null){return e=>e.lift(new pbe(n))}class pbe{constructor(e){this.defaultValue=e}call(e,t){return t.subscribe(new gbe(e,this.defaultValue))}}class gbe extends y{constructor(e,t){super(e),this.defaultValue=t,this.isEmpty=!0}_next(e){this.isEmpty=!1,this.destination.next(e)}_complete(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()}}function hc(n){return function(t){const i=new mbe(n),r=t.lift(i);return i.caught=r}}class mbe{constructor(e){this.selector=e}call(e,t){return t.subscribe(new _be(e,this.selector,this.caught))}}class _be extends we{constructor(e,t,i){super(e),this.selector=t,this.caught=i}error(e){if(!this.isStopped){let t;try{t=this.selector(e,this.caught)}catch(s){return void super.error(s)}this._unsubscribeAndRecycle();const i=new _t(this);this.add(i);const r=P(t,i);r!==i&&this.add(r)}}}function ls(n){return e=>e.lift(new ybe(n))}class ybe{constructor(e){this.notifier=e}call(e,t){const i=new vbe(e),r=P(this.notifier,new _t(i));return r&&!i.seenValue?(i.add(r),t.subscribe(i)):i}}class vbe extends we{constructor(e){super(e),this.seenValue=!1}notifyNext(){this.seenValue=!0,this.complete()}notifyComplete(){}}function ph(){}function ur(n,e,t){return function(r){return r.lift(new bbe(n,e,t))}}class bbe{constructor(e,t,i){this.nextOrObserver=e,this.error=t,this.complete=i}call(e,t){return t.subscribe(new wbe(e,this.nextOrObserver,this.error,this.complete))}}class wbe extends y{constructor(e,t,i,r){super(e),this._tapNext=ph,this._tapError=ph,this._tapComplete=ph,this._tapError=i||ph,this._tapComplete=r||ph,Y(t)?(this._context=this,this._tapNext=t):t&&(this._context=t,this._tapNext=t.next||ph,this._tapError=t.error||ph,this._tapComplete=t.complete||ph)}_next(e){try{this._tapNext.call(this._context,e)}catch(t){return void this.destination.error(t)}this.destination.next(e)}_error(e){try{this._tapError.call(this._context,e)}catch(t){return void this.destination.error(t)}this.destination.error(e)}_complete(){try{this._tapComplete.call(this._context)}catch(e){return void this.destination.error(e)}return this.destination.complete()}}function ed(n,e){return t=>t.lift(new Ebe(n,e))}class Ebe{constructor(e,t){this.compare=e,this.keySelector=t}call(e,t){return t.subscribe(new Sbe(e,this.compare,this.keySelector))}}class Sbe extends y{constructor(e,t,i){super(e),this.keySelector=i,this.hasKey=!1,"function"==typeof t&&(this.compare=t)}compare(e,t){return e===t}_next(e){let t;try{const{keySelector:r}=this;t=r?r(e):e}catch(r){return this.destination.error(r)}let i=!1;if(this.hasKey)try{const{compare:r}=this;i=r(this.key,t)}catch(r){return this.destination.error(r)}else this.hasKey=!0;i||(this.key=t,this.destination.next(e))}}const ja={STATE_NAME:n=>`${n} is not a valid state name. It needs to be a valid object property name.`,STATE_NAME_PROPERTY:()=>"States must register a 'name' property",STATE_UNIQUE:(n,e,t)=>`State name '${n}' from ${e} already exists in ${t}`,STATE_DECORATOR:()=>"States must be decorated with @State() decorator",INCORRECT_PRODUCTION:()=>"Angular is running in production mode but NGXS is still running in the development mode!\nPlease set developmentMode to false on the NgxsModule options when in production mode.\nNgxsModule.forRoot(states, { developmentMode: !environment.production })",INCORRECT_DEVELOPMENT:()=>"RECOMMENDATION: Set developmentMode to true on the NgxsModule when Angular is running in development mode.\nNgxsModule.forRoot(states, { developmentMode: !environment.production })",SELECT_FACTORY_NOT_CONNECTED:()=>"You have forgotten to import the NGXS module!",ACTION_DECORATOR:()=>"@Action() decorator cannot be used with static methods",SELECTOR_DECORATOR:()=>"Selectors only work on methods",ZONE_WARNING:()=>"Your application was bootstrapped with nooped zone and your execution strategy requires an actual NgZone!\nPlease set the value of the executionStrategy property to NoopNgxsExecutionStrategy.\nNgxsModule.forRoot(states, { executionStrategy: NoopNgxsExecutionStrategy })",PATCHING_ARRAY:()=>"Patching arrays is not supported.",PATCHING_PRIMITIVE:()=>"Patching primitives is not supported.",UNDECORATED_STATE_IN_IVY:n=>`'${n}' class should be decorated with @Injectable() right after the @State() decorator`};let X8=(()=>{class n{constructor(t,i){this._ngZone=t,this._platformId=i,this.verifyZoneIsNotNooped(this._ngZone)}enter(t){return function(n){return"server"===n}(this._platformId)?this.runInsideAngular(t):this.runOutsideAngular(t)}leave(t){return this.runInsideAngular(t)}runInsideAngular(t){return yn.isInAngularZone()?t():this._ngZone.run(t)}runOutsideAngular(t){return yn.isInAngularZone()?this._ngZone.runOutsideAngular(t):t()}verifyZoneIsNotNooped(t){t instanceof yn||console.warn(ja.ZONE_WARNING())}}return n.\u0275fac=function(t){return new(t||n)(Ie(yn),Ie(Hc))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const Q8=new Gt("ROOT_STATE_TOKEN"),Z8=new Gt("FEATURE_STATE_TOKEN"),J8=new Gt("NGXS_PLUGINS"),e5=new Gt("NG_TEST_MODE"),t5=new Gt("NG_DEV_MODE"),td="NGXS_META",n5="NGXS_OPTIONS_META";let jf=(()=>{class n{constructor(){this.defaultsState={},this.selectorOptions={injectContainerState:!0,suppressErrors:!0},this.compatibility={strictContentSecurityPolicy:!1},this.executionStrategy=X8}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class xbe{constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}}const i5=new Gt("NGXS_EXECUTION_STRATEGY");function Uf(n){return n.constructor&&n.constructor.type?n.constructor.type:n.type}const r5=(n,e,t)=>{n=Object.assign({},n);const i=e.split("."),r=i.length-1;return i.reduce((s,o,a)=>(s[o]=a===r?t:Array.isArray(s[o])?s[o].slice():Object.assign({},s[o]),s&&s[o]),n),n},gx=(n,e)=>e.split(".").reduce((t,i)=>t&&t[i],n),JR=n=>n&&"object"==typeof n&&!Array.isArray(n),eN=(n,...e)=>{if(!e.length)return n;const t=e.shift();if(JR(n)&&JR(t))for(const i in t)JR(t[i])?(n[i]||Object.assign(n,{[i]:{}}),eN(n[i],t[i])):Object.assign(n,{[i]:t[i]});return eN(n,...e)};function ov(n){return n[td]}function o5(n,e){const t=gx(e.currentAppState,n.path),i=gx(e.newAppState,n.path);return new xbe(t,i,!n.isInitialised)}function Rbe(...n){return function(n,e,t=Fbe){const i=function(n){return n.reduce((e,t)=>(e[Uf(t)]=!0,e),{})}(n),r=e&&function(n){return n.reduce((e,t)=>(e[t]=!0,e),{})}(e);return function(s){return s.pipe(function(n,e){return qi(t=>{const i=Uf(t.action);return n[i]&&(!e||e[t.status])})}(i,r),t())}}(n,["DISPATCHED"])}function Fbe(){return me(n=>n.action)}function mx(n){return e=>new O(t=>e.subscribe({next(i){n.leave(()=>t.next(i))},error(i){n.leave(()=>t.error(i))},complete(){n.leave(()=>t.complete())}}))}let _x=(()=>{class n{constructor(t){this._executionStrategy=t}enter(t){return this._executionStrategy.enter(t)}leave(t){return this._executionStrategy.leave(t)}}return n.\u0275fac=function(t){return new(t||n)(Ie(i5))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class Bbe extends oe{constructor(){super(...arguments),this._itemQueue=[],this._busyPushingNext=!1}next(e){if(this._busyPushingNext)this._itemQueue.unshift(e);else{for(this._busyPushingNext=!0,super.next(e);this._itemQueue.length>0;){const t=this._itemQueue.pop();super.next(t)}this._busyPushingNext=!1}}}let yx=(()=>{class n extends Bbe{}return n.\u0275fac=function(){let e;return function(i){return(e||(e=$i(n)))(i||n)}}(),n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),Vbe=(()=>{class n extends O{constructor(t,i){super(r=>{const s=t.pipe(mx(i)).subscribe({next:o=>r.next(o),error:o=>r.error(o),complete:()=>r.complete()});r.add(s)})}}return n.\u0275fac=function(t){return new(t||n)(Ie(yx),Ie(_x))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const a5=n=>(...e)=>n.shift()(...e,(...i)=>a5(n)(...i));let vx=(()=>{class n extends Nr{constructor(){super({})}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),rN=(()=>{class n{constructor(t,i){this._parentManager=t,this._pluginHandlers=i,this.plugins=[],this.registerHandlers()}get rootPlugins(){return this._parentManager&&this._parentManager.plugins||this.plugins}registerHandlers(){const t=this.getPluginHandlers();this.rootPlugins.push(...t)}getPluginHandlers(){return(this._pluginHandlers||[]).map(i=>i.handle?i.handle.bind(i):i)}}return n.\u0275fac=function(t){return new(t||n)(Ie(n,12),Ie(J8,8))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),sN=(()=>{class n extends oe{}return n.\u0275fac=function(){let e;return function(i){return(e||(e=$i(n)))(i||n)}}(),n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),l5=(()=>{class n{constructor(t,i,r,s,o,a){this._injector=t,this._actions=i,this._actionResults=r,this._pluginManager=s,this._stateStream=o,this._ngxsExecutionStrategy=a}dispatch(t){const i=this._ngxsExecutionStrategy.enter(()=>this.dispatchByEvents(t));return i.subscribe({error:r=>this._ngxsExecutionStrategy.leave(()=>{try{this._errorHandler=this._errorHandler||this._injector.get(ea),this._errorHandler.handleError(r)}catch(s){}})}),i.pipe(mx(this._ngxsExecutionStrategy))}dispatchByEvents(t){return Array.isArray(t)?0===t.length?tn(this._stateStream.getValue()):sv(t.map(i=>this.dispatchSingle(i))):this.dispatchSingle(t)}dispatchSingle(t){if(!Uf(t))return Ig(new Error(`This action doesn't have a type property: ${t.constructor.name}`));const r=this._stateStream.getValue();return a5([...this._pluginManager.plugins,(o,a)=>{o!==r&&this._stateStream.next(o);const l=this.getActionResultStream(a);return l.subscribe(c=>this._actions.next(c)),this._actions.next({action:a,status:"DISPATCHED"}),this.createDispatchObservable(l)}])(r,t).pipe(Va())}getActionResultStream(t){return this._actionResults.pipe(qi(i=>i.action===t&&"DISPATCHED"!==i.status),zr(1),Va())}createDispatchObservable(t){return t.pipe(K8(i=>{switch(i.status){case"SUCCESSFUL":return tn(this._stateStream.getValue());case"ERRORED":return Ig(i.error);default:return $c}})).pipe(Va())}}return n.\u0275fac=function(t){return new(t||n)(Ie(zn),Ie(yx),Ie(sN),Ie(rN),Ie(vx),Ie(_x))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const c5=n=>{Object.freeze(n);const e="function"==typeof n,t=Object.prototype.hasOwnProperty;return Object.getOwnPropertyNames(n).forEach(function(i){t.call(n,i)&&(!e||"caller"!==i&&"callee"!==i&&"arguments"!==i)&&null!==n[i]&&("object"==typeof n[i]||"function"==typeof n[i])&&!Object.isFrozen(n[i])&&c5(n[i])}),n};let u5=(()=>{class n{constructor(t,i){this.isDevMode=t,this.isTestMode=i}}return n.\u0275fac=function(t){return new(t||n)(Ie(t5),Ie(e5))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),d5=(()=>{class n{constructor(t,i){this._host=t,this._config=i}get isIncorrectProduction(){return!this._host.isDevMode()&&this._config.developmentMode}get isIncorrectDevelopment(){return this._host.isDevMode()&&!this._config.developmentMode}verifyDevMode(){this._host.isTestMode()||(this.isIncorrectProduction?console.warn(ja.INCORRECT_PRODUCTION()):this.isIncorrectDevelopment&&console.warn(ja.INCORRECT_DEVELOPMENT()))}}return n.\u0275fac=function(t){return new(t||n)(Ie(u5),Ie(jf))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),um=(()=>{class n{constructor(t,i,r,s){this._stateStream=t,this._dispatcher=i,this._config=r,s.verifyDevMode()}getRootStateOperations(){const t={getState:()=>this._stateStream.getValue(),setState:i=>this._stateStream.next(i),dispatch:i=>this._dispatcher.dispatch(i)};return this._config.developmentMode?this.ensureStateAndActionsAreImmutable(t):t}ensureStateAndActionsAreImmutable(t){return{getState:()=>t.getState(),setState:i=>{const r=c5(i);return t.setState(r)},dispatch:i=>t.dispatch(i)}}setStateToTheCurrentWithNew(t){const i=this.getRootStateOperations(),r=i.getState();i.setState(Object.assign({},r,t.defaults))}}return n.\u0275fac=function(t){return new(t||n)(Ie(vx),Ie(l5),Ie(jf),Ie(d5))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),bx=(()=>{class n{constructor(t){this._internalStateOperations=t}createStateContext(t){const i=this._internalStateOperations.getRootStateOperations();function r(l){return gx(l,t.path)}function s(l,c){const u=r5(l,t.path,c),h=t.instance;if(h.ngxsOnChanges){const f=o5(t,{currentAppState:l,newAppState:u});h.ngxsOnChanges(f)}return i.setState(u),u}function o(l,c){return s(l,c(r(l)))}return{getState:()=>r(i.getState()),patchState:l=>o(i.getState(),function(n){return e=>{if(Array.isArray(n))throw new Error(ja.PATCHING_ARRAY());if("object"!=typeof n)throw new Error(ja.PATCHING_PRIMITIVE());const t=Object.assign({},e);for(const i in n)t[i]=n[i];return t}}(l)),setState(l){const c=i.getState();return function(l){return"function"==typeof l}(l)?o(c,l):s(c,l)},dispatch:l=>i.dispatch(l)}}}return n.\u0275fac=function(t){return new(t||n)(Ie(um))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class wx{static stateNameErrorMessage(e){return ja.STATE_NAME(e)}static checkCorrectStateName(e){if(!e)throw new Error(ja.STATE_NAME_PROPERTY());if(!this.stateNameRegex.test(e))throw new Error(this.stateNameErrorMessage(e))}static checkStateNameIsUnique(e,t){const r=this.getValidStateMeta(e).name,s=t[r];if(s&&s!==e)throw new Error(ja.STATE_UNIQUE(r,e.name,s.name));return r}static getValidStateMeta(e){const t=ov(e);if(!t)throw new Error(ja.STATE_DECORATOR());return t}}wx.stateNameRegex=new RegExp("^[a-zA-Z0-9_]+$");let dm=(()=>{class n{constructor(t,i,r,s,o,a,l){this._injector=t,this._config=i,this._parentFactory=r,this._actions=s,this._actionResults=o,this._stateContextFactory=a,this._initialState=l,this._actionsSubscription=null,this._states=[],this._statesByName={},this._statePaths={},this.getRuntimeSelectorContext=$8(()=>{const c=this;function u(f){const g=c.statePaths[f];return g?function(n,e){return e&&e.compatibility&&e.compatibility.strictContentSecurityPolicy?function(n){const e=n.slice();return t=>e.reduce((i,r)=>i&&i[r],t)}(n):function(n){const e=n;let t="store."+e[0],i=0;const r=e.length;let s=t;for(;++i<r;)s=s+" && "+(t=t+"."+e[i]);return new Function("store","return "+s+";")}(n)}(g.split("."),c._config):null}return this._parentFactory?this._parentFactory.getRuntimeSelectorContext():{getStateGetter(f){let g=u(f);return g||((...m)=>(g||(g=u(f)),g?g(...m):void 0))},getSelectorOptions:f=>Object.assign({},c._config.selectorOptions,f||{})}})}get states(){return this._parentFactory?this._parentFactory.states:this._states}get statesByName(){return this._parentFactory?this._parentFactory.statesByName:this._statesByName}get statePaths(){return this._parentFactory?this._parentFactory.statePaths:this._statePaths}static cloneDefaults(t){let i={};return i=Array.isArray(t)?t.slice():function(n){return"object"==typeof n&&null!==n||"function"==typeof n}(t)?Object.assign({},t):void 0===t?{}:t,i}static checkStatesAreValid(t){t.forEach(wx.getValidStateMeta)}ngOnDestroy(){this._actionsSubscription.unsubscribe()}add(t){n.checkStatesAreValid(t);const{newStates:i}=this.addToStatesMap(t);if(!i.length)return[];const r=function(n){const e=t=>{const i=n.find(r=>r===t);if(!i)throw new Error(`Child state not found: ${t}. \r\nYou may have forgotten to add states to module`);return i[td].name};return n.reduce((t,i)=>{const{name:r,children:s}=i[td];return t[r]=(s||[]).map(e),t},{})}(i),s=function(n){const e=[],t={},i=(r,s=[])=>{Array.isArray(s)||(s=[]),s.push(r),t[r]=!0,n[r].forEach(o=>{if(s.indexOf(o)>=0)throw new Error(`Circular dependency '${o}' is required by '${r}': ${s.join(" -> ")}`);t[o]||i(o,s.slice(0))}),e.indexOf(r)<0&&e.push(r)};return Object.keys(n).forEach(r=>i(r)),e.reverse()}(r),o=function(n,e={}){const t=(i,r)=>{for(const s in i)if(i.hasOwnProperty(s)&&i[s].indexOf(r)>=0){const o=t(i,s);return null!==o?`${o}.${s}`:s}return null};for(const i in n)if(n.hasOwnProperty(i)){const r=t(n,i);e[i]=r?`${r}.${i}`:i}return e}(r),a=function(n){return n.reduce((e,t)=>(e[t[td].name]=t,e),{})}(i),l=[];for(const c of s){const u=a[c],h=o[c],f=u[td];this.addRuntimeInfoToMeta(f,h);const g={name:c,path:h,isInitialised:!1,actions:f.actions,instance:this._injector.get(u),defaults:n.cloneDefaults(f.defaults)};this.hasBeenMountedAndBootstrapped(c,h)||l.push(g),this.states.push(g)}return l}addAndReturnDefaults(t){const r=this.add(t||[]);return{defaults:r.reduce((o,a)=>r5(o,a.path,a.defaults),{}),states:r}}connectActionHandlers(){null===this._actionsSubscription&&(this._actionsSubscription=this._actions.pipe(qi(t=>"DISPATCHED"===t.status),V(({action:t})=>this.invokeActions(this._actions,t).pipe(me(()=>({action:t,status:"SUCCESSFUL"})),px({action:t,status:"CANCELED"}),hc(i=>tn({action:t,status:"ERRORED",error:i}))))).subscribe(t=>this._actionResults.next(t)))}invokeActions(t,i){const r=Uf(i),s=[];for(const o of this.states){const a=o.actions[r];if(a)for(const l of a){const c=this._stateContextFactory.createStateContext(o);try{let u=o.instance[l.fn](c,i);u instanceof Promise&&(u=je(u)),u instanceof O?(u=u.pipe(px({})),l.options.cancelUncompleted&&(u=u.pipe(ls(t.pipe(Rbe(i)))))):u=tn({}).pipe(Va()),s.push(u)}catch(u){s.push(Ig(u))}}}return s.length||s.push(tn({})),sv(s)}addToStatesMap(t){const i=[],r=this.statesByName;for(const s of t){const o=wx.checkStateNameIsUnique(s,r);!r[o]&&(i.push(s),r[o]=s)}return{newStates:i}}addRuntimeInfoToMeta(t,i){this.statePaths[t.name]=i,t.path=i}hasBeenMountedAndBootstrapped(t,i){const r=void 0!==gx(this._initialState,i);return this.statesByName[t]&&r}}return n.\u0275fac=function(t){return new(t||n)(Ie(zn),Ie(jf),Ie(n,12),Ie(yx),Ie(sN),Ie(bx),Ie(QR,8))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),oN=(()=>{class n{constructor(t,i,r){this.internalStateOperations=t,this.stateContextFactory=i,this.bootstrapper=r}ngxsBootstrap(t,i){this.internalStateOperations.getRootStateOperations().dispatch(t).pipe(qi(()=>!!i),ur(()=>this.invokeInit(i.states)),V(()=>this.bootstrapper.appBootstrapped$),qi(r=>!!r)).subscribe(()=>this.invokeBootstrap(i.states))}invokeInit(t){for(const i of t){const r=i.instance;if(r.ngxsOnChanges){const a=o5(i,{currentAppState:{},newAppState:this.internalStateOperations.getRootStateOperations().getState()});r.ngxsOnChanges(a)}r.ngxsOnInit&&r.ngxsOnInit(this.getStateContext(i)),i.isInitialised=!0}}invokeBootstrap(t){for(const i of t){const r=i.instance;r.ngxsAfterBootstrap&&r.ngxsAfterBootstrap(this.getStateContext(i))}}getStateContext(t){return this.stateContextFactory.createStateContext(t)}}return n.\u0275fac=function(t){return new(t||n)(Ie(um),Ie(bx),Ie(XR))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();let gh=(()=>{class n{constructor(t,i,r,s,o,a){this._stateStream=t,this._internalStateOperations=i,this._config=r,this._internalExecutionStrategy=s,this._stateFactory=o,this.initStateStream(a)}dispatch(t){return this._internalStateOperations.getRootStateOperations().dispatch(t)}select(t){const i=this.getStoreBoundSelectorFn(t);return this._stateStream.pipe(me(i),hc(r=>{const{suppressErrors:s}=this._config.selectorOptions;return r instanceof TypeError&&s?tn(void 0):Ig(r)}),ed(),mx(this._internalExecutionStrategy))}selectOnce(t){return this.select(t).pipe(zr(1))}selectSnapshot(t){return this.getStoreBoundSelectorFn(t)(this._stateStream.getValue())}subscribe(t){return this._stateStream.pipe(mx(this._internalExecutionStrategy)).subscribe(t)}snapshot(){return this._internalStateOperations.getRootStateOperations().getState()}reset(t){return this._internalStateOperations.getRootStateOperations().setState(t)}getStoreBoundSelectorFn(t){return function(n){const e=function(n){return n.NGXS_SELECTOR_META}(n)||ov(n);return e&&e.makeRootSelector||(()=>n)}(t)(this._stateFactory.getRuntimeSelectorContext())}initStateStream(t){const i=this._stateStream.value;if(!i||0===Object.keys(i).length){const o=Object.keys(this._config.defaultsState).length>0?Object.assign({},this._config.defaultsState,t):t;this._stateStream.next(o)}}}return n.\u0275fac=function(t){return new(t||n)(Ie(vx),Ie(um),Ie(jf),Ie(_x),Ie(dm),Ie(QR,8))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),av=(()=>{class n{constructor(t,i){n.store=t,n.config=i}ngOnDestroy(){n.store=null,n.config=null}}return n.\u0275fac=function(t){return new(t||n)(Ie(gh),Ie(jf))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n.store=null,n.config=null,n})();class Wbe{static get type(){return"@@INIT"}}class qbe{constructor(e){this.addedStates=e}static get type(){return"@@UPDATE_STATE"}}const Sx=new Sf(1);let Kbe=(()=>{class n{constructor(t,i,r,s,o=[],a){!function(){try{const n=window.ng,t=!(n.probe&&n.coreTokens)&&oa();Sx.next(t)}catch(n){Sx.next(!1)}finally{Sx.complete()}}();const l=t.addAndReturnDefaults(o);i.setStateToTheCurrentWithNew(l),t.connectActionHandlers(),a.ngxsBootstrap(new Wbe,l)}}return n.\u0275fac=function(t){return new(t||n)(Ie(dm),Ie(um),Ie(gh),Ie(av),Ie(Q8,8),Ie(oN))},n.\u0275mod=an({type:n}),n.\u0275inj=Ct({}),n})(),Xbe=(()=>{class n{constructor(t,i,r,s=[],o){const a=n.flattenStates(s),l=r.addAndReturnDefaults(a);l.states.length&&(i.setStateToTheCurrentWithNew(l),o.ngxsBootstrap(new qbe(l.defaults),l))}static flattenStates(t=[]){return t.reduce((i,r)=>i.concat(r),[])}}return n.\u0275fac=function(t){return new(t||n)(Ie(gh),Ie(um),Ie(dm),Ie(Z8,8),Ie(oN))},n.\u0275mod=an({type:n}),n.\u0275inj=Ct({}),n})();class pa{static forRoot(e=[],t={}){return{ngModule:Kbe,providers:[dm,bx,Vbe,yx,XR,d5,u5,oN,l5,sN,um,_x,gh,vx,av,rN,...e,...pa.ngxsTokenProviders(e,t)]}}static forFeature(e=[]){return{ngModule:Xbe,providers:[dm,rN,...e,{provide:Z8,multi:!0,useValue:e}]}}static ngxsTokenProviders(e,t){return[{provide:e5,useValue:sbe},{provide:t5,useValue:oa},{provide:i5,useClass:t.executionStrategy||X8},{provide:Q8,useValue:e},{provide:pa.ROOT_OPTIONS,useValue:t},{provide:jf,useFactory:pa.ngxsConfigFactory,deps:[pa.ROOT_OPTIONS]},{provide:yE,useFactory:pa.appBootstrapListenerFactory,multi:!0,deps:[XR]},{provide:QR,useFactory:pa.getInitialState},{provide:W8,useExisting:bx},{provide:q8,useExisting:dm}]}static ngxsConfigFactory(e){return eN(new jf,e)}static appBootstrapListenerFactory(e){return()=>e.bootstrap()}static getInitialState(){return obe.pop()}}function Zbe(n){return i=>{!function(n){Sx.subscribe(e=>{e&&(n.\u0275prov||console.warn(ja.UNDECORATED_STATE_IN_IVY(n.name)))})}(i);const r=i,s=function(n){if(!n.hasOwnProperty(td)){const e={name:null,actions:{},defaults:{},path:null,makeRootSelector:t=>t.getStateGetter(e.name),children:[]};Object.defineProperty(n,td,{value:e})}return ov(n)}(r),o=Object.getPrototypeOf(r),a=function(i){return Object.assign({},i[n5]||{},n)}(o);(function(i){const{meta:r,inheritedStateClass:s,optionsWithInheritance:o}=i,{children:a,defaults:l,name:c}=o,u="string"==typeof c?c:c&&c.getName()||null;wx.checkCorrectStateName(u),s.hasOwnProperty(td)&&(r.actions=Object.assign({},r.actions,(s[td]||{}).actions)),r.children=a,r.defaults=l,r.name=u})({meta:s,inheritedStateClass:o,optionsWithInheritance:a}),r[n5]=a}}pa.\u0275fac=function(e){return new(e||pa)},pa.\u0275mod=an({type:pa}),pa.\u0275inj=Ct({}),pa.ROOT_OPTIONS=new Gt("ROOT_OPTIONS");const Ua=new Gt("NgValueAccessor"),Fx=new nc(KE);class oEe{constructor(e,t){this.dueTime=e,this.scheduler=t}call(e,t){return t.subscribe(new aEe(e,this.dueTime,this.scheduler))}}class aEe extends y{constructor(e,t,i){super(e),this.dueTime=t,this.scheduler=i,this.debouncedSubscription=null,this.lastValue=null,this.hasValue=!1}_next(e){this.clearDebounce(),this.lastValue=e,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(lEe,this.dueTime,this))}_complete(){this.debouncedNext(),this.destination.complete()}debouncedNext(){if(this.clearDebounce(),this.hasValue){const{lastValue:e}=this;this.lastValue=null,this.hasValue=!1,this.destination.next(e)}}clearDebounce(){const e=this.debouncedSubscription;null!==e&&(this.remove(e),e.unsubscribe(),this.debouncedSubscription=null)}}function lEe(n){n.debouncedNext()}class cEe{constructor(e){this.total=e}call(e,t){return t.subscribe(new uEe(e,this.total))}}class uEe extends y{constructor(e,t){super(e),this.total=t,this.count=0}_next(e){++this.count>this.total&&this.destination.next(e)}}function Yi(n){return null!=n&&"false"!=`${n}`}function za(n,e=0){return function(n){return!isNaN(parseFloat(n))&&!isNaN(Number(n))}(n)?Number(n):e}function id(n){return n instanceof En?n.nativeElement:n}let RN;try{RN="undefined"!=typeof Intl&&Intl.v8BreakIterator}catch(n){RN=!1}let mv,NN,Ki=(()=>{class n{constructor(t){this._platformId=t,this.isBrowser=this._platformId?wf(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!RN)&&"undefined"!=typeof CSS&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return n.\u0275fac=function(t){return new(t||n)(Ie(Hc))},n.\u0275prov=We({factory:function(){return new n(Ie(Hc))},token:n,providedIn:"root"}),n})(),gv=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=an({type:n}),n.\u0275inj=Ct({}),n})();function pm(n){return function(){if(null==mv&&"undefined"!=typeof window)try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>mv=!0}))}finally{mv=mv||!1}return mv}()?n:!!n.capture}function Gf(n){return n.composedPath?n.composedPath()[0]:n.target}let PN=(()=>{class n{create(t){return"undefined"==typeof MutationObserver?null:new MutationObserver(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({factory:function(){return new n},token:n,providedIn:"root"}),n})(),S6=(()=>{class n{constructor(t){this._mutationObserverFactory=t,this._observedElements=new Map}ngOnDestroy(){this._observedElements.forEach((t,i)=>this._cleanupObserver(i))}observe(t){const i=id(t);return new O(r=>{const o=this._observeElement(i).subscribe(r);return()=>{o.unsubscribe(),this._unobserveElement(i)}})}_observeElement(t){if(this._observedElements.has(t))this._observedElements.get(t).count++;else{const i=new oe,r=this._mutationObserverFactory.create(s=>i.next(s));r&&r.observe(t,{characterData:!0,childList:!0,subtree:!0}),this._observedElements.set(t,{observer:r,stream:i,count:1})}return this._observedElements.get(t).stream}_unobserveElement(t){this._observedElements.has(t)&&(this._observedElements.get(t).count--,this._observedElements.get(t).count||this._cleanupObserver(t))}_cleanupObserver(t){if(this._observedElements.has(t)){const{observer:i,stream:r}=this._observedElements.get(t);i&&i.disconnect(),r.complete(),this._observedElements.delete(t)}}}return n.\u0275fac=function(t){return new(t||n)(Ie(PN))},n.\u0275prov=We({factory:function(){return new n(Ie(PN))},token:n,providedIn:"root"}),n})(),x6=(()=>{class n{constructor(t,i,r){this._contentObserver=t,this._elementRef=i,this._ngZone=r,this.event=new dn,this._disabled=!1,this._currentSubscription=null}get disabled(){return this._disabled}set disabled(t){this._disabled=Yi(t),this._disabled?this._unsubscribe():this._subscribe()}get debounce(){return this._debounce}set debounce(t){this._debounce=za(t),this._subscribe()}ngAfterContentInit(){!this._currentSubscription&&!this.disabled&&this._subscribe()}ngOnDestroy(){this._unsubscribe()}_subscribe(){this._unsubscribe();const t=this._contentObserver.observe(this._elementRef);this._ngZone.runOutsideAngular(()=>{this._currentSubscription=(this.debounce?t.pipe(function(n,e=Fx){return t=>t.lift(new oEe(n,e))}(this.debounce)):t).subscribe(this.event)})}_unsubscribe(){var t;null===(t=this._currentSubscription)||void 0===t||t.unsubscribe()}}return n.\u0275fac=function(t){return new(t||n)(De(S6),De(En),De(yn))},n.\u0275dir=Bt({type:n,selectors:[["","cdkObserveContent",""]],inputs:{disabled:["cdkObserveContentDisabled","disabled"],debounce:"debounce"},outputs:{event:"cdkObserveContent"},exportAs:["cdkObserveContent"]}),n})(),FN=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=an({type:n}),n.\u0275inj=Ct({providers:[PN]}),n})();function F6(n){return 0===n.offsetX&&0===n.offsetY}function L6(n){const e=n.touches&&n.touches[0]||n.changedTouches&&n.changedTouches[0];return!(!e||-1!==e.identifier||null!=e.radiusX&&1!==e.radiusX||null!=e.radiusY&&1!==e.radiusY)}"undefined"!=typeof Element&&Element;const k6=new Gt("cdk-input-modality-detector-options"),LEe={ignoreKeys:[18,17,224,91,16]},gm=pm({passive:!0,capture:!0});let V6=(()=>{class n{constructor(t,i,r,s){this._platform=t,this._mostRecentTarget=null,this._modality=new Nr(null),this._lastTouchMs=0,this._onKeydown=o=>{var a,l;(null===(l=null===(a=this._options)||void 0===a?void 0:a.ignoreKeys)||void 0===l?void 0:l.some(c=>c===o.keyCode))||(this._modality.next("keyboard"),this._mostRecentTarget=Gf(o))},this._onMousedown=o=>{Date.now()-this._lastTouchMs<650||(this._modality.next(F6(o)?"keyboard":"mouse"),this._mostRecentTarget=Gf(o))},this._onTouchstart=o=>{L6(o)?this._modality.next("keyboard"):(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=Gf(o))},this._options=Object.assign(Object.assign({},LEe),s),this.modalityDetected=this._modality.pipe(function(n){return e=>e.lift(new cEe(n))}(1)),this.modalityChanged=this.modalityDetected.pipe(ed()),t.isBrowser&&i.runOutsideAngular(()=>{r.addEventListener("keydown",this._onKeydown,gm),r.addEventListener("mousedown",this._onMousedown,gm),r.addEventListener("touchstart",this._onTouchstart,gm)})}get mostRecentModality(){return this._modality.value}ngOnDestroy(){!this._platform.isBrowser||(document.removeEventListener("keydown",this._onKeydown,gm),document.removeEventListener("mousedown",this._onMousedown,gm),document.removeEventListener("touchstart",this._onTouchstart,gm))}}return n.\u0275fac=function(t){return new(t||n)(Ie(Ki),Ie(yn),Ie(un),Ie(k6,8))},n.\u0275prov=We({factory:function(){return new n(Ie(Ki),Ie(yn),Ie(un),Ie(k6,8))},token:n,providedIn:"root"}),n})();const z6=new Gt("cdk-focus-monitor-default-options"),Ux=pm({passive:!0,capture:!0});let rd=(()=>{class n{constructor(t,i,r,s,o){this._ngZone=t,this._platform=i,this._inputModalityDetector=r,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new oe,this._rootNodeFocusAndBlurListener=a=>{const l=Gf(a),c="focus"===a.type?this._onFocus:this._onBlur;for(let u=l;u;u=u.parentElement)c.call(this,a,u)},this._document=s,this._detectionMode=(null==o?void 0:o.detectionMode)||0}monitor(t,i=!1){const r=id(t);if(!this._platform.isBrowser||1!==r.nodeType)return tn(null);const s=function(n){if(function(){if(null==NN){const n="undefined"!=typeof document?document.head:null;NN=!(!n||!n.createShadowRoot&&!n.attachShadow)}return NN}()){const e=n.getRootNode?n.getRootNode():null;if("undefined"!=typeof ShadowRoot&&ShadowRoot&&e instanceof ShadowRoot)return e}return null}(r)||this._getDocument(),o=this._elementInfo.get(r);if(o)return i&&(o.checkChildren=!0),o.subject;const a={checkChildren:i,subject:new oe,rootNode:s};return this._elementInfo.set(r,a),this._registerGlobalListeners(a),a.subject}stopMonitoring(t){const i=id(t),r=this._elementInfo.get(i);r&&(r.subject.complete(),this._setClasses(i),this._elementInfo.delete(i),this._removeGlobalListeners(r))}focusVia(t,i,r){const s=id(t);s===this._getDocument().activeElement?this._getClosestElementsInfo(s).forEach(([a,l])=>this._originChanged(a,i,l)):(this._setOrigin(i),"function"==typeof s.focus&&s.focus(r))}ngOnDestroy(){this._elementInfo.forEach((t,i)=>this.stopMonitoring(i))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_toggleClass(t,i,r){r?t.classList.add(i):t.classList.remove(i)}_getFocusOrigin(t){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(t)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:"program"}_shouldBeAttributedToTouch(t){return 1===this._detectionMode||!!(null==t?void 0:t.contains(this._inputModalityDetector._mostRecentTarget))}_setClasses(t,i){this._toggleClass(t,"cdk-focused",!!i),this._toggleClass(t,"cdk-touch-focused","touch"===i),this._toggleClass(t,"cdk-keyboard-focused","keyboard"===i),this._toggleClass(t,"cdk-mouse-focused","mouse"===i),this._toggleClass(t,"cdk-program-focused","program"===i)}_setOrigin(t,i=!1){this._ngZone.runOutsideAngular(()=>{this._origin=t,this._originFromTouchInteraction="touch"===t&&i,0===this._detectionMode&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(t,i){const r=this._elementInfo.get(i),s=Gf(t);!r||!r.checkChildren&&i!==s||this._originChanged(i,this._getFocusOrigin(s),r)}_onBlur(t,i){const r=this._elementInfo.get(i);!r||r.checkChildren&&t.relatedTarget instanceof Node&&i.contains(t.relatedTarget)||(this._setClasses(i),this._emitOrigin(r.subject,null))}_emitOrigin(t,i){this._ngZone.run(()=>t.next(i))}_registerGlobalListeners(t){if(!this._platform.isBrowser)return;const i=t.rootNode,r=this._rootNodeFocusListenerCount.get(i)||0;r||this._ngZone.runOutsideAngular(()=>{i.addEventListener("focus",this._rootNodeFocusAndBlurListener,Ux),i.addEventListener("blur",this._rootNodeFocusAndBlurListener,Ux)}),this._rootNodeFocusListenerCount.set(i,r+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(ls(this._stopInputModalityDetector)).subscribe(s=>{this._setOrigin(s,!0)}))}_removeGlobalListeners(t){const i=t.rootNode;if(this._rootNodeFocusListenerCount.has(i)){const r=this._rootNodeFocusListenerCount.get(i);r>1?this._rootNodeFocusListenerCount.set(i,r-1):(i.removeEventListener("focus",this._rootNodeFocusAndBlurListener,Ux),i.removeEventListener("blur",this._rootNodeFocusAndBlurListener,Ux),this._rootNodeFocusListenerCount.delete(i))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(t,i,r){this._setClasses(t,i),this._emitOrigin(r.subject,i),this._lastFocusOrigin=i}_getClosestElementsInfo(t){const i=[];return this._elementInfo.forEach((r,s)=>{(s===t||r.checkChildren&&s.contains(t))&&i.push([s,r])}),i}}return n.\u0275fac=function(t){return new(t||n)(Ie(yn),Ie(Ki),Ie(V6),Ie(un,8),Ie(z6,8))},n.\u0275prov=We({factory:function(){return new n(Ie(yn),Ie(Ki),Ie(V6),Ie(un,8),Ie(z6,8))},token:n,providedIn:"root"}),n})();const H6="cdk-high-contrast-black-on-white",G6="cdk-high-contrast-white-on-black",kN="cdk-high-contrast-active";let $6=(()=>{class n{constructor(t,i){this._platform=t,this._document=i}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const t=this._document.createElement("div");t.style.backgroundColor="rgb(1,2,3)",t.style.position="absolute",this._document.body.appendChild(t);const i=this._document.defaultView||window,r=i&&i.getComputedStyle?i.getComputedStyle(t):null,s=(r&&r.backgroundColor||"").replace(/ /g,"");switch(this._document.body.removeChild(t),s){case"rgb(0,0,0)":return 2;case"rgb(255,255,255)":return 1}return 0}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const t=this._document.body.classList;t.remove(kN),t.remove(H6),t.remove(G6),this._hasCheckedHighContrastMode=!0;const i=this.getHighContrastMode();1===i?(t.add(kN),t.add(H6)):2===i&&(t.add(kN),t.add(G6))}}}return n.\u0275fac=function(t){return new(t||n)(Ie(Ki),Ie(un))},n.\u0275prov=We({factory:function(){return new n(Ie(Ki),Ie(un))},token:n,providedIn:"root"}),n})(),yv=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=an({type:n}),n.\u0275inj=Ct({}),n})();const q6=new Fu("12.2.5");function X6(n){Promise.resolve(null).then(n)}class _m{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._onStartFns.push(e)}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){X6(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}function Z6(){return"undefined"!=typeof window&&void 0!==window.document}function VN(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}let HN=(n,e)=>!1,GN=(n,e)=>!1,tG=(n,e,t)=>[];const nG=VN();(nG||"undefined"!=typeof Element)&&(HN=Z6()?(n,e)=>{for(;e&&e!==document.documentElement;){if(e===n)return!0;e=e.parentNode||e.host}return!1}:(n,e)=>n.contains(e),GN=(()=>{if(nG||Element.prototype.matches)return(n,e)=>n.matches(e);{const n=Element.prototype,e=n.matchesSelector||n.mozMatchesSelector||n.msMatchesSelector||n.oMatchesSelector||n.webkitMatchesSelector;return e?(t,i)=>e.apply(t,[i]):GN}})(),tG=(n,e,t)=>{let i=[];if(t){const r=n.querySelectorAll(e);for(let s=0;s<r.length;s++)i.push(r[s])}else{const r=n.querySelector(e);r&&i.push(r)}return i});let $f=null,iG=!1;function $N(n){$f||($f=("undefined"!=typeof document?document.body:null)||{},iG=!!$f.style&&"WebkitAppearance"in $f.style);let e=!0;return $f.style&&!function(n){return"ebkit"==n.substring(1,6)}(n)&&(e=n in $f.style,!e&&iG&&(e="Webkit"+n.charAt(0).toUpperCase()+n.substr(1)in $f.style)),e}const WN=GN,qN=HN,YN=tG;let sG=(()=>{class n{validateStyleProperty(t){return $N(t)}matchesElement(t,i){return WN(t,i)}containsElement(t,i){return qN(t,i)}query(t,i,r){return YN(t,i,r)}computeStyle(t,i,r){return r||""}animate(t,i,r,s,o,a=[],l){return new _m(r,s)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class zx{}zx.NOOP=new sG;function cG(n,e,t){return t?e+":"+t+";":""}function uG(n){let e="";for(let t=0;t<n.style.length;t++){const i=n.style.item(t);e+=cG(0,i,n.style.getPropertyValue(i))}for(const t in n.style)n.style.hasOwnProperty(t)&&!t.startsWith("_")&&(e+=cG(0,XEe(t),n.style[t]));n.setAttribute("style",e)}function lu(n,e,t){n.style&&(Object.keys(e).forEach(i=>{const r=JN(i);t&&!t.hasOwnProperty(i)&&(t[i]=n.style[r]),n.style[r]=e[i]}),VN()&&uG(n))}function qf(n,e){n.style&&(Object.keys(e).forEach(t=>{const i=JN(t);n.style[i]=""}),VN()&&uG(n))}const KEe=/-+([a-z0-9])/g;function JN(n){return n.replace(KEe,(...e)=>e[1].toUpperCase())}function XEe(n){return n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}class bm{constructor(e,t,i){this._element=e,this._startStyles=t,this._endStyles=i,this._state=0;let r=bm.initialStylesByElement.get(e);r||bm.initialStylesByElement.set(e,r={}),this._initialStyles=r}start(){this._state<1&&(this._startStyles&&lu(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(lu(this._element,this._initialStyles),this._endStyles&&(lu(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(bm.initialStylesByElement.delete(this._element),this._startStyles&&(qf(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(qf(this._element,this._endStyles),this._endStyles=null),lu(this._element,this._initialStyles),this._state=3)}}bm.initialStylesByElement=new WeakMap;const pc=new Gt("AnimationModuleType"),YG=new Fu("12.2.5"),_xe=new Gt("mat-sanity-checks",{providedIn:"root",factory:function(){return!0}});let Kf,gr=(()=>{class n{constructor(t,i,r){this._hasDoneGlobalChecks=!1,this._document=r,t._applyBodyHighContrastModeCssClasses(),this._sanityChecks=i,this._hasDoneGlobalChecks||(this._checkDoctypeIsDefined(),this._checkThemeIsPresent(),this._checkCdkVersionMatch(),this._hasDoneGlobalChecks=!0)}_getWindow(){const t=this._document.defaultView||window;return"object"==typeof t&&t?t:null}_checkIsEnabled(t){return!(!oa()||this._isTestEnv())&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[t])}_isTestEnv(){const t=this._getWindow();return t&&(t.__karma__||t.jasmine)}_checkDoctypeIsDefined(){this._checkIsEnabled("doctype")&&!this._document.doctype&&console.warn("Current document does not have a doctype. This may cause some Angular Material components not to behave as expected.")}_checkThemeIsPresent(){if(!this._checkIsEnabled("theme")||!this._document.body||"function"!=typeof getComputedStyle)return;const t=this._document.createElement("div");t.classList.add("mat-theme-loaded-marker"),this._document.body.appendChild(t);const i=getComputedStyle(t);i&&"none"!==i.display&&console.warn("Could not find Angular Material core theme. Most Material components may not work as expected. For more info refer to the theming guide: https://material.angular.io/guide/theming"),this._document.body.removeChild(t)}_checkCdkVersionMatch(){this._checkIsEnabled("version")&&YG.full!==q6.full&&console.warn("The Angular Material version ("+YG.full+") does not match the Angular CDK version ("+q6.full+").\nPlease ensure the versions of these two packages exactly match.")}}return n.\u0275fac=function(t){return new(t||n)(Ie($6),Ie(_xe,8),Ie(un))},n.\u0275mod=an({type:n}),n.\u0275inj=Ct({imports:[[yv],yv]}),n})();function aC(n){return class extends n{constructor(...e){super(...e),this._disabled=!1}get disabled(){return this._disabled}set disabled(e){this._disabled=Yi(e)}}}function wv(n,e){return class extends n{constructor(...t){super(...t),this.defaultColor=e,this.color=e}get color(){return this._color}set color(t){const i=t||this.defaultColor;i!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove(`mat-${this._color}`),i&&this._elementRef.nativeElement.classList.add(`mat-${i}`),this._color=i)}}}function pP(n){return class extends n{constructor(...e){super(...e),this._disableRipple=!1}get disableRipple(){return this._disableRipple}set disableRipple(e){this._disableRipple=Yi(e)}}}function gP(n,e=0){return class extends n{constructor(...t){super(...t),this._tabIndex=e,this.defaultTabIndex=e}get tabIndex(){return this.disabled?-1:this._tabIndex}set tabIndex(t){this._tabIndex=null!=t?za(t):this.defaultTabIndex}}}try{Kf="undefined"!=typeof Intl}catch(n){Kf=!1}class Ixe{constructor(e,t,i){this._renderer=e,this.element=t,this.config=i,this.state=3}fadeOut(){this._renderer.fadeOutRipple(this)}}const QG={enterDuration:225,exitDuration:150},mP=pm({passive:!0}),ZG=["mousedown","touchstart"],JG=["mouseup","mouseleave","touchend","touchcancel"];class Rxe{constructor(e,t,i,r){this._target=e,this._ngZone=t,this._isPointerDown=!1,this._activeRipples=new Set,this._pointerUpEventsRegistered=!1,r.isBrowser&&(this._containerElement=id(i))}fadeInRipple(e,t,i={}){const r=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),s=Object.assign(Object.assign({},QG),i.animation);i.centered&&(e=r.left+r.width/2,t=r.top+r.height/2);const o=i.radius||function(n,e,t){const i=Math.max(Math.abs(n-t.left),Math.abs(n-t.right)),r=Math.max(Math.abs(e-t.top),Math.abs(e-t.bottom));return Math.sqrt(i*i+r*r)}(e,t,r),a=e-r.left,l=t-r.top,c=s.enterDuration,u=document.createElement("div");u.classList.add("mat-ripple-element"),u.style.left=a-o+"px",u.style.top=l-o+"px",u.style.height=2*o+"px",u.style.width=2*o+"px",null!=i.color&&(u.style.backgroundColor=i.color),u.style.transitionDuration=`${c}ms`,this._containerElement.appendChild(u),function(n){window.getComputedStyle(n).getPropertyValue("opacity")}(u),u.style.transform="scale(1)";const h=new Ixe(this,u,i);return h.state=0,this._activeRipples.add(h),i.persistent||(this._mostRecentTransientRipple=h),this._runTimeoutOutsideZone(()=>{const f=h===this._mostRecentTransientRipple;h.state=1,!i.persistent&&(!f||!this._isPointerDown)&&h.fadeOut()},c),h}fadeOutRipple(e){const t=this._activeRipples.delete(e);if(e===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),this._activeRipples.size||(this._containerRect=null),!t)return;const i=e.element,r=Object.assign(Object.assign({},QG),e.config.animation);i.style.transitionDuration=`${r.exitDuration}ms`,i.style.opacity="0",e.state=2,this._runTimeoutOutsideZone(()=>{e.state=3,i.parentNode.removeChild(i)},r.exitDuration)}fadeOutAll(){this._activeRipples.forEach(e=>e.fadeOut())}fadeOutAllNonPersistent(){this._activeRipples.forEach(e=>{e.config.persistent||e.fadeOut()})}setupTriggerEvents(e){const t=id(e);!t||t===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=t,this._registerEvents(ZG))}handleEvent(e){"mousedown"===e.type?this._onMousedown(e):"touchstart"===e.type?this._onTouchStart(e):this._onPointerUp(),this._pointerUpEventsRegistered||(this._registerEvents(JG),this._pointerUpEventsRegistered=!0)}_onMousedown(e){const t=F6(e),i=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!t&&!i&&(this._isPointerDown=!0,this.fadeInRipple(e.clientX,e.clientY,this._target.rippleConfig))}_onTouchStart(e){if(!this._target.rippleDisabled&&!L6(e)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const t=e.changedTouches;for(let i=0;i<t.length;i++)this.fadeInRipple(t[i].clientX,t[i].clientY,this._target.rippleConfig)}}_onPointerUp(){!this._isPointerDown||(this._isPointerDown=!1,this._activeRipples.forEach(e=>{!e.config.persistent&&(1===e.state||e.config.terminateOnPointerUp&&0===e.state)&&e.fadeOut()}))}_runTimeoutOutsideZone(e,t=0){this._ngZone.runOutsideAngular(()=>setTimeout(e,t))}_registerEvents(e){this._ngZone.runOutsideAngular(()=>{e.forEach(t=>{this._triggerElement.addEventListener(t,this,mP)})})}_removeTriggerEvents(){this._triggerElement&&(ZG.forEach(e=>{this._triggerElement.removeEventListener(e,this,mP)}),this._pointerUpEventsRegistered&&JG.forEach(e=>{this._triggerElement.removeEventListener(e,this,mP)}))}}const Fxe=new Gt("mat-ripple-global-options");let wm=(()=>{class n{constructor(t,i,r,s,o){this._elementRef=t,this._animationMode=o,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=s||{},this._rippleRenderer=new Rxe(this,i,t,r)}get disabled(){return this._disabled}set disabled(t){t&&this.fadeOutAllNonPersistent(),this._disabled=t,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(t){this._trigger=t,this._setupTriggerEventsIfEnabled()}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:Object.assign(Object.assign(Object.assign({},this._globalOptions.animation),"NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{}),this.animation),terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(t,i=0,r){return"number"==typeof t?this._rippleRenderer.fadeInRipple(t,i,Object.assign(Object.assign({},this.rippleConfig),r)):this._rippleRenderer.fadeInRipple(0,0,Object.assign(Object.assign({},this.rippleConfig),t))}}return n.\u0275fac=function(t){return new(t||n)(De(En),De(yn),De(Ki),De(Fxe,8),De(pc,8))},n.\u0275dir=Bt({type:n,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(t,i){2&t&&Ti("mat-ripple-unbounded",i.unbounded)},inputs:{radius:["matRippleRadius","radius"],disabled:["matRippleDisabled","disabled"],trigger:["matRippleTrigger","trigger"],color:["matRippleColor","color"],unbounded:["matRippleUnbounded","unbounded"],centered:["matRippleCentered","centered"],animation:["matRippleAnimation","animation"]},exportAs:["matRipple"]}),n})(),cC=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=an({type:n}),n.\u0275inj=Ct({imports:[[gr,gv],gr]}),n})();function ld(n,e,t,i){return Y(t)&&(i=t,t=void 0),i?ld(n,e,t).pipe(me(r=>F(r)?i(...r):i(r))):new O(r=>{r$(n,e,function(o){r.next(arguments.length>1?Array.prototype.slice.call(arguments):o)},r,t)})}function r$(n,e,t,i,r){let s;if(function(n){return n&&"function"==typeof n.addEventListener&&"function"==typeof n.removeEventListener}(n)){const o=n;n.addEventListener(e,t,r),s=()=>o.removeEventListener(e,t,r)}else if(function(n){return n&&"function"==typeof n.on&&"function"==typeof n.off}(n)){const o=n;n.on(e,t),s=()=>o.off(e,t)}else if(function(n){return n&&"function"==typeof n.addListener&&"function"==typeof n.removeListener}(n)){const o=n;n.addListener(e,t),s=()=>o.removeListener(e,t)}else{if(!n||!n.length)throw new TypeError("Invalid event target");for(let o=0,a=n.length;o<a;o++)r$(n[o],e,t,i,r)}i.add(s)}new class extends nc{flush(e){this.active=!0,this.scheduled=void 0;const{actions:t}=this;let i,r=-1,s=t.length;e=e||t.shift();do{if(i=e.execute(e.state,e.delay))break}while(++r<s&&(e=t.shift()));if(this.active=!1,i){for(;++r<s&&(e=t.shift());)e.unsubscribe();throw i}}}(class extends KE{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,i=0){return null!==i&&i>0?super.requestAsyncId(e,t,i):(e.actions.push(this),e.scheduled||(e.scheduled=requestAnimationFrame(()=>e.flush(null))))}recycleAsyncId(e,t,i=0){if(null!==i&&i>0||null===i&&this.delay>0)return super.recycleAsyncId(e,t,i);0===e.actions.length&&(cancelAnimationFrame(t),e.scheduled=void 0)}});let Xxe=1;const Qxe=Promise.resolve(),dC={};function s$(n){return n in dC&&(delete dC[n],!0)}const o$={setImmediate(n){const e=Xxe++;return dC[e]=!0,Qxe.then(()=>s$(e)&&n()),e},clearImmediate(n){s$(n)}};new class extends nc{flush(e){this.active=!0,this.scheduled=void 0;const{actions:t}=this;let i,r=-1,s=t.length;e=e||t.shift();do{if(i=e.execute(e.state,e.delay))break}while(++r<s&&(e=t.shift()));if(this.active=!1,i){for(;++r<s&&(e=t.shift());)e.unsubscribe();throw i}}}(class extends KE{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,i=0){return null!==i&&i>0?super.requestAsyncId(e,t,i):(e.actions.push(this),e.scheduled||(e.scheduled=o$.setImmediate(e.flush.bind(e,null))))}recycleAsyncId(e,t,i=0){if(null!==i&&i>0||null===i&&this.delay>0)return super.recycleAsyncId(e,t,i);0===e.actions.length&&(o$.clearImmediate(t),e.scheduled=void 0)}});function Sv(n){return!!n&&(n instanceof O||"function"==typeof n.lift&&"function"==typeof n.subscribe)}function fC(...n){return Rt(1)(tn(...n))}"undefined"!=typeof window&&window;class vTe{constructor(e,t){this.delay=e,this.scheduler=t}call(e,t){return t.subscribe(new xP(e,this.delay,this.scheduler))}}class xP extends y{constructor(e,t,i){super(e),this.delay=t,this.scheduler=i,this.queue=[],this.active=!1,this.errored=!1}static dispatch(e){const t=e.source,i=t.queue,r=e.scheduler,s=e.destination;for(;i.length>0&&i[0].time-r.now()<=0;)i.shift().notification.observe(s);if(i.length>0){const o=Math.max(0,i[0].time-r.now());this.schedule(e,o)}else this.unsubscribe(),t.active=!1}_schedule(e){this.active=!0,this.destination.add(e.schedule(xP.dispatch,this.delay,{source:this,destination:this.destination,scheduler:e}))}scheduleNotification(e){if(!0===this.errored)return;const t=this.scheduler,i=new bTe(t.now()+this.delay,e);this.queue.push(i),!1===this.active&&this._schedule(t)}_next(e){this.scheduleNotification(la.createNext(e))}_error(e){this.errored=!0,this.queue=[],this.destination.error(e),this.unsubscribe()}_complete(){this.scheduleNotification(la.createComplete()),this.unsubscribe()}}class bTe{constructor(e,t){this.time=e,this.notification=t}}function j$(...n){const e=n.length;if(0===e)throw new Error("list of properties cannot be empty.");return t=>me(function(n,e){return i=>{let r=i;for(let s=0;s<e;s++){const o=null!=r?r[n[s]]:void 0;if(void 0===o)return;r=o}return r}}(n,e))(t)}et(7266);class a1e{constructor(e){this.callback=e}call(e,t){return t.subscribe(new l1e(e,this.callback))}}class l1e extends y{constructor(e,t){super(e),this.add(new C(t))}}class Y${}class K${}class cu{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?this.lazyInit="string"==typeof e?()=>{this.headers=new Map,e.split("\n").forEach(t=>{const i=t.indexOf(":");if(i>0){const r=t.slice(0,i),s=r.toLowerCase(),o=t.slice(i+1).trim();this.maybeSetNormalizedName(r,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:()=>{this.headers=new Map,Object.keys(e).forEach(t=>{let i=e[t];const r=t.toLowerCase();"string"==typeof i&&(i=[i]),i.length>0&&(this.headers.set(r,i),this.maybeSetNormalizedName(t,r))})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof cu?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){const t=new cu;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof cu?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){const t=e.name.toLowerCase();switch(e.op){case"a":case"s":let i=e.value;if("string"==typeof i&&(i=[i]),0===i.length)return;this.maybeSetNormalizedName(e.name,t);const r=("a"===e.op?this.headers.get(t):void 0)||[];r.push(...i),this.headers.set(t,r);break;case"d":const s=e.value;if(s){let o=this.headers.get(t);if(!o)return;o=o.filter(a=>-1===s.indexOf(a)),0===o.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}else this.headers.delete(t),this.normalizedNames.delete(t)}}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}}class c1e{encodeKey(e){return X$(e)}encodeValue(e){return X$(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const d1e=/%(\d[a-f0-9])/gi,h1e={40:"@","3A":":",24:"$","2C":",","3B":";","2B":"+","3D":"=","3F":"?","2F":"/"};function X$(n){return encodeURIComponent(n).replace(d1e,(e,t)=>{var i;return null!==(i=h1e[t])&&void 0!==i?i:e})}function Q$(n){return`${n}`}class Pr{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new c1e,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function(n,e){const t=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(r=>{const s=r.indexOf("="),[o,a]=-1==s?[e.decodeKey(r),""]:[e.decodeKey(r.slice(0,s)),e.decodeValue(r.slice(s+1))],l=t.get(o)||[];l.push(a),t.set(o,l)}),t}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{const i=e.fromObject[t];this.map.set(t,Array.isArray(i)?i:[i])})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){const t=[];return Object.keys(e).forEach(i=>{const r=e[i];Array.isArray(r)?r.forEach(s=>{t.push({param:i,value:s,op:"a"})}):t.push({param:i,value:r,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const t=this.encoder.encodeKey(e);return this.map.get(e).map(i=>t+"="+this.encoder.encodeValue(i)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const t=new Pr({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const t=("a"===e.op?this.map.get(e.param):void 0)||[];t.push(Q$(e.value)),this.map.set(e.param,t);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let i=this.map.get(e.param)||[];const r=i.indexOf(Q$(e.value));-1!==r&&i.splice(r,1),i.length>0?this.map.set(e.param,i):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class Ys{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}keys(){return this.map.keys()}}function Z$(n){return"undefined"!=typeof ArrayBuffer&&n instanceof ArrayBuffer}function J$(n){return"undefined"!=typeof Blob&&n instanceof Blob}function eW(n){return"undefined"!=typeof FormData&&n instanceof FormData}class Cv{constructor(e,t,i,r){let s;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==i?i:null,s=r):s=i,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params)),this.headers||(this.headers=new cu),this.context||(this.context=new Ys),this.params){const o=this.params.toString();if(0===o.length)this.urlWithParams=t;else{const a=t.indexOf("?");this.urlWithParams=t+(-1===a?"?":a<t.length-1?"&":"")+o}}else this.params=new Pr,this.urlWithParams=t}serializeBody(){return null===this.body?null:Z$(this.body)||J$(this.body)||eW(this.body)||function(n){return"undefined"!=typeof URLSearchParams&&n instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof Pr?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||eW(this.body)?null:J$(this.body)?this.body.type||null:Z$(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Pr?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(e={}){var t;const i=e.method||this.method,r=e.url||this.url,s=e.responseType||this.responseType,o=void 0!==e.body?e.body:this.body,a=void 0!==e.withCredentials?e.withCredentials:this.withCredentials,l=void 0!==e.reportProgress?e.reportProgress:this.reportProgress;let c=e.headers||this.headers,u=e.params||this.params;const h=null!==(t=e.context)&&void 0!==t?t:this.context;return void 0!==e.setHeaders&&(c=Object.keys(e.setHeaders).reduce((f,g)=>f.set(g,e.setHeaders[g]),c)),e.setParams&&(u=Object.keys(e.setParams).reduce((f,g)=>f.set(g,e.setParams[g]),u)),new Cv(i,r,o,{params:u,headers:c,context:h,reportProgress:l,responseType:s,withCredentials:a})}}var _s=(()=>((_s=_s||{})[_s.Sent=0]="Sent",_s[_s.UploadProgress=1]="UploadProgress",_s[_s.ResponseHeader=2]="ResponseHeader",_s[_s.DownloadProgress=3]="DownloadProgress",_s[_s.Response=4]="Response",_s[_s.User=5]="User",_s))();class TP{constructor(e,t=200,i="OK"){this.headers=e.headers||new cu,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||i,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class AP extends TP{constructor(e={}){super(e),this.type=_s.ResponseHeader}clone(e={}){return new AP({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class bC extends TP{constructor(e={}){super(e),this.type=_s.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new bC({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class tW extends TP{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${e.url||"(unknown url)"}`:`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}}function MP(n,e){return{body:e,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials}}let cd=(()=>{class n{constructor(t){this.handler=t}request(t,i,r={}){let s;if(t instanceof Cv)s=t;else{let l,c;l=r.headers instanceof cu?r.headers:new cu(r.headers),r.params&&(c=r.params instanceof Pr?r.params:new Pr({fromObject:r.params})),s=new Cv(t,i,void 0!==r.body?r.body:null,{headers:l,context:r.context,params:c,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials})}const o=tn(s).pipe(function(n,e){return V(n,e,1)}(l=>this.handler.handle(l)));if(t instanceof Cv||"events"===r.observe)return o;const a=o.pipe(qi(l=>l instanceof bC));switch(r.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return a.pipe(me(l=>{if(null!==l.body&&!(l.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return l.body}));case"blob":return a.pipe(me(l=>{if(null!==l.body&&!(l.body instanceof Blob))throw new Error("Response is not a Blob.");return l.body}));case"text":return a.pipe(me(l=>{if(null!==l.body&&"string"!=typeof l.body)throw new Error("Response is not a string.");return l.body}));case"json":default:return a.pipe(me(l=>l.body))}case"response":return a;default:throw new Error(`Unreachable: unhandled observe type ${r.observe}}`)}}delete(t,i={}){return this.request("DELETE",t,i)}get(t,i={}){return this.request("GET",t,i)}head(t,i={}){return this.request("HEAD",t,i)}jsonp(t,i){return this.request("JSONP",t,{params:(new Pr).append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,i={}){return this.request("OPTIONS",t,i)}patch(t,i,r={}){return this.request("PATCH",t,MP(r,i))}post(t,i,r={}){return this.request("POST",t,MP(r,i))}put(t,i,r={}){return this.request("PUT",t,MP(r,i))}}return n.\u0275fac=function(t){return new(t||n)(Ie(Y$))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class nW{constructor(e,t){this.next=e,this.interceptor=t}handle(e){return this.interceptor.intercept(e,this.next)}}const iW=new Gt("HTTP_INTERCEPTORS");let g1e=(()=>{class n{intercept(t,i){return i.handle(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const m1e=/^\)\]\}',?\n/;let rW=(()=>{class n{constructor(t){this.xhrFactory=t}handle(t){if("JSONP"===t.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new O(i=>{const r=this.xhrFactory.build();if(r.open(t.method,t.urlWithParams),t.withCredentials&&(r.withCredentials=!0),t.headers.forEach((g,m)=>r.setRequestHeader(g,m.join(","))),t.headers.has("Accept")||r.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){const g=t.detectContentTypeHeader();null!==g&&r.setRequestHeader("Content-Type",g)}if(t.responseType){const g=t.responseType.toLowerCase();r.responseType="json"!==g?g:"text"}const s=t.serializeBody();let o=null;const a=()=>{if(null!==o)return o;const g=1223===r.status?204:r.status,m=r.statusText||"OK",w=new cu(r.getAllResponseHeaders()),S=function(n){return"responseURL"in n&&n.responseURL?n.responseURL:/^X-Request-URL:/m.test(n.getAllResponseHeaders())?n.getResponseHeader("X-Request-URL"):null}(r)||t.url;return o=new AP({headers:w,status:g,statusText:m,url:S}),o},l=()=>{let{headers:g,status:m,statusText:w,url:S}=a(),U=null;204!==m&&(U=void 0===r.response?r.responseText:r.response),0===m&&(m=U?200:0);let D=m>=200&&m<300;if("json"===t.responseType&&"string"==typeof U){const ie=U;U=U.replace(m1e,"");try{U=""!==U?JSON.parse(U):null}catch(_e){U=ie,D&&(D=!1,U={error:_e,text:U})}}D?(i.next(new bC({body:U,headers:g,status:m,statusText:w,url:S||void 0})),i.complete()):i.error(new tW({error:U,headers:g,status:m,statusText:w,url:S||void 0}))},c=g=>{const{url:m}=a(),w=new tW({error:g,status:r.status||0,statusText:r.statusText||"Unknown Error",url:m||void 0});i.error(w)};let u=!1;const h=g=>{u||(i.next(a()),u=!0);let m={type:_s.DownloadProgress,loaded:g.loaded};g.lengthComputable&&(m.total=g.total),"text"===t.responseType&&!!r.responseText&&(m.partialText=r.responseText),i.next(m)},f=g=>{let m={type:_s.UploadProgress,loaded:g.loaded};g.lengthComputable&&(m.total=g.total),i.next(m)};return r.addEventListener("load",l),r.addEventListener("error",c),r.addEventListener("timeout",c),r.addEventListener("abort",c),t.reportProgress&&(r.addEventListener("progress",h),null!==s&&r.upload&&r.upload.addEventListener("progress",f)),r.send(s),i.next({type:_s.Sent}),()=>{r.removeEventListener("error",c),r.removeEventListener("abort",c),r.removeEventListener("load",l),r.removeEventListener("timeout",c),t.reportProgress&&(r.removeEventListener("progress",h),null!==s&&r.upload&&r.upload.removeEventListener("progress",f)),r.readyState!==r.DONE&&r.abort()}})}}return n.\u0275fac=function(t){return new(t||n)(Ie(jB))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const DP=new Gt("XSRF_COOKIE_NAME"),IP=new Gt("XSRF_HEADER_NAME");class sW{}let y1e=(()=>{class n{constructor(t,i,r){this.doc=t,this.platform=i,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=DB(t,this.cookieName),this.lastCookieString=t),this.lastToken}}return n.\u0275fac=function(t){return new(t||n)(Ie(un),Ie(Hc),Ie(DP))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),OP=(()=>{class n{constructor(t,i){this.tokenService=t,this.headerName=i}intercept(t,i){const r=t.url.toLowerCase();if("GET"===t.method||"HEAD"===t.method||r.startsWith("http://")||r.startsWith("https://"))return i.handle(t);const s=this.tokenService.getToken();return null!==s&&!t.headers.has(this.headerName)&&(t=t.clone({headers:t.headers.set(this.headerName,s)})),i.handle(t)}}return n.\u0275fac=function(t){return new(t||n)(Ie(sW),Ie(IP))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),v1e=(()=>{class n{constructor(t,i){this.backend=t,this.injector=i,this.chain=null}handle(t){if(null===this.chain){const i=this.injector.get(iW,[]);this.chain=i.reduceRight((r,s)=>new nW(r,s),this.backend)}return this.chain.handle(t)}}return n.\u0275fac=function(t){return new(t||n)(Ie(K$),Ie(zn))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),b1e=(()=>{class n{static disable(){return{ngModule:n,providers:[{provide:OP,useClass:g1e}]}}static withOptions(t={}){return{ngModule:n,providers:[t.cookieName?{provide:DP,useValue:t.cookieName}:[],t.headerName?{provide:IP,useValue:t.headerName}:[]]}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=an({type:n}),n.\u0275inj=Ct({providers:[OP,{provide:iW,useExisting:OP,multi:!0},{provide:sW,useClass:y1e},{provide:DP,useValue:"XSRF-TOKEN"},{provide:IP,useValue:"X-XSRF-TOKEN"}]}),n})(),oW=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=an({type:n}),n.\u0275inj=Ct({providers:[cd,{provide:Y$,useClass:v1e},rW,{provide:K$,useExisting:rW}],imports:[[b1e.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),n})();function Mv(n){return!0===n}function $a(n){return null==n}function Wa(n){return!$a(n)}function UP(n){return Boolean(n)}function NW(n){return $a(n)?n:JSON.parse(JSON.stringify(n))}et(5478),Object.create(Error.prototype),new Gt("SECURITY_CONTEXT");const IC=n=>{const t=n instanceof Date;if("object"!=typeof n||null===n||t)return n;Object.freeze(n);const r="function"==typeof n,s=Object.prototype.hasOwnProperty;return Object.getOwnPropertyNames(n).forEach(o=>{s.call(n,o)&&(!r||"caller"!==o&&"callee"!==o&&"arguments"!==o)&&null!==n[o]&&("object"==typeof n[o]||"function"==typeof n[o])&&!Object.isFrozen(n[o])&&IC(n[o])}),n};function PW(n){return Wa(n)&&"object"==typeof n&&function(n){return"[object Object]"===Object.prototype.toString.call(n)}(n)}const kW="NGXS_DATA_META",HP="NGXS_META",BW="NGXS_ARGUMENT_REGISTRY_META";let VW=(()=>{class n{constructor(t){this.sequence$=new Nr(0),this.subscription=null,t&&(this.subscription=t.subscribe(()=>this.updateSequence()))}get sequenceValue(){return this.sequence$.getValue()}ngOnDestroy(){var t;this.sequence$.next(0),null===(t=this.subscription)||void 0===t||t.unsubscribe()}updateSequence(){this.sequence$.next(this.sequenceValue+1)}}return n.\u0275fac=function(t){return new(t||n)(Ie(gh,8))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();function Dv(n){return n[kW]}let qa=(()=>{class n{constructor(t,i,r){n.store=t.get(gh),n.ngZone=t.get(yn),n.factory=i,n.context=r,n.computed=t.get(VW)}}return n.store=null,n.computed=null,n.context=null,n.factory=null,n.ngZone=null,n.\u0275fac=function(t){return new(t||n)(Ie(zn),Ie(q8),Ie(W8))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class us{constructor(){us.statesCachedMeta.clear()}static createStateContext(e){return qa.context.createStateContext(e)}static ensureMappedState(e){if($a(qa.factory)||$a(e))throw new Error("Metadata not created \n Maybe you forgot to import the NgxsDataPluginModule\n Also, you cannot use this.ctx.* until the application is fully rendered \n (use by default ngxsOnInit(ctx: StateContext), or ngxsAfterBootstrap(ctx: StateContext) !!!");return(Wa(e.name)?us.statesCachedMeta.get(e.name):null)||us.ensureMeta(e)}static getRepositoryByInstance(e){var t;const r=null!==(t=Dv(us.getStateClassByInstance(e)))&&void 0!==t?t:null;if($a(r))throw new Error("You forgot add decorator @StateRepository or initialize state!\nExample: NgxsModule.forRoot([ .. ]), or NgxsModule.forFeature([ .. ])");return r}static getStateClassByInstance(e){return(null!=e?e:{}).constructor}static clearMetaByInstance(e){const t=us.getRepositoryByInstance(e);t.stateMeta.actions={},t.operations={}}static createPayload(e,t){const i={},r=Array.from(e);for(let s=0;s<r.length;s++){const o=null==t?void 0:t.getPayloadTypeByIndex(s);Wa(o)&&(i[o]=r[s])}return Object.keys(i).length>0?i:null}static createAction(e,t,i){const r=us.createPayload(t,i);return new(function(n){return class{constructor(t){t&&Object.keys(t).forEach(i=>{this[i]=t[i]})}static get type(){return n}}}(e.type))(r)}static ensureMeta(e){var t;const i=Wa(e.name)?null===(t=qa.factory.states)||void 0===t?void 0:t.find(r=>r.name===e.name):null;return Wa(i)&&Wa(e.name)&&us.statesCachedMeta.set(e.name,i),i}}us.statesCachedMeta=new Map,us.\u0275fac=function(e){return new(e||us)},us.\u0275prov=We({token:us,factory:us.\u0275fac}),new Sf(1);class mMe extends Error{constructor(e){super(`Child states can only be added to an object. Cannot convert ${Wa(null==e?void 0:e.constructor)?e.constructor.name:e} to PlainObject`)}}function jW(n){var e;return null!==(e=n.NGXS_OPTIONS_META)&&void 0!==e?e:{name:""}}function UW(n){var e;const t=jW(n),i=null!==(e=t.children)&&void 0!==e?e:[],s=NW(void 0===t.defaults?{}:t.defaults);if(i.length){if(PW(s))return function(n,e){return e.reduce((t,i)=>{const r=jW(i);if(function(n){const e="string"==typeof n?n.trim():n;return[void 0,null,NaN,"",1/0].includes(e)}(r.name))throw new Error("State name not provided in class");return t[r.name.toString()]=UW(i),t},null!=n?n:{})}(s,i);throw new mMe(s)}return s}function HW(n){var e;return null!==(e=n.__NGXS_COMPUTED_OPTION__)&&void 0!==e?e:null}function GW(){var n,e;return null!==(e=null===(n=null==qa?void 0:qa.computed)||void 0===n?void 0:n.sequenceValue)&&void 0!==e?e:0}function bMe(n){let e=!1;return Sv(n)&&(e=!0),e}function GP(n){return n[BW]}class wMe extends Error{constructor(e,t){super(`An argument with the name '${e}' already exists in the method '${t}'`)}}class EMe{constructor(){this.payloadMap=new Map,this.argumentMap=new Map}getPayloadTypeByIndex(e){var t;return null!==(t=this.payloadMap.get(e))&&void 0!==t?t:null}getArgumentNameByIndex(e){var t;return null!==(t=this.argumentMap.get(e))&&void 0!==t?t:null}createPayloadType(e,t,i){this.checkDuplicateName(e,t),this.payloadMap.set(i,e),this.payloadMap.set(e,e)}createArgumentName(e,t,i){this.checkDuplicateName(e,t),this.argumentMap.set(i,e),this.argumentMap.set(e,e)}checkDuplicateName(e,t){if(UP(this.argumentMap.has(e))||UP(this.payloadMap.has(e)))throw new wMe(e,t)}}function MMe(n){return{enumerable:!0,configurable:!0,get(){const e=Dv(n),t=us.ensureMappedState(e.stateMeta);return us.createStateContext(t)}}}function $W(){return(n,e,t)=>{!function(n,e){if(!function(n,e){var t;let i=n,r=!1;if(PW(i))for(;null!==i;){if(Mv(null==i?void 0:i.hasOwnProperty(e))){r=!!(null===(t=Object.getOwnPropertyDescriptor(i,e))||void 0===t?void 0:t.get);break}i=Object.getPrototypeOf(i)}return r}(n,null==e?void 0:e.toString()))throw new Error(`The method must be a getter for the computed decorator to work properly.\nExample: \n@Computed() get ${e.toString()}() { \n\t .. \n}`)}(n,e);const i=t.get;return t.get=function(...r){const s=function(n){return $a(HW(n))&&Object.defineProperties(n,{__NGXS_COMPUTED_OPTION__:{enumerable:!0,configurable:!0,value:new WeakMap}}),HW(n)}(this),o=null==s?void 0:s.get(i);if(Mv(null==o?void 0:o.isObservable))return null==o?void 0:o.value;if($a(o)||o.sequenceId!==GW()){s.delete(i);const l=i.apply(this,r);return s.set(i,{value:l,sequenceId:GW(),isObservable:bMe(l)}),l}return o.value},t}}const PMe={cancelUncompleted:!0,insideZone:!1};function $P(n=PMe){return(e,t,i)=>{!function(n,e){if(n.hasOwnProperty("prototype"))throw new Error("Cannot support static methods with @DataAction()");if(void 0===e)throw new Error("@DataAction() can only decorate a method implementation")}(e,i);const r=i.value,s=t.toString();return i.value=function(...o){const a=this;let l=null;const c=us.getRepositoryByInstance(a),u=c.operations;let h=u[s];const f=c.stateMeta,g=GP(r);if($a(h)){const D=function(n){var e,t,i;return null!==(i=null===(t=null===(e=(n+"").replace(/[/][/].*$/gm,"").replace(/\s+/g,"").replace(/[/][*][^/*]*[*][/]/g,"").split("){",1))||void 0===e?void 0:e[0])||void 0===t?void 0:t.replace(/^[^(]*[(]/,"").replace(/=[^,]+/g,"").split(",").filter(Boolean))&&void 0!==i?i:[]}(r),ie=function(n){const{statePath:e,argumentsNames:t,methodName:i,argumentRegistry:r}=n;let s="";for(let o=0;o<t.length;o++)Wa(null==r?void 0:r.getArgumentNameByIndex(o))?s+=null==r?void 0:r.getArgumentNameByIndex(o):Wa(null==r?void 0:r.getPayloadTypeByIndex(o))?s+=null==r?void 0:r.getPayloadTypeByIndex(o):s+=`$arg${o}`,o!==t.length-1&&(s+=", ");return`@${e.replace(/\./g,"/")}.${i}(${s})`}({statePath:f.path,methodName:s,argumentsNames:D,argumentRegistry:g});h=u[s]={type:ie,options:{cancelUncompleted:n.cancelUncompleted}},f.actions[h.type]=[{type:h.type,options:h.options,fn:h.type}]}us.ensureMappedState(f).instance[h.type]=()=>{var D;return Mv(n.insideZone)?null===(D=qa.ngZone)||void 0===D||D.run(()=>{l=r.apply(a,o)}):l=r.apply(a,o),Sv(l)?tn(null).pipe(me(()=>l)):l};const S=us.createAction(h,o,g),U=qa.store.dispatch(S);return Sv(l)?function(n,e){return sv([n,e]).pipe(me(t=>t.pop()))}(U,l):l},i}}function WW(n){return(e,t,i)=>{const r=n.trim();if(!r)throw new Error("Payload name should be initialized");(function(n,e){const t=n[e];return $a(GP(t))&&Object.defineProperties(t,{[BW]:{enumerable:!0,configurable:!0,value:new EMe}}),GP(t)})(e,t).createPayloadType(r,t,i)}}function LMe(){return n=>{const e=function(n){if(function(n){return!UP(n)}(n.hasOwnProperty(HP))){const e={name:null,actions:{},defaults:{},path:null,makeRootSelector:t=>t.getStateGetter(e.name),children:[]};Object.defineProperty(n,HP,{value:e})}return function(n){var e;return null===(e=n)||void 0===e?void 0:e[HP]}(n)}(n);if($a(e.name))throw new Error("@StateRepository should be add before decorator @State");!function(n,e){(function(n){var e;const t=null!==(e=Dv(n))&&void 0!==e?e:null;return($a(t)||(null==t?void 0:t.stateClass)!==n)&&function(n){Object.defineProperty(n,kW,{writable:!0,configurable:!0,enumerable:!0,value:{stateMeta:null,operations:{},stateClass:n}})}(n),Dv(n)}(n)).stateMeta=e}(n,e),function(n,e,t){Object.defineProperties(n.prototype,{name:{enumerable:!0,configurable:!0,value:e.name},initialState:{enumerable:!0,configurable:!0,get:()=>NW(t)},context:MMe(n)})}(n,e,UW(n)),function(n){var e,t;const i=Dv(n),r=null!==(t=null===(e=null==i?void 0:i.stateMeta)||void 0===e?void 0:e.name)&&void 0!==t?t:null;if(Wa(r)){const s=`__${r}__selector`;Object.defineProperties(n.prototype,{[s]:{writable:!0,enumerable:!1,configurable:!0},state$:{enumerable:!0,configurable:!0,get(){if(Wa(this[s]))return this[s];if($a(qa.store))throw new Error("Metadata not created \n Maybe you forgot to import the NgxsDataPluginModule\n Also, you cannot use this.ctx.* until the application is fully rendered \n (use by default ngxsOnInit(ctx: StateContext), or ngxsAfterBootstrap(ctx: StateContext) !!!");return this[s]=qa.store.select(n).pipe(me(o=>oa()?IC(o):o),Va({refCount:!0,bufferSize:1})),this[s]}}})}}(n)}}let BMe=(()=>{class n{constructor(){this.browserStorageEvents$=new oe,this.isInitialised=!1,this.isBootstrapped=!1,this._dirty=!0}get dirty(){return this._dirty}set dirty(t){this._dirty=t}ngxsOnChanges(t){var r;this.dirty&&this.isBootstrapped&&(this.dirty=!1,null===(r=this.ngxsDataDoCheck)||void 0===r||r.call(this))}ngxsOnInit(){this.isInitialised=!0}ngxsAfterBootstrap(){var i;this.isBootstrapped=!0,this.dirty&&(this.dirty=!1,null===(i=this.ngxsDataDoCheck)||void 0===i||i.call(this))}markAsDirtyAfterReset(){var i;this.dirty=!0,null===(i=this.ngxsDataAfterReset)||void 0===i||i.call(this)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),VMe=(()=>{class n extends BMe{get snapshot(){return function(n){return oa()?IC(n):n}(this.getState())}get ctx(){return function(n){if(!n)throw new Error("You forgot add decorator @StateRepository or initialize state!\nExample: NgxsModule.forRoot([ .. ]), or NgxsModule.forFeature([ .. ])");return Object.assign(Object.assign({},n),{getState:()=>oa()?IC(n.getState()):n.getState(),setState(e){n.setState(e)},patchState(e){n.patchState(e)}})}(this.context)}getState(){return this.ctx.getState()}dispatch(t){return this.ctx.dispatch(t)}patchState(t){this.ctx.patchState(t)}setState(t){this.ctx.setState(t)}reset(){this.ctx.setState(this.initialState),this.markAsDirtyAfterReset()}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=$i(n)))(i||n)}}(),n.\u0275prov=We({token:n,factory:n.\u0275fac}),Or([$W(),ic("design:type",Object),ic("design:paramtypes",[])],n.prototype,"snapshot",null),Or([$P(),tV(0,WW("patchValue")),ic("design:type",Function),ic("design:paramtypes",[Object]),ic("design:returntype",void 0)],n.prototype,"patchState",null),Or([$P(),tV(0,WW("stateValue")),ic("design:type",Function),ic("design:paramtypes",[Object]),ic("design:returntype",void 0)],n.prototype,"setState",null),Or([$P(),ic("design:type",Function),ic("design:paramtypes",[]),ic("design:returntype",void 0)],n.prototype,"reset",null),n})(),J7=(()=>{class n{constructor(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=Bt({type:n,selectors:[["","gaEvent","","gaCategory",""],["","gaCategory",""]],inputs:{gaCategory:"gaCategory"},exportAs:["gaCategory"]}),n})();const Rm=new Gt("ngx-google-analytics-settings",{factory:()=>({trackingCode:"",enableTracing:!1})}),gF=new Gt("ngx-window",{providedIn:"root",factory:()=>function(n){return wf(n)?window:null}(Oc(Hc))}),oOe=new Gt("ngx-data-layer",{providedIn:"root",factory:()=>function(n){return n?n.dataLayer=n.dataLayer||[]:null}(Oc(gF))}),mF=new Gt("ngx-gtag-fn",{providedIn:"root",factory:()=>function(n,e){return n?n.gtag=n.gtag||function(){e.push(arguments)}:null}(Oc(gF),Oc(oOe))});let YC=(()=>{class n{constructor(t,i,r){this.settings=t,this._document=i,this._gtag=r}get document(){return this._document}throw(t){(this.settings.enableTracing||oa())&&console&&console.error&&console.error(t)}toKeyValue(t){return t.size>0?Array.from(t).reduce((i,[r,s])=>Object.defineProperty(i,r,{value:s,enumerable:!0}),{}):void 0}gtag(...t){try{this._gtag(...t.filter(i=>void 0!==i))}catch(i){this.throw(i)}}event(t,i,r,s,o){try{const a=new Map;i&&a.set("event_category",i),r&&a.set("event_label",r),s&&a.set("value",s),void 0!==o&&a.set("interaction",o);const l=this.toKeyValue(a);l?this.gtag("event",t,l):this.gtag("event",t)}catch(a){this.throw(a)}}pageView(t,i,r,s){try{const o=new Map([["page_path",t]]);i&&o.set("page_title",i),(r||this.document)&&o.set("page_location",r||this.document.location.href),s&&Object.entries(s).map(([a,l])=>o.set(a,l)),this.gtag("config",this.settings.trackingCode,this.toKeyValue(o))}catch(o){this.throw(o)}}appView(t,i,r,s,o){try{const a=new Map([["screen_name",t],["app_name",i]]);r&&a.set("app_id",r),s&&a.set("app_version",s),o&&a.set("app_installer_id",o),this.gtag("event","screen_view",this.toKeyValue(a))}catch(a){this.throw(a)}}set(...t){try{this._gtag("set",...t)}catch(i){this.throw(i)}}exception(t,i){try{const r=new Map;t&&r.set("description",t),i&&r.set("fatal",i),this.toKeyValue(r)?this.gtag("event","exception",this.toKeyValue(r)):this.gtag("event","exception")}catch(r){this.throw(r)}}}return n.\u0275fac=function(t){return new(t||n)(Ie(Rm),Ie(un),Ie(mF))},n.\u0275prov=We({factory:function(){return new n(Ie(Rm),Ie(un),Ie(mF))},token:n,providedIn:"root"}),n})(),e9=(()=>{class n{constructor(t,i,r,s){this.gaCategoryDirective=t,this.gaService=i,this.settings=r,this.el=s,this.gaBind="click"}set gaBind(t){this.bindSubscription&&this.bindSubscription.unsubscribe(),this._gaBind=t,this.bindSubscription=ld(this.el.nativeElement,t).subscribe(()=>this.trigger())}get gaBind(){return this._gaBind}ngOnDestroy(){this.bindSubscription&&this.bindSubscription.unsubscribe()}trigger(){try{if(!this.gaAction&&!this.gaEvent)throw new Error("You must provide a gaAction attribute to identify this event.");this.gaService.event(this.gaAction||this.gaEvent,this.gaCategoryDirective?this.gaCategoryDirective.gaCategory:void 0,this.gaLabel||this.label,this.gaValue,this.gaInteraction)}catch(t){this.throw(t)}}throw(t){(oa()||this.settings.enableTracing)&&console&&console.warn&&console.warn(t)}}return n.\u0275fac=function(t){return new(t||n)(De(J7,8),De(YC),De(Rm),De(En))},n.\u0275dir=Bt({type:n,selectors:[["","gaEvent",""]],inputs:{gaBind:"gaBind",gaAction:"gaAction",gaLabel:"gaLabel",label:"label",gaValue:"gaValue",gaInteraction:"gaInteraction",gaEvent:"gaEvent"},exportAs:["gaEvent"]}),n})();const lOe={provide:mf,multi:!0,useFactory:function(n,e,t){return()=>Pi(this,void 0,void 0,function*(){var i;if(!n.trackingCode)return void(oa()||console.error("Empty tracking code for Google Analytics. Make sure to provide one when initializing NgxGoogleAnalyticsModule."));if(!e)return void(oa()||console.error("Was not possible create or read gtag() fn. Make sure this module is running on a Browser w/ access to Window interface."));t||oa()||console.error("Was not possible to access Document interface. Make sure this module is running on a Browser w/ access do Document interface."),n.uri=n.uri||`https://www.googletagmanager.com/gtag/js?id=${n.trackingCode}`,n.initCommands=null!==(i=null==n?void 0:n.initCommands)&&void 0!==i?i:[],n.initCommands.find(o=>"config"===o.command)||n.initCommands.unshift({command:"config",values:[n.trackingCode]}),n.initCommands.find(o=>"js"===o.command)||n.initCommands.unshift({command:"js",values:[new Date]});for(const o of n.initCommands)e(o.command,...o.values);const r=t.createElement("script");r.async=!0,r.src=n.uri,n.nonce&&r.setAttribute("nonce",n.nonce),t.getElementsByTagName("head")[0].appendChild(r)})},deps:[Rm,mF,un]};new Gt("ngx-google-analytics-routing-settings",{factory:()=>({})});let KC=(()=>{class n{static forRoot(t,i=[],r,s,o){return{ngModule:n,providers:[{provide:Rm,useValue:{trackingCode:t,initCommands:i,uri:r,enableTracing:s,nonce:o}},lOe]}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=an({type:n}),n.\u0275inj=Ct({imports:[[]]}),n})(),XC=(()=>{class n{constructor(){this.consent="not-set",this.consentChange=new Sf(1),this.consentChange.next(this.consent)}ngOnDestroy(){this.consentChange.complete()}setConsent(t){this.consent!==t&&(this.consent=t,this.consentChange.next(t))}unsetConsent(){this.setConsent("not-set")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),hOe=(()=>{class n{constructor(t,i,{trackingCode:r}){this.window=i,this.subscriptions=new C,this.token=r,this.subscriptions.add(t.consentChange.subscribe(s=>this.toggleGoogleAnalytics("rescinded"===s)))}ngOnDestroy(){this.subscriptions.unsubscribe()}toggleGoogleAnalytics(t){this.window&&(this.window[`ga-disable-${this.token}`]=t)}}return n.\u0275fac=function(t){return new(t||n)(Ie(XC),Ie(gF),Ie(Rm))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const fOe=new Gt("Key under which consent is stored",{providedIn:"root",factory:()=>"ALLOW_TELEMETRY"}),i9=[XC,hOe,(()=>{class n{constructor(t,i){this.key=i,this.subscriptions=new C;try{this.storage=localStorage}catch(r){}t.setConsent(this.loadConsent()),this.subscriptions.add(t.consentChange.subscribe(r=>this.saveConsent(r)))}ngOnDestroy(){this.subscriptions.unsubscribe()}loadConsent(){var t,i;const r=null===(i=null===(t=this.storage)||void 0===t?void 0:t.getItem)||void 0===i?void 0:i.call(t,this.key);if(null==r)return"not-set";const s=r.trim().toLowerCase();switch(s){case"given":case"rescinded":return s;default:return"not-set"}}saveConsent(t){var i,r;null===(r=null===(i=this.storage)||void 0===i?void 0:i.setItem)||void 0===r||r.call(i,this.key,t)}}return n.\u0275fac=function(t){return new(t||n)(Ie(XC),Ie(fOe))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})()];function gOe(n){return Object.entries(n).reduce((e,[t,i])=>(null!=i&&(e[t]=`${i}`),e),{})}let _Oe=(()=>{class n{static forRoot(t){const{providers:i=[]}=KC.forRoot(t.gaToken,function(n){const{appName:e,projectName:t,developmentMode:i}=n;return[{command:"set",values:[gOe({appName:e,projectName:t,developmentMode:i})]}]}(t));return{ngModule:n,providers:i}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=an({type:n}),n.\u0275inj=Ct({providers:[...i9,{provide:mf,multi:!0,useFactory:()=>()=>{},deps:i9}],imports:[[KC]]}),n})();const wOe=(n,e)=>JSON.stringify(n)===JSON.stringify(e),EOe=n=>n.map(e=>void 0!==e?JSON.parse(JSON.stringify(e)):e),mc={storageStrategy:class extends class{}{constructor(){super(...arguments),this.cachePairs=[]}add(e,t,i){this.cachePairs.push(e)}addMany(e){this.cachePairs=e}updateAtIndex(e,t){Object.assign(this.cachePairs[e],t)}update(e,t){Object.assign(this.cachePairs[e],t)}getAll(){return this.cachePairs}removeAtIndex(e){this.cachePairs.splice(e,1)}remove(e){this.cachePairs.splice(e,1)}removeAll(){this.cachePairs.length=0}},globalCacheKey:"CACHE_STORAGE",promiseImplementation:Promise},SOe=new oe;function _c(n={}){return function(e,t,i){const r=n.cacheKey||e.constructor.name+"#"+t,s=i.value;if(i&&i.value){let o=n.storageStrategy?new n.storageStrategy:new mc.storageStrategy;const a=[];n.cacheModifier&&n.cacheModifier.subscribe(u=>o.addMany(u(o.getAll(r,this)),r,this)),Nn(SOe.asObservable(),n.cacheBusterObserver?n.cacheBusterObserver:u0()).subscribe(u=>{o.removeAll(r,this),a.length=0}),n.cacheResolver=n.cacheResolver||mc.cacheResolver||wOe,n.cacheHasher=n.cacheHasher||mc.cacheHasher||EOe,i.value=function(...u){const h=o.getAll(r,this);let f=n.cacheHasher(u),g=h.find(w=>n.cacheResolver(w.parameters,f));const m=a.find(w=>n.cacheResolver(w.parameters,f));if((n.maxAge||mc.maxAge)&&g&&g.created&&((new Date).getTime()-new Date(g.created).getTime()>(n.maxAge||mc.maxAge)?(o.remove?o.remove(h.indexOf(g),g,r,this):o.removeAtIndex(h.indexOf(g),r,this),g=null):(n.slidingExpiration||mc.slidingExpiration)&&(g.created=new Date,o.update?o.update(h.indexOf(g),g,r,this):o.updateAtIndex(h.indexOf(g),g,r,this))),g){const w=tn(g.response);return n.async?w.pipe(function(n,e=Fx){const i=function(n){return n instanceof Date&&!isNaN(+n)}(n)?+n-e.now():Math.abs(n);return r=>r.lift(new vTe(i,e))}(0)):w}if(m)return m.response;{const w=s.call(this,...u).pipe(function(n){return e=>e.lift(new a1e(n))}(()=>{const S=a.find(U=>n.cacheResolver(U.parameters,f));a.splice(a.indexOf(S),1)}),ur(S=>{(!n.shouldCacheDecider||n.shouldCacheDecider(S))&&((!(n.maxCacheCount||mc.maxCacheCount)||1===(n.maxCacheCount||mc.maxCacheCount)||(n.maxCacheCount||mc.maxCacheCount)&&(n.maxCacheCount||mc.maxCacheCount)<h.length+1)&&(o.remove?o.remove(0,h[0],r,this):o.removeAtIndex(0,r,this)),o.add({parameters:f,response:S,created:n.maxAge||mc.maxAge?new Date:null},r,this))}),function(n,e,t,i){const s=new Sf(1,void 0,i);return o=>_a(()=>s,undefined)(o)}(),$n());return a.push({parameters:f,response:w,created:new Date}),w}}}return i}}class xOe{encodeKey(e){return encodeURIComponent(e)}encodeValue(e){return encodeURIComponent(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const r9=new Gt("basePath");class Vv{constructor(e={}){this.apiKeys=e.apiKeys,this.username=e.username,this.password=e.password,this.accessToken=e.accessToken,this.basePath=e.basePath,this.withCredentials=e.withCredentials,this.encoder=e.encoder,this.credentials=e.credentials?e.credentials:{}}selectHeaderContentType(e){if(0===e.length)return;const t=e.find(i=>this.isJsonMime(i));return void 0===t?e[0]:t}selectHeaderAccept(e){if(0===e.length)return;const t=e.find(i=>this.isJsonMime(i));return void 0===t?e[0]:t}isJsonMime(e){const t=new RegExp("^(application/json|[^;/ \t]+/[^;/ \t]+[+]json)[ \t]*(;.*)?$","i");return null!==e&&(t.test(e)||"application/json-patch+json"===e.toLowerCase())}lookupCredential(e){const t=this.credentials[e];return"function"==typeof t?t():t}}let s9=(()=>{class n{constructor(t,i,r){this.httpClient=t,this.basePath="/v1",this.defaultHeaders=new cu,this.configuration=new Vv,r&&(this.configuration=r),"string"!=typeof this.configuration.basePath&&("string"!=typeof i&&(i=this.basePath),this.configuration.basePath=i),this.encoder=this.configuration.encoder||new xOe}addToHttpParams(t,i,r){return this.addToHttpParamsRecursive(t,i,r)}addToHttpParamsRecursive(t,i,r){if(null==i)return t;if("object"==typeof i)if(Array.isArray(i))i.forEach(s=>t=this.addToHttpParamsRecursive(t,s,r));else if(i instanceof Date){if(null==r)throw Error("key may not be null if value is Date");t=t.append(r,i.toISOString().substr(0,10))}else Object.keys(i).forEach(s=>t=this.addToHttpParamsRecursive(t,i[s],null!=r?`${r}.${s}`:s));else{if(null==r)throw Error("key may not be null if value is not object or array");t=t.append(r,i)}return t}aggregateResults(t,i="body",r=!1,s){const o=t.age,a=t.ageRange,l=t.bmi,c=t.bmiRange,u=t.cache,h=t.ontologyTerms,f=t.cellTypeTerms,g=t.providers,m=t.sex,w=t.spatial,S=t.technologies,U=t.token;let D=new Pr({encoder:this.encoder});null!=o&&(D=this.addToHttpParams(D,o,"age")),null!=a&&(D=this.addToHttpParams(D,a,"age-range")),null!=l&&(D=this.addToHttpParams(D,l,"bmi")),null!=c&&(D=this.addToHttpParams(D,c,"bmi-range")),null!=u&&(D=this.addToHttpParams(D,u,"cache")),h&&h.forEach(Ve=>{D=this.addToHttpParams(D,Ve,"ontology-terms")}),f&&f.forEach(Ve=>{D=this.addToHttpParams(D,Ve,"cell-type-terms")}),g&&g.forEach(Ve=>{D=this.addToHttpParams(D,Ve,"providers")}),null!=m&&(D=this.addToHttpParams(D,m,"sex")),w&&w.forEach(Ve=>{D=this.addToHttpParams(D,Ve,"spatial")}),S&&S.forEach(Ve=>{D=this.addToHttpParams(D,Ve,"technologies")}),null!=U&&(D=this.addToHttpParams(D,U,"token"));let ie=this.defaultHeaders,_e=s&&s.httpHeaderAccept;void 0===_e&&(_e=this.configuration.selectHeaderAccept(["application/json"])),void 0!==_e&&(ie=ie.set("Accept",_e));let Ne=s&&s.context;void 0===Ne&&(Ne=new Ys);let Pe="json";return _e&&(Pe=_e.startsWith("text")?"text":this.configuration.isJsonMime(_e)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/aggregate-results`,{context:Ne,params:D,responseType:Pe,withCredentials:this.configuration.withCredentials,headers:ie,observe:i,reportProgress:r})}cellTypeTermOccurences(t,i="body",r=!1,s){const o=t.age,a=t.ageRange,l=t.bmi,c=t.bmiRange,u=t.cache,h=t.ontologyTerms,f=t.cellTypeTerms,g=t.providers,m=t.sex,w=t.spatial,S=t.technologies,U=t.token;let D=new Pr({encoder:this.encoder});null!=o&&(D=this.addToHttpParams(D,o,"age")),null!=a&&(D=this.addToHttpParams(D,a,"age-range")),null!=l&&(D=this.addToHttpParams(D,l,"bmi")),null!=c&&(D=this.addToHttpParams(D,c,"bmi-range")),null!=u&&(D=this.addToHttpParams(D,u,"cache")),h&&h.forEach(Ve=>{D=this.addToHttpParams(D,Ve,"ontology-terms")}),f&&f.forEach(Ve=>{D=this.addToHttpParams(D,Ve,"cell-type-terms")}),g&&g.forEach(Ve=>{D=this.addToHttpParams(D,Ve,"providers")}),null!=m&&(D=this.addToHttpParams(D,m,"sex")),w&&w.forEach(Ve=>{D=this.addToHttpParams(D,Ve,"spatial")}),S&&S.forEach(Ve=>{D=this.addToHttpParams(D,Ve,"technologies")}),null!=U&&(D=this.addToHttpParams(D,U,"token"));let ie=this.defaultHeaders,_e=s&&s.httpHeaderAccept;void 0===_e&&(_e=this.configuration.selectHeaderAccept(["application/json"])),void 0!==_e&&(ie=ie.set("Accept",_e));let Ne=s&&s.context;void 0===Ne&&(Ne=new Ys);let Pe="json";return _e&&(Pe=_e.startsWith("text")?"text":this.configuration.isJsonMime(_e)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/cell-type-term-occurences`,{context:Ne,params:D,responseType:Pe,withCredentials:this.configuration.withCredentials,headers:ie,observe:i,reportProgress:r})}cellTypeTreeModel(t,i="body",r=!1,s){const o=t.cache,a=t.token;let l=new Pr({encoder:this.encoder});null!=o&&(l=this.addToHttpParams(l,o,"cache")),null!=a&&(l=this.addToHttpParams(l,a,"token"));let c=this.defaultHeaders,u=s&&s.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(c=c.set("Accept",u));let h=s&&s.context;void 0===h&&(h=new Ys);let f="json";return u&&(f=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/cell-type-tree-model`,{context:h,params:l,responseType:f,withCredentials:this.configuration.withCredentials,headers:c,observe:i,reportProgress:r})}dbStatus(t,i="body",r=!1,s){const o=t.token;let a=new Pr({encoder:this.encoder});null!=o&&(a=this.addToHttpParams(a,o,"token"));let l=this.defaultHeaders,c=s&&s.httpHeaderAccept;void 0===c&&(c=this.configuration.selectHeaderAccept(["application/json"])),void 0!==c&&(l=l.set("Accept",c));let u=s&&s.context;void 0===u&&(u=new Ys);let h="json";return c&&(h=c.startsWith("text")?"text":this.configuration.isJsonMime(c)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/db-status`,{context:u,params:a,responseType:h,withCredentials:this.configuration.withCredentials,headers:l,observe:i,reportProgress:r})}getSpatialPlacement(t,i="body",r=!1,s){const o=t.getSpatialPlacementRequest;if(null==o)throw new Error("Required parameter getSpatialPlacementRequest was null or undefined when calling getSpatialPlacement.");let a=this.defaultHeaders,l=s&&s.httpHeaderAccept;void 0===l&&(l=this.configuration.selectHeaderAccept(["application/json"])),void 0!==l&&(a=a.set("Accept",l));let c=s&&s.context;void 0===c&&(c=new Ys);const h=this.configuration.selectHeaderContentType(["application/json"]);void 0!==h&&(a=a.set("Content-Type",h));let f="json";return l&&(f=l.startsWith("text")?"text":this.configuration.isJsonMime(l)?"json":"blob"),this.httpClient.post(`${this.configuration.basePath}/get-spatial-placement`,o,{context:c,responseType:f,withCredentials:this.configuration.withCredentials,headers:a,observe:i,reportProgress:r})}gtexRuiLocations(t,i="body",r=!1,s){const o=t.cache;let a=new Pr({encoder:this.encoder});null!=o&&(a=this.addToHttpParams(a,o,"cache"));let l=this.defaultHeaders,c=s&&s.httpHeaderAccept;void 0===c&&(c=this.configuration.selectHeaderAccept(["application/json"])),void 0!==c&&(l=l.set("Accept",c));let u=s&&s.context;void 0===u&&(u=new Ys);let h="json";return c&&(h=c.startsWith("text")?"text":this.configuration.isJsonMime(c)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/gtex/rui_locations.jsonld`,{context:u,params:a,responseType:h,withCredentials:this.configuration.withCredentials,headers:l,observe:i,reportProgress:r})}hubmapRuiLocations(t,i="body",r=!1,s){const o=t.cache,a=t.token;let l=new Pr({encoder:this.encoder});null!=o&&(l=this.addToHttpParams(l,o,"cache")),null!=a&&(l=this.addToHttpParams(l,a,"token"));let c=this.defaultHeaders,u=s&&s.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(c=c.set("Accept",u));let h=s&&s.context;void 0===h&&(h=new Ys);let f="json";return u&&(f=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/hubmap/rui_locations.jsonld`,{context:h,params:l,responseType:f,withCredentials:this.configuration.withCredentials,headers:c,observe:i,reportProgress:r})}ontologyTermOccurences(t,i="body",r=!1,s){const o=t.age,a=t.ageRange,l=t.bmi,c=t.bmiRange,u=t.cache,h=t.ontologyTerms,f=t.cellTypeTerms,g=t.providers,m=t.sex,w=t.spatial,S=t.technologies,U=t.token;let D=new Pr({encoder:this.encoder});null!=o&&(D=this.addToHttpParams(D,o,"age")),null!=a&&(D=this.addToHttpParams(D,a,"age-range")),null!=l&&(D=this.addToHttpParams(D,l,"bmi")),null!=c&&(D=this.addToHttpParams(D,c,"bmi-range")),null!=u&&(D=this.addToHttpParams(D,u,"cache")),h&&h.forEach(Ve=>{D=this.addToHttpParams(D,Ve,"ontology-terms")}),f&&f.forEach(Ve=>{D=this.addToHttpParams(D,Ve,"cell-type-terms")}),g&&g.forEach(Ve=>{D=this.addToHttpParams(D,Ve,"providers")}),null!=m&&(D=this.addToHttpParams(D,m,"sex")),w&&w.forEach(Ve=>{D=this.addToHttpParams(D,Ve,"spatial")}),S&&S.forEach(Ve=>{D=this.addToHttpParams(D,Ve,"technologies")}),null!=U&&(D=this.addToHttpParams(D,U,"token"));let ie=this.defaultHeaders,_e=s&&s.httpHeaderAccept;void 0===_e&&(_e=this.configuration.selectHeaderAccept(["application/json"])),void 0!==_e&&(ie=ie.set("Accept",_e));let Ne=s&&s.context;void 0===Ne&&(Ne=new Ys);let Pe="json";return _e&&(Pe=_e.startsWith("text")?"text":this.configuration.isJsonMime(_e)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/ontology-term-occurences`,{context:Ne,params:D,responseType:Pe,withCredentials:this.configuration.withCredentials,headers:ie,observe:i,reportProgress:r})}ontologyTreeModel(t,i="body",r=!1,s){const o=t.cache,a=t.token;let l=new Pr({encoder:this.encoder});null!=o&&(l=this.addToHttpParams(l,o,"cache")),null!=a&&(l=this.addToHttpParams(l,a,"token"));let c=this.defaultHeaders,u=s&&s.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(c=c.set("Accept",u));let h=s&&s.context;void 0===h&&(h=new Ys);let f="json";return u&&(f=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/ontology-tree-model`,{context:h,params:l,responseType:f,withCredentials:this.configuration.withCredentials,headers:c,observe:i,reportProgress:r})}providerNames(t,i="body",r=!1,s){const o=t.cache,a=t.token;let l=new Pr({encoder:this.encoder});null!=o&&(l=this.addToHttpParams(l,o,"cache")),null!=a&&(l=this.addToHttpParams(l,a,"token"));let c=this.defaultHeaders,u=s&&s.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(c=c.set("Accept",u));let h=s&&s.context;void 0===h&&(h=new Ys);let f="json";return u&&(f=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/provider-names`,{context:h,params:l,responseType:f,withCredentials:this.configuration.withCredentials,headers:c,observe:i,reportProgress:r})}referenceOrganScene(t,i="body",r=!1,s){const o=t.organIri;if(null==o)throw new Error("Required parameter organIri was null or undefined when calling referenceOrganScene.");const a=t.age,l=t.ageRange,c=t.bmi,u=t.bmiRange,h=t.cache,f=t.ontologyTerms,g=t.cellTypeTerms,m=t.providers,w=t.sex,S=t.spatial,U=t.technologies,D=t.token;let ie=new Pr({encoder:this.encoder});null!=a&&(ie=this.addToHttpParams(ie,a,"age")),null!=l&&(ie=this.addToHttpParams(ie,l,"age-range")),null!=c&&(ie=this.addToHttpParams(ie,c,"bmi")),null!=u&&(ie=this.addToHttpParams(ie,u,"bmi-range")),null!=h&&(ie=this.addToHttpParams(ie,h,"cache")),f&&f.forEach(vt=>{ie=this.addToHttpParams(ie,vt,"ontology-terms")}),g&&g.forEach(vt=>{ie=this.addToHttpParams(ie,vt,"cell-type-terms")}),null!=o&&(ie=this.addToHttpParams(ie,o,"organ-iri")),m&&m.forEach(vt=>{ie=this.addToHttpParams(ie,vt,"providers")}),null!=w&&(ie=this.addToHttpParams(ie,w,"sex")),S&&S.forEach(vt=>{ie=this.addToHttpParams(ie,vt,"spatial")}),U&&U.forEach(vt=>{ie=this.addToHttpParams(ie,vt,"technologies")}),null!=D&&(ie=this.addToHttpParams(ie,D,"token"));let _e=this.defaultHeaders,Ne=s&&s.httpHeaderAccept;void 0===Ne&&(Ne=this.configuration.selectHeaderAccept(["application/json"])),void 0!==Ne&&(_e=_e.set("Accept",Ne));let Pe=s&&s.context;void 0===Pe&&(Pe=new Ys);let Ve="json";return Ne&&(Ve=Ne.startsWith("text")?"text":this.configuration.isJsonMime(Ne)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/reference-organ-scene`,{context:Pe,params:ie,responseType:Ve,withCredentials:this.configuration.withCredentials,headers:_e,observe:i,reportProgress:r})}referenceOrgans(t,i="body",r=!1,s){const o=t.cache,a=t.token;let l=new Pr({encoder:this.encoder});null!=o&&(l=this.addToHttpParams(l,o,"cache")),null!=a&&(l=this.addToHttpParams(l,a,"token"));let c=this.defaultHeaders,u=s&&s.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(c=c.set("Accept",u));let h=s&&s.context;void 0===h&&(h=new Ys);let f="json";return u&&(f=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/reference-organs`,{context:h,params:l,responseType:f,withCredentials:this.configuration.withCredentials,headers:c,observe:i,reportProgress:r})}scene(t,i="body",r=!1,s){const o=t.age,a=t.ageRange,l=t.bmi,c=t.bmiRange,u=t.cache,h=t.ontologyTerms,f=t.cellTypeTerms,g=t.providers,m=t.sex,w=t.spatial,S=t.technologies,U=t.token;let D=new Pr({encoder:this.encoder});null!=o&&(D=this.addToHttpParams(D,o,"age")),null!=a&&(D=this.addToHttpParams(D,a,"age-range")),null!=l&&(D=this.addToHttpParams(D,l,"bmi")),null!=c&&(D=this.addToHttpParams(D,c,"bmi-range")),null!=u&&(D=this.addToHttpParams(D,u,"cache")),h&&h.forEach(Ve=>{D=this.addToHttpParams(D,Ve,"ontology-terms")}),f&&f.forEach(Ve=>{D=this.addToHttpParams(D,Ve,"cell-type-terms")}),g&&g.forEach(Ve=>{D=this.addToHttpParams(D,Ve,"providers")}),null!=m&&(D=this.addToHttpParams(D,m,"sex")),w&&w.forEach(Ve=>{D=this.addToHttpParams(D,Ve,"spatial")}),S&&S.forEach(Ve=>{D=this.addToHttpParams(D,Ve,"technologies")}),null!=U&&(D=this.addToHttpParams(D,U,"token"));let ie=this.defaultHeaders,_e=s&&s.httpHeaderAccept;void 0===_e&&(_e=this.configuration.selectHeaderAccept(["application/json"])),void 0!==_e&&(ie=ie.set("Accept",_e));let Ne=s&&s.context;void 0===Ne&&(Ne=new Ys);let Pe="json";return _e&&(Pe=_e.startsWith("text")?"text":this.configuration.isJsonMime(_e)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/scene`,{context:Ne,params:D,responseType:Pe,withCredentials:this.configuration.withCredentials,headers:ie,observe:i,reportProgress:r})}sparql(t,i="body",r=!1,s){const o=t.query;if(null==o)throw new Error("Required parameter query was null or undefined when calling sparql.");const a=t.token,l=t.format;let c=new Pr({encoder:this.encoder});null!=o&&(c=this.addToHttpParams(c,o,"query")),null!=a&&(c=this.addToHttpParams(c,a,"token")),null!=l&&(c=this.addToHttpParams(c,l,"format"));let u=this.defaultHeaders,h=s&&s.httpHeaderAccept;void 0===h&&(h=this.configuration.selectHeaderAccept(["application/json"])),void 0!==h&&(u=u.set("Accept",h));let f=s&&s.context;void 0===f&&(f=new Ys);let g="json";return h&&(g=h.startsWith("text")?"text":this.configuration.isJsonMime(h)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/sparql`,{context:f,params:c,responseType:g,withCredentials:this.configuration.withCredentials,headers:u,observe:i,reportProgress:r})}sparqlPost(t,i="body",r=!1,s){const o=t.sparqlQueryRequest;if(null==o)throw new Error("Required parameter sparqlQueryRequest was null or undefined when calling sparqlPost.");const a=t.token,l=t.format;let c=new Pr({encoder:this.encoder});null!=a&&(c=this.addToHttpParams(c,a,"token")),null!=l&&(c=this.addToHttpParams(c,l,"format"));let u=this.defaultHeaders,h=s&&s.httpHeaderAccept;void 0===h&&(h=this.configuration.selectHeaderAccept(["application/json"])),void 0!==h&&(u=u.set("Accept",h));let f=s&&s.context;void 0===f&&(f=new Ys);const m=this.configuration.selectHeaderContentType(["application/json","application/x-www-form-urlencoded"]);void 0!==m&&(u=u.set("Content-Type",m));let w="json";return h&&(w=h.startsWith("text")?"text":this.configuration.isJsonMime(h)?"json":"blob"),this.httpClient.post(`${this.configuration.basePath}/sparql`,o,{context:f,params:c,responseType:w,withCredentials:this.configuration.withCredentials,headers:u,observe:i,reportProgress:r})}technologyNames(t,i="body",r=!1,s){const o=t.cache,a=t.token;let l=new Pr({encoder:this.encoder});null!=o&&(l=this.addToHttpParams(l,o,"cache")),null!=a&&(l=this.addToHttpParams(l,a,"token"));let c=this.defaultHeaders,u=s&&s.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(c=c.set("Accept",u));let h=s&&s.context;void 0===h&&(h=new Ys);let f="json";return u&&(f=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/technology-names`,{context:h,params:l,responseType:f,withCredentials:this.configuration.withCredentials,headers:c,observe:i,reportProgress:r})}tissueBlocks(t,i="body",r=!1,s){const o=t.age,a=t.ageRange,l=t.bmi,c=t.bmiRange,u=t.cache,h=t.ontologyTerms,f=t.cellTypeTerms,g=t.providers,m=t.sex,w=t.spatial,S=t.technologies,U=t.token;let D=new Pr({encoder:this.encoder});null!=o&&(D=this.addToHttpParams(D,o,"age")),null!=a&&(D=this.addToHttpParams(D,a,"age-range")),null!=l&&(D=this.addToHttpParams(D,l,"bmi")),null!=c&&(D=this.addToHttpParams(D,c,"bmi-range")),null!=u&&(D=this.addToHttpParams(D,u,"cache")),h&&h.forEach(Ve=>{D=this.addToHttpParams(D,Ve,"ontology-terms")}),f&&f.forEach(Ve=>{D=this.addToHttpParams(D,Ve,"cell-type-terms")}),g&&g.forEach(Ve=>{D=this.addToHttpParams(D,Ve,"providers")}),null!=m&&(D=this.addToHttpParams(D,m,"sex")),w&&w.forEach(Ve=>{D=this.addToHttpParams(D,Ve,"spatial")}),S&&S.forEach(Ve=>{D=this.addToHttpParams(D,Ve,"technologies")}),null!=U&&(D=this.addToHttpParams(D,U,"token"));let ie=this.defaultHeaders,_e=s&&s.httpHeaderAccept;void 0===_e&&(_e=this.configuration.selectHeaderAccept(["application/json"])),void 0!==_e&&(ie=ie.set("Accept",_e));let Ne=s&&s.context;void 0===Ne&&(Ne=new Ys);let Pe="json";return _e&&(Pe=_e.startsWith("text")?"text":this.configuration.isJsonMime(_e)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/tissue-blocks`,{context:Ne,params:D,responseType:Pe,withCredentials:this.configuration.withCredentials,headers:ie,observe:i,reportProgress:r})}}return n.\u0275fac=function(t){return new(t||n)(Ie(cd),Ie(r9,8),Ie(Vv,8))},n.\u0275prov=We({factory:function(){return new n(Ie(cd),Ie(r9,8),Ie(Vv,8))},token:n,providedIn:"root"}),n})(),COe=(()=>{class n{constructor(t,i){if(t)throw new Error("CcfApiModule is already loaded. Import in your base AppModule only.");if(!i)throw new Error("You need to import the HttpClientModule in your AppModule! \nSee also https://github.com/angular/angular/issues/20575")}static forRoot(t){return{ngModule:n,providers:[{provide:Vv,useFactory:t}]}}}return n.\u0275fac=function(t){return new(t||n)(Ie(n,12),Ie(cd,8))},n.\u0275mod=an({type:n}),n.\u0275inj=Ct({providers:[],imports:[[]]}),n})();function hu(n){return new Promise((e,t)=>{n.oncomplete=n.onsuccess=()=>e(n.result),n.onabort=n.onerror=()=>t(n.error)})}let _F;function yc(){return _F||(_F=function(n,e){const t=function(){if(navigator.userAgentData||!/Safari\//.test(navigator.userAgent)||/Chrom(e|ium)\//.test(navigator.userAgent)||!indexedDB.databases)return Promise.resolve();let e;return new Promise(t=>{const i=()=>indexedDB.databases().finally(t);e=setInterval(i,100),i()}).finally(()=>clearInterval(e))}().then(()=>{const i=indexedDB.open("keyval-store");return i.onupgradeneeded=()=>i.result.createObjectStore(e),hu(i)});return(i,r)=>t.then(s=>r(s.transaction(e,i).objectStore(e)))}(0,"keyval")),_F}function o9(n,e=yc()){return e("readonly",t=>hu(t.get(n)))}var Vn=et(1440);const QC="Unknown Euler angle order",Nm=.99999;class Xi extends oS{static get ZYX(){return 0}static get YXZ(){return 1}static get XZY(){return 2}static get ZXY(){return 3}static get YZX(){return 4}static get XYZ(){return 5}static get RollPitchYaw(){return 0}static get DefaultOrder(){return Xi.ZYX}static get RotationOrders(){return["ZYX","YXZ","XZY","ZXY","YZX","XYZ"]}static rotationOrder(e){return Xi.RotationOrders[e]}get ELEMENTS(){return 4}constructor(e=0,t=0,i=0,r=Xi.DefaultOrder){super(-0,-0,-0,-0),arguments.length>0&&Array.isArray(arguments[0])?this.fromVector3(...arguments):this.set(e,t,i,r)}fromQuaternion(e){const[t,i,r,s]=e,o=i*i,a=-2*(o+r*r)+1,l=2*(t*i+s*r);let c=-2*(t*r-s*i);c=c>1?1:c,c=c<-1?-1:c;const f=Math.atan2(2*(i*r+s*t),-2*(t*t+o)+1),g=Math.asin(c),m=Math.atan2(l,a);return new Xi(f,g,m,Xi.RollPitchYaw)}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=Number.isFinite(e[3])||this.order,this.check()}set(e=0,t=0,i=0,r){return this[0]=e,this[1]=t,this[2]=i,this[3]=Number.isFinite(r)?r:this[3],this.check()}validate(){return function(n){return n>=0&&n<6}(this[3])&&Number.isFinite(this[0])&&Number.isFinite(this[1])&&Number.isFinite(this[2])}toArray(e=[],t=0){return e[t]=this[0],e[t+1]=this[1],e[t+2]=this[2],e}toArray4(e=[],t=0){return e[t]=this[0],e[t+1]=this[1],e[t+2]=this[2],e[t+3]=this[3],e}toVector3(e=[-0,-0,-0]){return e[0]=this[0],e[1]=this[1],e[2]=this[2],e}get x(){return this[0]}set x(e){this[0]=er(e)}get y(){return this[1]}set y(e){this[1]=er(e)}get z(){return this[2]}set z(e){this[2]=er(e)}get alpha(){return this[0]}set alpha(e){this[0]=er(e)}get beta(){return this[1]}set beta(e){this[1]=er(e)}get gamma(){return this[2]}set gamma(e){this[2]=er(e)}get phi(){return this[0]}set phi(e){this[0]=er(e)}get theta(){return this[1]}set theta(e){this[1]=er(e)}get psi(){return this[2]}set psi(e){this[2]=er(e)}get roll(){return this[0]}set roll(e){this[0]=er(e)}get pitch(){return this[1]}set pitch(e){this[1]=er(e)}get yaw(){return this[2]}set yaw(e){this[2]=er(e)}get order(){return this[3]}set order(e){this[3]=function(n){if(n<0&&n>=6)throw new Error(QC);return n}(e)}fromVector3(e,t){return this.set(e[0],e[1],e[2],Number.isFinite(t)?t:this[3])}fromArray(e,t=0){return this[0]=e[0+t],this[1]=e[1+t],this[2]=e[2+t],void 0!==e[3]&&(this[3]=e[3]),this.check()}fromRollPitchYaw(e,t,i){return this.set(e,t,i,Xi.ZYX)}fromRotationMatrix(e,t=Xi.DefaultOrder){return this._fromRotationMatrix(e,t),this.check()}getRotationMatrix(e){return this._getRotationMatrix(e)}getQuaternion(){const e=new sR;switch(this[4]){case Xi.XYZ:return e.rotateX(this[0]).rotateY(this[1]).rotateZ(this[2]);case Xi.YXZ:return e.rotateY(this[0]).rotateX(this[1]).rotateZ(this[2]);case Xi.ZXY:return e.rotateZ(this[0]).rotateX(this[1]).rotateY(this[2]);case Xi.ZYX:return e.rotateZ(this[0]).rotateY(this[1]).rotateX(this[2]);case Xi.YZX:return e.rotateY(this[0]).rotateZ(this[1]).rotateX(this[2]);case Xi.XZY:return e.rotateX(this[0]).rotateZ(this[1]).rotateY(this[2]);default:throw new Error(QC)}}_fromRotationMatrix(e,t=Xi.DefaultOrder){const i=e.elements,r=i[0],s=i[4],o=i[8],a=i[1],l=i[5],c=i[9],u=i[2],h=i[6],f=i[10];switch(t=t||this[3]){case Xi.XYZ:this[1]=Math.asin(Pa(o,-1,1)),Math.abs(o)<Nm?(this[0]=Math.atan2(-c,f),this[2]=Math.atan2(-s,r)):(this[0]=Math.atan2(h,l),this[2]=0);break;case Xi.YXZ:this[0]=Math.asin(-Pa(c,-1,1)),Math.abs(c)<Nm?(this[1]=Math.atan2(o,f),this[2]=Math.atan2(a,l)):(this[1]=Math.atan2(-u,r),this[2]=0);break;case Xi.ZXY:this[0]=Math.asin(Pa(h,-1,1)),Math.abs(h)<Nm?(this[1]=Math.atan2(-u,f),this[2]=Math.atan2(-s,l)):(this[1]=0,this[2]=Math.atan2(a,r));break;case Xi.ZYX:this[1]=Math.asin(-Pa(u,-1,1)),Math.abs(u)<Nm?(this[0]=Math.atan2(h,f),this[2]=Math.atan2(a,r)):(this[0]=0,this[2]=Math.atan2(-s,l));break;case Xi.YZX:this[2]=Math.asin(Pa(a,-1,1)),Math.abs(a)<Nm?(this[0]=Math.atan2(-c,l),this[1]=Math.atan2(-u,r)):(this[0]=0,this[1]=Math.atan2(o,f));break;case Xi.XZY:this[2]=Math.asin(-Pa(s,-1,1)),Math.abs(s)<Nm?(this[0]=Math.atan2(h,l),this[1]=Math.atan2(o,r)):(this[0]=Math.atan2(-c,f),this[1]=0);break;default:throw new Error(QC)}return this[3]=t,this}_getRotationMatrix(e){const t=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],i=this.x,r=this.y,s=this.z,o=Math.cos(i),a=Math.cos(r),l=Math.cos(s),c=Math.sin(i),u=Math.sin(r),h=Math.sin(s);switch(this[3]){case Xi.XYZ:{const f=o*l,g=o*h,m=c*l,w=c*h;t[0]=a*l,t[4]=-a*h,t[8]=u,t[1]=g+m*u,t[5]=f-w*u,t[9]=-c*a,t[2]=w-f*u,t[6]=m+g*u,t[10]=o*a;break}case Xi.YXZ:{const f=a*l,g=a*h,m=u*l,w=u*h;t[0]=f+w*c,t[4]=m*c-g,t[8]=o*u,t[1]=o*h,t[5]=o*l,t[9]=-c,t[2]=g*c-m,t[6]=w+f*c,t[10]=o*a;break}case Xi.ZXY:{const f=a*l,g=a*h,m=u*l,w=u*h;t[0]=f-w*c,t[4]=-o*h,t[8]=m+g*c,t[1]=g+m*c,t[5]=o*l,t[9]=w-f*c,t[2]=-o*u,t[6]=c,t[10]=o*a;break}case Xi.ZYX:{const f=o*l,g=o*h,m=c*l,w=c*h;t[0]=a*l,t[4]=m*u-g,t[8]=f*u+w,t[1]=a*h,t[5]=w*u+f,t[9]=g*u-m,t[2]=-u,t[6]=c*a,t[10]=o*a;break}case Xi.YZX:{const f=o*a,g=o*u,m=c*a,w=c*u;t[0]=a*l,t[4]=w-f*h,t[8]=m*h+g,t[1]=h,t[5]=o*l,t[9]=-c*l,t[2]=-u*l,t[6]=g*h+m,t[10]=f-w*h;break}case Xi.XZY:{const f=o*a,g=o*u,m=c*a,w=c*u;t[0]=a*l,t[4]=-h,t[8]=u*l,t[1]=f*h+w,t[5]=o*l,t[9]=g*h-m,t[2]=m*h-g,t[6]=c*l,t[10]=w*h+f;break}default:throw new Error(QC)}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}toQuaternion(){const e=Math.cos(.5*this.yaw),t=Math.sin(.5*this.yaw),i=Math.cos(.5*this.roll),r=Math.sin(.5*this.roll),s=Math.cos(.5*this.pitch),o=Math.sin(.5*this.pitch);return new sR(e*r*s-t*i*o,e*i*o+t*r*s,t*i*s-e*r*o,e*i*s+t*r*o)}}const a9=Object.freeze([1,0,0,0,1,0,0,0,1]),NOe=Object.freeze([0,0,0,0,0,0,0,0,0]),POe=Object.freeze({COL0ROW0:0,COL0ROW1:1,COL0ROW2:2,COL1ROW0:3,COL1ROW1:4,COL1ROW2:5,COL2ROW0:6,COL2ROW1:7,COL2ROW2:8}),Pm={};class jv extends pU{static get IDENTITY(){return Pm.IDENTITY=Pm.IDENTITY||Object.freeze(new jv(a9)),Pm.IDENTITY}static get ZERO(){return Pm.ZERO=Pm.ZERO||Object.freeze(new jv(NOe)),Pm.ZERO}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return POe}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this.check()}set(e,t,i,r,s,o,a,l,c){return this[0]=e,this[1]=t,this[2]=i,this[3]=r,this[4]=s,this[5]=o,this[6]=a,this[7]=l,this[8]=c,this.check()}setRowMajor(e,t,i,r,s,o,a,l,c){return this[0]=e,this[1]=r,this[2]=a,this[3]=t,this[4]=s,this[5]=l,this[6]=i,this[7]=o,this[8]=c,this.check()}determinant(){return V4(this)}identity(){return this.copy(a9)}fromQuaternion(e){return z4(this,e),this.check()}transpose(){return k4(this,this),this.check()}invert(){return B4(this,this),this.check()}multiplyLeft(e){return YS(this,e,this),this.check()}multiplyRight(e){return YS(this,this,e),this.check()}rotate(e){return U4(this,this,e),this.check()}scale(e){return Array.isArray(e)?KS(this,this,e):KS(this,this,[e,e,e]),this.check()}translate(e){return j4(this,this,e),this.check()}transform(e,t){switch(e.length){case 2:t=_U(t||[-0,-0],e,this);break;case 3:t=aS(t||[-0,-0,-0],e,this);break;case 4:t=function(n,e,t){const i=e[0],r=e[1],s=e[2];return n[0]=t[0]*i+t[3]*r+t[6]*s,n[1]=t[1]*i+t[4]*r+t[7]*s,n[2]=t[2]*i+t[5]*r+t[8]*s,n[3]=e[3],n}(t||[-0,-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return b0(t,e.length),t}transformVector(e,t){return kg("Matrix3.transformVector"),this.transform(e,t)}transformVector2(e,t){return kg("Matrix3.transformVector"),this.transform(e,t)}transformVector3(e,t){return kg("Matrix3.transformVector"),this.transform(e,t)}}var ZC,FOe=et(698),LOe=et(7445),kOe=et.n(LOe),mr=et(3815),BOe=new Uint8Array(16);function VOe(){if(!ZC&&!(ZC="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ZC(BOe)}const jOe=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,zOe=function(n){return"string"==typeof n&&jOe.test(n)};for(var oo=[],vF=0;vF<256;++vF)oo.push((vF+256).toString(16).substr(1));const WOe=function(n,e,t){var i=(n=n||{}).random||(n.rng||VOe)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,e){t=t||0;for(var r=0;r<16;++r)e[t+r]=i[r];return e}return function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=(oo[n[e+0]]+oo[n[e+1]]+oo[n[e+2]]+oo[n[e+3]]+"-"+oo[n[e+4]]+oo[n[e+5]]+"-"+oo[n[e+6]]+oo[n[e+7]]+"-"+oo[n[e+8]]+oo[n[e+9]]+"-"+oo[n[e+10]]+oo[n[e+11]]+oo[n[e+12]]+oo[n[e+13]]+oo[n[e+14]]+oo[n[e+15]]).toLowerCase();if(!zOe(t))throw TypeError("Stringified UUID is invalid");return t}(i)};var JC=et(1609);const Fm=Object.freeze({OUTSIDE:-1,INTERSECTING:0,INSIDE:1}),Tr=(Math,Math,{});function XOe(n,{precision:e=Tr.precision||4}={}){return n=function(n){return Math.round(n/Tr.EPSILON)*Tr.EPSILON}(n),"".concat(parseFloat(n.toPrecision(e)))}function Sh(n){return Array.isArray(n)||ArrayBuffer.isView(n)&&!(n instanceof DataView)}function Uv(n,e,t){const i=Tr.EPSILON;t&&(Tr.EPSILON=t);try{if(n===e)return!0;if(Sh(n)&&Sh(e)){if(n.length!==e.length)return!1;for(let r=0;r<n.length;++r)if(!Uv(n[r],e[r]))return!1;return!0}return n&&n.equals?n.equals(e):e&&e.equals?e.equals(n):!(!Number.isFinite(n)||!Number.isFinite(e))&&Math.abs(n-e)<=Tr.EPSILON*Math.max(1,Math.abs(n),Math.abs(e))}finally{Tr.EPSILON=i}}function vc(n,e){if(!n)throw new Error("math.gl assertion ".concat(e))}Tr.EPSILON=1e-12,Tr.debug=!1,Tr.precision=4,Tr.printTypes=!1,Tr.printDegrees=!1,Tr.printRowMajor=!0;class bF extends(function(n){function e(){var t=Reflect.construct(n,Array.from(arguments));return Object.setPrototypeOf(t,Object.getPrototypeOf(this)),t}return e.prototype=Object.create(n.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,n):e.__proto__=n,e}(Array)){get ELEMENTS(){return vc(!1),0}clone(){return(new this.constructor).copy(this)}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}fromArray(e,t=0){for(let i=0;i<this.ELEMENTS;++i)this[i]=e[i+t];return this.check()}to(e){return e===this?this:Sh(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toArray(e=[],t=0){for(let i=0;i<this.ELEMENTS;++i)e[t+i]=this[i];return e}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(Tr)}formatString(e){let t="";for(let i=0;i<this.ELEMENTS;++i)t+=(i>0?", ":"")+XOe(this[i],e);return"".concat(e.printTypes?this.constructor.name:"","[").concat(t,"]")}equals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(!Uv(this[t],e[t]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(this[t]!==e[t])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,t,i){void 0===i&&(i=t,t=e,e=this);for(let r=0;r<this.ELEMENTS;++r){const s=e[r];this[r]=s+i*(t[r]-s)}return this.check()}min(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.min(e[t],this[t]);return this.check()}max(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.max(e[t],this[t]);return this.check()}clamp(e,t){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(Math.max(this[i],e[i]),t[i]);return this.check()}add(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]+=t[i];return this.check()}subtract(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]-=t[i];return this.check()}scale(e){if(Array.isArray(e))return this.multiply(e);for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}sub(e){return this.subtract(e)}setScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=e;return this.check()}addScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}divideScalar(e){return this.scale(1/e)}clampScalar(e,t){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(Math.max(this[i],e),t);return this.check()}multiplyByScalar(e){return this.scale(e)}get elements(){return this}check(){if(Tr.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let e=this.length===this.ELEMENTS;for(let t=0;t<this.ELEMENTS;++t)e=e&&Number.isFinite(this[t]);return e}}function ao(n){if(!Number.isFinite(n))throw new Error("Invalid number ".concat(n));return n}function l9(n,e,t=""){if(Tr.debug&&!function(n,e){if(n.length!==e)return!1;for(let t=0;t<n.length;++t)if(!Number.isFinite(n[t]))return!1;return!0}(n,e))throw new Error("math.gl: ".concat(t," some fields set to invalid numbers'"));return n}const c9={};function wF(n,e){c9[n]||(c9[n]=!0,console.warn("".concat(n," has been removed in version ").concat(e,", see upgrade guide for more information")))}class rRe extends bF{get ELEMENTS(){return vc(!1),0}copy(e){return vc(!1),this}get x(){return this[0]}set x(e){this[0]=ao(e)}get y(){return this[1]}set y(e){this[1]=ao(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let t=0;t<this.ELEMENTS;++t)e+=this[t]*this[t];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let t=0;for(let i=0;i<this.ELEMENTS;++i){const r=this[i]-e[i];t+=r*r}return ao(t)}dot(e){let t=0;for(let i=0;i<this.ELEMENTS;++i)t+=this[i]*e[i];return ao(t)}normalize(){const e=this.magnitude();if(0!==e)for(let t=0;t<this.ELEMENTS;++t)this[t]/=e;return this.check()}multiply(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]*=t[i];return this.check()}divide(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]/=t[i];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return vc(e>=0&&e<this.ELEMENTS,"index is out of range"),ao(this[e])}setComponent(e,t){return vc(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=t,this.check()}addVectors(e,t){return this.copy(e).add(t)}subVectors(e,t){return this.copy(e).subtract(t)}multiplyVectors(e,t){return this.copy(e).multiply(t)}addScaledVector(e,t){return this.add(new this.constructor(e).multiplyScalar(t))}}const EF=[0,0,0],u9={};class Rn extends rRe{static get ZERO(){return u9.ZERO=u9.ZERO||Object.freeze(new Rn(0,0,0,0))}constructor(e=0,t=0,i=0){super(-0,-0,-0),1===arguments.length&&Sh(e)?this.copy(e):(Tr.debug&&(ao(e),ao(t),ao(i)),this[0]=e,this[1]=t,this[2]=i)}set(e,t,i){return this[0]=e,this[1]=t,this[2]=i,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return Tr.debug&&(ao(e.x),ao(e.y),ao(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=ao(e)}angle(e){return oj(this,e)}cross(e){return w0(this,this,e),this.check()}rotateX({radians:e,origin:t=EF}){return ij(this,this,t,e),this.check()}rotateY({radians:e,origin:t=EF}){return rj(this,this,t,e),this.check()}rotateZ({radians:e,origin:t=EF}){return sj(this,this,t,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return cI(this,this,e),this.check()}transformAsVector(e){return function(n,e,t){const i=e[0],r=e[1],s=e[2],o=t[3]*i+t[7]*r+t[11]*s||1;n[0]=(t[0]*i+t[4]*r+t[8]*s)/o,n[1]=(t[1]*i+t[5]*r+t[9]*s)/o,n[2]=(t[2]*i+t[6]*r+t[10]*s)/o}(this,this,e),this.check()}transformByMatrix3(e){return aS(this,this,e),this.check()}transformByMatrix2(e){return function(n,e,t){const i=e[0],r=e[1];n[0]=t[0]*i+t[2]*r,n[1]=t[1]*i+t[3]*r,n[2]=e[2]}(this,this,e),this.check()}transformByQuaternion(e){return nj(this,this,e),this.check()}}new Rn,new Rn;const zv=new Rn,f9=new Rn;class SF{constructor(e=[0,0,0],t=0){this.radius=-0,this.center=new Rn,this.fromCenterRadius(e,t)}fromCenterRadius(e,t){return this.center.from(e),this.radius=t,this}fromCornerPoints(e,t){return t=zv.from(t),this.center=(new Rn).from(e).add(t).scale(.5),this.radius=this.center.distance(t),this}equals(e){return this===e||Boolean(e)&&this.center.equals(e.center)&&this.radius===e.radius}clone(){return new SF(this.center,this.radius)}union(e){const t=this.center,i=this.radius,s=e.radius,o=zv.copy(e.center).subtract(t),a=o.magnitude();if(i>=a+s)return this.clone();if(s>=a+i)return e.clone();const l=.5*(i+a+s);return f9.copy(o).scale((-i+l)/a).add(t),this.center.copy(f9),this.radius=l,this}expand(e){const t=(e=zv.from(e)).subtract(this.center).magnitude();return t>this.radius&&(this.radius=t),this}transform(e){this.center.transform(e);const t=function(n,e){var s=e[4],o=e[5],a=e[6],l=e[8],c=e[9],u=e[10];return n[0]=Math.hypot(e[0],e[1],e[2]),n[1]=Math.hypot(s,o,a),n[2]=Math.hypot(l,c,u),n}(zv,e);return this.radius=Math.max(t[0],Math.max(t[1],t[2]))*this.radius,this}distanceSquaredTo(e){const t=this.distanceTo(e);return t*t}distanceTo(e){const t=(e=zv.from(e)).subtract(this.center);return Math.max(0,t.len()-this.radius)}intersectPlane(e){const i=this.radius,s=e.normal.dot(this.center)+e.distance;return s<-i?Fm.OUTSIDE:s<i?Fm.INTERSECTING:Fm.INSIDE}}class cRe extends bF{get ELEMENTS(){return vc(!1),0}get RANK(){return vc(!1),0}toString(){let e="[";if(Tr.printRowMajor){e+="row-major:";for(let t=0;t<this.RANK;++t)for(let i=0;i<this.RANK;++i)e+=" ".concat(this[i*this.RANK+t])}else{e+="column-major:";for(let t=0;t<this.ELEMENTS;++t)e+=" ".concat(this[t])}return e+="]",e}getElementIndex(e,t){return t*this.RANK+e}getElement(e,t){return this[t*this.RANK+e]}setElement(e,t,i){return this[t*this.RANK+e]=ao(i),this}getColumn(e,t=new Array(this.RANK).fill(-0)){const i=e*this.RANK;for(let r=0;r<this.RANK;++r)t[r]=this[i+r];return t}setColumn(e,t){const i=e*this.RANK;for(let r=0;r<this.RANK;++r)this[i+r]=t[r];return this}}const p9=Object.freeze([1,0,0,0,1,0,0,0,1]),uRe=Object.freeze([0,0,0,0,0,0,0,0,0]),dRe=Object.freeze({COL0ROW0:0,COL0ROW1:1,COL0ROW2:2,COL1ROW0:3,COL1ROW1:4,COL1ROW2:5,COL2ROW0:6,COL2ROW1:7,COL2ROW2:8}),Lm={};class Ho extends cRe{static get IDENTITY(){return Lm.IDENTITY=Lm.IDENTITY||Object.freeze(new Ho(p9)),Lm.IDENTITY}static get ZERO(){return Lm.ZERO=Lm.ZERO||Object.freeze(new Ho(uRe)),Lm.ZERO}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return dRe}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this.check()}set(e,t,i,r,s,o,a,l,c){return this[0]=e,this[1]=t,this[2]=i,this[3]=r,this[4]=s,this[5]=o,this[6]=a,this[7]=l,this[8]=c,this.check()}setRowMajor(e,t,i,r,s,o,a,l,c){return this[0]=e,this[1]=r,this[2]=a,this[3]=t,this[4]=s,this[5]=l,this[6]=i,this[7]=o,this[8]=c,this.check()}determinant(){return V4(this)}identity(){return this.copy(p9)}fromQuaternion(e){return z4(this,e),this.check()}transpose(){return k4(this,this),this.check()}invert(){return B4(this,this),this.check()}multiplyLeft(e){return YS(this,e,this),this.check()}multiplyRight(e){return YS(this,this,e),this.check()}rotate(e){return U4(this,this,e),this.check()}scale(e){return Array.isArray(e)?KS(this,this,e):KS(this,this,[e,e,e]),this.check()}translate(e){return j4(this,this,e),this.check()}transform(e,t){switch(e.length){case 2:t=_U(t||[-0,-0],e,this);break;case 3:t=aS(t||[-0,-0,-0],e,this);break;case 4:t=function(n,e,t){const i=e[0],r=e[1],s=e[2];return n[0]=t[0]*i+t[3]*r+t[6]*s,n[1]=t[1]*i+t[4]*r+t[7]*s,n[2]=t[2]*i+t[5]*r+t[8]*s,n[3]=e[3],n}(t||[-0,-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return l9(t,e.length),t}transformVector(e,t){return wF("Matrix3.transformVector"),this.transform(e,t)}transformVector2(e,t){return wF("Matrix3.transformVector"),this.transform(e,t)}transformVector3(e,t){return wF("Matrix3.transformVector"),this.transform(e,t)}}const hRe=[0,0,0,1];class g9 extends bF{constructor(e=0,t=0,i=0,r=1){super(-0,-0,-0,-0),Array.isArray(e)&&1===arguments.length?this.copy(e):this.set(e,t,i,r)}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}set(e,t,i,r){return this[0]=e,this[1]=t,this[2]=i,this[3]=r,this.check()}fromMatrix3(e){return nR(this,e),this.check()}identity(){return G4(this),this.check()}fromAxisRotation(e,t){return tR(this,e,t),this.check()}setAxisAngle(e,t){return this.fromAxisRotation(e,t)}get ELEMENTS(){return 4}get x(){return this[0]}set x(e){this[0]=ao(e)}get y(){return this[1]}set y(e){this[1]=ao(e)}get z(){return this[2]}set z(e){this[2]=ao(e)}get w(){return this[3]}set w(e){this[3]=ao(e)}len(){return J4(this)}lengthSquared(){return eH(this)}dot(e,t){if(void 0!==t)throw new Error("Quaternion.dot only takes one argument");return rR(this,e)}rotationTo(e,t){return nH(this,e,t),this.check()}add(e,t){if(void 0!==t)throw new Error("Quaternion.add only takes one argument");return Q4(this,this,e),this.check()}calculateW(){return Y4(this,this),this.check()}conjugate(){return X4(this,this),this.check()}invert(){return K4(this,this),this.check()}lerp(e,t,i){return Z4(this,e,t,i),this.check()}multiplyRight(e,t){return vc(!t),XS(this,this,e),this.check()}multiplyLeft(e,t){return vc(!t),XS(this,e,this),this.check()}normalize(){const e=this.len(),t=e>0?1/e:0;return this[0]=this[0]*t,this[1]=this[1]*t,this[2]=this[2]*t,this[3]=this[3]*t,0===e&&(this[3]=1),this.check()}rotateX(e){return $4(this,this,e),this.check()}rotateY(e){return W4(this,this,e),this.check()}rotateZ(e){return q4(this,this,e),this.check()}scale(e){return iR(this,this,e),this.check()}slerp(e,t,i){switch(arguments.length){case 1:({start:e=hRe,target:t,ratio:i}=arguments[0]);break;case 2:[t,i]=arguments,e=this}return Y0(this,e,t,i),this.check()}transformVector4(e,t=e){return dU(t,e,this),l9(t,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(e,t){return this.setAxisAngle(e,t)}premultiply(e,t){return this.multiplyLeft(e,t)}multiply(e,t){return this.multiplyRight(e,t)}}const fRe=new Rn,pRe=new Rn,eT=new Rn,tT=new Rn,nT=new Rn,gRe=new Rn,mRe=new Rn;class xF{constructor(e=[0,0,0],t=[0,0,0,0,0,0,0,0,0]){this.center=(new Rn).from(e),this.halfAxes=new Ho(t)}get halfSize(){const e=this.halfAxes.getColumn(0),t=this.halfAxes.getColumn(1),i=this.halfAxes.getColumn(2);return[new Rn(e).len(),new Rn(t).len(),new Rn(i).len()]}get quaternion(){const e=this.halfAxes.getColumn(0),t=this.halfAxes.getColumn(1),i=this.halfAxes.getColumn(2),r=new Rn(e).normalize(),s=new Rn(t).normalize(),o=new Rn(i).normalize();return(new g9).fromMatrix3(new Ho([...r,...s,...o]))}fromCenterHalfSizeQuaternion(e,t,i){const r=new g9(i),s=(new Ho).fromQuaternion(r);return s[0]=s[0]*t[0],s[1]=s[1]*t[0],s[2]=s[2]*t[0],s[3]=s[3]*t[1],s[4]=s[4]*t[1],s[5]=s[5]*t[1],s[6]=s[6]*t[2],s[7]=s[7]*t[2],s[8]=s[8]*t[2],this.center=(new Rn).from(e),this.halfAxes=s,this}clone(){return new xF(this.center,this.halfAxes)}equals(e){return this===e||Boolean(e)&&this.center.equals(e.center)&&this.halfAxes.equals(e.halfAxes)}getBoundingSphere(e=new SF){const t=this.halfAxes,i=t.getColumn(0,eT),r=t.getColumn(1,tT),s=t.getColumn(2,nT),o=fRe.copy(i).add(r).add(s);return e.center.copy(this.center),e.radius=o.magnitude(),e}intersectPlane(e){const t=this.center,i=e.normal,r=this.halfAxes,s=i.x,o=i.y,a=i.z,l=Math.abs(s*r[0]+o*r[1]+a*r[2])+Math.abs(s*r[3]+o*r[4]+a*r[5])+Math.abs(s*r[6]+o*r[7]+a*r[8]),c=i.dot(t)+e.distance;return c<=-l?Fm.OUTSIDE:c>=l?Fm.INSIDE:Fm.INTERSECTING}distanceTo(e){return Math.sqrt(this.distanceSquaredTo(e))}distanceSquaredTo(e){const t=pRe.from(e).subtract(this.center),i=this.halfAxes,r=i.getColumn(0,eT),s=i.getColumn(1,tT),o=i.getColumn(2,nT),a=r.magnitude(),l=s.magnitude(),c=o.magnitude();r.normalize(),s.normalize(),o.normalize();let h,u=0;return h=Math.abs(t.dot(r))-a,h>0&&(u+=h*h),h=Math.abs(t.dot(s))-l,h>0&&(u+=h*h),h=Math.abs(t.dot(o))-c,h>0&&(u+=h*h),u}computePlaneDistances(e,t,i=[-0,-0]){let r=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;const o=this.center,a=this.halfAxes,l=a.getColumn(0,eT),c=a.getColumn(1,tT),u=a.getColumn(2,nT),h=gRe.copy(l).add(c).add(u).add(o),f=mRe.copy(h).subtract(e);let g=t.dot(f);return r=Math.min(g,r),s=Math.max(g,s),h.copy(o).add(l).add(c).subtract(u),f.copy(h).subtract(e),g=t.dot(f),r=Math.min(g,r),s=Math.max(g,s),h.copy(o).add(l).subtract(c).add(u),f.copy(h).subtract(e),g=t.dot(f),r=Math.min(g,r),s=Math.max(g,s),h.copy(o).add(l).subtract(c).subtract(u),f.copy(h).subtract(e),g=t.dot(f),r=Math.min(g,r),s=Math.max(g,s),o.copy(h).subtract(l).add(c).add(u),f.copy(h).subtract(e),g=t.dot(f),r=Math.min(g,r),s=Math.max(g,s),o.copy(h).subtract(l).add(c).subtract(u),f.copy(h).subtract(e),g=t.dot(f),r=Math.min(g,r),s=Math.max(g,s),o.copy(h).subtract(l).subtract(c).add(u),f.copy(h).subtract(e),g=t.dot(f),r=Math.min(g,r),s=Math.max(g,s),o.copy(h).subtract(l).subtract(c).subtract(u),f.copy(h).subtract(e),g=t.dot(f),r=Math.min(g,r),s=Math.max(g,s),i[0]=r,i[1]=s,i}transform(e){this.center.transformAsPoint(e);const t=this.halfAxes.getColumn(0,eT);t.transformAsPoint(e);const i=this.halfAxes.getColumn(1,tT);i.transformAsPoint(e);const r=this.halfAxes.getColumn(2,nT);return r.transformAsPoint(e),this.halfAxes=new Ho([...t,...i,...r]),this}getTransform(){throw new Error("not implemented")}}const m9=new Rn,_9=new Rn;class CF{constructor(e=[0,0,1],t=0){this.normal=new Rn,this.distance=-0,this.fromNormalDistance(e,t)}fromNormalDistance(e,t){return vc(Number.isFinite(t)),this.normal.from(e).normalize(),this.distance=t,this}fromPointNormal(e,t){e=m9.from(e),this.normal.from(t).normalize();const i=-this.normal.dot(e);return this.distance=i,this}fromCoefficients(e,t,i,r){return this.normal.set(e,t,i),vc(Uv(this.normal.len(),1)),this.distance=r,this}clone(e){return new CF(this.normal,this.distance)}equals(e){return Uv(this.distance,e.distance)&&Uv(this.normal,e.normal)}getPointDistance(e){return this.normal.dot(e)+this.distance}transform(e){const t=_9.copy(this.normal).transformAsVector(e).normalize(),i=this.normal.scale(-this.distance).transform(e);return this.fromPointNormal(i,t)}projectPointOntoPlane(e,t=[0,0,0]){e=m9.from(e);const i=this.getPointDistance(e),r=_9.copy(this.normal).scale(i);return e.subtract(r).to(t)}}function*OF(n,e,t){for(const[i,r]of Object.entries(t))for(const s of(0,Vn.readQuads)(n,e,i,null,null)){const o="Literal"===s.object.termType?(0,JC.fromRdf)(s.object):s.object.id;yield[r,o]}}function rp(n,e,t,i){const r={"@id":e,"@type":t};for(const[s,o]of Object.entries(i))for(const a of(0,Vn.readQuads)(n,r["@id"],s,null,null)){const l="Literal"===a.object.termType?(0,JC.fromRdf)(a.object):a.object.id;r[o]=l}return r}new Rn([1,0,0]),new Rn([0,1,0]),new Rn([0,0,1]),new Rn,new Rn,new CF(new Rn(1,0,0),0),new Rn,new Rn,new Rn,new Rn,new Rn,new Rn,new Rn,new Rn,new Rn,new Rn,new Rn,new Rn,new Rn,new Rn,new Rn,new Rn,new Rn,Math,new Ho,new Ho,new Ho,new Ho,new Ho,new Rn,new Rn,new Rn,new Rn,new Rn,new Ho,new Ho,new Ho;const Ii=Vn.Util.prefixes({ccf:"http://purl.org/ccf/latest/ccf.owl#",entity:"http://purl.org/ccf/latest/ccf-entity.owl#",fma:"http://purl.obolibrary.org/obo/FMA_",obo:"http://purl.obolibrary.org/obo/",uberon:"http://purl.obolibrary.org/obo/UBERON_",cl:"http://purl.obolibrary.org/obo/CL_",lmha:"http://purl.obolibrary.org/obo/LMHA_",rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",rdfs:"http://www.w3.org/2000/01/rdf-schema#",dc:"http://purl.org/dc/elements/1.1/"},Vn.DataFactory),w9={x:Ii("rdf"),type:Ii("rdf")("type")},Bm={x:Ii("rdfs"),label:Ii("rdfs")("label"),comment:Ii("rdfs")("comment"),isDefinedBy:Ii("rdfs")("isDefinedBy"),seeAlso:Ii("rdfs")("seeAlso")},hi={x:Ii("entity"),id:Ii("entity")("id"),label:Bm.label,description:Bm.comment,link:Bm.seeAlso,sex:Ii("entity")("sex"),age:Ii("entity")("age"),bmi:Ii("entity")("bmi"),Male:Vn.DataFactory.literal("Male"),Female:Vn.DataFactory.literal("Female"),consortiumName:Ii("entity")("consortium_name"),providerName:Ii("entity")("provider_name"),providerUUID:Ii("entity")("provider_uuid"),donor:Ii("entity")("has_donor"),sections:Ii("entity")("has_tissue_section"),datasets:Ii("entity")("has_dataset"),sampleType:Ii("entity")("sample_type"),TissueBlock:Vn.DataFactory.literal("Tissue Block"),TissueSection:Vn.DataFactory.literal("Tissue Section"),NonStandard:Vn.DataFactory.literal("Non-standard"),sectionCount:Ii("entity")("section_count"),sectionSize:Ii("entity")("section_size"),sectionUnits:Ii("entity")("section_units"),sectionNumber:Ii("entity")("section_number"),spatialEntity:Ii("entity")("has_spatial_entity"),ontologyTerms:Ii("entity")("has_ontology_term"),cellTypeTerms:Ii("entity")("has_cell_type_term"),technology:Ii("entity")("technology"),thumbnail:Ii("entity")("has_thumbnail")},xn=Ii("ccf"),Ri={x:xn,ontologyNode:{label:xn("ccf_preferred_label"),parent:xn("ccf_part_of"),children:xn("ccf_part_of"),rui_rank:xn("ccf_rui_rank"),synonymLabels:Vn.DataFactory.namedNode("http://www.geneontology.org/formats/oboInOwl#hasExactSynonym")},asctb:{part_of:xn("ccf_part_of"),ct_is_a:xn("ct_is_a"),located_in:xn("located_in"),characterizes:xn("characterizes")},spatial:{Female:xn("VHFemale"),Male:xn("VHMale"),BothSexes:xn("VHBothSexes"),FemaleOrgans:xn("VHFemaleOrgans"),MaleOrgans:xn("VHMaleOrgans")},SpatialObjectReference:xn("SpatialObjectReference"),SpatialEntity:xn("SpatialEntity"),SpatialPlacement:xn("SpatialPlacement"),spatialObjectReference:{file:xn("has_object_file"),file_format:xn("has_object_file_format"),file_subpath:xn("has_object_file_subpath")},extractionSet:{label:Bm.label,rui_rank:xn("ccf_rui_rank")},spatialEntity:{label:Bm.label,comment:Bm.comment,creator:Ii("dc")("creator"),creator_first_name:xn("creator_first_name"),creator_last_name:xn("creator_last_name"),creator_orcid:xn("creator_orcid"),creation_date:xn("creation_date"),updated_date:xn("updated_date"),ccf_annotations:xn("ccf_annotation"),representation_of:xn("ccf_representation_of"),reference_organ:xn("anatomical_structure_of"),extraction_set_for:xn("extraction_set_for"),extraction_set:xn("extraction_site_for"),sex:xn("has_sex"),side:xn("has_side"),rui_rank:xn("ccf_rui_rank"),slice_thickness:xn("ccf_slice_thickness"),slice_count:xn("ccf_slice_count"),x_dimension:xn("has_x_dimension"),y_dimension:xn("has_y_dimension"),z_dimension:xn("has_z_dimension"),dimension_units:xn("has_dimension_units"),object:xn("has_object_reference")},spatialPlacement:{source:xn("has_placement_source"),target:xn("has_placement_target"),placement_date:xn("has_placement_date"),x_scaling:xn("has_x_scaling"),y_scaling:xn("has_y_scaling"),z_scaling:xn("has_z_scaling"),scaling_units:xn("has_scaling_units"),x_rotation:xn("has_x_rotation"),y_rotation:xn("has_y_rotation"),z_rotation:xn("has_z_rotation"),w_rotation:xn("has_theta_rotation"),rotation_order:xn("has_rotation_order"),rotation_units:xn("has_rotation_units"),x_translation:xn("has_x_translation"),y_translation:xn("has_y_translation"),z_translation:xn("has_z_translation"),translation_units:xn("has_translation_units")}},si={x:Ii("uberon"),body:Ii("uberon")("0013702")},qRe={x:Ii("cl"),cell:Ii("cl")("0000000")},Gv={x:Ii("fma")},pd=(Ii("lmha"),{body:si.body,cell:qRe.cell,respiratory_system:si.x("0001004"),colon:si.x("0001155"),left_lung:si.x("0002168"),right_lung:si.x("0002167"),left_bronchus:si.x("0002178"),right_bronchus:si.x("0002177"),kidney:si.x("0002113"),ureter:si.x("0000056"),eye:si.x("0000970"),fallopian_tube:si.x("0003889"),knee:si.x("0001465"),ovary:si.x("0000992"),trachea:si.x("0003126"),aorta:si.x("0000947"),blood:si.x("0000178"),bone_marrow:si.x("0002371"),male_reproductive_system:si.x("0000079"),lymph_node:si.x("0000029"),blood_vasculature:si.x("0004537"),brain:si.x("0000955"),eye_left:si.x("0004548"),eye_right:Gv.x("54449"),fallopian_tube_left:si.x("0001303"),fallopian_tube_right:si.x("0001302"),heart:si.x("0000948"),kidney_left:si.x("0004538"),kidney_right:si.x("0004539"),knee_left:Gv.x("24978"),knee_right:Gv.x("24977"),large_intestine:si.x("0000059"),liver:si.x("0002107"),lungs:si.x("0002048"),mesenteric_lymph_node:si.x("0002509"),ovary_left:Gv.x("7214"),ovary_right:Gv.x("7213"),pancreas:si.x("0001264"),pelvis:si.x("0001270"),prostate_gland:si.x("0002367"),skin:si.x("0002097"),small_intestine:si.x("0002108"),spleen:si.x("0002106"),thymus:si.x("0002370"),ureter_left:si.x("0001223"),ureter_right:si.x("0001222"),urinary_bladder:si.x("0001255"),uterus:si.x("0000995")});function RF(n){const e={};return Object.entries(n).forEach(([t,i])=>{e[i.id]=t}),e}const rT={spatialObjectReference:RF(Ri.spatialObjectReference),spatialEntity:RF(Ri.spatialEntity),spatialPlacement:RF(Ri.spatialPlacement)};function E9(n,e){const t=rp(n,e,"ExtractionSet",rT.spatialEntity);return t.extractionSites=(0,mr.sortBy)(n.getSubjects(Ri.spatialEntity.extraction_set,e,null).map(i=>sp(n,i.id)),["rui_rank"]),t}function sp(n,e){const t=rp(n,e,"SpatialEntity",rT.spatialEntity);return t.object&&(t.object=function(n,e){return rp(n,e,"SpatialObjectReference",rT.spatialObjectReference)}(n,t.object)),t.ccf_annotations&&(t.ccf_annotations=n.getObjects(e,Ri.spatialEntity.ccf_annotations,null).map(i=>i.id)),n.forSubjects(i=>t.entityId=i.id,hi.spatialEntity,e,null),t}function ZRe(n,e){const t=rp(n,e,"SpatialPlacement",rT.spatialPlacement);return t.source&&(t.source=sp(n,t.source)),t.target&&(t.target=sp(n,t.target)),t}function S9(n,e){const t=e;let i;switch(t.translation_units){case"centimeter":i=.01;break;case"millimeter":i=.001;break;case"meter":default:i=1}const r=[t.x_translation,t.y_translation,t.z_translation].map(a=>a*i),s=[t.x_rotation,t.y_rotation,t.z_rotation].map(QV),o=[t.x_scaling,t.y_scaling,t.z_scaling];return n.translate(r).rotateXYZ(s).scale(o)}class x9{constructor(e){this.db=e,this.createGraph()}createGraph(){this.graph=new FOe.DirectedGraph;const e=this.db.store;e.forSubjects(i=>{this.addNode(i.id,"SpatialObjectReference")},w9.type,Ri.SpatialObjectReference,null),e.forSubjects(i=>{this.addNode(i.id,"SpatialEntity")},w9.type,Ri.SpatialEntity,null);const t={};for(const i of(0,Vn.readQuads)(e,null,Ri.spatialPlacement.source,null,null))t[i.subject.id]=i.object.id;for(const i of(0,Vn.readQuads)(e,null,Ri.spatialPlacement.target,null,null)){const r=t[i.subject.id];r&&this.addEdge(i.subject.id,r,i.object.id,"SpatialPlacement")}}addNode(e,t){this.graph.mergeNode(e,{type:t})}addEdge(e,t,i,r){this.graph.mergeDirectedEdge(t,i,{type:r,id:e})}getTransformationMatrix(e,t){if(e===t)return new Gn(Gn.IDENTITY);if(!this.graph.hasNode(e)||!this.graph.hasNode(t))return;const i=this.db.store,r=new Gn(Gn.IDENTITY),s=kOe()(this.graph,e,t);if(s&&s.length>0){s.reverse();let o="";for(const a of s)o&&S9(r,ZRe(i,this.graph.getEdgeAttribute(a,o,"id"))),o=a;return r}}getSpatialPlacement(e,t){const i=this.graph.hasNode(e["@id"])?e["@id"]:void 0,r=(0,mr.get)(e,"placement[0]",(0,mr.get)(e,"placement",void 0));let s;if(r&&this.graph.hasNode(r.target)?(s=this.getTransformationMatrix(r.target,t),s&&(s=S9(s,r))):i&&(s=this.getTransformationMatrix(i,t)),s){const o=(new Xi).fromRotationMatrix(s,Xi.XYZ),a=s.getTranslation().map(u=>1e3*u),l=o.toVector3().map(Mre),c=s.getScale().map(u=>u<1&&u>.999999?1:u);return{"@context":"https://hubmapconsortium.github.io/hubmap-ontology/ccf-context.jsonld","@id":`http://purl.org/ccf/1.5/${WOe()}_placement`,"@type":"SpatialPlacement",source:e["@id"],target:t,placement_date:(new Date).toISOString().split("T")[0],x_scaling:c[0],y_scaling:c[1],z_scaling:c[2],scaling_units:"ratio",x_rotation:l[0],y_rotation:l[1],z_rotation:l[2],rotation_order:"XYZ",rotation_units:"degree",x_translation:a[0],y_translation:a[1],z_translation:a[2],translation_units:"millimeter"}}}}class C9{constructor(e){this.db=e}getSpatialEntity(e){return sp(this.db.store,e)}getExtractionSets(e){return function(n,e){return(0,mr.sortBy)(n.getSubjects(Ri.spatialEntity.extraction_set_for,e,null).map(t=>E9(n,t.id)),["rui_rank"])}(this.db.store,e)}getExtractionSet(e){return E9(this.db.store,e)}getAnatomicalStructures(e){return function(n,e){return(0,mr.sortBy)(n.getSubjects(Ri.spatialEntity.reference_organ,e,null).map(t=>sp(n,t.id)).filter(t=>t["@id"]!==e),["rui_rank"])}(this.db.store,e)}getReferenceOrgans(){return function(n){const e=[];return n.forEach(t=>{t.subject.id===t.object.id&&e.push(sp(n,t.subject.id))},null,Ri.spatialEntity.reference_organ,null,null),(0,mr.sortBy)(e,["rui_rank"])}(this.db.store)}getReferenceBody(e){let t;switch(null==e?void 0:e.sex){case"Male":t=Ri.spatial.Male.id;break;case"Female":t=Ri.spatial.Female.id;break;case"Both":default:t=Ri.spatial.BothSexes.id}return this.getSpatialEntity(t)}getReferenceOrganSets(e){let t=this.getReferenceOrgans();switch(null==e?void 0:e.sex){case"Male":t=t.filter(i=>"Male"===i.sex);break;case"Female":t=t.filter(i=>"Female"===i.sex)}return(null==e?void 0:e.debug)&&(t=t.map(i=>[[i],this.getAnatomicalStructures(i["@id"])]).reduce((i,[r,s])=>i.concat(s.length>0?s:r),[])),t}getReferenceSceneNodes(e){const t=this.getReferenceBody(e),i=[];let r=[...this.getReferenceOrganSets(e).map(s=>{const o="http://purl.obolibrary.org/obo/UBERON_0002097"===s.representation_of,a=this.getSceneNode(s,t,{color:[255,255,255,255],opacity:o?.5:.2,unpickable:!0,_lighting:"pbr",zoomBasedOpacity:!o});return o&&a?void i.push(a):a})];return i.length>0&&(r=[...i,...r]),(null==e?void 0:e.debug)&&(r=r.concat([this.getSceneNode(this.getSpatialEntity(Ri.x("VHRightKidney").id),t,{color:[0,0,255,127.5],geometry:"wireframe"}),this.getSceneNode(this.getSpatialEntity(Ri.x("VHLeftKidney").id),t,{color:[255,0,0,127.5],geometry:"wireframe"}),this.getSceneNode(this.getSpatialEntity(Ri.x("VHSpleenCC1").id),t,{color:[0,255,0,127.5],geometry:"wireframe"}),this.getSceneNode(this.getSpatialEntity(Ri.x("VHSpleenCC2").id),t,{color:[0,255,0,127.5],geometry:"wireframe"}),this.getSceneNode(this.getSpatialEntity(Ri.x("VHSpleenCC3").id),t,{color:[0,255,0,127.5],geometry:"wireframe"})])),r.filter(s=>void 0!==s)}getReferenceOrganScene(e,t){var i,r;const s=void 0!==(null==t?void 0:t.sex)&&"both"!==(null===(i=null==t?void 0:t.sex)||void 0===i?void 0:i.toLowerCase()),o=this.getReferenceOrgans().filter(a=>a.representation_of===e&&(!s||a.sex===(null==t?void 0:t.sex)));if(o.length>0){const a=o[0],c=this.getSceneNode(a,a,{color:[255,255,255,255],opacity:"http://purl.obolibrary.org/obo/UBERON_0002097"===a.representation_of?.5:.2,unpickable:!0,_lighting:"pbr"}),u=(null!==(r=this.db.getSpatialEntities(t))&&void 0!==r?r:[]).map(h=>this.getSceneNode(h,a,{color:[255,255,255,229.5]}));return[c].concat(u).filter(h=>void 0!==h)}return[]}getEntitySceneNodes(e){const t=this.getReferenceBody(e);return this.db.getSpatialEntities(e).map(i=>this.getSceneNode(i,t,{color:[255,255,255,229.5]})).filter(i=>void 0!==i)}getSceneNode(e,t,i={}){var r,s,o,a;const l=null===(s=null===(r=null==e?void 0:e.object)||void 0===r?void 0:r.file_format)||void 0===s?void 0:s.startsWith("model/gltf");let u=this.db.graph.getTransformationMatrix(l&&e.object?e.object["@id"]:e["@id"],t["@id"]);if(u){if(l)u=new Gn(Gn.IDENTITY).rotateX(QV(90)).multiplyLeft(u);else{let h;switch(e.dimension_units){case"centimeter":h=.01;break;case"millimeter":h=.001;break;case"meter":default:h=1}const f=[e.x_dimension,e.y_dimension,e.z_dimension].map(g=>g*h/2);u.scale(f)}return Object.assign({"@id":e["@id"],"@type":"SpatialSceneNode",entityId:e.entityId,ccf_annotations:e.ccf_annotations,representation_of:e.representation_of,reference_organ:e.reference_organ,scenegraph:l?null===(o=e.object)||void 0===o?void 0:o.file:void 0,scenegraphNode:l?null===(a=e.object)||void 0===a?void 0:a.file_subpath:void 0,transformMatrix:u,tooltip:e.label},i)}}getScene(e){return[...this.getReferenceSceneNodes(e),...this.getEntitySceneNodes(e)]}}const sT="https://entity.api.hubmapconsortium.org/entities/",T9=new Set(["VAN0003-LK-32-21-AF_preIMS_registered_thumbnail.jpg","VAN0003-LK-32-21-IMS_NegMode_multilayer_thumbnail.jpg","VAN0003-LK-32-21-IMS_PosMode_multilayer_thumbnail.jpg","VAN0003-LK-32-21-PAS_registered_thumbnail.jpg","VAN0003-LK-32-22-AF_preMxIF_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc1_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc2_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc3_registered_thumbnail.jpg","VAN0005-RK-1-1-AF_preIMS_registered_thumbnail.jpg","VAN0005-RK-1-1-IMS_NegMode_multilayer_thumbnail.jpg","VAN0005-RK-1-1-IMS_PosMode_multilayer_thumbnail.jpg","VAN0005-RK-1-1-PAS_registered_thumbnail.jpg","VAN0005-RK-4-172-AF_preIMS_registered_thumbnail.jpg","VAN0005-RK-4-172-IMS_NegMode_multilayer_thumbnail.jpg","VAN0005-RK-4-172-IMS_PosMode_multilayer_thumbnail.jpg","VAN0005-RK-4-172-PAS_registered_thumbnail.jpg","VAN0006-LK-2-85-AF_preIMS_registered_thumbnail.jpg","VAN0006-LK-2-85-IMS_NegMode_multilayer_thumbnail.jpg","VAN0006-LK-2-85-IMS_PosMode_multilayer_thumbnail.jpg","VAN0006-LK-2-85-PAS_registered_thumbnail.jpg","VAN0006-LK-2-86-AF_preMxIF_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc1_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc2_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc3_registered_thumbnail.jpg","VAN0007-LK-203-103-AF_preIMS_registered_thumbnail.jpg","VAN0007-LK-203-103-IMS_NegMode_multilayer_thumbnail.jpg","VAN0007-LK-203-103-IMS_PosMode_multilayer_thumbnail.jpg","VAN0007-LK-203-103-PAS_registered_thumbnail.jpg","VAN0008-RK-403-100-AF_preIMS_registered_thumbnail.jpg","VAN0008-RK-403-100-IMS_NegMode_multilayer_thumbnail.jpg","VAN0008-RK-403-100-IMS_PosMode_multilayer_thumbnail.jpg","VAN0008-RK-403-100-PAS_registered_thumbnail.jpg","VAN0008-RK-403-101-AF_preMxIF_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc1_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc2_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc3_registered_thumbnail.jpg","VAN0009-LK-102-7-AF_preIMS_registered_thumbnail.jpg","VAN0009-LK-102-7-IMS_NegMode_multilayer_thumbnail.jpg","VAN0009-LK-102-7-IMS_PosMode_multilayer_thumbnail.jpg","VAN0009-LK-102-7-PAS_registered_thumbnail.jpg","VAN0010-LK-155-40-AF_preIMS_registered_thumbnail.jpg","VAN0010-LK-155-40-IMS_NegMode_multilayer_thumbnail.jpg","VAN0010-LK-155-40-IMS_PosMode_multilayer_thumbnail.jpg","VAN0010-LK-155-40-PAS_registered_thumbnail.jpg","VAN0011-RK-3-10-AF_preIMS_registered_thumbnail.jpg","VAN0011-RK-3-10-IMS_NegMode_multilayer_thumbnail.jpg","VAN0011-RK-3-10-IMS_PosMode_multilayer_thumbnail.jpg","VAN0011-RK-3-10-PAS_registered_thumbnail.jpg","VAN0011-RK-3-11-AF_preMxIF_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc1_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc2_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc3_registered_thumbnail.jpg","VAN0012-RK-103-75-AF_preIMS_registered_thumbnail.jpg","VAN0012-RK-103-75-IMS_NegMode_multilayer_thumbnail.jpg","VAN0012-RK-103-75-IMS_PosMode_multilayer_thumbnail.jpg","VAN0012-RK-103-75-PAS_registered_thumbnail.jpg","VAN0012-RK-103-76-AF_preMxIF_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc1_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc2_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc3_registered_thumbnail.jpg","VAN0013-LK-202-96-AF_preIMS_registered_thumbnail.jpg","VAN0013-LK-202-96-IMS_NegMode_multilayer_thumbnail.jpg","VAN0013-LK-202-96-IMS_PosMode_multilayer_thumbnail.jpg","VAN0013-LK-202-96-PAS_registered_thumbnail.jpg","VAN0013-LK-202-97-AF_preMxIF_registered_thumbnail.jpg","VAN0013-LK-202-97-MxIF_cyc1_registered_thumbnail.jpg","VAN0013-LK-202-97-MxIF_cyc2_registered_thumbnail.jpg","VAN0013-LK-202-97-MxIF_cyc3_registered_thumbnail.jpg","VAN0014-LK-203-108-AF_preIMS_registered_thumbnail.jpg","VAN0014-LK-203-108-IMS_NegMode_multilayer_thumbnail.jpg","VAN0014-LK-203-108-IMS_PosMode_multilayer_thumbnail.jpg","VAN0014-LK-203-108-PAS_registered_thumbnail.jpg","VAN0016-LK-202-89-AF_preIMS_registered_thumbnail.jpg","VAN0016-LK-202-89-IMS_NegMode_multilayer_thumbnail.jpg","VAN0016-LK-202-89-IMS_PosMode_multilayer_thumbnail.jpg","VAN0016-LK-202-89-PAS_registered_thumbnail.jpg","VAN0003-LK-32-21-AF_preIMS_registered_thumbnail.jpg","VAN0003-LK-32-21-IMS_NegMode_multilayer_thumbnail.jpg","VAN0003-LK-32-21-IMS_PosMode_multilayer_thumbnail.jpg","VAN0003-LK-32-21-PAS_registered_thumbnail.jpg","VAN0003-LK-32-22-AF_preMxIF_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc1_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc2_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc3_registered_thumbnail.jpg","VAN0005-RK-1-1-AF_preIMS_registered_thumbnail.jpg","VAN0005-RK-1-1-IMS_NegMode_multilayer_thumbnail.jpg","VAN0005-RK-1-1-IMS_PosMode_multilayer_thumbnail.jpg","VAN0005-RK-1-1-PAS_registered_thumbnail.jpg","VAN0005-RK-4-172-AF_preIMS_registered_thumbnail.jpg","VAN0005-RK-4-172-IMS_NegMode_multilayer_thumbnail.jpg","VAN0005-RK-4-172-IMS_PosMode_multilayer_thumbnail.jpg","VAN0005-RK-4-172-PAS_registered_thumbnail.jpg","VAN0006-LK-2-85-AF_preIMS_registered_thumbnail.jpg","VAN0006-LK-2-85-IMS_NegMode_multilayer_thumbnail.jpg","VAN0006-LK-2-85-IMS_PosMode_multilayer_thumbnail.jpg","VAN0006-LK-2-85-PAS_registered_thumbnail.jpg","VAN0006-LK-2-86-AF_preMxIF_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc1_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc2_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc3_registered_thumbnail.jpg","VAN0007-LK-203-103-AF_preIMS_registered_thumbnail.jpg","VAN0007-LK-203-103-IMS_NegMode_multilayer_thumbnail.jpg","VAN0007-LK-203-103-IMS_PosMode_multilayer_thumbnail.jpg","VAN0007-LK-203-103-PAS_registered_thumbnail.jpg","VAN0008-RK-403-100-AF_preIMS_registered_thumbnail.jpg","VAN0008-RK-403-100-IMS_NegMode_multilayer_thumbnail.jpg","VAN0008-RK-403-100-IMS_PosMode_multilayer_thumbnail.jpg","VAN0008-RK-403-100-PAS_registered_thumbnail.jpg","VAN0008-RK-403-101-AF_preMxIF_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc1_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc2_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc3_registered_thumbnail.jpg","VAN0011-RK-3-10-AF_preIMS_registered_thumbnail.jpg","VAN0011-RK-3-10-IMS_NegMode_multilayer_thumbnail.jpg","VAN0011-RK-3-10-IMS_PosMode_multilayer_thumbnail.jpg","VAN0011-RK-3-10-PAS_registered_thumbnail.jpg","VAN0011-RK-3-11-AF_preMxIF_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc1_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc2_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc3_registered_thumbnail.jpg","VAN0012-RK-103-75-AF_preIMS_registered_thumbnail.jpg","VAN0012-RK-103-75-IMS_NegMode_multilayer_thumbnail.jpg","VAN0012-RK-103-75-IMS_PosMode_multilayer_thumbnail.jpg","VAN0012-RK-103-75-PAS_registered_thumbnail.jpg","VAN0012-RK-103-76-AF_preMxIF_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc1_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc2_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc3_registered_thumbnail.jpg"]),eNe={"HBM558.SRZG.629":"HBM558.SRZG.629_UFL0002-SP-3-4-1.jpg","HBM562.NTMH.548":"HBM562.NTMH.548_UFL0006-SP-1-2-1.jpg","HBM685.KHRQ.684":"HBM685.KHRQ.684_UFL0008-LY07-1-1.jpg","HBM278.SFQW.627":"HBM278.SFQW.627_UFL0008-LY09-1-1.jpg","HBM427.SMGB.866":"HBM427.SMGB.866_UFL0004-SP-1-4-1.jpg","HBM432.LLCF.677":"HBM432.LLCF.677_UFL0001-SP-2-5-1.jpg","HBM586.ZSVS.996":"HBM586.ZSVS.996_UFL0008-SP-1-1-1.jpg","HBM285.XMBT.542":"HBM285.XMBT.542_UFL0006-TH-1-3-1.jpg","HBM289.BWJW.663":"HBM289.BWJW.663_UFL0006-TH-1-2-1.jpg","HBM255.SRPR.985":"HBM255.SRPR.985_UFL0005-TH-2-2-1.jpg","HBM799.WXHD.535":"HBM799.WXHD.535_UFL0009-LY02-1-1.jpg","HBM294.RZFN.624":"HBM294.RZFN.624_UFL0005-TH-1-1-1.jpg","HBM383.TRQG.424":"HBM383.TRQG.424_UFL0006-SP-1-3-1.jpg","HBM647.MFQB.496":"HBM647.MFQB.496_UFL0001-SP-1-2-1.jpg","HBM237.GGPR.739":"HBM237.GGPR.739_UFL0006-LY01-1-1.jpg","HBM288.TPBD.654":"HBM288.TPBD.654_UFL0003-SP-2-2-1.jpg","HBM974.NDXT.675":"HBM974.NDXT.675_UFL0008-TH-2-2-1.jpg","HBM589.SLVV.423":"HBM589.SLVV.423_UFL0008-LY10-1-1.jpg","HBM794.RLFN.358":"HBM794.RLFN.358_UFL0006-LY03-1-1.jpg","HBM372.BQSR.778":"HBM372.BQSR.778_UFL0007-SP-1-1-1.jpg","HBM499.TKDW.458":"HBM499.TKDW.458_UFL0009-LY03-1-1.jpg","HBM342.PRQB.739":"HBM342.PRQB.739_UFL0003-LY06-1-1.jpg","HBM633.CLVN.674":"HBM633.CLVN.674_UFL0003-SP-3-6-1.jpg","HBM343.JQKM.578":"HBM343.JQKM.578_UFL0009-LY01-1-1.jpg","HBM987.XGTH.368":"HBM987.XGTH.368_UFL0002-SP-2-4-1.jpg","HBM964.CWCP.788":"HBM964.CWCP.788_UFL0006-LY02-2-1.jpg","HBM244.TJLK.223":"HBM244.TJLK.223_UFL0003-SP-1-4-1.jpg","HBM646.FSBQ.966":"HBM646.FSBQ.966_UFL0007-SP-2-2-1.jpg","HBM572.GXSB.234":"HBM572.GXSB.234_UFL0003-SP-3-2-1.jpg","HBM772.TKGJ.794":"HBM772.TKGJ.794_UFL0008-SP-2-1-1.jpg","HBM239.CBWR.263":"HBM239.CBWR.263_UFL0008-SP-1-2-1.jpg","HBM992.NRTT.383":"HBM992.NRTT.383_UFL0006-SP-1-1-1.jpg","HBM283.DQXD.546":"HBM283.DQXD.546_UFL0003-SP-1-2-1.jpg","HBM795.JHND.856":"HBM795.JHND.856_UFL0007-SP-1-2-1.jpg","HBM267.BZKT.867":"HBM267.BZKT.867_UFL0003-SP-2-6-1.jpg","HBM838.DLMJ.782":"HBM838.DLMJ.782_UFL0008-TH-1-1-1.jpg","HBM337.FSXL.564":"HBM337.FSXL.564_UFL0001-SP-3-8-2.jpg","HBM355.JDLK.244":"HBM355.JDLK.244_UFL0004-SP-2-4-1.jpg","HBM599.PSZG.737":"HBM599.PSZG.737_UFL0006-LY02-1-1.jpg"},Vm={"03b3d854-ed44-11e8-8bce-0e368f3075e8":"TMC-UCSD","07a29e4c-ed43-11e8-b56a-0e8017bdda58":"TMC-Florida","308f5ffc-ed43-11e8-b56a-0e8017bdda58":"TMC-CalTech","5bd084c8-edc2-11e8-802f-0e368f3075e8":"HBM-TestingGroup","73bb26e4-ed43-11e8-8f19-0a7c1eab007a":"TMC-Vanderbilt","def5fd76-ed43-11e8-b56a-0e8017bdda58":"TMC-Stanford","5c106f29-ea2d-11e9-85e8-0efb3ba9a670":"RTI-General Electric","301615f9-c870-11eb-a8dc-35ce3d8786fe":"TMC-UConn"},A9={"@base":"http://purl.org/ccf/latest/ccf-entity.owl#","@vocab":"http://purl.org/ccf/latest/ccf-entity.owl#",ccf:"http://purl.org/ccf/latest/ccf.owl#",rdfs:"http://www.w3.org/2000/01/rdf-schema#",label:"rdfs:label",description:"rdfs:comment",link:{"@id":"rdfs:seeAlso","@type":"@id"},samples:{"@reverse":"has_donor"},sections:{"@id":"has_tissue_section","@type":"@id"},datasets:{"@id":"has_dataset","@type":"@id"},rui_location:{"@id":"has_spatial_entity","@type":"@id"},ontologyTerms:{"@id":"has_ontology_term","@type":"@id"},cellTypeTerms:{"@id":"has_cell_type_term","@type":"@id"},thumbnail:{"@id":"has_thumbnail"}};class iNe{constructor(e,t="",i="",r){var s,o;if(this.data=e,this.bad=!1,this["@type"]="Sample",this.sample_type="Tissue Block","Sample"!==this.data.entity_type)return void(this.bad=!0);const c=this.data.descendants||[],u=(this.data.ancestors||[]).find(Pe=>"Donor"===Pe.entity_type);this.donor=this.getDonor(u,i);const h=this.getRuiLocation(e,this.donor);h?this.rui_location=h:this.bad=!0,Vm[e.group_uuid]||(Vm[e.group_uuid]=e.group_name);const f=new Date(e.last_modified_timestamp).toLocaleDateString(),g=Vm[e.group_uuid]||e.group_name,m=e.created_by_user_displayname;this["@id"]=sT+e.uuid,this.label=`Registered ${f}, ${m}, ${g}`,this.link=`${i}browse/sample/${e.uuid}`;const w={},S=[];this.sections=S;const U=[];this.datasets=U;for(const Pe of c.filter(Ve=>"Sample"===Ve.entity_type)){const Ve=this.getSection(Pe,e,i);w[Pe.submission_id]=Ve,S.push(Ve),Ve.section_number=null!==(s=Ve.section_number)&&void 0!==s?s:S.length}for(const Pe of c)if("Dataset"===Pe.entity_type){const Ve=this.getDataset(Pe,t,i,r),vt=(0,mr.get)(Pe,["ingest_metadata","metadata","tissue_id"]);w[vt]?null===(o=w[vt].datasets)||void 0===o||o.push(Ve):U.push(Ve)}const D=null!=h?h:{},ie=`${D.x_dimension} x ${D.y_dimension} x ${D.z_dimension} ${D.dimension_units}`;this.section_count=D.slice_count||S.length;const _e=parseFloat((D.slice_thickness||(D.z_dimension||0)/Math.max(this.section_count,1)).toFixed(1));this.section_size=_e;const Ne=D.dimension_units||"millimeter";this.section_units=Ne,this.description=`${ie}, ${_e} ${Ne}, ${e.specimen_type}, ${this.section_count} Sections`,S.forEach((Pe,Ve)=>{Pe.description=`${D.x_dimension} x ${D.y_dimension} x ${_e} ${Ne}, ${_e} ${Ne}, ${Pe.description}`,Pe.section_number=Ve+1})}getSection(e,t,i){const r=new Date(e.last_modified_timestamp).toLocaleDateString();return{"@id":sT+e.uuid,"@type":"Sample",label:`Registered ${r}, ${e.created_by_user_displayname}, ${Vm[e.group_uuid]||e.group_name}`,description:`${t.specimen_type}`,link:`${i}browse/sample/${e.uuid}`,sample_type:"Tissue Section",section_number:1,samples:[],datasets:[]}}getDataset(e,t="",i="",r){var s;const o=new Date(e.last_modified_timestamp).toLocaleDateString(),a=Vm[e.group_uuid]||e.group_name,l=e.created_by_user_displayname,c=[...e.data_types,(0,mr.get)(e,["ingest_metadata","metadata","assay_type"],"")],u=c.join("|").toLowerCase();let h,f="assets/icons/ico-unknown.svg";return-1!==u.indexOf("10x")?(h="10x",f="assets/icons/ico-bulk-10x.svg"):-1!==u.indexOf("af")?(h="AF",f="assets/icons/ico-spatial-af.svg"):-1!==u.indexOf("codex")?(h="CODEX",f="assets/icons/ico-spatial-codex.svg"):-1!==u.indexOf("imc")?(h="IMC",f="assets/icons/ico-spatial-imc.svg"):-1!==u.indexOf("lc")&&-1===u.indexOf("af")?(h="LC",f="assets/icons/ico-bulk-lc.svg"):h=-1!==u.indexOf("maldi")?"MALDI":-1!==u.indexOf("pas")?"PAS":"OTHER",f=null!==(s=this.getDatasetThumbnail(e,t,r))&&void 0!==s?s:f,{"@id":sT+e.uuid,"@type":"Dataset",label:`Registered ${o}, ${l}, ${a}`,description:`Data/Assay Types: ${c.join(", ")}`,link:`${i}browse/dataset/${e.uuid}`,technology:h,thumbnail:f}}getDatasetThumbnail(e,t,i){if(e.thumbnail_file){const r=e.thumbnail_file;return`${t}/${r.file_uuid}/${r.filename}`+(i?`?token=${i}`:"")}if("73bb26e4-ed43-11e8-8f19-0a7c1eab007a"===e.group_uuid){const r=(0,mr.get)(e,"metadata.files",[]).filter(s=>/\.(ome\.tif|ome\.tiff)$/.test(s.rel_path)).filter(s=>!/(multilayer\.ome\.tif|_ac\.ome\.tif)/.test(s.rel_path)).filter(s=>T9.has(s.rel_path.split("/").slice(-1)[0].split("?")[0].replace(".ome.tif","_thumbnail.jpg"))).map(s=>`${t}/${e.uuid}/${s.rel_path}`+(i?`?token=${i}`:""));if(r.length>0){const s=r[0].split("/").slice(-1)[0].split("?")[0].replace(".ome.tif","_thumbnail.jpg");if(T9.has(s))return`assets/thumbnails/TMC-Vanderbilt/DR1/${s}`}}else if("07a29e4c-ed43-11e8-b56a-0e8017bdda58"===e.group_uuid){const r=eNe[e.hubmap_id];if(r)return`assets/thumbnails/TMC-Florida/${r}`}}getDonor(e,t){const i=(e.description||"").toLowerCase();let r;i.includes("female")?r="Female":i.includes("male")&&(r="Male");const s=i.match(/age ([0-9]+)/);let o,a;s&&(o=(0,mr.toNumber)(s[1]));for(const f of(0,mr.get)(e,"metadata.organ_donor_data",[]))"Feminine gender"===f.preferred_term||"Female"===f.preferred_term?r="Female":"Masculine gender"===f.preferred_term||"Male"===f.preferred_term?r="Male":"Current chronological age"===f.preferred_term||"Age"===f.preferred_term?o=(0,mr.toNumber)(f.data_value):"Body mass index"===f.preferred_term&&(a=(0,mr.toNumber)(f.data_value));let l="";r&&o&&(l+=`${r}, Age ${o}`,a&&(l+=`, BMI ${a.toFixed(1)}`));const c=new Date(e.last_modified_timestamp).toLocaleDateString(),u=Vm[e.group_uuid]||e.group_name;return{"@id":sT+e.uuid,"@type":"Donor",label:l,description:`Entered ${c}, ${e.created_by_user_displayname}, ${u}`,link:`${t}browse/donor/${e.uuid}`,age:o,sex:r,bmi:a,consortium_name:"HuBMAP",provider_name:u,provider_uuid:e.group_uuid,samples:[]}}getRuiLocation(e,t){var i;let r,s=e.rui_location;if(s&&("string"==typeof s&&(s=JSON.parse(s)),s.alignment_id?console.log("Detected a deprecated rui_location",e.uuid):s["@id"]&&(r=s)),r){const o=null!==(i=(0,mr.get)(r,["placement","target"]))&&void 0!==i?i:"";o.startsWith("http://purl.org/ccf/latest/ccf.owl#VHSpleenCC")?(0,mr.set)(r,["placement","target"],o.replace("#VHSpleenCC","Male"===t.sex?"#VHMSpleenCC":"#VHFSpleenCC")):("http://purl.org/ccf/latest/ccf.owl#VHLeftKidney"===o||"http://purl.org/ccf/latest/ccf.owl#VHRightKidney"===o)&&(0,mr.set)(r,["placement","target"],"Male"===t.sex?o.replace("#VH","#VHM")+"_Patch":o.replace("#VH","#VHF")+"_Patch")}return r}getTissueBlock(){return(0,mr.omit)(Object.assign({},this),["data","bad","donor"])}toJsonLd(){return Object.assign(Object.assign({},this.donor),{samples:[this.getTissueBlock()]})}}const sNe=["uuid","entity_type","group_uuid","group_name","last_modified_timestamp","created_by_user_displayname","ancestors","descendants","rui_location","specimen_type"],oNe={exists:{field:"rui_location"}};function M9(n,e,t){return JSON.stringify({version:!0,from:n,size:e,stored_fields:["*"],script_fields:{},docvalue_fields:[],query:null!=t?t:oNe,_source:{includes:sNe}})}function NF(n,e){return Pi(this,void 0,void 0,function*(){try{const t=yield fetch(n,e);return t.ok?yield t.json():void 0}catch(t){return}})}function D9(n,e,t,i,r="",s=""){return Pi(this,void 0,void 0,function*(){let o;if("static"===e?o=yield NF(n):"search-api"===e&&(o=yield function(n,e,t){return Pi(this,void 0,void 0,function*(){const r=function(n){const e=new Headers;return e.append("Content-type","application/json"),n&&e.append("Authorization",`Bearer ${n}`),e}(e),s=M9(0,50,t),o=yield NF(n,{method:"POST",headers:r,body:s});if(!o)return;const a=o.hits.total.value;if(a<=50)return o;const l=[];for(let h=50;h<a;h+=50)l.push(NF(n,{method:"POST",headers:r,body:M9(h,50,t)}));const c=yield Promise.all(l);if(c.some(h=>!h))return;const u=c.map(h=>h.hits.hits);return Object.assign(Object.assign({},o),{hits:Object.assign(Object.assign({},o.hits),{hits:o.hits.hits.concat(...u)})})})}(n,i,t)),o)return function(n,e="",t="",i,r=!1){const o={},a=(0,mr.get)(n,"hits.hits",[]).map(c=>(0,mr.get)(c,"_source",{})).map(c=>new iNe(c,e,t,i).toJsonLd());for(const c of a){const u=c["@id"];o[u]?o[u].samples.push(c.samples[0]):o[u]=c}const l=Object.values(o);return r&&(function(n){let e=[],t=0;for(const i of n.filter(r=>r.samples.length>1)){const r=i.samples;for(let s=0;s<r.length;s++){const o=r[s]["@id"];e=e.concat(r[s].datasets);for(const a of r[s].sections)e=e.concat(a.datasets);for(let a=s+1;a<r.length;a++)r[a].sections.find(c=>c["@id"]===o)&&(r[s].deleteMe=!0,t++)}i.samples=r.filter(s=>!0!==s.deleteMe)}t>0&&console.log(`\u26a0 ${t} sections identified as blocks`)}(l),console.log(l.map(c=>Object.assign({"@context":A9},c)))),{"@context":A9,"@graph":l}}(o,r,s,i);console.warn(`Unable to load ${n} as HuBMAP Data`)})}function $v(n,e,t){const i=new Set;for(const r of e)for(const s of(0,Vn.readQuads)(n,r,t,null,null))i.add(s.object.id);return i}const hNe={[Ri.spatialEntity.x_dimension.id]:"x",[Ri.spatialEntity.y_dimension.id]:"y",[Ri.spatialEntity.z_dimension.id]:"z"};function pNe(n,e,t,i){const r=e.getTransformationMatrix(t,i);let s;if(r){const o=function(n,e){const t=rp(n,e,"Dimensions",hNe);return[t.x,t.y,t.z]}(n,t),a=r.getTranslation(),l=(new Xi).fromRotationMatrix(r,Xi.XYZ),c=new jv(jv.IDENTITY).fromQuaternion(l.toQuaternion()).scale(o.map(u=>u/1e3/1e3));s=new xF(a,c)}return s}function gNe(n,e,t,i){const{x:r,y:s,z:o,radius:a,target:l}=i,c=new Set,u=a/1e3*(a/1e3);for(const h of t){const f=pNe(n,e,h,l);f&&f.distanceSquaredTo([r,s,o].map(m=>m/1e3))<u&&c.add(h)}return c}function oT(n,e,t){var i,r;const s=new Map,o=new Set;for(const c of e)for(const u of(0,Vn.readQuads)(n,c,hi.donor,null,null))o.add(u.object.id),s.has(u.object.id)?null===(i=s.get(u.object.id))||void 0===i||i.push(c):s.set(u.object.id,[c]);const a=t(o),l=new Set;for(const c of a)for(const u of null!==(r=s.get(c))&&void 0!==r?r:[])l.add(u);return l}function PF(n,e,t){var i,r;const s=new Map,o=new Set;for(const c of e)for(const u of(0,Vn.readQuads)(n,c,hi.spatialEntity,null,null))o.add(u.object.id),s.has(u.object.id)?null===(i=s.get(u.object.id))||void 0===i||i.push(c):s.set(u.object.id,[c]);const a=t(o),l=new Set;for(const c of a)for(const u of null!==(r=s.get(c))&&void 0!==r?r:[])l.add(u);return l}function Wv(n,e){return function(t){n.has(t.id)&&e.add(t.id)}}function I9(n,e,t){const i=new Set;for(const r of t){const s=Vn.DataFactory.namedNode(r);n.forSubjects(Wv(e,i),Ri.spatialEntity.ccf_annotations,s,null)}return i}function O9(n,e){const t=function(n,e){const t=new Map;for(const i of n)for(const r of(0,Vn.readQuads)(e,i,hi.spatialEntity,null,null))t.has(r.object.id)?t.get(r.object.id).add(i):t.set(r.object.id,new Set([i]));return t}(n,e),i=new Map;for(const r of t.keys()){const s=t.get(r);for(const o of(0,Vn.readQuads)(e,r,Ri.spatialEntity.ccf_annotations,null,null))if(i.has(o.object.id)){const a=i.get(o.object.id);s.forEach(l=>a.add(l))}else i.set(o.object.id,new Set(s))}return i}function INe(n,e,t){const i={"@id":e,"@type":"OntologyTreeNode",id:e,parent:"",children:[],synonymLabels:[],label:""},r={[Ri.ontologyNode.label.id]:"label",[t]:"parent",[Ri.ontologyNode.synonymLabels.id]:"synonymLabels"};for(const[s,o]of OF(n,e,r))"synonymLabels"===s?i.synonymLabels.push(o):i[s]=o;return i.children=n.getSubjects(t,e,null).map(s=>s.id),i}function R9(n,e,t,i){const r={root:e,nodes:{}},s=new Set;for(const a of(0,Vn.readQuads)(n,null,i,null,null))s.add(a.subject.id),s.add(a.object.id);for(const a of s)r.nodes[a]=INe(n,a,i);r.nodes[e]||(r.nodes[e]={"@id":e,"@type":"OntologyTreeNode",id:e,label:t,children:[],synonymLabels:[]});const o=n.getSubjects(i,e,null).map(a=>a.id).sort((a,l)=>r.nodes[a].label.localeCompare(r.nodes[l].label));return r.nodes[e].children=o,r}const N9=(0,mr.memoize)(function(n){const e=R9(n,pd.body.id,"body",Ri.asctb.part_of.id);return e.nodes[pd.body.id].children=["http://purl.obolibrary.org/obo/UBERON_0000955","http://purl.obolibrary.org/obo/UBERON_0000029","http://purl.obolibrary.org/obo/UBERON_0000970","http://purl.obolibrary.org/obo/UBERON_0003889","http://purl.obolibrary.org/obo/UBERON_0000948","http://purl.obolibrary.org/obo/UBERON_0002113","http://purl.obolibrary.org/obo/UBERON_0001465","http://purl.obolibrary.org/obo/UBERON_0002107","http://purl.obolibrary.org/obo/UBERON_0002048","http://purl.obolibrary.org/obo/UBERON_0000992","http://purl.obolibrary.org/obo/UBERON_0001264","http://purl.obolibrary.org/obo/UBERON_0001270","http://purl.obolibrary.org/obo/UBERON_0001987","http://purl.obolibrary.org/obo/UBERON_0002367","http://purl.obolibrary.org/obo/UBERON_0002097","http://purl.obolibrary.org/obo/UBERON_0002108","http://purl.obolibrary.org/obo/UBERON_0002240","http://purl.obolibrary.org/obo/UBERON_0000059","http://purl.obolibrary.org/obo/UBERON_0002106","http://purl.obolibrary.org/obo/UBERON_0002370","http://purl.obolibrary.org/obo/UBERON_0000056","http://purl.obolibrary.org/obo/UBERON_0001255","http://purl.obolibrary.org/obo/UBERON_0000995","http://purl.obolibrary.org/obo/UBERON_0004537"].filter(t=>t in e.nodes),e},()=>""),aT={[hi.label.id]:"label",[hi.description.id]:"description",[hi.link.id]:"link"},NNe=Object.assign(Object.assign({},aT),{[hi.providerName.id]:"providerName"}),PNe=Object.assign(Object.assign({},aT),{[hi.technology.id]:"technology",[hi.thumbnail.id]:"thumbnail"}),FNe=Object.assign(Object.assign({},aT),{[hi.sampleType.id]:"sampleType",[hi.sectionNumber.id]:"sectionNumber",[hi.datasets.id]:"datasets"}),LNe=Object.assign(Object.assign({},aT),{[hi.sampleType.id]:"sampleType",[hi.sectionCount.id]:"sectionCount",[hi.sectionSize.id]:"sectionSize",[hi.sectionUnits.id]:"sectionUnits",[hi.donor.id]:"donor",[hi.spatialEntity.id]:"spatialEntityId",[hi.sections.id]:"sections",[hi.datasets.id]:"datasets"});function kNe(n,e){return rp(n,e,"Donor",NNe)}function P9(n,e){return rp(n,e,"Dataset",PNe)}function BNe(n,e){const t={"@id":e,"@type":"Sample",datasets:[]};for(const[i,r]of OF(n,e,FNe))if("datasets"===i){const s=P9(n,r);t[i].push(s)}else t[i]=r;return t}class jNe{constructor(e){this.database=e,this.connect()}toJson(){return{status:this.status,message:this.message,checkback:"Ready"===this.status||"Error"===this.status?36e5:2e3,loadTime:this.loadTime}}connect(){this.status="Loading",this.message="Loading database";const e=Date.now();return this.database.connect().then(t=>Pi(this,void 0,void 0,function*(){t?(this.message="Building scene",yield this.database.getScene(),this.message="Building tissue block results",yield this.database.getTissueBlockResults(),this.message="Aggregating results",yield this.database.getAggregateResults(),this.status="Ready",this.message="Database successfully loaded"):(this.status="Error",this.message="Unknown error while loading database")})).catch(t=>{var i;this.status="Error",this.message=null!==(i=null==t?void 0:t.message)&&void 0!==i?i:"Unknown error while loading database"}).finally(()=>{this.loadTime=Date.now()-e})}}const zNe={ccfOwlUrl:"https://purl.org/ccf/latest/ccf.owl",ccfContextUrl:"https://purl.org/ccf/latest/ccf-context.jsonld",dataSources:[],hubmapDataService:"static",hubmapPortalUrl:"https://portal.hubmapconsortium.org/",hubmapDataUrl:"",hubmapAssetsUrl:"https://assets.hubmapconsortium.org"};class HNe{constructor(e=zNe){this.options=e,this.store=new Vn.Store(void 0,{factory:Vn.DataFactory}),this.graph=new x9(this),this.scene=new C9(this)}connect(e,t=!1){return Pi(this,void 0,void 0,function*(){return e&&(this.options=e),this.initializing||(this.initializing=t?this.cachedConnect():this.doConnect()),yield this.initializing,this.store.size>0})}cachedConnect(){return Pi(this,void 0,void 0,function*(){const e=(new Date).getTime(),t="ccf-database.last_modified",i="ccf-database",r=yield o9(t).catch(()=>{});let s;r&&e-new Date(+r).getTime()>36e5?yield function(n,e=yc()){return e("readwrite",t=>(n.forEach(i=>t.delete(i)),hu(t.transaction)))}([i,t]).catch(()=>{}):s=yield o9(i).catch(()=>{}),s?yield this.deserialize(s):(yield this.doConnect(),function(n,e=yc()){return e("readwrite",t=>(n.forEach(i=>t.put(i[1],i[0])),hu(t.transaction)))}([[i,this.serialize()],[t,""+e]]).catch(()=>{}))})}doConnect(){var e,t;return Pi(this,void 0,void 0,function*(){const i=[],r=null!==(t=null===(e=this.options.dataSources)||void 0===e?void 0:e.concat())&&void 0!==t?t:[],s=this.options.ccfOwlUrl;if(s.startsWith("{"))this.store=(0,Vn.deserializeN3Store)(s,Vn.DataFactory);else if(s.endsWith(".n3store.json")){const o=yield fetch(s).then(a=>a.text()).catch(()=>console.log("Couldn't locate serialized store."));o&&(this.store=(0,Vn.deserializeN3Store)(o,Vn.DataFactory))}else(null==s?void 0:s.length)>0&&r.push(s);this.options.hubmapDataUrl&&(this.options.hubmapDataUrl.endsWith("jsonld")?r.push(this.options.hubmapDataUrl):i.push(D9(this.options.hubmapDataUrl,this.options.hubmapDataService,this.options.hubmapQuery,this.options.hubmapToken,this.options.hubmapAssetsUrl,this.options.hubmapPortalUrl).then(o=>{if(o)return this.addDataSources([o])}))),i.push(this.addDataSources(r)),yield Promise.all(i),yield this.synchronize()})}addDataSources(e,t){return Pi(this,void 0,void 0,function*(){const i=null!=t?t:this.store;return yield Promise.all(e.map(r=>Pi(this,void 0,void 0,function*(){"string"==typeof r?r.endsWith("jsonld")?yield(0,Vn.addJsonLdToStore)(r,i):r.endsWith("n3")?yield(0,Vn.addN3ToStore)(r,i):r.endsWith("rdf")||r.endsWith("owl")||r.endsWith("xml")?yield(0,Vn.addRdfXmlToStore)(r,i):yield(0,Vn.addJsonLdToStore)(r,i):yield(0,Vn.addJsonLdToStore)(r,i)}))),this})}synchronize(){return Pi(this,void 0,void 0,function*(){return yield new Promise(e=>{setTimeout(e,500)}),this.graph.createGraph(),function(n){var e,t,i;const r=N9(n),s=new Map;for(const{subject:o,object:a}of(0,Vn.readQuads)(n,null,Ri.spatialEntity.representation_of,null,null)){const l=new Set([a.id]);let c=null===(e=r.nodes[a.id])||void 0===e?void 0:e.parent;for(;c&&!l.has(c);)l.add(c),c=null===(t=r.nodes[c])||void 0===t?void 0:t.parent;s.set(o.id,[...l].map(u=>Vn.DataFactory.namedNode(u)))}for(const{object:o}of(0,Vn.readQuads)(n,null,hi.spatialEntity,null,null))for(const{subject:a}of(0,Vn.readQuads)(n,null,Ri.spatialPlacement.source,o,null))for(const{object:l}of(0,Vn.readQuads)(n,a,Ri.spatialPlacement.target,null,null))for(const c of null!==(i=s.get(l.id))&&void 0!==i?i:[])n.addQuad(Vn.DataFactory.namedNode(o.id),Ri.spatialEntity.ccf_annotations,c)}(this.store),this})}serialize(){return(0,Vn.serializeN3Store)(this.store)}deserialize(e){return Pi(this,void 0,void 0,function*(){this.store=(0,Vn.deserializeN3Store)(e,Vn.DataFactory),this.graph=new x9(this),this.scene=new C9(this),yield new Promise(t=>{setTimeout(t,10)})})}getIds(e={}){return function(n,e,t){var i,r,s,o,a,l,c;let u=function(n){const e=new Set;return n.forSubjects(t=>e.add(t.id),hi.spatialEntity,null,null),e}(n);if(u.size>0&&(u=function(n,e,t=!0){const i=new Set;if(n.forSubjects(Wv(e,i),hi.spatialEntity,null,null),!t){const r=new Set;return e.forEach(s=>i.has(s)?void 0:r.add(s)),r}return i}(n,u)),u.size>0&&("Male"===t.sex||"Female"===t.sex)){const h=t.sex;u=oT(n,u,f=>function(n,e,t){const i=new Set;return n.forSubjects(Wv(e,i),hi.sex,hi[t],null),i}(n,f,h))}if(u.size>0&&(null===(i=t.tmc)||void 0===i?void 0:i.length)>0&&(u=oT(n,u,h=>function(n,e,t){const i=new Set;for(const r of t){const s=Vn.DataFactory.literal(r);n.forSubjects(Wv(e,i),hi.providerName,s,null)}return i}(n,h,t.tmc))),u.size>0&&(null===(r=t.technologies)||void 0===r?void 0:r.length)>0&&(u=function(n,e,t){var i,r;const s=new Map,o=new Set,a=new Set(e);for(const u of e)for(const h of(0,Vn.readQuads)(n,u,hi.sections,null,null))a.add(h.object.id);for(const u of a)for(const h of(0,Vn.readQuads)(n,u,hi.datasets,null,null))o.add(h.object.id),s.has(h.object.id)?null===(i=s.get(h.object.id))||void 0===i||i.push(u):s.set(h.object.id,[u]);const l=t(o),c=new Set;for(const u of l)for(const h of null!==(r=s.get(u))&&void 0!==r?r:[])c.add(h);return c}(n,u,h=>function(n,e,t){const i=new Set;for(const r of t){const s=Vn.DataFactory.literal(r);n.forSubjects(Wv(e,i),hi.technology,s,null)}return i}(n,h,t.technologies))),u.size>0&&(null===(s=t.spatialSearches)||void 0===s?void 0:s.length)>0&&(u=PF(n,u,h=>function(n,e,t,i){const r=new Set;for(const s of i)gNe(n,e,t,s).forEach(a=>r.add(a));return r}(n,e,h,t.spatialSearches))),u.size>0&&(null===(o=t.ontologyTerms)||void 0===o?void 0:o.length)>0){const h=t.ontologyTerms;-1===h.indexOf(pd.body.id)&&(u=PF(n,u,f=>I9(n,f,h)))}if(u.size>0&&(null===(a=t.cellTypeTerms)||void 0===a?void 0:a.length)>0){const h=t.cellTypeTerms;-1===h.indexOf(pd.cell.id)&&(u=PF(n,u,f=>function(n,e,t){const i=new Set;for(const r of t)n.forObjects(s=>{i.add(s.id)},r,Ri.asctb.located_in,null),r===pd.cell.id&&i.add(pd.body.id);return I9(n,e,[...i])}(n,f,h)))}if(u.size>0&&2===(null===(l=t.ageRange)||void 0===l?void 0:l.length)&&(0,mr.isFinite)(t.ageRange[0])&&(0,mr.isFinite)(t.ageRange[1])){const h=Math.max(...t.ageRange),f=Math.min(...t.ageRange);1===f&&110===h||(u=oT(n,u,g=>function(n,e,t,i){const r=new Set;for(const s of e)for(const o of(0,Vn.readQuads)(n,s,hi.age,null,null)){const a=(0,JC.fromRdf)(o.object);a>=t&&a<=i&&r.add(s)}return r}(n,g,f,h)))}if(u.size>0&&2===(null===(c=t.bmiRange)||void 0===c?void 0:c.length)&&(0,mr.isFinite)(t.bmiRange[0])&&(0,mr.isFinite)(t.bmiRange[1])){const h=Math.max(...t.bmiRange),f=Math.min(...t.bmiRange);13===f&&83===h||(u=oT(n,u,g=>function(n,e,t,i){const r=new Set;for(const s of e)for(const o of(0,Vn.readQuads)(n,s,hi.bmi,null,null)){const a=(0,JC.fromRdf)(o.object);a>=t&&a<=i&&r.add(s)}return r}(n,g,f,h)))}return u}(this.store,this.graph,e)}get(e){return this.store.getQuads(Vn.DataFactory.namedNode(e),null,null,null)}search(e={}){return[...this.getIds(e)].map(t=>this.get(t))}getSpatialEntities(e){return e=Object.assign(Object.assign({},e),{hasSpatialEntity:!0}),[...this.getIds(e)].map(t=>function(n,e){const t=n.getObjects(Vn.DataFactory.namedNode(e),hi.spatialEntity,null);if(t.length>0)return sp(n,t[0].id)}(this.store,t))}getDatabaseStatus(){return Pi(this,void 0,void 0,function*(){return this.status||(this.status=new jNe(this)),this.status.toJson()})}getDatasetTechnologyNames(){return Pi(this,void 0,void 0,function*(){return function(n){const e=new Set;for(const t of(0,Vn.readQuads)(n,null,hi.technology,null,null))e.add(t.object.value);return Array.from(e).sort()}(this.store)})}getProviderNames(){return Pi(this,void 0,void 0,function*(){return function(n){const e=new Set;for(const t of(0,Vn.readQuads)(n,null,hi.providerName,null,null))e.add(t.object.value);return Array.from(e).sort()}(this.store)})}getTissueBlockResults(e){return Pi(this,void 0,void 0,function*(){return e=Object.assign(Object.assign({},e),{hasSpatialEntity:!0}),[...this.getIds(e)].map(t=>function(n,e){const t={"@id":e,"@type":"Sample",sections:[],datasets:[]};for(const[i,r]of OF(n,e,LNe))if("sections"===i){const s=BNe(n,r);t[i].push(s)}else if("datasets"===i){const s=P9(n,r);t[i].push(s)}else t[i]="donor"===i?kNe(n,r):r;return t}(this.store,t))})}getAggregateResults(e){return Pi(this,void 0,void 0,function*(){return function(n,e){const t=$v(e,n,hi.donor.id),i=$v(e,t,hi.providerUUID.id),r=new Set;for(const l of n)for(const c of(0,Vn.readQuads)(e,l,hi.spatialEntity,null,null))r.add(c.subject.id);const s=$v(e,r,hi.sections.id),o=new Set([...$v(e,r,hi.datasets.id),...$v(e,s,hi.datasets.id)]);return Object.entries({"Tissue Data Providers":i.size,Donors:t.size,"Tissue Blocks":r.size,"Tissue Sections":s.size,"Tissue Datasets":o.size}).map(([l,c])=>({label:l,count:c}))}(this.getIds(e),this.store)})}getOntologyTermOccurences(e){return Pi(this,void 0,void 0,function*(){return function(n,e){const t={};return O9(n,e).forEach((r,s)=>{t[s]=r.size}),t}(this.getIds(e),this.store)})}getCellTypeTermOccurences(e){return Pi(this,void 0,void 0,function*(){return function(n,e){var t,i;const r=O9(n,e),s=new Map;for(const a of r.keys()){const l=r.get(a);for(const c of(0,Vn.readQuads)(e,null,Ri.asctb.located_in,a,null)){const u=c.subject.id;if(s.has(u)){const h=s.get(u);l.forEach(f=>h.add(f))}else s.set(u,new Set(l))}}const o={};return s.forEach((a,l)=>{o[l]=a.size}),o[pd.cell.id]=null!==(i=null===(t=r.get(pd.body.id))||void 0===t?void 0:t.size)&&void 0!==i?i:0,o}(this.getIds(e),this.store)})}getOntologyTreeModel(){return Pi(this,void 0,void 0,function*(){return N9(this.store)})}getCellTypeTreeModel(){return Pi(this,void 0,void 0,function*(){return function(n){return R9(n,pd.cell.id,"cell",Ri.asctb.ct_is_a.id)}(this.store)})}getReferenceOrgans(){return Pi(this,void 0,void 0,function*(){return this.scene.getReferenceOrgans()})}getScene(e){return Pi(this,void 0,void 0,function*(){return this.graph.createGraph(),this.scene.getScene(e)})}getReferenceOrganScene(e,t){return Pi(this,void 0,void 0,function*(){return this.graph.createGraph(),this.scene.getReferenceOrganScene(e,t)})}getSpatialPlacement(e,t){return Pi(this,void 0,void 0,function*(){return this.graph.getSpatialPlacement(e,t)})}}const WNe=["bodyCanvas"];let qNe=(()=>{class n{constructor(){this.clsName="ccf-body-ui",this.rotationChange=new dn,this.nodeDrag=new dn,this.nodeClick=new dn,this.nodeHoverStart=new dn,this.nodeHoverStop=new dn,this.initialized=new dn,this._interactive=!0,this._rotation=0,this._rotationX=0,this._zoom=9.5,this._target=[0,0,0],this._scene=[],this.subscriptions=[]}get scene(){return this._scene}set scene(t){var i;this._scene=t,null===(i=this.bodyUI)||void 0===i||i.setScene(t)}get rotation(){return this._rotation}set rotation(t){var i;this._rotation=t,null===(i=this.bodyUI)||void 0===i||i.setRotation(t)}get rotationX(){return this._rotationX}set rotationX(t){var i;this._rotationX=t,null===(i=this.bodyUI)||void 0===i||i.setRotationX(t)}get zoom(){return this._zoom}set zoom(t){var i;this._zoom=t,null===(i=this.bodyUI)||void 0===i||i.setZoom(t)}get target(){return this._target}set target(t){var i;this._target=t,null===(i=this.bodyUI)||void 0===i||i.setTarget(t)}get bounds(){return this._bounds}set bounds(t){this._bounds=t,this.zoomToBounds(t)}get camera(){return this._camera}set camera(t){this._camera=t}get interactive(){return this._interactive}set interactive(t){this._interactive=t,this.bodyUI&&this.recreateBodyUI()}ngAfterViewInit(){this.setupBodyUI()}zoomToBounds(t,i={x:48,y:48}){if(this.bodyCanvas){const{width:r,height:s}=this.bodyCanvas.nativeElement,o=window.devicePixelRatio,a=Math.min(Math.log2((r-i.x)/o/t.x),Math.log2((s-i.y)/o/t.y));this.zoom=a}}setupBodyUI(){var t;return Pi(this,void 0,void 0,function*(){const i=this.bodyCanvas.nativeElement,r=new Zve({id:"body-ui",canvas:i,zoom:this.zoom,target:[0,0,0],rotation:0,minRotationX:-75,maxRotationX:75,interactive:this.interactive,camera:this.camera});i.addEventListener("contextmenu",s=>s.preventDefault()),yield r.initialize(),this.bodyUI=r,window.bodyUI=r,(null===(t=this.scene)||void 0===t?void 0:t.length)>0&&this.bodyUI.setScene(this.scene),this.bounds&&this.zoomToBounds(this.bounds),this.subscriptions=[this.bodyUI.sceneRotation$.subscribe(s=>this.rotationChange.next(s)),this.bodyUI.nodeDrag$.subscribe(s=>this.nodeDrag.emit(s)),this.bodyUI.nodeClick$.subscribe(s=>this.nodeClick.emit(s)),this.bodyUI.nodeHoverStart$.subscribe(s=>this.nodeHoverStart.emit(s)),this.bodyUI.nodeHoverStop$.subscribe(s=>this.nodeHoverStop.emit(s))],this.initialized.emit()})}recreateBodyUI(){this.clearSubscriptions(),this.bodyUI.finalize(),this.setupBodyUI()}clearSubscriptions(){this.subscriptions.forEach(t=>t.unsubscribe()),this.subscriptions=[]}ngOnDestroy(){this.clearSubscriptions()}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=_n({type:n,selectors:[["ccf-body-ui"]],viewQuery:function(t,i){if(1&t&&Ir(WNe,5,En),2&t){let r;gi(r=mi())&&(i.bodyCanvas=r.first)}},hostVars:2,hostBindings:function(t,i){2&t&&Vc(i.clsName)},inputs:{scene:"scene",rotation:"rotation",rotationX:"rotationX",zoom:"zoom",target:"target",bounds:"bounds",camera:"camera",interactive:"interactive"},outputs:{rotationChange:"rotationChange",nodeDrag:"nodeDrag",nodeClick:"nodeClick",nodeHoverStart:"nodeHoverStart",nodeHoverStop:"nodeHoverStop",initialized:"initialized"},decls:2,vars:0,consts:[[1,"body-ui"],["bodyCanvas",""]],template:function(t,i){1&t&&Ci(0,"canvas",0,1)},styles:["[_nghost-%COMP%]{height:100%;display:block}[_nghost-%COMP%]   .body-ui[_ngcontent-%COMP%]{position:relative!important;background-color:#000;border-radius:.5rem}"]}),n})(),YNe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=an({type:n}),n.\u0275inj=Ct({imports:[[Zr]]}),n})();new Gt("Maximum number of autocomplete options displayed",{providedIn:"root",factory:()=>10});const L9=[{src:"app:skin",organ:"Skin",name:"Skin",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002097"},{src:"app:brain",organ:"Brain",name:"Brain",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000955"},{disabled:!0,src:"app:lymph-nodes",organ:"Lymph Node",name:"Lymph Node",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000029"},{src:"app:lymph-nodes",organ:"Lymph Node",name:"Lymph Node",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002509"},{disabled:!0,src:"app:eye",organ:"Eye",name:"Eye, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000970"},{src:"app:eye",organ:"Eye",name:"Eye, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0004548"},{src:"app:eye",organ:"Eye",name:"Eye, R",side:"right",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0004549"},{disabled:!0,src:"app:fallopian-tube-left",organ:"Fallopian Tube",name:"Fallopian Tube, L",side:"left",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0003889"},{src:"app:fallopian-tube-left",organ:"Fallopian Tube",name:"Fallopian Tube, L",side:"left",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0001303"},{src:"app:fallopian-tube-right",organ:"Fallopian Tube",name:"Fallopian Tube, R",side:"right",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0001302"},{src:"app:heart",organ:"Heart",name:"Heart",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000948"},{disabled:!0,src:"app:kidney-left",organ:"Kidney",name:"Kidney, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002113"},{src:"app:kidney-left",organ:"Kidney",name:"Kidney, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0004538"},{src:"app:kidney-right",organ:"Kidney",name:"Kidney, R",side:"right",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0004539"},{disabled:!0,src:"app:knee",organ:"Knee",name:"Knee, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001465"},{src:"app:knee",organ:"Knee",name:"Knee, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/FMA_24978"},{src:"app:knee",organ:"Knee",name:"Knee, R",side:"right",hasSex:!0,id:"http://purl.obolibrary.org/obo/FMA_24977"},{src:"app:liver",organ:"Liver",name:"Liver",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002107"},{disabled:!0,src:"app:lung",organ:"Lung",name:"Lungs",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002048"},{src:"app:lung",organ:"Lung",name:"Lungs",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001004"},{disabled:!0,src:"app:ovary-left",organ:"Ovary",name:"Ovary, L",side:"left",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0000992"},{src:"app:ovary-left",organ:"Ovary",name:"Ovary, L",side:"left",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/FMA_7214"},{src:"app:ovary-right",organ:"Ovary",name:"Ovary, R",side:"right",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/FMA_7213"},{src:"app:pancreas",organ:"Pancreas",name:"Pancreas",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001264"},{src:"app:pelvis-f",organ:"Pelvis",name:"Pelvis",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001270"},{src:"app:placenta",organ:"Placenta",name:"Placenta",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0001987"},{src:"app:prostate",organ:"Prostate",name:"Prostate",hasSex:!1,sex:"male",id:"http://purl.obolibrary.org/obo/UBERON_0002367",disabled:!0},{src:"app:prostate",organ:"Prostate",name:"Prostate",hasSex:!1,sex:"male",id:"http://purl.obolibrary.org/obo/UBERON_0000079"},{src:"app:small-intestine",organ:"Small Intestine",name:"Small Intestine",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002108"},{src:"app:large-intestine",organ:"Large Intestine",name:"Large Intestine",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000059"},{src:"app:spinal-cord",organ:"Spinal Cord",name:"Spinal Cord",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002240"},{src:"app:spleen",organ:"Spleen",name:"Spleen",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002106"},{src:"app:thymus",organ:"Thymus",name:"Thymus",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002370"},{disabled:!0,src:"app:ureter-left",organ:"Ureter",name:"Ureter, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000056"},{src:"app:ureter-left",organ:"Ureter",name:"Ureter, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001223"},{src:"app:ureter-right",organ:"Ureter",name:"Ureter, R",side:"right",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001222"},{src:"app:bladder",organ:"Urinary Bladder",name:"Urinary Bladder",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001255"},{src:"app:uterus",organ:"Uterus",name:"Uterus",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0000995"},{src:"app:vasculature-thick",organ:"Blood Vasculature",name:"Blood Vasculature",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0004537"},{disabled:!0,src:"app:vasculature-thick",organ:"Blood Vasculature",name:"Blood Vasculature",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002049"}].sort((n,e)=>n.name.localeCompare(e.name));L9.filter(n=>!0!==n.disabled);let Hm=(()=>{let n=class extends VMe{constructor(){super(...arguments),this.optionCache=new Map}get config$(){return this.state$.pipe(qi(n=>null!=n),Va(1))}setConfig(t){this.setState(t)}patchConfig(t){this.patchState(t)}getProperty(t){return this.config$.pipe(j$(...t),ed(),Va(1))}getOption(...t){const i=this.getPathKey(t);if(this.optionCache.has(i))return this.optionCache.get(i);const r=this.config$.pipe(j$(...t),ed(),Va(1));return this.optionCache.set(i,r),r}getPathKey(t){return`${t.length}:${t.join(".")}`}};return n.\u0275fac=function(){let e;return function(i){return(e||(e=$i(n)))(i||n)}}(),n.\u0275prov=We({token:n,factory:n.\u0275fac}),Or([$W()],n.prototype,"config$",null),n=Or([LMe(),Zbe({name:"globalConfig",defaults:null})],n),n})();!function(){const n=localStorage.getItem("ALLOW_TELEMETRY");null===n||n.toLowerCase()}();class k9 extends class{getDatabaseStatus(){return this.forwardCall("getDatabaseStatus")}getProviderNames(){return this.forwardCall("getProviderNames")}getDatasetTechnologyNames(){return this.forwardCall("getDatasetTechnologyNames")}getOntologyTreeModel(){return this.forwardCall("getOntologyTreeModel")}getCellTypeTreeModel(){return this.forwardCall("getCellTypeTreeModel")}getReferenceOrgans(){return this.forwardCall("getReferenceOrgans")}getTissueBlockResults(e){return this.forwardCall("getTissueBlockResults",e)}getAggregateResults(e){return this.forwardCall("getAggregateResults",e)}getOntologyTermOccurences(e){return this.forwardCall("getOntologyTermOccurences",e)}getCellTypeTermOccurences(e){return this.forwardCall("getCellTypeTermOccurences",e)}getScene(e){return this.forwardCall("getScene",e)}getReferenceOrganScene(e,t){return this.forwardCall("getReferenceOrganScene",e,t)}}{forwardCall(e,...t){return this.impl$.pipe(Jr(i=>i[e](...t)))}}let B9=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const FF=new oe,qv={cacheBusterObserver:FF},Gm={cacheBusterObserver:FF,maxCacheCount:4};function V9(n,e,t){return n?{min:n[0]>e?n[0]:void 0,max:n[1]<t?n[1]:void 0}:void 0}function j9(n){return n.map(e=>{var t;return Object.assign(Object.assign({},e),{transformMatrix:new Gn(null!==(t=e.transformMatrix)&&void 0!==t?t:[])})})}let TPe=(()=>{class n{constructor(t,i){this.api=t,this.globalConfig=i,i.getOption("hubmapToken").subscribe(FF)}getDatabaseStatus(){return this.doRequest(t=>this.api.dbStatus(t))}getProviderNames(){return this.doRequest(t=>this.api.providerNames(t))}getDatasetTechnologyNames(){return this.doRequest(t=>this.api.technologyNames(t))}getOntologyTreeModel(){return this.doRequest(t=>this.api.ontologyTreeModel(t),void 0,{},n=>n)}getCellTypeTreeModel(){return this.doRequest(t=>this.api.cellTypeTreeModel(t),void 0,{},n=>n)}getReferenceOrgans(){return this.doRequest(t=>this.api.referenceOrgans(t),void 0,{},n=>n)}getTissueBlockResults(t){return this.doRequest(i=>this.api.tissueBlocks(i),t,{},n=>n)}getAggregateResults(t){return this.doRequest(i=>this.api.aggregateResults(i),t)}getOntologyTermOccurences(t){return this.doRequest(i=>this.api.ontologyTermOccurences(i),t)}getCellTypeTermOccurences(t){return this.doRequest(i=>this.api.cellTypeTermOccurences(i),t)}getScene(t){return this.doRequest(i=>this.api.scene(i),t,{},j9)}getReferenceOrganScene(t,i){return this.doRequest(r=>this.api.referenceOrganScene(r),i,{organIri:t},j9)}doRequest(t,i,r,s){const{api:o,globalConfig:a}=this,l=Object.assign(Object.assign({},function(n){var e,t;return{age:V9(null==n?void 0:n.ageRange,1,110),bmi:V9(null==n?void 0:n.bmiRange,13,83),sex:null===(t=null===(e=null==n?void 0:n.sex)||void 0===e?void 0:e.toLowerCase)||void 0===t?void 0:t.call(e),ontologyTerms:null==n?void 0:n.ontologyTerms,cellTypeTerms:null==n?void 0:n.cellTypeTerms,providers:null==n?void 0:n.tmc,technologies:null==n?void 0:n.technologies,spatial:null==n?void 0:n.spatialSearches}}(i)),r);return function(...n){let e,t;return Ce(n[n.length-1])&&(t=n.pop()),"function"==typeof n[n.length-1]&&(e=n.pop()),1===n.length&&F(n[0])&&(n=n[0]),Mn(n,t).lift(new G8(e))}([a.getOption("remoteApiEndpoint"),a.getOption("hubmapToken")]).pipe(zr(1),ur(([c,u])=>{o.configuration.basePath=c,u&&(l.token=u)}),Jr(()=>t(l)),me(c=>s?s(c):c))}}return n.\u0275fac=function(t){return new(t||n)(Ie(s9),Ie(Hm))},n.\u0275prov=We({token:n,factory:n.\u0275fac,providedIn:"root"}),Or([_c(qv)],n.prototype,"getProviderNames",null),Or([_c(qv)],n.prototype,"getDatasetTechnologyNames",null),Or([_c(qv)],n.prototype,"getOntologyTreeModel",null),Or([_c(qv)],n.prototype,"getCellTypeTreeModel",null),Or([_c(qv)],n.prototype,"getReferenceOrgans",null),Or([_c(Gm)],n.prototype,"getTissueBlockResults",null),Or([_c(Gm)],n.prototype,"getAggregateResults",null),Or([_c(Gm)],n.prototype,"getOntologyTermOccurences",null),Or([_c(Gm)],n.prototype,"getCellTypeTermOccurences",null),Or([_c(Gm)],n.prototype,"getScene",null),Or([_c(Gm)],n.prototype,"getReferenceOrganScene",null),n})(),APe=(()=>{class n extends k9{constructor(t){super(),this.impl$=this.database$=t.config$.pipe(i=>i,qi(i=>Object.keys(i).length>0),Jr(i=>function(n,e){return new O(t=>{let i,r;try{i=n()}catch(a){return void t.error(a)}try{r=e(i)}catch(a){return void t.error(a)}const o=(r?je(r):$c).subscribe(t);return()=>{o.unsubscribe(),i&&i.unsubscribe()}})}(()=>this.createDatabase(i),r=>this.connectDatabase(r,i))),me(i=>i.database),Va(1))}connectDatabase(t,i){return Pi(this,void 0,void 0,function*(){const r=!oa();return yield t.database.connect(i,r),t})}}return n.\u0275fac=function(t){return new(t||n)(Ie(Hm))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),MPe=(()=>{class n extends APe{createDatabase(t){return{database:new HNe(t),unsubscribe:()=>{}}}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=$i(n)))(i||n)}}(),n.\u0275prov=We({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),DPe=(()=>{class n extends k9{constructor(t,i){super(),this.impl$=t.config$.pipe(r=>r,me(r=>this.selectToken(r)),ed(),me(r=>i.get(r)),Va(1))}}return n.\u0275fac=function(t){return new(t||n)(Ie(Hm),Ie(zn))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),IPe=(()=>{class n{constructor(t){this.source=t,this.organs=L9}getOrganInfo(t,i,r="Female"){let s=this.organs.find(a=>a.id===t);if(!s)return tn(void 0);const o=s.organ;return s.disabled&&(s=this.organs.find(a=>!a.disabled&&a.organ===o)),(null==s?void 0:s.side)&&i&&s.side!==i&&(s=this.organs.find(a=>!a.disabled&&a.organ===o&&a.side===i)),tn(s)}getOrgan(t,i="Both"){return this.source.getReferenceOrgans().pipe(me(r=>r.find(s=>s.representation_of===t.id&&("Both"===i||s.sex===i))))}getOrganScene(t,i="Female"){return t.id?this.source.getReferenceOrganScene(t.id,{ontologyTerms:[t.id],sex:i}):tn([])}getOrganStats(t,i="Female"){return t.id?this.source.getAggregateResults({ontologyTerms:[t.id],sex:i}):tn([])}getBlocks(t,i="Female"){return t.id?this.source.getTissueBlockResults({ontologyTerms:[t.id],sex:i}):tn([])}}return n.\u0275fac=function(t){return new(t||n)(Ie(B9))},n.\u0275prov=We({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const OPe=["thumbContainer"],RPe=["toggleBar"],NPe=["input"],PPe=function(n){return{enterDuration:n}},FPe=["*"],LPe=new Gt("mat-slide-toggle-default-options",{providedIn:"root",factory:()=>({disableToggleValue:!1})});let kPe=0;const BPe={provide:Ua,useExisting:ge(()=>U9),multi:!0};class VPe{constructor(e,t){this.source=e,this.checked=t}}const jPe=gP(wv(pP(aC(class{constructor(n){this._elementRef=n}}))));let U9=(()=>{class n extends jPe{constructor(t,i,r,s,o,a){super(t),this._focusMonitor=i,this._changeDetectorRef=r,this.defaults=o,this._onChange=l=>{},this._onTouched=()=>{},this._uniqueId="mat-slide-toggle-"+ ++kPe,this._required=!1,this._checked=!1,this.name=null,this.id=this._uniqueId,this.labelPosition="after",this.ariaLabel=null,this.ariaLabelledby=null,this.change=new dn,this.toggleChange=new dn,this.tabIndex=parseInt(s)||0,this.color=this.defaultColor=o.color||"accent",this._noopAnimations="NoopAnimations"===a}get required(){return this._required}set required(t){this._required=Yi(t)}get checked(){return this._checked}set checked(t){this._checked=Yi(t),this._changeDetectorRef.markForCheck()}get inputId(){return`${this.id||this._uniqueId}-input`}ngAfterContentInit(){this._focusMonitor.monitor(this._elementRef,!0).subscribe(t=>{"keyboard"===t||"program"===t?this._inputElement.nativeElement.focus():t||Promise.resolve().then(()=>this._onTouched())})}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}_onChangeEvent(t){t.stopPropagation(),this.toggleChange.emit(),this.defaults.disableToggleValue?this._inputElement.nativeElement.checked=this.checked:(this.checked=this._inputElement.nativeElement.checked,this._emitChangeEvent())}_onInputClick(t){t.stopPropagation()}writeValue(t){this.checked=!!t}registerOnChange(t){this._onChange=t}registerOnTouched(t){this._onTouched=t}setDisabledState(t){this.disabled=t,this._changeDetectorRef.markForCheck()}focus(t,i){i?this._focusMonitor.focusVia(this._inputElement,i,t):this._inputElement.nativeElement.focus(t)}toggle(){this.checked=!this.checked,this._onChange(this.checked)}_emitChangeEvent(){this._onChange(this.checked),this.change.emit(new VPe(this,this.checked))}_onLabelTextChange(){this._changeDetectorRef.detectChanges()}}return n.\u0275fac=function(t){return new(t||n)(De(En),De(rd),De(ss),function(n){return function(n,e){if("class"===e)return n.classes;if("style"===e)return n.styles;const t=n.attrs;if(t){const i=t.length;let r=0;for(;r<i;){const s=t[r];if(ob(s))break;if(0===s)r+=2;else if("number"==typeof s)for(r++;r<i&&"string"==typeof t[r];)r++;else{if(s===e)return t[r+1];r+=2}}}return null}(is(),n)}("tabindex"),De(LPe),De(pc,8))},n.\u0275cmp=_n({type:n,selectors:[["mat-slide-toggle"]],viewQuery:function(t,i){if(1&t&&(Ir(OPe,5),Ir(RPe,5),Ir(NPe,5)),2&t){let r;gi(r=mi())&&(i._thumbEl=r.first),gi(r=mi())&&(i._thumbBarEl=r.first),gi(r=mi())&&(i._inputElement=r.first)}},hostAttrs:[1,"mat-slide-toggle"],hostVars:12,hostBindings:function(t,i){2&t&&(Nu("id",i.id),Wi("tabindex",i.disabled?null:-1)("aria-label",null)("aria-labelledby",null),Ti("mat-checked",i.checked)("mat-disabled",i.disabled)("mat-slide-toggle-label-before","before"==i.labelPosition)("_mat-animation-noopable",i._noopAnimations))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color",tabIndex:"tabIndex",name:"name",id:"id",labelPosition:"labelPosition",ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],required:"required",checked:"checked",ariaDescribedby:["aria-describedby","ariaDescribedby"]},outputs:{change:"change",toggleChange:"toggleChange"},exportAs:["matSlideToggle"],features:[Kn([BPe]),In],ngContentSelectors:FPe,decls:16,vars:20,consts:[[1,"mat-slide-toggle-label"],["label",""],[1,"mat-slide-toggle-bar"],["toggleBar",""],["type","checkbox","role","switch",1,"mat-slide-toggle-input","cdk-visually-hidden",3,"id","required","tabIndex","checked","disabled","change","click"],["input",""],[1,"mat-slide-toggle-thumb-container"],["thumbContainer",""],[1,"mat-slide-toggle-thumb"],["mat-ripple","",1,"mat-slide-toggle-ripple","mat-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleCentered","matRippleRadius","matRippleAnimation"],[1,"mat-ripple-element","mat-slide-toggle-persistent-ripple"],[1,"mat-slide-toggle-content",3,"cdkObserveContent"],["labelContent",""],[2,"display","none"]],template:function(t,i){if(1&t&&(function(n){const e=Vt()[16][6];if(!e.projection){const i=e.projection=Ac(n?n.length:1,null),r=i.slice();let s=e.child;for(;null!==s;){const o=n?Fq(s,n):0;null!==o&&(r[o]?r[o].projectionNext=s:i[o]=s,r[o]=s),s=s.next}}}(),Ft(0,"label",0,1),Ft(2,"div",2,3),Ft(4,"input",4,5),jn("change",function(s){return i._onChangeEvent(s)})("click",function(s){return i._onInputClick(s)}),Lt(),Ft(6,"div",6,7),Ci(8,"div",8),Ft(9,"div",9),Ci(10,"div",10),Lt(),Lt(),Lt(),Ft(11,"span",11,12),jn("cdkObserveContent",function(){return i._onLabelTextChange()}),Ft(13,"span",13),Ai(14,"\xa0"),Lt(),function(n,e=0,t){const i=Vt(),r=pi(),s=qd(r,20+n,16,null,t||null);null===s.projection&&(s.projection=e),hs(),64!=(64&s.flags)&&function(n,e,t){ty(e[11],0,e,t,Zb(n,t,e),nw(t.parent||e[6],t,e))}(r,i,s)}(15),Lt(),Lt()),2&t){const r=cg(1),s=cg(12);Wi("for",i.inputId),Qt(2),Ti("mat-slide-toggle-bar-no-side-margin",!s.textContent||!s.textContent.trim()),Qt(2),sn("id",i.inputId)("required",i.required)("tabIndex",i.tabIndex)("checked",i.checked)("disabled",i.disabled),Wi("name",i.name)("aria-checked",i.checked.toString())("aria-label",i.ariaLabel)("aria-labelledby",i.ariaLabelledby)("aria-describedby",i.ariaDescribedby),Qt(5),sn("matRippleTrigger",r)("matRippleDisabled",i.disableRipple||i.disabled)("matRippleCentered",!0)("matRippleRadius",20)("matRippleAnimation",function(n,e,t,i){return n3(Vt(),Es(),n,e,t,i)}(18,PPe,i._noopAnimations?0:150))}},directives:[wm,x6],styles:[".mat-slide-toggle{display:inline-block;height:24px;max-width:100%;line-height:24px;white-space:nowrap;outline:none;-webkit-tap-highlight-color:transparent}.mat-slide-toggle.mat-checked .mat-slide-toggle-thumb-container{transform:translate3d(16px, 0, 0)}[dir=rtl] .mat-slide-toggle.mat-checked .mat-slide-toggle-thumb-container{transform:translate3d(-16px, 0, 0)}.mat-slide-toggle.mat-disabled{opacity:.38}.mat-slide-toggle.mat-disabled .mat-slide-toggle-label,.mat-slide-toggle.mat-disabled .mat-slide-toggle-thumb-container{cursor:default}.mat-slide-toggle-label{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;display:flex;flex:1;flex-direction:row;align-items:center;height:inherit;cursor:pointer}.mat-slide-toggle-content{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.mat-slide-toggle-label-before .mat-slide-toggle-label{order:1}.mat-slide-toggle-label-before .mat-slide-toggle-bar{order:2}[dir=rtl] .mat-slide-toggle-label-before .mat-slide-toggle-bar,.mat-slide-toggle-bar{margin-right:8px;margin-left:0}[dir=rtl] .mat-slide-toggle-bar,.mat-slide-toggle-label-before .mat-slide-toggle-bar{margin-left:8px;margin-right:0}.mat-slide-toggle-bar-no-side-margin{margin-left:0;margin-right:0}.mat-slide-toggle-thumb-container{position:absolute;z-index:1;width:20px;height:20px;top:-3px;left:0;transform:translate3d(0, 0, 0);transition:all 80ms linear;transition-property:transform}._mat-animation-noopable .mat-slide-toggle-thumb-container{transition:none}[dir=rtl] .mat-slide-toggle-thumb-container{left:auto;right:0}.mat-slide-toggle-thumb{height:20px;width:20px;border-radius:50%}.mat-slide-toggle-bar{position:relative;width:36px;height:14px;flex-shrink:0;border-radius:8px}.mat-slide-toggle-input{bottom:0;left:10px}[dir=rtl] .mat-slide-toggle-input{left:auto;right:10px}.mat-slide-toggle-bar,.mat-slide-toggle-thumb{transition:all 80ms linear;transition-property:background-color;transition-delay:50ms}._mat-animation-noopable .mat-slide-toggle-bar,._mat-animation-noopable .mat-slide-toggle-thumb{transition:none}.mat-slide-toggle .mat-slide-toggle-ripple{position:absolute;top:calc(50% - 20px);left:calc(50% - 20px);height:40px;width:40px;z-index:1;pointer-events:none}.mat-slide-toggle .mat-slide-toggle-ripple .mat-ripple-element:not(.mat-slide-toggle-persistent-ripple){opacity:.12}.mat-slide-toggle-persistent-ripple{width:100%;height:100%;transform:none}.mat-slide-toggle-bar:hover .mat-slide-toggle-persistent-ripple{opacity:.04}.mat-slide-toggle:not(.mat-disabled).cdk-keyboard-focused .mat-slide-toggle-persistent-ripple{opacity:.12}.mat-slide-toggle-persistent-ripple,.mat-slide-toggle.mat-disabled .mat-slide-toggle-bar:hover .mat-slide-toggle-persistent-ripple{opacity:0}@media(hover: none){.mat-slide-toggle-bar:hover .mat-slide-toggle-persistent-ripple{display:none}}.cdk-high-contrast-active .mat-slide-toggle-thumb,.cdk-high-contrast-active .mat-slide-toggle-bar{border:1px solid}.cdk-high-contrast-active .mat-slide-toggle.cdk-keyboard-focused .mat-slide-toggle-bar{outline:2px dotted;outline-offset:5px}\n"],encapsulation:2,changeDetection:0}),n})(),z9=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=an({type:n}),n.\u0275inj=Ct({}),n})(),HPe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=an({type:n}),n.\u0275inj=Ct({imports:[[z9,cC,gr,FN],z9,gr]}),n})(),GPe=(()=>{class n{constructor(){this.clsName="ccf-slide-toggle",this.labels=["Left","Right"],this.value="Left",this.disabled=!1,this.valueChange=new dn}get left(){const{value:t,labels:i}=this;return t!==i[1]}updateToggle(t){this.value=t?this.labels[0]:this.labels[1],this.valueChange.emit(this.value)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=_n({type:n,selectors:[["ccf-slide-toggle"]],hostVars:2,hostBindings:function(t,i){2&t&&Vc(i.clsName)},inputs:{labels:"labels",value:"value",disabled:"disabled"},outputs:{valueChange:"valueChange"},decls:6,vars:12,consts:[[1,"slide-label",3,"click"],[1,"slider",3,"disabled","checked","change"],["toggle",""]],template:function(t,i){if(1&t){const r=$l();Ft(0,"span",0),jn("click",function(){Mr(r);const o=cg(3);return i.left||o.toggle(),i.updateToggle(!0)}),Ai(1),Lt(),Ft(2,"mat-slide-toggle",1,2),jn("change",function(o){return i.updateToggle(!o.checked)}),Lt(),Ft(4,"span",0),jn("click",function(){Mr(r);const o=cg(3);return i.left&&o.toggle(),i.updateToggle(!1)}),Ai(5),Lt()}2&t&&(Ti("disabled",i.disabled)("highlighted",i.left),Qt(1),Ds(i.labels[0].charAt(0).toUpperCase()+i.labels[0].slice(1)),Qt(1),sn("disabled",i.disabled)("checked",!i.left),Qt(2),Ti("disabled",i.disabled)("highlighted",!i.left),Qt(1),Ds(i.labels[1].charAt(0).toUpperCase()+i.labels[1].slice(1)))},directives:[U9],styles:["[_nghost-%COMP%]   .slide-label[_ngcontent-%COMP%]{margin:0 1rem;transition:color .6s;cursor:pointer;opacity:50%}[_nghost-%COMP%]   .slide-label.highlighted[_ngcontent-%COMP%]{opacity:100%}[_nghost-%COMP%]   .disabled[_ngcontent-%COMP%]{opacity:30%!important;cursor:not-allowed}[_nghost-%COMP%]     .slider .mat-slide-toggle-bar{background-color:#43476580}[_nghost-%COMP%]     .slider .mat-slide-toggle-thumb{background-color:#434765}"],changeDetection:0}),n})();const $Pe=["bodyUI"],WPe=function(){return["Male","Female"]},qPe=function(){return["Left","Right"]};let YPe=(()=>{class n{constructor(t){this.ga=t,this.sexChange=new dn,this.sideChange=new dn}ngAfterViewChecked(){this.updateHighlighting()}updateHighlighting(){var t,i,r,s;const o=new Set(null!==(i=null===(t=this.filter)||void 0===t?void 0:t.tmc)&&void 0!==i?i:[]);this.filteredBlocks=null!==(s=null===(r=this.blocks)||void 0===r?void 0:r.filter(a=>o.has(a.donor.providerName)).map(a=>a["@id"]))&&void 0!==s?s:[],this.bodyUI.scene=this.bodyUI.scene.map(a=>{var l;return Object.assign(Object.assign({},a),{color:a.entityId&&this.highlightedNodeId===a["@id"]?[30,136,229,255]:this.filteredBlocks.includes(null!==(l=a.entityId)&&void 0!==l?l:"")?[173,255,47,229.5]:[255,255,255,229.5]})})}ngOnChanges(t){this.bodyUI&&"organ"in t&&this.zoomToFitOrgan()}updateSex(t){this.sex=t,this.sexChange.emit(this.sex)}updateSide(t){this.side=t,this.sideChange.emit(this.side)}zoomToFitOrgan(){const{bodyUI:t,organ:i}=this;if(i){const{x_dimension:r,y_dimension:s,z_dimension:o}=i;t.rotation=t.rotationX=0,t.bounds={x:1.25*r/1e3,y:1.25*s/1e3,z:1.25*o/1e3},t.target=[r/1e3/2,s/1e3/2,o/1e3/2]}}nodeClicked(t){this.ga.event("node_click","organ",t.node["@id"]),this.highlightedNodeId=this.highlightedNodeId&&this.highlightedNodeId===t.node["@id"]?"":t.node["@id"]}}return n.\u0275fac=function(t){return new(t||n)(De(YC))},n.\u0275cmp=_n({type:n,selectors:[["ccf-organ"]],viewQuery:function(t,i){if(1&t&&Ir($Pe,7),2&t){let r;gi(r=mi())&&(i.bodyUI=r.first)}},inputs:{organ:"organ",scene:"scene",organIri:"organIri",sex:"sex",side:"side",blocks:"blocks",filter:"filter"},outputs:{sexChange:"sexChange",sideChange:"sideChange"},features:[zi],decls:5,vars:10,consts:[["camera","perspective",1,"body-ui",3,"scene","interactive","nodeClick","initialized"],["bodyUI",""],[1,"stage-options"],[1,"view-slider",3,"labels","value","hidden","valueChange"]],template:function(t,i){1&t&&(Ft(0,"ccf-body-ui",0,1),jn("nodeClick",function(s){return i.nodeClicked(s)})("initialized",function(){return i.zoomToFitOrgan()}),Lt(),Ft(2,"div",2),Ft(3,"ccf-slide-toggle",3),jn("valueChange",function(s){return i.updateSex(s)}),Lt(),Ft(4,"ccf-slide-toggle",3),jn("valueChange",function(s){return i.updateSide(s)}),Lt(),Lt()),2&t&&(sn("scene",i.scene)("interactive",!0),Qt(3),sn("labels",gE(8,WPe))("value",i.sex)("hidden",!i.sex),Qt(1),sn("labels",gE(9,qPe))("value",i.side)("hidden",!i.side))},directives:[qNe,GPe],styles:["[_nghost-%COMP%]{display:block;background-color:#000;border-radius:.5rem;color:#fff;height:100%}[_nghost-%COMP%]   .body-ui[_ngcontent-%COMP%]{height:90%}[_nghost-%COMP%]   .stage-options[_ngcontent-%COMP%]{padding:1rem;min-width:352px}"],changeDetection:0}),n})();function KPe(n,e){if(1&n&&(Ft(0,"div",3),Ft(1,"div",4),Ai(2),Lt(),Ft(3,"div",5),Ai(4),Lt(),Lt()),2&n){const t=e.$implicit;Qt(2),Ds(t.count),Qt(2),Ds(t.label)}}let XPe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=_n({type:n,selectors:[["ccf-stats-list"]],inputs:{statsLabel:"statsLabel",stats:"stats"},decls:4,vars:2,consts:[[1,"stats-container"],[1,"header"],["class","stats-row",4,"ngFor","ngForOf"],[1,"stats-row"],[1,"stat"],[1,"label"]],template:function(t,i){1&t&&(Ft(0,"div",0),Ft(1,"div",1),Ai(2),Lt(),Ei(3,KPe,5,2,"div",2),Lt()),2&t&&(Qt(2),Uc(" ",i.statsLabel," "),Qt(1),sn("ngForOf",i.stats))},directives:[th],styles:[".stats-container[_ngcontent-%COMP%]{margin-bottom:2rem;min-height:9rem}.stats-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{margin-bottom:1rem}.stats-container[_ngcontent-%COMP%]   .stats-row[_ngcontent-%COMP%]{display:flex;flex-direction:row;height:1.325rem}.stats-container[_ngcontent-%COMP%]   .stats-row[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]{width:2rem;margin-right:1rem;text-align:right}.stats-container[_ngcontent-%COMP%]   .stats-row[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{flex-grow:1;text-align:left}"],changeDetection:0}),n})();function QPe(n,e){if(1&n){const t=$l();Ft(0,"div",6),Ft(1,"div",7),Ft(2,"div",8),Ai(3),Lt(),Ft(4,"div",9),jn("click",function(){const s=Mr(t).$implicit;return Si().goToURL(s.buttonUrl)}),Ai(5),Lt(),Lt(),Lt()}if(2&n){const t=e.$implicit;Qt(3),Ds(t.body),Qt(1),sn("gaLabel",t.buttonUrl),Qt(1),Uc(" ",t.buttonTitle,"")}}function ZPe(n,e){if(1&n){const t=$l();Ft(0,"div",10),jn("click",function(){const s=Mr(t).$implicit;return Si().goToURL(s.buttonUrl)}),Ai(1),Lt()}if(2&n){const t=e.$implicit;sn("gaLabel",t.buttonUrl),Qt(1),Ds(t.buttonTitle)}}let JPe=(()=>{class n{constructor(){this.linkCards=[{body:"Add tissue blocks using the CCF Registration User Interface (RUI).",buttonTitle:"Register Tissue",buttonUrl:"https://hubmapconsortium.github.io/ccf-ui/rui/"},{body:"Explore tissue sections in tissue blocks with the CCF Exploration User Interface (EUI).",buttonTitle:"Explore Tissue",buttonUrl:"https://portal.hubmapconsortium.org/ccf-eui"},{body:"View linkages between anatomical structures, cell types, and common biomarkers (ASCT+B).",buttonTitle:"ASCT+B Reporter",buttonUrl:"https://hubmapconsortium.github.io/ccf-asct-reporter/"}],this.deepDives=[{body:"",buttonTitle:"CCF Portal",buttonUrl:"https://hubmapconsortium.github.io/ccf/"},{body:"",buttonTitle:"Online Course",buttonUrl:"https://expand.iu.edu/browse/sice/cns/courses/hubmap-visible-human-mooc"},{body:"",buttonTitle:"Paper",buttonUrl:"https://www.biorxiv.org/content/10.1101/2021.05.31.446440v2"}]}goToURL(t){window.open(t,"_blank")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=_n({type:n,selectors:[["ccf-link-cards"]],decls:7,vars:2,consts:[["gaCategory","link-cards",1,"link-cards-container"],["class","link-card",4,"ngFor","ngForOf"],["gaCategory","deep-dive",1,"deep-dive-section"],[1,"title"],[1,"button-container"],["class","btn-outline btn","gaEvent","visit-link",3,"gaLabel","click",4,"ngFor","ngForOf"],[1,"link-card"],[1,"link-card-content"],[1,"body"],["gaEvent","visit-link",1,"link-button","btn",3,"gaLabel","click"],["gaEvent","visit-link",1,"btn-outline","btn",3,"gaLabel","click"]],template:function(t,i){1&t&&(Ft(0,"div",0),Ei(1,QPe,6,3,"div",1),Lt(),Ft(2,"div",2),Ft(3,"div",3),Ai(4,"Common Coordinate Framework (CCF) Deep Dive"),Lt(),Ft(5,"div",4),Ei(6,ZPe,2,2,"div",5),Lt(),Lt()),2&t&&(Qt(1),sn("ngForOf",i.linkCards),Qt(5),sn("ngForOf",i.deepDives))},directives:[J7,th,e9],styles:[".link-cards-container[_ngcontent-%COMP%]{max-width:30rem}.link-cards-container[_ngcontent-%COMP%]   .link-card[_ngcontent-%COMP%]{border-top:1px solid #e0e0e0;padding-top:1px;padding-bottom:1px}.link-cards-container[_ngcontent-%COMP%]   .link-card[_ngcontent-%COMP%]:last-of-type{border-bottom:1px solid #e0e0e0}.link-cards-container[_ngcontent-%COMP%]   .link-card[_ngcontent-%COMP%]   .link-card-content[_ngcontent-%COMP%]{align-items:center;padding:1rem 0 1rem 1rem;display:flex;flex-direction:row;justify-content:space-between;border-left:6px solid #444A65}.link-cards-container[_ngcontent-%COMP%]   .link-card[_ngcontent-%COMP%]   .link-card-content[_ngcontent-%COMP%]   .link-button[_ngcontent-%COMP%]{margin-left:2rem;background-color:#444a65;color:#fff}.link-cards-container[_ngcontent-%COMP%]   .link-card[_ngcontent-%COMP%]   .link-card-content[_ngcontent-%COMP%]   .link-button[_ngcontent-%COMP%]:hover{background-color:#2f3346}.deep-dive-section[_ngcontent-%COMP%]{margin-top:2rem}.deep-dive-section[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{margin-bottom:1rem;font-size:1rem}.deep-dive-section[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]{display:flex;flex-direction:row}.deep-dive-section[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]   .btn-outline[_ngcontent-%COMP%]{color:#444a65;border:1px solid #444A65;background-color:#fff}.deep-dive-section[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]   .btn-outline[_ngcontent-%COMP%]:not(:last-of-type){margin-right:1rem}.deep-dive-section[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]   .btn-outline[_ngcontent-%COMP%]:hover{background-color:#e0e0e0}.btn[_ngcontent-%COMP%]{min-width:9rem!important;max-height:2.28125rem;text-align:center;white-space:nowrap;cursor:pointer;font-size:.875rem;font-weight:500;border-radius:2px;line-height:2.75;transition:background-color .25s cubic-bezier(.4,0,.2,1) 0ms,box-shadow .25s cubic-bezier(.4,0,.2,1) 0ms,border .25s cubic-bezier(.4,0,.2,1) 0ms;font-family:Inter Variable,Helvetica,Arial,sans-serif}"],changeDetection:0}),n})();const eFe=["left"],tFe=["right"],nFe=function(){return[]},iFe=[{color:[0,0,0,0],opacity:.001}];let rFe=(()=>{class n{constructor(t,i,r){this.ga=i,this.configState=r,this.sex$=this.configState.getOption("sex"),this.side$=this.configState.getOption("side"),this.filter$=this.configState.getOption("highlightProviders").pipe(me(s=>({tmc:s}))),this.latestConfig={},this.organInfo$=r.config$.pipe(ur(s=>this.latestConfig=s),Jr(s=>{var o,a,l;return t.getOrganInfo(null!==(o=s.organIri)&&void 0!==o?o:"",null===(l=null===(a=s.side)||void 0===a?void 0:a.toLowerCase)||void 0===l?void 0:l.call(a),s.sex)}),ur(s=>this.logOrganLookup(s)),ur(s=>this.latestOrganInfo=s),Va(1)),this.organ$=this.organInfo$.pipe(Jr(s=>s?t.getOrgan(s,s.hasSex?this.latestConfig.sex:void 0):tn(void 0)),ur(s=>{var o;if(s&&this.latestOrganInfo){const a=(null===(o=this.latestOrganInfo)||void 0===o?void 0:o.hasSex)?s.sex:void 0;a!==this.latestConfig.sex&&this.updateInput("sex",a),s.side!==this.latestConfig.side&&this.updateInput("side",s.side)}}),Va(1)),this.scene$=this.organ$.pipe(Jr(s=>s&&this.latestOrganInfo?t.getOrganScene(this.latestOrganInfo,s.sex):tn(iFe))),this.stats$=this.organ$.pipe(Jr(s=>s&&this.latestOrganInfo?t.getOrganStats(this.latestOrganInfo,s.sex):tn([]))),this.statsLabel$=this.organ$.pipe(me(s=>this.makeStatsLabel(this.latestOrganInfo,null==s?void 0:s.sex)),function(...n){const e=n[n.length-1];return Ce(e)?(n.pop(),t=>fC(n,t,e)):t=>fC(n,t)}("Loading...")),this.blocks$=this.organ$.pipe(Jr(s=>s&&this.latestOrganInfo?t.getBlocks(this.latestOrganInfo,s.sex):tn([])))}ngAfterViewInit(){const{left:t,right:i}=this;t.nativeElement.style.height=`${i.nativeElement.offsetHeight}px`}updateInput(t,i){this.configState.patchConfig({[t]:i})}makeStatsLabel(t,i){let r=[`Unknown IRI: ${this.latestConfig.organIri}`];if(t){const s=t.side?t.side.charAt(0).toUpperCase()+t.side.slice(1):void 0;r=[i,t.organ,s]}return r.filter(s=>!!s).join(", ")}logOrganLookup(t){this.ga.event(t?"organ_lookup_success":"organ_lookup_failure","organ",`Iri: ${this.latestConfig.organIri} - Sex: ${this.latestConfig.sex} - Side: ${this.latestConfig.side}`)}}return n.\u0275fac=function(t){return new(t||n)(De(IPe),De(YC),De(Hm))},n.\u0275cmp=_n({type:n,selectors:[["ccf-root"]],viewQuery:function(t,i){if(1&t&&(Ir(eFe,7,En),Ir(tFe,7,En)),2&t){let r;gi(r=mi())&&(i.left=r.first),gi(r=mi())&&(i.right=r.first)}},decls:16,vars:25,consts:[[1,"container"],[1,"left"],["left",""],[3,"blocks","filter","sex","side","organ","scene","sexChange","sideChange"],[1,"right"],["right",""],[3,"statsLabel","stats"]],template:function(t,i){if(1&t&&(Ft(0,"div",0),Ft(1,"div",1,2),Ft(3,"ccf-organ",3),jn("sexChange",function(s){return i.updateInput("sex",s)})("sideChange",function(s){return i.updateInput("side",s)}),_l(4,"async"),_l(5,"async"),_l(6,"async"),_l(7,"async"),_l(8,"async"),_l(9,"async"),Lt(),Lt(),Ft(10,"div",4,5),Ci(12,"ccf-stats-list",6),_l(13,"async"),_l(14,"async"),Ci(15,"ccf-link-cards"),Lt(),Lt()),2&t){let r;Qt(3),sn("blocks",yl(4,8,i.blocks$))("filter",yl(5,10,i.filter$))("sex",yl(6,12,i.sex$))("side",yl(7,14,i.side$))("organ",yl(8,16,i.organ$))("scene",null!==(r=yl(9,18,i.scene$))&&void 0!==r?r:gE(24,nFe)),Qt(9),sn("statsLabel",yl(13,20,i.statsLabel$))("stats",yl(14,22,i.stats$))}},directives:[YPe,XPe,JPe],pipes:[HE],styles:[".container[_ngcontent-%COMP%]{height:-webkit-fit-content;height:-moz-fit-content;height:fit-content;display:flex;flex-direction:row;padding:1rem;font-family:Inter;font-size:.95rem;line-height:1.5;text-align:left;position:relative;background-color:#fff;color:#000}.container[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%]{width:auto;flex-grow:1}.container[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{margin-left:2rem;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content;width:29rem}"],changeDetection:0}),n})();function sFe(n,e){1&n&&Ci(0,"ccf-root")}function oFe(n){const e=i=>"string"==typeof i,t=i=>Array.isArray(i)&&i.every(e);if("string"==typeof n){const i=jD.json(n);if(t(i))return i}else if(t(n))return n;throw new Error("Invalid data sources")}function aFe(n){const e=i=>"string"==typeof i,t=i=>Array.isArray(i)&&i.every(e);if("string"==typeof n){if(!(null==n?void 0:n.startsWith("[")))return[n];{const i=jD.json(n);if(t(i))return i}}else if(t(n))return n;throw new Error("Invalid data sources")}let lFe=(()=>{class n extends Ine{constructor(t,i){super(t,i,{initialDelay:10,initialConfig:Object.assign(Object.assign({},xf.dbOptions),globalThis.dbOptions),parse:{dataSources:oFe,highlightProviders:aFe,useRemoteApi:jD.boolean}}),this.sex="Female",this.side="Left"}}return n.\u0275fac=function(t){return new(t||n)(De(Hm),De(ss))},n.\u0275cmp=_n({type:n,selectors:[["ccf-root-wc"]],inputs:{organIri:"organIri",sex:"sex",side:"side",dataSources:"dataSources",highlightProviders:"highlightProviders",hubmapDataService:"hubmapDataService",hubmapDataUrl:"hubmapDataUrl",hubmapAssetUrl:"hubmapAssetUrl",hubmapToken:"hubmapToken",hubmapPortalUrl:"hubmapPortalUrl",useRemoteApi:"useRemoteApi",remoteApiEndpoint:"remoteApiEndpoint"},features:[In],decls:1,vars:1,consts:[[4,"ngIf"]],template:function(t,i){1&t&&Ei(0,sFe,1,0,"ccf-root",0),2&t&&sn("ngIf",i.initialized)},directives:[ju,rFe],encapsulation:2,changeDetection:0}),n})(),cFe=(()=>{class n extends DPe{selectToken(t){return t.useRemoteApi&&t.remoteApiEndpoint?TPe:MPe}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=$i(n)))(i||n)}}(),n.\u0275prov=We({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),uFe=(()=>{class n{constructor(t,i){this.accessor=t,this.injector=i}static forRoot(t=[]){return{ngModule:n,providers:[us,qa,VW,...t]}}}return n.\u0275fac=function(t){return new(t||n)(Ie(us,2),Ie(qa,2))},n.\u0275mod=an({type:n}),n.\u0275inj=Ct({}),n})();const hT=(n,e)=>((n,e)=>new Array(e+1).join("0"))(0,e-n.toString().length)+n;class fFe{constructor(e,t,i){this.action=e,this.store=t,this.logWriter=i}dispatched(e){const t=Uf(this.action),i=function(n){return hT(n.getHours(),2)+":"+hT(n.getMinutes(),2)+":"+hT(n.getSeconds(),2)+"."+hT(n.getMilliseconds(),3)}(new Date);this.logWriter.startGroup(`action ${t} @ ${i}`),this._hasPayload(this.action)&&this.logWriter.logGrey("payload",Object.assign({},this.action)),this.logWriter.logGrey("prev state",e)}completed(e){this.logWriter.logGreen("next state",e),this.logWriter.endGroup()}errored(e){this.logWriter.logRedish("next state after error",this.store.snapshot()),this.logWriter.logRedish("error",e),this.logWriter.endGroup()}_hasPayload(e){return this._getNonEmptyProperties(e).length>0}_getNonEmptyProperties(e){return Object.keys(e).map(r=>e[r]).filter(r=>void 0!==r)}}class pFe{constructor(e){this.options=e,this.options=this.options||{},this.logger=e.logger||console}startGroup(e){const t=this.options.collapsed?this.logger.groupCollapsed:this.logger.group;try{t.call(this.logger,e)}catch(i){console.log(e)}}endGroup(){try{this.logger.groupEnd()}catch(e){this.logger.log("\u2014\u2014 log end \u2014\u2014")}}logGrey(e,t){this.log(e,"color: #9E9E9E; font-weight: bold",t)}logGreen(e,t){this.log(e,"color: #4CAF50; font-weight: bold",t)}logRedish(e,t){this.log(e,"color: #FD8182; font-weight: bold",t)}log(e,t,i){this.isIE()?this.logger.log(e,i):this.logger.log("%c "+e,t,i)}isIE(){const e="undefined"!=typeof window&&window.navigator.userAgent?window.navigator.userAgent:"";let t=!1;const i=e.indexOf("MSIE "),r=e.indexOf("Trident/");return(i>-1||r>-1)&&(t=!0),t}}const H9=new Gt("NGXS_LOGGER_PLUGIN_OPTIONS");let gFe=(()=>{class n{constructor(t,i){this._options=t,this._injector=i}handle(t,i,r){if(this._options.disabled||!this._options.filter(i,t))return r(t,i);this._logWriter=this._logWriter||new pFe(this._options),this._store=this._store||this._injector.get(gh);const s=new fFe(i,this._store,this._logWriter);return s.dispatched(t),r(t,i).pipe(ur(o=>{s.completed(o)}),hc(o=>{throw s.errored(o),o}))}}return n.\u0275fac=function(t){return new(t||n)(Ie(H9),Ie(zn))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const G9=new Gt("LOGGER_USER_OPTIONS");function mFe(n){return Object.assign({},{logger:console,collapsed:!1,disabled:!1,filter:()=>!0},n)}let _Fe=(()=>{class n{static forRoot(t){return{ngModule:n,providers:[{provide:J8,useClass:gFe,multi:!0},{provide:G9,useValue:t},{provide:H9,useFactory:mFe,deps:[G9]}]}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=an({type:n}),n.\u0275inj=Ct({}),n})();const yFe=[Hm];let vFe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=an({type:n}),n.\u0275inj=Ct({imports:[[uFe.forRoot(),pa.forRoot(yFe,{developmentMode:!xf.production}),_Fe.forRoot({disabled:xf.production})]]}),n})(),bFe=(()=>{class n{constructor(t){if(t)throw new Error("The core module should only be imported once in the root module")}}return n.\u0275fac=function(t){return new(t||n)(Ie(n,12))},n.\u0275mod=an({type:n}),n.\u0275inj=Ct({providers:[{provide:B9,useExisting:cFe}],imports:[[oW,_Oe.forRoot({gaToken:xf.googleAnalyticsToken,appName:"organ-info",projectName:"ccf",developmentMode:!xf.production}),COe.forRoot(()=>new Vv({basePath:xf.dbOptions.remoteApiEndpoint})),vFe]]}),n})(),wFe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=an({type:n}),n.\u0275inj=Ct({imports:[[Zr,HPe]]}),n})(),EFe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=an({type:n}),n.\u0275inj=Ct({imports:[[Zr,YNe,wFe]]}),n})(),SFe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=an({type:n}),n.\u0275inj=Ct({imports:[[Zr,KC]]}),n})(),xFe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=an({type:n}),n.\u0275inj=Ct({imports:[[Zr]]}),n})(),CFe=(()=>{class n{constructor(t){this.injector=t}ngDoBootstrap(){const t=function(n,e){const t=function(n,e){return e.get(pl).resolveComponentFactory(n).inputs}(n,e.injector),i=e.strategyFactory||new xne(n,e.injector),r=function(n){const e={};return n.forEach(({propName:t,templateName:i})=>{e[function(n){return n.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}(i)]=t}),e}(t);class s extends Tne{constructor(a){super(),this.injector=a}get ngElementStrategy(){if(!this._ngElementStrategy){const a=this._ngElementStrategy=i.create(this.injector||e.injector);t.forEach(({propName:l})=>{if(!this.hasOwnProperty(l))return;const c=this[l];delete this[l],a.setInputValue(l,c)})}return this._ngElementStrategy}attributeChangedCallback(a,l,c,u){this.ngElementStrategy.setInputValue(r[a],c)}connectedCallback(){let a=!1;this.ngElementStrategy.events&&(this.subscribeToEvents(),a=!0),this.ngElementStrategy.connect(this),a||this.subscribeToEvents()}disconnectedCallback(){this._ngElementStrategy&&this._ngElementStrategy.disconnect(),this.ngElementEventsSubscription&&(this.ngElementEventsSubscription.unsubscribe(),this.ngElementEventsSubscription=null)}subscribeToEvents(){this.ngElementEventsSubscription=this.ngElementStrategy.events.subscribe(a=>{const l=function(n,e,t){if("function"!=typeof CustomEvent){const s=n.createEvent("CustomEvent");return s.initCustomEvent(e,!1,!1,t),s}return new CustomEvent(e,{bubbles:!1,cancelable:!1,detail:t})}(this.ownerDocument,a.name,a.value);this.dispatchEvent(l)})}}return s.observedAttributes=Object.keys(r),t.forEach(({propName:o})=>{Object.defineProperty(s.prototype,o,{get(){return this.ngElementStrategy.getInputValue(o)},set(a){this.ngElementStrategy.setInputValue(o,a)},configurable:!0,enumerable:!0})}),s}(lFe,{injector:this.injector});customElements.define("ccf-organ-info",t)}}return n.\u0275fac=function(t){return new(t||n)(Ie(zn))},n.\u0275mod=an({type:n}),n.\u0275inj=Ct({providers:[],imports:[[kD,bFe,SFe,xFe,EFe]]}),n})();xf.production&&function(){if(B3)throw new Error("Cannot enable prod mode after platform setup.");k3=!1}(),qte().bootstrapModule(CFe).catch(n=>console.error(n))},1052:Ut=>{function it(yt,ee,At,dt,Y,xe,he){try{var W=yt[xe](he),j=W.value}catch(F){return void At(F)}W.done?ee(j):Promise.resolve(j).then(dt,Y)}Ut.exports=function(yt){return function(){var ee=this,At=arguments;return new Promise(function(dt,Y){var xe=yt.apply(ee,At);function he(j){it(xe,dt,Y,he,W,"next",j)}function W(j){it(xe,dt,Y,he,W,"throw",j)}he(void 0)})}},Ut.exports.default=Ut.exports,Ut.exports.__esModule=!0},1948:Ut=>{Ut.exports=function(et){return et&&et.__esModule?et:{default:et}},Ut.exports.default=Ut.exports,Ut.exports.__esModule=!0},4321:Ut=>{function it(et){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?(Ut.exports=it=function(ee){return typeof ee},Ut.exports.default=Ut.exports,Ut.exports.__esModule=!0):(Ut.exports=it=function(ee){return ee&&"function"==typeof Symbol&&ee.constructor===Symbol&&ee!==Symbol.prototype?"symbol":typeof ee},Ut.exports.default=Ut.exports,Ut.exports.__esModule=!0),it(et)}Ut.exports=it,Ut.exports.default=Ut.exports,Ut.exports.__esModule=!0},9082:Ut=>{function it(et){return Promise.resolve().then(()=>{var yt=new Error("Cannot find module '"+et+"'");throw yt.code="MODULE_NOT_FOUND",yt})}it.keys=()=>[],it.resolve=it,it.id=9082,Ut.exports=it},9521:()=>{},9125:()=>{},5307:()=>{}},Ut=>{Ut(Ut.s=4668)}]);