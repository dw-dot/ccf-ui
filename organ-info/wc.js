(()=>{"use strict";var e,d={},v={};function a(e){var n=v[e];if(void 0!==n)return n.exports;var r=v[e]={id:e,loaded:!1,exports:{}};return d[e].call(r.exports,r,r.exports,a),r.loaded=!0,r.exports}a.m=d,e=[],a.O=(n,r,u,l)=>{if(!r){var c=1/0;for(t=0;t<e.length;t++){for(var[r,u,l]=e[t],i=!0,f=0;f<r.length;f++)(!1&l||c>=l)&&Object.keys(a.O).every(b=>a.O[b](r[f]))?r.splice(f--,1):(i=!1,l<c&&(c=l));if(i){e.splice(t--,1);var o=u();void 0!==o&&(n=o)}}return n}l=l||0;for(var t=e.length;t>0&&e[t-1][2]>l;t--)e[t]=e[t-1];e[t]=[r,u,l]},a.n=e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return a.d(n,{a:n}),n},a.d=(e,n)=>{for(var r in n)a.o(n,r)&&!a.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})},a.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e={666:0};a.O.j=u=>0===e[u];var n=(u,l)=>{var f,o,[t,c,i]=l,s=0;for(f in c)a.o(c,f)&&(a.m[f]=c[f]);if(i)var _=i(a);for(u&&u(l);s<t.length;s++)a.o(e,o=t[s])&&e[o]&&e[o][0](),e[t[s]]=0;return a.O(_)},r=self.webpackChunkccf_ui=self.webpackChunkccf_ui||[];r.forEach(n.bind(null,0)),r.push=n.bind(null,r.push.bind(r))})()})();
(self.webpackChunkccf_ui=self.webpackChunkccf_ui||[]).push([[429],{138:()=>{!function(){"use strict";!function(){if(void 0===window.Reflect||void 0===window.customElements||window.customElements.polyfillWrapFlushCallback)return;const G=HTMLElement;window.HTMLElement=function(){return Reflect.construct(G,[],this.constructor)},HTMLElement.prototype=G.prototype,HTMLElement.prototype.constructor=HTMLElement,Object.setPrototypeOf(HTMLElement,G)}()}()},142:()=>{!function(G,ne){"use strict";function he(){var e=Ge.splice(0,Ge.length);for(V=0;e.length;)e.shift().call(null,e.shift())}function ye(e,r){for(var i=0,h=e.length;i<h;i++)je(e[i],r)}function Ve(e){return function(r){L(r)&&(je(r,e),le.length&&ye(r.querySelectorAll(le),e))}}function Ie(e){var r=R.call(e,"is"),i=e.nodeName.toUpperCase(),h=Te.call(Ne,r?st+r.toUpperCase():Xe+i);return r&&-1<h&&!Ze(i,r)?-1:h}function Ze(e,r){return-1<le.indexOf(e+'[is="'+r+'"]')}function Ue(e){var r=e.currentTarget,i=e.attrChange,h=e.attrName,s=e.target,o=e[ot]||2,l=e[pt]||3;!n||s&&s!==r||!r[Ee]||"style"===h||e.prevValue===e.newValue&&(""!==e.newValue||i!==o&&i!==l)||r[Ee](h,i===o?null:e.prevValue,i===l?null:e.newValue)}function et(e){var r=Ve(e);return function(i){Ge.push(r,i.target),V&&clearTimeout(V),V=setTimeout(he,1)}}function de(e){k&&(k=!1,e.currentTarget.removeEventListener(bt,de)),le.length&&ye((e.target||A).querySelectorAll(le),e.detail===pe?pe:Le),z&&function(){for(var e,r=0,i=T.length;r<i;r++)De.contains(e=T[r])||(i--,T.splice(r--,1),je(e,pe))}()}function ve(e,r){var i=this;$.call(i,e,r),xe.call(i,{target:i})}function Ae(e,r,i){var h=r.apply(e,i),s=Ie(h);return-1<s&&ae(h,Ye[s]),i.pop()&&le.length&&function(e){for(var r,i=0,h=e.length;i<h;i++)ae(r=e[i],Ye[Ie(r)])}(h.querySelectorAll(le)),h}function Be(e,r){b(e,r),We?We.observe(e,oe):(I&&(e.setAttribute=ve,e[me]=nt(e),e[be](Et,xe)),e[be](He,Ue)),e[qe]&&n&&(e.created=!0,e[qe](),e.created=!1)}function U(e){throw new Error("A "+e+" type is already registered")}function je(e,r){var i,h,s=Ie(e);-1<s&&!B.call(e,"TEMPLATE")&&(we(e,Ye[s]),s=0,r!==Le||e[Le]?r!==pe||e[pe]||(e[Le]=!1,e[pe]=!0,h="disconnected",s=1):(e[pe]=!1,e[Le]=!0,h="connected",s=1,z&&Te.call(T,e)<0&&T.push(e)),s&&(i=e[r+ce]||e[h+ce])&&i.call(e))}function ke(){}function J(e,r,i){var h=i&&i[te]||"",s=r.prototype,o=w(s),l=r.observedAttributes||Oe,d={prototype:o};x(o,qe,{value:function(){if(f)f=!1;else if(!this[Je]){this[Je]=!0,new r(this),s[qe]&&s[qe].call(this);var p=m[v.get(r)];(!t||p.create.length>1)&&tt(this)}}}),x(o,Ee,{value:function(p){-1<Te.call(l,p)&&s[Ee]&&s[Ee].apply(this,arguments)}}),s[rt]&&x(o,vt,{value:s[rt]}),s[mt]&&x(o,kt,{value:s[mt]}),h&&(d[te]=h),e=e.toUpperCase(),m[e]={constructor:r,create:h?[h,C(e)]:[e]},v.set(r,e),A[se](e.toLowerCase(),d),ut(e),E[e].r()}function gt(e){var r=m[e.toUpperCase()];return r&&r.constructor}function yt(e){return"string"==typeof e?e:e&&e.is||""}function tt(e){for(var r,i=e[Ee],h=i?e.attributes:Oe,s=h.length;s--;)i.call(e,(r=h[s]).name||r.nodeName,null,r.value||r.nodeValue)}function ut(e){return(e=e.toUpperCase())in E||(E[e]={},E[e].p=new c(function(r){E[e].r=r})),E[e].p}function ft(){Me&&delete G.customElements,Re(G,"customElements",{configurable:!0,value:new ke}),Re(G,"CustomElementRegistry",{configurable:!0,value:ke});for(var e=ht.get(/^HTML[A-Z]*[a-z]/),r=e.length;r--;function(i){var h=G[i];if(h){G[i]=function(s){var o,l;return s||(s=this),s[Je]||(f=!0,o=m[v.get(s.constructor)],(s=(l=t&&1===o.create.length)?Reflect.construct(h,Oe,o.constructor):A.createElement.apply(A,o.create))[Je]=!0,f=!1,l||tt(s)),s},G[i].prototype=h.prototype;try{h.prototype.constructor=G[i]}catch(s){Re(h,Je,{value:G[i]})}}}(e[r]));A.createElement=function(i,h){var s=yt(h);return s?H.call(this,i,C(s)):H.call(this,i)},ue||(X=!0,A[se](""))}var A=G.document,re=G.Object,ht=function(e){var r,i,h,s,o=/^[A-Z]+[a-z]/,d=function(_,g){(g=g.toLowerCase())in p||(p[_]=(p[_]||[]).concat(g),p[g]=p[g.toUpperCase()]=_)},p=(re.create||re)(null),y={};for(i in e)for(s in e[i])for(p[s]=h=e[i][s],r=0;r<h.length;r++)p[h[r].toLowerCase()]=p[h[r].toUpperCase()]=s;return y.get=function(_){return"string"==typeof _?p[_]||(o.test(_)?[]:""):function(_){var g,M=[];for(g in p)_.test(g)&&M.push(g);return M}(_)},y.set=function(_,g){return o.test(_)?d(_,g):d(g,_),y},y}({collections:{HTMLAllCollection:["all"],HTMLCollection:["forms"],HTMLFormControlsCollection:["elements"],HTMLOptionsCollection:["options"]},elements:{Element:["element"],HTMLAnchorElement:["a"],HTMLAppletElement:["applet"],HTMLAreaElement:["area"],HTMLAttachmentElement:["attachment"],HTMLAudioElement:["audio"],HTMLBRElement:["br"],HTMLBaseElement:["base"],HTMLBodyElement:["body"],HTMLButtonElement:["button"],HTMLCanvasElement:["canvas"],HTMLContentElement:["content"],HTMLDListElement:["dl"],HTMLDataElement:["data"],HTMLDataListElement:["datalist"],HTMLDetailsElement:["details"],HTMLDialogElement:["dialog"],HTMLDirectoryElement:["dir"],HTMLDivElement:["div"],HTMLDocument:["document"],HTMLElement:["element","abbr","address","article","aside","b","bdi","bdo","cite","code","command","dd","dfn","dt","em","figcaption","figure","footer","header","i","kbd","mark","nav","noscript","rp","rt","ruby","s","samp","section","small","strong","sub","summary","sup","u","var","wbr"],HTMLEmbedElement:["embed"],HTMLFieldSetElement:["fieldset"],HTMLFontElement:["font"],HTMLFormElement:["form"],HTMLFrameElement:["frame"],HTMLFrameSetElement:["frameset"],HTMLHRElement:["hr"],HTMLHeadElement:["head"],HTMLHeadingElement:["h1","h2","h3","h4","h5","h6"],HTMLHtmlElement:["html"],HTMLIFrameElement:["iframe"],HTMLImageElement:["img"],HTMLInputElement:["input"],HTMLKeygenElement:["keygen"],HTMLLIElement:["li"],HTMLLabelElement:["label"],HTMLLegendElement:["legend"],HTMLLinkElement:["link"],HTMLMapElement:["map"],HTMLMarqueeElement:["marquee"],HTMLMediaElement:["media"],HTMLMenuElement:["menu"],HTMLMenuItemElement:["menuitem"],HTMLMetaElement:["meta"],HTMLMeterElement:["meter"],HTMLModElement:["del","ins"],HTMLOListElement:["ol"],HTMLObjectElement:["object"],HTMLOptGroupElement:["optgroup"],HTMLOptionElement:["option"],HTMLOutputElement:["output"],HTMLParagraphElement:["p"],HTMLParamElement:["param"],HTMLPictureElement:["picture"],HTMLPreElement:["pre"],HTMLProgressElement:["progress"],HTMLQuoteElement:["blockquote","q","quote"],HTMLScriptElement:["script"],HTMLSelectElement:["select"],HTMLShadowElement:["shadow"],HTMLSlotElement:["slot"],HTMLSourceElement:["source"],HTMLSpanElement:["span"],HTMLStyleElement:["style"],HTMLTableCaptionElement:["caption"],HTMLTableCellElement:["td","th"],HTMLTableColElement:["col","colgroup"],HTMLTableElement:["table"],HTMLTableRowElement:["tr"],HTMLTableSectionElement:["thead","tbody","tfoot"],HTMLTemplateElement:["template"],HTMLTextAreaElement:["textarea"],HTMLTimeElement:["time"],HTMLTitleElement:["title"],HTMLTrackElement:["track"],HTMLUListElement:["ul"],HTMLUnknownElement:["unknown","vhgroupv","vkeygen"],HTMLVideoElement:["video"]},nodes:{Attr:["node"],Audio:["audio"],CDATASection:["node"],CharacterData:["node"],Comment:["#comment"],Document:["#document"],DocumentFragment:["#document-fragment"],DocumentType:["node"],HTMLDocument:["#document"],Image:["img"],Option:["option"],ProcessingInstruction:["node"],ShadowRoot:["#shadow-root"],Text:["#text"],XMLDocument:["xml"]}});"object"!=typeof ne&&(ne={type:ne||"auto"});var Ge,xe,ze,nt,We,ie,we,ae,Ce,e,r,i,h,s,se="registerElement",dt=1e5*G.Math.random()>>0,me="__"+se+dt,be="addEventListener",Le="attached",ce="Callback",pe="detached",te="extends",Ee="attributeChanged"+ce,vt=Le+ce,rt="connected"+ce,mt="disconnected"+ce,qe="created"+ce,kt=pe+ce,ot="ADDITION",pt="REMOVAL",He="DOMAttrModified",bt="DOMContentLoaded",Et="DOMSubtreeModified",Xe="<",st="=",Mt=/^[A-Z][._A-Z0-9]*-[-._A-Z0-9]*$/,wt=["ANNOTATION-XML","COLOR-PROFILE","FONT-FACE","FONT-FACE-SRC","FONT-FACE-URI","FONT-FACE-FORMAT","FONT-FACE-NAME","MISSING-GLYPH"],Ne=[],Ye=[],le="",De=A.documentElement,Te=Ne.indexOf||function(e){for(var r=this.length;r--&&this[r]!==e;);return r},it=re.prototype,Pe=it.hasOwnProperty,at=it.isPrototypeOf,Re=re.defineProperty,Oe=[],Ke=re.getOwnPropertyDescriptor,Y=re.getOwnPropertyNames,Ct=re.getPrototypeOf,$e=re.setPrototypeOf,Se=!!re.__proto__,Je="__dreCEv1",Me=G.customElements,t=!/^force/.test(ne.type)&&!!(Me&&Me.define&&Me.get&&Me.whenDefined),a=re.create||re,u=G.Map||function(){var e,r=[],i=[];return{get:function(h){return i[Te.call(r,h)]},set:function(h,s){(e=Te.call(r,h))<0?i[r.push(h)-1]=s:i[e]=s}}},c=G.Promise||function(e){function r(o){for(h=!0;i.length;)i.shift()(o)}var i=[],h=!1,s={catch:function(){return s},then:function(o){return i.push(o),h&&setTimeout(r,1),s}};return e(r),s},f=!1,m=a(null),E=a(null),v=new u,C=function(e){return e.toLowerCase()},w=re.create||function e(r){return r?(e.prototype=r,new e):this},b=$e||(Se?function(e,r){return e.__proto__=r,e}:Y&&Ke?function(){function e(r,i){for(var h,s=Y(i),o=0,l=s.length;o<l;o++)Pe.call(r,h=s[o])||Re(r,h,Ke(i,h))}return function(r,i){do{e(r,i)}while((i=Ct(i))&&!at.call(i,r));return r}}():function(e,r){for(var i in r)e[i]=r[i];return e}),N=G.MutationObserver||G.WebKitMutationObserver,S=G.HTMLAnchorElement,P=(G.HTMLElement||G.Element||G.Node).prototype,z=!at.call(P,De),x=z?function(e,r,i){return e[r]=i.value,e}:Re,L=z?function(e){return 1===e.nodeType}:function(e){return at.call(P,e)},T=z&&[],Z=P.attachShadow,W=P.cloneNode,B=P.closest||function(e){for(var r=this;r&&r.nodeName!==e;)r=r.parentNode;return r},K=P.dispatchEvent,R=P.getAttribute,Q=P.hasAttribute,F=P.removeAttribute,$=P.setAttribute,O=A.createElement,j=A.importNode,H=O,oe=N&&{attributes:!0,characterData:!0,attributeOldValue:!0},_e=N||function(e){I=!1,De.removeEventListener(He,_e)},V=0,ue=se in A&&!/^force-all/.test(ne.type),fe=!0,X=!1,I=!0,k=!0,n=!0;if(N&&((Ce=A.createElement("div")).innerHTML="<div><div></div></div>",new N(function(e,r){if(e[0]&&"childList"==e[0].type&&!e[0].removedNodes[0].childNodes.length){var i=(Ce=Ke(P,"innerHTML"))&&Ce.set;i&&Re(P,"innerHTML",{set:function(h){for(;this.lastChild;)this.removeChild(this.lastChild);i.call(this,h)}})}r.disconnect(),Ce=null}).observe(Ce,{childList:!0,subtree:!0}),Ce.innerHTML=""),ue||($e||Se?(we=function(e,r){at.call(r,e)||Be(e,r)},ae=Be):ae=we=function(e,r){e[me]||(e[me]=re(!0),Be(e,r))},z?(I=!1,e=Ke(P,be),r=e.value,i=function(o){var l=new CustomEvent(He,{bubbles:!0});l.attrName=o,l.prevValue=R.call(this,o),l.newValue=null,l[pt]=l.attrChange=2,F.call(this,o),K.call(this,l)},h=function(o,l){var d=Q.call(this,o),p=d&&R.call(this,o),y=new CustomEvent(He,{bubbles:!0});$.call(this,o,l),y.attrName=o,y.prevValue=d?p:null,y.newValue=l,d?y.MODIFICATION=y.attrChange=1:y[ot]=y.attrChange=0,K.call(this,y)},s=function(o){var l,d=o.currentTarget,p=d[me],y=o.propertyName;p.hasOwnProperty(y)&&(p=p[y],(l=new CustomEvent(He,{bubbles:!0})).attrName=p.name,l.prevValue=p.value||null,l.newValue=p.value=d[y]||null,null==l.prevValue?l[ot]=l.attrChange=0:l.MODIFICATION=l.attrChange=1,K.call(d,l))},e.value=function(o,l,d){o===He&&this[Ee]&&this.setAttribute!==h&&(this[me]={className:{name:"class",value:this.className}},this.setAttribute=h,this.removeAttribute=i,r.call(this,"propertychange",s)),r.call(this,o,l,d)},Re(P,be,e)):N||(De[be](He,_e),De.setAttribute(me,1),De.removeAttribute(me),I&&(xe=function(e){var r,i,h,s=this;if(s===e.target){for(h in r=s[me],s[me]=i=nt(s),i){if(!(h in r))return ze(0,s,h,r[h],i[h],ot);if(i[h]!==r[h])return ze(1,s,h,r[h],i[h],"MODIFICATION")}for(h in r)if(!(h in i))return ze(2,s,h,r[h],i[h],pt)}},ze=function(e,r,i,h,s,o){var l={attrChange:e,currentTarget:r,attrName:i,prevValue:h,newValue:s};l[o]=e,Ue(l)},nt=function(e){for(var r,i,h={},s=e.attributes,o=0,l=s.length;o<l;o++)"setAttribute"!==(i=(r=s[o]).name)&&(h[i]=r.value);return h})),A[se]=function(e,r){if(i=e.toUpperCase(),fe&&(fe=!1,N?(We=function(p,y){function _(g,M){for(var D=0,q=g.length;D<q;M(g[D++]));}return new N(function(g){for(var M,D,q,ee=0,ge=g.length;ee<ge;ee++)"childList"===(M=g[ee]).type?(_(M.addedNodes,p),_(M.removedNodes,y)):(D=M.target,n&&D[Ee]&&"style"!==M.attributeName&&(q=R.call(D,M.attributeName))!==M.oldValue&&D[Ee](M.attributeName,M.oldValue,q))})}(Ve(Le),Ve(pe)),(ie=function(p){return We.observe(p,{childList:!0,subtree:!0}),p})(A),Z&&(P.attachShadow=function(){return ie(Z.apply(this,arguments))})):(Ge=[],A[be]("DOMNodeInserted",et(Le)),A[be]("DOMNodeRemoved",et(pe))),A[be](bt,de),A[be]("readystatechange",de),A.importNode=function(p,y){switch(p.nodeType){case 1:return Ae(A,j,[p,!!y]);case 11:for(var _=A.createDocumentFragment(),g=p.childNodes,M=g.length,D=0;D<M;D++)_.appendChild(A.importNode(g[D],!!y));return _;default:return W.call(p,!!y)}},P.cloneNode=function(p){return Ae(this,W,[!!p])}),X)return X=!1;if(-2<Te.call(Ne,st+i)+Te.call(Ne,Xe+i)&&U(e),!Mt.test(i)||-1<Te.call(wt,i))throw new Error("The type "+e+" is invalid");var i,h,s=function(){return l?A.createElement(d,i):A.createElement(d)},o=r||it,l=Pe.call(o,te),d=l?r[te].toUpperCase():i;return l&&-1<Te.call(Ne,Xe+d)&&U(d),h=Ne.push((l?st:Xe)+i)-1,le=le.concat(le.length?",":"",l?d+'[is="'+e.toLowerCase()+'"]':d),s.prototype=Ye[h]=Pe.call(o,"prototype")?o.prototype:w(P),le.length&&ye(A.querySelectorAll(le),Le),s},A.createElement=H=function(e,r){var i=yt(r),h=i?O.call(A,e,C(i)):O.call(A,e),s=""+e,o=Te.call(Ne,(i?st:Xe)+(i||s).toUpperCase()),l=-1<o;return i&&(h.setAttribute("is",i=i.toLowerCase()),l&&(l=Ze(s.toUpperCase(),i))),n=!A.createElement.innerHTMLHelper,l&&ae(h,Ye[o]),h}),addEventListener("beforeunload",function(){delete A.createElement,delete A.importNode,delete A[se]},!1),ke.prototype={constructor:ke,define:t?function(e,r,i){if(i)J(e,r,i);else{var h=e.toUpperCase();m[h]={constructor:r,create:[h]},v.set(r,h),Me.define(e,r)}}:J,get:t?function(e){return Me.get(e)||gt(e)}:gt,whenDefined:t?function(e){return c.race([Me.whenDefined(e),ut(e)])}:ut},!Me||/^force/.test(ne.type))ft();else if(!ne.noBuiltIn)try{!function(e,r,i){var h=new RegExp("^<a\\s+is=('|\")"+i+"\\1></a>$");if(r[te]="a",(e.prototype=w(S.prototype)).constructor=e,G.customElements.define(i,e,r),!h.test(A.createElement("a",{is:i}).outerHTML)||!h.test((new e).outerHTML))throw r}(function e(){return Reflect.construct(S,[],e)},{},"document-register-element-a"+dt)}catch(e){ft()}if(!ne.noBuiltIn)try{if(O.call(A,"a","a").outerHTML.indexOf("is")<0)throw{}}catch(e){C=function(r){return{is:r.toLowerCase()}}}}(window)},277:()=>{"use strict";!function(t){const a=t.performance;function u(I){a&&a.mark&&a.mark(I)}function c(I,k){a&&a.measure&&a.measure(I,k)}u("Zone");const f=t.__Zone_symbol_prefix||"__zone_symbol__";function m(I){return f+I}const E=!0===t[m("forceDuplicateZoneCheck")];if(t.Zone){if(E||"function"!=typeof t.Zone.__symbol__)throw new Error("Zone already loaded.");return t.Zone}let v=(()=>{class I{constructor(n,e){this._parent=n,this._name=e?e.name||"unnamed":"<root>",this._properties=e&&e.properties||{},this._zoneDelegate=new w(this,this._parent&&this._parent._zoneDelegate,e)}static assertZonePatched(){if(t.Promise!==oe.ZoneAwarePromise)throw new Error("Zone.js has detected that ZoneAwarePromise `(window|global).Promise` has been overwritten.\nMost likely cause is that a Promise polyfill has been loaded after Zone.js (Polyfilling Promise api is not necessary when zone.js is loaded. If you must load one, do so before loading zone.js.)")}static get root(){let n=I.current;for(;n.parent;)n=n.parent;return n}static get current(){return V.zone}static get currentTask(){return ue}static __load_patch(n,e,r=!1){if(oe.hasOwnProperty(n)){if(!r&&E)throw Error("Already loaded patch: "+n)}else if(!t["__Zone_disable_"+n]){const i="Zone:"+n;u(i),oe[n]=e(t,I,_e),c(i,i)}}get parent(){return this._parent}get name(){return this._name}get(n){const e=this.getZoneWith(n);if(e)return e._properties[n]}getZoneWith(n){let e=this;for(;e;){if(e._properties.hasOwnProperty(n))return e;e=e._parent}return null}fork(n){if(!n)throw new Error("ZoneSpec required!");return this._zoneDelegate.fork(this,n)}wrap(n,e){if("function"!=typeof n)throw new Error("Expecting function got: "+n);const r=this._zoneDelegate.intercept(this,n,e),i=this;return function(){return i.runGuarded(r,this,arguments,e)}}run(n,e,r,i){V={parent:V,zone:this};try{return this._zoneDelegate.invoke(this,n,e,r,i)}finally{V=V.parent}}runGuarded(n,e=null,r,i){V={parent:V,zone:this};try{try{return this._zoneDelegate.invoke(this,n,e,r,i)}catch(h){if(this._zoneDelegate.handleError(this,h))throw h}}finally{V=V.parent}}runTask(n,e,r){if(n.zone!=this)throw new Error("A task can only be run in the zone of creation! (Creation: "+(n.zone||W).name+"; Execution: "+this.name+")");if(n.state===B&&(n.type===H||n.type===j))return;const i=n.state!=Q;i&&n._transitionTo(Q,R),n.runCount++;const h=ue;ue=n,V={parent:V,zone:this};try{n.type==j&&n.data&&!n.data.isPeriodic&&(n.cancelFn=void 0);try{return this._zoneDelegate.invokeTask(this,n,e,r)}catch(s){if(this._zoneDelegate.handleError(this,s))throw s}}finally{n.state!==B&&n.state!==$&&(n.type==H||n.data&&n.data.isPeriodic?i&&n._transitionTo(R,Q):(n.runCount=0,this._updateTaskCount(n,-1),i&&n._transitionTo(B,Q,B))),V=V.parent,ue=h}}scheduleTask(n){if(n.zone&&n.zone!==this){let r=this;for(;r;){if(r===n.zone)throw Error(`can not reschedule task to ${this.name} which is descendants of the original zone ${n.zone.name}`);r=r.parent}}n._transitionTo(K,B);const e=[];n._zoneDelegates=e,n._zone=this;try{n=this._zoneDelegate.scheduleTask(this,n)}catch(r){throw n._transitionTo($,K,B),this._zoneDelegate.handleError(this,r),r}return n._zoneDelegates===e&&this._updateTaskCount(n,1),n.state==K&&n._transitionTo(R,K),n}scheduleMicroTask(n,e,r,i){return this.scheduleTask(new b(O,n,e,r,i,void 0))}scheduleMacroTask(n,e,r,i,h){return this.scheduleTask(new b(j,n,e,r,i,h))}scheduleEventTask(n,e,r,i,h){return this.scheduleTask(new b(H,n,e,r,i,h))}cancelTask(n){if(n.zone!=this)throw new Error("A task can only be cancelled in the zone of creation! (Creation: "+(n.zone||W).name+"; Execution: "+this.name+")");n._transitionTo(F,R,Q);try{this._zoneDelegate.cancelTask(this,n)}catch(e){throw n._transitionTo($,F),this._zoneDelegate.handleError(this,e),e}return this._updateTaskCount(n,-1),n._transitionTo(B,F),n.runCount=0,n}_updateTaskCount(n,e){const r=n._zoneDelegates;-1==e&&(n._zoneDelegates=null);for(let i=0;i<r.length;i++)r[i]._updateTaskCount(n.type,e)}}return I.__symbol__=m,I})();const C={name:"",onHasTask:(I,k,n,e)=>I.hasTask(n,e),onScheduleTask:(I,k,n,e)=>I.scheduleTask(n,e),onInvokeTask:(I,k,n,e,r,i)=>I.invokeTask(n,e,r,i),onCancelTask:(I,k,n,e)=>I.cancelTask(n,e)};class w{constructor(k,n,e){this._taskCounts={microTask:0,macroTask:0,eventTask:0},this.zone=k,this._parentDelegate=n,this._forkZS=e&&(e&&e.onFork?e:n._forkZS),this._forkDlgt=e&&(e.onFork?n:n._forkDlgt),this._forkCurrZone=e&&(e.onFork?this.zone:n._forkCurrZone),this._interceptZS=e&&(e.onIntercept?e:n._interceptZS),this._interceptDlgt=e&&(e.onIntercept?n:n._interceptDlgt),this._interceptCurrZone=e&&(e.onIntercept?this.zone:n._interceptCurrZone),this._invokeZS=e&&(e.onInvoke?e:n._invokeZS),this._invokeDlgt=e&&(e.onInvoke?n:n._invokeDlgt),this._invokeCurrZone=e&&(e.onInvoke?this.zone:n._invokeCurrZone),this._handleErrorZS=e&&(e.onHandleError?e:n._handleErrorZS),this._handleErrorDlgt=e&&(e.onHandleError?n:n._handleErrorDlgt),this._handleErrorCurrZone=e&&(e.onHandleError?this.zone:n._handleErrorCurrZone),this._scheduleTaskZS=e&&(e.onScheduleTask?e:n._scheduleTaskZS),this._scheduleTaskDlgt=e&&(e.onScheduleTask?n:n._scheduleTaskDlgt),this._scheduleTaskCurrZone=e&&(e.onScheduleTask?this.zone:n._scheduleTaskCurrZone),this._invokeTaskZS=e&&(e.onInvokeTask?e:n._invokeTaskZS),this._invokeTaskDlgt=e&&(e.onInvokeTask?n:n._invokeTaskDlgt),this._invokeTaskCurrZone=e&&(e.onInvokeTask?this.zone:n._invokeTaskCurrZone),this._cancelTaskZS=e&&(e.onCancelTask?e:n._cancelTaskZS),this._cancelTaskDlgt=e&&(e.onCancelTask?n:n._cancelTaskDlgt),this._cancelTaskCurrZone=e&&(e.onCancelTask?this.zone:n._cancelTaskCurrZone),this._hasTaskZS=null,this._hasTaskDlgt=null,this._hasTaskDlgtOwner=null,this._hasTaskCurrZone=null;const r=e&&e.onHasTask;(r||n&&n._hasTaskZS)&&(this._hasTaskZS=r?e:C,this._hasTaskDlgt=n,this._hasTaskDlgtOwner=this,this._hasTaskCurrZone=k,e.onScheduleTask||(this._scheduleTaskZS=C,this._scheduleTaskDlgt=n,this._scheduleTaskCurrZone=this.zone),e.onInvokeTask||(this._invokeTaskZS=C,this._invokeTaskDlgt=n,this._invokeTaskCurrZone=this.zone),e.onCancelTask||(this._cancelTaskZS=C,this._cancelTaskDlgt=n,this._cancelTaskCurrZone=this.zone))}fork(k,n){return this._forkZS?this._forkZS.onFork(this._forkDlgt,this.zone,k,n):new v(k,n)}intercept(k,n,e){return this._interceptZS?this._interceptZS.onIntercept(this._interceptDlgt,this._interceptCurrZone,k,n,e):n}invoke(k,n,e,r,i){return this._invokeZS?this._invokeZS.onInvoke(this._invokeDlgt,this._invokeCurrZone,k,n,e,r,i):n.apply(e,r)}handleError(k,n){return!this._handleErrorZS||this._handleErrorZS.onHandleError(this._handleErrorDlgt,this._handleErrorCurrZone,k,n)}scheduleTask(k,n){let e=n;if(this._scheduleTaskZS)this._hasTaskZS&&e._zoneDelegates.push(this._hasTaskDlgtOwner),e=this._scheduleTaskZS.onScheduleTask(this._scheduleTaskDlgt,this._scheduleTaskCurrZone,k,n),e||(e=n);else if(n.scheduleFn)n.scheduleFn(n);else{if(n.type!=O)throw new Error("Task is missing scheduleFn.");T(n)}return e}invokeTask(k,n,e,r){return this._invokeTaskZS?this._invokeTaskZS.onInvokeTask(this._invokeTaskDlgt,this._invokeTaskCurrZone,k,n,e,r):n.callback.apply(e,r)}cancelTask(k,n){let e;if(this._cancelTaskZS)e=this._cancelTaskZS.onCancelTask(this._cancelTaskDlgt,this._cancelTaskCurrZone,k,n);else{if(!n.cancelFn)throw Error("Task is not cancelable");e=n.cancelFn(n)}return e}hasTask(k,n){try{this._hasTaskZS&&this._hasTaskZS.onHasTask(this._hasTaskDlgt,this._hasTaskCurrZone,k,n)}catch(e){this.handleError(k,e)}}_updateTaskCount(k,n){const e=this._taskCounts,r=e[k],i=e[k]=r+n;if(i<0)throw new Error("More tasks executed then were scheduled.");0!=r&&0!=i||this.hasTask(this.zone,{microTask:e.microTask>0,macroTask:e.macroTask>0,eventTask:e.eventTask>0,change:k})}}class b{constructor(k,n,e,r,i,h){if(this._zone=null,this.runCount=0,this._zoneDelegates=null,this._state="notScheduled",this.type=k,this.source=n,this.data=r,this.scheduleFn=i,this.cancelFn=h,!e)throw new Error("callback is not defined");this.callback=e;const s=this;this.invoke=k===H&&r&&r.useG?b.invokeTask:function(){return b.invokeTask.call(t,s,this,arguments)}}static invokeTask(k,n,e){k||(k=this),fe++;try{return k.runCount++,k.zone.runTask(k,n,e)}finally{1==fe&&Z(),fe--}}get zone(){return this._zone}get state(){return this._state}cancelScheduleRequest(){this._transitionTo(B,K)}_transitionTo(k,n,e){if(this._state!==n&&this._state!==e)throw new Error(`${this.type} '${this.source}': can not transition to '${k}', expecting state '${n}'${e?" or '"+e+"'":""}, was '${this._state}'.`);this._state=k,k==B&&(this._zoneDelegates=null)}toString(){return this.data&&void 0!==this.data.handleId?this.data.handleId.toString():Object.prototype.toString.call(this)}toJSON(){return{type:this.type,state:this.state,source:this.source,zone:this.zone.name,runCount:this.runCount}}}const N=m("setTimeout"),S=m("Promise"),P=m("then");let L,z=[],x=!1;function T(I){if(0===fe&&0===z.length)if(L||t[S]&&(L=t[S].resolve(0)),L){let k=L[P];k||(k=L.then),k.call(L,Z)}else t[N](Z,0);I&&z.push(I)}function Z(){if(!x){for(x=!0;z.length;){const I=z;z=[];for(let k=0;k<I.length;k++){const n=I[k];try{n.zone.runTask(n,null,null)}catch(e){_e.onUnhandledError(e)}}}_e.microtaskDrainDone(),x=!1}}const W={name:"NO ZONE"},B="notScheduled",K="scheduling",R="scheduled",Q="running",F="canceling",$="unknown",O="microTask",j="macroTask",H="eventTask",oe={},_e={symbol:m,currentZoneFrame:()=>V,onUnhandledError:X,microtaskDrainDone:X,scheduleMicroTask:T,showUncaughtError:()=>!v[m("ignoreConsoleErrorUncaughtError")],patchEventTarget:()=>[],patchOnProperties:X,patchMethod:()=>X,bindArguments:()=>[],patchThen:()=>X,patchMacroTask:()=>X,patchEventPrototype:()=>X,isIEOrEdge:()=>!1,getGlobalObjects:()=>{},ObjectDefineProperty:()=>X,ObjectGetOwnPropertyDescriptor:()=>{},ObjectCreate:()=>{},ArraySlice:()=>[],patchClass:()=>X,wrapWithCurrentZone:()=>X,filterProperties:()=>[],attachOriginToPatched:()=>X,_redefineProperty:()=>X,patchCallbacks:()=>X};let V={parent:null,zone:new v(null,null)},ue=null,fe=0;function X(){}c("Zone","Zone"),t.Zone=v}("undefined"!=typeof window&&window||"undefined"!=typeof self&&self||global);const ne=Object.getOwnPropertyDescriptor,he=Object.defineProperty,ye=Object.getPrototypeOf,_t=Object.create,Ve=Array.prototype.slice,Ie="addEventListener",Ze="removeEventListener",Ue=Zone.__symbol__(Ie),et=Zone.__symbol__(Ze),de="true",ve="false",Ae=Zone.__symbol__("");function Be(t,a){return Zone.current.wrap(t,a)}function lt(t,a,u,c,f){return Zone.current.scheduleMacroTask(t,a,u,c,f)}const U=Zone.__symbol__,je="undefined"!=typeof window,ke=je?window:void 0,J=je&&ke||"object"==typeof self&&self||global,yt=[null];function tt(t,a){for(let u=t.length-1;u>=0;u--)"function"==typeof t[u]&&(t[u]=Be(t[u],a+"_"+u));return t}function ft(t){return!t||!1!==t.writable&&!("function"==typeof t.get&&void 0===t.set)}const A="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope,re=!("nw"in J)&&void 0!==J.process&&"[object process]"==={}.toString.call(J.process),ht=!re&&!A&&!(!je||!ke.HTMLElement),Ge=void 0!==J.process&&"[object process]"==={}.toString.call(J.process)&&!A&&!(!je||!ke.HTMLElement),xe={},ze=function(t){if(!(t=t||J.event))return;let a=xe[t.type];a||(a=xe[t.type]=U("ON_PROPERTY"+t.type));const u=this||t.target||J,c=u[a];let f;if(ht&&u===ke&&"error"===t.type){const m=t;f=c&&c.call(this,m.message,m.filename,m.lineno,m.colno,m.error),!0===f&&t.preventDefault()}else f=c&&c.apply(this,arguments),null!=f&&!f&&t.preventDefault();return f};function nt(t,a,u){let c=ne(t,a);if(!c&&u&&ne(u,a)&&(c={enumerable:!0,configurable:!0}),!c||!c.configurable)return;const f=U("on"+a+"patched");if(t.hasOwnProperty(f)&&t[f])return;delete c.writable,delete c.value;const m=c.get,E=c.set,v=a.substr(2);let C=xe[v];C||(C=xe[v]=U("ON_PROPERTY"+v)),c.set=function(w){let b=this;!b&&t===J&&(b=J),b&&(b[C]&&b.removeEventListener(v,ze),E&&E.apply(b,yt),"function"==typeof w?(b[C]=w,b.addEventListener(v,ze,!1)):b[C]=null)},c.get=function(){let w=this;if(!w&&t===J&&(w=J),!w)return null;const b=w[C];if(b)return b;if(m){let N=m&&m.call(this);if(N)return c.set.call(this,N),"function"==typeof w.removeAttribute&&w.removeAttribute(a),N}return null},he(t,a,c),t[f]=!0}function We(t,a,u){if(a)for(let c=0;c<a.length;c++)nt(t,"on"+a[c],u);else{const c=[];for(const f in t)"on"==f.substr(0,2)&&c.push(f);for(let f=0;f<c.length;f++)nt(t,c[f],u)}}const ie=U("originalInstance");function we(t){const a=J[t];if(!a)return;J[U(t)]=a,J[t]=function(){const f=tt(arguments,t);switch(f.length){case 0:this[ie]=new a;break;case 1:this[ie]=new a(f[0]);break;case 2:this[ie]=new a(f[0],f[1]);break;case 3:this[ie]=new a(f[0],f[1],f[2]);break;case 4:this[ie]=new a(f[0],f[1],f[2],f[3]);break;default:throw new Error("Arg list too long.")}},se(J[t],a);const u=new a(function(){});let c;for(c in u)"XMLHttpRequest"===t&&"responseBlob"===c||function(f){"function"==typeof u[f]?J[t].prototype[f]=function(){return this[ie][f].apply(this[ie],arguments)}:he(J[t].prototype,f,{set:function(m){"function"==typeof m?(this[ie][f]=Be(m,t+"."+f),se(this[ie][f],m)):this[ie][f]=m},get:function(){return this[ie][f]}})}(c);for(c in a)"prototype"!==c&&a.hasOwnProperty(c)&&(J[t][c]=a[c])}function ae(t,a,u){let c=t;for(;c&&!c.hasOwnProperty(a);)c=ye(c);!c&&t[a]&&(c=t);const f=U(a);let m=null;if(c&&(!(m=c[f])||!c.hasOwnProperty(f))&&(m=c[f]=c[a],ft(c&&ne(c,a)))){const v=u(m,f,a);c[a]=function(){return v(this,arguments)},se(c[a],m)}return m}function Ce(t,a,u){let c=null;function f(m){const E=m.data;return E.args[E.cbIdx]=function(){m.invoke.apply(this,arguments)},c.apply(E.target,E.args),m}c=ae(t,a,m=>function(E,v){const C=u(E,v);return C.cbIdx>=0&&"function"==typeof v[C.cbIdx]?lt(C.name,v[C.cbIdx],C,f):m.apply(E,v)})}function se(t,a){t[U("OriginalDelegate")]=a}let dt=!1,me=!1;function Le(){if(dt)return me;dt=!0;try{const t=ke.navigator.userAgent;(-1!==t.indexOf("MSIE ")||-1!==t.indexOf("Trident/")||-1!==t.indexOf("Edge/"))&&(me=!0)}catch(t){}return me}Zone.__load_patch("ZoneAwarePromise",(t,a,u)=>{const c=Object.getOwnPropertyDescriptor,f=Object.defineProperty,E=u.symbol,v=[],C=!0===t[E("DISABLE_WRAPPING_UNCAUGHT_PROMISE_REJECTION")],w=E("Promise"),b=E("then");u.onUnhandledError=s=>{if(u.showUncaughtError()){const o=s&&s.rejection;o?console.error("Unhandled Promise rejection:",o instanceof Error?o.message:o,"; Zone:",s.zone.name,"; Task:",s.task&&s.task.source,"; Value:",o,o instanceof Error?o.stack:void 0):console.error(s)}},u.microtaskDrainDone=()=>{for(;v.length;){const s=v.shift();try{s.zone.runGuarded(()=>{throw s.throwOriginal?s.rejection:s})}catch(o){P(o)}}};const S=E("unhandledPromiseRejectionHandler");function P(s){u.onUnhandledError(s);try{const o=a[S];"function"==typeof o&&o.call(this,s)}catch(o){}}function z(s){return s&&s.then}function x(s){return s}function L(s){return n.reject(s)}const T=E("state"),Z=E("value"),W=E("finally"),B=E("parentPromiseValue"),K=E("parentPromiseState"),Q=null,F=!0,$=!1;function j(s,o){return l=>{try{V(s,o,l)}catch(d){V(s,!1,d)}}}const _e=E("currentTaskTrace");function V(s,o,l){const d=function(){let s=!1;return function(l){return function(){s||(s=!0,l.apply(null,arguments))}}}();if(s===l)throw new TypeError("Promise resolved with itself");if(s[T]===Q){let p=null;try{("object"==typeof l||"function"==typeof l)&&(p=l&&l.then)}catch(y){return d(()=>{V(s,!1,y)})(),s}if(o!==$&&l instanceof n&&l.hasOwnProperty(T)&&l.hasOwnProperty(Z)&&l[T]!==Q)fe(l),V(s,l[T],l[Z]);else if(o!==$&&"function"==typeof p)try{p.call(l,d(j(s,o)),d(j(s,!1)))}catch(y){d(()=>{V(s,!1,y)})()}else{s[T]=o;const y=s[Z];if(s[Z]=l,s[W]===W&&o===F&&(s[T]=s[K],s[Z]=s[B]),o===$&&l instanceof Error){const _=a.currentTask&&a.currentTask.data&&a.currentTask.data.__creationTrace__;_&&f(l,_e,{configurable:!0,enumerable:!1,writable:!0,value:_})}for(let _=0;_<y.length;)X(s,y[_++],y[_++],y[_++],y[_++]);if(0==y.length&&o==$){s[T]=0;let _=l;try{throw new Error("Uncaught (in promise): "+function(s){return s&&s.toString===Object.prototype.toString?(s.constructor&&s.constructor.name||"")+": "+JSON.stringify(s):s?s.toString():Object.prototype.toString.call(s)}(l)+(l&&l.stack?"\n"+l.stack:""))}catch(g){_=g}C&&(_.throwOriginal=!0),_.rejection=l,_.promise=s,_.zone=a.current,_.task=a.currentTask,v.push(_),u.scheduleMicroTask()}}}return s}const ue=E("rejectionHandledHandler");function fe(s){if(0===s[T]){try{const o=a[ue];o&&"function"==typeof o&&o.call(this,{rejection:s[Z],promise:s})}catch(o){}s[T]=$;for(let o=0;o<v.length;o++)s===v[o].promise&&v.splice(o,1)}}function X(s,o,l,d,p){fe(s);const y=s[T],_=y?"function"==typeof d?d:x:"function"==typeof p?p:L;o.scheduleMicroTask("Promise.then",()=>{try{const g=s[Z],M=!!l&&W===l[W];M&&(l[B]=g,l[K]=y);const D=o.run(_,void 0,M&&_!==L&&_!==x?[]:[g]);V(l,!0,D)}catch(g){V(l,!1,g)}},l)}const k=function(){};class n{static toString(){return"function ZoneAwarePromise() { [native code] }"}static resolve(o){return V(new this(null),F,o)}static reject(o){return V(new this(null),$,o)}static race(o){let l,d,p=new this((g,M)=>{l=g,d=M});function y(g){l(g)}function _(g){d(g)}for(let g of o)z(g)||(g=this.resolve(g)),g.then(y,_);return p}static all(o){return n.allWithCallback(o)}static allSettled(o){return(this&&this.prototype instanceof n?this:n).allWithCallback(o,{thenCallback:d=>({status:"fulfilled",value:d}),errorCallback:d=>({status:"rejected",reason:d})})}static allWithCallback(o,l){let d,p,y=new this((D,q)=>{d=D,p=q}),_=2,g=0;const M=[];for(let D of o){z(D)||(D=this.resolve(D));const q=g;try{D.then(ee=>{M[q]=l?l.thenCallback(ee):ee,_--,0===_&&d(M)},ee=>{l?(M[q]=l.errorCallback(ee),_--,0===_&&d(M)):p(ee)})}catch(ee){p(ee)}_++,g++}return _-=2,0===_&&d(M),y}constructor(o){const l=this;if(!(l instanceof n))throw new Error("Must be an instanceof Promise.");l[T]=Q,l[Z]=[];try{o&&o(j(l,F),j(l,$))}catch(d){V(l,!1,d)}}get[Symbol.toStringTag](){return"Promise"}get[Symbol.species](){return n}then(o,l){let d=this.constructor[Symbol.species];(!d||"function"!=typeof d)&&(d=this.constructor||n);const p=new d(k),y=a.current;return this[T]==Q?this[Z].push(y,p,o,l):X(this,y,p,o,l),p}catch(o){return this.then(null,o)}finally(o){let l=this.constructor[Symbol.species];(!l||"function"!=typeof l)&&(l=n);const d=new l(k);d[W]=W;const p=a.current;return this[T]==Q?this[Z].push(p,d,o,o):X(this,p,d,o,o),d}}n.resolve=n.resolve,n.reject=n.reject,n.race=n.race,n.all=n.all;const e=t[w]=t.Promise;t.Promise=n;const r=E("thenPatched");function i(s){const o=s.prototype,l=c(o,"then");if(l&&(!1===l.writable||!l.configurable))return;const d=o.then;o[b]=d,s.prototype.then=function(p,y){return new n((g,M)=>{d.call(this,g,M)}).then(p,y)},s[r]=!0}return u.patchThen=i,e&&(i(e),ae(t,"fetch",s=>function(s){return function(o,l){let d=s.apply(o,l);if(d instanceof n)return d;let p=d.constructor;return p[r]||i(p),d}}(s))),Promise[a.__symbol__("uncaughtPromiseErrors")]=v,n}),Zone.__load_patch("toString",t=>{const a=Function.prototype.toString,u=U("OriginalDelegate"),c=U("Promise"),f=U("Error"),m=function(){if("function"==typeof this){const w=this[u];if(w)return"function"==typeof w?a.call(w):Object.prototype.toString.call(w);if(this===Promise){const b=t[c];if(b)return a.call(b)}if(this===Error){const b=t[f];if(b)return a.call(b)}}return a.call(this)};m[u]=a,Function.prototype.toString=m;const E=Object.prototype.toString;Object.prototype.toString=function(){return"function"==typeof Promise&&this instanceof Promise?"[object Promise]":E.call(this)}});let ce=!1;if("undefined"!=typeof window)try{const t=Object.defineProperty({},"passive",{get:function(){ce=!0}});window.addEventListener("test",t,t),window.removeEventListener("test",t,t)}catch(t){ce=!1}const pe={useG:!0},te={},Ee={},vt=new RegExp("^"+Ae+"(\\w+)(true|false)$"),rt=U("propagationStopped");function mt(t,a){const u=(a?a(t):t)+ve,c=(a?a(t):t)+de,f=Ae+u,m=Ae+c;te[t]={},te[t][ve]=f,te[t][de]=m}function qe(t,a,u){const c=u&&u.add||Ie,f=u&&u.rm||Ze,m=u&&u.listeners||"eventListeners",E=u&&u.rmAll||"removeAllListeners",v=U(c),C="."+c+":",N=function(L,T,Z){if(L.isRemoved)return;const W=L.callback;"object"==typeof W&&W.handleEvent&&(L.callback=K=>W.handleEvent(K),L.originalDelegate=W),L.invoke(L,T,[Z]);const B=L.options;B&&"object"==typeof B&&B.once&&T[f].call(T,Z.type,L.originalDelegate?L.originalDelegate:L.callback,B)},S=function(L){if(!(L=L||t.event))return;const T=this||L.target||t,Z=T[te[L.type][ve]];if(Z)if(1===Z.length)N(Z[0],T,L);else{const W=Z.slice();for(let B=0;B<W.length&&(!L||!0!==L[rt]);B++)N(W[B],T,L)}},P=function(L){if(!(L=L||t.event))return;const T=this||L.target||t,Z=T[te[L.type][de]];if(Z)if(1===Z.length)N(Z[0],T,L);else{const W=Z.slice();for(let B=0;B<W.length&&(!L||!0!==L[rt]);B++)N(W[B],T,L)}};function z(L,T){if(!L)return!1;let Z=!0;T&&void 0!==T.useG&&(Z=T.useG);const W=T&&T.vh;let B=!0;T&&void 0!==T.chkDup&&(B=T.chkDup);let K=!1;T&&void 0!==T.rt&&(K=T.rt);let R=L;for(;R&&!R.hasOwnProperty(c);)R=ye(R);if(!R&&L[c]&&(R=L),!R||R[v])return!1;const Q=T&&T.eventNameToString,F={},$=R[v]=R[c],O=R[U(f)]=R[f],j=R[U(m)]=R[m],H=R[U(E)]=R[E];let oe;function _e(o,l){return!ce&&"object"==typeof o&&o?!!o.capture:ce&&l?"boolean"==typeof o?{capture:o,passive:!0}:o?"object"==typeof o&&!1!==o.passive?Object.assign(Object.assign({},o),{passive:!0}):o:{passive:!0}:o}T&&T.prepend&&(oe=R[U(T.prepend)]=R[T.prepend]);const k=Z?function(o){if(!F.isExisting)return $.call(F.target,F.eventName,F.capture?P:S,F.options)}:function(o){return $.call(F.target,F.eventName,o.invoke,F.options)},n=Z?function(o){if(!o.isRemoved){const l=te[o.eventName];let d;l&&(d=l[o.capture?de:ve]);const p=d&&o.target[d];if(p)for(let y=0;y<p.length;y++)if(p[y]===o){p.splice(y,1),o.isRemoved=!0,0===p.length&&(o.allRemoved=!0,o.target[d]=null);break}}if(o.allRemoved)return O.call(o.target,o.eventName,o.capture?P:S,o.options)}:function(o){return O.call(o.target,o.eventName,o.invoke,o.options)},r=T&&T.diff?T.diff:function(o,l){const d=typeof l;return"function"===d&&o.callback===l||"object"===d&&o.originalDelegate===l},i=Zone[U("UNPATCHED_EVENTS")],h=t[U("PASSIVE_EVENTS")],s=function(o,l,d,p,y=!1,_=!1){return function(){const g=this||t;let M=arguments[0];T&&T.transferEventName&&(M=T.transferEventName(M));let D=arguments[1];if(!D)return o.apply(this,arguments);if(re&&"uncaughtException"===M)return o.apply(this,arguments);let q=!1;if("function"!=typeof D){if(!D.handleEvent)return o.apply(this,arguments);q=!0}if(W&&!W(o,D,g,arguments))return;const ee=ce&&!!h&&-1!==h.indexOf(M),ge=_e(arguments[2],ee);if(i)for(let Qe=0;Qe<i.length;Qe++)if(M===i[Qe])return ee?o.call(g,M,D,ge):o.apply(this,arguments);const Ot=!!ge&&("boolean"==typeof ge||ge.capture),Nt=!(!ge||"object"!=typeof ge)&&ge.once,Zt=Zone.current;let Ht=te[M];Ht||(mt(M,Q),Ht=te[M]);const Dt=Ht[Ot?de:ve];let Lt,ct=g[Dt],Rt=!1;if(ct){if(Rt=!0,B)for(let Qe=0;Qe<ct.length;Qe++)if(r(ct[Qe],D))return}else ct=g[Dt]=[];const St=g.constructor.name,It=Ee[St];It&&(Lt=It[M]),Lt||(Lt=St+l+(Q?Q(M):M)),F.options=ge,Nt&&(F.options.once=!1),F.target=g,F.capture=Ot,F.eventName=M,F.isExisting=Rt;const Tt=Z?pe:void 0;Tt&&(Tt.taskData=F);const Fe=Zt.scheduleEventTask(Lt,D,Tt,d,p);return F.target=null,Tt&&(Tt.taskData=null),Nt&&(ge.once=!0),!ce&&"boolean"==typeof Fe.options||(Fe.options=ge),Fe.target=g,Fe.capture=Ot,Fe.eventName=M,q&&(Fe.originalDelegate=D),_?ct.unshift(Fe):ct.push(Fe),y?g:void 0}};return R[c]=s($,C,k,n,K),oe&&(R.prependListener=s(oe,".prependListener:",function(o){return oe.call(F.target,F.eventName,o.invoke,F.options)},n,K,!0)),R[f]=function(){const o=this||t;let l=arguments[0];T&&T.transferEventName&&(l=T.transferEventName(l));const d=arguments[2],p=!!d&&("boolean"==typeof d||d.capture),y=arguments[1];if(!y)return O.apply(this,arguments);if(W&&!W(O,y,o,arguments))return;const _=te[l];let g;_&&(g=_[p?de:ve]);const M=g&&o[g];if(M)for(let D=0;D<M.length;D++){const q=M[D];if(r(q,y))return M.splice(D,1),q.isRemoved=!0,0===M.length&&(q.allRemoved=!0,o[g]=null,"string"==typeof l)&&(o[Ae+"ON_PROPERTY"+l]=null),q.zone.cancelTask(q),K?o:void 0}return O.apply(this,arguments)},R[m]=function(){const o=this||t;let l=arguments[0];T&&T.transferEventName&&(l=T.transferEventName(l));const d=[],p=kt(o,Q?Q(l):l);for(let y=0;y<p.length;y++){const _=p[y];d.push(_.originalDelegate?_.originalDelegate:_.callback)}return d},R[E]=function(){const o=this||t;let l=arguments[0];if(l){T&&T.transferEventName&&(l=T.transferEventName(l));const d=te[l];if(d){const _=o[d[ve]],g=o[d[de]];if(_){const M=_.slice();for(let D=0;D<M.length;D++){const q=M[D];this[f].call(this,l,q.originalDelegate?q.originalDelegate:q.callback,q.options)}}if(g){const M=g.slice();for(let D=0;D<M.length;D++){const q=M[D];this[f].call(this,l,q.originalDelegate?q.originalDelegate:q.callback,q.options)}}}}else{const d=Object.keys(o);for(let p=0;p<d.length;p++){const _=vt.exec(d[p]);let g=_&&_[1];g&&"removeListener"!==g&&this[E].call(this,g)}this[E].call(this,"removeListener")}if(K)return this},se(R[c],$),se(R[f],O),H&&se(R[E],H),j&&se(R[m],j),!0}let x=[];for(let L=0;L<a.length;L++)x[L]=z(a[L],u);return x}function kt(t,a){if(!a){const m=[];for(let E in t){const v=vt.exec(E);let C=v&&v[1];if(C&&(!a||C===a)){const w=t[E];if(w)for(let b=0;b<w.length;b++)m.push(w[b])}}return m}let u=te[a];u||(mt(a),u=te[a]);const c=t[u[ve]],f=t[u[de]];return c?f?c.concat(f):c.slice():f?f.slice():[]}function ot(t,a){const u=t.Event;u&&u.prototype&&a.patchMethod(u.prototype,"stopImmediatePropagation",c=>function(f,m){f[rt]=!0,c&&c.apply(f,m)})}function pt(t,a,u,c,f){const m=Zone.__symbol__(c);if(a[m])return;const E=a[m]=a[c];a[c]=function(v,C,w){return C&&C.prototype&&f.forEach(function(b){const N=`${u}.${c}::`+b,S=C.prototype;if(S.hasOwnProperty(b)){const P=t.ObjectGetOwnPropertyDescriptor(S,b);P&&P.value?(P.value=t.wrapWithCurrentZone(P.value,N),t._redefineProperty(C.prototype,b,P)):S[b]&&(S[b]=t.wrapWithCurrentZone(S[b],N))}else S[b]&&(S[b]=t.wrapWithCurrentZone(S[b],N))}),E.call(a,v,C,w)},t.attachOriginToPatched(a[c],E)}const Et=["absolutedeviceorientation","afterinput","afterprint","appinstalled","beforeinstallprompt","beforeprint","beforeunload","devicelight","devicemotion","deviceorientation","deviceorientationabsolute","deviceproximity","hashchange","languagechange","message","mozbeforepaint","offline","online","paint","pageshow","pagehide","popstate","rejectionhandled","storage","unhandledrejection","unload","userproximity","vrdisplayconnected","vrdisplaydisconnected","vrdisplaypresentchange"],st=["encrypted","waitingforkey","msneedkey","mozinterruptbegin","mozinterruptend"],le=["load"],De=["blur","error","focus","load","resize","scroll","messageerror"],Te=["bounce","finish","start"],it=["loadstart","progress","abort","error","load","progress","timeout","loadend","readystatechange"],Pe=["upgradeneeded","complete","abort","success","error","blocked","versionchange","close"],at=["close","error","open","message"],Re=["error","message"],Oe=["abort","animationcancel","animationend","animationiteration","auxclick","beforeinput","blur","cancel","canplay","canplaythrough","change","compositionstart","compositionupdate","compositionend","cuechange","click","close","contextmenu","curechange","dblclick","drag","dragend","dragenter","dragexit","dragleave","dragover","drop","durationchange","emptied","ended","error","focus","focusin","focusout","gotpointercapture","input","invalid","keydown","keypress","keyup","load","loadstart","loadeddata","loadedmetadata","lostpointercapture","mousedown","mouseenter","mouseleave","mousemove","mouseout","mouseover","mouseup","mousewheel","orientationchange","pause","play","playing","pointercancel","pointerdown","pointerenter","pointerleave","pointerlockchange","mozpointerlockchange","webkitpointerlockerchange","pointerlockerror","mozpointerlockerror","webkitpointerlockerror","pointermove","pointout","pointerover","pointerup","progress","ratechange","reset","resize","scroll","seeked","seeking","select","selectionchange","selectstart","show","sort","stalled","submit","suspend","timeupdate","volumechange","touchcancel","touchmove","touchstart","touchend","transitioncancel","transitionend","waiting","wheel"].concat(["webglcontextrestored","webglcontextlost","webglcontextcreationerror"],["autocomplete","autocompleteerror"],["toggle"],["afterscriptexecute","beforescriptexecute","DOMContentLoaded","freeze","fullscreenchange","mozfullscreenchange","webkitfullscreenchange","msfullscreenchange","fullscreenerror","mozfullscreenerror","webkitfullscreenerror","msfullscreenerror","readystatechange","visibilitychange","resume"],Et,["beforecopy","beforecut","beforepaste","copy","cut","paste","dragstart","loadend","animationstart","search","transitionrun","transitionstart","webkitanimationend","webkitanimationiteration","webkitanimationstart","webkittransitionend"],["activate","afterupdate","ariarequest","beforeactivate","beforedeactivate","beforeeditfocus","beforeupdate","cellchange","controlselect","dataavailable","datasetchanged","datasetcomplete","errorupdate","filterchange","layoutcomplete","losecapture","move","moveend","movestart","propertychange","resizeend","resizestart","rowenter","rowexit","rowsdelete","rowsinserted","command","compassneedscalibration","deactivate","help","mscontentzoom","msmanipulationstatechanged","msgesturechange","msgesturedoubletap","msgestureend","msgesturehold","msgesturestart","msgesturetap","msgotpointercapture","msinertiastart","mslostpointercapture","mspointercancel","mspointerdown","mspointerenter","mspointerhover","mspointerleave","mspointermove","mspointerout","mspointerover","mspointerup","pointerout","mssitemodejumplistitemremoved","msthumbnailclick","stop","storagecommit"]);function Ke(t,a,u){if(!u||0===u.length)return a;const c=u.filter(m=>m.target===t);if(!c||0===c.length)return a;const f=c[0].ignoreProperties;return a.filter(m=>-1===f.indexOf(m))}function Y(t,a,u,c){t&&We(t,Ke(t,a,u),c)}Zone.__load_patch("util",(t,a,u)=>{u.patchOnProperties=We,u.patchMethod=ae,u.bindArguments=tt,u.patchMacroTask=Ce;const c=a.__symbol__("BLACK_LISTED_EVENTS"),f=a.__symbol__("UNPATCHED_EVENTS");t[f]&&(t[c]=t[f]),t[c]&&(a[c]=a[f]=t[c]),u.patchEventPrototype=ot,u.patchEventTarget=qe,u.isIEOrEdge=Le,u.ObjectDefineProperty=he,u.ObjectGetOwnPropertyDescriptor=ne,u.ObjectCreate=_t,u.ArraySlice=Ve,u.patchClass=we,u.wrapWithCurrentZone=Be,u.filterProperties=Ke,u.attachOriginToPatched=se,u._redefineProperty=Object.defineProperty,u.patchCallbacks=pt,u.getGlobalObjects=()=>({globalSources:Ee,zoneSymbolEventNames:te,eventNames:Oe,isBrowser:ht,isMix:Ge,isNode:re,TRUE_STR:de,FALSE_STR:ve,ZONE_SYMBOL_PREFIX:Ae,ADD_EVENT_LISTENER_STR:Ie,REMOVE_EVENT_LISTENER_STR:Ze})});const $e=U("zoneTask");function Se(t,a,u,c){let f=null,m=null;u+=c;const E={};function v(w){const b=w.data;return b.args[0]=function(){return w.invoke.apply(this,arguments)},b.handleId=f.apply(t,b.args),w}function C(w){return m.call(t,w.data.handleId)}f=ae(t,a+=c,w=>function(b,N){if("function"==typeof N[0]){const S={isPeriodic:"Interval"===c,delay:"Timeout"===c||"Interval"===c?N[1]||0:void 0,args:N},P=N[0];N[0]=function(){try{return P.apply(this,arguments)}finally{S.isPeriodic||("number"==typeof S.handleId?delete E[S.handleId]:S.handleId&&(S.handleId[$e]=null))}};const z=lt(a,N[0],S,v,C);if(!z)return z;const x=z.data.handleId;return"number"==typeof x?E[x]=z:x&&(x[$e]=z),x&&x.ref&&x.unref&&"function"==typeof x.ref&&"function"==typeof x.unref&&(z.ref=x.ref.bind(x),z.unref=x.unref.bind(x)),"number"==typeof x||x?x:z}return w.apply(t,N)}),m=ae(t,u,w=>function(b,N){const S=N[0];let P;"number"==typeof S?P=E[S]:(P=S&&S[$e],P||(P=S)),P&&"string"==typeof P.type?"notScheduled"!==P.state&&(P.cancelFn&&P.data.isPeriodic||0===P.runCount)&&("number"==typeof S?delete E[S]:S&&(S[$e]=null),P.zone.cancelTask(P)):w.apply(t,N)})}Zone.__load_patch("legacy",t=>{const a=t[Zone.__symbol__("legacyPatch")];a&&a()}),Zone.__load_patch("queueMicrotask",(t,a,u)=>{u.patchMethod(t,"queueMicrotask",c=>function(f,m){a.current.scheduleMicroTask("queueMicrotask",m[0])})}),Zone.__load_patch("timers",t=>{const a="set",u="clear";Se(t,a,u,"Timeout"),Se(t,a,u,"Interval"),Se(t,a,u,"Immediate")}),Zone.__load_patch("requestAnimationFrame",t=>{Se(t,"request","cancel","AnimationFrame"),Se(t,"mozRequest","mozCancel","AnimationFrame"),Se(t,"webkitRequest","webkitCancel","AnimationFrame")}),Zone.__load_patch("blocking",(t,a)=>{const u=["alert","prompt","confirm"];for(let c=0;c<u.length;c++)ae(t,u[c],(m,E,v)=>function(C,w){return a.current.run(m,t,w,v)})}),Zone.__load_patch("EventTarget",(t,a,u)=>{(function(t,a){a.patchEventPrototype(t,a)})(t,u),function(t,a){if(Zone[a.symbol("patchEventTarget")])return;const{eventNames:u,zoneSymbolEventNames:c,TRUE_STR:f,FALSE_STR:m,ZONE_SYMBOL_PREFIX:E}=a.getGlobalObjects();for(let C=0;C<u.length;C++){const w=u[C],S=E+(w+m),P=E+(w+f);c[w]={},c[w][m]=S,c[w][f]=P}const v=t.EventTarget;v&&v.prototype&&a.patchEventTarget(t,[v&&v.prototype])}(t,u);const c=t.XMLHttpRequestEventTarget;c&&c.prototype&&u.patchEventTarget(t,[c.prototype])}),Zone.__load_patch("MutationObserver",(t,a,u)=>{we("MutationObserver"),we("WebKitMutationObserver")}),Zone.__load_patch("IntersectionObserver",(t,a,u)=>{we("IntersectionObserver")}),Zone.__load_patch("FileReader",(t,a,u)=>{we("FileReader")}),Zone.__load_patch("on_property",(t,a,u)=>{!function(t,a){if(re&&!Ge||Zone[t.symbol("patchEvents")])return;const u="undefined"!=typeof WebSocket,c=a.__Zone_ignore_on_properties;if(ht){const E=window,v=function(){try{const t=ke.navigator.userAgent;if(-1!==t.indexOf("MSIE ")||-1!==t.indexOf("Trident/"))return!0}catch(t){}return!1}()?[{target:E,ignoreProperties:["error"]}]:[];Y(E,Oe.concat(["messageerror"]),c&&c.concat(v),ye(E)),Y(Document.prototype,Oe,c),void 0!==E.SVGElement&&Y(E.SVGElement.prototype,Oe,c),Y(Element.prototype,Oe,c),Y(HTMLElement.prototype,Oe,c),Y(HTMLMediaElement.prototype,st,c),Y(HTMLFrameSetElement.prototype,Et.concat(De),c),Y(HTMLBodyElement.prototype,Et.concat(De),c),Y(HTMLFrameElement.prototype,le,c),Y(HTMLIFrameElement.prototype,le,c);const C=E.HTMLMarqueeElement;C&&Y(C.prototype,Te,c);const w=E.Worker;w&&Y(w.prototype,Re,c)}const f=a.XMLHttpRequest;f&&Y(f.prototype,it,c);const m=a.XMLHttpRequestEventTarget;m&&Y(m&&m.prototype,it,c),"undefined"!=typeof IDBIndex&&(Y(IDBIndex.prototype,Pe,c),Y(IDBRequest.prototype,Pe,c),Y(IDBOpenDBRequest.prototype,Pe,c),Y(IDBDatabase.prototype,Pe,c),Y(IDBTransaction.prototype,Pe,c),Y(IDBCursor.prototype,Pe,c)),u&&Y(WebSocket.prototype,at,c)}(u,t)}),Zone.__load_patch("customElements",(t,a,u)=>{!function(t,a){const{isBrowser:u,isMix:c}=a.getGlobalObjects();(u||c)&&t.customElements&&"customElements"in t&&a.patchCallbacks(a,t.customElements,"customElements","define",["connectedCallback","disconnectedCallback","adoptedCallback","attributeChangedCallback"])}(t,u)}),Zone.__load_patch("XHR",(t,a)=>{!function(w){const b=w.XMLHttpRequest;if(!b)return;const N=b.prototype;let P=N[Ue],z=N[et];if(!P){const O=w.XMLHttpRequestEventTarget;if(O){const j=O.prototype;P=j[Ue],z=j[et]}}const x="readystatechange",L="scheduled";function T(O){const j=O.data,H=j.target;H[m]=!1,H[v]=!1;const oe=H[f];P||(P=H[Ue],z=H[et]),oe&&z.call(H,x,oe);const _e=H[f]=()=>{if(H.readyState===H.DONE)if(!j.aborted&&H[m]&&O.state===L){const ue=H[a.__symbol__("loadfalse")];if(0!==H.status&&ue&&ue.length>0){const fe=O.invoke;O.invoke=function(){const X=H[a.__symbol__("loadfalse")];for(let I=0;I<X.length;I++)X[I]===O&&X.splice(I,1);!j.aborted&&O.state===L&&fe.call(O)},ue.push(O)}else O.invoke()}else!j.aborted&&!1===H[m]&&(H[v]=!0)};return P.call(H,x,_e),H[u]||(H[u]=O),F.apply(H,j.args),H[m]=!0,O}function Z(){}function W(O){const j=O.data;return j.aborted=!0,$.apply(j.target,j.args)}const B=ae(N,"open",()=>function(O,j){return O[c]=0==j[2],O[E]=j[1],B.apply(O,j)}),R=U("fetchTaskAborting"),Q=U("fetchTaskScheduling"),F=ae(N,"send",()=>function(O,j){if(!0===a.current[Q]||O[c])return F.apply(O,j);{const H={target:O,url:O[E],isPeriodic:!1,args:j,aborted:!1},oe=lt("XMLHttpRequest.send",Z,H,T,W);O&&!0===O[v]&&!H.aborted&&oe.state===L&&oe.invoke()}}),$=ae(N,"abort",()=>function(O,j){const H=function(O){return O[u]}(O);if(H&&"string"==typeof H.type){if(null==H.cancelFn||H.data&&H.data.aborted)return;H.zone.cancelTask(H)}else if(!0===a.current[R])return $.apply(O,j)})}(t);const u=U("xhrTask"),c=U("xhrSync"),f=U("xhrListener"),m=U("xhrScheduled"),E=U("xhrURL"),v=U("xhrErrorBeforeScheduled")}),Zone.__load_patch("geolocation",t=>{t.navigator&&t.navigator.geolocation&&function(t,a){const u=t.constructor.name;for(let c=0;c<a.length;c++){const f=a[c],m=t[f];if(m){if(!ft(ne(t,f)))continue;t[f]=(v=>{const C=function(){return v.apply(this,tt(arguments,u+"."+f))};return se(C,v),C})(m)}}}(t.navigator.geolocation,["getCurrentPosition","watchPosition"])}),Zone.__load_patch("PromiseRejectionEvent",(t,a)=>{function u(c){return function(f){kt(t,c).forEach(E=>{const v=t.PromiseRejectionEvent;if(v){const C=new v(c,{promise:f.promise,reason:f.rejection});E.invoke(C)}})}}t.PromiseRejectionEvent&&(a[U("unhandledPromiseRejectionHandler")]=u("unhandledrejection"),a[U("rejectionHandledHandler")]=u("rejectionhandled"))})},454:(G,ne,he)=>{"use strict";he(277),he(142),he(138)}},G=>{G(G.s=454)}]);
/*! (C) Andrea Giammarchi - @WebReflection - ISC Style License */
!function(e,t){"use strict";function n(){var e=C.splice(0,C.length);for(We=0;e.length;)e.shift().call(null,e.shift())}function r(e,t){for(var n=0,r=e.length;n<r;n++)p(e[n],t)}function o(e){return function(t){Re(t)&&(p(t,e),le.length&&r(t.querySelectorAll(le),e))}}function l(e){var t=Be.call(e,"is"),n=e.nodeName.toUpperCase(),r=ie.call(re,t?ee+t.toUpperCase():J+n);return t&&-1<r&&!a(n,t)?-1:r}function a(e,t){return-1<le.indexOf(e+'[is="'+t+'"]')}function i(e){var t=e.currentTarget,n=e.attrChange,r=e.attrName,o=e.target,l=e[X]||2,a=e[$]||3;!rt||o&&o!==t||!t[B]||"style"===r||e.prevValue===e.newValue&&(""!==e.newValue||n!==l&&n!==a)||t[B](r,n===l?null:e.prevValue,n===a?null:e.newValue)}function u(e){var t=o(e);return function(e){C.push(t,e.target),We&&clearTimeout(We),We=setTimeout(n,1)}}function c(e){nt&&(nt=!1,e.currentTarget.removeEventListener(W,c)),le.length&&r((e.target||g).querySelectorAll(le),e.detail===x?x:_),Ve&&function(){for(var e,t=0,n=Ue.length;t<n;t++)e=Ue[t],ae.contains(e)||(n--,Ue.splice(t--,1),p(e,x))}()}function s(e,t){var n=this;Ge.call(n,e,t),w.call(n,{target:n})}function m(e,t,n){var r=t.apply(e,n),o=l(r);return-1<o&&F(r,oe[o]),n.pop()&&le.length&&function(e){for(var t,n=0,r=e.length;n<r;n++)t=e[n],F(t,oe[l(t)])}(r.querySelectorAll(le)),r}function f(e,t){De(e,t),N?N.observe(e,$e):(tt&&(e.setAttribute=s,e[R]=O(e),e[U](Y,w)),e[U](Q,i)),e[z]&&rt&&(e.created=!0,e[z](),e.created=!1)}function d(e){throw new Error("A "+e+" type is already registered")}function p(e,t){var n,r,o=l(e);-1<o&&!xe.call(e,"TEMPLATE")&&(I(e,oe[o]),o=0,t!==_||e[_]?t!==x||e[x]||(e[_]=!1,e[x]=!0,r="disconnected",o=1):(e[x]=!1,e[_]=!0,r="connected",o=1,Ve&&ie.call(Ue,e)<0&&Ue.push(e)),o&&(n=e[t+k]||e[r+k])&&n.call(e))}function h(){}function T(e,t,n){var r=n&&n[q]||"",o=t.prototype,l=Ne(o),a=t.observedAttributes||fe,i={prototype:l};Pe(l,z,{value:function(){if(ye)ye=!1;else if(!this[Me]){this[Me]=!0,new t(this),o[z]&&o[z].call(this);var e=Ce[Ae.get(t)];(!ve||e.create.length>1)&&E(this)}}}),Pe(l,B,{value:function(e){-1<ie.call(a,e)&&o[B]&&o[B].apply(this,arguments)}}),o[j]&&Pe(l,Z,{value:o[j]}),o[G]&&Pe(l,K,{value:o[G]}),r&&(i[q]=r),e=e.toUpperCase(),Ce[e]={constructor:t,create:r?[r,Oe(e)]:[e]},Ae.set(t,e),g[V](e.toLowerCase(),i),v(e),we[e].r()}function L(e){var t=Ce[e.toUpperCase()];return t&&t.constructor}function M(e){return"string"==typeof e?e:e&&e.is||""}function E(e){for(var t,n=e[B],r=n?e.attributes:fe,o=r.length;o--;)t=r[o],n.call(e,t.name||t.nodeName,null,t.value||t.nodeValue)}function v(e){return(e=e.toUpperCase())in we||(we[e]={},we[e].p=new be(function(t){we[e].r=t})),we[e].p}function H(){Ee&&delete e.customElements,me(e,"customElements",{configurable:!0,value:new h}),me(e,"CustomElementRegistry",{configurable:!0,value:h});for(var t=y.get(/^HTML[A-Z]*[a-z]/),n=t.length;n--;function(t){var n=e[t];if(n){e[t]=function(e){var t,r;return e||(e=this),e[Me]||(ye=!0,t=Ce[Ae.get(e.constructor)],(e=(r=ve&&1===t.create.length)?Reflect.construct(n,fe,t.constructor):g.createElement.apply(g,t.create))[Me]=!0,ye=!1,r||E(e)),e},e[t].prototype=n.prototype;try{n.prototype.constructor=e[t]}catch(r){!0,me(n,Me,{value:e[t]})}}}(t[n]));g.createElement=function(e,t){var n=M(t);return n?Xe.call(this,e,Oe(n)):Xe.call(this,e)},Ye||(et=!0,g[V](""))}var g=e.document,b=e.Object,y=function(e){var t,n,r,o,l=/^[A-Z]+[a-z]/,a=function(e,t){(t=t.toLowerCase())in i||(i[e]=(i[e]||[]).concat(t),i[t]=i[t.toUpperCase()]=e)},i=(b.create||b)(null),u={};for(n in e)for(o in e[n])for(r=e[n][o],i[o]=r,t=0;t<r.length;t++)i[r[t].toLowerCase()]=i[r[t].toUpperCase()]=o;return u.get=function(e){return"string"==typeof e?i[e]||(l.test(e)?[]:""):function(e){var t,n=[];for(t in i)e.test(t)&&n.push(t);return n}(e)},u.set=function(e,t){return l.test(e)?a(e,t):a(t,e),u},u}({collections:{HTMLAllCollection:["all"],HTMLCollection:["forms"],HTMLFormControlsCollection:["elements"],HTMLOptionsCollection:["options"]},elements:{Element:["element"],HTMLAnchorElement:["a"],HTMLAppletElement:["applet"],HTMLAreaElement:["area"],HTMLAttachmentElement:["attachment"],HTMLAudioElement:["audio"],HTMLBRElement:["br"],HTMLBaseElement:["base"],HTMLBodyElement:["body"],HTMLButtonElement:["button"],HTMLCanvasElement:["canvas"],HTMLContentElement:["content"],HTMLDListElement:["dl"],HTMLDataElement:["data"],HTMLDataListElement:["datalist"],HTMLDetailsElement:["details"],HTMLDialogElement:["dialog"],HTMLDirectoryElement:["dir"],HTMLDivElement:["div"],HTMLDocument:["document"],HTMLElement:["element","abbr","address","article","aside","b","bdi","bdo","cite","code","command","dd","dfn","dt","em","figcaption","figure","footer","header","i","kbd","mark","nav","noscript","rp","rt","ruby","s","samp","section","small","strong","sub","summary","sup","u","var","wbr"],HTMLEmbedElement:["embed"],HTMLFieldSetElement:["fieldset"],HTMLFontElement:["font"],HTMLFormElement:["form"],HTMLFrameElement:["frame"],HTMLFrameSetElement:["frameset"],HTMLHRElement:["hr"],HTMLHeadElement:["head"],HTMLHeadingElement:["h1","h2","h3","h4","h5","h6"],HTMLHtmlElement:["html"],HTMLIFrameElement:["iframe"],HTMLImageElement:["img"],HTMLInputElement:["input"],HTMLKeygenElement:["keygen"],HTMLLIElement:["li"],HTMLLabelElement:["label"],HTMLLegendElement:["legend"],HTMLLinkElement:["link"],HTMLMapElement:["map"],HTMLMarqueeElement:["marquee"],HTMLMediaElement:["media"],HTMLMenuElement:["menu"],HTMLMenuItemElement:["menuitem"],HTMLMetaElement:["meta"],HTMLMeterElement:["meter"],HTMLModElement:["del","ins"],HTMLOListElement:["ol"],HTMLObjectElement:["object"],HTMLOptGroupElement:["optgroup"],HTMLOptionElement:["option"],HTMLOutputElement:["output"],HTMLParagraphElement:["p"],HTMLParamElement:["param"],HTMLPictureElement:["picture"],HTMLPreElement:["pre"],HTMLProgressElement:["progress"],HTMLQuoteElement:["blockquote","q","quote"],HTMLScriptElement:["script"],HTMLSelectElement:["select"],HTMLShadowElement:["shadow"],HTMLSlotElement:["slot"],HTMLSourceElement:["source"],HTMLSpanElement:["span"],HTMLStyleElement:["style"],HTMLTableCaptionElement:["caption"],HTMLTableCellElement:["td","th"],HTMLTableColElement:["col","colgroup"],HTMLTableElement:["table"],HTMLTableRowElement:["tr"],HTMLTableSectionElement:["thead","tbody","tfoot"],HTMLTemplateElement:["template"],HTMLTextAreaElement:["textarea"],HTMLTimeElement:["time"],HTMLTitleElement:["title"],HTMLTrackElement:["track"],HTMLUListElement:["ul"],HTMLUnknownElement:["unknown","vhgroupv","vkeygen"],HTMLVideoElement:["video"]},nodes:{Attr:["node"],Audio:["audio"],CDATASection:["node"],CharacterData:["node"],Comment:["#comment"],Document:["#document"],DocumentFragment:["#document-fragment"],DocumentType:["node"],HTMLDocument:["#document"],Image:["img"],Option:["option"],ProcessingInstruction:["node"],ShadowRoot:["#shadow-root"],Text:["#text"],XMLDocument:["xml"]}});"object"!=typeof t&&(t={type:t||"auto"});var C,w,A,O,N,D,I,F,S,V="registerElement",P=1e5*e.Math.random()>>0,R="__"+V+P,U="addEventListener",_="attached",k="Callback",x="detached",q="extends",B="attributeChanged"+k,Z=_+k,j="connected"+k,G="disconnected"+k,z="created"+k,K=x+k,X="ADDITION",$="REMOVAL",Q="DOMAttrModified",W="DOMContentLoaded",Y="DOMSubtreeModified",J="<",ee="=",te=/^[A-Z][._A-Z0-9]*-[-._A-Z0-9]*$/,ne=["ANNOTATION-XML","COLOR-PROFILE","FONT-FACE","FONT-FACE-SRC","FONT-FACE-URI","FONT-FACE-FORMAT","FONT-FACE-NAME","MISSING-GLYPH"],re=[],oe=[],le="",ae=g.documentElement,ie=re.indexOf||function(e){for(var t=this.length;t--&&this[t]!==e;);return t},ue=b.prototype,ce=ue.hasOwnProperty,se=ue.isPrototypeOf,me=b.defineProperty,fe=[],de=b.getOwnPropertyDescriptor,pe=b.getOwnPropertyNames,he=b.getPrototypeOf,Te=b.setPrototypeOf,Le=!!b.__proto__,Me="__dreCEv1",Ee=e.customElements,ve=!/^force/.test(t.type)&&!!(Ee&&Ee.define&&Ee.get&&Ee.whenDefined),He=b.create||b,ge=e.Map||function(){var e,t=[],n=[];return{get:function(e){return n[ie.call(t,e)]},set:function(r,o){(e=ie.call(t,r))<0?n[t.push(r)-1]=o:n[e]=o}}},be=e.Promise||function(e){function t(e){for(r=!0;n.length;)n.shift()(e)}var n=[],r=!1,o={catch:function(){return o},then:function(e){return n.push(e),r&&setTimeout(t,1),o}};return e(t),o},ye=!1,Ce=He(null),we=He(null),Ae=new ge,Oe=function(e){return e.toLowerCase()},Ne=b.create||function e(t){return t?(e.prototype=t,new e):this},De=Te||(Le?function(e,t){return e.__proto__=t,e}:pe&&de?function(){function e(e,t){for(var n,r=pe(t),o=0,l=r.length;o<l;o++)n=r[o],ce.call(e,n)||me(e,n,de(t,n))}return function(t,n){do{e(t,n)}while((n=he(n))&&!se.call(n,t));return t}}():function(e,t){for(var n in t)e[n]=t[n];return e}),Ie=e.MutationObserver||e.WebKitMutationObserver,Fe=e.HTMLAnchorElement,Se=(e.HTMLElement||e.Element||e.Node).prototype,Ve=!se.call(Se,ae),Pe=Ve?function(e,t,n){return e[t]=n.value,e}:me,Re=Ve?function(e){return 1===e.nodeType}:function(e){return se.call(Se,e)},Ue=Ve&&[],_e=Se.attachShadow,ke=Se.cloneNode,xe=Se.closest||function(e){for(var t=this;t&&t.nodeName!==e;)t=t.parentNode;return t},qe=Se.dispatchEvent,Be=Se.getAttribute,Ze=Se.hasAttribute,je=Se.removeAttribute,Ge=Se.setAttribute,ze=g.createElement,Ke=g.importNode,Xe=ze,$e=Ie&&{attributes:!0,characterData:!0,attributeOldValue:!0},Qe=Ie||function(e){tt=!1,ae.removeEventListener(Q,Qe)},We=0,Ye=V in g&&!/^force-all/.test(t.type),Je=!0,et=!1,tt=!0,nt=!0,rt=!0;if(Ie&&((S=g.createElement("div")).innerHTML="<div><div></div></div>",new Ie(function(e,t){if(e[0]&&"childList"==e[0].type&&!e[0].removedNodes[0].childNodes.length){var n=(S=de(Se,"innerHTML"))&&S.set;n&&me(Se,"innerHTML",{set:function(e){for(;this.lastChild;)this.removeChild(this.lastChild);n.call(this,e)}})}t.disconnect(),S=null}).observe(S,{childList:!0,subtree:!0}),S.innerHTML=""),Ye||(Te||Le?(I=function(e,t){se.call(t,e)||f(e,t)},F=f):F=I=function(e,t){e[R]||(e[R]=b(!0),f(e,t))},Ve?(tt=!1,function(){var e=de(Se,U),t=e.value,n=function(e){var t=new CustomEvent(Q,{bubbles:!0});t.attrName=e,t.prevValue=Be.call(this,e),t.newValue=null,t[$]=t.attrChange=2,je.call(this,e),qe.call(this,t)},r=function(e,t){var n=Ze.call(this,e),r=n&&Be.call(this,e),o=new CustomEvent(Q,{bubbles:!0});Ge.call(this,e,t),o.attrName=e,o.prevValue=n?r:null,o.newValue=t,n?o.MODIFICATION=o.attrChange=1:o[X]=o.attrChange=0,qe.call(this,o)},o=function(e){var t,n=e.currentTarget,r=n[R],o=e.propertyName;r.hasOwnProperty(o)&&(r=r[o],(t=new CustomEvent(Q,{bubbles:!0})).attrName=r.name,t.prevValue=r.value||null,t.newValue=r.value=n[o]||null,null==t.prevValue?t[X]=t.attrChange=0:t.MODIFICATION=t.attrChange=1,qe.call(n,t))};e.value=function(e,l,a){e===Q&&this[B]&&this.setAttribute!==r&&(this[R]={className:{name:"class",value:this.className}},this.setAttribute=r,this.removeAttribute=n,t.call(this,"propertychange",o)),t.call(this,e,l,a)},me(Se,U,e)}()):Ie||(ae[U](Q,Qe),ae.setAttribute(R,1),ae.removeAttribute(R),tt&&(w=function(e){var t,n,r,o=this;if(o===e.target){for(r in t=o[R],o[R]=n=O(o),n){if(!(r in t))return A(0,o,r,t[r],n[r],X);if(n[r]!==t[r])return A(1,o,r,t[r],n[r],"MODIFICATION")}for(r in t)if(!(r in n))return A(2,o,r,t[r],n[r],$)}},A=function(e,t,n,r,o,l){var a={attrChange:e,currentTarget:t,attrName:n,prevValue:r,newValue:o};a[l]=e,i(a)},O=function(e){for(var t,n,r={},o=e.attributes,l=0,a=o.length;l<a;l++)"setAttribute"!==(n=(t=o[l]).name)&&(r[n]=t.value);return r})),g[V]=function(e,t){if(n=e.toUpperCase(),Je&&(Je=!1,Ie?(N=function(e,t){function n(e,t){for(var n=0,r=e.length;n<r;t(e[n++]));}return new Ie(function(r){for(var o,l,a,i=0,u=r.length;i<u;i++)"childList"===(o=r[i]).type?(n(o.addedNodes,e),n(o.removedNodes,t)):(l=o.target,rt&&l[B]&&"style"!==o.attributeName&&(a=Be.call(l,o.attributeName))!==o.oldValue&&l[B](o.attributeName,o.oldValue,a))})}(o(_),o(x)),(D=function(e){return N.observe(e,{childList:!0,subtree:!0}),e})(g),_e&&(Se.attachShadow=function(){return D(_e.apply(this,arguments))})):(C=[],g[U]("DOMNodeInserted",u(_)),g[U]("DOMNodeRemoved",u(x))),g[U](W,c),g[U]("readystatechange",c),g.importNode=function(e,t){switch(e.nodeType){case 1:return m(g,Ke,[e,!!t]);case 11:for(var n=g.createDocumentFragment(),r=e.childNodes,o=r.length,l=0;l<o;l++)n.appendChild(g.importNode(r[l],!!t));return n;default:return ke.call(e,!!t)}},Se.cloneNode=function(e){return m(this,ke,[!!e])}),et)return et=!1;if(-2<ie.call(re,ee+n)+ie.call(re,J+n)&&d(e),!te.test(n)||-1<ie.call(ne,n))throw new Error("The type "+e+" is invalid");var n,l,a=function(){return s?g.createElement(f,n):g.createElement(f)},i=t||ue,s=ce.call(i,q),f=s?t[q].toUpperCase():n;return s&&-1<ie.call(re,J+f)&&d(f),l=re.push((s?ee:J)+n)-1,le=le.concat(le.length?",":"",s?f+'[is="'+e.toLowerCase()+'"]':f),a.prototype=oe[l]=ce.call(i,"prototype")?i.prototype:Ne(Se),le.length&&r(g.querySelectorAll(le),_),a},g.createElement=Xe=function(e,t){var n=M(t),r=n?ze.call(g,e,Oe(n)):ze.call(g,e),o=""+e,l=ie.call(re,(n?ee:J)+(n||o).toUpperCase()),i=-1<l;return n&&(r.setAttribute("is",n=n.toLowerCase()),i&&(i=a(o.toUpperCase(),n))),rt=!g.createElement.innerHTMLHelper,i&&F(r,oe[l]),r}),addEventListener("beforeunload",function(){delete g.createElement,delete g.importNode,delete g[V]},!1),h.prototype={constructor:h,define:ve?function(e,t,n){if(n)T(e,t,n);else{var r=e.toUpperCase();Ce[r]={constructor:t,create:[r]},Ae.set(t,r),Ee.define(e,t)}}:T,get:ve?function(e){return Ee.get(e)||L(e)}:L,whenDefined:ve?function(e){return be.race([Ee.whenDefined(e),v(e)])}:v},!Ee||/^force/.test(t.type))H();else if(!t.noBuiltIn)try{!function(t,n,r){var o=new RegExp("^<a\\s+is=('|\")"+r+"\\1></a>$");if(n[q]="a",(t.prototype=Ne(Fe.prototype)).constructor=t,e.customElements.define(r,t,n),!o.test(g.createElement("a",{is:r}).outerHTML)||!o.test((new t).outerHTML))throw n}(function e(){return Reflect.construct(Fe,[],e)},{},"document-register-element-a"+P)}catch(e){H()}if(!t.noBuiltIn)try{if(ze.call(g,"a","a").outerHTML.indexOf("is")<0)throw{}}catch(e){Oe=function(e){return{is:e.toLowerCase()}}}}(window);
var QNe=Object.defineProperty,ZNe=Object.defineProperties,JNe=Object.getOwnPropertyDescriptors,n1=Object.getOwnPropertySymbols,d9=Object.prototype.hasOwnProperty,h9=Object.prototype.propertyIsEnumerable,_r=Math.pow,f9=(Vt,it,nt)=>it in Vt?QNe(Vt,it,{enumerable:!0,configurable:!0,writable:!0,value:nt}):Vt[it]=nt,dt=(Vt,it)=>{for(var nt in it||(it={}))d9.call(it,nt)&&f9(Vt,nt,it[nt]);if(n1)for(var nt of n1(it))h9.call(it,nt)&&f9(Vt,nt,it[nt]);return Vt},Hn=(Vt,it)=>ZNe(Vt,JNe(it)),p9=(Vt,it)=>{var nt={};for(var mt in Vt)d9.call(Vt,mt)&&it.indexOf(mt)<0&&(nt[mt]=Vt[mt]);if(null!=Vt&&n1)for(var mt of n1(Vt))it.indexOf(mt)<0&&h9.call(Vt,mt)&&(nt[mt]=Vt[mt]);return nt};(self.webpackChunkccf_ui=self.webpackChunkccf_ui||[]).push([[179],{440:(Vt,it,nt)=>{var mt=nt(52).default;Vt.exports=function K(Me,pe,Y){function U(W,b){if(!pe[W]){if(!Me[W]){if(k)return k(W,!0);var P=new Error("Cannot find module '"+W+"'");throw P.code="MODULE_NOT_FOUND",P}var M=pe[W]={exports:{}};Me[W][0].call(M.exports,function(v){return U(Me[W][1][v]||v)},M,M.exports,K,Me,pe,Y)}return pe[W].exports}for(var k=void 0,ie=0;ie<Y.length;ie++)U(Y[ie]);return U}({1:[function(K,Me,pe){var Y,U;Y=this,U=function(Y,U,k,ie,W){"use strict";function T(Te,je,qe,Ne){return new(qe||(qe=Promise))(function(z,fe){function de(ft){try{gt(Ne.next(ft))}catch(be){fe(be)}}function Ve(ft){try{gt(Ne.throw(ft))}catch(be){fe(be)}}function gt(ft){ft.done?z(ft.value):function(z){return z instanceof qe?z:new qe(function(fe){fe(z)})}(ft.value).then(de,Ve)}gt((Ne=Ne.apply(Te,je||[])).next())})}function j(Te,je){var Ne,$,z,fe,qe={label:0,sent:function(){if(1&z[0])throw z[1];return z[1]},trys:[],ops:[]};return fe={next:de(0),throw:de(1),return:de(2)},"function"==typeof Symbol&&(fe[Symbol.iterator]=function(){return this}),fe;function de(gt){return function(ft){return function(gt){if(Ne)throw new TypeError("Generator is already executing.");for(;qe;)try{if(Ne=1,$&&(z=2&gt[0]?$.return:gt[0]?$.throw||((z=$.return)&&z.call($),0):$.next)&&!(z=z.call($,gt[1])).done)return z;switch($=0,z&&(gt=[2&gt[0],z.value]),gt[0]){case 0:case 1:z=gt;break;case 4:return qe.label++,{value:gt[1],done:!1};case 5:qe.label++,$=gt[1],gt=[0];continue;case 7:gt=qe.ops.pop(),qe.trys.pop();continue;default:if(!(z=(z=qe.trys).length>0&&z[z.length-1])&&(6===gt[0]||2===gt[0])){qe=0;continue}if(3===gt[0]&&(!z||gt[1]>z[0]&&gt[1]<z[3])){qe.label=gt[1];break}if(6===gt[0]&&qe.label<z[1]){qe.label=z[1],z=gt;break}if(z&&qe.label<z[2]){qe.label=z[2],qe.ops.push(gt);break}z[2]&&qe.ops.pop(),qe.trys.pop();continue}gt=je.call(Te,qe)}catch(ft){gt=[6,ft],$=0}finally{Ne=z=0}if(5&gt[0])throw gt[1];return{value:gt[0]?gt[1]:void 0,done:!0}}([gt,ft])}}}function Qe(Te){var je=Te.length,qe=0;return new W.Readable({objectMode:!0,read:function(){this.push(qe<je?Te[qe++]:null)}})}Y.addJsonLdToStore=function(Te,je){return T(this,void 0,void 0,function(){var qe,Ne,$;return j(this,function(z){switch(z.label){case 0:return"string"!=typeof Te?[3,4]:[4,fetch(Te,{redirect:"follow"})];case 1:return(Ne=z.sent()).ok?[4,Ne.json()]:[3,3];case 2:qe=z.sent(),z.label=3;case 3:return[3,5];case 4:qe=Te,z.label=5;case 5:return qe?[4,U.toRDF(qe)]:[3,7];case 6:$=z.sent(),je.import(Qe($)),z.label=7;case 7:return[2,je]}})})},Y.addN3ToStore=function(Te,je){return T(this,void 0,void 0,function(){var qe,Ne,$;return j(this,function(z){switch(z.label){case 0:return"string"==typeof Te&&(null==Te?void 0:Te.startsWith("http"))?[4,fetch(Te,{redirect:"follow"})]:[3,4];case 1:return(Ne=z.sent()).ok?[4,Ne.text()]:[3,3];case 2:qe=z.sent(),z.label=3;case 3:return[3,5];case 4:qe=Te,z.label=5;case 5:return qe&&($=new k.Parser({format:"n3"}).parse(qe),je.import(Qe($))),[2,je]}})})},Y.addRdfXmlToStore=function(Te,je){return T(this,void 0,void 0,function(){var qe,Ne,$,z;return j(this,function(fe){switch(fe.label){case 0:return"string"==typeof Te&&(null==Te?void 0:Te.startsWith("http"))?[4,fetch(Te,{redirect:"follow"})]:[3,4];case 1:return(Ne=fe.sent()).ok?[4,Ne.text()]:[3,3];case 2:qe=fe.sent(),fe.label=3;case 3:return[3,5];case 4:qe=Te,fe.label=5;case 5:return qe?($=new ie.RdfXmlParser({dataFactory:k.DataFactory,strict:!0}),z=new Promise(function(de){$.once("end",function(){return de(je)})}),je.import($),$.write(qe),$.end(),[2,z]):[2,je]}})})},Y.arrayToStream=Qe,Y.deserializeN3Store=function(Te,je){var qe=JSON.parse(Te),Ne=new k.Store;return Object.assign(Ne,qe,{_factory:null!=je?je:k.DataFactory}),Ne},Y.readQuads=function(Te,je,qe,Ne,$){return Te.readQuads(je,qe,Ne,$)},Y.serializeN3Store=function(Te){var je=Object.assign({},Te);return delete je._factory,JSON.stringify(je)},Y.streamToArray=function(Te){return new Promise(function(je,qe){var Ne=[];Te.on("data",function($){Ne.push($)}).once("end",function(){je(Ne)}).once("error",function($){qe($)})})},Object.keys(k).forEach(function(Te){"default"!==Te&&!Y.hasOwnProperty(Te)&&Object.defineProperty(Y,Te,{enumerable:!0,get:function(){return k[Te]}})}),Object.defineProperty(Y,"__esModule",{value:!0})},"object"==typeof pe&&void 0!==Me?U(pe,K("jsonld"),K("n3"),K("rdfxml-streaming-parser"),K("readable-stream")):U((Y="undefined"!=typeof globalThis?globalThis:Y||self).tripleStoreUtils={},Y.jsonld,Y.n3,Y.rdfxmlStreamingParser,Y.readablestream)},{jsonld:26,n3:43,"rdfxml-streaming-parser":64,"readable-stream":81}],2:[function(K,Me,pe){"use strict";pe.byteLength=function(j){var R=C(j),ue=R[1];return 3*(R[0]+ue)/4-ue},pe.toByteArray=function(j){var R,G,q=C(j),ue=q[0],D=q[1],O=new k(function(j,R,q){return 3*(R+q)/4-q}(0,ue,D)),X=0,E=D>0?ue-4:ue;for(G=0;G<E;G+=4)R=U[j.charCodeAt(G)]<<18|U[j.charCodeAt(G+1)]<<12|U[j.charCodeAt(G+2)]<<6|U[j.charCodeAt(G+3)],O[X++]=R>>16&255,O[X++]=R>>8&255,O[X++]=255&R;return 2===D&&(R=U[j.charCodeAt(G)]<<2|U[j.charCodeAt(G+1)]>>4,O[X++]=255&R),1===D&&(R=U[j.charCodeAt(G)]<<10|U[j.charCodeAt(G+1)]<<4|U[j.charCodeAt(G+2)]>>2,O[X++]=R>>8&255,O[X++]=255&R),O},pe.fromByteArray=function(j){for(var R,q=j.length,ue=q%3,D=[],O=16383,X=0,E=q-ue;X<E;X+=O)D.push(S(j,X,X+O>E?E:X+O));return 1===ue?D.push(Y[(R=j[q-1])>>2]+Y[R<<4&63]+"=="):2===ue&&D.push(Y[(R=(j[q-2]<<8)+j[q-1])>>10]+Y[R>>4&63]+Y[R<<2&63]+"="),D.join("")};for(var Y=[],U=[],k="undefined"!=typeof Uint8Array?Uint8Array:Array,ie="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",W=0,b=ie.length;W<b;++W)Y[W]=ie[W],U[ie.charCodeAt(W)]=W;function C(j){var R=j.length;if(R%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var q=j.indexOf("=");return-1===q&&(q=R),[q,q===R?0:4-q%4]}function y(j){return Y[j>>18&63]+Y[j>>12&63]+Y[j>>6&63]+Y[63&j]}function S(j,R,q){for(var D=[],O=R;O<q;O+=3)D.push(y((j[O]<<16&16711680)+(j[O+1]<<8&65280)+(255&j[O+2])));return D.join("")}U["-".charCodeAt(0)]=62,U["_".charCodeAt(0)]=63},{}],3:[function(K,Me,pe){},{}],4:[function(K,Me,pe){var Y=K("buffer"),U=Y.Buffer;function k(W,b){for(var C in W)b[C]=W[C]}function ie(W,b,C){return U(W,b,C)}U.from&&U.alloc&&U.allocUnsafe&&U.allocUnsafeSlow?Me.exports=Y:(k(Y,pe),pe.Buffer=ie),k(U,ie),ie.from=function(W,b,C){if("number"==typeof W)throw new TypeError("Argument must not be a number");return U(W,b,C)},ie.alloc=function(W,b,C){if("number"!=typeof W)throw new TypeError("Argument must be a number");var P=U(W);return void 0!==b?"string"==typeof C?P.fill(b,C):P.fill(b):P.fill(0),P},ie.allocUnsafe=function(W){if("number"!=typeof W)throw new TypeError("Argument must be a number");return U(W)},ie.allocUnsafeSlow=function(W){if("number"!=typeof W)throw new TypeError("Argument must be a number");return Y.SlowBuffer(W)}},{buffer:6}],5:[function(K,Me,pe){"use strict";var Y=K("safe-buffer").Buffer,U=Y.isEncoding||function(D){switch((D=""+D)&&D.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function W(D){var O;switch(this.encoding=function(D){var O=function(D){if(!D)return"utf8";for(var O;;)switch(D){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return D;default:if(O)return;D=(""+D).toLowerCase(),O=!0}}(D);if("string"!=typeof O&&(Y.isEncoding===U||!U(D)))throw new Error("Unknown encoding: "+D);return O||D}(D),this.encoding){case"utf16le":this.text=S,this.end=T,O=4;break;case"utf8":this.fillLast=M,O=4;break;case"base64":this.text=j,this.end=R,O=3;break;default:return this.write=q,void(this.end=ue)}this.lastNeed=0,this.lastTotal=0,this.lastChar=Y.allocUnsafe(O)}function b(D){return D<=127?0:D>>5==6?2:D>>4==14?3:D>>3==30?4:D>>6==2?-1:-2}function M(D){var O=this.lastTotal-this.lastNeed,X=function(D,O,X){if(128!=(192&O[0]))return D.lastNeed=0,"\ufffd";if(D.lastNeed>1&&O.length>1){if(128!=(192&O[1]))return D.lastNeed=1,"\ufffd";if(D.lastNeed>2&&O.length>2&&128!=(192&O[2]))return D.lastNeed=2,"\ufffd"}}(this,D);return void 0!==X?X:this.lastNeed<=D.length?(D.copy(this.lastChar,O,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(D.copy(this.lastChar,O,0,D.length),void(this.lastNeed-=D.length))}function S(D,O){if((D.length-O)%2==0){var X=D.toString("utf16le",O);if(X){var E=X.charCodeAt(X.length-1);if(E>=55296&&E<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=D[D.length-2],this.lastChar[1]=D[D.length-1],X.slice(0,-1)}return X}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=D[D.length-1],D.toString("utf16le",O,D.length-1)}function T(D){var O=D&&D.length?this.write(D):"";return this.lastNeed?O+this.lastChar.toString("utf16le",0,this.lastTotal-this.lastNeed):O}function j(D,O){var X=(D.length-O)%3;return 0===X?D.toString("base64",O):(this.lastNeed=3-X,this.lastTotal=3,1===X?this.lastChar[0]=D[D.length-1]:(this.lastChar[0]=D[D.length-2],this.lastChar[1]=D[D.length-1]),D.toString("base64",O,D.length-X))}function R(D){var O=D&&D.length?this.write(D):"";return this.lastNeed?O+this.lastChar.toString("base64",0,3-this.lastNeed):O}function q(D){return D.toString(this.encoding)}function ue(D){return D&&D.length?this.write(D):""}pe.StringDecoder=W,W.prototype.write=function(D){if(0===D.length)return"";var O,X;if(this.lastNeed){if(void 0===(O=this.fillLast(D)))return"";X=this.lastNeed,this.lastNeed=0}else X=0;return X<D.length?O?O+this.text(D,X):this.text(D,X):O||""},W.prototype.end=function(D){var O=D&&D.length?this.write(D):"";return this.lastNeed?O+"\ufffd":O},W.prototype.text=function(D,O){var X=function(D,O,X){var E=O.length-1;if(E<X)return 0;var G=b(O[E]);return G>=0?(G>0&&(D.lastNeed=G-1),G):--E<X||-2===G?0:(G=b(O[E]))>=0?(G>0&&(D.lastNeed=G-2),G):--E<X||-2===G?0:(G=b(O[E]))>=0?(G>0&&(2===G?G=0:D.lastNeed=G-3),G):0}(this,D,O);if(!this.lastNeed)return D.toString("utf8",O);this.lastTotal=X;var E=D.length-(X-this.lastNeed);return D.copy(this.lastChar,0,E),D.toString("utf8",O,E)},W.prototype.fillLast=function(D){if(this.lastNeed<=D.length)return D.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);D.copy(this.lastChar,this.lastTotal-this.lastNeed,0,D.length),this.lastNeed-=D.length}},{"safe-buffer":4}],6:[function(K,Me,pe){(function(Y){(function(){"use strict";var U=K("base64-js"),k=K("ieee754");pe.Buffer=C,pe.SlowBuffer=function(B){return+B!=B&&(B=0),C.alloc(+B)},pe.INSPECT_MAX_BYTES=50;var ie=2147483647;function b(B){if(B>ie)throw new RangeError('The value "'+B+'" is invalid for option "size"');var N=new Uint8Array(B);return N.__proto__=C.prototype,N}function C(B,N,V){if("number"==typeof B){if("string"==typeof N)throw new TypeError('The "string" argument must be of type string. Received type number');return y(B)}return P(B,N,V)}function P(B,N,V){if("string"==typeof B)return function(B,N){if(("string"!=typeof N||""===N)&&(N="utf8"),!C.isEncoding(N))throw new TypeError("Unknown encoding: "+N);var V=0|D(B,N),Re=b(V),Ze=Re.write(B,N);return Ze!==V&&(Re=Re.slice(0,Ze)),Re}(B,N);if(ArrayBuffer.isView(B))return T(B);if(null==B)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof B);if(ft(B,ArrayBuffer)||B&&ft(B.buffer,ArrayBuffer))return function(B,N,V){if(N<0||B.byteLength<N)throw new RangeError('"offset" is outside of buffer bounds');if(B.byteLength<N+(V||0))throw new RangeError('"length" is outside of buffer bounds');var Re;return(Re=void 0===N&&void 0===V?new Uint8Array(B):void 0===V?new Uint8Array(B,N):new Uint8Array(B,N,V)).__proto__=C.prototype,Re}(B,N,V);if("number"==typeof B)throw new TypeError('The "value" argument must not be of type number. Received type number');var Re=B.valueOf&&B.valueOf();if(null!=Re&&Re!==B)return C.from(Re,N,V);var Ze=function(B){if(C.isBuffer(B)){var N=0|q(B.length),V=b(N);return 0===V.length||B.copy(V,0,0,N),V}return void 0!==B.length?"number"!=typeof B.length||be(B.length)?b(0):T(B):"Buffer"===B.type&&Array.isArray(B.data)?T(B.data):void 0}(B);if(Ze)return Ze;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof B[Symbol.toPrimitive])return C.from(B[Symbol.toPrimitive]("string"),N,V);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof B)}function M(B){if("number"!=typeof B)throw new TypeError('"size" argument must be of type number');if(B<0)throw new RangeError('The value "'+B+'" is invalid for option "size"')}function y(B){return M(B),b(B<0?0:0|q(B))}function T(B){for(var N=B.length<0?0:0|q(B.length),V=b(N),Re=0;Re<N;Re+=1)V[Re]=255&B[Re];return V}function q(B){if(B>=ie)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+ie.toString(16)+" bytes");return 0|B}function D(B,N){if(C.isBuffer(B))return B.length;if(ArrayBuffer.isView(B)||ft(B,ArrayBuffer))return B.byteLength;if("string"!=typeof B)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof B);var V=B.length,Re=arguments.length>2&&!0===arguments[2];if(!Re&&0===V)return 0;for(var Ze=!1;;)switch(N){case"ascii":case"latin1":case"binary":return V;case"utf8":case"utf-8":return z(B).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*V;case"hex":return V>>>1;case"base64":return Ve(B).length;default:if(Ze)return Re?-1:z(B).length;N=(""+N).toLowerCase(),Ze=!0}}function O(B,N,V){var Re=!1;if((void 0===N||N<0)&&(N=0),N>this.length||((void 0===V||V>this.length)&&(V=this.length),V<=0)||(V>>>=0)<=(N>>>=0))return"";for(B||(B="utf8");;)switch(B){case"hex":return et(this,N,V);case"utf8":case"utf-8":return _e(this,N,V);case"ascii":return st(this,N,V);case"latin1":case"binary":return Qe(this,N,V);case"base64":return te(this,N,V);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ke(this,N,V);default:if(Re)throw new TypeError("Unknown encoding: "+B);B=(B+"").toLowerCase(),Re=!0}}function X(B,N,V){var Re=B[N];B[N]=B[V],B[V]=Re}function E(B,N,V,Re,Ze){if(0===B.length)return-1;if("string"==typeof V?(Re=V,V=0):V>2147483647?V=2147483647:V<-2147483648&&(V=-2147483648),be(V=+V)&&(V=Ze?0:B.length-1),V<0&&(V=B.length+V),V>=B.length){if(Ze)return-1;V=B.length-1}else if(V<0){if(!Ze)return-1;V=0}if("string"==typeof N&&(N=C.from(N,Re)),C.isBuffer(N))return 0===N.length?-1:G(B,N,V,Re,Ze);if("number"==typeof N)return N&=255,"function"==typeof Uint8Array.prototype.indexOf?Ze?Uint8Array.prototype.indexOf.call(B,N,V):Uint8Array.prototype.lastIndexOf.call(B,N,V):G(B,[N],V,Re,Ze);throw new TypeError("val must be string, number or Buffer")}function G(B,N,V,Re,Ze){var Gn,bt=1,Rt=B.length,Mn=N.length;if(void 0!==Re&&("ucs2"===(Re=String(Re).toLowerCase())||"ucs-2"===Re||"utf16le"===Re||"utf-16le"===Re)){if(B.length<2||N.length<2)return-1;bt=2,Rt/=2,Mn/=2,V/=2}function Nn(Ls,fs){return 1===bt?Ls[fs]:Ls.readUInt16BE(fs*bt)}if(Ze){var wi=-1;for(Gn=V;Gn<Rt;Gn++)if(Nn(B,Gn)===Nn(N,-1===wi?0:Gn-wi)){if(-1===wi&&(wi=Gn),Gn-wi+1===Mn)return wi*bt}else-1!==wi&&(Gn-=Gn-wi),wi=-1}else for(V+Mn>Rt&&(V=Rt-Mn),Gn=V;Gn>=0;Gn--){for(var pi=!0,Wr=0;Wr<Mn;Wr++)if(Nn(B,Gn+Wr)!==Nn(N,Wr)){pi=!1;break}if(pi)return Gn}return-1}function Q(B,N,V,Re){V=Number(V)||0;var Ze=B.length-V;Re?(Re=Number(Re))>Ze&&(Re=Ze):Re=Ze;var bt=N.length;Re>bt/2&&(Re=bt/2);for(var Rt=0;Rt<Re;++Rt){var Mn=parseInt(N.substr(2*Rt,2),16);if(be(Mn))return Rt;B[V+Rt]=Mn}return Rt}function ae(B,N,V,Re){return gt(z(N,B.length-V),B,V,Re)}function se(B,N,V,Re){return gt(function(B){for(var N=[],V=0;V<B.length;++V)N.push(255&B.charCodeAt(V));return N}(N),B,V,Re)}function ee(B,N,V,Re){return se(B,N,V,Re)}function xe(B,N,V,Re){return gt(Ve(N),B,V,Re)}function me(B,N,V,Re){return gt(function(B,N){for(var V,Re,bt=[],Rt=0;Rt<B.length&&!((N-=2)<0);++Rt)Re=(V=B.charCodeAt(Rt))>>8,bt.push(V%256),bt.push(Re);return bt}(N,B.length-V),B,V,Re)}function te(B,N,V){return U.fromByteArray(0===N&&V===B.length?B:B.slice(N,V))}function _e(B,N,V){V=Math.min(B.length,V);for(var Re=[],Ze=N;Ze<V;){var Nn,Gn,wi,pi,bt=B[Ze],Rt=null,Mn=bt>239?4:bt>223?3:bt>191?2:1;if(Ze+Mn<=V)switch(Mn){case 1:bt<128&&(Rt=bt);break;case 2:128==(192&(Nn=B[Ze+1]))&&(pi=(31&bt)<<6|63&Nn)>127&&(Rt=pi);break;case 3:Gn=B[Ze+2],128==(192&(Nn=B[Ze+1]))&&128==(192&Gn)&&(pi=(15&bt)<<12|(63&Nn)<<6|63&Gn)>2047&&(pi<55296||pi>57343)&&(Rt=pi);break;case 4:Gn=B[Ze+2],wi=B[Ze+3],128==(192&(Nn=B[Ze+1]))&&128==(192&Gn)&&128==(192&wi)&&(pi=(15&bt)<<18|(63&Nn)<<12|(63&Gn)<<6|63&wi)>65535&&pi<1114112&&(Rt=pi)}null===Rt?(Rt=65533,Mn=1):Rt>65535&&(Re.push((Rt-=65536)>>>10&1023|55296),Rt=56320|1023&Rt),Re.push(Rt),Ze+=Mn}return function(B){var N=B.length;if(N<=4096)return String.fromCharCode.apply(String,B);for(var V="",Re=0;Re<N;)V+=String.fromCharCode.apply(String,B.slice(Re,Re+=4096));return V}(Re)}pe.kMaxLength=ie,!(C.TYPED_ARRAY_SUPPORT=function(){try{var B=new Uint8Array(1);return B.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===B.foo()}catch(N){return!1}}())&&"undefined"!=typeof console&&"function"==typeof console.error&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(C.prototype,"parent",{enumerable:!0,get:function(){if(C.isBuffer(this))return this.buffer}}),Object.defineProperty(C.prototype,"offset",{enumerable:!0,get:function(){if(C.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&C[Symbol.species]===C&&Object.defineProperty(C,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),C.poolSize=8192,C.from=function(B,N,V){return P(B,N,V)},C.prototype.__proto__=Uint8Array.prototype,C.__proto__=Uint8Array,C.alloc=function(B,N,V){return function(B,N,V){return M(B),B<=0?b(B):void 0!==N?"string"==typeof V?b(B).fill(N,V):b(B).fill(N):b(B)}(B,N,V)},C.allocUnsafe=function(B){return y(B)},C.allocUnsafeSlow=function(B){return y(B)},C.isBuffer=function(N){return null!=N&&!0===N._isBuffer&&N!==C.prototype},C.compare=function(N,V){if(ft(N,Uint8Array)&&(N=C.from(N,N.offset,N.byteLength)),ft(V,Uint8Array)&&(V=C.from(V,V.offset,V.byteLength)),!C.isBuffer(N)||!C.isBuffer(V))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(N===V)return 0;for(var Re=N.length,Ze=V.length,bt=0,Rt=Math.min(Re,Ze);bt<Rt;++bt)if(N[bt]!==V[bt]){Re=N[bt],Ze=V[bt];break}return Re<Ze?-1:Ze<Re?1:0},C.isEncoding=function(N){switch(String(N).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},C.concat=function(N,V){if(!Array.isArray(N))throw new TypeError('"list" argument must be an Array of Buffers');if(0===N.length)return C.alloc(0);var Re;if(void 0===V)for(V=0,Re=0;Re<N.length;++Re)V+=N[Re].length;var Ze=C.allocUnsafe(V),bt=0;for(Re=0;Re<N.length;++Re){var Rt=N[Re];if(ft(Rt,Uint8Array)&&(Rt=C.from(Rt)),!C.isBuffer(Rt))throw new TypeError('"list" argument must be an Array of Buffers');Rt.copy(Ze,bt),bt+=Rt.length}return Ze},C.byteLength=D,C.prototype._isBuffer=!0,C.prototype.swap16=function(){var N=this.length;if(N%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var V=0;V<N;V+=2)X(this,V,V+1);return this},C.prototype.swap32=function(){var N=this.length;if(N%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var V=0;V<N;V+=4)X(this,V,V+3),X(this,V+1,V+2);return this},C.prototype.swap64=function(){var N=this.length;if(N%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var V=0;V<N;V+=8)X(this,V,V+7),X(this,V+1,V+6),X(this,V+2,V+5),X(this,V+3,V+4);return this},C.prototype.toLocaleString=C.prototype.toString=function(){var N=this.length;return 0===N?"":0===arguments.length?_e(this,0,N):O.apply(this,arguments)},C.prototype.equals=function(N){if(!C.isBuffer(N))throw new TypeError("Argument must be a Buffer");return this===N||0===C.compare(this,N)},C.prototype.inspect=function(){var N="",V=pe.INSPECT_MAX_BYTES;return N=this.toString("hex",0,V).replace(/(.{2})/g,"$1 ").trim(),this.length>V&&(N+=" ... "),"<Buffer "+N+">"},C.prototype.compare=function(N,V,Re,Ze,bt){if(ft(N,Uint8Array)&&(N=C.from(N,N.offset,N.byteLength)),!C.isBuffer(N))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof N);if(void 0===V&&(V=0),void 0===Re&&(Re=N?N.length:0),void 0===Ze&&(Ze=0),void 0===bt&&(bt=this.length),V<0||Re>N.length||Ze<0||bt>this.length)throw new RangeError("out of range index");if(Ze>=bt&&V>=Re)return 0;if(Ze>=bt)return-1;if(V>=Re)return 1;if(this===N)return 0;for(var Rt=(bt>>>=0)-(Ze>>>=0),Mn=(Re>>>=0)-(V>>>=0),Nn=Math.min(Rt,Mn),Gn=this.slice(Ze,bt),wi=N.slice(V,Re),pi=0;pi<Nn;++pi)if(Gn[pi]!==wi[pi]){Rt=Gn[pi],Mn=wi[pi];break}return Rt<Mn?-1:Mn<Rt?1:0},C.prototype.includes=function(N,V,Re){return-1!==this.indexOf(N,V,Re)},C.prototype.indexOf=function(N,V,Re){return E(this,N,V,Re,!0)},C.prototype.lastIndexOf=function(N,V,Re){return E(this,N,V,Re,!1)},C.prototype.write=function(N,V,Re,Ze){if(void 0===V)Ze="utf8",Re=this.length,V=0;else if(void 0===Re&&"string"==typeof V)Ze=V,Re=this.length,V=0;else{if(!isFinite(V))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");V>>>=0,isFinite(Re)?(Re>>>=0,void 0===Ze&&(Ze="utf8")):(Ze=Re,Re=void 0)}var bt=this.length-V;if((void 0===Re||Re>bt)&&(Re=bt),N.length>0&&(Re<0||V<0)||V>this.length)throw new RangeError("Attempt to write outside buffer bounds");Ze||(Ze="utf8");for(var Rt=!1;;)switch(Ze){case"hex":return Q(this,N,V,Re);case"utf8":case"utf-8":return ae(this,N,V,Re);case"ascii":return se(this,N,V,Re);case"latin1":case"binary":return ee(this,N,V,Re);case"base64":return xe(this,N,V,Re);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return me(this,N,V,Re);default:if(Rt)throw new TypeError("Unknown encoding: "+Ze);Ze=(""+Ze).toLowerCase(),Rt=!0}},C.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function st(B,N,V){var Re="";V=Math.min(B.length,V);for(var Ze=N;Ze<V;++Ze)Re+=String.fromCharCode(127&B[Ze]);return Re}function Qe(B,N,V){var Re="";V=Math.min(B.length,V);for(var Ze=N;Ze<V;++Ze)Re+=String.fromCharCode(B[Ze]);return Re}function et(B,N,V){var Re=B.length;(!N||N<0)&&(N=0),(!V||V<0||V>Re)&&(V=Re);for(var Ze="",bt=N;bt<V;++bt)Ze+=$(B[bt]);return Ze}function Ke(B,N,V){for(var Re=B.slice(N,V),Ze="",bt=0;bt<Re.length;bt+=2)Ze+=String.fromCharCode(Re[bt]+256*Re[bt+1]);return Ze}function Ue(B,N,V){if(B%1!=0||B<0)throw new RangeError("offset is not uint");if(B+N>V)throw new RangeError("Trying to access beyond buffer length")}function Le(B,N,V,Re,Ze,bt){if(!C.isBuffer(B))throw new TypeError('"buffer" argument must be a Buffer instance');if(N>Ze||N<bt)throw new RangeError('"value" argument is out of bounds');if(V+Re>B.length)throw new RangeError("Index out of range")}function Xe(B,N,V,Re,Ze,bt){if(V+Re>B.length)throw new RangeError("Index out of range");if(V<0)throw new RangeError("Index out of range")}function Te(B,N,V,Re,Ze){return N=+N,V>>>=0,Ze||Xe(B,0,V,4),k.write(B,N,V,Re,23,4),V+4}function je(B,N,V,Re,Ze){return N=+N,V>>>=0,Ze||Xe(B,0,V,8),k.write(B,N,V,Re,52,8),V+8}C.prototype.slice=function(N,V){var Re=this.length;(N=~~N)<0?(N+=Re)<0&&(N=0):N>Re&&(N=Re),(V=void 0===V?Re:~~V)<0?(V+=Re)<0&&(V=0):V>Re&&(V=Re),V<N&&(V=N);var Ze=this.subarray(N,V);return Ze.__proto__=C.prototype,Ze},C.prototype.readUIntLE=function(N,V,Re){N>>>=0,V>>>=0,Re||Ue(N,V,this.length);for(var Ze=this[N],bt=1,Rt=0;++Rt<V&&(bt*=256);)Ze+=this[N+Rt]*bt;return Ze},C.prototype.readUIntBE=function(N,V,Re){N>>>=0,V>>>=0,Re||Ue(N,V,this.length);for(var Ze=this[N+--V],bt=1;V>0&&(bt*=256);)Ze+=this[N+--V]*bt;return Ze},C.prototype.readUInt8=function(N,V){return N>>>=0,V||Ue(N,1,this.length),this[N]},C.prototype.readUInt16LE=function(N,V){return N>>>=0,V||Ue(N,2,this.length),this[N]|this[N+1]<<8},C.prototype.readUInt16BE=function(N,V){return N>>>=0,V||Ue(N,2,this.length),this[N]<<8|this[N+1]},C.prototype.readUInt32LE=function(N,V){return N>>>=0,V||Ue(N,4,this.length),(this[N]|this[N+1]<<8|this[N+2]<<16)+16777216*this[N+3]},C.prototype.readUInt32BE=function(N,V){return N>>>=0,V||Ue(N,4,this.length),16777216*this[N]+(this[N+1]<<16|this[N+2]<<8|this[N+3])},C.prototype.readIntLE=function(N,V,Re){N>>>=0,V>>>=0,Re||Ue(N,V,this.length);for(var Ze=this[N],bt=1,Rt=0;++Rt<V&&(bt*=256);)Ze+=this[N+Rt]*bt;return Ze>=(bt*=128)&&(Ze-=Math.pow(2,8*V)),Ze},C.prototype.readIntBE=function(N,V,Re){N>>>=0,V>>>=0,Re||Ue(N,V,this.length);for(var Ze=V,bt=1,Rt=this[N+--Ze];Ze>0&&(bt*=256);)Rt+=this[N+--Ze]*bt;return Rt>=(bt*=128)&&(Rt-=Math.pow(2,8*V)),Rt},C.prototype.readInt8=function(N,V){return N>>>=0,V||Ue(N,1,this.length),128&this[N]?-1*(255-this[N]+1):this[N]},C.prototype.readInt16LE=function(N,V){N>>>=0,V||Ue(N,2,this.length);var Re=this[N]|this[N+1]<<8;return 32768&Re?4294901760|Re:Re},C.prototype.readInt16BE=function(N,V){N>>>=0,V||Ue(N,2,this.length);var Re=this[N+1]|this[N]<<8;return 32768&Re?4294901760|Re:Re},C.prototype.readInt32LE=function(N,V){return N>>>=0,V||Ue(N,4,this.length),this[N]|this[N+1]<<8|this[N+2]<<16|this[N+3]<<24},C.prototype.readInt32BE=function(N,V){return N>>>=0,V||Ue(N,4,this.length),this[N]<<24|this[N+1]<<16|this[N+2]<<8|this[N+3]},C.prototype.readFloatLE=function(N,V){return N>>>=0,V||Ue(N,4,this.length),k.read(this,N,!0,23,4)},C.prototype.readFloatBE=function(N,V){return N>>>=0,V||Ue(N,4,this.length),k.read(this,N,!1,23,4)},C.prototype.readDoubleLE=function(N,V){return N>>>=0,V||Ue(N,8,this.length),k.read(this,N,!0,52,8)},C.prototype.readDoubleBE=function(N,V){return N>>>=0,V||Ue(N,8,this.length),k.read(this,N,!1,52,8)},C.prototype.writeUIntLE=function(N,V,Re,Ze){N=+N,V>>>=0,Re>>>=0,Ze||Le(this,N,V,Re,Math.pow(2,8*Re)-1,0);var Rt=1,Mn=0;for(this[V]=255&N;++Mn<Re&&(Rt*=256);)this[V+Mn]=N/Rt&255;return V+Re},C.prototype.writeUIntBE=function(N,V,Re,Ze){N=+N,V>>>=0,Re>>>=0,Ze||Le(this,N,V,Re,Math.pow(2,8*Re)-1,0);var Rt=Re-1,Mn=1;for(this[V+Rt]=255&N;--Rt>=0&&(Mn*=256);)this[V+Rt]=N/Mn&255;return V+Re},C.prototype.writeUInt8=function(N,V,Re){return N=+N,V>>>=0,Re||Le(this,N,V,1,255,0),this[V]=255&N,V+1},C.prototype.writeUInt16LE=function(N,V,Re){return N=+N,V>>>=0,Re||Le(this,N,V,2,65535,0),this[V]=255&N,this[V+1]=N>>>8,V+2},C.prototype.writeUInt16BE=function(N,V,Re){return N=+N,V>>>=0,Re||Le(this,N,V,2,65535,0),this[V]=N>>>8,this[V+1]=255&N,V+2},C.prototype.writeUInt32LE=function(N,V,Re){return N=+N,V>>>=0,Re||Le(this,N,V,4,4294967295,0),this[V+3]=N>>>24,this[V+2]=N>>>16,this[V+1]=N>>>8,this[V]=255&N,V+4},C.prototype.writeUInt32BE=function(N,V,Re){return N=+N,V>>>=0,Re||Le(this,N,V,4,4294967295,0),this[V]=N>>>24,this[V+1]=N>>>16,this[V+2]=N>>>8,this[V+3]=255&N,V+4},C.prototype.writeIntLE=function(N,V,Re,Ze){if(N=+N,V>>>=0,!Ze){var bt=Math.pow(2,8*Re-1);Le(this,N,V,Re,bt-1,-bt)}var Rt=0,Mn=1,Nn=0;for(this[V]=255&N;++Rt<Re&&(Mn*=256);)N<0&&0===Nn&&0!==this[V+Rt-1]&&(Nn=1),this[V+Rt]=(N/Mn>>0)-Nn&255;return V+Re},C.prototype.writeIntBE=function(N,V,Re,Ze){if(N=+N,V>>>=0,!Ze){var bt=Math.pow(2,8*Re-1);Le(this,N,V,Re,bt-1,-bt)}var Rt=Re-1,Mn=1,Nn=0;for(this[V+Rt]=255&N;--Rt>=0&&(Mn*=256);)N<0&&0===Nn&&0!==this[V+Rt+1]&&(Nn=1),this[V+Rt]=(N/Mn>>0)-Nn&255;return V+Re},C.prototype.writeInt8=function(N,V,Re){return N=+N,V>>>=0,Re||Le(this,N,V,1,127,-128),N<0&&(N=255+N+1),this[V]=255&N,V+1},C.prototype.writeInt16LE=function(N,V,Re){return N=+N,V>>>=0,Re||Le(this,N,V,2,32767,-32768),this[V]=255&N,this[V+1]=N>>>8,V+2},C.prototype.writeInt16BE=function(N,V,Re){return N=+N,V>>>=0,Re||Le(this,N,V,2,32767,-32768),this[V]=N>>>8,this[V+1]=255&N,V+2},C.prototype.writeInt32LE=function(N,V,Re){return N=+N,V>>>=0,Re||Le(this,N,V,4,2147483647,-2147483648),this[V]=255&N,this[V+1]=N>>>8,this[V+2]=N>>>16,this[V+3]=N>>>24,V+4},C.prototype.writeInt32BE=function(N,V,Re){return N=+N,V>>>=0,Re||Le(this,N,V,4,2147483647,-2147483648),N<0&&(N=4294967295+N+1),this[V]=N>>>24,this[V+1]=N>>>16,this[V+2]=N>>>8,this[V+3]=255&N,V+4},C.prototype.writeFloatLE=function(N,V,Re){return Te(this,N,V,!0,Re)},C.prototype.writeFloatBE=function(N,V,Re){return Te(this,N,V,!1,Re)},C.prototype.writeDoubleLE=function(N,V,Re){return je(this,N,V,!0,Re)},C.prototype.writeDoubleBE=function(N,V,Re){return je(this,N,V,!1,Re)},C.prototype.copy=function(N,V,Re,Ze){if(!C.isBuffer(N))throw new TypeError("argument should be a Buffer");if(Re||(Re=0),!Ze&&0!==Ze&&(Ze=this.length),V>=N.length&&(V=N.length),V||(V=0),Ze>0&&Ze<Re&&(Ze=Re),Ze===Re||0===N.length||0===this.length)return 0;if(V<0)throw new RangeError("targetStart out of bounds");if(Re<0||Re>=this.length)throw new RangeError("Index out of range");if(Ze<0)throw new RangeError("sourceEnd out of bounds");Ze>this.length&&(Ze=this.length),N.length-V<Ze-Re&&(Ze=N.length-V+Re);var bt=Ze-Re;if(this===N&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(V,Re,Ze);else if(this===N&&Re<V&&V<Ze)for(var Rt=bt-1;Rt>=0;--Rt)N[Rt+V]=this[Rt+Re];else Uint8Array.prototype.set.call(N,this.subarray(Re,Ze),V);return bt},C.prototype.fill=function(N,V,Re,Ze){if("string"==typeof N){if("string"==typeof V?(Ze=V,V=0,Re=this.length):"string"==typeof Re&&(Ze=Re,Re=this.length),void 0!==Ze&&"string"!=typeof Ze)throw new TypeError("encoding must be a string");if("string"==typeof Ze&&!C.isEncoding(Ze))throw new TypeError("Unknown encoding: "+Ze);if(1===N.length){var bt=N.charCodeAt(0);("utf8"===Ze&&bt<128||"latin1"===Ze)&&(N=bt)}}else"number"==typeof N&&(N&=255);if(V<0||this.length<V||this.length<Re)throw new RangeError("Out of range index");if(Re<=V)return this;var Rt;if(V>>>=0,Re=void 0===Re?this.length:Re>>>0,N||(N=0),"number"==typeof N)for(Rt=V;Rt<Re;++Rt)this[Rt]=N;else{var Mn=C.isBuffer(N)?N:C.from(N,Ze),Nn=Mn.length;if(0===Nn)throw new TypeError('The value "'+N+'" is invalid for argument "value"');for(Rt=0;Rt<Re-V;++Rt)this[Rt+V]=Mn[Rt%Nn]}return this};var qe=/[^+/0-9A-Za-z-_]/g;function $(B){return B<16?"0"+B.toString(16):B.toString(16)}function z(B,N){N=N||1/0;for(var V,Re=B.length,Ze=null,bt=[],Rt=0;Rt<Re;++Rt){if((V=B.charCodeAt(Rt))>55295&&V<57344){if(!Ze){if(V>56319){(N-=3)>-1&&bt.push(239,191,189);continue}if(Rt+1===Re){(N-=3)>-1&&bt.push(239,191,189);continue}Ze=V;continue}if(V<56320){(N-=3)>-1&&bt.push(239,191,189),Ze=V;continue}V=65536+(Ze-55296<<10|V-56320)}else Ze&&(N-=3)>-1&&bt.push(239,191,189);if(Ze=null,V<128){if((N-=1)<0)break;bt.push(V)}else if(V<2048){if((N-=2)<0)break;bt.push(V>>6|192,63&V|128)}else if(V<65536){if((N-=3)<0)break;bt.push(V>>12|224,V>>6&63|128,63&V|128)}else{if(!(V<1114112))throw new Error("Invalid code point");if((N-=4)<0)break;bt.push(V>>18|240,V>>12&63|128,V>>6&63|128,63&V|128)}}return bt}function Ve(B){return U.toByteArray(function(B){if((B=(B=B.split("=")[0]).trim().replace(qe,"")).length<2)return"";for(;B.length%4!=0;)B+="=";return B}(B))}function gt(B,N,V,Re){for(var Ze=0;Ze<Re&&!(Ze+V>=N.length||Ze>=B.length);++Ze)N[Ze+V]=B[Ze];return Ze}function ft(B,N){return B instanceof N||null!=B&&null!=B.constructor&&null!=B.constructor.name&&B.constructor.name===N.name}function be(B){return B!=B}}).call(this)}).call(this,K("buffer").Buffer)},{"base64-js":2,buffer:6,ieee754:9}],7:[function(K,Me,pe){"use strict";Me.exports=function Y(U){return null===U||"object"!=typeof U||null!=U.toJSON?JSON.stringify(U):Array.isArray(U)?"["+U.reduce((k,ie,W)=>k+(0===W?"":",")+Y(void 0===ie||"symbol"==typeof ie?null:ie),"")+"]":"{"+Object.keys(U).sort().reduce((k,ie,W)=>void 0===U[ie]||"symbol"==typeof U[ie]?k:k+(0===k.length?"":",")+Y(ie)+":"+Y(U[ie]),"")+"}"}},{}],8:[function(K,Me,pe){"use strict";var k,Y="object"==typeof Reflect?Reflect:null,U=Y&&"function"==typeof Y.apply?Y.apply:function(G,Q,ae){return Function.prototype.apply.call(G,Q,ae)};k=Y&&"function"==typeof Y.ownKeys?Y.ownKeys:Object.getOwnPropertySymbols?function(G){return Object.getOwnPropertyNames(G).concat(Object.getOwnPropertySymbols(G))}:function(G){return Object.getOwnPropertyNames(G)};var W=Number.isNaN||function(G){return G!=G};function b(){b.init.call(this)}Me.exports=b,Me.exports.once=function(E,G){return new Promise(function(Q,ae){function se(xe){E.removeListener(G,ee),ae(xe)}function ee(){"function"==typeof E.removeListener&&E.removeListener("error",se),Q([].slice.call(arguments))}X(E,G,ee,{once:!0}),"error"!==G&&function(E,G,Q){"function"==typeof E.on&&X(E,"error",G,Q)}(E,se,{once:!0})})},b.EventEmitter=b,b.prototype._events=void 0,b.prototype._eventsCount=0,b.prototype._maxListeners=void 0;var C=10;function P(E){if("function"!=typeof E)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof E)}function M(E){return void 0===E._maxListeners?b.defaultMaxListeners:E._maxListeners}function v(E,G,Q,ae){var se,ee,xe;if(P(Q),void 0===(ee=E._events)?(ee=E._events=Object.create(null),E._eventsCount=0):(void 0!==ee.newListener&&(E.emit("newListener",G,Q.listener?Q.listener:Q),ee=E._events),xe=ee[G]),void 0===xe)xe=ee[G]=Q,++E._eventsCount;else if("function"==typeof xe?xe=ee[G]=ae?[Q,xe]:[xe,Q]:ae?xe.unshift(Q):xe.push(Q),(se=M(E))>0&&xe.length>se&&!xe.warned){xe.warned=!0;var me=new Error("Possible EventEmitter memory leak detected. "+xe.length+" "+String(G)+" listeners added. Use emitter.setMaxListeners() to increase limit");me.name="MaxListenersExceededWarning",me.emitter=E,me.type=G,me.count=xe.length,function(E){console&&console.warn&&console.warn(E)}(me)}return E}function y(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function S(E,G,Q){var ae={fired:!1,wrapFn:void 0,target:E,type:G,listener:Q},se=y.bind(ae);return se.listener=Q,ae.wrapFn=se,se}function T(E,G,Q){var ae=E._events;if(void 0===ae)return[];var se=ae[G];return void 0===se?[]:"function"==typeof se?Q?[se.listener||se]:[se]:Q?function(E){for(var G=new Array(E.length),Q=0;Q<G.length;++Q)G[Q]=E[Q].listener||E[Q];return G}(se):R(se,se.length)}function j(E){var G=this._events;if(void 0!==G){var Q=G[E];if("function"==typeof Q)return 1;if(void 0!==Q)return Q.length}return 0}function R(E,G){for(var Q=new Array(G),ae=0;ae<G;++ae)Q[ae]=E[ae];return Q}function X(E,G,Q,ae){if("function"==typeof E.on)ae.once?E.once(G,Q):E.on(G,Q);else{if("function"!=typeof E.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof E);E.addEventListener(G,function se(ee){ae.once&&E.removeEventListener(G,se),Q(ee)})}}Object.defineProperty(b,"defaultMaxListeners",{enumerable:!0,get:function(){return C},set:function(E){if("number"!=typeof E||E<0||W(E))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+E+".");C=E}}),b.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},b.prototype.setMaxListeners=function(G){if("number"!=typeof G||G<0||W(G))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+G+".");return this._maxListeners=G,this},b.prototype.getMaxListeners=function(){return M(this)},b.prototype.emit=function(G){for(var Q=[],ae=1;ae<arguments.length;ae++)Q.push(arguments[ae]);var se="error"===G,ee=this._events;if(void 0!==ee)se=se&&void 0===ee.error;else if(!se)return!1;if(se){var xe;if(Q.length>0&&(xe=Q[0]),xe instanceof Error)throw xe;var me=new Error("Unhandled error."+(xe?" ("+xe.message+")":""));throw me.context=xe,me}var te=ee[G];if(void 0===te)return!1;if("function"==typeof te)U(te,this,Q);else{var _e=te.length,Oe=R(te,_e);for(ae=0;ae<_e;++ae)U(Oe[ae],this,Q)}return!0},b.prototype.on=b.prototype.addListener=function(G,Q){return v(this,G,Q,!1)},b.prototype.prependListener=function(G,Q){return v(this,G,Q,!0)},b.prototype.once=function(G,Q){return P(Q),this.on(G,S(this,G,Q)),this},b.prototype.prependOnceListener=function(G,Q){return P(Q),this.prependListener(G,S(this,G,Q)),this},b.prototype.off=b.prototype.removeListener=function(G,Q){var ae,se,ee,xe,me;if(P(Q),void 0===(se=this._events))return this;if(void 0===(ae=se[G]))return this;if(ae===Q||ae.listener===Q)0==--this._eventsCount?this._events=Object.create(null):(delete se[G],se.removeListener&&this.emit("removeListener",G,ae.listener||Q));else if("function"!=typeof ae){for(ee=-1,xe=ae.length-1;xe>=0;xe--)if(ae[xe]===Q||ae[xe].listener===Q){me=ae[xe].listener,ee=xe;break}if(ee<0)return this;0===ee?ae.shift():function(E,G){for(;G+1<E.length;G++)E[G]=E[G+1];E.pop()}(ae,ee),1===ae.length&&(se[G]=ae[0]),void 0!==se.removeListener&&this.emit("removeListener",G,me||Q)}return this},b.prototype.removeAllListeners=function(G){var Q,ae,se;if(void 0===(ae=this._events))return this;if(void 0===ae.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==ae[G]&&(0==--this._eventsCount?this._events=Object.create(null):delete ae[G]),this;if(0===arguments.length){var xe,ee=Object.keys(ae);for(se=0;se<ee.length;++se)"removeListener"!==(xe=ee[se])&&this.removeAllListeners(xe);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(Q=ae[G]))this.removeListener(G,Q);else if(void 0!==Q)for(se=Q.length-1;se>=0;se--)this.removeListener(G,Q[se]);return this},b.prototype.listeners=function(G){return T(this,G,!0)},b.prototype.rawListeners=function(G){return T(this,G,!1)},b.listenerCount=function(E,G){return"function"==typeof E.listenerCount?E.listenerCount(G):j.call(E,G)},b.prototype.listenerCount=j,b.prototype.eventNames=function(){return this._eventsCount>0?k(this._events):[]}},{}],9:[function(K,Me,pe){pe.read=function(Y,U,k,ie,W){var b,C,P=8*W-ie-1,M=(1<<P)-1,v=M>>1,y=-7,S=k?W-1:0,T=k?-1:1,j=Y[U+S];for(S+=T,b=j&(1<<-y)-1,j>>=-y,y+=P;y>0;b=256*b+Y[U+S],S+=T,y-=8);for(C=b&(1<<-y)-1,b>>=-y,y+=ie;y>0;C=256*C+Y[U+S],S+=T,y-=8);if(0===b)b=1-v;else{if(b===M)return C?NaN:1/0*(j?-1:1);C+=Math.pow(2,ie),b-=v}return(j?-1:1)*C*Math.pow(2,b-ie)},pe.write=function(Y,U,k,ie,W,b){var C,P,M,v=8*b-W-1,y=(1<<v)-1,S=y>>1,T=23===W?Math.pow(2,-24)-Math.pow(2,-77):0,j=ie?0:b-1,R=ie?1:-1,q=U<0||0===U&&1/U<0?1:0;for(U=Math.abs(U),isNaN(U)||U===1/0?(P=isNaN(U)?1:0,C=y):(C=Math.floor(Math.log(U)/Math.LN2),U*(M=Math.pow(2,-C))<1&&(C--,M*=2),(U+=C+S>=1?T/M:T*Math.pow(2,1-S))*M>=2&&(C++,M/=2),C+S>=y?(P=0,C=y):C+S>=1?(P=(U*M-1)*Math.pow(2,W),C+=S):(P=U*Math.pow(2,S-1)*Math.pow(2,W),C=0));W>=8;Y[k+j]=255&P,j+=R,P/=256,W-=8);for(C=C<<W|P,v+=W;v>0;Y[k+j]=255&C,j+=R,C/=256,v-=8);Y[k+j-R]|=128*q}},{}],10:[function(K,Me,pe){Me.exports="function"==typeof Object.create?function(U,k){k&&(U.super_=k,U.prototype=Object.create(k.prototype,{constructor:{value:U,enumerable:!1,writable:!0,configurable:!0}}))}:function(U,k){if(k){U.super_=k;var ie=function(){};ie.prototype=k.prototype,U.prototype=new ie,U.prototype.constructor=U}}},{}],11:[function(K,Me,pe){"use strict";const{isArray:Y,isObject:U,isString:k}=K("./types"),{asArray:ie}=K("./util"),{prependBase:W}=K("./url"),b=K("./JsonLdError"),C=K("./ResolvedContext");function M(y){throw new b("Invalid JSON-LD syntax; @context must be an object.","jsonld.SyntaxError",{code:"invalid local context",context:y})}function v({context:y,base:S}){if(!y)return;const T=y["@context"];if(k(T))y["@context"]=W(S,T);else if(Y(T))for(let j=0;j<T.length;++j){const R=T[j];k(R)?T[j]=W(S,R):U(R)&&v({context:{"@context":R},base:S})}else if(U(T))for(const j in T)v({context:T[j],base:S})}Me.exports=class{constructor({sharedCache:S}){this.perOpCache=new Map,this.sharedCache=S}resolve({activeCtx:S,context:T,documentLoader:j,base:R,cycles:q=new Set}){var ue=this;return mt(function*(){T&&U(T)&&T["@context"]&&(T=T["@context"]),T=ie(T);const D=[];for(const O of T){if(k(O)){let G=ue._get(O);G||(G=yield ue._resolveRemoteContext({activeCtx:S,url:O,documentLoader:j,base:R,cycles:q})),Y(G)?D.push(...G):D.push(G);continue}if(null===O){D.push(new C({document:null}));continue}U(O)||M(T);const X=JSON.stringify(O);let E=ue._get(X);E||(E=new C({document:O}),ue._cacheResolvedContext({key:X,resolved:E,tag:"static"})),D.push(E)}return D})()}_get(S){let T=this.perOpCache.get(S);if(!T){const j=this.sharedCache.get(S);j&&(T=j.get("static"),T&&this.perOpCache.set(S,T))}return T}_cacheResolvedContext({key:S,resolved:T,tag:j}){if(this.perOpCache.set(S,T),void 0!==j){let R=this.sharedCache.get(S);R||(R=new Map,this.sharedCache.set(S,R)),R.set(j,T)}return T}_resolveRemoteContext({activeCtx:S,url:T,documentLoader:j,base:R,cycles:q}){var ue=this;return mt(function*(){T=W(R,T);const{context:D,remoteDoc:O}=yield ue._fetchContext({activeCtx:S,url:T,documentLoader:j,cycles:q});v({context:D,base:R=O.documentUrl||T});const X=yield ue.resolve({activeCtx:S,context:D,documentLoader:j,base:R,cycles:q});return ue._cacheResolvedContext({key:T,resolved:X,tag:O.tag}),X})()}_fetchContext({activeCtx:S,url:T,documentLoader:j,cycles:R}){return mt(function*(){if(R.size>10)throw new b("Maximum number of @context URLs exceeded.","jsonld.ContextUrlError",{code:"json-ld-1.0"===S.processingMode?"loading remote context failed":"context overflow",max:10});if(R.has(T))throw new b("Cyclical @context URLs detected.","jsonld.ContextUrlError",{code:"json-ld-1.0"===S.processingMode?"recursive context inclusion":"context overflow",url:T});let q,ue;R.add(T);try{ue=yield j(T),q=ue.document||null,k(q)&&(q=JSON.parse(q))}catch(D){throw new b("Dereferencing a URL did not result in a valid JSON-LD object. Possible causes are an inaccessible URL perhaps due to a same-origin policy (ensure the server uses CORS if you are using client-side JavaScript), too many redirects, a non-JSON response, or more than one HTTP Link Header was provided for a remote context.","jsonld.InvalidUrl",{code:"loading remote context failed",url:T,cause:D})}if(!U(q))throw new b("Dereferencing a URL did not result in a JSON object. The response was valid JSON, but it was not a JSON object.","jsonld.InvalidUrl",{code:"invalid remote context",url:T});return q="@context"in q?{"@context":q["@context"]}:{"@context":{}},ue.contextUrl&&(Y(q["@context"])||(q["@context"]=[q["@context"]]),q["@context"].push(ue.contextUrl)),{context:q,remoteDoc:ue}})()}}},{"./JsonLdError":12,"./ResolvedContext":16,"./types":30,"./url":31,"./util":32}],12:[function(K,Me,pe){"use strict";Me.exports=class extends Error{constructor(U="An unspecified JSON-LD error occurred.",k="jsonld.Error",ie={}){super(U),this.name=k,this.message=U,this.details=ie}}},{}],13:[function(K,Me,pe){"use strict";Me.exports=Y=>{class U{toString(){return"[object JsonLdProcessor]"}}return Object.defineProperty(U,"prototype",{writable:!1,enumerable:!1}),Object.defineProperty(U.prototype,"constructor",{writable:!0,enumerable:!1,configurable:!0,value:U}),U.compact=function(k,ie){return arguments.length<2?Promise.reject(new TypeError("Could not compact, too few arguments.")):Y.compact(k,ie)},U.expand=function(k){return arguments.length<1?Promise.reject(new TypeError("Could not expand, too few arguments.")):Y.expand(k)},U.flatten=function(k){return arguments.length<1?Promise.reject(new TypeError("Could not flatten, too few arguments.")):Y.flatten(k)},U}},{}],14:[function(K,Me,pe){"use strict";Me.exports=K("rdf-canonize").NQuads},{"rdf-canonize":46}],15:[function(K,Me,pe){"use strict";Me.exports=class{constructor(){this._requests={}}wrapLoader(U){const k=this;return k._loader=U,function(){return k.add.apply(k,arguments)}}add(U){var k=this;return mt(function*(){let ie=k._requests[U];if(ie)return Promise.resolve(ie);ie=k._requests[U]=k._loader(U);try{return yield ie}finally{delete k._requests[U]}})()}}},{}],16:[function(K,Me,pe){"use strict";const Y=K("lru-cache");Me.exports=class{constructor({document:ie}){this.document=ie,this.cache=new Y({max:10})}getProcessed(ie){return this.cache.get(ie)}setProcessed(ie,W){this.cache.set(ie,W)}}},{"lru-cache":33}],17:[function(K,Me,pe){"use strict";const Y=K("./JsonLdError"),{isArray:U,isObject:k,isString:ie,isUndefined:W}=K("./types"),{isList:b,isValue:C,isGraph:P,isSimpleGraph:M,isSubjectReference:v}=K("./graphTypes"),{expandIri:y,getContextValue:S,isKeyword:T,process:j,processingMode:R}=K("./context"),{removeBase:q,prependBase:ue}=K("./url"),{addValue:D,asArray:O,compareShortestLeast:X}=K("./util"),E={};function Q(ae,se,ee){if("@nest"!==y(ae,se,{vocab:!0},ee))throw new Y("JSON-LD compact error; nested property must have an @nest value resolving to @nest.","jsonld.SyntaxError",{code:"invalid @nest value"})}Me.exports=E,E.compact=function(){var ae=mt(function*({activeCtx:se,activeProperty:ee=null,element:xe,options:me={},compactionMap:te=(()=>{})}){if(U(xe)){let Oe=[];for(let $e=0;$e<xe.length;++$e){let st=yield E.compact({activeCtx:se,activeProperty:ee,element:xe[$e],options:me,compactionMap:te});null===st&&(st=yield te({unmappedValue:xe[$e],activeCtx:se,activeProperty:ee,parent:xe,index:$e,options:me}),void 0===st)||Oe.push(st)}return me.compactArrays&&1===Oe.length&&0===(S(se,ee,"@container")||[]).length&&(Oe=Oe[0]),Oe}const _e=S(se,ee,"@context");if(W(_e)||(se=yield j({activeCtx:se,localCtx:_e,propagate:!0,overrideProtected:!0,options:me})),k(xe)){if(me.link&&"@id"in xe&&me.link.hasOwnProperty(xe["@id"])){const Le=me.link[xe["@id"]];for(let Xe=0;Xe<Le.length;++Xe)if(Le[Xe].expanded===xe)return Le[Xe].compacted}if(C(xe)||v(xe)){const Le=E.compactValue({activeCtx:se,activeProperty:ee,value:xe,options:me});return me.link&&v(xe)&&(me.link.hasOwnProperty(xe["@id"])||(me.link[xe["@id"]]=[]),me.link[xe["@id"]].push({expanded:xe,compacted:Le})),Le}if(b(xe)&&(S(se,ee,"@container")||[]).includes("@list"))return E.compact({activeCtx:se,activeProperty:ee,element:xe["@list"],options:me,compactionMap:te});const Oe="@reverse"===ee,$e={},st=se;!C(xe)&&!v(xe)&&(se=se.revertToPreviousContext());const Qe=S(st,ee,"@context");W(Qe)||(se=yield j({activeCtx:se,localCtx:Qe,propagate:!0,overrideProtected:!0,options:me})),me.link&&"@id"in xe&&(me.link.hasOwnProperty(xe["@id"])||(me.link[xe["@id"]]=[]),me.link[xe["@id"]].push({expanded:xe,compacted:$e}));let et=xe["@type"]||[];et.length>1&&(et=Array.from(et).sort());const Ke=se;for(const Le of et){const Xe=E.compactIri({activeCtx:Ke,iri:Le,relativeTo:{vocab:!0}}),Te=S(st,Xe,"@context");W(Te)||(se=yield j({activeCtx:se,localCtx:Te,options:me,propagate:!1}))}const Ue=Object.keys(xe).sort();for(const Le of Ue){const Xe=xe[Le];if("@id"!==Le)if("@type"!==Le)if("@reverse"!==Le)if("@preserve"!==Le)if("@index"!==Le)if("@graph"!==Le&&"@list"!==Le&&"@included"!==Le&&T(Le)){const Te=E.compactIri({activeCtx:se,iri:Le,relativeTo:{vocab:!0}});D($e,Te,Xe)}else{if(!U(Xe))throw new Y("JSON-LD expansion error; expanded value must be an array.","jsonld.SyntaxError");if(0===Xe.length){const Te=E.compactIri({activeCtx:se,iri:Le,value:Xe,relativeTo:{vocab:!0},reverse:Oe}),je=se.mappings.has(Te)?se.mappings.get(Te)["@nest"]:null;let qe=$e;je&&(Q(se,je,me),k($e[je])||($e[je]={}),qe=$e[je]),D(qe,Te,Xe,{propertyIsArray:!0})}for(const Te of Xe){const je=E.compactIri({activeCtx:se,iri:Le,value:Te,relativeTo:{vocab:!0},reverse:Oe}),qe=se.mappings.has(je)?se.mappings.get(je)["@nest"]:null;let Ne=$e;qe&&(Q(se,qe,me),k($e[qe])||($e[qe]={}),Ne=$e[qe]);const $=S(se,je,"@container")||[],z=P(Te),fe=b(Te);let de;fe?de=Te["@list"]:z&&(de=Te["@graph"]);let Ve=yield E.compact({activeCtx:se,activeProperty:je,element:fe||z?de:Te,options:me,compactionMap:te});if(fe){if(U(Ve)||(Ve=[Ve]),$.includes("@list")){D(Ne,je,Ve,{valueIsArray:!0,allowDuplicate:!0});continue}Ve={[E.compactIri({activeCtx:se,iri:"@list",relativeTo:{vocab:!0}})]:Ve},"@index"in Te&&(Ve[E.compactIri({activeCtx:se,iri:"@index",relativeTo:{vocab:!0}})]=Te["@index"])}if(z)if($.includes("@graph")&&($.includes("@id")||$.includes("@index")&&M(Te))){let gt;Ne.hasOwnProperty(je)?gt=Ne[je]:Ne[je]=gt={};const ft=($.includes("@id")?Te["@id"]:Te["@index"])||E.compactIri({activeCtx:se,iri:"@none",relativeTo:{vocab:!0}});D(gt,ft,Ve,{propertyIsArray:!me.compactArrays||$.includes("@set")})}else $.includes("@graph")&&M(Te)?(U(Ve)&&Ve.length>1&&(Ve={"@included":Ve}),D(Ne,je,Ve,{propertyIsArray:!me.compactArrays||$.includes("@set")})):(U(Ve)&&1===Ve.length&&me.compactArrays&&(Ve=Ve[0]),Ve={[E.compactIri({activeCtx:se,iri:"@graph",relativeTo:{vocab:!0}})]:Ve},"@id"in Te&&(Ve[E.compactIri({activeCtx:se,iri:"@id",relativeTo:{vocab:!0}})]=Te["@id"]),"@index"in Te&&(Ve[E.compactIri({activeCtx:se,iri:"@index",relativeTo:{vocab:!0}})]=Te["@index"]),D(Ne,je,Ve,{propertyIsArray:!me.compactArrays||$.includes("@set")}));else if($.includes("@language")||$.includes("@index")||$.includes("@id")||$.includes("@type")){let gt,ft;if(Ne.hasOwnProperty(je)?gt=Ne[je]:Ne[je]=gt={},$.includes("@language"))C(Ve)&&(Ve=Ve["@value"]),ft=Te["@language"];else if($.includes("@index")){const be=S(se,je,"@index")||"@index",B=E.compactIri({activeCtx:se,iri:be,relativeTo:{vocab:!0}});if("@index"===be)ft=Te["@index"],delete Ve[B];else{let N;if([ft,...N]=O(Ve[be]||[]),ie(ft))switch(N.length){case 0:delete Ve[be];break;case 1:Ve[be]=N[0];break;default:Ve[be]=N}else ft=null}}else if($.includes("@id")){const be=E.compactIri({activeCtx:se,iri:"@id",relativeTo:{vocab:!0}});ft=Ve[be],delete Ve[be]}else if($.includes("@type")){const be=E.compactIri({activeCtx:se,iri:"@type",relativeTo:{vocab:!0}});let B;switch([ft,...B]=O(Ve[be]||[]),B.length){case 0:delete Ve[be];break;case 1:Ve[be]=B[0];break;default:Ve[be]=B}1===Object.keys(Ve).length&&"@id"in Te&&(Ve=yield E.compact({activeCtx:se,activeProperty:je,element:{"@id":Te["@id"]},options:me,compactionMap:te}))}ft||(ft=E.compactIri({activeCtx:se,iri:"@none",relativeTo:{vocab:!0}})),D(gt,ft,Ve,{propertyIsArray:$.includes("@set")})}else{const gt=!me.compactArrays||$.includes("@set")||$.includes("@list")||U(Ve)&&0===Ve.length||"@list"===Le||"@graph"===Le;D(Ne,je,Ve,{propertyIsArray:gt})}}}else{if((S(se,ee,"@container")||[]).includes("@index"))continue;const je=E.compactIri({activeCtx:se,iri:Le,relativeTo:{vocab:!0}});D($e,je,Xe)}else{const Te=yield E.compact({activeCtx:se,activeProperty:ee,element:Xe,options:me,compactionMap:te});U(Te)&&0===Te.length||D($e,Le,Te)}else{const Te=yield E.compact({activeCtx:se,activeProperty:"@reverse",element:Xe,options:me,compactionMap:te});for(const je in Te)if(se.mappings.has(je)&&se.mappings.get(je).reverse){const qe=Te[je],$=(S(se,je,"@container")||[]).includes("@set")||!me.compactArrays;D($e,je,qe,{propertyIsArray:$}),delete Te[je]}if(Object.keys(Te).length>0){const je=E.compactIri({activeCtx:se,iri:Le,relativeTo:{vocab:!0}});D($e,je,Te)}}else{let Te=O(Xe).map(z=>E.compactIri({activeCtx:st,iri:z,relativeTo:{vocab:!0}}));1===Te.length&&(Te=Te[0]);const je=E.compactIri({activeCtx:se,iri:"@type",relativeTo:{vocab:!0}}),$=(S(se,je,"@container")||[]).includes("@set")&&R(se,1.1)||U(Te)&&0===Xe.length;D($e,je,Te,{propertyIsArray:$})}else{let Te=O(Xe).map(qe=>E.compactIri({activeCtx:se,iri:qe,relativeTo:{vocab:!1},base:me.base}));1===Te.length&&(Te=Te[0]),$e[E.compactIri({activeCtx:se,iri:"@id",relativeTo:{vocab:!0}})]=Te}}return $e}return xe});return function(se){return ae.apply(this,arguments)}}(),E.compactIri=({activeCtx:ae,iri:se,value:ee=null,relativeTo:xe={vocab:!1},reverse:me=!1,base:te=null})=>{if(null===se)return se;ae.isPropertyTermScoped&&ae.previousContext&&(ae=ae.previousContext);const _e=ae.getInverse();if(T(se)&&se in _e&&"@none"in _e[se]&&"@type"in _e[se]["@none"]&&"@none"in _e[se]["@none"]["@type"])return _e[se]["@none"]["@type"]["@none"];if(xe.vocab&&se in _e){const et=ae["@language"]||"@none",Ke=[];k(ee)&&"@index"in ee&&!("@graph"in ee)&&Ke.push("@index","@index@set"),k(ee)&&"@preserve"in ee&&(ee=ee["@preserve"][0]),P(ee)?("@index"in ee&&Ke.push("@graph@index","@graph@index@set","@index","@index@set"),"@id"in ee&&Ke.push("@graph@id","@graph@id@set"),Ke.push("@graph","@graph@set","@set"),"@index"in ee||Ke.push("@graph@index","@graph@index@set","@index","@index@set"),"@id"in ee||Ke.push("@graph@id","@graph@id@set")):k(ee)&&!C(ee)&&Ke.push("@id","@id@set","@type","@set@type");let Ue="@language",Le="@null";if(me)Ue="@type",Le="@reverse",Ke.push("@set");else if(b(ee)){"@index"in ee||Ke.push("@list");const Te=ee["@list"];if(0===Te.length)Ue="@any",Le="@none";else{let je=0===Te.length?et:null,qe=null;for(let Ne=0;Ne<Te.length;++Ne){const $=Te[Ne];let z="@none",fe="@none";if(C($)?"@direction"in $?z=`${($["@language"]||"").toLowerCase()}_${$["@direction"]}`:"@language"in $?z=$["@language"].toLowerCase():"@type"in $?fe=$["@type"]:z="@null":fe="@id",null===je?je=z:z!==je&&C($)&&(je="@none"),null===qe?qe=fe:fe!==qe&&(qe="@none"),"@none"===je&&"@none"===qe)break}je=je||"@none",qe=qe||"@none","@none"!==qe?(Ue="@type",Le=qe):Le=je}}else{if(C(ee))if("@language"in ee&&!("@index"in ee)){Ke.push("@language","@language@set"),Le=ee["@language"];const Te=ee["@direction"];Te&&(Le=`${Le}_${Te}`)}else"@direction"in ee&&!("@index"in ee)?Le=`_${ee["@direction"]}`:"@type"in ee&&(Ue="@type",Le=ee["@type"]);else Ue="@type",Le="@id";Ke.push("@set")}Ke.push("@none"),k(ee)&&!("@index"in ee)&&Ke.push("@index","@index@set"),C(ee)&&1===Object.keys(ee).length&&Ke.push("@language","@language@set");const Xe=function(ae,se,ee,xe,me,te){null===te&&(te="@null");const _e=[];if(("@id"===te||"@reverse"===te)&&k(ee)&&"@id"in ee){"@reverse"===te&&_e.push("@reverse");const $e=E.compactIri({activeCtx:ae,iri:ee["@id"],relativeTo:{vocab:!0}});ae.mappings.has($e)&&ae.mappings.get($e)&&ae.mappings.get($e)["@id"]===ee["@id"]?_e.push.apply(_e,["@vocab","@id"]):_e.push.apply(_e,["@id","@vocab"])}else{_e.push(te);const $e=_e.find(st=>st.includes("_"));$e&&_e.push($e.replace(/^[^_]+_/,"_"))}_e.push("@none");const Oe=ae.inverse[se];for(const $e of xe){if(!($e in Oe))continue;const st=Oe[$e][me];for(const Qe of _e)if(Qe in st)return st[Qe]}return null}(ae,se,ee,Ke,Ue,Le);if(null!==Xe)return Xe}if(xe.vocab&&"@vocab"in ae){const et=ae["@vocab"];if(0===se.indexOf(et)&&se!==et){const Ke=se.substr(et.length);if(!ae.mappings.has(Ke))return Ke}}let Oe=null;const $e=[];let st=ae.fastCurieMap;const Qe=se.length-1;for(let et=0;et<Qe&&se[et]in st;++et)st=st[se[et]],""in st&&$e.push(st[""][0]);for(let et=$e.length-1;et>=0;--et){const Ke=$e[et],Ue=Ke.terms;for(const Le of Ue){const Xe=Le+":"+se.substr(Ke.iri.length);ae.mappings.get(Le)._prefix&&(!ae.mappings.has(Xe)||null===ee&&ae.mappings.get(Xe)["@id"]===se)&&(null===Oe||X(Xe,Oe)<0)&&(Oe=Xe)}}if(null!==Oe)return Oe;for(const[et,Ke]of ae.mappings)if(Ke&&Ke._prefix&&se.startsWith(et+":"))throw new Y(`Absolute IRI "${se}" confused with prefix "${et}".`,"jsonld.SyntaxError",{code:"IRI confused with prefix",context:ae});return xe.vocab?se:"@base"in ae?ae["@base"]?q(ue(te,ae["@base"]),se):se:q(te,se)},E.compactValue=({activeCtx:ae,activeProperty:se,value:ee,options:xe})=>{if(C(ee)){const Oe=S(ae,se,"@type"),$e=S(ae,se,"@language"),st=S(ae,se,"@direction"),Qe=S(ae,se,"@container")||[],et="@index"in ee&&!Qe.includes("@index");if(!et&&"@none"!==Oe&&(ee["@type"]===Oe||"@language"in ee&&ee["@language"]===$e&&"@direction"in ee&&ee["@direction"]===st||"@language"in ee&&ee["@language"]===$e||"@direction"in ee&&ee["@direction"]===st))return ee["@value"];const Ke=Object.keys(ee).length,Ue=1===Ke||2===Ke&&"@index"in ee&&!et,Le="@language"in ae,Xe=ie(ee["@value"]),Te=ae.mappings.has(se)&&null===ae.mappings.get(se)["@language"];if(Ue&&"@none"!==Oe&&(!Le||!Xe||Te))return ee["@value"];const je={};return et&&(je[E.compactIri({activeCtx:ae,iri:"@index",relativeTo:{vocab:!0}})]=ee["@index"]),"@type"in ee?je[E.compactIri({activeCtx:ae,iri:"@type",relativeTo:{vocab:!0}})]=E.compactIri({activeCtx:ae,iri:ee["@type"],relativeTo:{vocab:!0}}):"@language"in ee&&(je[E.compactIri({activeCtx:ae,iri:"@language",relativeTo:{vocab:!0}})]=ee["@language"]),"@direction"in ee&&(je[E.compactIri({activeCtx:ae,iri:"@direction",relativeTo:{vocab:!0}})]=ee["@direction"]),je[E.compactIri({activeCtx:ae,iri:"@value",relativeTo:{vocab:!0}})]=ee["@value"],je}const me=y(ae,se,{vocab:!0},xe),te=S(ae,se,"@type"),_e=E.compactIri({activeCtx:ae,iri:ee["@id"],relativeTo:{vocab:"@vocab"===te},base:xe.base});return"@id"===te||"@vocab"===te||"@graph"===me?_e:{[E.compactIri({activeCtx:ae,iri:"@id",relativeTo:{vocab:!0}})]:_e}}},{"./JsonLdError":12,"./context":19,"./graphTypes":25,"./types":30,"./url":31,"./util":32}],18:[function(K,Me,pe){"use strict";const Y="http://www.w3.org/1999/02/22-rdf-syntax-ns#",U="http://www.w3.org/2001/XMLSchema#";Me.exports={LINK_HEADER_REL:"http://www.w3.org/ns/json-ld#context",LINK_HEADER_CONTEXT:"http://www.w3.org/ns/json-ld#context",RDF:Y,RDF_LIST:Y+"List",RDF_FIRST:Y+"first",RDF_REST:Y+"rest",RDF_NIL:Y+"nil",RDF_TYPE:Y+"type",RDF_PLAIN_LITERAL:Y+"PlainLiteral",RDF_XML_LITERAL:Y+"XMLLiteral",RDF_JSON_LITERAL:Y+"JSON",RDF_OBJECT:Y+"object",RDF_LANGSTRING:Y+"langString",XSD:U,XSD_BOOLEAN:U+"boolean",XSD_DOUBLE:U+"double",XSD_INTEGER:U+"integer",XSD_STRING:U+"string"}},{}],19:[function(K,Me,pe){"use strict";const Y=K("./util"),U=K("./JsonLdError"),{isArray:k,isObject:ie,isString:W,isUndefined:b}=K("./types"),{isAbsolute:C,isRelative:P,prependBase:M}=K("./url"),{asArray:v,compareShortestLeast:y}=K("./util"),S=new Map,j=/^@[a-zA-Z]+$/,R={};function q(D,O,X,E,G,Q){if(null===O||!W(O)||R.isKeyword(O))return O;if(O.match(j))return null;if(E&&E.hasOwnProperty(O)&&!0!==G.get(O)&&R.createTermDefinition({activeCtx:D,localCtx:E,term:O,defined:G,options:Q}),(X=X||{}).vocab){const se=D.mappings.get(O);if(null===se)return null;if(ie(se)&&"@id"in se)return se["@id"]}const ae=O.indexOf(":");if(ae>0){const se=O.substr(0,ae),ee=O.substr(ae+1);if("_"===se||0===ee.indexOf("//"))return O;E&&E.hasOwnProperty(se)&&R.createTermDefinition({activeCtx:D,localCtx:E,term:se,defined:G,options:Q});const xe=D.mappings.get(se);if(xe&&xe._prefix)return xe["@id"]+ee;if(C(O))return O}if(X.vocab&&"@vocab"in D)return D["@vocab"]+O;if(X.base&&"@base"in D){if(D["@base"])return M(M(Q.base,D["@base"]),O)}else if(X.base)return M(Q.base,O);return O}function ue(D,O){if(!D||"object"!=typeof D||!O||"object"!=typeof O)return D===O;const X=Array.isArray(D);if(X!==Array.isArray(O))return!1;if(X){if(D.length!==O.length)return!1;for(let Q=0;Q<D.length;++Q)if(!ue(D[Q],O[Q]))return!1;return!0}const E=Object.keys(D),G=Object.keys(O);if(E.length!==G.length)return!1;for(const Q in D){let ae=D[Q],se=O[Q];if("@container"===Q&&Array.isArray(ae)&&Array.isArray(se)&&(ae=ae.slice().sort(),se=se.slice().sort()),!ue(ae,se))return!1}return!0}Me.exports=R,R.process=function(){var D=mt(function*({activeCtx:O,localCtx:X,options:E,propagate:G=!0,overrideProtected:Q=!1,cycles:ae=new Set}){if(ie(X)&&"@context"in X&&k(X["@context"])&&(X=X["@context"]),0===v(X).length)return O;const ee=yield E.contextResolver.resolve({activeCtx:O,context:X,documentLoader:E.documentLoader,base:E.base});ie(ee[0].document)&&"boolean"==typeof ee[0].document["@propagate"]&&(G=ee[0].document["@propagate"]);let xe=O;!G&&!xe.previousContext&&(xe=xe.clone(),xe.previousContext=O);for(const me of ee){let{document:te}=me;if(O=xe,null===te){if(!Q&&0!==Object.keys(O.protected).length){const $e=E&&E.protectedMode||"error";if("error"===$e)throw new U("Tried to nullify a context with protected terms outside of a term definition.","jsonld.SyntaxError",{code:"invalid context nullification"});if("warn"===$e){console.warn("WARNING: invalid context nullification");const st=me.getProcessed(O);if(st){xe=O=st;continue}const Qe=O;xe=O=R.getInitialContext(E).clone();for(const[et,Ke]of Object.entries(Qe.protected))Ke&&(O.mappings[et]=Y.clone(Qe.mappings[et]));O.protected=Y.clone(Qe.protected),me.setProcessed(Qe,xe);continue}throw new U("Invalid protectedMode.","jsonld.SyntaxError",{code:"invalid protected mode",context:X,protectedMode:$e})}xe=O=R.getInitialContext(E).clone();continue}const _e=me.getProcessed(O);if(_e){xe=O=_e;continue}if(ie(te)&&"@context"in te&&(te=te["@context"]),!ie(te))throw new U("Invalid JSON-LD syntax; @context must be an object.","jsonld.SyntaxError",{code:"invalid local context",context:te});xe=xe.clone();const Oe=new Map;if("@version"in te){if(1.1!==te["@version"])throw new U("Unsupported JSON-LD version: "+te["@version"],"jsonld.UnsupportedVersion",{code:"invalid @version value",context:te});if(O.processingMode&&"json-ld-1.0"===O.processingMode)throw new U("@version: "+te["@version"]+" not compatible with "+O.processingMode,"jsonld.ProcessingModeConflict",{code:"processing mode conflict",context:te});xe.processingMode="json-ld-1.1",xe["@version"]=te["@version"],Oe.set("@version",!0)}if(xe.processingMode=xe.processingMode||O.processingMode,"@base"in te){let $e=te["@base"];if(null!==$e&&!C($e)){if(!P($e))throw new U('Invalid JSON-LD syntax; the value of "@base" in a @context must be an absolute IRI, a relative IRI, or null.',"jsonld.SyntaxError",{code:"invalid base IRI",context:te});$e=M(xe["@base"],$e)}xe["@base"]=$e,Oe.set("@base",!0)}if("@vocab"in te){const $e=te["@vocab"];if(null===$e)delete xe["@vocab"];else{if(!W($e))throw new U('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:te});if(!C($e)&&R.processingMode(xe,1))throw new U('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be an absolute IRI.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:te});xe["@vocab"]=q(xe,$e,{vocab:!0,base:!0},void 0,void 0,E)}Oe.set("@vocab",!0)}if("@language"in te){const $e=te["@language"];if(null===$e)delete xe["@language"];else{if(!W($e))throw new U('Invalid JSON-LD syntax; the value of "@language" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid default language",context:te});xe["@language"]=$e.toLowerCase()}Oe.set("@language",!0)}if("@direction"in te){const $e=te["@direction"];if("json-ld-1.0"===O.processingMode)throw new U("Invalid JSON-LD syntax; @direction not compatible with "+O.processingMode,"jsonld.SyntaxError",{code:"invalid context member",context:te});if(null===$e)delete xe["@direction"];else{if("ltr"!==$e&&"rtl"!==$e)throw new U('Invalid JSON-LD syntax; the value of "@direction" in a @context must be null, "ltr", or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",context:te});xe["@direction"]=$e}Oe.set("@direction",!0)}if("@propagate"in te){const $e=te["@propagate"];if("json-ld-1.0"===O.processingMode)throw new U("Invalid JSON-LD syntax; @propagate not compatible with "+O.processingMode,"jsonld.SyntaxError",{code:"invalid context entry",context:te});if("boolean"!=typeof $e)throw new U("Invalid JSON-LD syntax; @propagate value must be a boolean.","jsonld.SyntaxError",{code:"invalid @propagate value",context:X});Oe.set("@propagate",!0)}if("@import"in te){const $e=te["@import"];if("json-ld-1.0"===O.processingMode)throw new U("Invalid JSON-LD syntax; @import not compatible with "+O.processingMode,"jsonld.SyntaxError",{code:"invalid context entry",context:te});if(!W($e))throw new U("Invalid JSON-LD syntax; @import must be a string.","jsonld.SyntaxError",{code:"invalid @import value",context:X});const st=yield E.contextResolver.resolve({activeCtx:O,context:$e,documentLoader:E.documentLoader,base:E.base});if(1!==st.length)throw new U("Invalid JSON-LD syntax; @import must reference a single context.","jsonld.SyntaxError",{code:"invalid remote context",context:X});const Qe=st[0].getProcessed(O);if(Qe)te=Qe;else{const et=st[0].document;if("@import"in et)throw new U("Invalid JSON-LD syntax: imported context must not include @import.","jsonld.SyntaxError",{code:"invalid context entry",context:X});for(const Ke in et)te.hasOwnProperty(Ke)||(te[Ke]=et[Ke]);st[0].setProcessed(O,te)}Oe.set("@import",!0)}Oe.set("@protected",te["@protected"]||!1);for(const $e in te)if(R.createTermDefinition({activeCtx:xe,localCtx:te,term:$e,defined:Oe,options:E,overrideProtected:Q}),ie(te[$e])&&"@context"in te[$e]){const st=te[$e]["@context"];let Qe=!0;if(W(st)){const et=M(E.base,st);ae.has(et)?Qe=!1:ae.add(et)}if(Qe)try{yield R.process({activeCtx:xe.clone(),localCtx:te[$e]["@context"],overrideProtected:!0,options:E,cycles:ae})}catch(et){throw new U("Invalid JSON-LD syntax; invalid scoped context.","jsonld.SyntaxError",{code:"invalid scoped context",context:te[$e]["@context"],term:$e})}}me.setProcessed(O,xe)}return xe});return function(O){return D.apply(this,arguments)}}(),R.createTermDefinition=({activeCtx:D,localCtx:O,term:X,defined:E,options:G,overrideProtected:Q=!1})=>{if(E.has(X)){if(E.get(X))return;throw new U("Cyclical context definition detected.","jsonld.CyclicalContext",{code:"cyclic IRI mapping",context:O,term:X})}let ae;if(E.set(X,!1),O.hasOwnProperty(X)&&(ae=O[X]),"@type"===X&&ie(ae)&&"@set"===(ae["@container"]||"@set")&&R.processingMode(D,1.1)){const Oe=["@container","@id","@protected"],$e=Object.keys(ae);if(0===$e.length||$e.some(st=>!Oe.includes(st)))throw new U("Invalid JSON-LD syntax; keywords cannot be overridden.","jsonld.SyntaxError",{code:"keyword redefinition",context:O,term:X})}else{if(R.isKeyword(X))throw new U("Invalid JSON-LD syntax; keywords cannot be overridden.","jsonld.SyntaxError",{code:"keyword redefinition",context:O,term:X});if(X.match(j))return void console.warn('WARNING: terms beginning with "@" are reserved for future use and ignored',{term:X});if(""===X)throw new U("Invalid JSON-LD syntax; a term cannot be an empty string.","jsonld.SyntaxError",{code:"invalid term definition",context:O})}const se=D.mappings.get(X);D.mappings.has(X)&&D.mappings.delete(X);let ee=!1;if((W(ae)||null===ae)&&(ee=!0,ae={"@id":ae}),!ie(ae))throw new U("Invalid JSON-LD syntax; @context term values must be strings or objects.","jsonld.SyntaxError",{code:"invalid term definition",context:O});const xe={};D.mappings.set(X,xe),xe.reverse=!1;const me=["@container","@id","@language","@reverse","@type"];R.processingMode(D,1.1)&&me.push("@context","@direction","@index","@nest","@prefix","@protected");for(const Oe in ae)if(!me.includes(Oe))throw new U("Invalid JSON-LD syntax; a term definition must not contain "+Oe,"jsonld.SyntaxError",{code:"invalid term definition",context:O});const te=X.indexOf(":");if(xe._termHasColon=te>0,"@reverse"in ae){if("@id"in ae)throw new U("Invalid JSON-LD syntax; a @reverse term definition must not contain @id.","jsonld.SyntaxError",{code:"invalid reverse property",context:O});if("@nest"in ae)throw new U("Invalid JSON-LD syntax; a @reverse term definition must not contain @nest.","jsonld.SyntaxError",{code:"invalid reverse property",context:O});const Oe=ae["@reverse"];if(!W(Oe))throw new U("Invalid JSON-LD syntax; a @context @reverse value must be a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:O});if(!R.isKeyword(Oe)&&Oe.match(j))return console.warn('WARNING: values beginning with "@" are reserved for future use and ignored',{reverse:Oe}),void(se?D.mappings.set(X,se):D.mappings.delete(X));const $e=q(D,Oe,{vocab:!0,base:!1},O,E,G);if(!C($e))throw new U("Invalid JSON-LD syntax; a @context @reverse value must be an absolute IRI or a blank node identifier.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:O});xe["@id"]=$e,xe.reverse=!0}else if("@id"in ae){let Oe=ae["@id"];if(Oe&&!W(Oe))throw new U("Invalid JSON-LD syntax; a @context @id value must be an array of strings or a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:O});if(null===Oe)xe["@id"]=null;else{if(!R.isKeyword(Oe)&&Oe.match(j))return console.warn('WARNING: values beginning with "@" are reserved for future use and ignored',{id:Oe}),void(se?D.mappings.set(X,se):D.mappings.delete(X));if(Oe!==X){if(Oe=q(D,Oe,{vocab:!0,base:!1},O,E,G),!C(Oe)&&!R.isKeyword(Oe))throw new U("Invalid JSON-LD syntax; a @context @id value must be an absolute IRI, a blank node identifier, or a keyword.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:O});if(X.match(/(?::[^:])|\//)&&q(D,X,{vocab:!0,base:!1},O,new Map(E).set(X,!0),G)!==Oe)throw new U("Invalid JSON-LD syntax; term in form of IRI must expand to definition.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:O});xe["@id"]=Oe,xe._prefix=ee&&!xe._termHasColon&&Oe.match(/[:\/\?#\[\]@]$/)}}}if(!("@id"in xe))if(xe._termHasColon){const Oe=X.substr(0,te);if(O.hasOwnProperty(Oe)&&R.createTermDefinition({activeCtx:D,localCtx:O,term:Oe,defined:E,options:G}),D.mappings.has(Oe)){const $e=X.substr(te+1);xe["@id"]=D.mappings.get(Oe)["@id"]+$e}else xe["@id"]=X}else if("@type"===X)xe["@id"]=X;else{if(!("@vocab"in D))throw new U("Invalid JSON-LD syntax; @context terms must define an @id.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:O,term:X});xe["@id"]=D["@vocab"]+X}if((!0===ae["@protected"]||!0===E.get("@protected")&&!1!==ae["@protected"])&&(D.protected[X]=!0,xe.protected=!0),E.set(X,!0),"@type"in ae){let Oe=ae["@type"];if(!W(Oe))throw new U("Invalid JSON-LD syntax; an @context @type value must be a string.","jsonld.SyntaxError",{code:"invalid type mapping",context:O});if("@json"===Oe||"@none"===Oe){if(R.processingMode(D,1))throw new U(`Invalid JSON-LD syntax; an @context @type value must not be "${Oe}" in JSON-LD 1.0 mode.`,"jsonld.SyntaxError",{code:"invalid type mapping",context:O})}else if("@id"!==Oe&&"@vocab"!==Oe){if(Oe=q(D,Oe,{vocab:!0,base:!1},O,E,G),!C(Oe))throw new U("Invalid JSON-LD syntax; an @context @type value must be an absolute IRI.","jsonld.SyntaxError",{code:"invalid type mapping",context:O});if(0===Oe.indexOf("_:"))throw new U("Invalid JSON-LD syntax; an @context @type value must be an IRI, not a blank node identifier.","jsonld.SyntaxError",{code:"invalid type mapping",context:O})}xe["@type"]=Oe}if("@container"in ae){const Oe=W(ae["@container"])?[ae["@container"]]:ae["@container"]||[],$e=["@list","@set","@index","@language"];let st=!0;const Qe=Oe.includes("@set");if(R.processingMode(D,1.1)){if($e.push("@graph","@id","@type"),Oe.includes("@list")){if(1!==Oe.length)throw new U("Invalid JSON-LD syntax; @context @container with @list must have no other values","jsonld.SyntaxError",{code:"invalid container mapping",context:O})}else if(Oe.includes("@graph")){if(Oe.some(et=>"@graph"!==et&&"@id"!==et&&"@index"!==et&&"@set"!==et))throw new U("Invalid JSON-LD syntax; @context @container with @graph must have no other values other than @id, @index, and @set","jsonld.SyntaxError",{code:"invalid container mapping",context:O})}else st&=Oe.length<=(Qe?2:1);if(Oe.includes("@type")&&(xe["@type"]=xe["@type"]||"@id",!["@id","@vocab"].includes(xe["@type"])))throw new U("Invalid JSON-LD syntax; container: @type requires @type to be @id or @vocab.","jsonld.SyntaxError",{code:"invalid type mapping",context:O})}else st&=!k(ae["@container"]),st&=Oe.length<=1;if(st&=Oe.every(et=>$e.includes(et)),st&=!(Qe&&Oe.includes("@list")),!st)throw new U("Invalid JSON-LD syntax; @context @container value must be one of the following: "+$e.join(", "),"jsonld.SyntaxError",{code:"invalid container mapping",context:O});if(xe.reverse&&!Oe.every(et=>["@index","@set"].includes(et)))throw new U("Invalid JSON-LD syntax; @context @container value for a @reverse type definition must be @index or @set.","jsonld.SyntaxError",{code:"invalid reverse property",context:O});xe["@container"]=Oe}if("@index"in ae){if(!("@container"in ae)||!xe["@container"].includes("@index"))throw new U(`Invalid JSON-LD syntax; @index without @index in @container: "${ae["@index"]}" on term "${X}".`,"jsonld.SyntaxError",{code:"invalid term definition",context:O});if(!W(ae["@index"])||0===ae["@index"].indexOf("@"))throw new U(`Invalid JSON-LD syntax; @index must expand to an IRI: "${ae["@index"]}" on term "${X}".`,"jsonld.SyntaxError",{code:"invalid term definition",context:O});xe["@index"]=ae["@index"]}if("@context"in ae&&(xe["@context"]=ae["@context"]),"@language"in ae&&!("@type"in ae)){let Oe=ae["@language"];if(null!==Oe&&!W(Oe))throw new U("Invalid JSON-LD syntax; @context @language value must be a string or null.","jsonld.SyntaxError",{code:"invalid language mapping",context:O});null!==Oe&&(Oe=Oe.toLowerCase()),xe["@language"]=Oe}if("@prefix"in ae){if(X.match(/:|\//))throw new U("Invalid JSON-LD syntax; @context @prefix used on a compact IRI term","jsonld.SyntaxError",{code:"invalid term definition",context:O});if(R.isKeyword(xe["@id"]))throw new U("Invalid JSON-LD syntax; keywords may not be used as prefixes","jsonld.SyntaxError",{code:"invalid term definition",context:O});if("boolean"!=typeof ae["@prefix"])throw new U("Invalid JSON-LD syntax; @context value for @prefix must be boolean","jsonld.SyntaxError",{code:"invalid @prefix value",context:O});xe._prefix=!0===ae["@prefix"]}if("@direction"in ae){const Oe=ae["@direction"];if(null!==Oe&&"ltr"!==Oe&&"rtl"!==Oe)throw new U('Invalid JSON-LD syntax; @direction value must be null, "ltr", or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",context:O});xe["@direction"]=Oe}if("@nest"in ae){const Oe=ae["@nest"];if(!W(Oe)||"@nest"!==Oe&&0===Oe.indexOf("@"))throw new U("Invalid JSON-LD syntax; @context @nest value must be a string which is not a keyword other than @nest.","jsonld.SyntaxError",{code:"invalid @nest value",context:O});xe["@nest"]=Oe}const _e=xe["@id"];if("@context"===_e||"@preserve"===_e)throw new U("Invalid JSON-LD syntax; @context and @preserve cannot be aliased.","jsonld.SyntaxError",{code:"invalid keyword alias",context:O});if(se&&se.protected&&!Q&&(D.protected[X]=!0,xe.protected=!0,!ue(se,xe))){const Oe=G&&G.protectedMode||"error";if("error"===Oe)throw new U(`Invalid JSON-LD syntax; tried to redefine "${X}" which is a protected term.`,"jsonld.SyntaxError",{code:"protected term redefinition",context:O,term:X});if("warn"===Oe)return void console.warn("WARNING: protected term redefinition",{term:X});throw new U("Invalid protectedMode.","jsonld.SyntaxError",{code:"invalid protected mode",context:O,term:X,protectedMode:Oe})}},R.expandIri=(D,O,X,E)=>q(D,O,X,void 0,void 0,E),R.getInitialContext=D=>{const O=JSON.stringify({processingMode:D.processingMode}),X=S.get(O);if(X)return X;const E={processingMode:D.processingMode,mappings:new Map,inverse:null,getInverse:function(){const xe=this;if(xe.inverse)return xe.inverse;const me=xe.inverse={},te=xe.fastCurieMap={},_e={},Oe=(xe["@language"]||"@none").toLowerCase(),$e=xe["@direction"],st=xe.mappings,Qe=[...st.keys()].sort(y);for(const et of Qe){const Ke=st.get(et);if(null===Ke)continue;let Ue=Ke["@container"]||"@none";if(Ue=[].concat(Ue).sort().join(""),null===Ke["@id"])continue;const Le=v(Ke["@id"]);for(const Xe of Le){let Te=me[Xe];const je=R.isKeyword(Xe);if(Te)!je&&!Ke._termHasColon&&_e[Xe].push(et);else if(me[Xe]=Te={},!je&&!Ke._termHasColon){_e[Xe]=[et];const qe={iri:Xe,terms:_e[Xe]};Xe[0]in te?te[Xe[0]].push(qe):te[Xe[0]]=[qe]}if(Te[Ue]||(Te[Ue]={"@language":{},"@type":{},"@any":{}}),Te=Te[Ue],ae(et,Te["@any"],"@none"),Ke.reverse)ae(et,Te["@type"],"@reverse");else if("@none"===Ke["@type"])ae(et,Te["@any"],"@none"),ae(et,Te["@language"],"@none"),ae(et,Te["@type"],"@none");else if("@type"in Ke)ae(et,Te["@type"],Ke["@type"]);else if("@language"in Ke&&"@direction"in Ke){const qe=Ke["@language"],Ne=Ke["@direction"];ae(et,Te["@language"],qe&&Ne?`${qe}_${Ne}`.toLowerCase():qe?qe.toLowerCase():Ne?`_${Ne}`:"@null")}else"@language"in Ke?ae(et,Te["@language"],(Ke["@language"]||"@null").toLowerCase()):"@direction"in Ke?ae(et,Te["@language"],Ke["@direction"]?`_${Ke["@direction"]}`:"@none"):$e?(ae(et,Te["@language"],`_${$e}`),ae(et,Te["@language"],"@none"),ae(et,Te["@type"],"@none")):(ae(et,Te["@language"],Oe),ae(et,Te["@language"],"@none"),ae(et,Te["@type"],"@none"))}}for(const et in te)Q(te,et,1);return me},clone:function(){const xe={};return xe.mappings=Y.clone(this.mappings),xe.clone=this.clone,xe.inverse=null,xe.getInverse=this.getInverse,xe.protected=Y.clone(this.protected),this.previousContext&&(xe.previousContext=this.previousContext.clone()),xe.revertToPreviousContext=this.revertToPreviousContext,"@base"in this&&(xe["@base"]=this["@base"]),"@language"in this&&(xe["@language"]=this["@language"]),"@vocab"in this&&(xe["@vocab"]=this["@vocab"]),xe},revertToPreviousContext:function(){return this.previousContext?this.previousContext.clone():this},protected:{}};return 1e4===S.size&&S.clear(),S.set(O,E),E;function Q(xe,me,te){const _e=xe[me],Oe=xe[me]={};let $e,st;for(const Qe of _e)$e=Qe.iri,st=te>=$e.length?"":$e[te],st in Oe?Oe[st].push(Qe):Oe[st]=[Qe];for(const Qe in Oe)""!==Qe&&Q(Oe,Qe,te+1)}function ae(xe,me,te){me.hasOwnProperty(te)||(me[te]=xe)}},R.getContextValue=(D,O,X)=>{if(null===O)return"@context"===X?void 0:null;if(D.mappings.has(O)){const E=D.mappings.get(O);if(b(X))return E;if(E.hasOwnProperty(X))return E[X]}return"@language"===X&&X in D||"@direction"===X&&X in D?D[X]:"@context"!==X?null:void 0},R.processingMode=(D,O)=>O.toString()>="1.1"?!D.processingMode||D.processingMode>="json-ld-"+O.toString():"json-ld-1.0"===D.processingMode,R.isKeyword=D=>{if(!W(D)||"@"!==D[0])return!1;switch(D){case"@base":case"@container":case"@context":case"@default":case"@direction":case"@embed":case"@explicit":case"@graph":case"@id":case"@included":case"@index":case"@json":case"@language":case"@list":case"@nest":case"@none":case"@omitDefault":case"@prefix":case"@preserve":case"@protected":case"@requireAll":case"@reverse":case"@set":case"@type":case"@value":case"@version":case"@vocab":return!0}return!1}},{"./JsonLdError":12,"./types":30,"./url":31,"./util":32}],20:[function(K,Me,pe){"use strict";const{parseLinkHeader:Y,buildHeaders:U}=K("../util"),{LINK_HEADER_CONTEXT:k}=K("../constants"),ie=K("../JsonLdError"),W=K("../RequestQueue"),{prependBase:b}=K("../url"),C=/(^|(\r\n))link:/i;function P(M,v,y){const S=new(M=M||XMLHttpRequest);return new Promise((T,j)=>{S.onload=()=>T(S),S.onerror=R=>j(R),S.open("GET",v,!0);for(const R in y)S.setRequestHeader(R,y[R]);S.send()})}Me.exports=({secure:M,headers:v={},xhr:y}={headers:{}})=>{return v=U(v),(new W).wrapLoader(T);function T(R){return j.apply(this,arguments)}function j(){return(j=mt(function*(R){if(0!==R.indexOf("http:")&&0!==R.indexOf("https:"))throw new ie('URL could not be dereferenced; only "http" and "https" URLs are supported.',"jsonld.InvalidUrl",{code:"loading document failed",url:R});if(M&&0!==R.indexOf("https"))throw new ie('URL could not be dereferenced; secure mode is enabled and the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:R});let q;try{q=yield P(y,R,v)}catch(E){throw new ie("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:R,cause:E})}if(q.status>=400)throw new ie("URL could not be dereferenced: "+q.statusText,"jsonld.LoadDocumentError",{code:"loading document failed",url:R,httpStatusCode:q.status});let ue={contextUrl:null,documentUrl:R,document:q.response},D=null;const O=q.getResponseHeader("Content-Type");let X;if(C.test(q.getAllResponseHeaders())&&(X=q.getResponseHeader("Link")),X&&"application/ld+json"!==O){const E=Y(X),G=E[k];if(Array.isArray(G))throw new ie("URL could not be dereferenced, it has more than one associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:R});G&&(ue.contextUrl=G.target),D=E.alternate,D&&"application/ld+json"==D.type&&!(O||"").match(/^application\/(\w*\+)?json$/)&&(ue=yield T(b(R,D.target)))}return ue})).apply(this,arguments)}}},{"../JsonLdError":12,"../RequestQueue":15,"../constants":18,"../url":31,"../util":32}],21:[function(K,Me,pe){"use strict";const Y=K("./JsonLdError"),{isArray:U,isObject:k,isEmptyObject:ie,isString:W,isUndefined:b}=K("./types"),{isList:C,isValue:P,isGraph:M,isSubject:v}=K("./graphTypes"),{expandIri:y,getContextValue:S,isKeyword:T,process:j,processingMode:R}=K("./context"),{isAbsolute:q}=K("./url"),{addValue:ue,asArray:D,getValues:O,validateTypeValue:X}=K("./util"),E={};Me.exports=E;const G=/^[a-zA-Z]{1,8}(-[a-zA-Z0-9]{1,8})*$/;function Q(te){return ae.apply(this,arguments)}function ae(){return(ae=mt(function*({activeCtx:te,activeProperty:_e,expandedActiveProperty:Oe,element:$e,expandedParent:st,options:Qe={},insideList:et,typeKey:Ke,typeScopedContext:Ue,expansionMap:Le}){const Xe=Object.keys($e).sort(),Te=[];let je;const qe=$e[Ke]&&"@json"===y(te,U($e[Ke])?$e[Ke][0]:$e[Ke],{vocab:!0},Qe);for(const Ne of Xe){let z,$=$e[Ne];if("@context"===Ne)continue;let fe=y(te,Ne,{vocab:!0},Qe);if((null===fe||!q(fe)&&!T(fe))&&(fe=Le({unmappedProperty:Ne,activeCtx:te,activeProperty:_e,parent:$e,options:Qe,insideList:et,value:$,expandedParent:st}),void 0===fe))continue;if(T(fe)){if("@reverse"===Oe)throw new Y("Invalid JSON-LD syntax; a keyword cannot be used as a @reverse property.","jsonld.SyntaxError",{code:"invalid reverse property map",value:$});if(fe in st&&"@included"!==fe&&"@type"!==fe)throw new Y("Invalid JSON-LD syntax; colliding keywords detected.","jsonld.SyntaxError",{code:"colliding keywords",keyword:fe})}if("@id"===fe){if(!W($)){if(!Qe.isFrame)throw new Y('Invalid JSON-LD syntax; "@id" value must a string.',"jsonld.SyntaxError",{code:"invalid @id value",value:$});if(k($)){if(!ie($))throw new Y('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:$})}else{if(!U($))throw new Y('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:$});if(!$.every(ft=>W(ft)))throw new Y('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:$})}}ue(st,"@id",D($).map(ft=>W(ft)?y(te,ft,{base:!0},Qe):ft),{propertyIsArray:Qe.isFrame});continue}if("@type"===fe){k($)&&($=Object.fromEntries(Object.entries($).map(([ft,be])=>[y(Ue,ft,{vocab:!0}),D(be).map(B=>y(Ue,B,{base:!0,vocab:!0}))]))),X($,Qe.isFrame),ue(st,"@type",D($).map(ft=>W(ft)?y(Ue,ft,{base:!0,vocab:!0},Qe):ft),{propertyIsArray:Qe.isFrame});continue}if("@included"===fe&&R(te,1.1)){const ft=D(yield E.expand({activeCtx:te,activeProperty:_e,element:$,options:Qe,expansionMap:Le}));if(!ft.every(be=>v(be)))throw new Y("Invalid JSON-LD syntax; values of @included must expand to node objects.","jsonld.SyntaxError",{code:"invalid @included value",value:$});ue(st,"@included",ft,{propertyIsArray:!0});continue}if("@graph"===fe&&!k($)&&!U($))throw new Y('Invalid JSON-LD syntax; "@graph" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid @graph value",value:$});if("@value"===fe){je=$,qe&&R(te,1.1)?st["@value"]=$:ue(st,"@value",$,{propertyIsArray:Qe.isFrame});continue}if("@language"===fe){if(null===$)continue;if(!W($)&&!Qe.isFrame)throw new Y('Invalid JSON-LD syntax; "@language" value must be a string.',"jsonld.SyntaxError",{code:"invalid language-tagged string",value:$});$=D($).map(ft=>W(ft)?ft.toLowerCase():ft);for(const ft of $)W(ft)&&!ft.match(G)&&console.warn(`@language must be valid BCP47: ${ft}`);ue(st,"@language",$,{propertyIsArray:Qe.isFrame});continue}if("@direction"===fe){if(!W($)&&!Qe.isFrame)throw new Y('Invalid JSON-LD syntax; "@direction" value must be a string.',"jsonld.SyntaxError",{code:"invalid base direction",value:$});$=D($);for(const ft of $)if(W(ft)&&"ltr"!==ft&&"rtl"!==ft)throw new Y('Invalid JSON-LD syntax; "@direction" must be "ltr" or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",value:$});ue(st,"@direction",$,{propertyIsArray:Qe.isFrame});continue}if("@index"===fe){if(!W($))throw new Y('Invalid JSON-LD syntax; "@index" value must be a string.',"jsonld.SyntaxError",{code:"invalid @index value",value:$});ue(st,"@index",$);continue}if("@reverse"===fe){if(!k($))throw new Y('Invalid JSON-LD syntax; "@reverse" value must be an object.',"jsonld.SyntaxError",{code:"invalid @reverse value",value:$});if(z=yield E.expand({activeCtx:te,activeProperty:"@reverse",element:$,options:Qe,expansionMap:Le}),"@reverse"in z)for(const be in z["@reverse"])ue(st,be,z["@reverse"][be],{propertyIsArray:!0});let ft=st["@reverse"]||null;for(const be in z){if("@reverse"===be)continue;null===ft&&(ft=st["@reverse"]={}),ue(ft,be,[],{propertyIsArray:!0});const B=z[be];for(let N=0;N<B.length;++N){const V=B[N];if(P(V)||C(V))throw new Y('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:z});ue(ft,be,V,{propertyIsArray:!0})}}continue}if("@nest"===fe){Te.push(Ne);continue}let de=te;const Ve=S(te,Ne,"@context");b(Ve)||(de=yield j({activeCtx:te,localCtx:Ve,propagate:!0,overrideProtected:!0,options:Qe}));const gt=S(de,Ne,"@container")||[];if(gt.includes("@language")&&k($))z=ee(de,$,S(de,Ne,"@direction"),Qe);else if(gt.includes("@index")&&k($)){const ft=gt.includes("@graph"),be=S(de,Ne,"@index")||"@index",B="@index"!==be&&y(te,be,{vocab:!0},Qe);z=yield xe({activeCtx:de,options:Qe,activeProperty:Ne,value:$,expansionMap:Le,asGraph:ft,indexKey:be,propertyIndex:B})}else if(gt.includes("@id")&&k($)){const ft=gt.includes("@graph");z=yield xe({activeCtx:de,options:Qe,activeProperty:Ne,value:$,expansionMap:Le,asGraph:ft,indexKey:"@id"})}else if(gt.includes("@type")&&k($))z=yield xe({activeCtx:de.revertToPreviousContext(),options:Qe,activeProperty:Ne,value:$,expansionMap:Le,asGraph:!1,indexKey:"@type"});else{const ft="@list"===fe;if(ft||"@set"===fe){let be=_e;ft&&"@graph"===Oe&&(be=null),z=yield E.expand({activeCtx:de,activeProperty:be,element:$,options:Qe,insideList:ft,expansionMap:Le})}else z="@json"===S(te,Ne,"@type")?{"@type":"@json","@value":$}:yield E.expand({activeCtx:de,activeProperty:Ne,element:$,options:Qe,insideList:!1,expansionMap:Le})}if(null!==z||"@value"===fe||(z=Le({unmappedValue:$,expandedProperty:fe,activeCtx:de,activeProperty:_e,parent:$e,options:Qe,insideList:et,key:Ne,expandedParent:st}),void 0!==z)){if("@list"!==fe&&!C(z)&&gt.includes("@list")&&(z={"@list":D(z)}),gt.includes("@graph")&&!gt.some(ft=>"@id"===ft||"@index"===ft)&&(z=D(z).map(ft=>({"@graph":D(ft)}))),de.mappings.has(Ne)&&de.mappings.get(Ne).reverse){const ft=st["@reverse"]=st["@reverse"]||{};z=D(z);for(let be=0;be<z.length;++be){const B=z[be];if(P(B)||C(B))throw new Y('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:z});ue(ft,fe,B,{propertyIsArray:!0})}continue}ue(st,fe,z,{propertyIsArray:!0})}}if("@value"in st&&("@json"!==st["@type"]||!R(te,1.1))&&(k(je)||U(je))&&!Qe.isFrame)throw new Y('Invalid JSON-LD syntax; "@value" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid value object value",value:je});for(const Ne of Te){const $=U($e[Ne])?$e[Ne]:[$e[Ne]];for(const z of $){if(!k(z)||Object.keys(z).some(fe=>"@value"===y(te,fe,{vocab:!0},Qe)))throw new Y("Invalid JSON-LD syntax; nested value must be a node object.","jsonld.SyntaxError",{code:"invalid @nest value",value:z});yield Q({activeCtx:te,activeProperty:_e,expandedActiveProperty:Oe,element:z,expandedParent:st,options:Qe,insideList:et,typeScopedContext:Ue,typeKey:Ke,expansionMap:Le})}}})).apply(this,arguments)}function se({activeCtx:te,activeProperty:_e,value:Oe,options:$e}){if(null==Oe)return null;const st=y(te,_e,{vocab:!0},$e);if("@id"===st)return y(te,Oe,{base:!0},$e);if("@type"===st)return y(te,Oe,{vocab:!0,base:!0},$e);const Qe=S(te,_e,"@type");if(("@id"===Qe||"@graph"===st)&&W(Oe))return{"@id":y(te,Oe,{base:!0},$e)};if("@vocab"===Qe&&W(Oe))return{"@id":y(te,Oe,{vocab:!0,base:!0},$e)};if(T(st))return Oe;const et={};if(Qe&&!["@id","@vocab","@none"].includes(Qe))et["@type"]=Qe;else if(W(Oe)){const Ke=S(te,_e,"@language");null!==Ke&&(et["@language"]=Ke);const Ue=S(te,_e,"@direction");null!==Ue&&(et["@direction"]=Ue)}return["boolean","number","string"].includes(typeof Oe)||(Oe=Oe.toString()),et["@value"]=Oe,et}function ee(te,_e,Oe,$e){const st=[],Qe=Object.keys(_e).sort();for(const et of Qe){const Ke=y(te,et,{vocab:!0},$e);let Ue=_e[et];U(Ue)||(Ue=[Ue]);for(const Le of Ue){if(null===Le)continue;if(!W(Le))throw new Y("Invalid JSON-LD syntax; language map values must be strings.","jsonld.SyntaxError",{code:"invalid language map value",languageMap:_e});const Xe={"@value":Le};"@none"!==Ke&&(Xe["@language"]=et.toLowerCase()),Oe&&(Xe["@direction"]=Oe),st.push(Xe)}}return st}function xe(te){return me.apply(this,arguments)}function me(){return(me=mt(function*({activeCtx:te,options:_e,activeProperty:Oe,value:$e,expansionMap:st,asGraph:Qe,indexKey:et,propertyIndex:Ke}){const Ue=[],Le=Object.keys($e).sort(),Xe="@type"===et;for(let Te of Le){if(Xe){const Ne=S(te,Te,"@context");b(Ne)||(te=yield j({activeCtx:te,localCtx:Ne,propagate:!1,options:_e}))}let qe,je=$e[Te];U(je)||(je=[je]),je=yield E.expand({activeCtx:te,activeProperty:Oe,element:je,options:_e,insideList:!1,insideIndex:!0,expansionMap:st}),qe=Ke?"@none"===Te?"@none":se({activeCtx:te,activeProperty:et,value:Te,options:_e}):y(te,Te,{vocab:!0},_e),"@id"===et?Te=y(te,Te,{base:!0},_e):Xe&&(Te=qe);for(let Ne of je){if(Qe&&!M(Ne)&&(Ne={"@graph":[Ne]}),"@type"===et)"@none"===qe||(Ne["@type"]=Ne["@type"]?[Te].concat(Ne["@type"]):[Te]);else{if(P(Ne)&&!["@language","@type","@index"].includes(et))throw new Y(`Invalid JSON-LD syntax; Attempt to add illegal key to value object: "${et}".`,"jsonld.SyntaxError",{code:"invalid value object",value:Ne});Ke?"@none"!==qe&&ue(Ne,Ke,qe,{propertyIsArray:!0,prependValue:!0}):"@none"!==qe&&!(et in Ne)&&(Ne[et]=Te)}Ue.push(Ne)}}return Ue})).apply(this,arguments)}E.expand=function(){var te=mt(function*({activeCtx:_e,activeProperty:Oe=null,element:$e,options:st={},insideList:Qe=!1,insideIndex:et=!1,typeScopedContext:Ke=null,expansionMap:Ue=(()=>{})}){if(null==$e)return null;if("@default"===Oe&&(st=Object.assign({},st,{isFrame:!1})),!U($e)&&!k($e)){if(!Qe&&(null===Oe||"@graph"===y(_e,Oe,{vocab:!0},st))){const z=yield Ue({unmappedValue:$e,activeCtx:_e,activeProperty:Oe,options:st,insideList:Qe});return void 0===z?null:z}return se({activeCtx:_e,activeProperty:Oe,value:$e,options:st})}if(U($e)){let z=[];const fe=S(_e,Oe,"@container")||[];Qe=Qe||fe.includes("@list");for(let de=0;de<$e.length;++de){let Ve=yield E.expand({activeCtx:_e,activeProperty:Oe,element:$e[de],options:st,expansionMap:Ue,insideIndex:et,typeScopedContext:Ke});Qe&&U(Ve)&&(Ve={"@list":Ve}),(null!==Ve||(Ve=yield Ue({unmappedValue:$e[de],activeCtx:_e,activeProperty:Oe,parent:$e,index:de,options:st,expandedParent:z,insideList:Qe}),void 0!==Ve))&&(U(Ve)?z=z.concat(Ve):z.push(Ve))}return z}const Le=y(_e,Oe,{vocab:!0},st),Xe=S(_e,Oe,"@context");Ke=Ke||(_e.previousContext?_e:null);let Te=Object.keys($e).sort(),je=!et;if(je&&Ke&&Te.length<=2&&!Te.includes("@context"))for(const z of Te){const fe=y(Ke,z,{vocab:!0},st);if("@value"===fe){je=!1,_e=Ke;break}if("@id"===fe&&1===Te.length){je=!1;break}}je&&(_e=_e.revertToPreviousContext()),b(Xe)||(_e=yield j({activeCtx:_e,localCtx:Xe,propagate:!0,overrideProtected:!0,options:st})),"@context"in $e&&(_e=yield j({activeCtx:_e,localCtx:$e["@context"],options:st})),Ke=_e;let qe=null;for(const z of Te)if("@type"===y(_e,z,{vocab:!0},st)){qe=qe||z;const de=$e[z],Ve=Array.isArray(de)?de.length>1?de.slice().sort():de:[de];for(const gt of Ve){const ft=S(Ke,gt,"@context");b(ft)||(_e=yield j({activeCtx:_e,localCtx:ft,options:st,propagate:!1}))}}let Ne={};yield Q({activeCtx:_e,activeProperty:Oe,expandedActiveProperty:Le,element:$e,expandedParent:Ne,options:st,insideList:Qe,typeKey:qe,typeScopedContext:Ke,expansionMap:Ue}),Te=Object.keys(Ne);let $=Te.length;if("@value"in Ne){if("@type"in Ne&&("@language"in Ne||"@direction"in Ne))throw new Y('Invalid JSON-LD syntax; an element containing "@value" may not contain both "@type" and either "@language" or "@direction".',"jsonld.SyntaxError",{code:"invalid value object",element:Ne});let z=$-1;if("@type"in Ne&&(z-=1),"@index"in Ne&&(z-=1),"@language"in Ne&&(z-=1),"@direction"in Ne&&(z-=1),0!==z)throw new Y('Invalid JSON-LD syntax; an element containing "@value" may only have an "@index" property and either "@type" or either or both "@language" or "@direction".',"jsonld.SyntaxError",{code:"invalid value object",element:Ne});const fe=null===Ne["@value"]?[]:D(Ne["@value"]),de=O(Ne,"@type");if(!R(_e,1.1)||!de.includes("@json")||1!==de.length)if(0===fe.length){const Ve=yield Ue({unmappedValue:Ne,activeCtx:_e,activeProperty:Oe,element:$e,options:st,insideList:Qe});Ne=void 0!==Ve?Ve:null}else{if(!fe.every(Ve=>W(Ve)||ie(Ve))&&"@language"in Ne)throw new Y("Invalid JSON-LD syntax; only strings may be language-tagged.","jsonld.SyntaxError",{code:"invalid language-tagged value",element:Ne});if(!de.every(Ve=>q(Ve)&&!(W(Ve)&&0===Ve.indexOf("_:"))||ie(Ve)))throw new Y('Invalid JSON-LD syntax; an element containing "@value" and "@type" must have an absolute IRI for the value of "@type".',"jsonld.SyntaxError",{code:"invalid typed value",element:Ne})}}else if("@type"in Ne&&!U(Ne["@type"]))Ne["@type"]=[Ne["@type"]];else if("@set"in Ne||"@list"in Ne){if($>1&&(2!==$||!("@index"in Ne)))throw new Y('Invalid JSON-LD syntax; if an element has the property "@set" or "@list", then it can have at most one other property that is "@index".',"jsonld.SyntaxError",{code:"invalid set or list object",element:Ne});"@set"in Ne&&(Ne=Ne["@set"],Te=Object.keys(Ne),$=Te.length)}else if(1===$&&"@language"in Ne){const z=yield Ue(Ne,{unmappedValue:Ne,activeCtx:_e,activeProperty:Oe,element:$e,options:st,insideList:Qe});Ne=void 0!==z?z:null}if(k(Ne)&&!st.keepFreeFloatingNodes&&!Qe&&(null===Oe||"@graph"===Le)&&(0===$||"@value"in Ne||"@list"in Ne||1===$&&"@id"in Ne)){const z=yield Ue({unmappedValue:Ne,activeCtx:_e,activeProperty:Oe,element:$e,options:st,insideList:Qe});Ne=void 0!==z?z:null}return Ne});return function(_e){return te.apply(this,arguments)}}()},{"./JsonLdError":12,"./context":19,"./graphTypes":25,"./types":30,"./url":31,"./util":32}],22:[function(K,Me,pe){"use strict";const{isSubjectReference:Y}=K("./graphTypes"),{createMergedNodeMap:U}=K("./nodeMap"),k={};Me.exports=k,k.flatten=ie=>{const W=U(ie),b=[],C=Object.keys(W).sort();for(let P=0;P<C.length;++P){const M=W[C[P]];Y(M)||b.push(M)}return b}},{"./graphTypes":25,"./nodeMap":27}],23:[function(K,Me,pe){"use strict";const{isKeyword:Y}=K("./context"),U=K("./graphTypes"),k=K("./types"),ie=K("./util"),W=K("./url"),b=K("./JsonLdError"),{createNodeMap:C,mergeNodeMapGraphs:P}=K("./nodeMap"),M={};function v(E){const G={};for(const Q in E)void 0!==E[Q]&&(G["@"+Q]=[E[Q]]);return[G]}function y(E,G,Q){for(let ae=Q.length-1;ae>=0;--ae){const se=Q[ae];if(se.graph===G&&se.subject["@id"]===E["@id"])return!0}return!1}function S(E,G,Q){const ae="@"+Q;let se=ae in E?E[ae][0]:G[Q];if("embed"===Q)if(!0===se)se="@once";else if(!1===se)se="@never";else if("@always"!==se&&"@never"!==se&&"@link"!==se&&"@first"!==se&&"@last"!==se&&"@once"!==se)throw new b("Invalid JSON-LD syntax; invalid value of @embed.","jsonld.SyntaxError",{code:"invalid @embed value",frame:E});return se}function T(E){if(!k.isArray(E)||1!==E.length||!k.isObject(E[0]))throw new b("Invalid JSON-LD syntax; a JSON-LD frame must be a single object.","jsonld.SyntaxError",{frame:E});if("@id"in E[0])for(const G of ie.asArray(E[0]["@id"]))if(!k.isObject(G)&&!W.isAbsolute(G)||k.isString(G)&&0===G.indexOf("_:"))throw new b("Invalid JSON-LD syntax; invalid @id in frame.","jsonld.SyntaxError",{code:"invalid frame",frame:E});if("@type"in E[0])for(const G of ie.asArray(E[0]["@type"]))if(!k.isObject(G)&&!W.isAbsolute(G)||k.isString(G)&&0===G.indexOf("_:"))throw new b("Invalid JSON-LD syntax; invalid @type in frame.","jsonld.SyntaxError",{code:"invalid frame",frame:E})}function R(E,G,Q,ae){let se=!0,ee=!1;for(const xe in Q){let me=!1;const te=ie.getValues(G,xe),_e=0===ie.getValues(Q,xe).length;if("@id"===xe){if(k.isEmptyObject(Q["@id"][0]||{})?me=!0:Q["@id"].length>=0&&(me=Q["@id"].includes(te[0])),!ae.requireAll)return me}else if("@type"===xe){if(se=!1,_e){if(te.length>0)return!1;me=!0}else if(1===Q["@type"].length&&k.isEmptyObject(Q["@type"][0]))me=te.length>0;else for(const Oe of Q["@type"])me=!(!k.isObject(Oe)||!("@default"in Oe))||me||te.some($e=>$e===Oe);if(!ae.requireAll)return me}else{if(Y(xe))continue;{const Oe=ie.getValues(Q,xe)[0];let $e=!1;if(Oe&&(T([Oe]),$e="@default"in Oe),se=!1,0===te.length&&$e)continue;if(te.length>0&&_e)return!1;if(void 0===Oe){if(te.length>0)return!1;me=!0}else if(U.isList(Oe)){const st=Oe["@list"][0];if(U.isList(te[0])){const Qe=te[0]["@list"];U.isValue(st)?me=Qe.some(et=>X(st,et)):(U.isSubject(st)||U.isSubjectReference(st))&&(me=Qe.some(et=>O(E,st,et,ae)))}}else me=U.isValue(Oe)?te.some(st=>X(Oe,st)):U.isSubjectReference(Oe)?te.some(st=>O(E,Oe,st,ae)):!!k.isObject(Oe)&&te.length>0}}if(!me&&ae.requireAll)return!1;ee=ee||me}return se||ee}function q(E,G){const Q=E.uniqueEmbeds[E.graph],ae=Q[G],se=ae.parent,ee=ae.property,xe={"@id":G};if(k.isArray(se)){for(let te=0;te<se.length;++te)if(ie.compareValues(se[te],xe)){se[te]=xe;break}}else{const te=k.isArray(se[ee]);ie.removeValue(se,ee,xe,{propertyIsArray:te}),ie.addValue(se,ee,xe,{propertyIsArray:te})}const me=te=>{const _e=Object.keys(Q);for(const Oe of _e)Oe in Q&&k.isObject(Q[Oe].parent)&&Q[Oe].parent["@id"]===te&&(delete Q[Oe],me(Oe))};me(G)}function ue(E,G){if(k.isArray(E))return E.map(Q=>ue(Q,G));if(k.isObject(E)){if("@preserve"in E)return E["@preserve"][0];if(U.isValue(E))return E;if(U.isList(E))return E["@list"]=ue(E["@list"],G),E;if("@id"in E){const Q=E["@id"];if(G.link.hasOwnProperty(Q)){const ae=G.link[Q].indexOf(E);if(-1!==ae)return G.link[Q][ae];G.link[Q].push(E)}else G.link[Q]=[E]}for(const Q in E)"@id"===Q&&G.bnodesToClear.includes(E[Q])?delete E["@id"]:E[Q]=ue(E[Q],G)}return E}function D(E,G,Q){k.isObject(E)?ie.addValue(E,G,Q,{propertyIsArray:!0}):E.push(Q)}function O(E,G,Q,ae){if(!("@id"in Q))return!1;const se=E.subjects[Q["@id"]];return se&&R(E,se,G,ae)}function X(E,G){const Q=G["@value"],ae=G["@type"],se=G["@language"],ee=E["@value"]?k.isArray(E["@value"])?E["@value"]:[E["@value"]]:[],xe=E["@type"]?k.isArray(E["@type"])?E["@type"]:[E["@type"]]:[],me=E["@language"]?k.isArray(E["@language"])?E["@language"]:[E["@language"]]:[];return 0===ee.length&&0===xe.length&&0===me.length||!(!ee.includes(Q)&&!k.isEmptyObject(ee[0])||!(!ae&&0===xe.length||xe.includes(ae)||ae&&k.isEmptyObject(xe[0]))||!(!se&&0===me.length||me.includes(se)||se&&k.isEmptyObject(me[0])))}Me.exports=M,M.frameMergedOrDefault=(E,G,Q)=>{const ae={options:Q,embedded:!1,graph:"@default",graphMap:{"@default":{}},subjectStack:[],link:{},bnodeMap:{}},se=new ie.IdentifierIssuer("_:b");C(E,ae.graphMap,"@default",se),Q.merged&&(ae.graphMap["@merged"]=P(ae.graphMap),ae.graph="@merged"),ae.subjects=ae.graphMap[ae.graph];const ee=[];return M.frame(ae,Object.keys(ae.subjects).sort(),G,ee),Q.pruneBlankNodeIdentifiers&&(Q.bnodesToClear=Object.keys(ae.bnodeMap).filter(xe=>1===ae.bnodeMap[xe].length)),Q.link={},ue(ee,Q)},M.frame=(E,G,Q,ae,se=null)=>{T(Q);const ee=E.options,xe={embed:S(Q=Q[0],ee,"embed"),explicit:S(Q,ee,"explicit"),requireAll:S(Q,ee,"requireAll")};E.link.hasOwnProperty(E.graph)||(E.link[E.graph]={});const me=E.link[E.graph],te=function(E,G,Q,ae){const se={};for(const ee of G){const xe=E.graphMap[E.graph][ee];R(E,xe,Q,ae)&&(se[ee]=xe)}return se}(E,G,Q,xe),_e=Object.keys(te).sort();for(const Oe of _e){const $e=te[Oe];if(null===se?E.uniqueEmbeds={[E.graph]:{}}:E.uniqueEmbeds[E.graph]=E.uniqueEmbeds[E.graph]||{},"@link"===xe.embed&&Oe in me){D(ae,se,me[Oe]);continue}const st={"@id":Oe};if(0===Oe.indexOf("_:")&&ie.addValue(E.bnodeMap,Oe,st,{propertyIsArray:!0}),me[Oe]=st,("@first"===xe.embed||"@last"===xe.embed)&&E.is11)throw new b("Invalid JSON-LD syntax; invalid value of @embed.","jsonld.SyntaxError",{code:"invalid @embed value",frame:Q});if(E.embedded||!E.uniqueEmbeds[E.graph].hasOwnProperty(Oe)){if(E.embedded&&("@never"===xe.embed||y($e,E.graph,E.subjectStack))){D(ae,se,st);continue}if(E.embedded&&("@first"==xe.embed||"@once"==xe.embed)&&E.uniqueEmbeds[E.graph].hasOwnProperty(Oe)){D(ae,se,st);continue}if("@last"===xe.embed&&Oe in E.uniqueEmbeds[E.graph]&&q(E,Oe),E.uniqueEmbeds[E.graph][Oe]={parent:ae,property:se},E.subjectStack.push({subject:$e,graph:E.graph}),Oe in E.graphMap){let Qe=!1,et=null;"@graph"in Q?(et=Q["@graph"][0],Qe=!("@merged"===Oe||"@default"===Oe),k.isObject(et)||(et={})):(Qe="@merged"!==E.graph,et={}),Qe&&M.frame(Hn(dt({},E),{graph:Oe,embedded:!1}),Object.keys(E.graphMap[Oe]).sort(),[et],st,"@graph")}"@included"in Q&&M.frame(Hn(dt({},E),{embedded:!1}),G,Q["@included"],st,"@included");for(const Qe of Object.keys($e).sort())if(Y(Qe)){if(st[Qe]=ie.clone($e[Qe]),"@type"===Qe)for(const et of $e["@type"])0===et.indexOf("_:")&&ie.addValue(E.bnodeMap,et,st,{propertyIsArray:!0})}else if(!xe.explicit||Qe in Q)for(const et of $e[Qe]){const Ke=Qe in Q?Q[Qe]:v(xe);if(U.isList(et)){const Ue=Q[Qe]&&Q[Qe][0]&&Q[Qe][0]["@list"]?Q[Qe][0]["@list"]:v(xe),Le={"@list":[]};D(st,Qe,Le);const Xe=et["@list"];for(const Te of Xe)U.isSubjectReference(Te)?M.frame(Hn(dt({},E),{embedded:!0}),[Te["@id"]],Ue,Le,"@list"):D(Le,"@list",ie.clone(Te))}else U.isSubjectReference(et)?M.frame(Hn(dt({},E),{embedded:!0}),[et["@id"]],Ke,st,Qe):X(Ke[0],et)&&D(st,Qe,ie.clone(et))}for(const Qe of Object.keys(Q).sort()){if("@type"===Qe){if(!k.isObject(Q[Qe][0])||!("@default"in Q[Qe][0]))continue}else if(Y(Qe))continue;const et=Q[Qe][0]||{};if(!S(et,ee,"omitDefault")&&!(Qe in st)){let Ue="@null";"@default"in et&&(Ue=ie.clone(et["@default"])),k.isArray(Ue)||(Ue=[Ue]),st[Qe]=[{"@preserve":Ue}]}}for(const Qe of Object.keys(Q["@reverse"]||{}).sort()){const et=Q["@reverse"][Qe];for(const Ke of Object.keys(E.subjects))ie.getValues(E.subjects[Ke],Qe).some(Le=>Le["@id"]===Oe)&&(st["@reverse"]=st["@reverse"]||{},ie.addValue(st["@reverse"],Qe,[],{propertyIsArray:!0}),M.frame(Hn(dt({},E),{embedded:!0}),[Ke],et,st["@reverse"][Qe],se))}D(ae,se,st),E.subjectStack.pop()}}},M.cleanupNull=(E,G)=>{if(k.isArray(E))return E.map(ae=>M.cleanupNull(ae,G)).filter(ae=>ae);if("@null"===E)return null;if(k.isObject(E)){if("@id"in E){const Q=E["@id"];if(G.link.hasOwnProperty(Q)){const ae=G.link[Q].indexOf(E);if(-1!==ae)return G.link[Q][ae];G.link[Q].push(E)}else G.link[Q]=[E]}for(const Q in E)E[Q]=M.cleanupNull(E[Q],G)}return E}},{"./JsonLdError":12,"./context":19,"./graphTypes":25,"./nodeMap":27,"./types":30,"./url":31,"./util":32}],24:[function(K,Me,pe){"use strict";const Y=K("./JsonLdError"),U=K("./graphTypes"),k=K("./types"),ie=K("./util"),{RDF_LIST:W,RDF_FIRST:b,RDF_REST:C,RDF_NIL:P,RDF_TYPE:M,RDF_JSON_LITERAL:v,XSD_BOOLEAN:y,XSD_DOUBLE:S,XSD_INTEGER:T,XSD_STRING:j}=K("./constants"),R=/^[a-zA-Z]{1,8}(-[a-zA-Z0-9]{1,8})*$/,q={};function ue(D,O,X){if(D.termType.endsWith("Node"))return{"@id":D.value};const E={"@value":D.value};if(D.language)E["@language"]=D.language;else{let G=D.datatype.value;if(G||(G=j),G===v){G="@json";try{E["@value"]=JSON.parse(E["@value"])}catch(Q){throw new Y("JSON literal could not be parsed.","jsonld.InvalidJsonLiteral",{code:"invalid JSON literal",value:E["@value"],cause:Q})}}if(O){if(G===y)"true"===E["@value"]?E["@value"]=!0:"false"===E["@value"]&&(E["@value"]=!1);else if(k.isNumeric(E["@value"]))if(G===T){const Q=parseInt(E["@value"],10);Q.toFixed(0)===E["@value"]&&(E["@value"]=Q)}else G===S&&(E["@value"]=parseFloat(E["@value"]));[y,T,S,j].includes(G)||(E["@type"]=G)}else if("i18n-datatype"===X&&G.startsWith("https://www.w3.org/ns/i18n#")){const[,Q,ae]=G.split(/[#_]/);Q.length>0&&(E["@language"]=Q,Q.match(R)||console.warn(`@language must be valid BCP47: ${Q}`)),E["@direction"]=ae}else G!==j&&(E["@type"]=G)}return E}Me.exports=q,q.fromRDF=function(){var D=mt(function*(O,{useRdfType:X=!1,useNativeTypes:E=!1,rdfDirection:G=null}){const Q={},ae={"@default":Q},se={};for(const me of O){const te="DefaultGraph"===me.graph.termType?"@default":me.graph.value;te in ae||(ae[te]={}),"@default"!==te&&!(te in Q)&&(Q[te]={"@id":te});const _e=ae[te],Oe=me.subject.value,$e=me.predicate.value,st=me.object;Oe in _e||(_e[Oe]={"@id":Oe});const Qe=_e[Oe],et=st.termType.endsWith("Node");if(et&&!(st.value in _e)&&(_e[st.value]={"@id":st.value}),$e===M&&!X&&et){ie.addValue(Qe,"@type",st.value,{propertyIsArray:!0});continue}const Ke=ue(st,E,G);if(ie.addValue(Qe,$e,Ke,{propertyIsArray:!0}),et)if(st.value===P){const Ue=_e[st.value];"usages"in Ue||(Ue.usages=[]),Ue.usages.push({node:Qe,property:$e,value:Ke})}else se[st.value]=!(st.value in se)&&{node:Qe,property:$e,value:Ke}}for(const me in ae){const te=ae[me];if(!(P in te))continue;const _e=te[P];if(_e.usages){for(let Oe of _e.usages){let $e=Oe.node,st=Oe.property,Qe=Oe.value;const et=[],Ke=[];let Ue=Object.keys($e).length;for(;st===C&&k.isObject(se[$e["@id"]])&&k.isArray($e[b])&&1===$e[b].length&&k.isArray($e[C])&&1===$e[C].length&&(3===Ue||4===Ue&&k.isArray($e["@type"])&&1===$e["@type"].length&&$e["@type"][0]===W)&&(et.push($e[b][0]),Ke.push($e["@id"]),Oe=se[$e["@id"]],$e=Oe.node,st=Oe.property,Qe=Oe.value,Ue=Object.keys($e).length,U.isBlankNode($e)););delete Qe["@id"],Qe["@list"]=et.reverse();for(const Le of Ke)delete te[Le]}delete _e.usages}}const ee=[],xe=Object.keys(Q).sort();for(const me of xe){const te=Q[me];if(me in ae){const _e=te["@graph"]=[],Oe=ae[me],$e=Object.keys(Oe).sort();for(const st of $e){const Qe=Oe[st];U.isSubjectReference(Qe)||_e.push(Qe)}}U.isSubjectReference(te)||ee.push(te)}return ee});return function(O,X){return D.apply(this,arguments)}}()},{"./JsonLdError":12,"./constants":18,"./graphTypes":25,"./types":30,"./util":32}],25:[function(K,Me,pe){"use strict";const Y=K("./types"),U={};Me.exports=U,U.isSubject=k=>!(!Y.isObject(k)||"@value"in k||"@set"in k||"@list"in k)&&(Object.keys(k).length>1||!("@id"in k)),U.isSubjectReference=k=>Y.isObject(k)&&1===Object.keys(k).length&&"@id"in k,U.isValue=k=>Y.isObject(k)&&"@value"in k,U.isList=k=>Y.isObject(k)&&"@list"in k,U.isGraph=k=>Y.isObject(k)&&"@graph"in k&&1===Object.keys(k).filter(ie=>"@id"!==ie&&"@index"!==ie).length,U.isSimpleGraph=k=>U.isGraph(k)&&!("@id"in k),U.isBlankNode=k=>!!Y.isObject(k)&&("@id"in k?0===k["@id"].indexOf("_:"):0===Object.keys(k).length||!("@value"in k||"@set"in k||"@list"in k))},{"./types":30}],26:[function(K,Me,pe){const Y=K("rdf-canonize"),U=K("./platform"),k=K("./util"),ie=K("./ContextResolver"),W=k.IdentifierIssuer,b=K("./JsonLdError"),C=K("lru-cache"),P=K("./NQuads"),{expand:M}=K("./expand"),{flatten:v}=K("./flatten"),{fromRDF:y}=K("./fromRdf"),{toRDF:S}=K("./toRdf"),{frameMergedOrDefault:T,cleanupNull:j}=K("./frame"),{isArray:R,isObject:q,isString:ue}=K("./types"),{isSubjectReference:D}=K("./graphTypes"),{expandIri:O,getInitialContext:X,process:E,processingMode:G}=K("./context"),{compact:Q,compactIri:ae}=K("./compact"),{createNodeMap:se,createMergedNodeMap:ee,mergeNodeMaps:xe}=K("./nodeMap"),me=function(_e){const Oe={},st=new C({max:100});function Qe(et,Le){var Xe=Le,{documentLoader:Ke=_e.documentLoader}=Xe,Ue=p9(Xe,["documentLoader"]);return Object.assign({},{documentLoader:Ke},Ue,et)}return _e.compact=function(){var et=mt(function*(Ke,Ue,Le){if(arguments.length<2)throw new TypeError("Could not compact, too few arguments.");if(null===Ue)throw new b("The compaction context must not be null.","jsonld.CompactError",{code:"invalid local context"});if(null===Ke)return null;let Xe;(Le=Qe(Le,{base:ue(Ke)?Ke:"",compactArrays:!0,compactToRelative:!0,graph:!1,skipExpansion:!1,link:!1,issuer:new W("_:b"),contextResolver:new ie({sharedCache:st})})).link&&(Le.skipExpansion=!0),Le.compactToRelative||delete Le.base,Xe=Le.skipExpansion?Ke:yield _e.expand(Ke,Le);const Te=yield _e.processContext(X(Le),Ue,Le);let je=yield Q({activeCtx:Te,element:Xe,options:Le,compactionMap:Le.compactionMap});Le.compactArrays&&!Le.graph&&R(je)?1===je.length?je=je[0]:0===je.length&&(je={}):Le.graph&&q(je)&&(je=[je]),q(Ue)&&"@context"in Ue&&(Ue=Ue["@context"]),Ue=k.clone(Ue),R(Ue)||(Ue=[Ue]);const qe=Ue;Ue=[];for(let $=0;$<qe.length;++$)(!q(qe[$])||Object.keys(qe[$]).length>0)&&Ue.push(qe[$]);const Ne=Ue.length>0;if(1===Ue.length&&(Ue=Ue[0]),R(je)){const $=ae({activeCtx:Te,iri:"@graph",relativeTo:{vocab:!0}}),z=je;je={},Ne&&(je["@context"]=Ue),je[$]=z}else if(q(je)&&Ne){const $=je;je={"@context":Ue};for(const z in $)je[z]=$[z]}return je});return function(Ke,Ue,Le){return et.apply(this,arguments)}}(),_e.expand=function(){var et=mt(function*(Ke,Ue){if(arguments.length<1)throw new TypeError("Could not expand, too few arguments.");!1===(Ue=Qe(Ue,{keepFreeFloatingNodes:!1,contextResolver:new ie({sharedCache:st})})).expansionMap&&(Ue.expansionMap=void 0);const Le={},Xe=[];if("expandContext"in Ue){const Ne=k.clone(Ue.expandContext);Le.expandContext=q(Ne)&&"@context"in Ne?Ne:{"@context":Ne},Xe.push(Le.expandContext)}let Te;if(ue(Ke)){const Ne=yield _e.get(Ke,Ue);Te=Ne.documentUrl,Le.input=Ne.document,Ne.contextUrl&&(Le.remoteContext={"@context":Ne.contextUrl},Xe.push(Le.remoteContext))}else Le.input=k.clone(Ke);"base"in Ue||(Ue.base=Te||"");let je=X(Ue);for(const Ne of Xe)je=yield E({activeCtx:je,localCtx:Ne,options:Ue});let qe=yield M({activeCtx:je,element:Le.input,options:Ue,expansionMap:Ue.expansionMap});return q(qe)&&"@graph"in qe&&1===Object.keys(qe).length?qe=qe["@graph"]:null===qe&&(qe=[]),R(qe)||(qe=[qe]),qe});return function(Ke,Ue){return et.apply(this,arguments)}}(),_e.flatten=function(){var et=mt(function*(Ke,Ue,Le){if(arguments.length<1)return new TypeError("Could not flatten, too few arguments.");Ue="function"==typeof Ue?null:Ue||null,Le=Qe(Le,{base:ue(Ke)?Ke:"",contextResolver:new ie({sharedCache:st})});const Xe=yield _e.expand(Ke,Le),Te=v(Xe);return null===Ue?Te:(Le.graph=!0,Le.skipExpansion=!0,yield _e.compact(Te,Ue,Le))});return function(Ke,Ue,Le){return et.apply(this,arguments)}}(),_e.frame=function(){var et=mt(function*(Ke,Ue,Le){if(arguments.length<2)throw new TypeError("Could not frame, too few arguments.");if(Le=Qe(Le,{base:ue(Ke)?Ke:"",embed:"@once",explicit:!1,requireAll:!1,omitDefault:!1,bnodesToClear:[],contextResolver:new ie({sharedCache:st})}),ue(Ue)){const de=yield _e.get(Ue,Le);if(Ue=de.document,de.contextUrl){let Ve=Ue["@context"];Ve?R(Ve)?Ve.push(de.contextUrl):Ve=[Ve,de.contextUrl]:Ve=de.contextUrl,Ue["@context"]=Ve}}const Xe=Ue&&Ue["@context"]||{},Te=yield _e.processContext(X(Le),Xe,Le);Le.hasOwnProperty("omitGraph")||(Le.omitGraph=G(Te,1.1)),Le.hasOwnProperty("pruneBlankNodeIdentifiers")||(Le.pruneBlankNodeIdentifiers=G(Te,1.1));const je=yield _e.expand(Ke,Le),qe=dt({},Le);qe.isFrame=!0,qe.keepFreeFloatingNodes=!0;const Ne=yield _e.expand(Ue,qe),$=Object.keys(Ue).map(de=>O(Te,de,{vocab:!0}));qe.merged=!$.includes("@graph"),qe.is11=G(Te,1.1);const z=T(je,Ne,qe);qe.graph=!Le.omitGraph,qe.skipExpansion=!0,qe.link={},qe.framing=!0;let fe=yield _e.compact(z,Xe,qe);return qe.link={},fe=j(fe,qe),fe});return function(Ke,Ue,Le){return et.apply(this,arguments)}}(),_e.link=function(){var et=mt(function*(Ke,Ue,Le){const Xe={};return Ue&&(Xe["@context"]=Ue),Xe["@embed"]="@link",_e.frame(Ke,Xe,Le)});return function(Ke,Ue,Le){return et.apply(this,arguments)}}(),_e.normalize=_e.canonize=function(){var et=mt(function*(Ke,Ue){if(arguments.length<1)throw new TypeError("Could not canonize, too few arguments.");if("inputFormat"in(Ue=Qe(Ue,{base:ue(Ke)?Ke:"",algorithm:"URDNA2015",skipExpansion:!1,contextResolver:new ie({sharedCache:st})}))){if("application/n-quads"!==Ue.inputFormat&&"application/nquads"!==Ue.inputFormat)throw new b("Unknown canonicalization input format.","jsonld.CanonizeError");const Te=P.parse(Ke);return Y.canonize(Te,Ue)}const Le=dt({},Ue);delete Le.format,Le.produceGeneralizedRdf=!1;const Xe=yield _e.toRDF(Ke,Le);return Y.canonize(Xe,Ue)});return function(Ke,Ue){return et.apply(this,arguments)}}(),_e.fromRDF=function(){var et=mt(function*(Ke,Ue){if(arguments.length<1)throw new TypeError("Could not convert from RDF, too few arguments.");Ue=Qe(Ue,{format:ue(Ke)?"application/n-quads":void 0});const{format:Le}=Ue;let{rdfParser:Xe}=Ue;if(Le){if(Xe=Xe||Oe[Le],!Xe)throw new b("Unknown input format.","jsonld.UnknownFormat",{format:Le})}else Xe=()=>Ke;const Te=yield Xe(Ke);return y(Te,Ue)});return function(Ke,Ue){return et.apply(this,arguments)}}(),_e.toRDF=function(){var et=mt(function*(Ke,Ue){if(arguments.length<1)throw new TypeError("Could not convert to RDF, too few arguments.");let Le;Le=(Ue=Qe(Ue,{base:ue(Ke)?Ke:"",skipExpansion:!1,contextResolver:new ie({sharedCache:st})})).skipExpansion?Ke:yield _e.expand(Ke,Ue);const Xe=S(Le,Ue);if(Ue.format){if("application/n-quads"===Ue.format||"application/nquads"===Ue.format)return P.serialize(Xe);throw new b("Unknown output format.","jsonld.UnknownFormat",{format:Ue.format})}return Xe});return function(Ke,Ue){return et.apply(this,arguments)}}(),_e.createNodeMap=function(){var et=mt(function*(Ke,Ue){if(arguments.length<1)throw new TypeError("Could not create node map, too few arguments.");Ue=Qe(Ue,{base:ue(Ke)?Ke:"",contextResolver:new ie({sharedCache:st})});const Le=yield _e.expand(Ke,Ue);return ee(Le,Ue)});return function(Ke,Ue){return et.apply(this,arguments)}}(),_e.merge=function(){var et=mt(function*(Ke,Ue,Le){if(arguments.length<1)throw new TypeError("Could not merge, too few arguments.");if(!R(Ke))throw new TypeError('Could not merge, "docs" must be an array.');Ue="function"==typeof Ue?null:Ue||null,Le=Qe(Le,{contextResolver:new ie({sharedCache:st})});const Xe=yield Promise.all(Ke.map(de=>{const Ve=dt({},Le);return _e.expand(de,Ve)}));let Te=!0;"mergeNodes"in Le&&(Te=Le.mergeNodes);const je=Le.issuer||new W("_:b"),qe={"@default":{}};for(let de=0;de<Xe.length;++de){const Ve=k.relabelBlankNodes(Xe[de],{issuer:new W("_:b"+de+"-")}),gt=Te||0===de?qe:{"@default":{}};if(se(Ve,gt,"@default",je),gt!==qe)for(const ft in gt){const be=gt[ft];if(!(ft in qe)){qe[ft]=be;continue}const B=qe[ft];for(const N in be)N in B||(B[N]=be[N])}}const Ne=xe(qe),$=[],z=Object.keys(Ne).sort();for(let de=0;de<z.length;++de){const Ve=Ne[z[de]];D(Ve)||$.push(Ve)}return null===Ue?$:(Le.graph=!0,Le.skipExpansion=!0,yield _e.compact($,Ue,Le))});return function(Ke,Ue,Le){return et.apply(this,arguments)}}(),Object.defineProperty(_e,"documentLoader",{get:()=>_e._documentLoader,set:et=>_e._documentLoader=et}),_e.documentLoader=function(){var et=mt(function*(Ke){throw new b("Could not retrieve a JSON-LD document from the URL. URL dereferencing not implemented.","jsonld.LoadDocumentError",{code:"loading document failed",url:Ke})});return function(Ke){return et.apply(this,arguments)}}(),_e.get=function(){var et=mt(function*(Ke,Ue){let Le;Le="function"==typeof Ue.documentLoader?Ue.documentLoader:_e.documentLoader;const Xe=yield Le(Ke);try{if(!Xe.document)throw new b("No remote document found at the given URL.","jsonld.NullRemoteDocument");ue(Xe.document)&&(Xe.document=JSON.parse(Xe.document))}catch(Te){throw new b("Could not retrieve a JSON-LD document from the URL.","jsonld.LoadDocumentError",{code:"loading document failed",cause:Te,remoteDoc:Xe})}return Xe});return function(Ke,Ue){return et.apply(this,arguments)}}(),_e.processContext=function(){var et=mt(function*(Ke,Ue,Le){return Le=Qe(Le,{base:"",contextResolver:new ie({sharedCache:st})}),null===Ue?X(Le):(Ue=k.clone(Ue),q(Ue)&&"@context"in Ue||(Ue={"@context":Ue}),E({activeCtx:Ke,localCtx:Ue,options:Le}))});return function(Ke,Ue,Le){return et.apply(this,arguments)}}(),_e.getContextValue=K("./context").getContextValue,_e.documentLoaders={},_e.useDocumentLoader=function(et){if(!(et in _e.documentLoaders))throw new b('Unknown document loader type: "'+et+'"',"jsonld.UnknownDocumentLoader",{type:et});_e.documentLoader=_e.documentLoaders[et].apply(_e,Array.prototype.slice.call(arguments,1))},_e.registerRDFParser=function(et,Ke){Oe[et]=Ke},_e.unregisterRDFParser=function(et){delete Oe[et]},_e.registerRDFParser("application/n-quads",P.parse),_e.registerRDFParser("application/nquads",P.parse),_e.url=K("./url"),_e.util=k,Object.assign(_e,k),_e.promises=_e,_e.RequestQueue=K("./RequestQueue"),_e.JsonLdProcessor=K("./JsonLdProcessor")(_e),U.setupGlobals(_e),U.setupDocumentLoaders(_e),_e},te=function(){return me(function(){return te()})};me(te),Me.exports=te},{"./ContextResolver":11,"./JsonLdError":12,"./JsonLdProcessor":13,"./NQuads":14,"./RequestQueue":15,"./compact":17,"./context":19,"./expand":21,"./flatten":22,"./frame":23,"./fromRdf":24,"./graphTypes":25,"./nodeMap":27,"./platform":28,"./toRdf":29,"./types":30,"./url":31,"./util":32,"lru-cache":33,"rdf-canonize":46}],27:[function(K,Me,pe){"use strict";const{isKeyword:Y}=K("./context"),U=K("./graphTypes"),k=K("./types"),ie=K("./util"),W=K("./JsonLdError"),b={};Me.exports=b,b.createMergedNodeMap=(C,P)=>{const M=(P=P||{}).issuer||new ie.IdentifierIssuer("_:b"),v={"@default":{}};return b.createNodeMap(C,v,"@default",M),b.mergeNodeMaps(v)},b.createNodeMap=(C,P,M,v,y,S)=>{if(k.isArray(C)){for(const q of C)b.createNodeMap(q,P,M,v,void 0,S);return}if(!k.isObject(C))return void(S&&S.push(C));if(U.isValue(C)){if("@type"in C){let q=C["@type"];0===q.indexOf("_:")&&(C["@type"]=q=v.getId(q))}return void(S&&S.push(C))}if(S&&U.isList(C)){const q=[];return b.createNodeMap(C["@list"],P,M,v,y,q),void S.push({"@list":q})}if("@type"in C){const q=C["@type"];for(const ue of q)0===ue.indexOf("_:")&&v.getId(ue)}k.isUndefined(y)&&(y=U.isBlankNode(C)?v.getId(C["@id"]):C["@id"]),S&&S.push({"@id":y});const T=P[M],j=T[y]=T[y]||{};j["@id"]=y;const R=Object.keys(C).sort();for(let q of R){if("@id"===q)continue;if("@reverse"===q){const D={"@id":y},O=C["@reverse"];for(const X in O){const E=O[X];for(const G of E){let Q=G["@id"];U.isBlankNode(G)&&(Q=v.getId(Q)),b.createNodeMap(G,P,M,v,Q),ie.addValue(T[Q],X,D,{propertyIsArray:!0,allowDuplicate:!1})}}continue}if("@graph"===q){y in P||(P[y]={}),b.createNodeMap(C[q],P,y,v);continue}if("@included"===q){b.createNodeMap(C[q],P,M,v);continue}if("@type"!==q&&Y(q)){if("@index"===q&&q in j&&(C[q]!==j[q]||C[q]["@id"]!==j[q]["@id"]))throw new W("Invalid JSON-LD syntax; conflicting @index property detected.","jsonld.SyntaxError",{code:"conflicting indexes",subject:j});j[q]=C[q];continue}const ue=C[q];if(0===q.indexOf("_:")&&(q=v.getId(q)),0!==ue.length)for(let D of ue)if("@type"===q&&(D=0===D.indexOf("_:")?v.getId(D):D),U.isSubject(D)||U.isSubjectReference(D)){if("@id"in D&&!D["@id"])continue;const O=U.isBlankNode(D)?v.getId(D["@id"]):D["@id"];ie.addValue(j,q,{"@id":O},{propertyIsArray:!0,allowDuplicate:!1}),b.createNodeMap(D,P,M,v,O)}else if(U.isValue(D))ie.addValue(j,q,D,{propertyIsArray:!0,allowDuplicate:!1});else if(U.isList(D)){const O=[];b.createNodeMap(D["@list"],P,M,v,y,O),D={"@list":O},ie.addValue(j,q,D,{propertyIsArray:!0,allowDuplicate:!1})}else b.createNodeMap(D,P,M,v,y),ie.addValue(j,q,D,{propertyIsArray:!0,allowDuplicate:!1});else ie.addValue(j,q,[],{propertyIsArray:!0})}},b.mergeNodeMapGraphs=C=>{const P={};for(const M of Object.keys(C).sort())for(const v of Object.keys(C[M]).sort()){const y=C[M][v];v in P||(P[v]={"@id":v});const S=P[v];for(const T of Object.keys(y).sort())if(Y(T)&&"@type"!==T)S[T]=ie.clone(y[T]);else for(const j of y[T])ie.addValue(S,T,ie.clone(j),{propertyIsArray:!0,allowDuplicate:!1})}return P},b.mergeNodeMaps=C=>{const P=C["@default"],M=Object.keys(C).sort();for(const v of M){if("@default"===v)continue;const y=C[v];let S=P[v];S?"@graph"in S||(S["@graph"]=[]):P[v]=S={"@id":v,"@graph":[]};const T=S["@graph"];for(const j of Object.keys(y).sort()){const R=y[j];U.isSubjectReference(R)||T.push(R)}}return P}},{"./JsonLdError":12,"./context":19,"./graphTypes":25,"./types":30,"./util":32}],28:[function(K,Me,pe){"use strict";const Y=K("./documentLoaders/xhr"),U={};Me.exports=U,U.setupDocumentLoaders=function(k){"undefined"!=typeof XMLHttpRequest&&(k.documentLoaders.xhr=Y,k.useDocumentLoader("xhr"))},U.setupGlobals=function(k){void 0===globalThis.JsonLdProcessor&&Object.defineProperty(globalThis,"JsonLdProcessor",{writable:!0,enumerable:!1,configurable:!0,value:k.JsonLdProcessor})}},{"./documentLoaders/xhr":20}],29:[function(K,Me,pe){"use strict";const{createNodeMap:Y}=K("./nodeMap"),{isKeyword:U}=K("./context"),k=K("./graphTypes"),ie=K("canonicalize"),W=K("./types"),b=K("./util"),{RDF_FIRST:C,RDF_REST:P,RDF_NIL:M,RDF_TYPE:v,RDF_JSON_LITERAL:y,RDF_LANGSTRING:S,XSD_BOOLEAN:T,XSD_DOUBLE:j,XSD_INTEGER:R,XSD_STRING:q}=K("./constants"),{isAbsolute:ue}=K("./url"),D={};function O(G,Q,ae,se,ee){const xe=Object.keys(Q).sort();for(const me of xe){const te=Q[me],_e=Object.keys(te).sort();for(let Oe of _e){const $e=te[Oe];if("@type"===Oe)Oe=v;else if(U(Oe))continue;for(const st of $e){const Qe={termType:me.startsWith("_:")?"BlankNode":"NamedNode",value:me};if(!ue(me))continue;const et={termType:Oe.startsWith("_:")?"BlankNode":"NamedNode",value:Oe};if(!ue(Oe)||"BlankNode"===et.termType&&!ee.produceGeneralizedRdf)continue;const Ke=E(st,se,G,ae,ee.rdfDirection);Ke&&G.push({subject:Qe,predicate:et,object:Ke,graph:ae})}}}}function E(G,Q,ae,se,ee){const xe={};if(k.isValue(G)){xe.termType="Literal",xe.value=void 0,xe.datatype={termType:"NamedNode"};let me=G["@value"];const te=G["@type"]||null;"@json"===te?(xe.value=ie(me),xe.datatype.value=y):W.isBoolean(me)?(xe.value=me.toString(),xe.datatype.value=te||T):W.isDouble(me)||te===j?(W.isDouble(me)||(me=parseFloat(me)),xe.value=me.toExponential(15).replace(/(\d)0*e\+?/,"$1E"),xe.datatype.value=te||j):W.isNumber(me)?(xe.value=me.toFixed(0),xe.datatype.value=te||R):"i18n-datatype"===ee&&"@direction"in G?(xe.datatype.value="https://www.w3.org/ns/i18n#"+(G["@language"]||"")+`_${G["@direction"]}`,xe.value=me):"@language"in G?(xe.value=me,xe.datatype.value=te||S,xe.language=G["@language"]):(xe.value=me,xe.datatype.value=te||q)}else if(k.isList(G)){const me=function(G,Q,ae,se,ee){const xe={termType:"NamedNode",value:C},me={termType:"NamedNode",value:P},te={termType:"NamedNode",value:M},_e=G.pop(),Oe=_e?{termType:"BlankNode",value:Q.getId()}:te;let $e=Oe;for(const st of G){const Qe=E(st,Q,ae,se,ee),et={termType:"BlankNode",value:Q.getId()};ae.push({subject:$e,predicate:xe,object:Qe,graph:se}),ae.push({subject:$e,predicate:me,object:et,graph:se}),$e=et}if(_e){const st=E(_e,Q,ae,se,ee);ae.push({subject:$e,predicate:xe,object:st,graph:se}),ae.push({subject:$e,predicate:me,object:te,graph:se})}return Oe}(G["@list"],Q,ae,se,ee);xe.termType=me.termType,xe.value=me.value}else{const me=W.isObject(G)?G["@id"]:G;xe.termType=me.startsWith("_:")?"BlankNode":"NamedNode",xe.value=me}return"NamedNode"!==xe.termType||ue(xe.value)?xe:null}Me.exports=D,D.toRDF=(G,Q)=>{const ae=new b.IdentifierIssuer("_:b"),se={"@default":{}};Y(G,se,"@default",ae);const ee=[],xe=Object.keys(se).sort();for(const me of xe){let te;if("@default"===me)te={termType:"DefaultGraph",value:""};else{if(!ue(me))continue;te=me.startsWith("_:")?{termType:"BlankNode"}:{termType:"NamedNode"},te.value=me}O(ee,se[me],te,ae,Q)}return ee}},{"./constants":18,"./context":19,"./graphTypes":25,"./nodeMap":27,"./types":30,"./url":31,"./util":32,canonicalize:7}],30:[function(K,Me,pe){"use strict";const Y={};Me.exports=Y,Y.isArray=Array.isArray,Y.isBoolean=U=>"boolean"==typeof U||"[object Boolean]"===Object.prototype.toString.call(U),Y.isDouble=U=>Y.isNumber(U)&&(-1!==String(U).indexOf(".")||Math.abs(U)>=1e21),Y.isEmptyObject=U=>Y.isObject(U)&&0===Object.keys(U).length,Y.isNumber=U=>"number"==typeof U||"[object Number]"===Object.prototype.toString.call(U),Y.isNumeric=U=>!isNaN(parseFloat(U))&&isFinite(U),Y.isObject=U=>"[object Object]"===Object.prototype.toString.call(U),Y.isString=U=>"string"==typeof U||"[object String]"===Object.prototype.toString.call(U),Y.isUndefined=U=>void 0===U},{}],31:[function(K,Me,pe){"use strict";const Y=K("./types"),U={};Me.exports=U,U.parsers={simple:{keys:["href","scheme","authority","path","query","fragment"],regex:/^(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/},full:{keys:["href","protocol","scheme","authority","auth","user","password","hostname","port","path","directory","file","query","fragment"],regex:/^(([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?(?:(((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/}},U.parse=(ie,W)=>{const b={},C=U.parsers[W||"full"],P=C.regex.exec(ie);let M=C.keys.length;for(;M--;)b[C.keys[M]]=void 0===P[M]?null:P[M];return("https"===b.scheme&&"443"===b.port||"http"===b.scheme&&"80"===b.port)&&(b.href=b.href.replace(":"+b.port,""),b.authority=b.authority.replace(":"+b.port,""),b.port=null),b.normalizedPath=U.removeDotSegments(b.path),b},U.prependBase=(ie,W)=>{if(null===ie||U.isAbsolute(W))return W;(!ie||Y.isString(ie))&&(ie=U.parse(ie||""));const b=U.parse(W),C={protocol:ie.protocol||""};if(null!==b.authority)C.authority=b.authority,C.path=b.path,C.query=b.query;else if(C.authority=ie.authority,""===b.path)C.path=ie.path,C.query=null!==b.query?b.query:ie.query;else{if(0===b.path.indexOf("/"))C.path=b.path;else{let M=ie.path;M=M.substr(0,M.lastIndexOf("/")+1),(M.length>0||ie.authority)&&"/"!==M.substr(-1)&&(M+="/"),M+=b.path,C.path=M}C.query=b.query}""!==b.path&&(C.path=U.removeDotSegments(C.path));let P=C.protocol;return null!==C.authority&&(P+="//"+C.authority),P+=C.path,null!==C.query&&(P+="?"+C.query),null!==b.fragment&&(P+="#"+b.fragment),""===P&&(P="./"),P},U.removeBase=(ie,W)=>{if(null===ie)return W;(!ie||Y.isString(ie))&&(ie=U.parse(ie||""));let b="";if(""!==ie.href?b+=(ie.protocol||"")+"//"+(ie.authority||""):W.indexOf("//")&&(b+="//"),0!==W.indexOf(b))return W;const C=U.parse(W.substr(b.length)),P=ie.normalizedPath.split("/"),M=C.normalizedPath.split("/"),v=C.fragment||C.query?0:1;for(;P.length>0&&M.length>v&&P[0]===M[0];)P.shift(),M.shift();let y="";if(P.length>0){P.pop();for(let S=0;S<P.length;++S)y+="../"}return y+=M.join("/"),null!==C.query&&(y+="?"+C.query),null!==C.fragment&&(y+="#"+C.fragment),""===y&&(y="./"),y},U.removeDotSegments=ie=>{if(0===ie.length)return"";const W=ie.split("/"),b=[];for(;W.length>0;){const C=W.shift(),P=0===W.length;"."!==C?".."!==C?b.push(C):(b.pop(),P&&b.push("")):P&&b.push("")}return"/"===ie[0]&&b.length>0&&""!==b[0]&&b.unshift(""),1===b.length&&""===b[0]?"/":b.join("/")};const k=/^([A-Za-z][A-Za-z0-9+-.]*|_):[^\s]*$/;U.isAbsolute=ie=>Y.isString(ie)&&k.test(ie),U.isRelative=ie=>Y.isString(ie)},{"./types":30}],32:[function(K,Me,pe){"use strict";const Y=K("./graphTypes"),U=K("./types"),k=K("rdf-canonize").IdentifierIssuer,ie=K("./JsonLdError"),W=/(?:<[^>]*?>|"[^"]*?"|[^,])+/g,b=/\s*<([^>]*?)>\s*(?:;\s*(.*))?/,C=/(.*?)=(?:(?:"([^"]*?)")|([^"]*?))\s*(?:(?:;\s*)|$)/g,P_headers={accept:"application/ld+json, application/json"},M={};function v(y,S){if(U.isArray(S))for(let T=0;T<S.length;++T)S[T]=v(y,S[T]);else if(Y.isList(S))S["@list"]=v(y,S["@list"]);else if(U.isObject(S)){Y.isBlankNode(S)&&(S["@id"]=y.getId(S["@id"]));const T=Object.keys(S).sort();for(let j=0;j<T.length;++j){const R=T[j];"@id"!==R&&(S[R]=v(y,S[R]))}}return S}Me.exports=M,M.IdentifierIssuer=k,M.clone=function(y){if(y&&"object"==typeof y){let S;if(U.isArray(y)){S=[];for(let T=0;T<y.length;++T)S[T]=M.clone(y[T])}else if(y instanceof Map){S=new Map;for(const[T,j]of y)S.set(T,M.clone(j))}else if(y instanceof Set){S=new Set;for(const T of y)S.add(M.clone(T))}else if(U.isObject(y)){S={};for(const T in y)S[T]=M.clone(y[T])}else S=y.toString();return S}return y},M.asArray=function(y){return Array.isArray(y)?y:[y]},M.buildHeaders=(y={})=>{if(Object.keys(y).some(T=>"accept"===T.toLowerCase()))throw new RangeError('Accept header may not be specified; only "'+P_headers.accept+'" is supported.');return Object.assign({Accept:P_headers.accept},y)},M.parseLinkHeader=y=>{const S={},T=y.match(W);for(let j=0;j<T.length;++j){let R=T[j].match(b);if(!R)continue;const q={target:R[1]},ue=R[2];for(;R=C.exec(ue);)q[R[1]]=void 0===R[2]?R[3]:R[2];const D=q.rel||"";Array.isArray(S[D])?S[D].push(q):S[D]=S.hasOwnProperty(D)?[S[D],q]:q}return S},M.validateTypeValue=(y,S)=>{if(!(U.isString(y)||U.isArray(y)&&y.every(T=>U.isString(T)))){if(S&&U.isObject(y))switch(Object.keys(y).length){case 0:return;case 1:if("@default"in y&&M.asArray(y["@default"]).every(T=>U.isString(T)))return}throw new ie('Invalid JSON-LD syntax; "@type" value must a string, an array of strings, an empty object, or a default object.',"jsonld.SyntaxError",{code:"invalid type value",value:y})}},M.hasProperty=(y,S)=>{if(y.hasOwnProperty(S)){const T=y[S];return!U.isArray(T)||T.length>0}return!1},M.hasValue=(y,S,T)=>{if(M.hasProperty(y,S)){let j=y[S];const R=Y.isList(j);if(U.isArray(j)||R){R&&(j=j["@list"]);for(let q=0;q<j.length;++q)if(M.compareValues(T,j[q]))return!0}else if(!U.isArray(T))return M.compareValues(T,j)}return!1},M.addValue=(y,S,T,j)=>{if("propertyIsArray"in(j=j||{})||(j.propertyIsArray=!1),"valueIsArray"in j||(j.valueIsArray=!1),"allowDuplicate"in j||(j.allowDuplicate=!0),"prependValue"in j||(j.prependValue=!1),j.valueIsArray)y[S]=T;else if(U.isArray(T)){0===T.length&&j.propertyIsArray&&!y.hasOwnProperty(S)&&(y[S]=[]),j.prependValue&&(T=T.concat(y[S]),y[S]=[]);for(let R=0;R<T.length;++R)M.addValue(y,S,T[R],j)}else if(y.hasOwnProperty(S)){const R=!j.allowDuplicate&&M.hasValue(y,S,T);!U.isArray(y[S])&&(!R||j.propertyIsArray)&&(y[S]=[y[S]]),R||(j.prependValue?y[S].unshift(T):y[S].push(T))}else y[S]=j.propertyIsArray?[T]:T},M.getValues=(y,S)=>[].concat(y[S]||[]),M.removeProperty=(y,S)=>{delete y[S]},M.removeValue=(y,S,T,j)=>{"propertyIsArray"in(j=j||{})||(j.propertyIsArray=!1);const R=M.getValues(y,S).filter(q=>!M.compareValues(q,T));0===R.length?M.removeProperty(y,S):y[S]=1!==R.length||j.propertyIsArray?R:R[0]},M.relabelBlankNodes=(y,S)=>v((S=S||{}).issuer||new k("_:b"),y),M.compareValues=(y,S)=>!!(y===S||Y.isValue(y)&&Y.isValue(S)&&y["@value"]===S["@value"]&&y["@type"]===S["@type"]&&y["@language"]===S["@language"]&&y["@index"]===S["@index"])||!!(U.isObject(y)&&"@id"in y&&U.isObject(S)&&"@id"in S)&&y["@id"]===S["@id"],M.compareShortestLeast=(y,S)=>y.length<S.length?-1:S.length<y.length?1:y===S?0:y<S?-1:1},{"./JsonLdError":12,"./graphTypes":25,"./types":30,"rdf-canonize":46}],33:[function(K,Me,pe){"use strict";const Y=K("yallist"),U=Symbol("max"),k=Symbol("length"),ie=Symbol("lengthCalculator"),W=Symbol("allowStale"),b=Symbol("maxAge"),C=Symbol("dispose"),P=Symbol("noDisposeOnSet"),M=Symbol("lruList"),v=Symbol("cache"),y=Symbol("updateAgeOnGet"),S=()=>1;const j=(X,E,G)=>{const Q=X[v].get(E);if(Q){const ae=Q.value;if(R(X,ae)){if(ue(X,Q),!X[W])return}else G&&(X[y]&&(Q.value.now=Date.now()),X[M].unshiftNode(Q));return ae.value}},R=(X,E)=>{if(!E||!E.maxAge&&!X[b])return!1;const G=Date.now()-E.now;return E.maxAge?G>E.maxAge:X[b]&&G>X[b]},q=X=>{if(X[k]>X[U])for(let E=X[M].tail;X[k]>X[U]&&null!==E;){const G=E.prev;ue(X,E),E=G}},ue=(X,E)=>{if(E){const G=E.value;X[C]&&X[C](G.key,G.value),X[k]-=G.length,X[v].delete(G.key),X[M].removeNode(E)}};class D{constructor(E,G,Q,ae,se){this.key=E,this.value=G,this.length=Q,this.now=ae,this.maxAge=se||0}}const O=(X,E,G,Q)=>{let ae=G.value;R(X,ae)&&(ue(X,G),X[W]||(ae=void 0)),ae&&E.call(Q,ae.value,ae.key,X)};Me.exports=class{constructor(E){if("number"==typeof E&&(E={max:E}),E||(E={}),E.max&&("number"!=typeof E.max||E.max<0))throw new TypeError("max must be a non-negative number");this[U]=E.max||1/0;const Q=E.length||S;if(this[ie]="function"!=typeof Q?S:Q,this[W]=E.stale||!1,E.maxAge&&"number"!=typeof E.maxAge)throw new TypeError("maxAge must be a number");this[b]=E.maxAge||0,this[C]=E.dispose,this[P]=E.noDisposeOnSet||!1,this[y]=E.updateAgeOnGet||!1,this.reset()}set max(E){if("number"!=typeof E||E<0)throw new TypeError("max must be a non-negative number");this[U]=E||1/0,q(this)}get max(){return this[U]}set allowStale(E){this[W]=!!E}get allowStale(){return this[W]}set maxAge(E){if("number"!=typeof E)throw new TypeError("maxAge must be a non-negative number");this[b]=E,q(this)}get maxAge(){return this[b]}set lengthCalculator(E){"function"!=typeof E&&(E=S),E!==this[ie]&&(this[ie]=E,this[k]=0,this[M].forEach(G=>{G.length=this[ie](G.value,G.key),this[k]+=G.length})),q(this)}get lengthCalculator(){return this[ie]}get length(){return this[k]}get itemCount(){return this[M].length}rforEach(E,G){G=G||this;for(let Q=this[M].tail;null!==Q;){const ae=Q.prev;O(this,E,Q,G),Q=ae}}forEach(E,G){G=G||this;for(let Q=this[M].head;null!==Q;){const ae=Q.next;O(this,E,Q,G),Q=ae}}keys(){return this[M].toArray().map(E=>E.key)}values(){return this[M].toArray().map(E=>E.value)}reset(){this[C]&&this[M]&&this[M].length&&this[M].forEach(E=>this[C](E.key,E.value)),this[v]=new Map,this[M]=new Y,this[k]=0}dump(){return this[M].map(E=>!R(this,E)&&{k:E.key,v:E.value,e:E.now+(E.maxAge||0)}).toArray().filter(E=>E)}dumpLru(){return this[M]}set(E,G,Q){if((Q=Q||this[b])&&"number"!=typeof Q)throw new TypeError("maxAge must be a number");const ae=Q?Date.now():0,se=this[ie](G,E);if(this[v].has(E)){if(se>this[U])return ue(this,this[v].get(E)),!1;const me=this[v].get(E).value;return this[C]&&(this[P]||this[C](E,me.value)),me.now=ae,me.maxAge=Q,me.value=G,this[k]+=se-me.length,me.length=se,this.get(E),q(this),!0}const ee=new D(E,G,se,ae,Q);return ee.length>this[U]?(this[C]&&this[C](E,G),!1):(this[k]+=ee.length,this[M].unshift(ee),this[v].set(E,this[M].head),q(this),!0)}has(E){if(!this[v].has(E))return!1;const G=this[v].get(E).value;return!R(this,G)}get(E){return j(this,E,!0)}peek(E){return j(this,E,!1)}pop(){const E=this[M].tail;return E?(ue(this,E),E.value):null}del(E){ue(this,this[v].get(E))}load(E){this.reset();const G=Date.now();for(let Q=E.length-1;Q>=0;Q--){const ae=E[Q],se=ae.e||0;if(0===se)this.set(ae.k,ae.v);else{const ee=se-G;ee>0&&this.set(ae.k,ae.v,ee)}}}prune(){this[v].forEach((E,G)=>j(this,G,!1))}}},{yallist:92}],34:[function(K,Me,pe){"use strict";Object.defineProperty(pe,"__esModule",{value:!0}),pe.default=void 0;const Y="http://www.w3.org/1999/02/22-rdf-syntax-ns#",U="http://www.w3.org/2001/XMLSchema#",k="http://www.w3.org/2000/10/swap/";pe.default={xsd:{decimal:`${U}decimal`,boolean:`${U}boolean`,double:`${U}double`,integer:`${U}integer`,string:`${U}string`},rdf:{type:`${Y}type`,nil:`${Y}nil`,first:`${Y}first`,rest:`${Y}rest`,langString:`${Y}langString`},owl:{sameAs:"http://www.w3.org/2002/07/owl#sameAs"},r:{forSome:`${k}reify#forSome`,forAll:`${k}reify#forAll`},log:{implies:`${k}log#implies`}}},{}],35:[function(K,Me,pe){"use strict";Object.defineProperty(pe,"__esModule",{value:!0}),pe.default=pe.Variable=pe.Triple=pe.Term=pe.Quad=pe.NamedNode=pe.Literal=pe.DefaultGraph=pe.BlankNode=void 0,pe.escapeQuotes=E,pe.termFromId=function D(te,_e){if(_e=_e||v,!te)return _e.defaultGraph();switch(te[0]){case"?":return _e.variable(te.substr(1));case"_":return _e.blankNode(te.substr(2));case'"':if(_e===v)return new j(te);if('"'===te[te.length-1])return _e.literal(te.substr(1,te.length-2));const Oe=te.lastIndexOf('"',te.length-1);return _e.literal(te.substr(1,Oe-1),"@"===te[Oe+1]?te.substr(Oe+2):_e.namedNode(te.substr(Oe+3)));case"<":const $e=M.exec(te);return _e.quad(D(G($e[1]),_e),D(G($e[2]),_e),D(G($e[3]),_e),$e[4]&&D(G($e[4]),_e));default:return _e.namedNode(te)}},pe.termToId=function O(te){if("string"==typeof te)return te;if(te instanceof S&&"Quad"!==te.termType)return te.id;if(!te)return b.id;switch(te.termType){case"NamedNode":return te.value;case"BlankNode":return`_:${te.value}`;case"Variable":return`?${te.value}`;case"DefaultGraph":return"";case"Literal":return`"${te.value}"${te.language?`@${te.language}`:te.datatype&&te.datatype.value!==W.string?`^^${te.datatype.value}`:""}`;case"Quad":return`<<${E(O(te.subject))} ${E(O(te.predicate))} ${E(O(te.object))}${(0,U.isDefaultGraph)(te.graph)?"":` ${O(te.graph)}`}>>`;default:throw new Error(`Unexpected termType: ${te.termType}`)}},pe.unescapeQuotes=G;var te,Y=(te=K("./IRIs"))&&te.__esModule?te:{default:te},U=K("./N3Util");const{rdf:ie,xsd:W}=Y.default;let b,C=0;const P=/^"(.*".*)(?="[^"]*$)/,M=/^<<("(?:""|[^"])*"[^ ]*|[^ ]+) ("(?:""|[^"])*"[^ ]*|[^ ]+) ("(?:""|[^"])*"[^ ]*|[^ ]+) ?("(?:""|[^"])*"[^ ]*|[^ ]+)?>>$/,v={namedNode:function(te){return new T(te)},blankNode:function(te){return new R(te||"n3-"+C++)},variable:function(te){return new q(te)},literal:function(te,_e){if("string"==typeof _e)return new j(`"${te}"@${_e.toLowerCase()}`);let Oe=_e?_e.value:"";return""===Oe&&("boolean"==typeof te?Oe=W.boolean:"number"==typeof te&&(Number.isFinite(te)?Oe=Number.isInteger(te)?W.integer:W.double:(Oe=W.double,Number.isNaN(te)||(te=te>0?"INF":"-INF")))),new j(""===Oe||Oe===W.string?`"${te}"`:`"${te}"^^${Oe}`)},defaultGraph:function(){return b},quad:me,triple:me};pe.default=v;class S{constructor(_e){this.id=_e}get value(){return this.id}equals(_e){return _e instanceof S?this.id===_e.id:!!_e&&this.termType===_e.termType&&this.value===_e.value}hashCode(){return 0}toJSON(){return{termType:this.termType,value:this.value}}}pe.Term=S;class T extends S{get termType(){return"NamedNode"}}pe.NamedNode=T;class j extends S{get termType(){return"Literal"}get value(){return this.id.substring(1,this.id.lastIndexOf('"'))}get language(){const _e=this.id;let Oe=_e.lastIndexOf('"')+1;return Oe<_e.length&&"@"===_e[Oe++]?_e.substr(Oe).toLowerCase():""}get datatype(){return new T(this.datatypeString)}get datatypeString(){const _e=this.id,Oe=_e.lastIndexOf('"')+1,$e=Oe<_e.length?_e[Oe]:"";return"^"===$e?_e.substr(Oe+2):"@"!==$e?W.string:ie.langString}equals(_e){return _e instanceof j?this.id===_e.id:!!_e&&!!_e.datatype&&this.termType===_e.termType&&this.value===_e.value&&this.language===_e.language&&this.datatype.value===_e.datatype.value}toJSON(){return{termType:this.termType,value:this.value,language:this.language,datatype:{termType:"NamedNode",value:this.datatypeString}}}}pe.Literal=j;class R extends S{constructor(_e){super(`_:${_e}`)}get termType(){return"BlankNode"}get value(){return this.id.substr(2)}}pe.BlankNode=R;class q extends S{constructor(_e){super(`?${_e}`)}get termType(){return"Variable"}get value(){return this.id.substr(1)}}pe.Variable=q;class ue extends S{constructor(){return super(""),b||this}get termType(){return"DefaultGraph"}equals(_e){return this===_e||!!_e&&this.termType===_e.termType}}pe.DefaultGraph=ue,b=new ue;class X extends S{constructor(_e,Oe,$e,st){super(""),this._subject=_e,this._predicate=Oe,this._object=$e,this._graph=st||b}get termType(){return"Quad"}get subject(){return this._subject}get predicate(){return this._predicate}get object(){return this._object}get graph(){return this._graph}toJSON(){return{termType:this.termType,subject:this._subject.toJSON(),predicate:this._predicate.toJSON(),object:this._object.toJSON(),graph:this._graph.toJSON()}}equals(_e){return!!_e&&this._subject.equals(_e.subject)&&this._predicate.equals(_e.predicate)&&this._object.equals(_e.object)&&this._graph.equals(_e.graph)}}function E(te){return te.replace(P,(_e,Oe)=>`"${Oe.replace(/"/g,'""')}`)}function G(te){return te.replace(P,(_e,Oe)=>`"${Oe.replace(/""/g,'"')}`)}function me(te,_e,Oe,$e){return new X(te,_e,Oe,$e)}pe.Triple=pe.Quad=X},{"./IRIs":34,"./N3Util":41}],36:[function(K,Me,pe){(function(Y){(function(){"use strict";Object.defineProperty(pe,"__esModule",{value:!0}),pe.default=void 0;var U=ie(K("./IRIs")),k=ie(K("queue-microtask"));function ie(S){return S&&S.__esModule?S:{default:S}}const{xsd:W}=U.default,b=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{8})|\\([^])/g,C={"\\":"\\","'":"'",'"':'"',n:"\n",r:"\r",t:"\t",f:"\f",b:"\b",_:"_","~":"~",".":".","-":"-","!":"!",$:"$","&":"&","(":"(",")":")","*":"*","+":"+",",":",",";":";","=":"=","/":"/","?":"?","#":"#","@":"@","%":"%"},P=/[\x00-\x20<>\\"\{\}\|\^\`]/,M={_iri:!0,_unescapedIri:!0,_simpleQuotedString:!0,_langcode:!0,_blank:!0,_newline:!0,_comment:!0,_whitespace:!0,_endOfFile:!0},v=/$0^/;pe.default=class{constructor(T){if(this._iri=/^<((?:[^ <>{}\\]|\\[uU])+)>[ \t]*/,this._unescapedIri=/^<([^\x00-\x20<>\\"\{\}\|\^\`]*)>[ \t]*/,this._simpleQuotedString=/^"([^"\\\r\n]*)"(?=[^"])/,this._simpleApostropheString=/^'([^'\\\r\n]*)'(?=[^'])/,this._langcode=/^@([a-z]+(?:-[a-z0-9]+)*)(?=[^a-z0-9\-])/i,this._prefix=/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:(?=[#\s<])/,this._prefixed=/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:((?:(?:[0-:A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])(?:(?:[\.\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])*(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~]))?)?)(?:[ \t]+|(?=\.?[,;!\^\s#()\[\]\{\}"'<>]))/,this._variable=/^\?(?:(?:[A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?=[.,;!\^\s#()\[\]\{\}"'<>])/,this._blank=/^_:((?:[0-9A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?:[ \t]+|(?=\.?[,;:\s#()\[\]\{\}"'<>]))/,this._number=/^[\-+]?(?:(\d+\.\d*|\.?\d+)[eE][\-+]?|\d*(\.)?)\d+(?=\.?[,;:\s#()\[\]\{\}"'<>])/,this._boolean=/^(?:true|false)(?=[.,;\s#()\[\]\{\}"'<>])/,this._keyword=/^@[a-z]+(?=[\s#<:])/i,this._sparqlKeyword=/^(?:PREFIX|BASE|GRAPH)(?=[\s#<])/i,this._shortPredicates=/^a(?=[\s#()\[\]\{\}"'<>])/,this._newline=/^[ \t]*(?:#[^\n\r]*)?(?:\r\n|\n|\r)[ \t]*/,this._comment=/#([^\n\r]*)/,this._whitespace=/^[ \t]+/,this._endOfFile=/^(?:#[^\n\r]*)?$/,this._lineMode=!!(T=T||{}).lineMode){this._n3Mode=!1;for(const j in this)!(j in M)&&this[j]instanceof RegExp&&(this[j]=v)}else this._n3Mode=!1!==T.n3;this._comments=!!T.comments,this._literalClosingPos=0}_tokenizeToEnd(T,j){let R=this._input,q=R.length;for(;;){let O,X;for(;O=this._newline.exec(R);)this._comments&&(X=this._comment.exec(O[0]))&&ue("comment",X[1],"",this._line,O[0].length),R=R.substr(O[0].length,R.length),q=R.length,this._line++;if(!O&&(O=this._whitespace.exec(R))&&(R=R.substr(O[0].length,R.length)),this._endOfFile.test(R))return j&&(this._comments&&(X=this._comment.exec(R))&&ue("comment",X[1],"",this._line,R.length),R=null,ue("eof","","",this._line,0)),this._input=R;const E=this._line,G=R[0];let Q="",ae="",se="",ee=null,xe=0,me=!1;switch(G){case"^":if(R.length<3)break;if("^"!==R[1]){this._n3Mode&&(xe=1,Q="^");break}if(this._previousMarker="^^",R=R.substr(2),"<"!==R[0]){me=!0;break}case"<":if(ee=this._unescapedIri.exec(R))Q="IRI",ae=ee[1];else if(ee=this._iri.exec(R)){if(ae=this._unescape(ee[1]),null===ae||P.test(ae))return D(this);Q="IRI"}else R.length>1&&"<"===R[1]?(Q="<<",xe=2):this._n3Mode&&R.length>1&&"="===R[1]&&(Q="inverse",xe=2,ae=">");break;case">":R.length>1&&">"===R[1]&&(Q=">>",xe=2);break;case"_":((ee=this._blank.exec(R))||j&&(ee=this._blank.exec(`${R} `)))&&(Q="blank",se="_",ae=ee[1]);break;case'"':if(ee=this._simpleQuotedString.exec(R))ae=ee[1];else if(({value:ae,matchLength:xe}=this._parseLiteral(R)),null===ae)return D(this);(null!==ee||0!==xe)&&(Q="literal",this._literalClosingPos=0);break;case"'":if(!this._lineMode){if(ee=this._simpleApostropheString.exec(R))ae=ee[1];else if(({value:ae,matchLength:xe}=this._parseLiteral(R)),null===ae)return D(this);(null!==ee||0!==xe)&&(Q="literal",this._literalClosingPos=0)}break;case"?":this._n3Mode&&(ee=this._variable.exec(R))&&(Q="var",ae=ee[0]);break;case"@":"literal"===this._previousMarker&&(ee=this._langcode.exec(R))?(Q="langcode",ae=ee[1]):(ee=this._keyword.exec(R))&&(Q=ee[0]);break;case".":if(1===R.length?j:R[1]<"0"||R[1]>"9"){Q=".",xe=1;break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"+":case"-":(ee=this._number.exec(R)||j&&(ee=this._number.exec(`${R} `)))&&(Q="literal",ae=ee[0],se="string"==typeof ee[1]?W.double:"string"==typeof ee[2]?W.decimal:W.integer);break;case"B":case"b":case"p":case"P":case"G":case"g":(ee=this._sparqlKeyword.exec(R))?Q=ee[0].toUpperCase():me=!0;break;case"f":case"t":(ee=this._boolean.exec(R))?(Q="literal",ae=ee[0],se=W.boolean):me=!0;break;case"a":(ee=this._shortPredicates.exec(R))?(Q="abbreviation",ae="a"):me=!0;break;case"=":this._n3Mode&&R.length>1&&(Q="abbreviation",">"!==R[1]?(xe=1,ae="="):(xe=2,ae=">"));break;case"!":if(!this._n3Mode)break;case",":case";":case"[":case"]":case"(":case")":case"{":case"}":this._lineMode||(xe=1,Q=G);break;default:me=!0}if(me&&("@prefix"!==this._previousMarker&&"PREFIX"!==this._previousMarker||!(ee=this._prefix.exec(R))?((ee=this._prefixed.exec(R))||j&&(ee=this._prefixed.exec(`${R} `)))&&(Q="prefixed",se=ee[1]||"",ae=this._unescape(ee[2])):(Q="prefix",ae=ee[1]||"")),"^^"===this._previousMarker)switch(Q){case"prefixed":Q="type";break;case"IRI":Q="typeIRI";break;default:Q=""}if(!Q)return j||!/^'''|^"""/.test(R)&&/\n|\r/.test(R)?D(this):this._input=R;const te=xe||ee[0].length,_e=ue(Q,ae,se,E,te);this.previousToken=_e,this._previousMarker=Q,R=R.substr(te,R.length)}function ue(O,X,E,G,Q){const ae=R?q-R.length:q,ee={type:O,value:X,prefix:E,line:G,start:ae,end:ae+Q};return T(null,ee),ee}function D(O){T(O._syntaxError(/^\S*/.exec(R)[0]))}}_unescape(T){let j=!1;const R=T.replace(b,(q,ue,D,O)=>{if("string"==typeof ue)return String.fromCharCode(Number.parseInt(ue,16));if("string"==typeof D){let X=Number.parseInt(D,16);return X<=65535?String.fromCharCode(Number.parseInt(D,16)):String.fromCharCode(55296+((X-=65536)>>10),56320+(1023&X))}return O in C?C[O]:(j=!0,"")});return j?null:R}_parseLiteral(T){if(T.length>=3){const j=T.match(/^(?:"""|"|'''|'|)/)[0],R=j.length;let q=Math.max(this._literalClosingPos,R);for(;(q=T.indexOf(j,q))>0;){let ue=0;for(;"\\"===T[q-ue-1];)ue++;if(ue%2==0){const D=T.substring(R,q),O=D.split(/\r\n|\r|\n/).length-1,X=q+R;if(1===R&&0!==O||3===R&&this._lineMode)break;return this._line+=O,{value:this._unescape(D),matchLength:X}}q++}this._literalClosingPos=T.length-R+1}return{value:"",matchLength:0}}_syntaxError(T){this._input=null;const j=new Error(`Unexpected "${T}" on line ${this._line}.`);return j.context={token:void 0,line:this._line,previousToken:this.previousToken},j}_readStartingBom(T){return T.startsWith("\ufeff")?T.substr(1):T}tokenize(T,j){if(this._line=1,"string"==typeof T){if(this._input=this._readStartingBom(T),"function"!=typeof j){const R=[];let q;if(this._tokenizeToEnd((ue,D)=>ue?q=ue:R.push(D),!0),q)throw q;return R}(0,k.default)(()=>this._tokenizeToEnd(j,!0))}else this._pendingBuffer=null,"function"==typeof T.setEncoding&&T.setEncoding("utf8"),T.on("data",R=>{null!==this._input&&0!==R.length&&(this._pendingBuffer&&(R=Y.concat([this._pendingBuffer,R]),this._pendingBuffer=null),128&R[R.length-1]?this._pendingBuffer=R:(void 0===this._input?this._input=this._readStartingBom("string"==typeof R?R:R.toString()):this._input+=R,this._tokenizeToEnd(j,!1)))}),T.on("end",()=>{"string"==typeof this._input&&this._tokenizeToEnd(j,!0)}),T.on("error",j)}}}).call(this)}).call(this,K("buffer").Buffer)},{"./IRIs":34,buffer:6,"queue-microtask":45}],37:[function(K,Me,pe){"use strict";Object.defineProperty(pe,"__esModule",{value:!0}),pe.default=void 0;var Y=ie(K("./N3Lexer")),U=ie(K("./N3DataFactory")),k=ie(K("./IRIs"));function ie(M){return M&&M.__esModule?M:{default:M}}let W=0;class b{constructor(v){this._contextStack=[],this._graph=null,this._setBase((v=v||{}).baseIRI),v.factory&&P(this,v.factory);const y="string"==typeof v.format?v.format.match(/\w*$/)[0].toLowerCase():"",S=/turtle/.test(y),T=/trig/.test(y),j=/triple/.test(y),R=/quad/.test(y),q=this._n3Mode=/n3/.test(y),ue=j||R;(this._supportsNamedGraphs=!(S||q))||(this._readPredicateOrNamedGraph=this._readPredicate),this._supportsQuads=!(S||T||j||q),this._supportsRDFStar=""===y||/star|\*$/.test(y),ue&&(this._resolveRelativeIRI=D=>null),this._blankNodePrefix="string"!=typeof v.blankNodePrefix?"":v.blankNodePrefix.replace(/^(?!_:)/,"_:"),this._lexer=v.lexer||new Y.default({lineMode:ue,n3:q}),this._explicitQuantifiers=!!v.explicitQuantifiers}static _resetBlankNodePrefix(){W=0}_setBase(v){if(v){const y=v.indexOf("#");y>=0&&(v=v.substr(0,y)),this._base=v,this._basePath=v.indexOf("/")<0?v:v.replace(/[^\/?]*(?:\?.*)?$/,""),v=v.match(/^(?:([a-z][a-z0-9+.-]*:))?(?:\/\/[^\/]*)?/i),this._baseRoot=v[0],this._baseScheme=v[1]}else this._base="",this._basePath=""}_saveContext(v,y,S,T,j){const R=this._n3Mode;this._contextStack.push({subject:S,predicate:T,object:j,graph:y,type:v,inverse:!!R&&this._inversePredicate,blankPrefix:R?this._prefixes._:"",quantified:R?this._quantified:null}),R&&(this._inversePredicate=!1,this._prefixes._=this._graph?`${this._graph.id.substr(2)}.`:".",this._quantified=Object.create(this._quantified))}_restoreContext(){const v=this._contextStack.pop(),y=this._n3Mode;this._subject=v.subject,this._predicate=v.predicate,this._object=v.object,this._graph=v.graph,y&&(this._inversePredicate=v.inverse,this._prefixes._=v.blankPrefix,this._quantified=v.quantified)}_readInTopContext(v){switch(v.type){case"eof":return null!==this._graph?this._error("Unclosed graph",v):(delete this._prefixes._,this._callback(null,null,this._prefixes));case"PREFIX":this._sparqlStyle=!0;case"@prefix":return this._readPrefix;case"BASE":this._sparqlStyle=!0;case"@base":return this._readBaseIRI;case"{":if(this._supportsNamedGraphs)return this._graph="",this._subject=null,this._readSubject;case"GRAPH":if(this._supportsNamedGraphs)return this._readNamedGraphLabel;default:return this._readSubject(v)}}_readEntity(v,y){let S;switch(v.type){case"IRI":case"typeIRI":const T=this._resolveIRI(v.value);if(null===T)return this._error("Invalid IRI",v);S=this._namedNode(T);break;case"type":case"prefixed":const j=this._prefixes[v.prefix];if(void 0===j)return this._error(`Undefined prefix "${v.prefix}:"`,v);S=this._namedNode(j+v.value);break;case"blank":S=this._blankNode(this._prefixes[v.prefix]+v.value);break;case"var":S=this._variable(v.value.substr(1));break;default:return this._error(`Expected entity but got ${v.type}`,v)}return!y&&this._n3Mode&&S.id in this._quantified&&(S=this._quantified[S.id]),S}_readSubject(v){switch(this._predicate=null,v.type){case"[":return this._saveContext("blank",this._graph,this._subject=this._blankNode(),null,null),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this.RDF_NIL,null,null),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._graph=this._blankNode(),null,null),this._readSubject):this._error("Unexpected graph",v);case"}":return this._readPunctuation(v);case"@forSome":return this._n3Mode?(this._subject=null,this._predicate=this.N3_FORSOME,this._quantifier=this._blankNode,this._readQuantifierList):this._error('Unexpected "@forSome"',v);case"@forAll":return this._n3Mode?(this._subject=null,this._predicate=this.N3_FORALL,this._quantifier=this._variable,this._readQuantifierList):this._error('Unexpected "@forAll"',v);case"literal":if(!this._n3Mode)return this._error("Unexpected literal",v);if(0===v.prefix.length)return this._literalValue=v.value,this._completeSubjectLiteral;this._subject=this._literal(v.value,this._namedNode(v.prefix));break;case"<<":return this._supportsRDFStar?(this._saveContext("<<",this._graph,null,null,null),this._graph=null,this._readSubject):this._error("Unexpected RDF* syntax",v);default:if(void 0===(this._subject=this._readEntity(v)))return;if(this._n3Mode)return this._getPathReader(this._readPredicateOrNamedGraph)}return this._readPredicateOrNamedGraph}_readPredicate(v){const y=v.type;switch(y){case"inverse":this._inversePredicate=!0;case"abbreviation":this._predicate=this.ABBREVIATIONS[v.value];break;case".":case"]":case"}":return null===this._predicate?this._error(`Unexpected ${y}`,v):(this._subject=null,"]"===y?this._readBlankNodeTail(v):this._readPunctuation(v));case";":return null!==this._predicate?this._readPredicate:this._error("Expected predicate but got ;",v);case"[":if(this._n3Mode)return this._saveContext("blank",this._graph,this._subject,this._subject=this._blankNode(),null),this._readBlankNodeHead;case"blank":if(!this._n3Mode)return this._error("Disallowed blank node as predicate",v);default:if(void 0===(this._predicate=this._readEntity(v)))return}return this._readObject}_readObject(v){switch(v.type){case"literal":if(0===v.prefix.length)return this._literalValue=v.value,this._readDataTypeOrLang;this._object=this._literal(v.value,this._namedNode(v.prefix));break;case"[":return this._saveContext("blank",this._graph,this._subject,this._predicate,this._subject=this._blankNode()),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this._subject,this._predicate,this.RDF_NIL),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph=this._blankNode()),this._readSubject):this._error("Unexpected graph",v);case"<<":return this._supportsRDFStar?(this._saveContext("<<",this._graph,this._subject,this._predicate,null),this._graph=null,this._readSubject):this._error("Unexpected RDF* syntax",v);default:if(void 0===(this._object=this._readEntity(v)))return;if(this._n3Mode)return this._getPathReader(this._getContextEndReader())}return this._getContextEndReader()}_readPredicateOrNamedGraph(v){return"{"===v.type?this._readGraph(v):this._readPredicate(v)}_readGraph(v){return"{"!==v.type?this._error(`Expected graph but got ${v.type}`,v):(this._graph=this._subject,this._subject=null,this._readSubject)}_readBlankNodeHead(v){return"]"===v.type?(this._subject=null,this._readBlankNodeTail(v)):(this._predicate=null,this._readPredicate(v))}_readBlankNodeTail(v){if("]"!==v.type)return this._readBlankNodePunctuation(v);null!==this._subject&&this._emit(this._subject,this._predicate,this._object,this._graph);const y=null===this._predicate;return this._restoreContext(),null!==this._object?this._getContextEndReader():null!==this._predicate?this._readObject:y?this._readPredicateOrNamedGraph:this._readPredicateAfterBlank}_readPredicateAfterBlank(v){switch(v.type){case".":case"}":return this._subject=null,this._readPunctuation(v);default:return this._readPredicate(v)}}_readListItem(v){let y=null,S=null,T=this._readListItem;const j=this._subject,R=this._contextStack,q=R[R.length-1];switch(v.type){case"[":this._saveContext("blank",this._graph,S=this._blankNode(),this.RDF_FIRST,this._subject=y=this._blankNode()),T=this._readBlankNodeHead;break;case"(":this._saveContext("list",this._graph,S=this._blankNode(),this.RDF_FIRST,this.RDF_NIL),this._subject=null;break;case")":if(this._restoreContext(),0!==R.length&&"list"===R[R.length-1].type&&this._emit(this._subject,this._predicate,this._object,this._graph),null===this._predicate){if(T=this._readPredicate,this._subject===this.RDF_NIL)return T}else if(T=this._getContextEndReader(),this._object===this.RDF_NIL)return T;S=this.RDF_NIL;break;case"literal":0===v.prefix.length?(this._literalValue=v.value,T=this._readListItemDataTypeOrLang):(y=this._literal(v.value,this._namedNode(v.prefix)),T=this._getContextEndReader());break;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph=this._blankNode()),this._readSubject):this._error("Unexpected graph",v);default:if(void 0===(y=this._readEntity(v)))return}if(null===S&&(this._subject=S=this._blankNode()),null===j?null===q.predicate?q.subject=S:q.object=S:this._emit(j,this.RDF_REST,S,this._graph),null!==y){if(this._n3Mode&&("IRI"===v.type||"prefixed"===v.type))return this._saveContext("item",this._graph,S,this.RDF_FIRST,y),this._subject=y,this._predicate=null,this._getPathReader(this._readListItem);this._emit(S,this.RDF_FIRST,y,this._graph)}return T}_readDataTypeOrLang(v){return this._completeObjectLiteral(v,!1)}_readListItemDataTypeOrLang(v){return this._completeObjectLiteral(v,!0)}_completeLiteral(v){let y=this._literal(this._literalValue);switch(v.type){case"type":case"typeIRI":const S=this._readEntity(v);if(void 0===S)return;y=this._literal(this._literalValue,S),v=null;break;case"langcode":y=this._literal(this._literalValue,v.value),v=null}return{token:v,literal:y}}_completeSubjectLiteral(v){return this._subject=this._completeLiteral(v).literal,this._readPredicateOrNamedGraph}_completeObjectLiteral(v,y){const S=this._completeLiteral(v);if(S)return this._object=S.literal,y&&this._emit(this._subject,this.RDF_FIRST,this._object,this._graph),null===S.token?this._getContextEndReader():(this._readCallback=this._getContextEndReader(),this._readCallback(S.token))}_readFormulaTail(v){return"}"!==v.type?this._readPunctuation(v):(null!==this._subject&&this._emit(this._subject,this._predicate,this._object,this._graph),this._restoreContext(),null===this._object?this._readPredicate:this._getContextEndReader())}_readPunctuation(v){let y,S=this._graph;const T=this._subject,j=this._inversePredicate;switch(v.type){case"}":if(null===this._graph)return this._error("Unexpected graph closing",v);if(this._n3Mode)return this._readFormulaTail(v);this._graph=null;case".":this._subject=null,y=this._contextStack.length?this._readSubject:this._readInTopContext,j&&(this._inversePredicate=!1);break;case";":y=this._readPredicate;break;case",":y=this._readObject;break;default:if(this._supportsQuads&&null===this._graph&&void 0!==(S=this._readEntity(v))){y=this._readQuadPunctuation;break}return this._error(`Expected punctuation to follow "${this._object.id}"`,v)}if(null!==T){const R=this._predicate,q=this._object;j?this._emit(q,R,T,S):this._emit(T,R,q,S)}return y}_readBlankNodePunctuation(v){let y;switch(v.type){case";":y=this._readPredicate;break;case",":y=this._readObject;break;default:return this._error(`Expected punctuation to follow "${this._object.id}"`,v)}return this._emit(this._subject,this._predicate,this._object,this._graph),y}_readQuadPunctuation(v){return"."!==v.type?this._error("Expected dot to follow quad",v):this._readInTopContext}_readPrefix(v){return"prefix"!==v.type?this._error("Expected prefix to follow @prefix",v):(this._prefix=v.value,this._readPrefixIRI)}_readPrefixIRI(v){if("IRI"!==v.type)return this._error(`Expected IRI to follow prefix "${this._prefix}:"`,v);const y=this._readEntity(v);return this._prefixes[this._prefix]=y.value,this._prefixCallback(this._prefix,y),this._readDeclarationPunctuation}_readBaseIRI(v){const y="IRI"===v.type&&this._resolveIRI(v.value);return y?(this._setBase(y),this._readDeclarationPunctuation):this._error("Expected valid IRI to follow base declaration",v)}_readNamedGraphLabel(v){switch(v.type){case"IRI":case"blank":case"prefixed":return this._readSubject(v),this._readGraph;case"[":return this._readNamedGraphBlankLabel;default:return this._error("Invalid graph label",v)}}_readNamedGraphBlankLabel(v){return"]"!==v.type?this._error("Invalid graph label",v):(this._subject=this._blankNode(),this._readGraph)}_readDeclarationPunctuation(v){return this._sparqlStyle?(this._sparqlStyle=!1,this._readInTopContext(v)):"."!==v.type?this._error("Expected declaration to end with a dot",v):this._readInTopContext}_readQuantifierList(v){let y;switch(v.type){case"IRI":case"prefixed":if(void 0!==(y=this._readEntity(v,!0)))break;default:return this._error(`Unexpected ${v.type}`,v)}return this._explicitQuantifiers?(null===this._subject?this._emit(this._graph||this.DEFAULTGRAPH,this._predicate,this._subject=this._blankNode(),this.QUANTIFIERS_GRAPH):this._emit(this._subject,this.RDF_REST,this._subject=this._blankNode(),this.QUANTIFIERS_GRAPH),this._emit(this._subject,this.RDF_FIRST,y,this.QUANTIFIERS_GRAPH)):this._quantified[y.id]=this._quantifier(this._blankNode().value),this._readQuantifierPunctuation}_readQuantifierPunctuation(v){return","===v.type?this._readQuantifierList:(this._explicitQuantifiers&&(this._emit(this._subject,this.RDF_REST,this.RDF_NIL,this.QUANTIFIERS_GRAPH),this._subject=null),this._readCallback=this._getContextEndReader(),this._readCallback(v))}_getPathReader(v){return this._afterPath=v,this._readPath}_readPath(v){switch(v.type){case"!":return this._readForwardPath;case"^":return this._readBackwardPath;default:const y=this._contextStack,S=y.length&&y[y.length-1];if(S&&"item"===S.type){const T=this._subject;this._restoreContext(),this._emit(this._subject,this.RDF_FIRST,T,this._graph)}return this._afterPath(v)}}_readForwardPath(v){let y,S;const T=this._blankNode();if(void 0!==(S=this._readEntity(v)))return null===this._predicate?(y=this._subject,this._subject=T):(y=this._object,this._object=T),this._emit(y,S,T,this._graph),this._readPath}_readBackwardPath(v){const y=this._blankNode();let S,T;if(void 0!==(S=this._readEntity(v)))return null===this._predicate?(T=this._subject,this._subject=y):(T=this._object,this._object=y),this._emit(y,S,T,this._graph),this._readPath}_readRDFStarTailOrGraph(v){return">>"!==v.type?this._supportsQuads&&null===this._graph&&void 0!==(this._graph=this._readEntity(v))?this._readRDFStarTail:this._error(`Expected >> to follow "${this._object.id}"`,v):this._readRDFStarTail(v)}_readRDFStarTail(v){if(">>"!==v.type)return this._error(`Expected >> but got ${v.type}`,v);const y=this._quad(this._subject,this._predicate,this._object,this._graph||this.DEFAULTGRAPH);return this._restoreContext(),null===this._subject?(this._subject=y,this._readPredicate):(this._object=y,this._getContextEndReader())}_getContextEndReader(){const v=this._contextStack;if(!v.length)return this._readPunctuation;switch(v[v.length-1].type){case"blank":return this._readBlankNodeTail;case"list":return this._readListItem;case"formula":return this._readFormulaTail;case"<<":return this._readRDFStarTailOrGraph}}_emit(v,y,S,T){this._callback(null,this._quad(v,y,S,T||this.DEFAULTGRAPH))}_error(v,y){const S=new Error(`${v} on line ${y.line}.`);S.context={token:y,line:y.line,previousToken:this._lexer.previousToken},this._callback(S),this._callback=C}_resolveIRI(v){return/^[a-z][a-z0-9+.-]*:/i.test(v)?v:this._resolveRelativeIRI(v)}_resolveRelativeIRI(v){if(!v.length)return this._base;switch(v[0]){case"#":return this._base+v;case"?":return this._base.replace(/(?:\?.*)?$/,v);case"/":return("/"===v[1]?this._baseScheme:this._baseRoot)+this._removeDotSegments(v);default:return/^[^/:]*:/.test(v)?null:this._removeDotSegments(this._basePath+v)}}_removeDotSegments(v){if(!/(^|\/)\.\.?($|[/#?])/.test(v))return v;const y=v.length;let S="",T=-1,j=-1,R=0,q="/";for(;T<y;){switch(q){case":":if(j<0&&"/"===v[++T]&&"/"===v[++T])for(;(j=T+1)<y&&"/"!==v[j];)T=j;break;case"?":case"#":T=y;break;case"/":if("."===v[T+1])switch(q=v[1+ ++T],q){case"/":S+=v.substring(R,T-1),R=T+1;break;case void 0:case"?":case"#":return S+v.substring(R,T)+v.substr(T+1);case".":if(q=v[1+ ++T],void 0===q||"/"===q||"?"===q||"#"===q){if(S+=v.substring(R,T-2),(R=S.lastIndexOf("/"))>=j&&(S=S.substr(0,R)),"/"!==q)return`${S}/${v.substr(T+1)}`;R=T+1}}}q=v[++T]}return S+v.substring(R)}parse(v,y,S){if(this._readCallback=this._readInTopContext,this._sparqlStyle=!1,this._prefixes=Object.create(null),this._prefixes._=this._blankNodePrefix?this._blankNodePrefix.substr(2):`b${W++}_`,this._prefixCallback=S||C,this._inversePredicate=!1,this._quantified=Object.create(null),!y){const T=[];let j;if(this._callback=(R,q)=>{R?j=R:q&&T.push(q)},this._lexer.tokenize(v).every(R=>this._readCallback=this._readCallback(R)),j)throw j;return T}this._callback=y,this._lexer.tokenize(v,(T,j)=>{null!==T?(this._callback(T),this._callback=C):this._readCallback&&(this._readCallback=this._readCallback(j))})}}function C(){}function P(M,v){const y=v.namedNode;M._namedNode=y,M._blankNode=v.blankNode,M._literal=v.literal,M._variable=v.variable,M._quad=v.quad,M.DEFAULTGRAPH=v.defaultGraph(),M.RDF_FIRST=y(k.default.rdf.first),M.RDF_REST=y(k.default.rdf.rest),M.RDF_NIL=y(k.default.rdf.nil),M.N3_FORALL=y(k.default.r.forAll),M.N3_FORSOME=y(k.default.r.forSome),M.ABBREVIATIONS={a:y(k.default.rdf.type),"=":y(k.default.owl.sameAs),">":y(k.default.log.implies)},M.QUANTIFIERS_GRAPH=y("urn:n3:quantifiers")}pe.default=b,P(b.prototype,U.default)},{"./IRIs":34,"./N3DataFactory":35,"./N3Lexer":36}],38:[function(K,Me,pe){"use strict";Object.defineProperty(pe,"__esModule",{value:!0}),pe.default=void 0;var v,Y=function(v,y){if(!y&&v&&v.__esModule)return v;if(null===v||"object"!=typeof v&&"function"!=typeof v)return{default:v};var S=W(y);if(S&&S.has(v))return S.get(v);var T={},j=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var R in v)if("default"!==R&&Object.prototype.hasOwnProperty.call(v,R)){var q=j?Object.getOwnPropertyDescriptor(v,R):null;q&&(q.get||q.set)?Object.defineProperty(T,R,q):T[R]=v[R]}return T.default=v,S&&S.set(v,T),T}(K("./N3DataFactory")),U=K("readable-stream"),k=(v=K("./IRIs"))&&v.__esModule?v:{default:v};function W(v){if("function"!=typeof WeakMap)return null;var y=new WeakMap,S=new WeakMap;return(W=function(T){return T?S:y})(v)}class C{constructor(y,S){this._size=0,this._graphs=Object.create(null),this._id=0,this._ids=Object.create(null),this._ids["><"]=0,this._entities=Object.create(null),this._blankNodeIndex=0,!S&&y&&!y[0]&&(S=y,y=null),this._factory=(S=S||{}).factory||Y.default,y&&this.addQuads(y)}get size(){let y=this._size;if(null!==y)return y;y=0;const S=this._graphs;let T,j;for(const R in S)for(const q in T=S[R].subjects)for(const ue in j=T[q])y+=Object.keys(j[ue]).length;return this._size=y}_addToIndex(y,S,T,j){const R=y[S]||(y[S]={}),q=R[T]||(R[T]={}),ue=j in q;return ue||(q[j]=null),!ue}_removeFromIndex(y,S,T,j){const R=y[S],q=R[T];delete q[j];for(const ue in q)return;delete R[T];for(const ue in R)return;delete y[S]}*_findInIndex(y,S,T,j,R,q,ue,D){let O,X,E;const Q=!S+!T+!j>1?Object.keys(this._ids):this._entities,ae=(0,Y.termFromId)(D,this._factory);S&&((O=y,y={})[S]=O[S]);for(const se in y){const ee=Q[se];if(X=y[se]){T&&((O=X,X={})[T]=O[T]);for(const xe in X){const me=Q[xe];if(E=X[xe]){const te=j?j in E?[j]:[]:Object.keys(E);for(let _e=0;_e<te.length;_e++){const Oe={subject:null,predicate:null,object:null};Oe[R]=(0,Y.termFromId)(ee,this._factory),Oe[q]=(0,Y.termFromId)(me,this._factory),Oe[ue]=(0,Y.termFromId)(Q[te[_e]],this._factory),yield this._factory.quad(Oe.subject,Oe.predicate,Oe.object,ae)}}}}}}_loop(y,S){for(const T in y)S(T)}_loopByKey0(y,S,T){let j,R;if(j=y[S])for(R in j)T(R)}_loopByKey1(y,S,T){let j,R;for(j in y)R=y[j],R[S]&&T(j)}_loopBy2Keys(y,S,T,j){let R,q,ue;if((R=y[S])&&(q=R[T]))for(ue in q)j(ue)}_countInIndex(y,S,T,j){let q,ue,D,R=0;S&&((q=y,y={})[S]=q[S]);for(const O in y)if(ue=y[O]){T&&((q=ue,ue={})[T]=q[T]);for(const X in ue)(D=ue[X])&&(j?j in D&&R++:R+=Object.keys(D).length)}return R}_getGraphs(y){if(!P(y))return this._graphs;const S={};return S[y]=this._graphs[y],S}_uniqueEntities(y){const S=Object.create(null);return T=>{T in S||(S[T]=!0,y((0,Y.termFromId)(this._entities[T],this._factory)))}}add(y){return this.addQuad(y),this}addQuad(y,S,T,j){S||(j=y.graph,T=y.object,S=y.predicate,y=y.subject),y=(0,Y.termToId)(y),S=(0,Y.termToId)(S),T=(0,Y.termToId)(T),j=(0,Y.termToId)(j);let R=this._graphs[j];R||(R=this._graphs[j]={subjects:{},predicates:{},objects:{}},Object.freeze(R));const q=this._ids,ue=this._entities;y=q[y]||(q[ue[++this._id]=y]=this._id),S=q[S]||(q[ue[++this._id]=S]=this._id),T=q[T]||(q[ue[++this._id]=T]=this._id);const D=this._addToIndex(R.subjects,y,S,T);return this._addToIndex(R.predicates,S,T,y),this._addToIndex(R.objects,T,y,S),this._size=null,D}addQuads(y){for(let S=0;S<y.length;S++)this.addQuad(y[S])}delete(y){return this.removeQuad(y),this}has(y,S,T,j){return y&&y.subject&&({subject:y,predicate:S,object:T,graph:j}=y),!this.readQuads(y,S,T,j).next().done}import(y){return y.on("data",S=>{this.addQuad(S)}),y}removeQuad(y,S,T,j){S||(j=y.graph,T=y.object,S=y.predicate,y=y.subject),y=(0,Y.termToId)(y),S=(0,Y.termToId)(S),T=(0,Y.termToId)(T),j=(0,Y.termToId)(j);const R=this._ids,q=this._graphs;let ue,D,O;if(!((y=R[y])&&(S=R[S])&&(T=R[T])&&(ue=q[j])&&(D=ue.subjects[y])&&(O=D[S])&&T in O))return!1;for(y in this._removeFromIndex(ue.subjects,y,S,T),this._removeFromIndex(ue.predicates,S,T,y),this._removeFromIndex(ue.objects,T,y,S),null!==this._size&&this._size--,ue.subjects)return!0;return delete q[j],!0}removeQuads(y){for(let S=0;S<y.length;S++)this.removeQuad(y[S])}remove(y){return y.on("data",S=>{this.removeQuad(S)}),y}removeMatches(y,S,T,j){const R=new U.Readable({objectMode:!0});return R._read=()=>{for(const q of this.readQuads(y,S,T,j))R.push(q);R.push(null)},this.remove(R)}deleteGraph(y){return this.removeMatches(null,null,null,y)}getQuads(y,S,T,j){return[...this.readQuads(y,S,T,j)]}*readQuads(y,S,T,j){y=y&&(0,Y.termToId)(y),S=S&&(0,Y.termToId)(S),T=T&&(0,Y.termToId)(T),j=j&&(0,Y.termToId)(j);const R=this._getGraphs(j),q=this._ids;let ue,D,O,X;if(!(P(y)&&!(D=q[y])||P(S)&&!(O=q[S])||P(T)&&!(X=q[T])))for(const E in R)(ue=R[E])&&(D?X?yield*this._findInIndex(ue.objects,X,D,O,"object","subject","predicate",E,null,!0):yield*this._findInIndex(ue.subjects,D,O,null,"subject","predicate","object",E,null,!0):O?yield*this._findInIndex(ue.predicates,O,X,null,"predicate","object","subject",E,null,!0):X?yield*this._findInIndex(ue.objects,X,null,null,"object","subject","predicate",E,null,!0):yield*this._findInIndex(ue.subjects,null,null,null,"subject","predicate","object",E,null,!0))}match(y,S,T,j){return new M(this,y,S,T,j)}countQuads(y,S,T,j){y=y&&(0,Y.termToId)(y),S=S&&(0,Y.termToId)(S),T=T&&(0,Y.termToId)(T),j=j&&(0,Y.termToId)(j);const R=this._getGraphs(j),q=this._ids;let D,O,X,E,ue=0;if(P(y)&&!(O=q[y])||P(S)&&!(X=q[S])||P(T)&&!(E=q[T]))return 0;for(const G in R)(D=R[G])&&(ue+=y?T?this._countInIndex(D.objects,E,O,X):this._countInIndex(D.subjects,O,X,E):S?this._countInIndex(D.predicates,X,E,O):this._countInIndex(D.objects,E,O,X));return ue}forEach(y,S,T,j,R){this.some(q=>(y(q),!1),S,T,j,R)}every(y,S,T,j,R){let q=!1;const ue=!this.some(D=>(q=!0,!y(D)),S,T,j,R);return q&&ue}some(y,S,T,j,R){for(const q of this.readQuads(S,T,j,R))if(y(q))return!0;return!1}getSubjects(y,S,T){const j=[];return this.forSubjects(R=>{j.push(R)},y,S,T),j}forSubjects(y,S,T,j){S=S&&(0,Y.termToId)(S),T=T&&(0,Y.termToId)(T),j=j&&(0,Y.termToId)(j);const R=this._ids,q=this._getGraphs(j);let ue,D,O;if(y=this._uniqueEntities(y),!(P(S)&&!(D=R[S])||P(T)&&!(O=R[T])))for(j in q)(ue=q[j])&&(D?O?this._loopBy2Keys(ue.predicates,D,O,y):this._loopByKey1(ue.subjects,D,y):O?this._loopByKey0(ue.objects,O,y):this._loop(ue.subjects,y))}getPredicates(y,S,T){const j=[];return this.forPredicates(R=>{j.push(R)},y,S,T),j}forPredicates(y,S,T,j){S=S&&(0,Y.termToId)(S),T=T&&(0,Y.termToId)(T),j=j&&(0,Y.termToId)(j);const R=this._ids,q=this._getGraphs(j);let ue,D,O;if(y=this._uniqueEntities(y),!(P(S)&&!(D=R[S])||P(T)&&!(O=R[T])))for(j in q)(ue=q[j])&&(D?O?this._loopBy2Keys(ue.objects,O,D,y):this._loopByKey0(ue.subjects,D,y):O?this._loopByKey1(ue.predicates,O,y):this._loop(ue.predicates,y))}getObjects(y,S,T){const j=[];return this.forObjects(R=>{j.push(R)},y,S,T),j}forObjects(y,S,T,j){S=S&&(0,Y.termToId)(S),T=T&&(0,Y.termToId)(T),j=j&&(0,Y.termToId)(j);const R=this._ids,q=this._getGraphs(j);let ue,D,O;if(y=this._uniqueEntities(y),!(P(S)&&!(D=R[S])||P(T)&&!(O=R[T])))for(j in q)(ue=q[j])&&(D?O?this._loopBy2Keys(ue.subjects,D,O,y):this._loopByKey1(ue.objects,D,y):O?this._loopByKey0(ue.predicates,O,y):this._loop(ue.objects,y))}getGraphs(y,S,T){const j=[];return this.forGraphs(R=>{j.push(R)},y,S,T),j}forGraphs(y,S,T,j){for(const R in this._graphs)this.some(q=>(y(q.graph),!0),S,T,j,R)}createBlankNode(y){let S,T;if(y)for(S=y=`_:${y}`,T=1;this._ids[S];)S=y+T++;else do{S="_:b"+this._blankNodeIndex++}while(this._ids[S]);return this._ids[S]=++this._id,this._entities[this._id]=S,this._factory.blankNode(S.substr(2))}extractLists({remove:y=!1,ignoreErrors:S=!1}={}){const T={},j=S?()=>!0:(ue,D)=>{throw new Error(`${ue.value} ${D}`)},R=this.getQuads(null,k.default.rdf.rest,k.default.rdf.nil,null),q=y?[...R]:[];return R.forEach(ue=>{const D=[];let X,E,O=!1;const G=ue.graph;let Q=ue.subject;for(;Q&&!O;){const ae=this.getQuads(null,null,Q,null),se=this.getQuads(Q,null,null,null);let ee,xe=null,me=null,te=null;for(let _e=0;_e<se.length&&!O;_e++)ee=se[_e],ee.graph.equals(G)?X?O=j(Q,"has non-list arcs out"):ee.predicate.value===k.default.rdf.first?xe?O=j(Q,"has multiple rdf:first arcs"):q.push(xe=ee):ee.predicate.value===k.default.rdf.rest?me?O=j(Q,"has multiple rdf:rest arcs"):q.push(me=ee):ae.length?O=j(Q,"can't be subject and object"):(X=ee,E="subject"):O=j(Q,"not confined to single graph");for(let _e=0;_e<ae.length&&!O;++_e)ee=ae[_e],X?O=j(Q,"can't have coreferences"):ee.predicate.value===k.default.rdf.rest?te?O=j(Q,"has incoming rdf:rest arcs"):te=ee:(X=ee,E="object");xe?D.unshift(xe.object):O=j(Q,"has no list head"),Q=te&&te.subject}O?y=!1:X&&(T[X[E].value]=D)}),y&&this.removeQuads(q),T}*[Symbol.iterator](){yield*this.readQuads()}}function P(v){return"string"==typeof v||v instanceof String}pe.default=C;class M extends U.Readable{constructor(y,S,T,j,R){super({objectMode:!0}),Object.assign(this,{n3Store:y,subject:S,predicate:T,object:j,graph:R})}get filtered(){if(!this._filtered){const{n3Store:y,graph:S,object:T,predicate:j,subject:R}=this,q=y.getQuads(R,j,T,S);this._filtered=new C(q,{factory:y._factory})}return this._filtered}get size(){return this.filtered.size}_read(){for(const y of this)this.push(y);this.push(null)}add(y){return this.filtered.add(y)}delete(y){return this.filtered.delete(y)}has(y){return this.filtered.has(y)}match(y,S,T,j){return new M(this.filtered,y,S,T,j)}*[Symbol.iterator](){yield*this._filtered||this.n3Store.readQuads(this.subject,this.predicate,this.object,this.graph)}}},{"./IRIs":34,"./N3DataFactory":35,"readable-stream":81}],39:[function(K,Me,pe){"use strict";Object.defineProperty(pe,"__esModule",{value:!0}),pe.default=void 0;var W,Y=(W=K("./N3Parser"))&&W.__esModule?W:{default:W},U=K("readable-stream");pe.default=class extends U.Transform{constructor(b){let P,M;super({decodeStrings:!0}),this._readableState.objectMode=!0,new Y.default(b).parse({on:(v,y)=>{switch(v){case"data":P=y;break;case"end":M=y}}},(v,y)=>{v&&this.emit("error",v)||y&&this.push(y)},(v,y)=>{this.emit("prefix",v,y)}),this._transform=(v,y,S)=>{P(v),S()},this._flush=v=>{M(),v()}}import(b){return b.on("data",C=>{this.write(C)}),b.on("end",()=>{this.end()}),b.on("error",C=>{this.emit("error",C)}),this}}},{"./N3Parser":37,"readable-stream":81}],40:[function(K,Me,pe){"use strict";Object.defineProperty(pe,"__esModule",{value:!0}),pe.default=void 0;var W,Y=K("readable-stream"),U=(W=K("./N3Writer"))&&W.__esModule?W:{default:W};pe.default=class extends Y.Transform{constructor(b){super({encoding:"utf8",writableObjectMode:!0});const C=this._writer=new U.default({write:(P,M,v)=>{this.push(P),v&&v()},end:P=>{this.push(null),P&&P()}},b);this._transform=(P,M,v)=>{C.addQuad(P,v)},this._flush=P=>{C.end(P)}}import(b){return b.on("data",C=>{this.write(C)}),b.on("end",()=>{this.end()}),b.on("error",C=>{this.emit("error",C)}),b.on("prefix",(C,P)=>{this._writer.addPrefix(C,P)}),this}}},{"./N3Writer":42,"readable-stream":81}],41:[function(K,Me,pe){"use strict";Object.defineProperty(pe,"__esModule",{value:!0}),pe.inDefaultGraph=function(y){return C(y.graph)},pe.isBlankNode=function(y){return!!y&&"BlankNode"===y.termType},pe.isDefaultGraph=C,pe.isLiteral=function(y){return!!y&&"Literal"===y.termType},pe.isNamedNode=function(y){return!!y&&"NamedNode"===y.termType},pe.isVariable=function(y){return!!y&&"Variable"===y.termType},pe.prefix=function(y,S){return v({"":y.value||y},S)("")},pe.prefixes=v;var y,Y=(y=K("./N3DataFactory"))&&y.__esModule?y:{default:y};function C(y){return!!y&&"DefaultGraph"===y.termType}function v(y,S){const T=Object.create(null);for(const R in y)j(R,y[R]);function j(R,q){if("string"==typeof q){const ue=Object.create(null);T[R]=D=>ue[D]||(ue[D]=S.namedNode(q+D))}else if(!(R in T))throw new Error(`Unknown prefix: ${R}`);return T[R]}return S=S||Y.default,j}},{"./N3DataFactory":35}],42:[function(K,Me,pe){"use strict";Object.defineProperty(pe,"__esModule",{value:!0}),pe.default=void 0;var ue,Y=(ue=K("./IRIs"))&&ue.__esModule?ue:{default:ue},U=function(ue,D){if(!D&&ue&&ue.__esModule)return ue;if(null===ue||"object"!=typeof ue&&"function"!=typeof ue)return{default:ue};var O=ie(D);if(O&&O.has(ue))return O.get(ue);var X={},E=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var G in ue)if("default"!==G&&Object.prototype.hasOwnProperty.call(ue,G)){var Q=E?Object.getOwnPropertyDescriptor(ue,G):null;Q&&(Q.get||Q.set)?Object.defineProperty(X,G,Q):X[G]=ue[G]}return X.default=ue,O&&O.set(ue,X),X}(K("./N3DataFactory")),k=K("./N3Util");function ie(ue){if("function"!=typeof WeakMap)return null;var D=new WeakMap,O=new WeakMap;return(ie=function(X){return X?O:D})(ue)}const C=U.default.defaultGraph(),{rdf:P,xsd:M}=Y.default,v=/["\\\t\n\r\b\f\u0000-\u0019\ud800-\udbff]/,y=/["\\\t\n\r\b\f\u0000-\u0019]|[\ud800-\udbff][\udc00-\udfff]/g,S={"\\":"\\\\",'"':'\\"',"\t":"\\t","\n":"\\n","\r":"\\r","\b":"\\b","\f":"\\f"};class T extends U.Term{equals(){return!1}}function R(ue){let D=S[ue];return void 0===D&&(1===ue.length?(D=ue.charCodeAt(0).toString(16),D="\\u0000".substr(0,6-D.length)+D):(D=(1024*(ue.charCodeAt(0)-55296)+ue.charCodeAt(1)+9216).toString(16),D="\\U00000000".substr(0,10-D.length)+D)),D}function q(ue){return ue.replace(/[\]\/\(\)\*\+\?\.\\\$]/g,"\\$&")}pe.default=class{constructor(D,O){if(this._prefixRegex=/$0^/,D&&"function"!=typeof D.write&&(O=D,D=null),this._lists=(O=O||{}).lists,D)this._outputStream=D,this._endStream=void 0===O.end||!!O.end;else{let X="";this._outputStream={write(E,G,Q){X+=E,Q&&Q()},end:E=>{E&&E(null,X)}},this._endStream=!0}this._subject=null,/triple|quad/i.test(O.format)?(this._lineMode=!0,this._writeQuad=this._writeQuadLine):(this._lineMode=!1,this._graph=C,this._prefixIRIs=Object.create(null),O.prefixes&&this.addPrefixes(O.prefixes),O.baseIRI&&(this._baseMatcher=new RegExp(`^${q(O.baseIRI)}${O.baseIRI.endsWith("/")?"":"[#?]"}`),this._baseLength=O.baseIRI.length))}get _inDefaultGraph(){return C.equals(this._graph)}_write(D,O){this._outputStream.write(D,"utf8",O)}_writeQuad(D,O,X,E,G){try{E.equals(this._graph)||(this._write((null===this._subject?"":this._inDefaultGraph?".\n":"\n}\n")+(C.equals(E)?"":`${this._encodeIriOrBlank(E)} {\n`)),this._graph=E,this._subject=null),D.equals(this._subject)?O.equals(this._predicate)?this._write(`, ${this._encodeObject(X)}`,G):this._write(`;\n    ${this._encodePredicate(this._predicate=O)} ${this._encodeObject(X)}`,G):this._write(`${(null===this._subject?"":".\n")+this._encodeSubject(this._subject=D)} ${this._encodePredicate(this._predicate=O)} ${this._encodeObject(X)}`,G)}catch(Q){G&&G(Q)}}_writeQuadLine(D,O,X,E,G){delete this._prefixMatch,this._write(this.quadToString(D,O,X,E),G)}quadToString(D,O,X,E){return`${this._encodeSubject(D)} ${this._encodeIriOrBlank(O)} ${this._encodeObject(X)}${E&&E.value?` ${this._encodeIriOrBlank(E)} .\n`:" .\n"}`}quadsToString(D){return D.map(O=>this.quadToString(O.subject,O.predicate,O.object,O.graph)).join("")}_encodeSubject(D){return"Quad"===D.termType?this._encodeQuad(D):this._encodeIriOrBlank(D)}_encodeIriOrBlank(D){if("NamedNode"!==D.termType)return this._lists&&D.value in this._lists&&(D=this.list(this._lists[D.value])),"id"in D?D.id:`_:${D.value}`;let O=D.value;this._baseMatcher&&this._baseMatcher.test(O)&&(O=O.substr(this._baseLength)),v.test(O)&&(O=O.replace(y,R));const X=this._prefixRegex.exec(O);return X?X[1]?this._prefixIRIs[X[1]]+X[2]:O:`<${O}>`}_encodeLiteral(D){let O=D.value;if(v.test(O)&&(O=O.replace(y,R)),D.language)return`"${O}"@${D.language}`;if(this._lineMode){if(D.datatype.value===M.string)return`"${O}"`}else switch(D.datatype.value){case M.string:return`"${O}"`;case M.boolean:if("true"===O||"false"===O)return O;break;case M.integer:if(/^[+-]?\d+$/.test(O))return O;break;case M.decimal:if(/^[+-]?\d*\.\d+$/.test(O))return O;break;case M.double:if(/^[+-]?(?:\d+\.\d*|\.?\d+)[eE][+-]?\d+$/.test(O))return O}return`"${O}"^^${this._encodeIriOrBlank(D.datatype)}`}_encodePredicate(D){return D.value===P.type?"a":this._encodeIriOrBlank(D)}_encodeObject(D){switch(D.termType){case"Quad":return this._encodeQuad(D);case"Literal":return this._encodeLiteral(D);default:return this._encodeIriOrBlank(D)}}_encodeQuad({subject:D,predicate:O,object:X,graph:E}){return`<<${this._encodeSubject(D)} ${this._encodePredicate(O)} ${this._encodeObject(X)}${(0,k.isDefaultGraph)(E)?"":` ${this._encodeIriOrBlank(E)}`}>>`}_blockedWrite(){throw new Error("Cannot write because the writer has been closed.")}addQuad(D,O,X,E,G){void 0===X?this._writeQuad(D.subject,D.predicate,D.object,D.graph,O):"function"==typeof E?this._writeQuad(D,O,X,C,E):this._writeQuad(D,O,X,E||C,G)}addQuads(D){for(let O=0;O<D.length;O++)this.addQuad(D[O])}addPrefix(D,O,X){const E={};E[D]=O,this.addPrefixes(E,X)}addPrefixes(D,O){if(!this._prefixIRIs)return O&&O();let X=!1;for(let E in D){let G=D[E];"string"!=typeof G&&(G=G.value),X=!0,null!==this._subject&&(this._write(this._inDefaultGraph?".\n":"\n}\n"),this._subject=null,this._graph=""),this._prefixIRIs[G]=E+=":",this._write(`@prefix ${E} <${G}>.\n`)}if(X){let E="",G="";for(const Q in this._prefixIRIs)E+=E?`|${Q}`:Q,G+=(G?"|":"")+this._prefixIRIs[Q];E=q(E),this._prefixRegex=new RegExp(`^(?:${G})[^/]*$|^(${E})([a-zA-Z][\\-_a-zA-Z0-9]*)$`)}this._write(X?"\n":"",O)}blank(D,O){let E,G,X=D;switch(void 0===D?X=[]:D.termType?X=[{predicate:D,object:O}]:"length"in D||(X=[D]),G=X.length){case 0:return new T("[]");case 1:if(E=X[0],!(E.object instanceof T))return new T(`[ ${this._encodePredicate(E.predicate)} ${this._encodeObject(E.object)} ]`);default:let Q="[";for(let ae=0;ae<G;ae++)E=X[ae],E.predicate.equals(D)?Q+=`, ${this._encodeObject(E.object)}`:(Q+=`${(ae?";\n  ":"\n  ")+this._encodePredicate(E.predicate)} ${this._encodeObject(E.object)}`,D=E.predicate);return new T(`${Q}\n]`)}}list(D){const O=D&&D.length||0,X=new Array(O);for(let E=0;E<O;E++)X[E]=this._encodeObject(D[E]);return new T(`(${X.join(" ")})`)}end(D){null!==this._subject&&(this._write(this._inDefaultGraph?".\n":"\n}\n"),this._subject=null),this._write=this._blockedWrite;let O=D&&((X,E)=>{O=null,D(X,E)});if(this._endStream)try{return this._outputStream.end(O)}catch(X){}O&&O()}}},{"./IRIs":34,"./N3DataFactory":35,"./N3Util":41}],43:[function(K,Me,pe){"use strict";Object.defineProperty(pe,"__esModule",{value:!0}),Object.defineProperty(pe,"BlankNode",{enumerable:!0,get:function(){return P.BlankNode}}),Object.defineProperty(pe,"DataFactory",{enumerable:!0,get:function(){return P.default}}),Object.defineProperty(pe,"DefaultGraph",{enumerable:!0,get:function(){return P.DefaultGraph}}),Object.defineProperty(pe,"Lexer",{enumerable:!0,get:function(){return Y.default}}),Object.defineProperty(pe,"Literal",{enumerable:!0,get:function(){return P.Literal}}),Object.defineProperty(pe,"NamedNode",{enumerable:!0,get:function(){return P.NamedNode}}),Object.defineProperty(pe,"Parser",{enumerable:!0,get:function(){return U.default}}),Object.defineProperty(pe,"Quad",{enumerable:!0,get:function(){return P.Quad}}),Object.defineProperty(pe,"Store",{enumerable:!0,get:function(){return ie.default}}),Object.defineProperty(pe,"StreamParser",{enumerable:!0,get:function(){return W.default}}),Object.defineProperty(pe,"StreamWriter",{enumerable:!0,get:function(){return b.default}}),Object.defineProperty(pe,"Term",{enumerable:!0,get:function(){return P.Term}}),Object.defineProperty(pe,"Triple",{enumerable:!0,get:function(){return P.Triple}}),pe.Util=void 0,Object.defineProperty(pe,"Variable",{enumerable:!0,get:function(){return P.Variable}}),Object.defineProperty(pe,"Writer",{enumerable:!0,get:function(){return k.default}}),pe.default=void 0,Object.defineProperty(pe,"termFromId",{enumerable:!0,get:function(){return P.termFromId}}),Object.defineProperty(pe,"termToId",{enumerable:!0,get:function(){return P.termToId}});var Y=y(K("./N3Lexer")),U=y(K("./N3Parser")),k=y(K("./N3Writer")),ie=y(K("./N3Store")),W=y(K("./N3StreamParser")),b=y(K("./N3StreamWriter")),C=v(K("./N3Util"));pe.Util=C;var P=v(K("./N3DataFactory"));function M(T){if("function"!=typeof WeakMap)return null;var j=new WeakMap,R=new WeakMap;return(M=function(q){return q?R:j})(T)}function v(T,j){if(!j&&T&&T.__esModule)return T;if(null===T||"object"!=typeof T&&"function"!=typeof T)return{default:T};var R=M(j);if(R&&R.has(T))return R.get(T);var q={},ue=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var D in T)if("default"!==D&&Object.prototype.hasOwnProperty.call(T,D)){var O=ue?Object.getOwnPropertyDescriptor(T,D):null;O&&(O.get||O.set)?Object.defineProperty(q,D,O):q[D]=T[D]}return q.default=T,R&&R.set(T,q),q}function y(T){return T&&T.__esModule?T:{default:T}}pe.default={Lexer:Y.default,Parser:U.default,Writer:k.default,Store:ie.default,StreamParser:W.default,StreamWriter:b.default,Util:C,DataFactory:P.default,Term:P.Term,NamedNode:P.NamedNode,Literal:P.Literal,BlankNode:P.BlankNode,Variable:P.Variable,DefaultGraph:P.DefaultGraph,Quad:P.Quad,Triple:P.Triple,termFromId:P.termFromId,termToId:P.termToId}},{"./N3DataFactory":35,"./N3Lexer":36,"./N3Parser":37,"./N3Store":38,"./N3StreamParser":39,"./N3StreamWriter":40,"./N3Util":41,"./N3Writer":42}],44:[function(K,Me,pe){var U,k,Y=Me.exports={};function ie(){throw new Error("setTimeout has not been defined")}function W(){throw new Error("clearTimeout has not been defined")}function b(q){if(U===setTimeout)return setTimeout(q,0);if((U===ie||!U)&&setTimeout)return U=setTimeout,setTimeout(q,0);try{return U(q,0)}catch(ue){try{return U.call(null,q,0)}catch(D){return U.call(this,q,0)}}}!function(){try{U="function"==typeof setTimeout?setTimeout:ie}catch(q){U=ie}try{k="function"==typeof clearTimeout?clearTimeout:W}catch(q){k=W}}();var v,P=[],M=!1,y=-1;function S(){!M||!v||(M=!1,v.length?P=v.concat(P):y=-1,P.length&&T())}function T(){if(!M){var q=b(S);M=!0;for(var ue=P.length;ue;){for(v=P,P=[];++y<ue;)v&&v[y].run();y=-1,ue=P.length}v=null,M=!1,function(q){if(k===clearTimeout)return clearTimeout(q);if((k===W||!k)&&clearTimeout)return k=clearTimeout,clearTimeout(q);try{k(q)}catch(ue){try{return k.call(null,q)}catch(D){return k.call(this,q)}}}(q)}}function j(q,ue){this.fun=q,this.array=ue}function R(){}Y.nextTick=function(q){var ue=new Array(arguments.length-1);if(arguments.length>1)for(var D=1;D<arguments.length;D++)ue[D-1]=arguments[D];P.push(new j(q,ue)),1===P.length&&!M&&b(T)},j.prototype.run=function(){this.fun.apply(null,this.array)},Y.title="browser",Y.browser=!0,Y.env={},Y.argv=[],Y.version="",Y.versions={},Y.on=R,Y.addListener=R,Y.once=R,Y.off=R,Y.removeListener=R,Y.removeAllListeners=R,Y.emit=R,Y.prependListener=R,Y.prependOnceListener=R,Y.listeners=function(q){return[]},Y.binding=function(q){throw new Error("process.binding is not supported")},Y.cwd=function(){return"/"},Y.chdir=function(q){throw new Error("process.chdir is not supported")},Y.umask=function(){return 0}},{}],45:[function(K,Me,pe){(function(Y){(function(){let U;Me.exports="function"==typeof queueMicrotask?queueMicrotask.bind("undefined"!=typeof window?window:Y):k=>(U||(U=Promise.resolve())).then(k).catch(ie=>setTimeout(()=>{throw ie},0))}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],46:[function(K,Me,pe){Me.exports=K("./lib")},{"./lib":55}],47:[function(K,Me,pe){"use strict";Me.exports=class g9{constructor(U,k=new Map,ie=0){this.prefix=U,this._existing=k,this.counter=ie}clone(){const{prefix:U,_existing:k,counter:ie}=this;return new g9(U,new Map(k),ie)}getId(U){const k=U&&this._existing.get(U);if(k)return k;const ie=this.prefix+this.counter;return this.counter++,U&&this._existing.set(U,ie),ie}hasId(U){return this._existing.has(U)}getOldIds(){return[...this._existing.keys()]}}},{}],48:[function(K,Me,pe){"use strict";K("setimmediate");const Y=self.crypto||self.msCrypto;Me.exports=class{constructor(k){if(!Y||!Y.subtle)throw new Error("crypto.subtle not found.");if("sha256"===k)this.algorithm={name:"SHA-256"};else{if("sha1"!==k)throw new Error(`Unsupport algorithm "${k}".`);this.algorithm={name:"SHA-1"}}this._content=""}update(k){this._content+=k}digest(){var k=this;return mt(function*(){const ie=(new TextEncoder).encode(k._content),W=new Uint8Array(yield Y.subtle.digest(k.algorithm,ie));let b="";for(let C=0;C<W.length;++C)b+=W[C].toString(16).padStart(2,"0");return b})()}}},{setimmediate:86}],49:[function(K,Me,pe){"use strict";const k="http://www.w3.org/1999/02/22-rdf-syntax-ns#langString",ie="http://www.w3.org/2001/XMLSchema#string",W="NamedNode",b="BlankNode",C="Literal",P="DefaultGraph",M={};function v(R,q){return R.subject.termType===q.subject.termType&&R.object.termType===q.object.termType&&R.subject.value===q.subject.value&&R.predicate.value===q.predicate.value&&R.object.value===q.object.value&&(R.object.termType!==C||R.object.datatype.termType===q.object.datatype.termType&&R.object.language===q.object.language&&R.object.datatype.value===q.object.datatype.value)}M.eoln=/(?:\r\n)|(?:\n)|(?:\r)/g,M.empty=new RegExp("^[ \\t]*$"),M.quad=new RegExp('^[ \\t]*(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9])(?:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040.])*(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040]))?))[ \\t]+(?:<([^:]+:[^>]*)>)[ \\t]+(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9])(?:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040.])*(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040]))?)|(?:"([^"\\\\]*(?:\\\\.[^"\\\\]*)*)"(?:(?:\\^\\^(?:<([^:]+:[^>]*)>))|(?:@([a-zA-Z]+(?:-[a-zA-Z0-9]+)*)))?))[ \\t]*(?:\\.|(?:(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9])(?:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040.])*(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040]))?))[ \\t]*\\.))[ \\t]*$'),Me.exports=class SF{static parse(q){const ue=[],D={},O=q.split(M.eoln);let X=0;for(const E of O){if(X++,M.empty.test(E))continue;const G=E.match(M.quad);if(null===G)throw new Error("N-Quads parse error on line "+X+".");const Q={subject:null,predicate:null,object:null,graph:null};if(Q.subject=void 0!==G[1]?{termType:W,value:G[1]}:{termType:b,value:G[2]},Q.predicate={termType:W,value:G[3]},void 0!==G[4]?Q.object={termType:W,value:G[4]}:void 0!==G[5]?Q.object={termType:b,value:G[5]}:(Q.object={termType:C,value:void 0,datatype:{termType:W}},void 0!==G[7]?Q.object.datatype.value=G[7]:void 0!==G[8]?(Q.object.datatype.value=k,Q.object.language=G[8]):Q.object.datatype.value=ie,Q.object.value=G[6].replace(T,function(q,ue,D,O){if(ue)switch(ue){case"t":return"\t";case"b":return"\b";case"n":return"\n";case"r":return"\r";case"f":return"\f";case'"':return'"';case"'":return"'";case"\\":return"\\"}if(D)return String.fromCharCode(parseInt(D,16));if(O)throw new Error("Unsupported U escape")})),Q.graph=void 0!==G[9]?{termType:W,value:G[9]}:void 0!==G[10]?{termType:b,value:G[10]}:{termType:P,value:""},Q.graph.value in D){let ae=!0;const se=D[Q.graph.value];for(const ee of se)if(v(ee,Q)){ae=!1;break}ae&&(se.push(Q),ue.push(Q))}else D[Q.graph.value]=[Q],ue.push(Q)}return ue}static serialize(q){Array.isArray(q)||(q=SF.legacyDatasetToQuads(q));const ue=[];for(const D of q)ue.push(SF.serializeQuad(D));return ue.sort().join("")}static serializeQuad(q){const ue=q.subject,O=q.object,X=q.graph;let E="";return E+=ue.termType===W?`<${ue.value}>`:`${ue.value}`,E+=` <${q.predicate.value}> `,O.termType===W?E+=`<${O.value}>`:O.termType===b?E+=O.value:(E+=`"${R=O.value,R.replace(y,function(q){switch(q){case'"':return'\\"';case"\\":return"\\\\";case"\n":return"\\n";case"\r":return"\\r"}})}"`,O.datatype.value===k?O.language&&(E+=`@${O.language}`):O.datatype.value!==ie&&(E+=`^^<${O.datatype.value}>`)),X.termType===W?E+=` <${X.value}>`:X.termType===b&&(E+=` ${X.value}`),E+=" .\n",E;var R}static legacyDatasetToQuads(q){const ue=[],D={"blank node":b,IRI:W,literal:C};for(const O in q)q[O].forEach(E=>{const G={};for(const Q in E){const ae=E[Q],se={termType:D[ae.type],value:ae.value};se.termType===C&&(se.datatype={termType:W},"datatype"in ae&&(se.datatype.value=ae.datatype),"language"in ae?("datatype"in ae||(se.datatype.value=k),se.language=ae.language):"datatype"in ae||(se.datatype.value=ie)),G[Q]=se}G.graph="@default"===O?{termType:P,value:""}:{termType:O.startsWith("_:")?b:W,value:O},ue.push(G)});return ue}};const y=/["\\\n\r]/g;const T=/(?:\\([tbnrf"'\\]))|(?:\\u([0-9A-Fa-f]{4}))|(?:\\U([0-9A-Fa-f]{8}))/g},{}],50:[function(K,Me,pe){"use strict";Me.exports=class{constructor(U){this.current=U.sort(),this.done=!1,this.dir=new Map;for(let k=0;k<U.length;++k)this.dir.set(U[k],!0)}hasNext(){return!this.done}next(){const{current:U,dir:k}=this,ie=U.slice();let W=null,b=0;const C=U.length;for(let P=0;P<C;++P){const M=U[P],v=k.get(M);(null===W||M>W)&&(v&&P>0&&M>U[P-1]||!v&&P<C-1&&M>U[P+1])&&(W=M,b=P)}if(null===W)this.done=!0;else{const P=k.get(W)?b-1:b+1;U[b]=U[P],U[P]=W;for(const M of U)M>W&&k.set(M,!k.get(M))}return ie}}},{}],51:[function(K,Me,pe){(function(Y){(function(){"use strict";const U=K("./IdentifierIssuer"),k=K("./MessageDigest"),ie=K("./Permuter"),W=K("./NQuads");function b(C,P){return C.hash<P.hash?-1:C.hash>P.hash?1:0}Me.exports=class{constructor(){this.name="URDNA2015",this.blankNodeInfo=new Map,this.canonicalIssuer=new U("_:c14n"),this.hashAlgorithm="sha256",this.quads=null}main(P){var M=this;return mt(function*(){M.quads=P;for(const q of P)M._addBlankNodeQuadInfo({quad:q,component:q.subject}),M._addBlankNodeQuadInfo({quad:q,component:q.object}),M._addBlankNodeQuadInfo({quad:q,component:q.graph});const v=new Map,y=[...M.blankNodeInfo.keys()];let S=0;for(const q of y)++S%100==0&&(yield M._yield()),yield M._hashAndTrackBlankNode({id:q,hashToBlankNodes:v});const T=[...v.keys()].sort(),j=[];for(const q of T){const ue=v.get(q);ue.length>1?j.push(ue):M.canonicalIssuer.getId(ue[0])}for(const q of j){const ue=[];for(const D of q){if(M.canonicalIssuer.hasId(D))continue;const O=new U("_:b");O.getId(D);const X=yield M.hashNDegreeQuads(D,O);ue.push(X)}ue.sort(b);for(const D of ue){const O=D.issuer.getOldIds();for(const X of O)M.canonicalIssuer.getId(X)}}const R=[];for(const q of M.quads){const ue=dt({},q);ue.subject=M._useCanonicalId({component:ue.subject}),ue.object=M._useCanonicalId({component:ue.object}),ue.graph=M._useCanonicalId({component:ue.graph}),R.push(W.serializeQuad(ue))}return R.sort(),R.join("")})()}hashFirstDegreeQuads(P){var M=this;return mt(function*(){const v=[],y=M.blankNodeInfo.get(P),S=y.quads;for(const j of S){const R={subject:null,predicate:j.predicate,object:null,graph:null};R.subject=M.modifyFirstDegreeComponent(P,j.subject,"subject"),R.object=M.modifyFirstDegreeComponent(P,j.object,"object"),R.graph=M.modifyFirstDegreeComponent(P,j.graph,"graph"),v.push(W.serializeQuad(R))}v.sort();const T=new k(M.hashAlgorithm);for(const j of v)T.update(j);return y.hash=yield T.digest(),y.hash})()}hashRelatedBlankNode(P,M,v,y){var S=this;return mt(function*(){let T;T=S.canonicalIssuer.hasId(P)?S.canonicalIssuer.getId(P):v.hasId(P)?v.getId(P):S.blankNodeInfo.get(P).hash;const j=new k(S.hashAlgorithm);return j.update(y),"g"!==y&&j.update(S.getRelatedPredicate(M)),j.update(T),j.digest()})()}hashNDegreeQuads(P,M){var v=this;return mt(function*(){const y=new k(v.hashAlgorithm),S=yield v.createHashToRelated(P,M),T=[...S.keys()].sort();for(const j of T){y.update(j);let q,R="";const ue=new ie(S.get(j));let D=0;for(;ue.hasNext();){const O=ue.next();++D%3==0&&(yield v._yield());let X=M.clone(),E="";const G=[];let Q=!1;for(const ae of O)if(v.canonicalIssuer.hasId(ae)?E+=v.canonicalIssuer.getId(ae):(X.hasId(ae)||G.push(ae),E+=X.getId(ae)),0!==R.length&&E>R){Q=!0;break}if(!Q){for(const ae of G){const se=yield v.hashNDegreeQuads(ae,X);if(E+=X.getId(ae),E+=`<${se.hash}>`,X=se.issuer,0!==R.length&&E>R){Q=!0;break}}Q||(0===R.length||E<R)&&(R=E,q=X)}}y.update(R),M=q}return{hash:yield y.digest(),issuer:M}})()}modifyFirstDegreeComponent(P,M){return"BlankNode"!==M.termType?M:{termType:"BlankNode",value:M.value===P?"_:a":"_:z"}}getRelatedPredicate(P){return`<${P.predicate.value}>`}createHashToRelated(P,M){var v=this;return mt(function*(){const y=new Map,S=v.blankNodeInfo.get(P).quads;let T=0;for(const j of S)++T%100==0&&(yield v._yield()),yield Promise.all([v._addRelatedBlankNodeHash({quad:j,component:j.subject,position:"s",id:P,issuer:M,hashToRelated:y}),v._addRelatedBlankNodeHash({quad:j,component:j.object,position:"o",id:P,issuer:M,hashToRelated:y}),v._addRelatedBlankNodeHash({quad:j,component:j.graph,position:"g",id:P,issuer:M,hashToRelated:y})]);return y})()}_hashAndTrackBlankNode({id:P,hashToBlankNodes:M}){var v=this;return mt(function*(){const y=yield v.hashFirstDegreeQuads(P),S=M.get(y);S?S.push(P):M.set(y,[P])})()}_addBlankNodeQuadInfo({quad:P,component:M}){if("BlankNode"!==M.termType)return;const v=M.value,y=this.blankNodeInfo.get(v);y?y.quads.add(P):this.blankNodeInfo.set(v,{quads:new Set([P]),hash:null})}_addRelatedBlankNodeHash({quad:P,component:M,position:v,id:y,issuer:S,hashToRelated:T}){var j=this;return mt(function*(){if("BlankNode"!==M.termType||M.value===y)return;const R=M.value,q=yield j.hashRelatedBlankNode(R,P,S,v),ue=T.get(q);ue?ue.push(R):T.set(q,[R])})()}_useCanonicalId({component:P}){return"BlankNode"!==P.termType||P.value.startsWith(this.canonicalIssuer.prefix)?P:{termType:"BlankNode",value:this.canonicalIssuer.getId(P.value)}}_yield(){return mt(function*(){return new Promise(P=>Y(P))})()}}}).call(this)}).call(this,K("timers").setImmediate)},{"./IdentifierIssuer":47,"./MessageDigest":48,"./NQuads":49,"./Permuter":50,timers:89}],52:[function(K,Me,pe){"use strict";const Y=K("./IdentifierIssuer"),U=K("./MessageDigest"),k=K("./Permuter"),ie=K("./NQuads");function W(b,C){return b.hash<C.hash?-1:b.hash>C.hash?1:0}Me.exports=class{constructor(){this.name="URDNA2015",this.blankNodeInfo=new Map,this.canonicalIssuer=new Y("_:c14n"),this.hashAlgorithm="sha256",this.quads=null}main(C){this.quads=C;for(const T of C)this._addBlankNodeQuadInfo({quad:T,component:T.subject}),this._addBlankNodeQuadInfo({quad:T,component:T.object}),this._addBlankNodeQuadInfo({quad:T,component:T.graph});const P=new Map,M=[...this.blankNodeInfo.keys()];for(const T of M)this._hashAndTrackBlankNode({id:T,hashToBlankNodes:P});const v=[...P.keys()].sort(),y=[];for(const T of v){const j=P.get(T);j.length>1?y.push(j):this.canonicalIssuer.getId(j[0])}for(const T of y){const j=[];for(const R of T){if(this.canonicalIssuer.hasId(R))continue;const q=new Y("_:b");q.getId(R);const ue=this.hashNDegreeQuads(R,q);j.push(ue)}j.sort(W);for(const R of j){const q=R.issuer.getOldIds();for(const ue of q)this.canonicalIssuer.getId(ue)}}const S=[];for(const T of this.quads){const j=dt({},T);j.subject=this._useCanonicalId({component:j.subject}),j.object=this._useCanonicalId({component:j.object}),j.graph=this._useCanonicalId({component:j.graph}),S.push(ie.serializeQuad(j))}return S.sort(),S.join("")}hashFirstDegreeQuads(C){const P=[],M=this.blankNodeInfo.get(C),v=M.quads;for(const S of v){const T={subject:null,predicate:S.predicate,object:null,graph:null};T.subject=this.modifyFirstDegreeComponent(C,S.subject,"subject"),T.object=this.modifyFirstDegreeComponent(C,S.object,"object"),T.graph=this.modifyFirstDegreeComponent(C,S.graph,"graph"),P.push(ie.serializeQuad(T))}P.sort();const y=new U(this.hashAlgorithm);for(const S of P)y.update(S);return M.hash=y.digest(),M.hash}hashRelatedBlankNode(C,P,M,v){let y;y=this.canonicalIssuer.hasId(C)?this.canonicalIssuer.getId(C):M.hasId(C)?M.getId(C):this.blankNodeInfo.get(C).hash;const S=new U(this.hashAlgorithm);return S.update(v),"g"!==v&&S.update(this.getRelatedPredicate(P)),S.update(y),S.digest()}hashNDegreeQuads(C,P){const M=new U(this.hashAlgorithm),v=this.createHashToRelated(C,P),y=[...v.keys()].sort();for(const S of y){M.update(S);let j,T="";const R=new k(v.get(S));for(;R.hasNext();){const q=R.next();let ue=P.clone(),D="";const O=[];let X=!1;for(const E of q)if(this.canonicalIssuer.hasId(E)?D+=this.canonicalIssuer.getId(E):(ue.hasId(E)||O.push(E),D+=ue.getId(E)),0!==T.length&&D>T){X=!0;break}if(!X){for(const E of O){const G=this.hashNDegreeQuads(E,ue);if(D+=ue.getId(E),D+=`<${G.hash}>`,ue=G.issuer,0!==T.length&&D>T){X=!0;break}}X||(0===T.length||D<T)&&(T=D,j=ue)}}M.update(T),P=j}return{hash:M.digest(),issuer:P}}modifyFirstDegreeComponent(C,P){return"BlankNode"!==P.termType?P:{termType:"BlankNode",value:P.value===C?"_:a":"_:z"}}getRelatedPredicate(C){return`<${C.predicate.value}>`}createHashToRelated(C,P){const M=new Map,v=this.blankNodeInfo.get(C).quads;for(const y of v)this._addRelatedBlankNodeHash({quad:y,component:y.subject,position:"s",id:C,issuer:P,hashToRelated:M}),this._addRelatedBlankNodeHash({quad:y,component:y.object,position:"o",id:C,issuer:P,hashToRelated:M}),this._addRelatedBlankNodeHash({quad:y,component:y.graph,position:"g",id:C,issuer:P,hashToRelated:M});return M}_hashAndTrackBlankNode({id:C,hashToBlankNodes:P}){const M=this.hashFirstDegreeQuads(C),v=P.get(M);v?v.push(C):P.set(M,[C])}_addBlankNodeQuadInfo({quad:C,component:P}){if("BlankNode"!==P.termType)return;const M=P.value,v=this.blankNodeInfo.get(M);v?v.quads.add(C):this.blankNodeInfo.set(M,{quads:new Set([C]),hash:null})}_addRelatedBlankNodeHash({quad:C,component:P,position:M,id:v,issuer:y,hashToRelated:S}){if("BlankNode"!==P.termType||P.value===v)return;const T=P.value,j=this.hashRelatedBlankNode(T,C,y,M),R=S.get(j);R?R.push(T):S.set(j,[T])}_useCanonicalId({component:C}){return"BlankNode"!==C.termType||C.value.startsWith(this.canonicalIssuer.prefix)?C:{termType:"BlankNode",value:this.canonicalIssuer.getId(C.value)}}}},{"./IdentifierIssuer":47,"./MessageDigest":48,"./NQuads":49,"./Permuter":50}],53:[function(K,Me,pe){"use strict";const Y=K("./URDNA2015");Me.exports=class extends Y{constructor(){super(),this.name="URGNA2012",this.hashAlgorithm="sha1"}modifyFirstDegreeComponent(k,ie,W){return"BlankNode"!==ie.termType?ie:"graph"===W?{termType:"BlankNode",value:"_:g"}:{termType:"BlankNode",value:ie.value===k?"_:a":"_:z"}}getRelatedPredicate(k){return k.predicate.value}createHashToRelated(k,ie){var W=this;return mt(function*(){const b=new Map,C=W.blankNodeInfo.get(k).quads;let P=0;for(const M of C){let v,y;if("BlankNode"===M.subject.termType&&M.subject.value!==k)y=M.subject.value,v="p";else{if("BlankNode"!==M.object.termType||M.object.value===k)continue;y=M.object.value,v="r"}++P%100==0&&(yield W._yield());const S=yield W.hashRelatedBlankNode(y,M,ie,v),T=b.get(S);T?T.push(y):b.set(S,[y])}return b})()}}},{"./URDNA2015":51}],54:[function(K,Me,pe){"use strict";const Y=K("./URDNA2015Sync");Me.exports=class extends Y{constructor(){super(),this.name="URGNA2012",this.hashAlgorithm="sha1"}modifyFirstDegreeComponent(k,ie,W){return"BlankNode"!==ie.termType?ie:"graph"===W?{termType:"BlankNode",value:"_:g"}:{termType:"BlankNode",value:ie.value===k?"_:a":"_:z"}}getRelatedPredicate(k){return k.predicate.value}createHashToRelated(k,ie){const W=new Map,b=this.blankNodeInfo.get(k).quads;for(const C of b){let P,M;if("BlankNode"===C.subject.termType&&C.subject.value!==k)M=C.subject.value,P="p";else{if("BlankNode"!==C.object.termType||C.object.value===k)continue;M=C.object.value,P="r"}const v=this.hashRelatedBlankNode(M,C,ie,P),y=W.get(v);y?y.push(M):W.set(v,[M])}return W}}},{"./URDNA2015Sync":52}],55:[function(K,Me,pe){"use strict";const Y=K("./URDNA2015"),U=K("./URGNA2012"),k=K("./URDNA2015Sync"),ie=K("./URGNA2012Sync");let W;try{W=K("rdf-canonize-native")}catch(C){}const b={};Me.exports=b,b.NQuads=K("./NQuads"),b.IdentifierIssuer=K("./IdentifierIssuer"),b._rdfCanonizeNative=function(C){return C&&(W=C),W},b.canonize=function(){var C=mt(function*(P,M){if(Array.isArray(P)||(P=b.NQuads.legacyDatasetToQuads(P)),M.useNative){if(!W)throw new Error("rdf-canonize-native not available");return new Promise((v,y)=>W.canonize(P,M,(S,T)=>S?y(S):v(T)))}if("URDNA2015"===M.algorithm)return new Y(M).main(P);if("URGNA2012"===M.algorithm)return new U(M).main(P);throw"algorithm"in M?new Error("Invalid RDF Dataset Canonicalization algorithm: "+M.algorithm):new Error("No RDF Dataset Canonicalization algorithm specified.")});return function(P,M){return C.apply(this,arguments)}}(),b._canonizeSync=function(C,P){if(Array.isArray(C)||(C=b.NQuads.legacyDatasetToQuads(C)),P.useNative){if(W)return W.canonizeSync(C,P);throw new Error("rdf-canonize-native not available")}if("URDNA2015"===P.algorithm)return new k(P).main(C);if("URGNA2012"===P.algorithm)return new ie(P).main(C);throw"algorithm"in P?new Error("Invalid RDF Dataset Canonicalization algorithm: "+P.algorithm):new Error("No RDF Dataset Canonicalization algorithm specified.")}},{"./IdentifierIssuer":47,"./NQuads":49,"./URDNA2015":51,"./URDNA2015Sync":52,"./URGNA2012":53,"./URGNA2012Sync":54,"rdf-canonize-native":3}],56:[function(K,Me,pe){"use strict";var Y=this&&this.__createBinding||(Object.create?function(k,ie,W,b){void 0===b&&(b=W),Object.defineProperty(k,b,{enumerable:!0,get:function(){return ie[W]}})}:function(k,ie,W,b){void 0===b&&(b=W),k[b]=ie[W]}),U=this&&this.__exportStar||function(k,ie){for(var W in k)"default"!==W&&!Object.prototype.hasOwnProperty.call(ie,W)&&Y(ie,k,W)};Object.defineProperty(pe,"__esModule",{value:!0}),U(K("./lib/BlankNode"),pe),U(K("./lib/DataFactory"),pe),U(K("./lib/DefaultGraph"),pe),U(K("./lib/Literal"),pe),U(K("./lib/NamedNode"),pe),U(K("./lib/Quad"),pe),U(K("./lib/Variable"),pe)},{"./lib/BlankNode":57,"./lib/DataFactory":58,"./lib/DefaultGraph":59,"./lib/Literal":60,"./lib/NamedNode":61,"./lib/Quad":62,"./lib/Variable":63}],57:[function(K,Me,pe){"use strict";Object.defineProperty(pe,"__esModule",{value:!0}),pe.BlankNode=void 0;pe.BlankNode=class{constructor(k){this.termType="BlankNode",this.value=k}equals(k){return!!k&&"BlankNode"===k.termType&&k.value===this.value}}},{}],58:[function(K,Me,pe){"use strict";Object.defineProperty(pe,"__esModule",{value:!0}),pe.DataFactory=void 0;const Y=K("./BlankNode"),U=K("./DefaultGraph"),k=K("./Literal"),ie=K("./NamedNode"),W=K("./Quad"),b=K("./Variable");let C=0;pe.DataFactory=class{constructor(v){this.blankNodeCounter=0,this.blankNodePrefix=(v=v||{}).blankNodePrefix||`df_${C++}_`}namedNode(v){return new ie.NamedNode(v)}blankNode(v){return new Y.BlankNode(v||`${this.blankNodePrefix}${this.blankNodeCounter++}`)}literal(v,y){return new k.Literal(v,y)}variable(v){return new b.Variable(v)}defaultGraph(){return U.DefaultGraph.INSTANCE}quad(v,y,S,T){return new W.Quad(v,y,S,T||this.defaultGraph())}fromTerm(v){switch(v.termType){case"NamedNode":return this.namedNode(v.value);case"BlankNode":return this.blankNode(v.value);case"Literal":return v.language?this.literal(v.value,v.language):v.datatype.equals(k.Literal.XSD_STRING)?this.literal(v.value):this.literal(v.value,this.fromTerm(v.datatype));case"Variable":return this.variable(v.value);case"DefaultGraph":return this.defaultGraph();case"Quad":return this.quad(this.fromTerm(v.subject),this.fromTerm(v.predicate),this.fromTerm(v.object),this.fromTerm(v.graph))}}fromQuad(v){return this.fromTerm(v)}resetBlankNodeCounter(){this.blankNodeCounter=0}}},{"./BlankNode":57,"./DefaultGraph":59,"./Literal":60,"./NamedNode":61,"./Quad":62,"./Variable":63}],59:[function(K,Me,pe){"use strict";Object.defineProperty(pe,"__esModule",{value:!0}),pe.DefaultGraph=void 0;class Y{constructor(){this.termType="DefaultGraph",this.value=""}equals(k){return!!k&&"DefaultGraph"===k.termType}}pe.DefaultGraph=Y,Y.INSTANCE=new Y},{}],60:[function(K,Me,pe){"use strict";Object.defineProperty(pe,"__esModule",{value:!0}),pe.Literal=void 0;const Y=K("./NamedNode");class U{constructor(ie,W){this.termType="Literal",this.value=ie,"string"==typeof W?(this.language=W,this.datatype=U.RDF_LANGUAGE_STRING):W?(this.language="",this.datatype=W):(this.language="",this.datatype=U.XSD_STRING)}equals(ie){return!!ie&&"Literal"===ie.termType&&ie.value===this.value&&ie.language===this.language&&ie.datatype.equals(this.datatype)}}pe.Literal=U,U.RDF_LANGUAGE_STRING=new Y.NamedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"),U.XSD_STRING=new Y.NamedNode("http://www.w3.org/2001/XMLSchema#string")},{"./NamedNode":61}],61:[function(K,Me,pe){"use strict";Object.defineProperty(pe,"__esModule",{value:!0}),pe.NamedNode=void 0;pe.NamedNode=class{constructor(k){this.termType="NamedNode",this.value=k}equals(k){return!!k&&"NamedNode"===k.termType&&k.value===this.value}}},{}],62:[function(K,Me,pe){"use strict";Object.defineProperty(pe,"__esModule",{value:!0}),pe.Quad=void 0;pe.Quad=class{constructor(k,ie,W,b){this.termType="Quad",this.value="",this.subject=k,this.predicate=ie,this.object=W,this.graph=b}equals(k){return!!k&&("Quad"===k.termType||!k.termType)&&this.subject.equals(k.subject)&&this.predicate.equals(k.predicate)&&this.object.equals(k.object)&&this.graph.equals(k.graph)}}},{}],63:[function(K,Me,pe){"use strict";Object.defineProperty(pe,"__esModule",{value:!0}),pe.Variable=void 0;pe.Variable=class{constructor(k){this.termType="Variable",this.value=k}equals(k){return!!k&&"Variable"===k.termType&&k.value===this.value}}},{}],64:[function(K,Me,pe){"use strict";var Y=this&&this.__createBinding||(Object.create?function(k,ie,W,b){void 0===b&&(b=W),Object.defineProperty(k,b,{enumerable:!0,get:function(){return ie[W]}})}:function(k,ie,W,b){void 0===b&&(b=W),k[b]=ie[W]}),U=this&&this.__exportStar||function(k,ie){for(var W in k)"default"!==W&&!Object.prototype.hasOwnProperty.call(ie,W)&&Y(ie,k,W)};Object.defineProperty(pe,"__esModule",{value:!0}),U(K("./lib/RdfXmlParser"),pe)},{"./lib/RdfXmlParser":66}],65:[function(K,Me,pe){"use strict";Object.defineProperty(pe,"__esModule",{value:!0}),pe.ParseError=void 0;class Y extends Error{constructor(k,ie){const W=k.saxStream._parser;super(k.trackPosition?`Line ${W.line+1} column ${W.column+1}: ${ie}`:ie)}}pe.ParseError=Y},{}],66:[function(K,Me,pe){"use strict";Object.defineProperty(pe,"__esModule",{value:!0}),pe.ParseType=pe.RdfXmlParser=void 0;const Y=K("relative-to-absolute-iri"),U=K("sax"),k=K("stream"),ie=K("./ParseError"),W=K("rdf-data-factory");class b extends k.Transform{constructor(M){super({readableObjectMode:!0}),this.activeTagStack=[],this.nodeIds={},M&&(Object.assign(this,M),this.options=M),this.dataFactory||(this.dataFactory=new W.DataFactory),this.baseIRI||(this.baseIRI=""),this.defaultGraph||(this.defaultGraph=this.dataFactory.defaultGraph()),this.saxStream=U.createStream(this.strict,{xmlns:!1,position:this.trackPosition}),this.strict||(this.saxStream._parser.looseCase="toString"),this.attachSaxListeners()}static parseNamespace(M,v){const y={};let S=!1;for(const j in M.attributes)j.startsWith("xmlns")&&(5===j.length?(S=!0,y[""]=M.attributes[j]):":"===j.charAt(5)&&(S=!0,y[j.substr(6)]=M.attributes[j]));const T=v&&v.ns?v.ns:[b.DEFAULT_NS];return S?T.concat([y]):T}static expandPrefixedTerm(M,v,y){const S=M.indexOf(":");let T,j;S>=0?(T=M.substr(0,S),j=M.substr(S+1)):(T="",j=M);let R=null,q=null;for(let ue=v.length-1;ue>=0;ue--){const D=v[ue][T];if(D){R=D;break}q||(q=v[ue][""])}if(!R){if(T&&"xmlns"!==T)throw new ie.ParseError(y,`The prefix '${T}' in term '${M}' was not bound.`);R=q||""}return{prefix:T,local:j,uri:R}}static isValidIri(M){return b.IRI_REGEX.test(M)}import(M){const v=new k.PassThrough({readableObjectMode:!0});M.on("error",S=>y.emit("error",S)),M.on("data",S=>v.push(S)),M.on("end",()=>v.push(null));const y=v.pipe(new b(this.options));return y}_transform(M,v,y){try{this.saxStream.write(M,v)}catch(S){return y(S)}y()}newParseError(M){return new ie.ParseError(this,M)}valueToUri(M,v){return this.uriToNamedNode(Y.resolve(M,v.baseIRI))}uriToNamedNode(M){if(!b.isValidIri(M))throw this.newParseError(`Invalid URI: ${M}`);return this.dataFactory.namedNode(M)}validateNcname(M){if(!b.NCNAME_MATCHER.test(M))throw this.newParseError(`Not a valid NCName: ${M}`)}attachSaxListeners(){this.saxStream.on("error",M=>this.emit("error",M)),this.saxStream.on("opentag",this.onTag.bind(this)),this.saxStream.on("text",this.onText.bind(this)),this.saxStream.on("closetag",this.onCloseTag.bind(this)),this.saxStream.on("doctype",this.onDoctype.bind(this))}onTag(M){const v=this.activeTagStack.length?this.activeTagStack[this.activeTagStack.length-1]:null;let y=C.RESOURCE;if(v&&(v.hadChildren=!0,y=v.childrenParseType),v&&v.childrenStringTags){const T=M.name;let j="";for(const D in M.attributes)j+=` ${D}="${M.attributes[D]}"`;v.childrenStringTags.push(`<${T}${j}>`);const ue={childrenStringTags:v.childrenStringTags};return ue.childrenStringEmitClosingTag=`</${T}>`,void this.activeTagStack.push(ue)}const S={};v?(S.language=v.language,S.baseIRI=v.baseIRI):S.baseIRI=this.baseIRI,this.activeTagStack.push(S),S.ns=b.parseNamespace(M,v),y===C.RESOURCE?this.onTagResource(M,S,v,!v):this.onTagProperty(M,S,v)}onTagResource(M,v,y,S){const T=b.expandPrefixedTerm(M.name,v.ns,this);v.childrenParseType=C.PROPERTY;let j=!0;if(T.uri===b.RDF){if(!S&&b.FORBIDDEN_NODE_ELEMENTS.indexOf(T.local)>=0)throw this.newParseError(`Illegal node element name: ${T.local}`);switch(T.local){case"RDF":v.childrenParseType=C.RESOURCE;case"Description":j=!1}}const R=[],q=[];let ue=null,D=!1,O=!1,X=null;for(const E in M.attributes){const G=M.attributes[E],Q=b.expandPrefixedTerm(E,v.ns,this);if(y&&Q.uri===b.RDF)switch(Q.local){case"about":if(ue)throw this.newParseError(`Only one of rdf:about, rdf:nodeID and rdf:ID can be present, while ${G} and ${ue} where found.`);ue=G;continue;case"ID":if(ue)throw this.newParseError(`Only one of rdf:about, rdf:nodeID and rdf:ID can be present, while ${G} and ${ue} where found.`);this.validateNcname(G),ue="#"+G,D=!0;continue;case"nodeID":if(ue)throw this.newParseError(`Only one of rdf:about, rdf:nodeID and rdf:ID can be present, while ${G} and ${ue} where found.`);this.validateNcname(G),ue=G,O=!0;continue;case"bagID":throw this.newParseError("rdf:bagID is not supported.");case"type":X=G;continue;case"aboutEach":throw this.newParseError("rdf:aboutEach is not supported.");case"aboutEachPrefix":throw this.newParseError("rdf:aboutEachPrefix is not supported.");case"li":throw this.newParseError("rdf:li on node elements are not supported.")}else if(Q.uri===b.XML){if("lang"===Q.local){v.language=""===G?null:G.toLowerCase();continue}if("base"===Q.local){v.baseIRI=Y.resolve(G,v.baseIRI);continue}}"xml"!==Q.prefix&&Q.uri&&(R.push(this.uriToNamedNode(Q.uri+Q.local)),q.push(G))}if(null!==ue&&(v.subject=O?this.dataFactory.blankNode(ue):this.valueToUri(ue,v),D&&this.claimNodeId(v.subject)),v.subject||(v.subject=this.dataFactory.blankNode()),j){const E=this.uriToNamedNode(T.uri+T.local);this.emitTriple(v.subject,this.dataFactory.namedNode(b.RDF+"type"),E,y?y.reifiedStatementId:null)}if(y){if(y.predicate)if(y.childrenCollectionSubject){const E=this.dataFactory.blankNode();this.emitTriple(y.childrenCollectionSubject,y.childrenCollectionPredicate,E,y.reifiedStatementId),this.emitTriple(E,this.dataFactory.namedNode(b.RDF+"first"),v.subject,v.reifiedStatementId),y.childrenCollectionSubject=E,y.childrenCollectionPredicate=this.dataFactory.namedNode(b.RDF+"rest")}else{this.emitTriple(y.subject,y.predicate,v.subject,y.reifiedStatementId);for(let E=0;E<y.predicateSubPredicates.length;E++)this.emitTriple(v.subject,y.predicateSubPredicates[E],y.predicateSubObjects[E],null);y.predicateSubPredicates=[],y.predicateSubObjects=[],y.predicateEmitted=!0}for(let E=0;E<R.length;E++){const G=this.dataFactory.literal(q[E],v.datatype||v.language);this.emitTriple(v.subject,R[E],G,y.reifiedStatementId)}X&&this.emitTriple(v.subject,this.dataFactory.namedNode(b.RDF+"type"),this.uriToNamedNode(X),null)}}onTagProperty(M,v,y){const S=b.expandPrefixedTerm(M.name,v.ns,this);if(v.childrenParseType=C.RESOURCE,v.subject=y.subject,S.uri===b.RDF&&"li"===S.local?(y.listItemCounter||(y.listItemCounter=1),v.predicate=this.uriToNamedNode(S.uri+"_"+y.listItemCounter++)):v.predicate=this.uriToNamedNode(S.uri+S.local),S.uri===b.RDF&&b.FORBIDDEN_PROPERTY_ELEMENTS.indexOf(S.local)>=0)throw this.newParseError(`Illegal property element name: ${S.local}`);v.predicateSubPredicates=[],v.predicateSubObjects=[];let T=!1,j=!1,R=null,q=!0;const ue=[],D=[];for(const O in M.attributes){const X=M.attributes[O],E=b.expandPrefixedTerm(O,v.ns,this);if(E.uri===b.RDF)switch(E.local){case"resource":if(R)throw this.newParseError(`Found both rdf:resource (${X}) and rdf:nodeID (${R}).`);if(T)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:resource (${X})`);v.hadChildren=!0,R=X,q=!1;continue;case"datatype":if(j)throw this.newParseError(`Found both non-rdf:* property attributes and rdf:datatype (${X}).`);if(T)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:datatype (${X})`);v.datatype=this.valueToUri(X,v);continue;case"nodeID":if(j)throw this.newParseError(`Found both non-rdf:* property attributes and rdf:nodeID (${X}).`);if(v.hadChildren)throw this.newParseError(`Found both rdf:resource and rdf:nodeID (${X}).`);if(T)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:nodeID (${X})`);this.validateNcname(X),v.hadChildren=!0,R=X,q=!0;continue;case"bagID":throw this.newParseError("rdf:bagID is not supported.");case"parseType":if(j)throw this.newParseError("rdf:parseType is not allowed when non-rdf:* property attributes are present");if(v.datatype)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:datatype (${v.datatype.value})`);if(R)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:nodeID or rdf:resource (${R})`);if("Resource"===X){T=!0,v.childrenParseType=C.PROPERTY;const G=this.dataFactory.blankNode();this.emitTriple(v.subject,v.predicate,G,v.reifiedStatementId),v.subject=G,v.predicate=null}else"Collection"===X?(T=!0,v.hadChildren=!0,v.childrenCollectionSubject=v.subject,v.childrenCollectionPredicate=v.predicate,q=!1):"Literal"===X&&(T=!0,v.childrenTagsToString=!0,v.childrenStringTags=[]);continue;case"ID":this.validateNcname(X),v.reifiedStatementId=this.valueToUri("#"+X,v),this.claimNodeId(v.reifiedStatementId);continue}else if(E.uri===b.XML&&"lang"===E.local){v.language=""===X?null:X.toLowerCase();continue}if("xml"!==E.prefix&&"xmlns"!==E.prefix&&E.uri){if(T||v.datatype)throw this.newParseError(`Found illegal rdf:* properties on property element with attribute: ${X}`);v.hadChildren=!0,j=!0,ue.push(this.uriToNamedNode(E.uri+E.local)),D.push(this.dataFactory.literal(X,v.datatype||v.language))}}if(null!==R){const O=v.subject;v.subject=q?this.dataFactory.blankNode(R):this.valueToUri(R,v),this.emitTriple(O,v.predicate,v.subject,v.reifiedStatementId);for(let X=0;X<ue.length;X++)this.emitTriple(v.subject,ue[X],D[X],null);v.predicateEmitted=!0}else q&&(v.predicateSubPredicates=ue,v.predicateSubObjects=D,v.predicateEmitted=!1)}emitTriple(M,v,y,S){this.push(this.dataFactory.quad(M,v,y,this.defaultGraph)),S&&(this.push(this.dataFactory.quad(S,this.dataFactory.namedNode(b.RDF+"type"),this.dataFactory.namedNode(b.RDF+"Statement"),this.defaultGraph)),this.push(this.dataFactory.quad(S,this.dataFactory.namedNode(b.RDF+"subject"),M,this.defaultGraph)),this.push(this.dataFactory.quad(S,this.dataFactory.namedNode(b.RDF+"predicate"),v,this.defaultGraph)),this.push(this.dataFactory.quad(S,this.dataFactory.namedNode(b.RDF+"object"),y,this.defaultGraph)))}claimNodeId(M){if(!this.allowDuplicateRdfIds){if(this.nodeIds[M.value])throw this.newParseError(`Found multiple occurrences of rdf:ID='${M.value}'.`);this.nodeIds[M.value]=!0}}onText(M){const v=this.activeTagStack.length?this.activeTagStack[this.activeTagStack.length-1]:null;v&&(v.childrenStringTags?v.childrenStringTags.push(M):v.predicate&&(v.text=M))}onCloseTag(){const M=this.activeTagStack.pop();if(M.childrenStringEmitClosingTag&&M.childrenStringTags.push(M.childrenStringEmitClosingTag),M.childrenTagsToString&&(M.datatype=this.dataFactory.namedNode(b.RDF+"XMLLiteral"),M.text=M.childrenStringTags.join(""),M.hadChildren=!1),M.childrenCollectionSubject)this.emitTriple(M.childrenCollectionSubject,M.childrenCollectionPredicate,this.dataFactory.namedNode(b.RDF+"nil"),M.reifiedStatementId);else if(M.predicate)if(M.hadChildren||M.childrenParseType===C.PROPERTY){if(!M.predicateEmitted){const v=this.dataFactory.blankNode();this.emitTriple(M.subject,M.predicate,v,M.reifiedStatementId);for(let y=0;y<M.predicateSubPredicates.length;y++)this.emitTriple(v,M.predicateSubPredicates[y],M.predicateSubObjects[y],null)}}else this.emitTriple(M.subject,M.predicate,this.dataFactory.literal(M.text||"",M.datatype||M.language),M.reifiedStatementId)}onDoctype(M){M.replace(/<!ENTITY\s+([^\s]+)\s+["']([^"']+)["']\s*>/g,(v,y,S)=>(this.saxStream._parser.ENTITIES[y]=S,""))}}var C,P;pe.RdfXmlParser=b,b.IRI_REGEX=/^([A-Za-z][A-Za-z0-9+-.]*):[^ "<>{}|\\\[\]`]*$/,b.MIME_TYPE="application/rdf+xml",b.RDF="http://www.w3.org/1999/02/22-rdf-syntax-ns#",b.XML="http://www.w3.org/XML/1998/namespace",b.XMLNS="http://www.w3.org/2000/xmlns/",b.DEFAULT_NS={xml:b.XML},b.FORBIDDEN_NODE_ELEMENTS=["RDF","ID","about","bagID","parseType","resource","nodeID","li","aboutEach","aboutEachPrefix"],b.FORBIDDEN_PROPERTY_ELEMENTS=["Description","RDF","ID","about","bagID","parseType","resource","nodeID","aboutEach","aboutEachPrefix"],b.NCNAME_MATCHER=/^([A-Za-z\xC0-\xD6\xD8-\xF6\u{F8}-\u{2FF}\u{370}-\u{37D}\u{37F}-\u{1FFF}\u{200C}-\u{200D}\u{2070}-\u{218F}\u{2C00}-\u{2FEF}\u{3001}-\u{D7FF}\u{F900}-\u{FDCF}\u{FDF0}-\u{FFFD}\u{10000}-\u{EFFFF}_])([A-Za-z\xC0-\xD6\xD8-\xF6\u{F8}-\u{2FF}\u{370}-\u{37D}\u{37F}-\u{1FFF}\u{200C}-\u{200D}\u{2070}-\u{218F}\u{2C00}-\u{2FEF}\u{3001}-\u{D7FF}\u{F900}-\u{FDCF}\u{FDF0}-\u{FFFD}\u{10000}-\u{EFFFF}_\-.0-9#xB7\u{0300}-\u{036F}\u{203F}-\u{2040}])*$/u,(P=C=pe.ParseType||(pe.ParseType={}))[P.RESOURCE=0]="RESOURCE",P[P.PROPERTY=1]="PROPERTY"},{"./ParseError":65,"rdf-data-factory":56,"relative-to-absolute-iri":82,sax:85,stream:87}],67:[function(K,Me,pe){"use strict";var U={};function k(P,M,v){v||(v=Error);var S=function(T){function j(R,q,ue){return T.call(this,function(T,j,R){return"string"==typeof M?M:M(T,j,R)}(R,q,ue))||this}return function(P,M){P.prototype=Object.create(M.prototype),P.prototype.constructor=P,P.__proto__=M}(j,T),j}(v);S.prototype.name=v.name,S.prototype.code=P,U[P]=S}function ie(P,M){if(Array.isArray(P)){var v=P.length;return P=P.map(function(y){return String(y)}),v>2?"one of ".concat(M," ").concat(P.slice(0,v-1).join(", "),", or ")+P[v-1]:2===v?"one of ".concat(M," ").concat(P[0]," or ").concat(P[1]):"of ".concat(M," ").concat(P[0])}return"of ".concat(M," ").concat(String(P))}k("ERR_INVALID_OPT_VALUE",function(P,M){return'The value "'+M+'" is invalid for option "'+P+'"'},TypeError),k("ERR_INVALID_ARG_TYPE",function(P,M,v){var y,S;if("string"==typeof M&&function(P,M,v){return P.substr(!v||v<0?0:+v,M.length)===M}(M,"not ")?(y="must not be",M=M.replace(/^not /,"")):y="must be",function(P,M,v){return(void 0===v||v>P.length)&&(v=P.length),P.substring(v-M.length,v)===M}(P," argument"))S="The ".concat(P," ").concat(y," ").concat(ie(M,"type"));else{var T=function(P,M,v){return"number"!=typeof v&&(v=0),!(v+M.length>P.length)&&-1!==P.indexOf(M,v)}(P,".")?"property":"argument";S='The "'.concat(P,'" ').concat(T," ").concat(y," ").concat(ie(M,"type"))}return S+". Received type ".concat(typeof v)},TypeError),k("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),k("ERR_METHOD_NOT_IMPLEMENTED",function(P){return"The "+P+" method is not implemented"}),k("ERR_STREAM_PREMATURE_CLOSE","Premature close"),k("ERR_STREAM_DESTROYED",function(P){return"Cannot call "+P+" after a stream was destroyed"}),k("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),k("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),k("ERR_STREAM_WRITE_AFTER_END","write after end"),k("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),k("ERR_UNKNOWN_ENCODING",function(P){return"Unknown encoding: "+P},TypeError),k("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),Me.exports.codes=U},{}],68:[function(K,Me,pe){(function(Y){(function(){"use strict";var U=Object.keys||function(y){var S=[];for(var T in y)S.push(T);return S};Me.exports=P;var k=K("./_stream_readable"),ie=K("./_stream_writable");K("inherits")(P,k);for(var W=U(ie.prototype),b=0;b<W.length;b++){var C=W[b];P.prototype[C]||(P.prototype[C]=ie.prototype[C])}function P(y){if(!(this instanceof P))return new P(y);k.call(this,y),ie.call(this,y),this.allowHalfOpen=!0,y&&(!1===y.readable&&(this.readable=!1),!1===y.writable&&(this.writable=!1),!1===y.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",M)))}function M(){this._writableState.ended||Y.nextTick(v,this)}function v(y){y.end()}Object.defineProperty(P.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(P.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(P.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(P.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(S){void 0===this._readableState||void 0===this._writableState||(this._readableState.destroyed=S,this._writableState.destroyed=S)}})}).call(this)}).call(this,K("_process"))},{"./_stream_readable":70,"./_stream_writable":72,_process:44,inherits:10}],69:[function(K,Me,pe){"use strict";Me.exports=U;var Y=K("./_stream_transform");function U(k){if(!(this instanceof U))return new U(k);Y.call(this,k)}K("inherits")(U,Y),U.prototype._transform=function(k,ie,W){W(null,k)}},{"./_stream_transform":71,inherits:10}],70:[function(K,Me,pe){(function(Y,U){(function(){"use strict";var k;Me.exports=te,te.ReadableState=me,K("events");var W=function(B,N){return B.listeners(N).length},b=K("./internal/streams/stream"),C=K("buffer").Buffer,P=U.Uint8Array||function(){};var S,y=K("util");S=y&&y.debuglog?y.debuglog("stream"):function(){};var G,Q,ae,T=K("./internal/streams/buffer_list"),j=K("./internal/streams/destroy"),q=K("./internal/streams/state").getHighWaterMark,ue=K("../errors").codes,D=ue.ERR_INVALID_ARG_TYPE,O=ue.ERR_STREAM_PUSH_AFTER_EOF,X=ue.ERR_METHOD_NOT_IMPLEMENTED,E=ue.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;K("inherits")(te,b);var se=j.errorOrDestroy,ee=["error","close","destroy","pause","resume"];function me(be,B,N){k=k||K("./_stream_duplex"),"boolean"!=typeof N&&(N=B instanceof k),this.objectMode=!!(be=be||{}).objectMode,N&&(this.objectMode=this.objectMode||!!be.readableObjectMode),this.highWaterMark=q(this,be,"readableHighWaterMark",N),this.buffer=new T,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==be.emitClose,this.autoDestroy=!!be.autoDestroy,this.destroyed=!1,this.defaultEncoding=be.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,be.encoding&&(G||(G=K("string_decoder/").StringDecoder),this.decoder=new G(be.encoding),this.encoding=be.encoding)}function te(be){if(k=k||K("./_stream_duplex"),!(this instanceof te))return new te(be);this._readableState=new me(be,this,this instanceof k),this.readable=!0,be&&("function"==typeof be.read&&(this._read=be.read),"function"==typeof be.destroy&&(this._destroy=be.destroy)),b.call(this)}function _e(be,B,N,V,Re){S("readableAddChunk",B);var bt,Ze=be._readableState;if(null===B)Ze.reading=!1,function(be,B){if(S("onEofChunk"),!B.ended){if(B.decoder){var N=B.decoder.end();N&&N.length&&(B.buffer.push(N),B.length+=B.objectMode?1:N.length)}B.ended=!0,B.sync?Ue(be):(B.needReadable=!1,B.emittedReadable||(B.emittedReadable=!0,Le(be)))}}(be,Ze);else if(Re||(bt=function(be,B){var N;return!function(be){return C.isBuffer(be)||be instanceof P}(B)&&"string"!=typeof B&&void 0!==B&&!be.objectMode&&(N=new D("chunk",["string","Buffer","Uint8Array"],B)),N}(Ze,B)),bt)se(be,bt);else if(Ze.objectMode||B&&B.length>0)if("string"!=typeof B&&!Ze.objectMode&&Object.getPrototypeOf(B)!==C.prototype&&(B=function(be){return C.from(be)}(B)),V)Ze.endEmitted?se(be,new E):Oe(be,Ze,B,!0);else if(Ze.ended)se(be,new O);else{if(Ze.destroyed)return!1;Ze.reading=!1,Ze.decoder&&!N?(B=Ze.decoder.write(B),Ze.objectMode||0!==B.length?Oe(be,Ze,B,!1):Xe(be,Ze)):Oe(be,Ze,B,!1)}else V||(Ze.reading=!1,Xe(be,Ze));return!Ze.ended&&(Ze.length<Ze.highWaterMark||0===Ze.length)}function Oe(be,B,N,V){B.flowing&&0===B.length&&!B.sync?(B.awaitDrain=0,be.emit("data",N)):(B.length+=B.objectMode?1:N.length,V?B.buffer.unshift(N):B.buffer.push(N),B.needReadable&&Ue(be)),Xe(be,B)}Object.defineProperty(te.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(B){!this._readableState||(this._readableState.destroyed=B)}}),te.prototype.destroy=j.destroy,te.prototype._undestroy=j.undestroy,te.prototype._destroy=function(be,B){B(be)},te.prototype.push=function(be,B){var V,N=this._readableState;return N.objectMode?V=!0:"string"==typeof be&&((B=B||N.defaultEncoding)!==N.encoding&&(be=C.from(be,B),B=""),V=!0),_e(this,be,B,!1,V)},te.prototype.unshift=function(be){return _e(this,be,null,!0,!1)},te.prototype.isPaused=function(){return!1===this._readableState.flowing},te.prototype.setEncoding=function(be){G||(G=K("string_decoder/").StringDecoder);var B=new G(be);this._readableState.decoder=B,this._readableState.encoding=this._readableState.decoder.encoding;for(var N=this._readableState.buffer.head,V="";null!==N;)V+=B.write(N.data),N=N.next;return this._readableState.buffer.clear(),""!==V&&this._readableState.buffer.push(V),this._readableState.length=V.length,this};var st=1073741824;function et(be,B){return be<=0||0===B.length&&B.ended?0:B.objectMode?1:be!=be?B.flowing&&B.length?B.buffer.head.data.length:B.length:(be>B.highWaterMark&&(B.highWaterMark=function(be){return be>=st?be=st:(be--,be|=be>>>1,be|=be>>>2,be|=be>>>4,be|=be>>>8,be|=be>>>16,be++),be}(be)),be<=B.length?be:B.ended?B.length:(B.needReadable=!0,0))}function Ue(be){var B=be._readableState;S("emitReadable",B.needReadable,B.emittedReadable),B.needReadable=!1,B.emittedReadable||(S("emitReadable",B.flowing),B.emittedReadable=!0,Y.nextTick(Le,be))}function Le(be){var B=be._readableState;S("emitReadable_",B.destroyed,B.length,B.ended),!B.destroyed&&(B.length||B.ended)&&(be.emit("readable"),B.emittedReadable=!1),B.needReadable=!B.flowing&&!B.ended&&B.length<=B.highWaterMark,fe(be)}function Xe(be,B){B.readingMore||(B.readingMore=!0,Y.nextTick(Te,be,B))}function Te(be,B){for(;!B.reading&&!B.ended&&(B.length<B.highWaterMark||B.flowing&&0===B.length);){var N=B.length;if(S("maybeReadMore read 0"),be.read(0),N===B.length)break}B.readingMore=!1}function qe(be){var B=be._readableState;B.readableListening=be.listenerCount("readable")>0,B.resumeScheduled&&!B.paused?B.flowing=!0:be.listenerCount("data")>0&&be.resume()}function Ne(be){S("readable nexttick read 0"),be.read(0)}function z(be,B){S("resume",B.reading),B.reading||be.read(0),B.resumeScheduled=!1,be.emit("resume"),fe(be),B.flowing&&!B.reading&&be.read(0)}function fe(be){var B=be._readableState;for(S("flow",B.flowing);B.flowing&&null!==be.read(););}function de(be,B){return 0===B.length?null:(B.objectMode?N=B.buffer.shift():!be||be>=B.length?(N=B.decoder?B.buffer.join(""):1===B.buffer.length?B.buffer.first():B.buffer.concat(B.length),B.buffer.clear()):N=B.buffer.consume(be,B.decoder),N);var N}function Ve(be){var B=be._readableState;S("endReadable",B.endEmitted),B.endEmitted||(B.ended=!0,Y.nextTick(gt,B,be))}function gt(be,B){if(S("endReadableNT",be.endEmitted,be.length),!be.endEmitted&&0===be.length&&(be.endEmitted=!0,B.readable=!1,B.emit("end"),be.autoDestroy)){var N=B._writableState;(!N||N.autoDestroy&&N.finished)&&B.destroy()}}function ft(be,B){for(var N=0,V=be.length;N<V;N++)if(be[N]===B)return N;return-1}te.prototype.read=function(be){S("read",be),be=parseInt(be,10);var B=this._readableState,N=be;if(0!==be&&(B.emittedReadable=!1),0===be&&B.needReadable&&((0!==B.highWaterMark?B.length>=B.highWaterMark:B.length>0)||B.ended))return S("read: emitReadable",B.length,B.ended),0===B.length&&B.ended?Ve(this):Ue(this),null;if(0===(be=et(be,B))&&B.ended)return 0===B.length&&Ve(this),null;var Re,V=B.needReadable;return S("need readable",V),(0===B.length||B.length-be<B.highWaterMark)&&S("length less than watermark",V=!0),B.ended||B.reading?S("reading or ended",V=!1):V&&(S("do read"),B.reading=!0,B.sync=!0,0===B.length&&(B.needReadable=!0),this._read(B.highWaterMark),B.sync=!1,B.reading||(be=et(N,B))),null===(Re=be>0?de(be,B):null)?(B.needReadable=B.length<=B.highWaterMark,be=0):(B.length-=be,B.awaitDrain=0),0===B.length&&(B.ended||(B.needReadable=!0),N!==be&&B.ended&&Ve(this)),null!==Re&&this.emit("data",Re),Re},te.prototype._read=function(be){se(this,new X("_read()"))},te.prototype.pipe=function(be,B){var N=this,V=this._readableState;switch(V.pipesCount){case 0:V.pipes=be;break;case 1:V.pipes=[V.pipes,be];break;default:V.pipes.push(be)}V.pipesCount+=1,S("pipe count=%d opts=%j",V.pipesCount,B);var Ze=B&&!1===B.end||be===Y.stdout||be===Y.stderr?fs:Rt;function bt(ks,qr){S("onunpipe"),ks===N&&qr&&!1===qr.hasUnpiped&&(qr.hasUnpiped=!0,S("cleanup"),be.removeListener("close",Wr),be.removeListener("finish",Ls),be.removeListener("drain",Mn),be.removeListener("error",pi),be.removeListener("unpipe",bt),N.removeListener("end",Rt),N.removeListener("end",fs),N.removeListener("data",wi),Nn=!0,V.awaitDrain&&(!be._writableState||be._writableState.needDrain)&&Mn())}function Rt(){S("onend"),be.end()}V.endEmitted?Y.nextTick(Ze):N.once("end",Ze),be.on("unpipe",bt);var Mn=function(be){return function(){var N=be._readableState;S("pipeOnDrain",N.awaitDrain),N.awaitDrain&&N.awaitDrain--,0===N.awaitDrain&&W(be,"data")&&(N.flowing=!0,fe(be))}}(N);be.on("drain",Mn);var Nn=!1;function wi(ks){S("ondata");var qr=be.write(ks);S("dest.write",qr),!1===qr&&((1===V.pipesCount&&V.pipes===be||V.pipesCount>1&&-1!==ft(V.pipes,be))&&!Nn&&(S("false write response, pause",V.awaitDrain),V.awaitDrain++),N.pause())}function pi(ks){S("onerror",ks),fs(),be.removeListener("error",pi),0===W(be,"error")&&se(be,ks)}function Wr(){be.removeListener("finish",Ls),fs()}function Ls(){S("onfinish"),be.removeListener("close",Wr),fs()}function fs(){S("unpipe"),N.unpipe(be)}return N.on("data",wi),function(be,B,N){if("function"==typeof be.prependListener)return be.prependListener(B,N);be._events&&be._events[B]?Array.isArray(be._events[B])?be._events[B].unshift(N):be._events[B]=[N,be._events[B]]:be.on(B,N)}(be,"error",pi),be.once("close",Wr),be.once("finish",Ls),be.emit("pipe",N),V.flowing||(S("pipe resume"),N.resume()),be},te.prototype.unpipe=function(be){var B=this._readableState,N={hasUnpiped:!1};if(0===B.pipesCount)return this;if(1===B.pipesCount)return be&&be!==B.pipes||(be||(be=B.pipes),B.pipes=null,B.pipesCount=0,B.flowing=!1,be&&be.emit("unpipe",this,N)),this;if(!be){var V=B.pipes,Re=B.pipesCount;B.pipes=null,B.pipesCount=0,B.flowing=!1;for(var Ze=0;Ze<Re;Ze++)V[Ze].emit("unpipe",this,{hasUnpiped:!1});return this}var bt=ft(B.pipes,be);return-1===bt||(B.pipes.splice(bt,1),B.pipesCount-=1,1===B.pipesCount&&(B.pipes=B.pipes[0]),be.emit("unpipe",this,N)),this},te.prototype.addListener=te.prototype.on=function(be,B){var N=b.prototype.on.call(this,be,B),V=this._readableState;return"data"===be?(V.readableListening=this.listenerCount("readable")>0,!1!==V.flowing&&this.resume()):"readable"===be&&!V.endEmitted&&!V.readableListening&&(V.readableListening=V.needReadable=!0,V.flowing=!1,V.emittedReadable=!1,S("on readable",V.length,V.reading),V.length?Ue(this):V.reading||Y.nextTick(Ne,this)),N},te.prototype.removeListener=function(be,B){var N=b.prototype.removeListener.call(this,be,B);return"readable"===be&&Y.nextTick(qe,this),N},te.prototype.removeAllListeners=function(be){var B=b.prototype.removeAllListeners.apply(this,arguments);return("readable"===be||void 0===be)&&Y.nextTick(qe,this),B},te.prototype.resume=function(){var be=this._readableState;return be.flowing||(S("resume"),be.flowing=!be.readableListening,function(be,B){B.resumeScheduled||(B.resumeScheduled=!0,Y.nextTick(z,be,B))}(this,be)),be.paused=!1,this},te.prototype.pause=function(){return S("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(S("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},te.prototype.wrap=function(be){var B=this,N=this._readableState,V=!1;for(var Re in be.on("end",function(){if(S("wrapped end"),N.decoder&&!N.ended){var bt=N.decoder.end();bt&&bt.length&&B.push(bt)}B.push(null)}),be.on("data",function(bt){S("wrapped data"),N.decoder&&(bt=N.decoder.write(bt)),N.objectMode&&null==bt||!(N.objectMode||bt&&bt.length)||B.push(bt)||(V=!0,be.pause())}),be)void 0===this[Re]&&"function"==typeof be[Re]&&(this[Re]=function(Rt){return function(){return be[Rt].apply(be,arguments)}}(Re));for(var Ze=0;Ze<ee.length;Ze++)be.on(ee[Ze],this.emit.bind(this,ee[Ze]));return this._read=function(bt){S("wrapped _read",bt),V&&(V=!1,be.resume())},this},"function"==typeof Symbol&&(te.prototype[Symbol.asyncIterator]=function(){return void 0===Q&&(Q=K("./internal/streams/async_iterator")),Q(this)}),Object.defineProperty(te.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(te.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(te.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(B){this._readableState&&(this._readableState.flowing=B)}}),te._fromList=de,Object.defineProperty(te.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(te.from=function(be,B){return void 0===ae&&(ae=K("./internal/streams/from")),ae(te,be,B)})}).call(this)}).call(this,K("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../errors":67,"./_stream_duplex":68,"./internal/streams/async_iterator":73,"./internal/streams/buffer_list":74,"./internal/streams/destroy":75,"./internal/streams/from":77,"./internal/streams/state":79,"./internal/streams/stream":80,_process:44,buffer:6,events:8,inherits:10,"string_decoder/":88,util:3}],71:[function(K,Me,pe){"use strict";Me.exports=P;var Y=K("../errors").codes,U=Y.ERR_METHOD_NOT_IMPLEMENTED,k=Y.ERR_MULTIPLE_CALLBACK,ie=Y.ERR_TRANSFORM_ALREADY_TRANSFORMING,W=Y.ERR_TRANSFORM_WITH_LENGTH_0,b=K("./_stream_duplex");function C(y,S){var T=this._transformState;T.transforming=!1;var j=T.writecb;if(null===j)return this.emit("error",new k);T.writechunk=null,T.writecb=null,null!=S&&this.push(S),j(y);var R=this._readableState;R.reading=!1,(R.needReadable||R.length<R.highWaterMark)&&this._read(R.highWaterMark)}function P(y){if(!(this instanceof P))return new P(y);b.call(this,y),this._transformState={afterTransform:C.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,y&&("function"==typeof y.transform&&(this._transform=y.transform),"function"==typeof y.flush&&(this._flush=y.flush)),this.on("prefinish",M)}function M(){var y=this;"function"!=typeof this._flush||this._readableState.destroyed?v(this,null,null):this._flush(function(S,T){v(y,S,T)})}function v(y,S,T){if(S)return y.emit("error",S);if(null!=T&&y.push(T),y._writableState.length)throw new W;if(y._transformState.transforming)throw new ie;return y.push(null)}K("inherits")(P,b),P.prototype.push=function(y,S){return this._transformState.needTransform=!1,b.prototype.push.call(this,y,S)},P.prototype._transform=function(y,S,T){T(new U("_transform()"))},P.prototype._write=function(y,S,T){var j=this._transformState;if(j.writecb=T,j.writechunk=y,j.writeencoding=S,!j.transforming){var R=this._readableState;(j.needTransform||R.needReadable||R.length<R.highWaterMark)&&this._read(R.highWaterMark)}},P.prototype._read=function(y){var S=this._transformState;null===S.writechunk||S.transforming?S.needTransform=!0:(S.transforming=!0,this._transform(S.writechunk,S.writeencoding,S.afterTransform))},P.prototype._destroy=function(y,S){b.prototype._destroy.call(this,y,function(T){S(T)})}},{"../errors":67,"./_stream_duplex":68,inherits:10}],72:[function(K,Me,pe){(function(Y,U){(function(){"use strict";function ie(fe){var de=this;this.next=null,this.entry=null,this.finish=function(){!function(fe,de,Ve){var gt=fe.entry;for(fe.entry=null;gt;){var ft=gt.callback;de.pendingcb--,ft(Ve),gt=gt.next}de.corkedRequestsFree.next=fe}(de,fe)}}var W;Me.exports=me,me.WritableState=ee;var b={deprecate:K("util-deprecate")},C=K("./internal/streams/stream"),P=K("buffer").Buffer,M=U.Uint8Array||function(){};var xe,S=K("./internal/streams/destroy"),j=K("./internal/streams/state").getHighWaterMark,R=K("../errors").codes,q=R.ERR_INVALID_ARG_TYPE,ue=R.ERR_METHOD_NOT_IMPLEMENTED,D=R.ERR_MULTIPLE_CALLBACK,O=R.ERR_STREAM_CANNOT_PIPE,X=R.ERR_STREAM_DESTROYED,E=R.ERR_STREAM_NULL_VALUES,G=R.ERR_STREAM_WRITE_AFTER_END,Q=R.ERR_UNKNOWN_ENCODING,ae=S.errorOrDestroy;function se(){}function ee(fe,de,Ve){W=W||K("./_stream_duplex"),"boolean"!=typeof Ve&&(Ve=de instanceof W),this.objectMode=!!(fe=fe||{}).objectMode,Ve&&(this.objectMode=this.objectMode||!!fe.writableObjectMode),this.highWaterMark=j(this,fe,"writableHighWaterMark",Ve),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1,this.decodeStrings=!(!1===fe.decodeStrings),this.defaultEncoding=fe.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(ft){!function(fe,de){var Ve=fe._writableState,gt=Ve.sync,ft=Ve.writecb;if("function"!=typeof ft)throw new D;if(function(fe){fe.writing=!1,fe.writecb=null,fe.length-=fe.writelen,fe.writelen=0}(Ve),de)!function(fe,de,Ve,gt,ft){--de.pendingcb,Ve?(Y.nextTick(ft,gt),Y.nextTick(Ne,fe,de),fe._writableState.errorEmitted=!0,ae(fe,gt)):(ft(gt),fe._writableState.errorEmitted=!0,ae(fe,gt),Ne(fe,de))}(fe,Ve,gt,de,ft);else{var be=Te(Ve)||fe.destroyed;!be&&!Ve.corked&&!Ve.bufferProcessing&&Ve.bufferedRequest&&Xe(fe,Ve),gt?Y.nextTick(Ue,fe,Ve,be,ft):Ue(fe,Ve,be,ft)}}(de,ft)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==fe.emitClose,this.autoDestroy=!!fe.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new ie(this)}function me(fe){var de=this instanceof(W=W||K("./_stream_duplex"));if(!de&&!xe.call(me,this))return new me(fe);this._writableState=new ee(fe,this,de),this.writable=!0,fe&&("function"==typeof fe.write&&(this._write=fe.write),"function"==typeof fe.writev&&(this._writev=fe.writev),"function"==typeof fe.destroy&&(this._destroy=fe.destroy),"function"==typeof fe.final&&(this._final=fe.final)),C.call(this)}function $e(fe,de,Ve,gt,ft,be){if(!Ve){var B=function(fe,de,Ve){return!fe.objectMode&&!1!==fe.decodeStrings&&"string"==typeof de&&(de=P.from(de,Ve)),de}(de,gt,ft);gt!==B&&(Ve=!0,ft="buffer",gt=B)}var N=de.objectMode?1:gt.length;de.length+=N;var V=de.length<de.highWaterMark;if(V||(de.needDrain=!0),de.writing||de.corked){var Re=de.lastBufferedRequest;de.lastBufferedRequest={chunk:gt,encoding:ft,isBuf:Ve,callback:be,next:null},Re?Re.next=de.lastBufferedRequest:de.bufferedRequest=de.lastBufferedRequest,de.bufferedRequestCount+=1}else st(fe,de,!1,N,gt,ft,be);return V}function st(fe,de,Ve,gt,ft,be,B){de.writelen=gt,de.writecb=B,de.writing=!0,de.sync=!0,de.destroyed?de.onwrite(new X("write")):Ve?fe._writev(ft,de.onwrite):fe._write(ft,be,de.onwrite),de.sync=!1}function Ue(fe,de,Ve,gt){Ve||function(fe,de){0===de.length&&de.needDrain&&(de.needDrain=!1,fe.emit("drain"))}(fe,de),de.pendingcb--,gt(),Ne(fe,de)}function Xe(fe,de){de.bufferProcessing=!0;var Ve=de.bufferedRequest;if(fe._writev&&Ve&&Ve.next){var ft=new Array(de.bufferedRequestCount),be=de.corkedRequestsFree;be.entry=Ve;for(var B=0,N=!0;Ve;)ft[B]=Ve,Ve.isBuf||(N=!1),Ve=Ve.next,B+=1;ft.allBuffers=N,st(fe,de,!0,de.length,ft,"",be.finish),de.pendingcb++,de.lastBufferedRequest=null,be.next?(de.corkedRequestsFree=be.next,be.next=null):de.corkedRequestsFree=new ie(de),de.bufferedRequestCount=0}else{for(;Ve;){var V=Ve.chunk;if(st(fe,de,!1,de.objectMode?1:V.length,V,Ve.encoding,Ve.callback),Ve=Ve.next,de.bufferedRequestCount--,de.writing)break}null===Ve&&(de.lastBufferedRequest=null)}de.bufferedRequest=Ve,de.bufferProcessing=!1}function Te(fe){return fe.ending&&0===fe.length&&null===fe.bufferedRequest&&!fe.finished&&!fe.writing}function je(fe,de){fe._final(function(Ve){de.pendingcb--,Ve&&ae(fe,Ve),de.prefinished=!0,fe.emit("prefinish"),Ne(fe,de)})}function Ne(fe,de){var Ve=Te(de);if(Ve&&(function(fe,de){!de.prefinished&&!de.finalCalled&&("function"!=typeof fe._final||de.destroyed?(de.prefinished=!0,fe.emit("prefinish")):(de.pendingcb++,de.finalCalled=!0,Y.nextTick(je,fe,de)))}(fe,de),0===de.pendingcb&&(de.finished=!0,fe.emit("finish"),de.autoDestroy))){var gt=fe._readableState;(!gt||gt.autoDestroy&&gt.endEmitted)&&fe.destroy()}return Ve}K("inherits")(me,C),ee.prototype.getBuffer=function(){for(var de=this.bufferedRequest,Ve=[];de;)Ve.push(de),de=de.next;return Ve},function(){try{Object.defineProperty(ee.prototype,"buffer",{get:b.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(fe){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(xe=Function.prototype[Symbol.hasInstance],Object.defineProperty(me,Symbol.hasInstance,{value:function(de){return!!xe.call(this,de)||this===me&&de&&de._writableState instanceof ee}})):xe=function(de){return de instanceof this},me.prototype.pipe=function(){ae(this,new O)},me.prototype.write=function(fe,de,Ve){var gt=this._writableState,ft=!1,be=!gt.objectMode&&function(fe){return P.isBuffer(fe)||fe instanceof M}(fe);return be&&!P.isBuffer(fe)&&(fe=function(fe){return P.from(fe)}(fe)),"function"==typeof de&&(Ve=de,de=null),be?de="buffer":de||(de=gt.defaultEncoding),"function"!=typeof Ve&&(Ve=se),gt.ending?function(fe,de){var Ve=new G;ae(fe,Ve),Y.nextTick(de,Ve)}(this,Ve):(be||function(fe,de,Ve,gt){var ft;return null===Ve?ft=new E:"string"!=typeof Ve&&!de.objectMode&&(ft=new q("chunk",["string","Buffer"],Ve)),!ft||(ae(fe,ft),Y.nextTick(gt,ft),!1)}(this,gt,fe,Ve))&&(gt.pendingcb++,ft=$e(this,gt,be,fe,de,Ve)),ft},me.prototype.cork=function(){this._writableState.corked++},me.prototype.uncork=function(){var fe=this._writableState;fe.corked&&(fe.corked--,!fe.writing&&!fe.corked&&!fe.bufferProcessing&&fe.bufferedRequest&&Xe(this,fe))},me.prototype.setDefaultEncoding=function(de){if("string"==typeof de&&(de=de.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((de+"").toLowerCase())>-1))throw new Q(de);return this._writableState.defaultEncoding=de,this},Object.defineProperty(me.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(me.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),me.prototype._write=function(fe,de,Ve){Ve(new ue("_write()"))},me.prototype._writev=null,me.prototype.end=function(fe,de,Ve){var gt=this._writableState;return"function"==typeof fe?(Ve=fe,fe=null,de=null):"function"==typeof de&&(Ve=de,de=null),null!=fe&&this.write(fe,de),gt.corked&&(gt.corked=1,this.uncork()),gt.ending||function(fe,de,Ve){de.ending=!0,Ne(fe,de),Ve&&(de.finished?Y.nextTick(Ve):fe.once("finish",Ve)),de.ended=!0,fe.writable=!1}(this,gt,Ve),this},Object.defineProperty(me.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(me.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(de){!this._writableState||(this._writableState.destroyed=de)}}),me.prototype.destroy=S.destroy,me.prototype._undestroy=S.undestroy,me.prototype._destroy=function(fe,de){de(fe)}}).call(this)}).call(this,K("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../errors":67,"./_stream_duplex":68,"./internal/streams/destroy":75,"./internal/streams/state":79,"./internal/streams/stream":80,_process:44,buffer:6,inherits:10,"util-deprecate":90}],73:[function(K,Me,pe){(function(Y){(function(){"use strict";var U;function k(O,X,E){return X in O?Object.defineProperty(O,X,{value:E,enumerable:!0,configurable:!0,writable:!0}):O[X]=E,O}var ie=K("./end-of-stream"),W=Symbol("lastResolve"),b=Symbol("lastReject"),C=Symbol("error"),P=Symbol("ended"),M=Symbol("lastPromise"),v=Symbol("handlePromise"),y=Symbol("stream");function S(O,X){return{value:O,done:X}}function T(O){var X=O[W];if(null!==X){var E=O[y].read();null!==E&&(O[M]=null,O[W]=null,O[b]=null,X(S(E,!1)))}}function j(O){Y.nextTick(T,O)}var q=Object.getPrototypeOf(function(){}),ue=Object.setPrototypeOf((k(U={get stream(){return this[y]},next:function(){var X=this,E=this[C];if(null!==E)return Promise.reject(E);if(this[P])return Promise.resolve(S(void 0,!0));if(this[y].destroyed)return new Promise(function(se,ee){Y.nextTick(function(){X[C]?ee(X[C]):se(S(void 0,!0))})});var Q,G=this[M];if(G)Q=new Promise(function(O,X){return function(E,G){O.then(function(){X[P]?E(S(void 0,!0)):X[v](E,G)},G)}}(G,this));else{var ae=this[y].read();if(null!==ae)return Promise.resolve(S(ae,!1));Q=new Promise(this[v])}return this[M]=Q,Q}},Symbol.asyncIterator,function(){return this}),k(U,"return",function(){var X=this;return new Promise(function(E,G){X[y].destroy(null,function(Q){Q?G(Q):E(S(void 0,!0))})})}),U),q);Me.exports=function(X){var E,G=Object.create(ue,(k(E={},y,{value:X,writable:!0}),k(E,W,{value:null,writable:!0}),k(E,b,{value:null,writable:!0}),k(E,C,{value:null,writable:!0}),k(E,P,{value:X._readableState.endEmitted,writable:!0}),k(E,v,{value:function(ae,se){var ee=G[y].read();ee?(G[M]=null,G[W]=null,G[b]=null,ae(S(ee,!1))):(G[W]=ae,G[b]=se)},writable:!0}),E));return G[M]=null,ie(X,function(Q){if(Q&&"ERR_STREAM_PREMATURE_CLOSE"!==Q.code){var ae=G[b];return null!==ae&&(G[M]=null,G[W]=null,G[b]=null,ae(Q)),void(G[C]=Q)}var se=G[W];null!==se&&(G[M]=null,G[W]=null,G[b]=null,se(S(void 0,!0))),G[P]=!0}),X.on("readable",j.bind(null,G)),G}}).call(this)}).call(this,K("_process"))},{"./end-of-stream":76,_process:44}],74:[function(K,Me,pe){"use strict";function Y(T,j){var R=Object.keys(T);if(Object.getOwnPropertySymbols){var q=Object.getOwnPropertySymbols(T);j&&(q=q.filter(function(ue){return Object.getOwnPropertyDescriptor(T,ue).enumerable})),R.push.apply(R,q)}return R}function k(T,j,R){return j in T?Object.defineProperty(T,j,{value:R,enumerable:!0,configurable:!0,writable:!0}):T[j]=R,T}function W(T,j){for(var R=0;R<j.length;R++){var q=j[R];q.enumerable=q.enumerable||!1,q.configurable=!0,"value"in q&&(q.writable=!0),Object.defineProperty(T,q.key,q)}}var P=K("buffer").Buffer,v=K("util").inspect,y=v&&v.custom||"inspect";function S(T,j,R){P.prototype.copy.call(T,j,R)}Me.exports=function(){function T(){(function(T,j){if(!(T instanceof j))throw new TypeError("Cannot call a class as a function")})(this,T),this.head=null,this.tail=null,this.length=0}return function(T,j,R){j&&W(T.prototype,j),R&&W(T,R)}(T,[{key:"push",value:function(R){var q={data:R,next:null};this.length>0?this.tail.next=q:this.head=q,this.tail=q,++this.length}},{key:"unshift",value:function(R){var q={data:R,next:this.head};0===this.length&&(this.tail=q),this.head=q,++this.length}},{key:"shift",value:function(){if(0!==this.length){var R=this.head.data;return this.head=1===this.length?this.tail=null:this.head.next,--this.length,R}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(R){if(0===this.length)return"";for(var q=this.head,ue=""+q.data;q=q.next;)ue+=R+q.data;return ue}},{key:"concat",value:function(R){if(0===this.length)return P.alloc(0);for(var q=P.allocUnsafe(R>>>0),ue=this.head,D=0;ue;)S(ue.data,q,D),D+=ue.data.length,ue=ue.next;return q}},{key:"consume",value:function(R,q){var ue;return R<this.head.data.length?(ue=this.head.data.slice(0,R),this.head.data=this.head.data.slice(R)):ue=R===this.head.data.length?this.shift():q?this._getString(R):this._getBuffer(R),ue}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(R){var q=this.head,ue=1,D=q.data;for(R-=D.length;q=q.next;){var O=q.data,X=R>O.length?O.length:R;if(D+=X===O.length?O:O.slice(0,R),0==(R-=X)){X===O.length?(++ue,this.head=q.next?q.next:this.tail=null):(this.head=q,q.data=O.slice(X));break}++ue}return this.length-=ue,D}},{key:"_getBuffer",value:function(R){var q=P.allocUnsafe(R),ue=this.head,D=1;for(ue.data.copy(q),R-=ue.data.length;ue=ue.next;){var O=ue.data,X=R>O.length?O.length:R;if(O.copy(q,q.length-R,0,X),0==(R-=X)){X===O.length?(++D,this.head=ue.next?ue.next:this.tail=null):(this.head=ue,ue.data=O.slice(X));break}++D}return this.length-=D,q}},{key:y,value:function(R,q){return v(this,function(T){for(var j=1;j<arguments.length;j++){var R=null!=arguments[j]?arguments[j]:{};j%2?Y(Object(R),!0).forEach(function(q){k(T,q,R[q])}):Object.getOwnPropertyDescriptors?Object.defineProperties(T,Object.getOwnPropertyDescriptors(R)):Y(Object(R)).forEach(function(q){Object.defineProperty(T,q,Object.getOwnPropertyDescriptor(R,q))})}return T}({},q,{depth:0,customInspect:!1}))}}]),T}()},{buffer:6,util:3}],75:[function(K,Me,pe){(function(Y){(function(){"use strict";function k(P,M){b(P,M),ie(P)}function ie(P){P._writableState&&!P._writableState.emitClose||P._readableState&&!P._readableState.emitClose||P.emit("close")}function b(P,M){P.emit("error",M)}Me.exports={destroy:function(P,M){var v=this;return this._readableState&&this._readableState.destroyed||this._writableState&&this._writableState.destroyed?(M?M(P):P&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,Y.nextTick(b,this,P)):Y.nextTick(b,this,P)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(P||null,function(T){!M&&T?v._writableState?v._writableState.errorEmitted?Y.nextTick(ie,v):(v._writableState.errorEmitted=!0,Y.nextTick(k,v,T)):Y.nextTick(k,v,T):M?(Y.nextTick(ie,v),M(T)):Y.nextTick(ie,v)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(P,M){var v=P._readableState,y=P._writableState;v&&v.autoDestroy||y&&y.autoDestroy?P.destroy(M):P.emit("error",M)}}}).call(this)}).call(this,K("_process"))},{_process:44}],76:[function(K,Me,pe){"use strict";var Y=K("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function k(){}Me.exports=function W(b,C,P){if("function"==typeof C)return W(b,null,C);C||(C={}),P=function(b){var C=!1;return function(){if(!C){C=!0;for(var P=arguments.length,M=new Array(P),v=0;v<P;v++)M[v]=arguments[v];b.apply(this,M)}}}(P||k);var M=C.readable||!1!==C.readable&&b.readable,v=C.writable||!1!==C.writable&&b.writable,y=function(){b.writable||T()},S=b._writableState&&b._writableState.finished,T=function(){v=!1,S=!0,M||P.call(b)},j=b._readableState&&b._readableState.endEmitted,R=function(){M=!1,j=!0,v||P.call(b)},q=function(X){P.call(b,X)},ue=function(){var X;return M&&!j?((!b._readableState||!b._readableState.ended)&&(X=new Y),P.call(b,X)):v&&!S?((!b._writableState||!b._writableState.ended)&&(X=new Y),P.call(b,X)):void 0},D=function(){b.req.on("finish",T)};return function(b){return b.setHeader&&"function"==typeof b.abort}(b)?(b.on("complete",T),b.on("abort",ue),b.req?D():b.on("request",D)):v&&!b._writableState&&(b.on("end",y),b.on("close",y)),b.on("end",R),b.on("finish",T),!1!==C.error&&b.on("error",q),b.on("close",ue),function(){b.removeListener("complete",T),b.removeListener("abort",ue),b.removeListener("request",D),b.req&&b.req.removeListener("finish",T),b.removeListener("end",y),b.removeListener("close",y),b.removeListener("finish",T),b.removeListener("end",R),b.removeListener("error",q),b.removeListener("close",ue)}}},{"../../../errors":67}],77:[function(K,Me,pe){Me.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],78:[function(K,Me,pe){"use strict";var Y;var k=K("../../../errors").codes,ie=k.ERR_MISSING_ARGS,W=k.ERR_STREAM_DESTROYED;function b(T){if(T)throw T}function P(T,j,R,q){q=function(T){var j=!1;return function(){j||(j=!0,T.apply(void 0,arguments))}}(q);var ue=!1;T.on("close",function(){ue=!0}),void 0===Y&&(Y=K("./end-of-stream")),Y(T,{readable:j,writable:R},function(O){if(O)return q(O);ue=!0,q()});var D=!1;return function(O){if(!ue&&!D){if(D=!0,function(T){return T.setHeader&&"function"==typeof T.abort}(T))return T.abort();if("function"==typeof T.destroy)return T.destroy();q(O||new W("pipe"))}}}function M(T){T()}function v(T,j){return T.pipe(j)}function y(T){return T.length&&"function"==typeof T[T.length-1]?T.pop():b}Me.exports=function(){for(var T=arguments.length,j=new Array(T),R=0;R<T;R++)j[R]=arguments[R];var q=y(j);if(Array.isArray(j[0])&&(j=j[0]),j.length<2)throw new ie("streams");var ue,D=j.map(function(O,X){var E=X<j.length-1;return P(O,E,X>0,function(Q){ue||(ue=Q),Q&&D.forEach(M),!E&&(D.forEach(M),q(ue))})});return j.reduce(v)}},{"../../../errors":67,"./end-of-stream":76}],79:[function(K,Me,pe){"use strict";var Y=K("../../../errors").codes.ERR_INVALID_OPT_VALUE;Me.exports={getHighWaterMark:function(ie,W,b,C){var P=function(ie,W,b){return null!=ie.highWaterMark?ie.highWaterMark:W?ie[b]:null}(W,C,b);if(null!=P){if(!isFinite(P)||Math.floor(P)!==P||P<0)throw new Y(C?b:"highWaterMark",P);return Math.floor(P)}return ie.objectMode?16:16384}}},{"../../../errors":67}],80:[function(K,Me,pe){Me.exports=K("events").EventEmitter},{events:8}],81:[function(K,Me,pe){(pe=Me.exports=K("./lib/_stream_readable.js")).Stream=pe,pe.Readable=pe,pe.Writable=K("./lib/_stream_writable.js"),pe.Duplex=K("./lib/_stream_duplex.js"),pe.Transform=K("./lib/_stream_transform.js"),pe.PassThrough=K("./lib/_stream_passthrough.js"),pe.finished=K("./lib/internal/streams/end-of-stream.js"),pe.pipeline=K("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":68,"./lib/_stream_passthrough.js":69,"./lib/_stream_readable.js":70,"./lib/_stream_transform.js":71,"./lib/_stream_writable.js":72,"./lib/internal/streams/end-of-stream.js":76,"./lib/internal/streams/pipeline.js":78}],82:[function(K,Me,pe){"use strict";Object.defineProperty(pe,"__esModule",{value:!0}),function(U){for(var k in U)pe.hasOwnProperty(k)||(pe[k]=U[k])}(K("./lib/Resolve"))},{"./lib/Resolve":83}],83:[function(K,Me,pe){"use strict";function U(W){const b=[];let C=0;for(;C<W.length;)switch(W[C]){case"/":if("."===W[C+1])if("."===W[C+2]){if(!ie(W[C+3])){b.push([]),C++;break}b.pop(),W[C+3]||b.push([]),C+=3}else{if(!ie(W[C+2])){b.push([]),C++;break}W[C+2]||b.push([]),C+=2}else b.push([]),C++;break;case"#":case"?":b.length||b.push([]),b[b.length-1].push(W.substr(C)),C=W.length;break;default:b.length||b.push([]),b[b.length-1].push(W[C]),C++}return"/"+b.map(P=>P.join("")).join("/")}function k(W,b){let C=b+1;b>=0?"/"===W[b+1]&&"/"===W[b+2]&&(C=b+3):"/"===W[0]&&"/"===W[1]&&(C=2);const P=W.indexOf("/",C);return P<0?W:W.substr(0,P)+U(W.substr(P))}function ie(W){return!W||"#"===W||"?"===W||"/"===W}Object.defineProperty(pe,"__esModule",{value:!0}),pe.resolve=function(W,b){const C=(b=b||"").indexOf("#");if(C>0&&(b=b.substr(0,C)),!W.length){if(b.indexOf(":")<0)throw new Error(`Found invalid baseIRI '${b}' for value '${W}'`);return b}if(W.startsWith("?")){const j=b.indexOf("?");return j>0&&(b=b.substr(0,j)),b+W}if(W.startsWith("#"))return b+W;if(!b.length){const j=W.indexOf(":");if(j<0)throw new Error(`Found invalid relative IRI '${W}' for a missing baseIRI`);return k(W,j)}const P=W.indexOf(":");if(P>=0)return k(W,P);const M=b.indexOf(":");if(M<0)throw new Error(`Found invalid baseIRI '${b}' for value '${W}'`);const v=b.substr(0,M+1);if(0===W.indexOf("//"))return v+k(W,P);let y;if(b.indexOf("//",M)===M+1){if(y=b.indexOf("/",M+3),y<0)return b.length>M+3?b+"/"+k(W,P):v+k(W,P)}else if(y=b.indexOf("/",M+1),y<0)return v+k(W,P);if(0===W.indexOf("/"))return b.substr(0,y)+U(W);let S=b.substr(y);const T=S.lastIndexOf("/");return T>=0&&T<S.length-1&&(S=S.substr(0,T+1),"."===W[0]&&"."!==W[1]&&"/"!==W[1]&&W[2]&&(W=W.substr(1))),W=U(W=S+W),b.substr(0,y)+W},pe.removeDotSegments=U,pe.removeDotSegmentsOfPath=k},{}],84:[function(K,Me,pe){var Y=K("buffer"),U=Y.Buffer;function k(W,b){for(var C in W)b[C]=W[C]}function ie(W,b,C){return U(W,b,C)}U.from&&U.alloc&&U.allocUnsafe&&U.allocUnsafeSlow?Me.exports=Y:(k(Y,pe),pe.Buffer=ie),ie.prototype=Object.create(U.prototype),k(U,ie),ie.from=function(W,b,C){if("number"==typeof W)throw new TypeError("Argument must not be a number");return U(W,b,C)},ie.alloc=function(W,b,C){if("number"!=typeof W)throw new TypeError("Argument must be a number");var P=U(W);return void 0!==b?"string"==typeof C?P.fill(b,C):P.fill(b):P.fill(0),P},ie.allocUnsafe=function(W){if("number"!=typeof W)throw new TypeError("Argument must be a number");return U(W)},ie.allocUnsafeSlow=function(W){if("number"!=typeof W)throw new TypeError("Argument must be a number");return Y.SlowBuffer(W)}},{buffer:6}],85:[function(K,Me,pe){(function(Y){(function(){!function(U){U.parser=function($,z){return new ie($,z)},U.SAXParser=ie,U.SAXStream=y,U.createStream=function($,z){return new y($,z)},U.MAX_BUFFER_LENGTH=65536;var P,k=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];function ie($,z){if(!(this instanceof ie))return new ie($,z);var fe=this;(function($){for(var z=0,fe=k.length;z<fe;z++)$[k[z]]=""})(fe),fe.q=fe.c="",fe.bufferCheckPosition=U.MAX_BUFFER_LENGTH,fe.opt=z||{},fe.opt.lowercase=fe.opt.lowercase||fe.opt.lowercasetags,fe.looseCase=fe.opt.lowercase?"toLowerCase":"toUpperCase",fe.tags=[],fe.closed=fe.closedRoot=fe.sawRoot=!1,fe.tag=fe.error=null,fe.strict=!!$,fe.noscript=!(!$&&!fe.opt.noscript),fe.state=ee.BEGIN,fe.strictEntities=fe.opt.strictEntities,fe.ENTITIES=Object.create(fe.strictEntities?U.XML_ENTITIES:U.ENTITIES),fe.attribList=[],fe.opt.xmlns&&(fe.ns=Object.create(q)),fe.trackPosition=!1!==fe.opt.position,fe.trackPosition&&(fe.position=fe.line=fe.column=0),me(fe,"onready")}U.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function($){function z(){}return z.prototype=$,new z}),Object.keys||(Object.keys=function($){var z=[];for(var fe in $)$.hasOwnProperty(fe)&&z.push(fe);return z}),ie.prototype={end:function(){st(this)},write:function($){var z=this;if(this.error)throw this.error;if(z.closed)return $e(z,"Cannot write after close. Assign an onready handler.");if(null===$)return st(z);"object"==typeof $&&($=$.toString());for(var fe=0,de="";de=qe($,fe++),z.c=de,de;)switch(z.trackPosition&&(z.position++,"\n"===de?(z.line++,z.column=0):z.column++),z.state){case ee.BEGIN:if(z.state=ee.BEGIN_WHITESPACE,"\ufeff"===de)continue;je(z,de);continue;case ee.BEGIN_WHITESPACE:je(z,de);continue;case ee.TEXT:if(z.sawRoot&&!z.closedRoot){for(var Ve=fe-1;de&&"<"!==de&&"&"!==de;)(de=qe($,fe++))&&z.trackPosition&&(z.position++,"\n"===de?(z.line++,z.column=0):z.column++);z.textNode+=$.substring(Ve,fe-1)}"<"!==de||z.sawRoot&&z.closedRoot&&!z.strict?(!E(de)&&(!z.sawRoot||z.closedRoot)&&Qe(z,"Text data outside of root node."),"&"===de?z.state=ee.TEXT_ENTITY:z.textNode+=de):(z.state=ee.OPEN_WAKA,z.startTagPosition=z.position);continue;case ee.SCRIPT:"<"===de?z.state=ee.SCRIPT_ENDING:z.script+=de;continue;case ee.SCRIPT_ENDING:"/"===de?z.state=ee.CLOSE_TAG:(z.script+="<"+de,z.state=ee.SCRIPT);continue;case ee.OPEN_WAKA:"!"===de?(z.state=ee.SGML_DECL,z.sgmlDecl=""):E(de)||(ae(ue,de)?(z.state=ee.OPEN_TAG,z.tagName=de):"/"===de?(z.state=ee.CLOSE_TAG,z.tagName=""):"?"===de?(z.state=ee.PROC_INST,z.procInstName=z.procInstBody=""):(Qe(z,"Unencoded <"),z.startTagPosition+1<z.position&&(de=new Array(z.position-z.startTagPosition).join(" ")+de),z.textNode+="<"+de,z.state=ee.TEXT));continue;case ee.SGML_DECL:"[CDATA["===(z.sgmlDecl+de).toUpperCase()?(te(z,"onopencdata"),z.state=ee.CDATA,z.sgmlDecl="",z.cdata=""):z.sgmlDecl+de==="--"?(z.state=ee.COMMENT,z.comment="",z.sgmlDecl=""):"DOCTYPE"===(z.sgmlDecl+de).toUpperCase()?(z.state=ee.DOCTYPE,(z.doctype||z.sawRoot)&&Qe(z,"Inappropriately located doctype declaration"),z.doctype="",z.sgmlDecl=""):">"===de?(te(z,"onsgmldeclaration",z.sgmlDecl),z.sgmlDecl="",z.state=ee.TEXT):(G(de)&&(z.state=ee.SGML_DECL_QUOTED),z.sgmlDecl+=de);continue;case ee.SGML_DECL_QUOTED:de===z.q&&(z.state=ee.SGML_DECL,z.q=""),z.sgmlDecl+=de;continue;case ee.DOCTYPE:">"===de?(z.state=ee.TEXT,te(z,"ondoctype",z.doctype),z.doctype=!0):(z.doctype+=de,"["===de?z.state=ee.DOCTYPE_DTD:G(de)&&(z.state=ee.DOCTYPE_QUOTED,z.q=de));continue;case ee.DOCTYPE_QUOTED:z.doctype+=de,de===z.q&&(z.q="",z.state=ee.DOCTYPE);continue;case ee.DOCTYPE_DTD:z.doctype+=de,"]"===de?z.state=ee.DOCTYPE:G(de)&&(z.state=ee.DOCTYPE_DTD_QUOTED,z.q=de);continue;case ee.DOCTYPE_DTD_QUOTED:z.doctype+=de,de===z.q&&(z.state=ee.DOCTYPE_DTD,z.q="");continue;case ee.COMMENT:"-"===de?z.state=ee.COMMENT_ENDING:z.comment+=de;continue;case ee.COMMENT_ENDING:"-"===de?(z.state=ee.COMMENT_ENDED,z.comment=Oe(z.opt,z.comment),z.comment&&te(z,"oncomment",z.comment),z.comment=""):(z.comment+="-"+de,z.state=ee.COMMENT);continue;case ee.COMMENT_ENDED:">"!==de?(Qe(z,"Malformed comment"),z.comment+="--"+de,z.state=ee.COMMENT):z.state=ee.TEXT;continue;case ee.CDATA:"]"===de?z.state=ee.CDATA_ENDING:z.cdata+=de;continue;case ee.CDATA_ENDING:"]"===de?z.state=ee.CDATA_ENDING_2:(z.cdata+="]"+de,z.state=ee.CDATA);continue;case ee.CDATA_ENDING_2:">"===de?(z.cdata&&te(z,"oncdata",z.cdata),te(z,"onclosecdata"),z.cdata="",z.state=ee.TEXT):"]"===de?z.cdata+="]":(z.cdata+="]]"+de,z.state=ee.CDATA);continue;case ee.PROC_INST:"?"===de?z.state=ee.PROC_INST_ENDING:E(de)?z.state=ee.PROC_INST_BODY:z.procInstName+=de;continue;case ee.PROC_INST_BODY:if(!z.procInstBody&&E(de))continue;"?"===de?z.state=ee.PROC_INST_ENDING:z.procInstBody+=de;continue;case ee.PROC_INST_ENDING:">"===de?(te(z,"onprocessinginstruction",{name:z.procInstName,body:z.procInstBody}),z.procInstName=z.procInstBody="",z.state=ee.TEXT):(z.procInstBody+="?"+de,z.state=ee.PROC_INST_BODY);continue;case ee.OPEN_TAG:ae(D,de)?z.tagName+=de:(et(z),">"===de?Le(z):"/"===de?z.state=ee.OPEN_TAG_SLASH:(E(de)||Qe(z,"Invalid character in tag name"),z.state=ee.ATTRIB));continue;case ee.OPEN_TAG_SLASH:">"===de?(Le(z,!0),Xe(z)):(Qe(z,"Forward-slash in opening tag not followed by >"),z.state=ee.ATTRIB);continue;case ee.ATTRIB:if(E(de))continue;">"===de?Le(z):"/"===de?z.state=ee.OPEN_TAG_SLASH:ae(ue,de)?(z.attribName=de,z.attribValue="",z.state=ee.ATTRIB_NAME):Qe(z,"Invalid attribute name");continue;case ee.ATTRIB_NAME:"="===de?z.state=ee.ATTRIB_VALUE:">"===de?(Qe(z,"Attribute without value"),z.attribValue=z.attribName,Ue(z),Le(z)):E(de)?z.state=ee.ATTRIB_NAME_SAW_WHITE:ae(D,de)?z.attribName+=de:Qe(z,"Invalid attribute name");continue;case ee.ATTRIB_NAME_SAW_WHITE:if("="===de)z.state=ee.ATTRIB_VALUE;else{if(E(de))continue;Qe(z,"Attribute without value"),z.tag.attributes[z.attribName]="",z.attribValue="",te(z,"onattribute",{name:z.attribName,value:""}),z.attribName="",">"===de?Le(z):ae(ue,de)?(z.attribName=de,z.state=ee.ATTRIB_NAME):(Qe(z,"Invalid attribute name"),z.state=ee.ATTRIB)}continue;case ee.ATTRIB_VALUE:if(E(de))continue;G(de)?(z.q=de,z.state=ee.ATTRIB_VALUE_QUOTED):(Qe(z,"Unquoted attribute value"),z.state=ee.ATTRIB_VALUE_UNQUOTED,z.attribValue=de);continue;case ee.ATTRIB_VALUE_QUOTED:if(de!==z.q){"&"===de?z.state=ee.ATTRIB_VALUE_ENTITY_Q:z.attribValue+=de;continue}Ue(z),z.q="",z.state=ee.ATTRIB_VALUE_CLOSED;continue;case ee.ATTRIB_VALUE_CLOSED:E(de)?z.state=ee.ATTRIB:">"===de?Le(z):"/"===de?z.state=ee.OPEN_TAG_SLASH:ae(ue,de)?(Qe(z,"No whitespace between attributes"),z.attribName=de,z.attribValue="",z.state=ee.ATTRIB_NAME):Qe(z,"Invalid attribute name");continue;case ee.ATTRIB_VALUE_UNQUOTED:if(!Q(de)){"&"===de?z.state=ee.ATTRIB_VALUE_ENTITY_U:z.attribValue+=de;continue}Ue(z),">"===de?Le(z):z.state=ee.ATTRIB;continue;case ee.CLOSE_TAG:if(z.tagName)">"===de?Xe(z):ae(D,de)?z.tagName+=de:z.script?(z.script+="</"+z.tagName,z.tagName="",z.state=ee.SCRIPT):(E(de)||Qe(z,"Invalid tagname in closing tag"),z.state=ee.CLOSE_TAG_SAW_WHITE);else{if(E(de))continue;se(ue,de)?z.script?(z.script+="</"+de,z.state=ee.SCRIPT):Qe(z,"Invalid tagname in closing tag."):z.tagName=de}continue;case ee.CLOSE_TAG_SAW_WHITE:if(E(de))continue;">"===de?Xe(z):Qe(z,"Invalid characters in closing tag");continue;case ee.TEXT_ENTITY:case ee.ATTRIB_VALUE_ENTITY_Q:case ee.ATTRIB_VALUE_ENTITY_U:var ft,be;switch(z.state){case ee.TEXT_ENTITY:ft=ee.TEXT,be="textNode";break;case ee.ATTRIB_VALUE_ENTITY_Q:ft=ee.ATTRIB_VALUE_QUOTED,be="attribValue";break;case ee.ATTRIB_VALUE_ENTITY_U:ft=ee.ATTRIB_VALUE_UNQUOTED,be="attribValue"}";"===de?(z[be]+=Te(z),z.entity="",z.state=ft):ae(z.entity.length?X:O,de)?z.entity+=de:(Qe(z,"Invalid character in entity name"),z[be]+="&"+z.entity+de,z.entity="",z.state=ft);continue;default:throw new Error(z,"Unknown state: "+z.state)}return z.position>=z.bufferCheckPosition&&function($){for(var z=Math.max(U.MAX_BUFFER_LENGTH,10),fe=0,de=0,Ve=k.length;de<Ve;de++){var gt=$[k[de]].length;if(gt>z)switch(k[de]){case"textNode":_e($);break;case"cdata":te($,"oncdata",$.cdata),$.cdata="";break;case"script":te($,"onscript",$.script),$.script="";break;default:$e($,"Max buffer length exceeded: "+k[de])}fe=Math.max(fe,gt)}$.bufferCheckPosition=U.MAX_BUFFER_LENGTH-fe+$.position}(z),z},resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){!function($){_e($),""!==$.cdata&&(te($,"oncdata",$.cdata),$.cdata=""),""!==$.script&&(te($,"onscript",$.script),$.script="")}(this)}};try{P=K("stream").Stream}catch($){P=function(){}}var M=U.EVENTS.filter(function($){return"error"!==$&&"end"!==$});function y($,z){if(!(this instanceof y))return new y($,z);P.apply(this),this._parser=new ie($,z),this.writable=!0,this.readable=!0;var fe=this;this._parser.onend=function(){fe.emit("end")},this._parser.onerror=function(de){fe.emit("error",de),fe._parser.error=null},this._decoder=null,M.forEach(function(de){Object.defineProperty(fe,"on"+de,{get:function(){return fe._parser["on"+de]},set:function(Ve){if(!Ve)return fe.removeAllListeners(de),fe._parser["on"+de]=Ve,Ve;fe.on(de,Ve)},enumerable:!0,configurable:!1})})}(y.prototype=Object.create(P.prototype,{constructor:{value:y}})).write=function($){if("function"==typeof Y&&"function"==typeof Y.isBuffer&&Y.isBuffer($)){if(!this._decoder){var z=K("string_decoder").StringDecoder;this._decoder=new z("utf8")}$=this._decoder.write($)}return this._parser.write($.toString()),this.emit("data",$),!0},y.prototype.end=function($){return $&&$.length&&this.write($),this._parser.end(),!0},y.prototype.on=function($,z){var fe=this;return!fe._parser["on"+$]&&-1!==M.indexOf($)&&(fe._parser["on"+$]=function(){var de=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);de.splice(0,0,$),fe.emit.apply(fe,de)}),P.prototype.on.call(fe,$,z)};var j="http://www.w3.org/XML/1998/namespace",R="http://www.w3.org/2000/xmlns/",q={xml:j,xmlns:R},ue=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,D=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,O=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,X=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function E($){return" "===$||"\n"===$||"\r"===$||"\t"===$}function G($){return'"'===$||"'"===$}function Q($){return">"===$||E($)}function ae($,z){return $.test(z)}function se($,z){return!ae($,z)}var $,z,fe,ee=0;for(var xe in U.STATE={BEGIN:ee++,BEGIN_WHITESPACE:ee++,TEXT:ee++,TEXT_ENTITY:ee++,OPEN_WAKA:ee++,SGML_DECL:ee++,SGML_DECL_QUOTED:ee++,DOCTYPE:ee++,DOCTYPE_QUOTED:ee++,DOCTYPE_DTD:ee++,DOCTYPE_DTD_QUOTED:ee++,COMMENT_STARTING:ee++,COMMENT:ee++,COMMENT_ENDING:ee++,COMMENT_ENDED:ee++,CDATA:ee++,CDATA_ENDING:ee++,CDATA_ENDING_2:ee++,PROC_INST:ee++,PROC_INST_BODY:ee++,PROC_INST_ENDING:ee++,OPEN_TAG:ee++,OPEN_TAG_SLASH:ee++,ATTRIB:ee++,ATTRIB_NAME:ee++,ATTRIB_NAME_SAW_WHITE:ee++,ATTRIB_VALUE:ee++,ATTRIB_VALUE_QUOTED:ee++,ATTRIB_VALUE_CLOSED:ee++,ATTRIB_VALUE_UNQUOTED:ee++,ATTRIB_VALUE_ENTITY_Q:ee++,ATTRIB_VALUE_ENTITY_U:ee++,CLOSE_TAG:ee++,CLOSE_TAG_SAW_WHITE:ee++,SCRIPT:ee++,SCRIPT_ENDING:ee++},U.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},U.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(U.ENTITIES).forEach(function($){var z=U.ENTITIES[$],fe="number"==typeof z?String.fromCharCode(z):z;U.ENTITIES[$]=fe}),U.STATE)U.STATE[U.STATE[xe]]=xe;function me($,z,fe){$[z]&&$[z](fe)}function te($,z,fe){$.textNode&&_e($),me($,z,fe)}function _e($){$.textNode=Oe($.opt,$.textNode),$.textNode&&me($,"ontext",$.textNode),$.textNode=""}function Oe($,z){return $.trim&&(z=z.trim()),$.normalize&&(z=z.replace(/\s+/g," ")),z}function $e($,z){return _e($),$.trackPosition&&(z+="\nLine: "+$.line+"\nColumn: "+$.column+"\nChar: "+$.c),z=new Error(z),$.error=z,me($,"onerror",z),$}function st($){return $.sawRoot&&!$.closedRoot&&Qe($,"Unclosed root tag"),$.state!==ee.BEGIN&&$.state!==ee.BEGIN_WHITESPACE&&$.state!==ee.TEXT&&$e($,"Unexpected end"),_e($),$.c="",$.closed=!0,me($,"onend"),ie.call($,$.strict,$.opt),$}function Qe($,z){if("object"!=typeof $||!($ instanceof ie))throw new Error("bad call to strictFail");$.strict&&$e($,z)}function et($){$.strict||($.tagName=$.tagName[$.looseCase]());var z=$.tags[$.tags.length-1]||$,fe=$.tag={name:$.tagName,attributes:{}};$.opt.xmlns&&(fe.ns=z.ns),$.attribList.length=0,te($,"onopentagstart",fe)}function Ke($,z){var de=$.indexOf(":")<0?["",$]:$.split(":"),Ve=de[0],gt=de[1];return z&&"xmlns"===$&&(Ve="xmlns",gt=""),{prefix:Ve,local:gt}}function Ue($){if($.strict||($.attribName=$.attribName[$.looseCase]()),-1!==$.attribList.indexOf($.attribName)||$.tag.attributes.hasOwnProperty($.attribName))$.attribName=$.attribValue="";else{if($.opt.xmlns){var z=Ke($.attribName,!0),de=z.local;if("xmlns"===z.prefix)if("xml"===de&&$.attribValue!==j)Qe($,"xml: prefix must be bound to "+j+"\nActual: "+$.attribValue);else if("xmlns"===de&&$.attribValue!==R)Qe($,"xmlns: prefix must be bound to "+R+"\nActual: "+$.attribValue);else{var Ve=$.tag,gt=$.tags[$.tags.length-1]||$;Ve.ns===gt.ns&&(Ve.ns=Object.create(gt.ns)),Ve.ns[de]=$.attribValue}$.attribList.push([$.attribName,$.attribValue])}else $.tag.attributes[$.attribName]=$.attribValue,te($,"onattribute",{name:$.attribName,value:$.attribValue});$.attribName=$.attribValue=""}}function Le($,z){if($.opt.xmlns){var fe=$.tag,de=Ke($.tagName);fe.prefix=de.prefix,fe.local=de.local,fe.uri=fe.ns[de.prefix]||"",fe.prefix&&!fe.uri&&(Qe($,"Unbound namespace prefix: "+JSON.stringify($.tagName)),fe.uri=de.prefix),fe.ns&&($.tags[$.tags.length-1]||$).ns!==fe.ns&&Object.keys(fe.ns).forEach(function(Mn){te($,"onopennamespace",{prefix:Mn,uri:fe.ns[Mn]})});for(var gt=0,ft=$.attribList.length;gt<ft;gt++){var be=$.attribList[gt],B=be[0],N=be[1],V=Ke(B,!0),Re=V.prefix,bt=""===Re?"":fe.ns[Re]||"",Rt={name:B,value:N,prefix:Re,local:V.local,uri:bt};Re&&"xmlns"!==Re&&!bt&&(Qe($,"Unbound namespace prefix: "+JSON.stringify(Re)),Rt.uri=Re),$.tag.attributes[B]=Rt,te($,"onattribute",Rt)}$.attribList.length=0}$.tag.isSelfClosing=!!z,$.sawRoot=!0,$.tags.push($.tag),te($,"onopentag",$.tag),z||($.state=$.noscript||"script"!==$.tagName.toLowerCase()?ee.TEXT:ee.SCRIPT,$.tag=null,$.tagName=""),$.attribName=$.attribValue="",$.attribList.length=0}function Xe($){if(!$.tagName)return Qe($,"Weird empty close tag."),$.textNode+="</>",void($.state=ee.TEXT);if($.script){if("script"!==$.tagName)return $.script+="</"+$.tagName+">",$.tagName="",void($.state=ee.SCRIPT);te($,"onscript",$.script),$.script=""}var z=$.tags.length,fe=$.tagName;$.strict||(fe=fe[$.looseCase]());for(var de=fe;z--&&$.tags[z].name!==de;)Qe($,"Unexpected close tag");if(z<0)return Qe($,"Unmatched closing tag: "+$.tagName),$.textNode+="</"+$.tagName+">",void($.state=ee.TEXT);$.tagName=fe;for(var gt=$.tags.length;gt-- >z;){var ft=$.tag=$.tags.pop();$.tagName=$.tag.name,te($,"onclosetag",$.tagName);var be={};for(var B in ft.ns)be[B]=ft.ns[B];$.opt.xmlns&&ft.ns!==($.tags[$.tags.length-1]||$).ns&&Object.keys(ft.ns).forEach(function(V){te($,"onclosenamespace",{prefix:V,uri:ft.ns[V]})})}0===z&&($.closedRoot=!0),$.tagName=$.attribValue=$.attribName="",$.attribList.length=0,$.state=ee.TEXT}function Te($){var de,z=$.entity,fe=z.toLowerCase(),Ve="";return $.ENTITIES[z]?$.ENTITIES[z]:$.ENTITIES[fe]?$.ENTITIES[fe]:("#"===(z=fe).charAt(0)&&("x"===z.charAt(1)?(z=z.slice(2),Ve=(de=parseInt(z,16)).toString(16)):(z=z.slice(1),Ve=(de=parseInt(z,10)).toString(10))),z=z.replace(/^0+/,""),isNaN(de)||Ve.toLowerCase()!==z?(Qe($,"Invalid character entity"),"&"+$.entity+";"):String.fromCodePoint(de))}function je($,z){"<"===z?($.state=ee.OPEN_WAKA,$.startTagPosition=$.position):E(z)||(Qe($,"Non-whitespace before first tag."),$.textNode=z,$.state=ee.TEXT)}function qe($,z){var fe="";return z<$.length&&(fe=$.charAt(z)),fe}ee=U.STATE,String.fromCodePoint||($=String.fromCharCode,z=Math.floor,fe=function(){var de=16384,Ve=[],be=-1,B=arguments.length;if(!B)return"";for(var N="";++be<B;){var V=Number(arguments[be]);if(!isFinite(V)||V<0||V>1114111||z(V)!==V)throw RangeError("Invalid code point: "+V);V<=65535?Ve.push(V):Ve.push(55296+((V-=65536)>>10),V%1024+56320),(be+1===B||Ve.length>de)&&(N+=$.apply(null,Ve),Ve.length=0)}return N},Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:fe,configurable:!0,writable:!0}):String.fromCodePoint=fe)}(void 0===pe?this.sax={}:pe)}).call(this)}).call(this,K("buffer").Buffer)},{buffer:6,stream:87,string_decoder:5}],86:[function(K,Me,pe){(function(Y,U){(function(){!function(k,ie){"use strict";if(!k.setImmediate){var M,W=1,b={},C=!1,P=k.document,X=Object.getPrototypeOf&&Object.getPrototypeOf(k);X=X&&X.setTimeout?X:k,"[object process]"==={}.toString.call(k.process)?M=function(E){Y.nextTick(function(){T(E)})}:function(){if(k.postMessage&&!k.importScripts){var E=!0,G=k.onmessage;return k.onmessage=function(){E=!1},k.postMessage("","*"),k.onmessage=G,E}}()?(E="setImmediate$"+Math.random()+"$",G=function(Q){Q.source===k&&"string"==typeof Q.data&&0===Q.data.indexOf(E)&&T(+Q.data.slice(E.length))},k.addEventListener?k.addEventListener("message",G,!1):k.attachEvent("onmessage",G),M=function(Q){k.postMessage(E+Q,"*")}):k.MessageChannel?function(){var E=new MessageChannel;E.port1.onmessage=function(G){T(G.data)},M=function(G){E.port2.postMessage(G)}}():P&&"onreadystatechange"in P.createElement("script")?function(){var E=P.documentElement;M=function(G){var Q=P.createElement("script");Q.onreadystatechange=function(){T(G),Q.onreadystatechange=null,E.removeChild(Q),Q=null},E.appendChild(Q)}}():M=function(E){setTimeout(T,0,E)},X.setImmediate=function(E){"function"!=typeof E&&(E=new Function(""+E));for(var G=new Array(arguments.length-1),Q=0;Q<G.length;Q++)G[Q]=arguments[Q+1];return b[W]={callback:E,args:G},M(W),W++},X.clearImmediate=y}var E,G;function y(E){delete b[E]}function T(E){if(C)setTimeout(T,0,E);else{var G=b[E];if(G){C=!0;try{!function(E){var G=E.callback,Q=E.args;switch(Q.length){case 0:G();break;case 1:G(Q[0]);break;case 2:G(Q[0],Q[1]);break;case 3:G(Q[0],Q[1],Q[2]);break;default:G.apply(void 0,Q)}}(G)}finally{y(E),C=!1}}}}}("undefined"==typeof self?void 0===U?this:U:self)}).call(this)}).call(this,K("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:44}],87:[function(K,Me,pe){Me.exports=k;var Y=K("events").EventEmitter;function k(){Y.call(this)}K("inherits")(k,Y),k.Readable=K("readable-stream/lib/_stream_readable.js"),k.Writable=K("readable-stream/lib/_stream_writable.js"),k.Duplex=K("readable-stream/lib/_stream_duplex.js"),k.Transform=K("readable-stream/lib/_stream_transform.js"),k.PassThrough=K("readable-stream/lib/_stream_passthrough.js"),k.finished=K("readable-stream/lib/internal/streams/end-of-stream.js"),k.pipeline=K("readable-stream/lib/internal/streams/pipeline.js"),k.Stream=k,k.prototype.pipe=function(ie,W){var b=this;function C(j){ie.writable&&!1===ie.write(j)&&b.pause&&b.pause()}function P(){b.readable&&b.resume&&b.resume()}b.on("data",C),ie.on("drain",P),!ie._isStdio&&(!W||!1!==W.end)&&(b.on("end",v),b.on("close",y));var M=!1;function v(){M||(M=!0,ie.end())}function y(){M||(M=!0,"function"==typeof ie.destroy&&ie.destroy())}function S(j){if(T(),0===Y.listenerCount(this,"error"))throw j}function T(){b.removeListener("data",C),ie.removeListener("drain",P),b.removeListener("end",v),b.removeListener("close",y),b.removeListener("error",S),ie.removeListener("error",S),b.removeListener("end",T),b.removeListener("close",T),ie.removeListener("close",T)}return b.on("error",S),ie.on("error",S),b.on("end",T),b.on("close",T),ie.on("close",T),ie.emit("pipe",b),ie}},{events:8,inherits:10,"readable-stream/lib/_stream_duplex.js":68,"readable-stream/lib/_stream_passthrough.js":69,"readable-stream/lib/_stream_readable.js":70,"readable-stream/lib/_stream_transform.js":71,"readable-stream/lib/_stream_writable.js":72,"readable-stream/lib/internal/streams/end-of-stream.js":76,"readable-stream/lib/internal/streams/pipeline.js":78}],88:[function(K,Me,pe){arguments[4][5][0].apply(pe,arguments)},{dup:5,"safe-buffer":84}],89:[function(K,Me,pe){(function(Y,U){(function(){var k=K("process/browser.js").nextTick,ie=Function.prototype.apply,W=Array.prototype.slice,b={},C=0;function P(M,v){this._id=M,this._clearFn=v}pe.setTimeout=function(){return new P(ie.call(setTimeout,window,arguments),clearTimeout)},pe.setInterval=function(){return new P(ie.call(setInterval,window,arguments),clearInterval)},pe.clearTimeout=pe.clearInterval=function(M){M.close()},P.prototype.unref=P.prototype.ref=function(){},P.prototype.close=function(){this._clearFn.call(window,this._id)},pe.enroll=function(M,v){clearTimeout(M._idleTimeoutId),M._idleTimeout=v},pe.unenroll=function(M){clearTimeout(M._idleTimeoutId),M._idleTimeout=-1},pe._unrefActive=pe.active=function(M){clearTimeout(M._idleTimeoutId);var v=M._idleTimeout;v>=0&&(M._idleTimeoutId=setTimeout(function(){M._onTimeout&&M._onTimeout()},v))},pe.setImmediate="function"==typeof Y?Y:function(M){var v=C++,y=!(arguments.length<2)&&W.call(arguments,1);return b[v]=!0,k(function(){b[v]&&(y?M.apply(null,y):M.call(null),pe.clearImmediate(v))}),v},pe.clearImmediate="function"==typeof U?U:function(M){delete b[M]}}).call(this)}).call(this,K("timers").setImmediate,K("timers").clearImmediate)},{"process/browser.js":44,timers:89}],90:[function(K,Me,pe){(function(Y){(function(){function k(ie){try{if(!Y.localStorage)return!1}catch(b){return!1}var W=Y.localStorage[ie];return null!=W&&"true"===String(W).toLowerCase()}Me.exports=function(ie,W){if(k("noDeprecation"))return ie;var b=!1;return function(){if(!b){if(k("throwDeprecation"))throw new Error(W);k("traceDeprecation")?console.trace(W):console.warn(W),b=!0}return ie.apply(this,arguments)}}}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],91:[function(K,Me,pe){"use strict";Me.exports=function(Y){Y.prototype[Symbol.iterator]=function*(){for(let U=this.head;U;U=U.next)yield U.value}}},{}],92:[function(K,Me,pe){"use strict";function Y(b){var C=this;if(C instanceof Y||(C=new Y),C.tail=null,C.head=null,C.length=0,b&&"function"==typeof b.forEach)b.forEach(function(v){C.push(v)});else if(arguments.length>0)for(var P=0,M=arguments.length;P<M;P++)C.push(arguments[P]);return C}function U(b,C,P){var M=C===b.head?new W(P,null,C,b):new W(P,C,C.next,b);return null===M.next&&(b.tail=M),null===M.prev&&(b.head=M),b.length++,M}function k(b,C){b.tail=new W(C,b.tail,null,b),b.head||(b.head=b.tail),b.length++}function ie(b,C){b.head=new W(C,null,b.head,b),b.tail||(b.tail=b.head),b.length++}function W(b,C,P,M){if(!(this instanceof W))return new W(b,C,P,M);this.list=M,this.value=b,C?(C.next=this,this.prev=C):this.prev=null,P?(P.prev=this,this.next=P):this.next=null}Me.exports=Y,Y.Node=W,Y.create=Y,Y.prototype.removeNode=function(b){if(b.list!==this)throw new Error("removing node which does not belong to this list");var C=b.next,P=b.prev;return C&&(C.prev=P),P&&(P.next=C),b===this.head&&(this.head=C),b===this.tail&&(this.tail=P),b.list.length--,b.next=null,b.prev=null,b.list=null,C},Y.prototype.unshiftNode=function(b){if(b!==this.head){b.list&&b.list.removeNode(b);var C=this.head;b.list=this,b.next=C,C&&(C.prev=b),this.head=b,this.tail||(this.tail=b),this.length++}},Y.prototype.pushNode=function(b){if(b!==this.tail){b.list&&b.list.removeNode(b);var C=this.tail;b.list=this,b.prev=C,C&&(C.next=b),this.tail=b,this.head||(this.head=b),this.length++}},Y.prototype.push=function(){for(var b=0,C=arguments.length;b<C;b++)k(this,arguments[b]);return this.length},Y.prototype.unshift=function(){for(var b=0,C=arguments.length;b<C;b++)ie(this,arguments[b]);return this.length},Y.prototype.pop=function(){if(this.tail){var b=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,b}},Y.prototype.shift=function(){if(this.head){var b=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,b}},Y.prototype.forEach=function(b,C){C=C||this;for(var P=this.head,M=0;null!==P;M++)b.call(C,P.value,M,this),P=P.next},Y.prototype.forEachReverse=function(b,C){C=C||this;for(var P=this.tail,M=this.length-1;null!==P;M--)b.call(C,P.value,M,this),P=P.prev},Y.prototype.get=function(b){for(var C=0,P=this.head;null!==P&&C<b;C++)P=P.next;if(C===b&&null!==P)return P.value},Y.prototype.getReverse=function(b){for(var C=0,P=this.tail;null!==P&&C<b;C++)P=P.prev;if(C===b&&null!==P)return P.value},Y.prototype.map=function(b,C){C=C||this;for(var P=new Y,M=this.head;null!==M;)P.push(b.call(C,M.value,this)),M=M.next;return P},Y.prototype.mapReverse=function(b,C){C=C||this;for(var P=new Y,M=this.tail;null!==M;)P.push(b.call(C,M.value,this)),M=M.prev;return P},Y.prototype.reduce=function(b,C){var P,M=this.head;if(arguments.length>1)P=C;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");M=this.head.next,P=this.head.value}for(var v=0;null!==M;v++)P=b(P,M.value,v),M=M.next;return P},Y.prototype.reduceReverse=function(b,C){var P,M=this.tail;if(arguments.length>1)P=C;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");M=this.tail.prev,P=this.tail.value}for(var v=this.length-1;null!==M;v--)P=b(P,M.value,v),M=M.prev;return P},Y.prototype.toArray=function(){for(var b=new Array(this.length),C=0,P=this.head;null!==P;C++)b[C]=P.value,P=P.next;return b},Y.prototype.toArrayReverse=function(){for(var b=new Array(this.length),C=0,P=this.tail;null!==P;C++)b[C]=P.value,P=P.prev;return b},Y.prototype.slice=function(b,C){(C=C||this.length)<0&&(C+=this.length),(b=b||0)<0&&(b+=this.length);var P=new Y;if(C<b||C<0)return P;b<0&&(b=0),C>this.length&&(C=this.length);for(var M=0,v=this.head;null!==v&&M<b;M++)v=v.next;for(;null!==v&&M<C;M++,v=v.next)P.push(v.value);return P},Y.prototype.sliceReverse=function(b,C){(C=C||this.length)<0&&(C+=this.length),(b=b||0)<0&&(b+=this.length);var P=new Y;if(C<b||C<0)return P;b<0&&(b=0),C>this.length&&(C=this.length);for(var M=this.length,v=this.tail;null!==v&&M>C;M--)v=v.prev;for(;null!==v&&M>b;M--,v=v.prev)P.push(v.value);return P},Y.prototype.splice=function(b,C,...P){b>this.length&&(b=this.length-1),b<0&&(b=this.length+b);for(var M=0,v=this.head;null!==v&&M<b;M++)v=v.next;var y=[];for(M=0;v&&M<C;M++)y.push(v.value),v=this.removeNode(v);for(null===v&&(v=this.tail),v!==this.head&&v!==this.tail&&(v=v.prev),M=0;M<P.length;M++)v=U(this,v,P[M]);return y},Y.prototype.reverse=function(){for(var b=this.head,C=this.tail,P=b;null!==P;P=P.prev){var M=P.prev;P.prev=P.next,P.next=M}return this.head=C,this.tail=b,this};try{K("./iterator.js")(Y)}catch(b){}},{"./iterator.js":91}]},{},[1])(1)},322:Vt=>{Vt.exports=function(nt,mt){var J=mt.length;if(0!==J){var Mt=nt.length;nt.length+=J;for(var ht=0;ht<J;ht++)nt[Mt+ht]=mt[ht]}}},517:(Vt,it)=>{"use strict";var mt=(()=>{return(Mt=mt||(mt={})).typeOfFunction="function",Mt.boolTrue=!0,mt;var Mt})();function J(Mt,ht,K){if(!K||typeof K.value!==mt.typeOfFunction)throw new TypeError("Only methods can be decorated with @bind. <"+ht+"> is not a method!");return{configurable:mt.boolTrue,get:function(){var Me=K.value.bind(this);return Object.defineProperty(this,ht,{value:Me,configurable:mt.boolTrue,writable:mt.boolTrue}),Me}}}it.ak=J,it.ZP=J},266:(Vt,it,nt)=>{Vt.exports={ResizeSensor:nt(835),ElementQueries:nt(845)}},845:function(Vt,it,nt){"use strict";var mt,J,Mt;"undefined"!=typeof window&&window,J=[nt(835)],void 0!==(Mt="function"==typeof(mt=function(ht){var K=function(){var pe,Y={},U=[];function k(D){D||(D=document.documentElement);var O=window.getComputedStyle(D,null).fontSize;return parseFloat(O)||16}function W(D,O){var X=O.split(/\d/),E=X[X.length-1];switch(O=parseFloat(O),E){case"px":return O;case"em":return O*k(D);case"rem":return O*k();case"vw":return O*document.documentElement.clientWidth/100;case"vh":return O*document.documentElement.clientHeight/100;case"vmin":case"vmax":var G=document.documentElement.clientWidth/100,Q=document.documentElement.clientHeight/100;return O*(0,Math["vmin"===E?"min":"max"])(G,Q);default:return O}}function b(D,O){this.element=D;var X,E,G,Q,ae,se,ee,xe,me=["min-width","min-height","max-width","max-height"];this.call=function(){for(X in G=function(D){if(!D.getBoundingClientRect)return{width:D.offsetWidth,height:D.offsetHeight};var O=D.getBoundingClientRect();return{width:Math.round(O.width),height:Math.round(O.height)}}(this.element),se={},Y[O])!Y[O].hasOwnProperty(X)||(Q=W(this.element,(E=Y[O][X]).value),ae="width"===E.property?G.width:G.height,ee="","min"===E.mode&&ae>=Q&&(ee+=E.value),"max"===E.mode&&ae<=Q&&(ee+=E.value),se[xe=E.mode+"-"+E.property]||(se[xe]=""),ee&&-1===(" "+se[xe]+" ").indexOf(" "+ee+" ")&&(se[xe]+=" "+ee));for(var te in me)!me.hasOwnProperty(te)||(se[me[te]]?this.element.setAttribute(me[te],se[me[te]].substr(1)):this.element.removeAttribute(me[te]))}}function C(D,O){D.elementQueriesSetupInformation||(D.elementQueriesSetupInformation=new b(D,O)),D.elementQueriesSensor||(D.elementQueriesSensor=new ht(D,function(){D.elementQueriesSetupInformation.call()}))}function P(D,O,X,E){if(void 0===Y[D]){Y[D]=[];var G=U.length;pe.innerHTML+="\n"+D+" {animation: 0.1s element-queries;}",pe.innerHTML+="\n"+D+" > .resize-sensor {min-width: "+G+"px;}",U.push(D)}Y[D].push({mode:O,property:X,value:E})}function M(D){var O;if(document.querySelectorAll&&(O=D?D.querySelectorAll.bind(D):document.querySelectorAll.bind(document)),!O&&"undefined"!=typeof $$&&(O=$$),!O&&"undefined"!=typeof jQuery&&(O=jQuery),!O)throw"No document.querySelectorAll, jQuery or Mootools's $$ found.";return O}function y(D){var O=[],X=[],E=[],G=0,Q=-1,ae=[];for(var se in D.children)if(D.children.hasOwnProperty(se)&&D.children[se].tagName&&"img"===D.children[se].tagName.toLowerCase()){O.push(D.children[se]);var ee=D.children[se].getAttribute("min-width")||D.children[se].getAttribute("data-min-width"),xe=D.children[se].getAttribute("data-src")||D.children[se].getAttribute("url");E.push(xe),X.push({minWidth:ee}),ee?D.children[se].style.display="none":(G=O.length-1,D.children[se].style.display="block")}function te(){var Oe,_e=!1;for(Oe in O)!O.hasOwnProperty(Oe)||X[Oe].minWidth&&D.offsetWidth>X[Oe].minWidth&&(_e=Oe);if(_e||(_e=G),Q!==_e)if(ae[_e])O[Q].style.display="none",O[_e].style.display="block",Q=_e;else{var $e=new Image;$e.onload=function(){O[_e].src=E[_e],O[Q].style.display="none",O[_e].style.display="block",ae[_e]=!0,Q=_e},$e.src=E[_e]}else O[_e].src=E[_e]}Q=G,D.resizeSensorInstance=new ht(D,te),te()}var T=/,?[\s\t]*([^,\n]*?)((?:\[[\s\t]*?(?:min|max)-(?:width|height)[\s\t]*?[~$\^]?=[\s\t]*?"[^"]*?"[\s\t]*?])+)([^,\n\s\{]*)/gim,j=/\[[\s\t]*?(min|max)-(width|height)[\s\t]*?[~$\^]?=[\s\t]*?"([^"]*?)"[\s\t]*?]/gim;function R(D){var O,X,E,G;for(D=D.replace(/'/g,'"');null!==(O=T.exec(D));)for(X=O[1]+O[3],E=O[2];null!==(G=j.exec(E));)P(X,G[1],G[2],G[3])}function q(D){var O="";if(D)if("string"==typeof D)(-1!==(D=D.toLowerCase()).indexOf("min-width")||-1!==D.indexOf("max-width"))&&R(D);else for(var X=0,E=D.length;X<E;X++)1===D[X].type?(-1!==(O=D[X].selectorText||D[X].cssText).indexOf("min-height")||-1!==O.indexOf("max-height")||-1!==O.indexOf("min-width")||-1!==O.indexOf("max-width"))&&R(O):4===D[X].type?q(D[X].cssRules||D[X].rules):3===D[X].type&&D[X].styleSheet.hasOwnProperty("cssRules")&&q(D[X].styleSheet.cssRules)}var ue=!1;this.init=function(){var D="animationstart";void 0!==document.documentElement.style.webkitAnimationName?D="webkitAnimationStart":void 0!==document.documentElement.style.MozAnimationName?D="mozanimationstart":void 0!==document.documentElement.style.OAnimationName&&(D="oanimationstart"),document.body.addEventListener(D,function(E){var G=E.target,Q=G&&window.getComputedStyle(G,null),ae=Q&&Q.getPropertyValue("animation-name");if(ae&&-1!==ae.indexOf("element-queries")){G.elementQueriesSensor=new ht(G,function(){G.elementQueriesSetupInformation&&G.elementQueriesSetupInformation.call()});var xe=window.getComputedStyle(G.resizeSensor,null).getPropertyValue("min-width");xe=parseInt(xe.replace("px","")),C(E.target,U[xe])}}),ue||((pe=document.createElement("style")).type="text/css",pe.innerHTML="[responsive-image] > img, [data-responsive-image] {overflow: hidden; padding: 0; } [responsive-image] > img, [data-responsive-image] > img {width: 100%;}",pe.innerHTML+="\n@keyframes element-queries { 0% { visibility: inherit; } }",document.getElementsByTagName("head")[0].appendChild(pe),ue=!0);for(var O=0,X=document.styleSheets.length;O<X;O++)try{document.styleSheets[O].href&&0===document.styleSheets[O].href.indexOf("file://")&&console.warn("CssElementQueries: unable to parse local css files, "+document.styleSheets[O].href),q(document.styleSheets[O].cssRules||document.styleSheets[O].rules||document.styleSheets[O].cssText)}catch(E){}!function(){for(var O=M()("[data-responsive-image],[responsive-image]"),X=0,E=O.length;X<E;X++)y(O[X])}()},this.findElementQueriesElements=function(D){!function(D){var O=M(D);for(var X in Y)if(Y.hasOwnProperty(X))for(var E=O(X,D),G=0,Q=E.length;G<Q;G++)C(E[G],X)}(D)},this.update=function(){this.init()}};K.update=function(){K.instance.update()},K.detach=function(pe){pe.elementQueriesSetupInformation?(pe.elementQueriesSensor.detach(),delete pe.elementQueriesSetupInformation,delete pe.elementQueriesSensor):pe.resizeSensorInstance&&(pe.resizeSensorInstance.detach(),delete pe.resizeSensorInstance)},K.init=function(){K.instance||(K.instance=new K),K.instance.init()};return K.findElementQueriesElements=function(pe){K.instance.findElementQueriesElements(pe)},K.listen=function(){!function(pe){if(document.addEventListener)document.addEventListener("DOMContentLoaded",pe,!1);else if(/KHTML|WebKit|iCab/i.test(navigator.userAgent))var Y=setInterval(function(){/loaded|complete/i.test(document.readyState)&&(pe(),clearInterval(Y))},10);else window.onload=pe}(K.init)},K})?mt.apply(it,J):mt)&&(Vt.exports=Mt)},835:function(Vt,it,nt){"use strict";var mt,J;"undefined"!=typeof window&&window,void 0!==(J="function"==typeof(mt=function(){if("undefined"==typeof window)return null;var Mt="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),ht=Mt.requestAnimationFrame||Mt.mozRequestAnimationFrame||Mt.webkitRequestAnimationFrame||function(ie){return Mt.setTimeout(ie,20)},K=Mt.cancelAnimationFrame||Mt.mozCancelAnimationFrame||Mt.webkitCancelAnimationFrame||function(ie){Mt.clearTimeout(ie)};function Me(ie,W){var b=Object.prototype.toString.call(ie),C="[object Array]"===b||"[object NodeList]"===b||"[object HTMLCollection]"===b||"[object Object]"===b||"undefined"!=typeof jQuery&&ie instanceof jQuery||"undefined"!=typeof Elements&&ie instanceof Elements,P=0,M=ie.length;if(C)for(;P<M;P++)W(ie[P]);else W(ie)}function pe(ie){if(!ie.getBoundingClientRect)return{width:ie.offsetWidth,height:ie.offsetHeight};var W=ie.getBoundingClientRect();return{width:Math.round(W.width),height:Math.round(W.height)}}function Y(ie,W){Object.keys(W).forEach(function(b){ie.style[b]=W[b]})}var U=function(ie,W){var b=0;function C(){var v,y,M=[];this.add=function(S){M.push(S)},this.call=function(S){for(v=0,y=M.length;v<y;v++)M[v].call(this,S)},this.remove=function(S){var T=[];for(v=0,y=M.length;v<y;v++)M[v]!==S&&T.push(M[v]);M=T},this.length=function(){return M.length}}function P(M,v){if(M){if(M.resizedAttached)return void M.resizedAttached.add(v);M.resizedAttached=new C,M.resizedAttached.add(v),M.resizeSensor=document.createElement("div"),M.resizeSensor.dir="ltr",M.resizeSensor.className="resize-sensor";var y={pointerEvents:"none",position:"absolute",left:"0px",top:"0px",right:"0px",bottom:"0px",overflow:"hidden",zIndex:"-1",visibility:"hidden",maxWidth:"100%"},S={position:"absolute",left:"0px",top:"0px",transition:"0s"};Y(M.resizeSensor,y);var T=document.createElement("div");T.className="resize-sensor-expand",Y(T,y);var j=document.createElement("div");Y(j,S),T.appendChild(j);var R=document.createElement("div");R.className="resize-sensor-shrink",Y(R,y);var q=document.createElement("div");Y(q,S),Y(q,{width:"200%",height:"200%"}),R.appendChild(q),M.resizeSensor.appendChild(T),M.resizeSensor.appendChild(R),M.appendChild(M.resizeSensor);var ue=window.getComputedStyle(M),D=ue?ue.getPropertyValue("position"):null;"absolute"!==D&&"relative"!==D&&"fixed"!==D&&"sticky"!==D&&(M.style.position="relative");var O=!1,X=0,E=pe(M),G=0,Q=0,ae=!0;b=0;var ee=function(){if(ae){if(0===M.offsetWidth&&0===M.offsetHeight)return void(b||(b=ht(function(){b=0,ee()})));ae=!1}var _e,Oe;Oe=M.offsetHeight,j.style.width=(_e=M.offsetWidth)+10+"px",j.style.height=Oe+10+"px",T.scrollLeft=_e+10,T.scrollTop=Oe+10,R.scrollLeft=_e+10,R.scrollTop=Oe+10};M.resizeSensor.resetSensor=ee;var xe=function(){X=0,O&&(G=E.width,Q=E.height,M.resizedAttached&&M.resizedAttached.call(E))},me=function(){E=pe(M),(O=E.width!==G||E.height!==Q)&&!X&&(X=ht(xe)),ee()},te=function(_e,Oe,$e){_e.attachEvent?_e.attachEvent("on"+Oe,$e):_e.addEventListener(Oe,$e)};te(T,"scroll",me),te(R,"scroll",me),b=ht(function(){b=0,ee()})}}Me(ie,function(M){P(M,W)}),this.detach=function(M){b||(K(b),b=0),U.detach(ie,M)},this.reset=function(){ie.resizeSensor.resetSensor()}};if(U.reset=function(ie){Me(ie,function(W){W.resizeSensor.resetSensor()})},U.detach=function(ie,W){Me(ie,function(b){!b||b.resizedAttached&&"function"==typeof W&&(b.resizedAttached.remove(W),b.resizedAttached.length())||b.resizeSensor&&(b.contains(b.resizeSensor)&&b.removeChild(b.resizeSensor),delete b.resizeSensor,delete b.resizedAttached)})},"undefined"!=typeof MutationObserver){var k=new MutationObserver(function(ie){for(var W in ie)if(ie.hasOwnProperty(W))for(var b=ie[W].addedNodes,C=0;C<b.length;C++)b[C].resizeSensor&&U.reset(b[C])});document.addEventListener("DOMContentLoaded",function(ie){k.observe(document.body,{childList:!0,subtree:!0})})}return U})?mt.call(it,nt,it,Vt):mt)&&(Vt.exports=J)},445:(Vt,it,nt)=>{var mt=nt(910),J=nt(369),Mt=nt(322);function ht(ie,W,b){if(!mt(ie))throw new Error("graphology-shortest-path: invalid graphology instance.");if(arguments.length<3)throw new Error("graphology-shortest-path: invalid number of arguments. Expecting at least 3.");if(!ie.hasNode(W))throw new Error('graphology-shortest-path: the "'+W+'" source node does not exist in the given graph.');if(!ie.hasNode(b))throw new Error('graphology-shortest-path: the "'+b+'" target node does not exist in the given graph.');if((W=""+W)==(b=""+b))return[W];var C=ie.inboundNeighbors.bind(ie),P=ie.outboundNeighbors.bind(ie),M={},v={};M[W]=null,v[b]=null;var T,j,R,q,ue,D,O,X,y=[W],S=[b],E=!1;e:for(;y.length&&S.length;)if(y.length<=S.length){for(T=y,y=[],ue=0,O=T.length;ue<O;ue++)for(D=0,X=(R=P(j=T[ue])).length;D<X;D++)if((q=R[D])in M||(y.push(q),M[q]=j),q in v){E=!0;break e}}else for(T=S,S=[],ue=0,O=T.length;ue<O;ue++)for(j=T[ue],R=C(j),D=0,X=R.length;D<X;D++)if(q=R[D],q in v||(S.push(q),v[q]=j),q in M){E=!0;break e}if(!E)return null;for(var G=[];q;)G.unshift(q),q=M[q];for(q=v[G[G.length-1]];q;)G.push(q),q=v[q];return G.length?G:null}function K(ie,W){if(!mt(ie))throw new Error("graphology-shortest-path: invalid graphology instance.");if(arguments.length<2)throw new Error("graphology-shortest-path: invalid number of arguments. Expecting at least 2.");if(!ie.hasNode(W))throw new Error('graphology-shortest-path: the "'+W+'" source node does not exist in the given graph.');var P,M,v,y,S,T,b={},C={};for(b[W=""+W]=!0,C[W]=[W];Object.keys(b).length;)for(v in P=b,b={},P)for(S=0,T=(M=ie.outboundNeighbors(v)).length;S<T;S++)C[y=M[S]]||(C[y]=C[v].concat(y),b[y]=!0);return C}function Me(ie,W,b){if(!mt(W))throw new Error("graphology-shortest-path: invalid graphology instance.");if(!W.hasNode(b))throw new Error('graphology-shortest-path: the "'+b+'" source node does not exist in the given graph.');b=""+b;var C=new Set,P={},M=0;P[b]=0;for(var y,S,T,v=[b];0!==v.length;){var j=[];for(y=0,S=v.length;y<S;y++)!C.has(T=v[y])&&(C.add(T),Mt(j,W[ie](T)),P[T]=M);M++,v=j}return P}var pe=Me.bind(null,"outboundNeighbors"),Y=Me.bind(null,"neighbors");function U(ie,W,b){return arguments.length<3?K(ie,W):ht(ie,W,b)}U.bidirectional=ht,U.singleSource=K,U.singleSourceLength=pe,U.undirectedSingleSourceLength=Y,U.brandes=function(ie,W){W=""+W;var v,y,S,T,j,R,q,ue,D,b=[],C={},P={},M=ie.nodes();for(R=0,ue=M.length;R<ue;R++)C[T=M[R]]=[],P[T]=0;var O={};P[W]=1,O[W]=0;for(var X=J.of(W);X.size;)for(T=X.dequeue(),b.push(T),v=O[T],y=P[T],q=0,D=(S=ie.outboundNeighbors(T)).length;q<D;q++)(j=S[q])in O||(X.enqueue(j),O[j]=v+1),O[j]===v+1&&(P[j]+=y,C[j].push(T));return[b,C,P]},Vt.exports=U},910:Vt=>{Vt.exports=function(nt){return null!==nt&&"object"==typeof nt&&"function"==typeof nt.addUndirectedEdgeWithKey&&"function"==typeof nt.dropNode&&"boolean"==typeof nt.multi}},698:function(Vt){Vt.exports=function(){"use strict";function it(ne){return(it="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(he){return typeof he}:function(he){return he&&"function"==typeof Symbol&&he.constructor===Symbol&&he!==Symbol.prototype?"symbol":typeof he})(ne)}function nt(ne,he){ne.prototype=Object.create(he.prototype),ne.prototype.constructor=ne,J(ne,he)}function mt(ne){return(mt=Object.setPrototypeOf?Object.getPrototypeOf:function(he){return he.__proto__||Object.getPrototypeOf(he)})(ne)}function J(ne,he){return(J=Object.setPrototypeOf||function(re,A){return re.__proto__=A,re})(ne,he)}function Mt(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(ne){return!1}}function ht(ne,he,re){return(ht=Mt()?Reflect.construct:function(A,L,Z){var we=[null];we.push.apply(we,L);var Fe=new(Function.bind.apply(A,we));return Z&&J(Fe,Z.prototype),Fe}).apply(null,arguments)}function K(ne){var he="function"==typeof Map?new Map:void 0;return(K=function(re){if(null===re||-1===Function.toString.call(re).indexOf("[native code]"))return re;if("function"!=typeof re)throw new TypeError("Super expression must either be null or a function");if(void 0!==he){if(he.has(re))return he.get(re);he.set(re,L)}function L(){return ht(re,arguments,mt(this).constructor)}return L.prototype=Object.create(re.prototype,{constructor:{value:L,enumerable:!1,writable:!0,configurable:!0}}),J(L,re)})(ne)}function Me(ne){if(void 0===ne)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ne}var pe=function(){for(var ne=arguments[0],he=1,re=arguments.length;he<re;he++)if(arguments[he])for(var A in arguments[he])ne[A]=arguments[he][A];return ne};function Y(ne,he,re,A){var L=ne._nodes.get(he),Z=null;return L?Z="mixed"===A?L.out&&L.out[re]||L.undirected&&L.undirected[re]:"directed"===A?L.out&&L.out[re]:L.undirected&&L.undirected[re]:Z}function U(ne){return null!==ne&&"object"===it(ne)&&"function"==typeof ne.addUndirectedEdgeWithKey&&"function"==typeof ne.dropNode}function k(ne){return"object"===it(ne)&&null!==ne&&ne.constructor===Object}function ie(ne){var he;for(he in ne)return!1;return!0}function W(ne,he,re){Object.defineProperty(ne,he,{enumerable:!1,configurable:!1,writable:!0,value:re})}function b(ne,he,re){var A={enumerable:!0,configurable:!0};"function"==typeof re?A.get=re:(A.value=re,A.writable=!1),Object.defineProperty(ne,he,A)}function C(ne){return!(!k(ne)||ne.attributes&&!Array.isArray(ne.attributes))}"function"==typeof Object.assign&&(pe=Object.assign);var P,M={exports:{}},v="object"==typeof Reflect?Reflect:null,y=v&&"function"==typeof v.apply?v.apply:function(ne,he,re){return Function.prototype.apply.call(ne,he,re)};P=v&&"function"==typeof v.ownKeys?v.ownKeys:Object.getOwnPropertySymbols?function(ne){return Object.getOwnPropertyNames(ne).concat(Object.getOwnPropertySymbols(ne))}:function(ne){return Object.getOwnPropertyNames(ne)};var S=Number.isNaN||function(ne){return ne!=ne};function T(){T.init.call(this)}M.exports=T,M.exports.once=function(ne,he){return new Promise(function(re,A){function L(we){ne.removeListener(he,Z),A(we)}function Z(){"function"==typeof ne.removeListener&&ne.removeListener("error",L),re([].slice.call(arguments))}var we;Q(ne,he,Z,{once:!0}),"error"!==he&&("function"==typeof(we=ne).on&&Q(we,"error",L,{once:!0}))})},T.EventEmitter=T,T.prototype._events=void 0,T.prototype._eventsCount=0,T.prototype._maxListeners=void 0;var j=10;function R(ne){if("function"!=typeof ne)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof ne)}function q(ne){return void 0===ne._maxListeners?T.defaultMaxListeners:ne._maxListeners}function ue(ne,he,re,A){var L,Z,we;if(R(re),void 0===(Z=ne._events)?(Z=ne._events=Object.create(null),ne._eventsCount=0):(void 0!==Z.newListener&&(ne.emit("newListener",he,re.listener?re.listener:re),Z=ne._events),we=Z[he]),void 0===we)we=Z[he]=re,++ne._eventsCount;else if("function"==typeof we?we=Z[he]=A?[re,we]:[we,re]:A?we.unshift(re):we.push(re),(L=q(ne))>0&&we.length>L&&!we.warned){we.warned=!0;var tt=new Error("Possible EventEmitter memory leak detected. "+we.length+" "+String(he)+" listeners added. Use emitter.setMaxListeners() to increase limit");tt.name="MaxListenersExceededWarning",tt.emitter=ne,tt.type=he,tt.count=we.length,console&&console.warn&&console.warn(tt)}return ne}function D(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function O(ne,he,re){var A={fired:!1,wrapFn:void 0,target:ne,type:he,listener:re},L=D.bind(A);return L.listener=re,A.wrapFn=L,L}function X(ne,he,re){var A=ne._events;if(void 0===A)return[];var L=A[he];return void 0===L?[]:"function"==typeof L?re?[L.listener||L]:[L]:re?function(Z){for(var we=new Array(Z.length),Fe=0;Fe<we.length;++Fe)we[Fe]=Z[Fe].listener||Z[Fe];return we}(L):G(L,L.length)}function E(ne){var he=this._events;if(void 0!==he){var re=he[ne];if("function"==typeof re)return 1;if(void 0!==re)return re.length}return 0}function G(ne,he){for(var re=new Array(he),A=0;A<he;++A)re[A]=ne[A];return re}function Q(ne,he,re,A){if("function"==typeof ne.on)A.once?ne.once(he,re):ne.on(he,re);else{if("function"!=typeof ne.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof ne);ne.addEventListener(he,function L(Z){A.once&&ne.removeEventListener(he,L),re(Z)})}}function ae(ne){Object.defineProperty(this,"_next",{writable:!1,enumerable:!1,value:ne}),this.done=!1}Object.defineProperty(T,"defaultMaxListeners",{enumerable:!0,get:function(){return j},set:function(ne){if("number"!=typeof ne||ne<0||S(ne))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+ne+".");j=ne}}),T.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},T.prototype.setMaxListeners=function(ne){if("number"!=typeof ne||ne<0||S(ne))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+ne+".");return this._maxListeners=ne,this},T.prototype.getMaxListeners=function(){return q(this)},T.prototype.emit=function(ne){for(var he=[],re=1;re<arguments.length;re++)he.push(arguments[re]);var A="error"===ne,L=this._events;if(void 0!==L)A=A&&void 0===L.error;else if(!A)return!1;if(A){var Z;if(he.length>0&&(Z=he[0]),Z instanceof Error)throw Z;var we=new Error("Unhandled error."+(Z?" ("+Z.message+")":""));throw we.context=Z,we}var Fe=L[ne];if(void 0===Fe)return!1;if("function"==typeof Fe)y(Fe,this,he);else{var tt=Fe.length,Ot=G(Fe,tt);for(re=0;re<tt;++re)y(Ot[re],this,he)}return!0},T.prototype.on=T.prototype.addListener=function(ne,he){return ue(this,ne,he,!1)},T.prototype.prependListener=function(ne,he){return ue(this,ne,he,!0)},T.prototype.once=function(ne,he){return R(he),this.on(ne,O(this,ne,he)),this},T.prototype.prependOnceListener=function(ne,he){return R(he),this.prependListener(ne,O(this,ne,he)),this},T.prototype.off=T.prototype.removeListener=function(ne,he){var re,A,L,Z,we;if(R(he),void 0===(A=this._events))return this;if(void 0===(re=A[ne]))return this;if(re===he||re.listener===he)0==--this._eventsCount?this._events=Object.create(null):(delete A[ne],A.removeListener&&this.emit("removeListener",ne,re.listener||he));else if("function"!=typeof re){for(L=-1,Z=re.length-1;Z>=0;Z--)if(re[Z]===he||re[Z].listener===he){we=re[Z].listener,L=Z;break}if(L<0)return this;0===L?re.shift():function(Fe,tt){for(;tt+1<Fe.length;tt++)Fe[tt]=Fe[tt+1];Fe.pop()}(re,L),1===re.length&&(A[ne]=re[0]),void 0!==A.removeListener&&this.emit("removeListener",ne,we||he)}return this},T.prototype.removeAllListeners=function(ne){var he,re,A;if(void 0===(re=this._events))return this;if(void 0===re.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==re[ne]&&(0==--this._eventsCount?this._events=Object.create(null):delete re[ne]),this;if(0===arguments.length){var L,Z=Object.keys(re);for(A=0;A<Z.length;++A)"removeListener"!==(L=Z[A])&&this.removeAllListeners(L);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(he=re[ne]))this.removeListener(ne,he);else if(void 0!==he)for(A=he.length-1;A>=0;A--)this.removeListener(ne,he[A]);return this},T.prototype.listeners=function(ne){return X(this,ne,!0)},T.prototype.rawListeners=function(ne){return X(this,ne,!1)},T.listenerCount=function(ne,he){return"function"==typeof ne.listenerCount?ne.listenerCount(he):E.call(ne,he)},T.prototype.listenerCount=E,T.prototype.eventNames=function(){return this._eventsCount>0?P(this._events):[]},ae.prototype.next=function(){if(this.done)return{done:!0};var ne=this._next();return ne.done&&(this.done=!0),ne},"undefined"!=typeof Symbol&&(ae.prototype[Symbol.iterator]=function(){return this}),ae.of=function(){var ne=arguments,he=ne.length,re=0;return new ae(function(){return re>=he?{done:!0}:{done:!1,value:ne[re++]}})},ae.empty=function(){var ne=new ae(null);return ne.done=!0,ne},ae.is=function(ne){return ne instanceof ae||"object"==typeof ne&&null!==ne&&"function"==typeof ne.next};var se=ae,ee=function(ne,he){for(var re,A=arguments.length>1?he:1/0,L=A!==1/0?new Array(A):[],Z=0;;){if(Z===A)return L;if((re=ne.next()).done)return Z!==he?L.slice(0,Z):L;L[Z++]=re.value}},xe=function(ne){function he(re,A){var L;return(L=ne.call(this)||this).name="GraphError",L.message=re||"",L.data=A||{},L}return nt(he,ne),he}(K(Error)),me=function(ne){function he(re,A){var L;return(L=ne.call(this,re,A)||this).name="InvalidArgumentsGraphError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(Me(L),he.prototype.constructor),L}return nt(he,ne),he}(xe),te=function(ne){function he(re,A){var L;return(L=ne.call(this,re,A)||this).name="NotFoundGraphError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(Me(L),he.prototype.constructor),L}return nt(he,ne),he}(xe),_e=function(ne){function he(re,A){var L;return(L=ne.call(this,re,A)||this).name="UsageGraphError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(Me(L),he.prototype.constructor),L}return nt(he,ne),he}(xe);function Oe(ne,he){this.key=ne,this.attributes=he,this.inDegree=0,this.outDegree=0,this.undirectedDegree=0,this.directedSelfLoops=0,this.undirectedSelfLoops=0,this.in={},this.out={},this.undirected={}}function $e(ne,he){this.key=ne,this.attributes=he,this.inDegree=0,this.outDegree=0,this.directedSelfLoops=0,this.in={},this.out={}}function st(ne,he){this.key=ne,this.attributes=he,this.undirectedDegree=0,this.undirectedSelfLoops=0,this.undirected={}}function Qe(ne,he,re,A,L,Z){this.key=he,this.attributes=Z,this.undirected=ne,this.source=A,this.target=L,this.generatedKey=re}function et(ne,he,re,A,L,Z,we){var Fe,tt,Ot="out",We="in";if(he&&(Ot=We="undirected"),ne.multi){if(void 0===(tt=(Fe=Z[Ot])[L])&&(tt=new Set,Fe[L]=tt),tt.add(re),A===L&&he)return;void 0===(Fe=we[We])[A]&&(Fe[A]=tt)}else{if(Z[Ot][L]=re,A===L&&he)return;we[We][A]=re}}function Ke(ne,he,re){var A=ne.multi,L=re.source,Z=re.target,we=L.key,Fe=Z.key,tt=L[he?"undirected":"out"],Ot=he?"undirected":"in";if(Fe in tt)if(A){var We=tt[Fe];1===We.size?(delete tt[Fe],delete Z[Ot][we]):We.delete(re)}else delete tt[Fe];A||delete Z[Ot][we]}$e.prototype.upgradeToMixed=function(){this.undirectedDegree=0,this.undirectedSelfLoops=0,this.undirected={}},st.prototype.upgradeToMixed=function(){this.inDegree=0,this.outDegree=0,this.directedSelfLoops=0,this.in={},this.out={}};var Ue=[{name:function(ne){return"get".concat(ne,"Attribute")},attacher:function(ne,he,re){ne.prototype[he]=function(A,L){var Z;if("mixed"!==this.type&&"mixed"!==re&&re!==this.type)throw new _e("Graph.".concat(he,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new _e("Graph.".concat(he,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var we=""+A,Fe=""+L;if(L=arguments[2],!(Z=Y(this,we,Fe,re)))throw new te("Graph.".concat(he,': could not find an edge for the given path ("').concat(we,'" - "').concat(Fe,'").'))}else if(!(Z=this._edges.get(A=""+A)))throw new te("Graph.".concat(he,': could not find the "').concat(A,'" edge in the graph.'));if("mixed"!==re&&Z.undirected!==("undirected"===re))throw new te("Graph.".concat(he,': could not find the "').concat(A,'" ').concat(re," edge in the graph."));return Z.attributes[L]}}},{name:function(ne){return"get".concat(ne,"Attributes")},attacher:function(ne,he,re){ne.prototype[he]=function(A){var L;if("mixed"!==this.type&&"mixed"!==re&&re!==this.type)throw new _e("Graph.".concat(he,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>1){if(this.multi)throw new _e("Graph.".concat(he,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var Z=""+A,we=""+arguments[1];if(!(L=Y(this,Z,we,re)))throw new te("Graph.".concat(he,': could not find an edge for the given path ("').concat(Z,'" - "').concat(we,'").'))}else if(!(L=this._edges.get(A=""+A)))throw new te("Graph.".concat(he,': could not find the "').concat(A,'" edge in the graph.'));if("mixed"!==re&&L.undirected!==("undirected"===re))throw new te("Graph.".concat(he,': could not find the "').concat(A,'" ').concat(re," edge in the graph."));return L.attributes}}},{name:function(ne){return"has".concat(ne,"Attribute")},attacher:function(ne,he,re){ne.prototype[he]=function(A,L){var Z;if("mixed"!==this.type&&"mixed"!==re&&re!==this.type)throw new _e("Graph.".concat(he,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new _e("Graph.".concat(he,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var we=""+A,Fe=""+L;if(L=arguments[2],!(Z=Y(this,we,Fe,re)))throw new te("Graph.".concat(he,': could not find an edge for the given path ("').concat(we,'" - "').concat(Fe,'").'))}else if(!(Z=this._edges.get(A=""+A)))throw new te("Graph.".concat(he,': could not find the "').concat(A,'" edge in the graph.'));if("mixed"!==re&&Z.undirected!==("undirected"===re))throw new te("Graph.".concat(he,': could not find the "').concat(A,'" ').concat(re," edge in the graph."));return Z.attributes.hasOwnProperty(L)}}},{name:function(ne){return"set".concat(ne,"Attribute")},attacher:function(ne,he,re){ne.prototype[he]=function(A,L,Z){var we;if("mixed"!==this.type&&"mixed"!==re&&re!==this.type)throw new _e("Graph.".concat(he,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>3){if(this.multi)throw new _e("Graph.".concat(he,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var Fe=""+A,tt=""+L;if(L=arguments[2],Z=arguments[3],!(we=Y(this,Fe,tt,re)))throw new te("Graph.".concat(he,': could not find an edge for the given path ("').concat(Fe,'" - "').concat(tt,'").'))}else if(!(we=this._edges.get(A=""+A)))throw new te("Graph.".concat(he,': could not find the "').concat(A,'" edge in the graph.'));if("mixed"!==re&&we.undirected!==("undirected"===re))throw new te("Graph.".concat(he,': could not find the "').concat(A,'" ').concat(re," edge in the graph."));return we.attributes[L]=Z,this.emit("edgeAttributesUpdated",{key:we.key,type:"set",attributes:we.attributes,name:L}),this}}},{name:function(ne){return"update".concat(ne,"Attribute")},attacher:function(ne,he,re){ne.prototype[he]=function(A,L,Z){var we;if("mixed"!==this.type&&"mixed"!==re&&re!==this.type)throw new _e("Graph.".concat(he,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>3){if(this.multi)throw new _e("Graph.".concat(he,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var Fe=""+A,tt=""+L;if(L=arguments[2],Z=arguments[3],!(we=Y(this,Fe,tt,re)))throw new te("Graph.".concat(he,': could not find an edge for the given path ("').concat(Fe,'" - "').concat(tt,'").'))}else if(!(we=this._edges.get(A=""+A)))throw new te("Graph.".concat(he,': could not find the "').concat(A,'" edge in the graph.'));if("function"!=typeof Z)throw new me("Graph.".concat(he,": updater should be a function."));if("mixed"!==re&&we.undirected!==("undirected"===re))throw new te("Graph.".concat(he,': could not find the "').concat(A,'" ').concat(re," edge in the graph."));return we.attributes[L]=Z(we.attributes[L]),this.emit("edgeAttributesUpdated",{key:we.key,type:"set",attributes:we.attributes,name:L}),this}}},{name:function(ne){return"remove".concat(ne,"Attribute")},attacher:function(ne,he,re){ne.prototype[he]=function(A,L){var Z;if("mixed"!==this.type&&"mixed"!==re&&re!==this.type)throw new _e("Graph.".concat(he,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new _e("Graph.".concat(he,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var we=""+A,Fe=""+L;if(L=arguments[2],!(Z=Y(this,we,Fe,re)))throw new te("Graph.".concat(he,': could not find an edge for the given path ("').concat(we,'" - "').concat(Fe,'").'))}else if(!(Z=this._edges.get(A=""+A)))throw new te("Graph.".concat(he,': could not find the "').concat(A,'" edge in the graph.'));if("mixed"!==re&&Z.undirected!==("undirected"===re))throw new te("Graph.".concat(he,': could not find the "').concat(A,'" ').concat(re," edge in the graph."));return delete Z.attributes[L],this.emit("edgeAttributesUpdated",{key:Z.key,type:"remove",attributes:Z.attributes,name:L}),this}}},{name:function(ne){return"replace".concat(ne,"Attributes")},attacher:function(ne,he,re){ne.prototype[he]=function(A,L){var Z;if("mixed"!==this.type&&"mixed"!==re&&re!==this.type)throw new _e("Graph.".concat(he,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new _e("Graph.".concat(he,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var we=""+A,Fe=""+L;if(L=arguments[2],!(Z=Y(this,we,Fe,re)))throw new te("Graph.".concat(he,': could not find an edge for the given path ("').concat(we,'" - "').concat(Fe,'").'))}else if(!(Z=this._edges.get(A=""+A)))throw new te("Graph.".concat(he,': could not find the "').concat(A,'" edge in the graph.'));if(!k(L))throw new me("Graph.".concat(he,": provided attributes are not a plain object."));if("mixed"!==re&&Z.undirected!==("undirected"===re))throw new te("Graph.".concat(he,': could not find the "').concat(A,'" ').concat(re," edge in the graph."));return Z.attributes=L,this.emit("edgeAttributesUpdated",{key:Z.key,type:"replace",attributes:Z.attributes}),this}}},{name:function(ne){return"merge".concat(ne,"Attributes")},attacher:function(ne,he,re){ne.prototype[he]=function(A,L){var Z;if("mixed"!==this.type&&"mixed"!==re&&re!==this.type)throw new _e("Graph.".concat(he,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new _e("Graph.".concat(he,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var we=""+A,Fe=""+L;if(L=arguments[2],!(Z=Y(this,we,Fe,re)))throw new te("Graph.".concat(he,': could not find an edge for the given path ("').concat(we,'" - "').concat(Fe,'").'))}else if(!(Z=this._edges.get(A=""+A)))throw new te("Graph.".concat(he,': could not find the "').concat(A,'" edge in the graph.'));if(!k(L))throw new me("Graph.".concat(he,": provided attributes are not a plain object."));if("mixed"!==re&&Z.undirected!==("undirected"===re))throw new te("Graph.".concat(he,': could not find the "').concat(A,'" ').concat(re," edge in the graph."));return pe(Z.attributes,L),this.emit("edgeAttributesUpdated",{key:Z.key,type:"merge",attributes:Z.attributes,data:L}),this}}}],Le=se,Xe=function(){var ne,he=arguments,re=-1;return new Le(function A(){if(!ne){if(++re>=he.length)return{done:!0};ne=he[re]}var L=ne.next();return L.done?(ne=null,A()):L})},Te=[{name:"edges",type:"mixed"},{name:"inEdges",type:"directed",direction:"in"},{name:"outEdges",type:"directed",direction:"out"},{name:"inboundEdges",type:"mixed",direction:"in"},{name:"outboundEdges",type:"mixed",direction:"out"},{name:"directedEdges",type:"directed"},{name:"undirectedEdges",type:"undirected"}];function je(ne,he){for(var re in he)ne.push(he[re].key)}function qe(ne,he){for(var re in he)he[re].forEach(function(A){return ne.push(A.key)})}function Ne(ne,he,re){for(var A in ne)if(A!==re){var L=ne[A];he(L.key,L.attributes,L.source.key,L.target.key,L.source.attributes,L.target.attributes,L.undirected,L.generatedKey)}}function $(ne,he,re){for(var A in ne)A!==re&&ne[A].forEach(function(L){return he(L.key,L.attributes,L.source.key,L.target.key,L.source.attributes,L.target.attributes,L.undirected,L.generatedKey)})}function z(ne,he,re){for(var A in ne)if(A!==re){var L=ne[A];if(he(L.key,L.attributes,L.source.key,L.target.key,L.source.attributes,L.target.attributes,L.undirected,L.generatedKey))return!0}return!1}function fe(ne,he,re){var A,L,Z,we,Fe;for(var tt in ne)if(tt!==re)for(A=ne[tt].values();!0!==(L=A.next()).done;)if(we=(Z=L.value).source,he(Z.key,Z.attributes,we.key,(Fe=Z.target).key,we.attributes,Fe.attributes,Z.undirected,Z.generatedKey))return!0;return!1}function de(ne,he){var re=Object.keys(ne),A=re.length,L=null,Z=0;return new se(function we(){var Fe;if(L){var tt=L.next();if(tt.done)return L=null,Z++,we();Fe=tt.value}else{if(Z>=A)return{done:!0};var Ot=re[Z];if(Ot===he)return Z++,we();if((Fe=ne[Ot])instanceof Set)return L=Fe.values(),we();Z++}return{done:!1,value:[Fe.key,Fe.attributes,Fe.source.key,Fe.target.key,Fe.source.attributes,Fe.target.attributes]}})}function Ve(ne,he,re){var A=he[re];A&&ne.push(A.key)}function gt(ne,he,re){var A=he[re];A&&A.forEach(function(L){return ne.push(L.key)})}function ft(ne,he,re){var A=ne[he];if(A){var L=A.source,Z=A.target;re(A.key,A.attributes,L.key,Z.key,L.attributes,Z.attributes,A.undirected,A.generatedKey)}}function be(ne,he,re){var A=ne[he];A&&A.forEach(function(L){return re(L.key,L.attributes,L.source.key,L.target.key,L.source.attributes,L.target.attributes,L.undirected,L.generatedKey)})}function B(ne,he,re){var A=ne[he];if(A){var L=A.source,Z=A.target;return re(A.key,A.attributes,L.key,Z.key,L.attributes,Z.attributes,A.undirected,A.generatedKey)}}function N(ne,he,re){var A=ne[he];if(A){for(var L,Z,we=A.values();!0!==(L=we.next()).done;)if(re((Z=L.value).key,Z.attributes,Z.source.key,Z.target.key,Z.source.attributes,Z.target.attributes,Z.undirected,Z.generatedKey))return!0;return!1}}function V(ne,he){var re=ne[he];if(re instanceof Set){var A=re.values();return new se(function(){var L=A.next();if(L.done)return L;var Z=L.value;return{done:!1,value:[Z.key,Z.attributes,Z.source.key,Z.target.key,Z.source.attributes,Z.target.attributes]}})}return se.of([re.key,re.attributes,re.source.key,re.target.key,re.source.attributes,re.target.attributes])}function Re(ne,he){if(0===ne.size)return[];if("mixed"===he||he===ne.type)return"function"==typeof Array.from?Array.from(ne._edges.keys()):ee(ne._edges.keys(),ne._edges.size);for(var re,A,Z=new Array("undirected"===he?ne.undirectedSize:ne.directedSize),we="undirected"===he,Fe=ne._edges.values(),tt=0;!0!==(re=Fe.next()).done;)(A=re.value).undirected===we&&(Z[tt++]=A.key);return Z}function Ze(ne,he,re){if(0!==ne.size)for(var A,L,Z="mixed"!==he&&he!==ne.type,we="undirected"===he,Fe=ne._edges.values();!0!==(A=Fe.next()).done;)if(L=A.value,!Z||L.undirected===we){var Gt=L.source,wt=L.target;re(L.key,L.attributes,Gt.key,wt.key,Gt.attributes,wt.attributes,L.undirected,L.generatedKey)}}function bt(ne,he,re){if(0!==ne.size)for(var A,L,Z="mixed"!==he&&he!==ne.type,we="undirected"===he,Fe=ne._edges.values();!0!==(A=Fe.next()).done;)if(L=A.value,!Z||L.undirected===we){var Gt=L.source,wt=L.target;if(re(L.key,L.attributes,Gt.key,wt.key,Gt.attributes,wt.attributes,L.undirected,L.generatedKey))break}}function Rt(ne,he){if(0===ne.size)return se.empty();var re="mixed"!==he&&he!==ne.type,A="undirected"===he,L=ne._edges.values();return new se(function(){for(var Z,we;;){if((Z=L.next()).done)return Z;if(we=Z.value,!re||we.undirected===A)break}return{value:[we.key,we.attributes,we.source.key,we.target.key,we.source.attributes,we.target.attributes],done:!1}})}function Mn(ne,he,re,A){var L=[],Z=ne?qe:je;return"undirected"!==he&&("out"!==re&&Z(L,A.in),"in"!==re&&Z(L,A.out),!re&&A.directedSelfLoops>0&&L.splice(L.lastIndexOf(A.key),1)),"directed"!==he&&Z(L,A.undirected),L}function Nn(ne,he,re,A,L){var Z=ne?$:Ne;"undirected"!==he&&("out"!==re&&Z(A.in,L),"in"!==re&&Z(A.out,L,re?null:A.key)),"directed"!==he&&Z(A.undirected,L)}function Gn(ne,he,re,A,L){var Z=ne?fe:z;"undirected"!==he&&("out"!==re&&Z(A.in,L)||"in"!==re&&Z(A.out,L,re?null:A.key))||"directed"===he||Z(A.undirected,L)}function wi(ne,he,re){var A=se.empty();return"undirected"!==ne&&("out"!==he&&void 0!==re.in&&(A=Xe(A,de(re.in))),"in"!==he&&void 0!==re.out&&(A=Xe(A,de(re.out,he?null:re.key)))),"directed"!==ne&&void 0!==re.undirected&&(A=Xe(A,de(re.undirected))),A}function pi(ne,he,re,A,L){var Z=he?gt:Ve,we=[];return"undirected"!==ne&&(void 0!==A.in&&"out"!==re&&Z(we,A.in,L),void 0!==A.out&&"in"!==re&&Z(we,A.out,L),!re&&A.directedSelfLoops>0&&we.splice(we.lastIndexOf(A.key),1)),"directed"!==ne&&void 0!==A.undirected&&Z(we,A.undirected,L),we}function Wr(ne,he,re,A,L,Z){var we=he?be:ft;"undirected"!==ne&&(void 0!==A.in&&"out"!==re&&we(A.in,L,Z),A.key!==L&&void 0!==A.out&&"in"!==re&&we(A.out,L,Z)),"directed"!==ne&&void 0!==A.undirected&&we(A.undirected,L,Z)}function Ls(ne,he,re,A,L,Z){var we=he?N:B;"undirected"!==ne&&(void 0!==A.in&&"out"!==re&&we(A.in,L,Z)||A.key!==L&&void 0!==A.out&&"in"!==re&&we(A.out,L,Z,re?null:A.key))||"directed"===ne||void 0===A.undirected||we(A.undirected,L,Z)}function fs(ne,he,re,A){var L=se.empty();return"undirected"!==ne&&(void 0!==re.in&&"out"!==he&&A in re.in&&(L=Xe(L,V(re.in,A))),void 0!==re.out&&"in"!==he&&A in re.out&&(L=Xe(L,V(re.out,A)))),"directed"!==ne&&void 0!==re.undirected&&A in re.undirected&&(L=Xe(L,V(re.undirected,A))),L}var ks=[{name:"neighbors",type:"mixed"},{name:"inNeighbors",type:"directed",direction:"in"},{name:"outNeighbors",type:"directed",direction:"out"},{name:"inboundNeighbors",type:"mixed",direction:"in"},{name:"outboundNeighbors",type:"mixed",direction:"out"},{name:"directedNeighbors",type:"directed"},{name:"undirectedNeighbors",type:"undirected"}];function qr(ne,he){if(void 0!==he)for(var re in he)ne.add(re)}function _a(ne,he,re){if("mixed"!==ne){if("undirected"===ne)return Object.keys(re.undirected);if("string"==typeof he)return Object.keys(re[he])}var A=new Set;return"undirected"!==ne&&("out"!==he&&qr(A,re.in),"in"!==he&&qr(A,re.out)),"directed"!==ne&&qr(A,re.undirected),ee(A.values(),A.size)}function Dl(ne,he,re){for(var A in he){var L=he[A];L instanceof Set&&(L=L.values().next().value);var Z=L.source,Fe=Z===ne?L.target:Z;re(Fe.key,Fe.attributes)}}function ya(ne,he,re,A){for(var L in re){var Z=re[L];Z instanceof Set&&(Z=Z.values().next().value);var we=Z.source,tt=we===he?Z.target:we;ne.has(tt.key)||(ne.add(tt.key),A(tt.key,tt.attributes))}}function bs(ne,he,re){for(var A in he){var L=he[A];L instanceof Set&&(L=L.values().next().value);var Z=L.source,Fe=Z===ne?L.target:Z;if(re(Fe.key,Fe.attributes))return!0}return!1}function Jt(ne,he,re,A){for(var L in re){var Z=re[L];Z instanceof Set&&(Z=Z.values().next().value);var we=Z.source,tt=we===he?Z.target:we;if(!ne.has(tt.key)&&(ne.add(tt.key),A(tt.key,tt.attributes)))return!0}return!1}function Xa(ne,he){var re=Object.keys(he),A=re.length,L=0;return new se(function(){if(L>=A)return{done:!0};var Z=he[re[L++]];Z instanceof Set&&(Z=Z.values().next().value);var we=Z.source,tt=we===ne?Z.target:we;return{done:!1,value:[tt.key,tt.attributes]}})}function rt(ne,he,re){var A=Object.keys(re),L=A.length,Z=0;return new se(function we(){if(Z>=L)return{done:!0};var Fe=re[A[Z++]];Fe instanceof Set&&(Fe=Fe.values().next().value);var tt=Fe.source,We=tt===he?Fe.target:tt;return ne.has(We.key)?we():(ne.add(We.key),{done:!1,value:[We.key,We.attributes]})})}function at(ne,he,re,A,L){var Z=ne._nodes.get(A);if("undirected"!==he){if("out"!==re&&void 0!==Z.in)for(var we in Z.in)if(we===L)return!0;if("in"!==re&&void 0!==Z.out)for(var Fe in Z.out)if(Fe===L)return!0}if("directed"!==he&&void 0!==Z.undirected)for(var tt in Z.undirected)if(tt===L)return!0;return!1}function ke(ne,he,re){for(var A,L,Z,we,Fe,tt,Ot,We=he._nodes.values(),Gt=he.type;!0!==(A=We.next()).done;){if(L=A.value,"undirected"!==Gt)for(Z in we=L.out)if(tt=(Fe=we[Z]).target,Ot=re(L.key,tt.key,L.attributes,tt.attributes,Fe.key,Fe.attributes,Fe.undirected,Fe.generatedKey),ne&&Ot)return;if("directed"!==Gt)for(Z in we=L.undirected)if((tt=(Fe=we[Z]).target).key!==Z&&(tt=Fe.source),Ot=re(L.key,tt.key,L.attributes,tt.attributes,Fe.key,Fe.attributes,Fe.undirected,Fe.generatedKey),ne&&Ot)return}}function ct(ne,he,re){for(var A,L,Z,we,Fe,tt,Ot,We,Gt,wt=he._nodes.values(),_n=he.type;!0!==(A=wt.next()).done;){if(L=A.value,"undirected"!==_n)for(Z in tt=L.out)for(we=tt[Z].values();!0!==(Fe=we.next()).done;)if(We=(Ot=Fe.value).target,Gt=re(L.key,We.key,L.attributes,We.attributes,Ot.key,Ot.attributes,Ot.undirected,Ot.generatedKey),ne&&Gt)return;if("directed"!==_n)for(Z in tt=L.undirected)for(we=tt[Z].values();!0!==(Fe=we.next()).done;)if((We=(Ot=Fe.value).target).key!==Z&&(We=Ot.source),Gt=re(L.key,We.key,L.attributes,We.attributes,Ot.key,Ot.attributes,Ot.undirected,Ot.generatedKey),ne&&Gt)return}}function Je(ne,he){var re={key:ne};return ie(he.attributes)||(re.attributes=pe({},he.attributes)),re}function Et(ne,he){var re={source:he.source.key,target:he.target.key};return he.generatedKey||(re.key=ne),ie(he.attributes)||(re.attributes=pe({},he.attributes)),he.undirected&&(re.undirected=!0),re}function Tt(ne){return k(ne)?"key"in ne?!("attributes"in ne)||k(ne.attributes)&&null!==ne.attributes?null:"invalid-attributes":"no-key":"not-object"}function Dt(ne){return k(ne)?"source"in ne?"target"in ne?!("attributes"in ne)||k(ne.attributes)&&null!==ne.attributes?"undirected"in ne&&"boolean"!=typeof ne.undirected?"invalid-undirected":null:"invalid-attributes":"no-target":"no-source":"not-object"}var Yt=new Set(["directed","undirected","mixed"]),jn=new Set(["domain","_events","_eventsCount","_maxListeners"]),ri={allowSelfLoops:!0,edgeKeyGenerator:null,multi:!1,type:"mixed"};function On(ne,he,re){var A=new ne.NodeDataClass(he,re);return ne._nodes.set(he,A),ne.emit("nodeAdded",{key:he,attributes:re}),A}function mn(ne,he,re,A,L,Z,we,Fe){if(!A&&"undirected"===ne.type)throw new _e("Graph.".concat(he,": you cannot add a directed edge to an undirected graph. Use the #.addEdge or #.addUndirectedEdge instead."));if(A&&"directed"===ne.type)throw new _e("Graph.".concat(he,": you cannot add an undirected edge to a directed graph. Use the #.addEdge or #.addDirectedEdge instead."));if(Fe&&!k(Fe))throw new me("Graph.".concat(he,': invalid attributes. Expecting an object but got "').concat(Fe,'"'));if(Z=""+Z,we=""+we,Fe=Fe||{},!ne.allowSelfLoops&&Z===we)throw new _e("Graph.".concat(he,': source & target are the same ("').concat(Z,"\"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false."));var tt=ne._nodes.get(Z),Ot=ne._nodes.get(we);if(!tt)throw new te("Graph.".concat(he,': source node "').concat(Z,'" not found.'));if(!Ot)throw new te("Graph.".concat(he,': target node "').concat(we,'" not found.'));var We={key:null,undirected:A,source:Z,target:we,attributes:Fe};if(re&&(L=ne._edgeKeyGenerator(We)),ne._edges.has(L=""+L))throw new _e("Graph.".concat(he,': the "').concat(L,'" edge already exists in the graph.'));if(!ne.multi&&(A?void 0!==tt.undirected[we]:void 0!==tt.out[we]))throw new _e("Graph.".concat(he,': an edge linking "').concat(Z,'" to "').concat(we,"\" already exists. If you really want to add multiple edges linking those nodes, you should create a multi graph by using the 'multi' option."));var Gt=new Qe(A,L,re,tt,Ot,Fe);return ne._edges.set(L,Gt),Z===we?A?(tt.undirectedSelfLoops++,ne._undirectedSelfLoopCount++):(tt.directedSelfLoops++,ne._directedSelfLoopCount++):A?(tt.undirectedDegree++,Ot.undirectedDegree++):(tt.outDegree++,Ot.inDegree++),et(ne,A,Gt,Z,we,tt,Ot),A?ne._undirectedSize++:ne._directedSize++,We.key=L,ne.emit("edgeAdded",We),L}function $n(ne,he,re,A,L,Z,we,Fe,tt){if(!A&&"undirected"===ne.type)throw new _e("Graph.".concat(he,": you cannot add a directed edge to an undirected graph. Use the #.addEdge or #.addUndirectedEdge instead."));if(A&&"directed"===ne.type)throw new _e("Graph.".concat(he,": you cannot add an undirected edge to a directed graph. Use the #.addEdge or #.addDirectedEdge instead."));if(Fe)if(tt){if("function"!=typeof Fe)throw new me("Graph.".concat(he,': invalid updater function. Expecting a function but got "').concat(Fe,'"'))}else if(!k(Fe))throw new me("Graph.".concat(he,': invalid attributes. Expecting an object but got "').concat(Fe,'"'));var Ot;if(Z=""+Z,we=""+we,tt&&(Ot=Fe,Fe=void 0),!ne.allowSelfLoops&&Z===we)throw new _e("Graph.".concat(he,': source & target are the same ("').concat(Z,"\"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false."));var We,Gt,wt=ne._nodes.get(Z),_n=ne._nodes.get(we);if(!re&&(We=ne._edges.get(L))){if(We.source.key!==Z||We.target.key!==we||A&&(We.source.key!==we||We.target.key!==Z))throw new _e("Graph.".concat(he,': inconsistency detected when attempting to merge the "').concat(L,'" edge with "').concat(Z,'" source & "').concat(we,'" target vs. ("').concat(We.source.key,'", "').concat(We.target.key,'").'));Gt=We}if(Gt||ne.multi||!wt||(Gt=A?wt.undirected[we]:wt.out[we]),Gt)return(tt?Ot:Fe)?(tt?(Gt.attributes=Ot(Gt.attributes),ne.emit("edgeAttributesUpdated",{type:"replace",key:Gt.key,attributes:Gt.attributes})):(pe(Gt.attributes,Fe),ne.emit("edgeAttributesUpdated",{type:"merge",key:Gt.key,attributes:Gt.attributes,data:Fe})),Gt.key):Gt.key;Fe=Fe||{},tt&&Ot&&(Fe=Ot(Fe));var Kr={key:null,undirected:A,source:Z,target:we,attributes:Fe};if(re&&(L=ne._edgeKeyGenerator(Kr)),ne._edges.has(L=""+L))throw new _e("Graph.".concat(he,': the "').concat(L,'" edge already exists in the graph.'));return wt||(wt=On(ne,Z,{}),Z===we&&(_n=wt)),_n||(_n=On(ne,we,{})),We=new Qe(A,L,re,wt,_n,Fe),ne._edges.set(L,We),Z===we?A?(wt.undirectedSelfLoops++,ne._undirectedSelfLoopCount++):(wt.directedSelfLoops++,ne._directedSelfLoopCount++):A?(wt.undirectedDegree++,_n.undirectedDegree++):(wt.outDegree++,_n.inDegree++),et(ne,A,We,Z,we,wt,_n),A?ne._undirectedSize++:ne._directedSize++,Kr.key=L,ne.emit("edgeAdded",Kr),L}var ne,Sn=function(ne){function he(A){var L;if(L=ne.call(this)||this,(A=pe({},ri,A)).edgeKeyGenerator&&"function"!=typeof A.edgeKeyGenerator)throw new me("Graph.constructor: invalid 'edgeKeyGenerator' option. Expecting a function but got \"".concat(A.edgeKeyGenerator,'".'));if("boolean"!=typeof A.multi)throw new me("Graph.constructor: invalid 'multi' option. Expecting a boolean but got \"".concat(A.multi,'".'));if(!Yt.has(A.type))throw new me('Graph.constructor: invalid \'type\' option. Should be one of "mixed", "directed" or "undirected" but got "'.concat(A.type,'".'));if("boolean"!=typeof A.allowSelfLoops)throw new me("Graph.constructor: invalid 'allowSelfLoops' option. Expecting a boolean but got \"".concat(A.allowSelfLoops,'".'));var Z,we="mixed"===A.type?Oe:"directed"===A.type?$e:st;return W(Me(L),"NodeDataClass",we),W(Me(L),"_attributes",{}),W(Me(L),"_nodes",new Map),W(Me(L),"_edges",new Map),W(Me(L),"_directedSize",0),W(Me(L),"_undirectedSize",0),W(Me(L),"_directedSelfLoopCount",0),W(Me(L),"_undirectedSelfLoopCount",0),W(Me(L),"_edgeKeyGenerator",A.edgeKeyGenerator||(Z=0,function(){return Z++})),W(Me(L),"_options",A),jn.forEach(function(Fe){return W(Me(L),Fe,L[Fe])}),b(Me(L),"order",function(){return L._nodes.size}),b(Me(L),"size",function(){return L._edges.size}),b(Me(L),"directedSize",function(){return L._directedSize}),b(Me(L),"undirectedSize",function(){return L._undirectedSize}),b(Me(L),"selfLoopCount",function(){return L._directedSelfLoopCount+L._undirectedSelfLoopCount}),b(Me(L),"directedSelfLoopCount",function(){return L._directedSelfLoopCount}),b(Me(L),"undirectedSelfLoopCount",function(){return L._undirectedSelfLoopCount}),b(Me(L),"multi",L._options.multi),b(Me(L),"type",L._options.type),b(Me(L),"allowSelfLoops",L._options.allowSelfLoops),b(Me(L),"implementation",function(){return"graphology"}),L}nt(he,ne);var re=he.prototype;return re.hasNode=function(A){return this._nodes.has(""+A)},re.hasDirectedEdge=function(A,L){if("undirected"===this.type)return!1;if(1===arguments.length){var we=this._edges.get(""+A);return!!we&&!we.undirected}if(2===arguments.length){L=""+L;var Fe=this._nodes.get(A=""+A);if(!Fe)return!1;var tt=Fe.out[L];return!(!tt||this.multi&&!tt.size)}throw new me("Graph.hasDirectedEdge: invalid arity (".concat(arguments.length,", instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target."))},re.hasUndirectedEdge=function(A,L){if("directed"===this.type)return!1;if(1===arguments.length){var we=this._edges.get(""+A);return!!we&&we.undirected}if(2===arguments.length){L=""+L;var Fe=this._nodes.get(A=""+A);if(!Fe)return!1;var tt=Fe.undirected[L];return!(!tt||this.multi&&!tt.size)}throw new me("Graph.hasDirectedEdge: invalid arity (".concat(arguments.length,", instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target."))},re.hasEdge=function(A,L){if(1===arguments.length)return this._edges.has(""+A);if(2===arguments.length){L=""+L;var we=this._nodes.get(A=""+A);if(!we)return!1;var Fe=void 0!==we.out&&we.out[L];return Fe||(Fe=void 0!==we.undirected&&we.undirected[L]),!(!Fe||this.multi&&!Fe.size)}throw new me("Graph.hasEdge: invalid arity (".concat(arguments.length,", instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target."))},re.directedEdge=function(A,L){if("undirected"!==this.type){if(A=""+A,L=""+L,this.multi)throw new _e("Graph.directedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.directedEdges instead.");var Z=this._nodes.get(A);if(!Z)throw new te('Graph.directedEdge: could not find the "'.concat(A,'" source node in the graph.'));if(!this._nodes.has(L))throw new te('Graph.directedEdge: could not find the "'.concat(L,'" target node in the graph.'));var we=Z.out&&Z.out[L]||void 0;return we?we.key:void 0}},re.undirectedEdge=function(A,L){if("directed"!==this.type){if(A=""+A,L=""+L,this.multi)throw new _e("Graph.undirectedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.undirectedEdges instead.");var Z=this._nodes.get(A);if(!Z)throw new te('Graph.undirectedEdge: could not find the "'.concat(A,'" source node in the graph.'));if(!this._nodes.has(L))throw new te('Graph.undirectedEdge: could not find the "'.concat(L,'" target node in the graph.'));var we=Z.undirected&&Z.undirected[L]||void 0;return we?we.key:void 0}},re.edge=function(A,L){if(this.multi)throw new _e("Graph.edge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.edges instead.");L=""+L;var Z=this._nodes.get(A=""+A);if(!Z)throw new te('Graph.edge: could not find the "'.concat(A,'" source node in the graph.'));if(!this._nodes.has(L))throw new te('Graph.edge: could not find the "'.concat(L,'" target node in the graph.'));var we=Z.out&&Z.out[L]||Z.undirected&&Z.undirected[L]||void 0;if(we)return we.key},re.inDegree=function(A){var L=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("boolean"!=typeof L)throw new me('Graph.inDegree: Expecting a boolean but got "'.concat(L,'" for the second parameter (allowing self-loops to be counted).'));var Z=this._nodes.get(A=""+A);if(!Z)throw new te('Graph.inDegree: could not find the "'.concat(A,'" node in the graph.'));return"undirected"===this.type?0:Z.inDegree+(L?Z.directedSelfLoops:0)},re.outDegree=function(A){var L=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("boolean"!=typeof L)throw new me('Graph.outDegree: Expecting a boolean but got "'.concat(L,'" for the second parameter (allowing self-loops to be counted).'));var Z=this._nodes.get(A=""+A);if(!Z)throw new te('Graph.outDegree: could not find the "'.concat(A,'" node in the graph.'));return"undirected"===this.type?0:Z.outDegree+(L?Z.directedSelfLoops:0)},re.directedDegree=function(A){var L=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("boolean"!=typeof L)throw new me('Graph.directedDegree: Expecting a boolean but got "'.concat(L,'" for the second parameter (allowing self-loops to be counted).'));var Z=this._nodes.get(A=""+A);if(!Z)throw new te('Graph.directedDegree: could not find the "'.concat(A,'" node in the graph.'));if("undirected"===this.type)return 0;var we=L?Z.directedSelfLoops:0;return Z.inDegree+we+(Z.outDegree+we)},re.undirectedDegree=function(A){var L=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("boolean"!=typeof L)throw new me('Graph.undirectedDegree: Expecting a boolean but got "'.concat(L,'" for the second parameter (allowing self-loops to be counted).'));var Z=this._nodes.get(A=""+A);if(!Z)throw new te('Graph.undirectedDegree: could not find the "'.concat(A,'" node in the graph.'));return"directed"===this.type?0:Z.undirectedDegree+2*(L?Z.undirectedSelfLoops:0)},re.degree=function(A){var L=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("boolean"!=typeof L)throw new me('Graph.degree: Expecting a boolean but got "'.concat(L,'" for the second parameter (allowing self-loops to be counted).'));var Z=this._nodes.get(A=""+A);if(!Z)throw new te('Graph.degree: could not find the "'.concat(A,'" node in the graph.'));var we=0,Fe=0;return"directed"!==this.type&&(L&&(Fe=Z.undirectedSelfLoops),we+=Z.undirectedDegree+2*Fe),"undirected"!==this.type&&(L&&(Fe=Z.directedSelfLoops),we+=Z.inDegree+Z.outDegree+2*Fe),we},re.source=function(A){var L=this._edges.get(A=""+A);if(!L)throw new te('Graph.source: could not find the "'.concat(A,'" edge in the graph.'));return L.source.key},re.target=function(A){var L=this._edges.get(A=""+A);if(!L)throw new te('Graph.target: could not find the "'.concat(A,'" edge in the graph.'));return L.target.key},re.extremities=function(A){var L=this._edges.get(A=""+A);if(!L)throw new te('Graph.extremities: could not find the "'.concat(A,'" edge in the graph.'));return[L.source.key,L.target.key]},re.opposite=function(A,L){A=""+A;var Z=this._edges.get(L=""+L);if(!Z)throw new te('Graph.opposite: could not find the "'.concat(L,'" edge in the graph.'));var we=Z.source.key,Fe=Z.target.key;if(A!==we&&A!==Fe)throw new te('Graph.opposite: the "'.concat(A,'" node is not attached to the "').concat(L,'" edge (').concat(we,", ").concat(Fe,")."));return A===we?Fe:we},re.hasExtremity=function(A,L){L=""+L;var Z=this._edges.get(A=""+A);if(!Z)throw new te('Graph.hasExtremity: could not find the "'.concat(A,'" edge in the graph.'));return Z.source.key===L||Z.target.key===L},re.isUndirected=function(A){var L=this._edges.get(A=""+A);if(!L)throw new te('Graph.isUndirected: could not find the "'.concat(A,'" edge in the graph.'));return L.undirected},re.isDirected=function(A){var L=this._edges.get(A=""+A);if(!L)throw new te('Graph.isDirected: could not find the "'.concat(A,'" edge in the graph.'));return!L.undirected},re.isSelfLoop=function(A){var L=this._edges.get(A=""+A);if(!L)throw new te('Graph.isSelfLoop: could not find the "'.concat(A,'" edge in the graph.'));return L.source===L.target},re.hasGeneratedKey=function(A){var L=this._edges.get(A=""+A);if(!L)throw new te('Graph.hasGeneratedKey: could not find the "'.concat(A,'" edge in the graph.'));return L.generatedKey},re.addNode=function(A,L){return function(Z,we,Fe){if(Fe&&!k(Fe))throw new me('Graph.addNode: invalid attributes. Expecting an object but got "'.concat(Fe,'"'));if(Fe=Fe||{},Z._nodes.has(we=""+we))throw new _e('Graph.addNode: the "'.concat(we,'" node already exist in the graph.'));var tt=new Z.NodeDataClass(we,Fe);return Z._nodes.set(we,tt),Z.emit("nodeAdded",{key:we,attributes:Fe}),tt}(this,A,L).key},re.mergeNode=function(A,L){if(L&&!k(L))throw new me('Graph.mergeNode: invalid attributes. Expecting an object but got "'.concat(L,'"'));L=L||{};var Z=this._nodes.get(A=""+A);return Z?(L&&(pe(Z.attributes,L),this.emit("nodeAttributesUpdated",{type:"merge",key:A,attributes:Z.attributes,data:L})),A):(Z=new this.NodeDataClass(A,L),this._nodes.set(A,Z),this.emit("nodeAdded",{key:A,attributes:L}),A)},re.updateNode=function(A,L){if(L&&"function"!=typeof L)throw new me('Graph.updateNode: invalid updater function. Expecting a function but got "'.concat(L,'"'));var Z=this._nodes.get(A=""+A);if(Z)return L&&(Z.attributes=L(Z.attributes),this.emit("nodeAttributesUpdated",{type:"replace",key:A,attributes:Z.attributes})),A;var Fe=L?L({}):{};return Z=new this.NodeDataClass(A,Fe),this._nodes.set(A,Z),this.emit("nodeAdded",{key:A,attributes:Fe}),A},re.dropNode=function(A){var L=this,Z=this._nodes.get(A=""+A);if(!Z)throw new te('Graph.dropNode: could not find the "'.concat(A,'" node in the graph.'));this.forEachEdge(A,function(we){L.dropEdge(we)}),this._nodes.delete(A),this.emit("nodeDropped",{key:A,attributes:Z.attributes})},re.dropEdge=function(A){var L;if(arguments.length>1){var Z=""+arguments[0],we=""+arguments[1];if(!(L=Y(this,Z,we,this.type)))throw new te('Graph.dropEdge: could not find the "'.concat(Z,'" -> "').concat(we,'" edge in the graph.'))}else if(!(L=this._edges.get(A=""+A)))throw new te('Graph.dropEdge: could not find the "'.concat(A,'" edge in the graph.'));this._edges.delete(L.key);var tt=L.source,Ot=L.target,We=L.attributes,Gt=L.undirected;return tt===Ot?Gt?(tt.undirectedSelfLoops--,this._undirectedSelfLoopCount--):(tt.directedSelfLoops--,this._directedSelfLoopCount--):Gt?(tt.undirectedDegree--,Ot.undirectedDegree--):(tt.outDegree--,Ot.inDegree--),Ke(this,Gt,L),Gt?this._undirectedSize--:this._directedSize--,this.emit("edgeDropped",{key:A,attributes:We,source:tt.key,target:Ot.key,undirected:Gt}),this},re.clear=function(){this._edges.clear(),this._nodes.clear(),this.emit("cleared")},re.clearEdges=function(){this._edges.clear(),this.clearIndex(),this.emit("edgesCleared")},re.getAttribute=function(A){return this._attributes[A]},re.getAttributes=function(){return this._attributes},re.hasAttribute=function(A){return this._attributes.hasOwnProperty(A)},re.setAttribute=function(A,L){return this._attributes[A]=L,this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:A}),this},re.updateAttribute=function(A,L){if("function"!=typeof L)throw new me("Graph.updateAttribute: updater should be a function.");return this._attributes[A]=L(this._attributes[A]),this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:A}),this},re.removeAttribute=function(A){return delete this._attributes[A],this.emit("attributesUpdated",{type:"remove",attributes:this._attributes,name:A}),this},re.replaceAttributes=function(A){if(!k(A))throw new me("Graph.replaceAttributes: provided attributes are not a plain object.");return this._attributes=A,this.emit("attributesUpdated",{type:"replace",attributes:this._attributes}),this},re.mergeAttributes=function(A){if(!k(A))throw new me("Graph.mergeAttributes: provided attributes are not a plain object.");return pe(this._attributes,A),this.emit("attributesUpdated",{type:"merge",attributes:this._attributes,data:A}),this},re.getNodeAttribute=function(A,L){var Z=this._nodes.get(A=""+A);if(!Z)throw new te('Graph.getNodeAttribute: could not find the "'.concat(A,'" node in the graph.'));return Z.attributes[L]},re.getNodeAttributes=function(A){var L=this._nodes.get(A=""+A);if(!L)throw new te('Graph.getNodeAttributes: could not find the "'.concat(A,'" node in the graph.'));return L.attributes},re.hasNodeAttribute=function(A,L){var Z=this._nodes.get(A=""+A);if(!Z)throw new te('Graph.hasNodeAttribute: could not find the "'.concat(A,'" node in the graph.'));return Z.attributes.hasOwnProperty(L)},re.setNodeAttribute=function(A,L,Z){var we=this._nodes.get(A=""+A);if(!we)throw new te('Graph.setNodeAttribute: could not find the "'.concat(A,'" node in the graph.'));if(arguments.length<3)throw new me("Graph.setNodeAttribute: not enough arguments. Either you forgot to pass the attribute's name or value, or you meant to use #.replaceNodeAttributes / #.mergeNodeAttributes instead.");return we.attributes[L]=Z,this.emit("nodeAttributesUpdated",{key:A,type:"set",attributes:we.attributes,name:L}),this},re.updateNodeAttribute=function(A,L,Z){var we=this._nodes.get(A=""+A);if(!we)throw new te('Graph.updateNodeAttribute: could not find the "'.concat(A,'" node in the graph.'));if(arguments.length<3)throw new me("Graph.updateNodeAttribute: not enough arguments. Either you forgot to pass the attribute's name or updater, or you meant to use #.replaceNodeAttributes / #.mergeNodeAttributes instead.");if("function"!=typeof Z)throw new me("Graph.updateAttribute: updater should be a function.");var Fe=we.attributes,tt=Z(Fe[L]);return Fe[L]=tt,this.emit("nodeAttributesUpdated",{key:A,type:"set",attributes:we.attributes,name:L}),this},re.removeNodeAttribute=function(A,L){var Z=this._nodes.get(A=""+A);if(!Z)throw new te('Graph.hasNodeAttribute: could not find the "'.concat(A,'" node in the graph.'));return delete Z.attributes[L],this.emit("nodeAttributesUpdated",{key:A,type:"remove",attributes:Z.attributes,name:L}),this},re.replaceNodeAttributes=function(A,L){var Z=this._nodes.get(A=""+A);if(!Z)throw new te('Graph.replaceNodeAttributes: could not find the "'.concat(A,'" node in the graph.'));if(!k(L))throw new me("Graph.replaceNodeAttributes: provided attributes are not a plain object.");return Z.attributes=L,this.emit("nodeAttributesUpdated",{key:A,type:"replace",attributes:Z.attributes}),this},re.mergeNodeAttributes=function(A,L){var Z=this._nodes.get(A=""+A);if(!Z)throw new te('Graph.mergeNodeAttributes: could not find the "'.concat(A,'" node in the graph.'));if(!k(L))throw new me("Graph.mergeNodeAttributes: provided attributes are not a plain object.");return pe(Z.attributes,L),this.emit("nodeAttributesUpdated",{key:A,type:"merge",attributes:Z.attributes,data:L}),this},re.updateEachNodeAttributes=function(A,L){if("function"!=typeof A)throw new me("Graph.updateEachNodeAttributes: expecting an updater function.");if(L&&!C(L))throw new me("Graph.updateEachNodeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");for(var Z,we,Fe=this._nodes.values();!0!==(Z=Fe.next()).done;)(we=Z.value).attributes=A(we.key,we.attributes);this.emit("eachNodeAttributesUpdated",{hints:L||null})},re.updateEachEdgeAttributes=function(A,L){if("function"!=typeof A)throw new me("Graph.updateEachEdgeAttributes: expecting an updater function.");if(L&&!C(L))throw new me("Graph.updateEachEdgeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");for(var Z,we,Fe=this._edges.values();!0!==(Z=Fe.next()).done;)(we=Z.value).attributes=A(we.key,we.attributes);this.emit("eachEdgeAttributesUpdated",{hints:L||null})},re.forEach=function(A){if("function"!=typeof A)throw new me("Graph.forEach: expecting a callback.");this.multi?ct(!1,this,A):ke(!1,this,A)},re.forEachUntil=function(A){if("function"!=typeof A)throw new me("Graph.forEach: expecting a callback.");this.multi?ct(!0,this,A):ke(!0,this,A)},re.adjacency=function(){return this.multi?(tt=(A=this)._nodes.values(),Ot=A.type,We="outer",Gt=null,new se(function wt(){var _n;if("outer"===We)return!0===(_n=tt.next()).done?_n:(L=_n.value,We="directed",wt());if("directed"===We)return"undirected"===Ot?(We="undirected",wt()):(we=L.out,Z=Object.keys(L.out),Fe=0,We="inner-directed",wt());if("undirected"===We){if("directed"===Ot)return We="outer",wt();we=L.undirected,Z=Object.keys(L.undirected),Fe=0,We="inner-undirected"}if(!Gt&&Fe>=Z.length)return We="inner-undirected"===We?"outer":"undirected",wt();if(!Gt){var ws=Z[Fe++];return Gt=we[ws].values(),wt()}if((_n=Gt.next()).done)return Gt=null,wt();var Kr=_n.value,Qs=Kr.target;return"inner-undirected"===We&&Qs.key===L.key&&(Qs=Kr.source),{done:!1,value:[L.key,Qs.key,L.attributes,Qs.attributes,Kr.key,Kr.attributes]}})):(Il=(wt=this)._nodes.values(),ho=wt.type,kr="outer",new se(function Bs(){var wc;if("outer"===kr)return!0===(wc=Il.next()).done?wc:(_n=wc.value,kr="directed",Bs());if("directed"===kr)return"undirected"===ho?(kr="undirected",Bs()):(Kr=_n.out,ws=Object.keys(_n.out),Qs=0,kr="inner-directed",Bs());if("undirected"===kr){if("directed"===ho)return kr="outer",Bs();Kr=_n.undirected,ws=Object.keys(_n.undirected),Qs=0,kr="inner-undirected"}if(Qs>=ws.length)return kr="inner-undirected"===kr?"outer":"undirected",Bs();var wn=ws[Qs++],fo=Kr[wn],Ol=fo.target;return"inner-undirected"===kr&&Ol.key===_n.key&&(Ol=fo.source),{done:!1,value:[_n.key,Ol.key,_n.attributes,Ol.attributes,fo.key,fo.attributes]}}));var wt,_n,ws,Kr,Qs,Il,ho,kr,A,L,Z,we,Fe,tt,Ot,We,Gt},re.nodes=function(){return"function"==typeof Array.from?Array.from(this._nodes.keys()):ee(this._nodes.keys(),this._nodes.size)},re.forEachNode=function(A){if("function"!=typeof A)throw new me("Graph.forEachNode: expecting a callback.");this._nodes.forEach(function(L,Z){A(Z,L.attributes)})},re.forEachNodeUntil=function(A){if("function"!=typeof A)throw new me("Graph.forEachNode: expecting a callback.");for(var L,Z,we=this._nodes.values();!0!==(L=we.next())&&!A((Z=L.value).key,Z.attributes););},re.nodeEntries=function(){var A=this._nodes.values();return new se(function(){var L=A.next();if(L.done)return L;var Z=L.value;return{value:[Z.key,Z.attributes],done:!1}})},re.exportNode=function(A){var L=this._nodes.get(A=""+A);if(!L)throw new te('Graph.exportNode: could not find the "'.concat(A,'" node in the graph.'));return Je(A,L)},re.exportEdge=function(A){var L=this._edges.get(A=""+A);if(!L)throw new te('Graph.exportEdge: could not find the "'.concat(A,'" edge in the graph.'));return Et(A,L)},re.export=function(){var A=new Array(this._nodes.size),L=0;this._nodes.forEach(function(we,Fe){A[L++]=Je(Fe,we)});var Z=new Array(this._edges.size);return L=0,this._edges.forEach(function(we,Fe){Z[L++]=Et(Fe,we)}),{attributes:this.getAttributes(),nodes:A,edges:Z,options:{type:this.type,multi:this.multi,allowSelfLoops:this.allowSelfLoops}}},re.importNode=function(A){var L=arguments.length>1&&void 0!==arguments[1]&&arguments[1],Z=Tt(A);if(Z){if("not-object"===Z)throw new me('Graph.importNode: invalid serialized node. A serialized node should be a plain object with at least a "key" property.');if("no-key"===Z)throw new me("Graph.importNode: no key provided.");if("invalid-attributes"===Z)throw new me("Graph.importNode: invalid attributes. Attributes should be a plain object, null or omitted.")}var we=A.key,Fe=A.attributes,tt=void 0===Fe?{}:Fe;return L?this.mergeNode(we,tt):this.addNode(we,tt),this},re.importEdge=function(A){var L=arguments.length>1&&void 0!==arguments[1]&&arguments[1],Z=Dt(A);if(Z){if("not-object"===Z)throw new me('Graph.importEdge: invalid serialized edge. A serialized edge should be a plain object with at least a "source" & "target" property.');if("no-source"===Z)throw new me("Graph.importEdge: missing souce.");if("no-target"===Z)throw new me("Graph.importEdge: missing target.");if("invalid-attributes"===Z)throw new me("Graph.importEdge: invalid attributes. Attributes should be a plain object, null or omitted.");if("invalid-undirected"===Z)throw new me("Graph.importEdge: invalid undirected. Undirected should be boolean or omitted.")}var we=A.source,Fe=A.target,tt=A.attributes,Ot=void 0===tt?{}:tt,We=A.undirected,Gt=void 0!==We&&We;return"key"in A?(L?Gt?this.mergeUndirectedEdgeWithKey:this.mergeDirectedEdgeWithKey:Gt?this.addUndirectedEdgeWithKey:this.addDirectedEdgeWithKey).call(this,A.key,we,Fe,Ot):(L?Gt?this.mergeUndirectedEdge:this.mergeDirectedEdge:Gt?this.addUndirectedEdge:this.addDirectedEdge).call(this,we,Fe,Ot),this},re.import=function(A){var L,Z,we,Fe=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(U(A))return this.import(A.export(),Fe),this;if(!k(A))throw new me("Graph.import: invalid argument. Expecting a serialized graph or, alternatively, a Graph instance.");if(A.attributes){if(!k(A.attributes))throw new me("Graph.import: invalid attributes. Expecting a plain object.");Fe?this.mergeAttributes(A.attributes):this.replaceAttributes(A.attributes)}if(A.nodes){if(we=A.nodes,!Array.isArray(we))throw new me("Graph.import: invalid nodes. Expecting an array.");for(L=0,Z=we.length;L<Z;L++)this.importNode(we[L],Fe)}if(A.edges){if(we=A.edges,!Array.isArray(we))throw new me("Graph.import: invalid edges. Expecting an array.");for(L=0,Z=we.length;L<Z;L++)this.importEdge(we[L],Fe)}return this},re.nullCopy=function(A){return new he(pe({},this._options,A))},re.emptyCopy=function(A){var L=this.nullCopy(A);return this._nodes.forEach(function(Z,we){var Fe=pe({},Z.attributes);Z=new L.NodeDataClass(we,Fe),L._nodes.set(we,Z)}),L},re.copy=function(){var A=new he(this._options);return A.import(this),A},re.upgradeToMixed=function(){return"mixed"===this.type||(this._nodes.forEach(function(A){return A.upgradeToMixed()}),this._options.type="mixed",b(this,"type",this._options.type),W(this,"NodeDataClass",Oe)),this},re.upgradeToMulti=function(){return this.multi||(this._options.multi=!0,b(this,"multi",!0),(A=this)._nodes.forEach(function(L,Z){if(L.out)for(var we in L.out){var Fe=new Set;Fe.add(L.out[we]),L.out[we]=Fe,A._nodes.get(we).in[Z]=Fe}if(L.undirected)for(var tt in L.undirected)if(!(tt>Z)){var Ot=new Set;Ot.add(L.undirected[tt]),L.undirected[tt]=Ot,A._nodes.get(tt).undirected[Z]=Ot}})),this;var A},re.clearIndex=function(){return this._nodes.forEach(function(A){void 0!==A.in&&(A.in={},A.out={}),void 0!==A.undirected&&(A.undirected={})}),this},re.toJSON=function(){return this.export()},re.toString=function(){return"[object Graph]"},re.inspect=function(){var A=this,L={};this._nodes.forEach(function(Ot,We){L[We]=Ot.attributes});var Z={},we={};this._edges.forEach(function(Ot,We){var Gt=Ot.undirected?"--":"->",wt="",_n="(".concat(Ot.source.key,")").concat(Gt,"(").concat(Ot.target.key,")");Ot.generatedKey?A.multi&&(void 0===we[_n]?we[_n]=0:we[_n]++,wt+="".concat(we[_n],". ")):wt+="[".concat(We,"]: "),Z[wt+=_n]=Ot.attributes});var Fe={};for(var tt in this)this.hasOwnProperty(tt)&&!jn.has(tt)&&"function"!=typeof this[tt]&&(Fe[tt]=this[tt]);return Fe.attributes=this._attributes,Fe.nodes=L,Fe.edges=Z,W(Fe,"constructor",this.constructor),Fe},he}(M.exports.EventEmitter);"undefined"!=typeof Symbol&&(Sn.prototype[Symbol.for("nodejs.util.inspect.custom")]=Sn.prototype.inspect),[{name:function(ne){return"".concat(ne,"Edge")},generateKey:!0},{name:function(ne){return"".concat(ne,"DirectedEdge")},generateKey:!0,type:"directed"},{name:function(ne){return"".concat(ne,"UndirectedEdge")},generateKey:!0,type:"undirected"},{name:function(ne){return"".concat(ne,"EdgeWithKey")}},{name:function(ne){return"".concat(ne,"DirectedEdgeWithKey")},type:"directed"},{name:function(ne){return"".concat(ne,"UndirectedEdgeWithKey")},type:"undirected"}].forEach(function(ne){["add","merge","update"].forEach(function(he){var re=ne.name(he),A="add"===he?mn:$n;Sn.prototype[re]=ne.generateKey?function(L,Z,we){return A(this,re,!0,"undirected"===(ne.type||this.type),null,L,Z,we,"update"===he)}:function(L,Z,we,Fe){return A(this,re,!1,"undirected"===(ne.type||this.type),L,Z,we,Fe,"update"===he)}})}),"undefined"!=typeof Symbol&&(Sn.prototype[Symbol.iterator]=Sn.prototype.adjacency),ne=Sn,Ue.forEach(function(he){var re=he.name,A=he.attacher;A(ne,re("Edge"),"mixed"),A(ne,re("DirectedEdge"),"directed"),A(ne,re("UndirectedEdge"),"undirected")}),function(ne){Te.forEach(function(he){var A,L,Z,we;Z=(A=he).type,we=A.direction,ne.prototype[L=A.name]=function(Fe,tt){if("mixed"!==Z&&"mixed"!==this.type&&Z!==this.type)return[];if(!arguments.length)return Re(this,Z);if(1===arguments.length){var Ot=this._nodes.get(Fe=""+Fe);if(void 0===Ot)throw new te("Graph.".concat(L,': could not find the "').concat(Fe,'" node in the graph.'));return Mn(this.multi,"mixed"===Z?this.type:Z,we,Ot)}if(2===arguments.length){tt=""+tt;var We=this._nodes.get(Fe=""+Fe);if(!We)throw new te("Graph.".concat(L,':  could not find the "').concat(Fe,'" source node in the graph.'));if(!this._nodes.has(tt))throw new te("Graph.".concat(L,':  could not find the "').concat(tt,'" target node in the graph.'));return pi(Z,this.multi,we,We,tt)}throw new me("Graph.".concat(L,": too many arguments (expecting 0, 1 or 2 and got ").concat(arguments.length,")."))},function(re,A){var L=A.name,Z=A.type,we=A.direction,Fe="forEach"+L[0].toUpperCase()+L.slice(1,-1);re.prototype[Fe]=function(tt,Ot,We){if("mixed"===Z||"mixed"===this.type||Z===this.type){if(1===arguments.length)return Ze(this,Z,We=tt);if(2===arguments.length){We=Ot;var Gt=this._nodes.get(tt=""+tt);if(void 0===Gt)throw new te("Graph.".concat(Fe,': could not find the "').concat(tt,'" node in the graph.'));return Nn(this.multi,"mixed"===Z?this.type:Z,we,Gt,We)}if(3===arguments.length){Ot=""+Ot;var wt=this._nodes.get(tt=""+tt);if(!wt)throw new te("Graph.".concat(Fe,':  could not find the "').concat(tt,'" source node in the graph.'));if(!this._nodes.has(Ot))throw new te("Graph.".concat(Fe,':  could not find the "').concat(Ot,'" target node in the graph.'));return Wr(Z,this.multi,we,wt,Ot,We)}throw new me("Graph.".concat(Fe,": too many arguments (expecting 1, 2 or 3 and got ").concat(arguments.length,")."))}}}(ne,he),function(re,A){var L=A.name,Z=A.type,we=A.direction,Fe="forEach"+L[0].toUpperCase()+L.slice(1,-1)+"Until";re.prototype[Fe]=function(tt,Ot,We){if("mixed"===Z||"mixed"===this.type||Z===this.type){if(1===arguments.length)return bt(this,Z,We=tt);if(2===arguments.length){We=Ot;var Gt=this._nodes.get(tt=""+tt);if(void 0===Gt)throw new te("Graph.".concat(Fe,': could not find the "').concat(tt,'" node in the graph.'));return Gn(this.multi,"mixed"===Z?this.type:Z,we,Gt,We)}if(3===arguments.length){Ot=""+Ot;var wt=this._nodes.get(tt=""+tt);if(!wt)throw new te("Graph.".concat(Fe,':  could not find the "').concat(tt,'" source node in the graph.'));if(!this._nodes.has(Ot))throw new te("Graph.".concat(Fe,':  could not find the "').concat(Ot,'" target node in the graph.'));return Ls(Z,this.multi,we,wt,Ot,We)}throw new me("Graph.".concat(Fe,": too many arguments (expecting 1, 2 or 3 and got ").concat(arguments.length,")."))}}}(ne,he),function(re,A){var Z=A.type,we=A.direction,Fe=A.name.slice(0,-1)+"Entries";re.prototype[Fe]=function(tt,Ot){if("mixed"!==Z&&"mixed"!==this.type&&Z!==this.type)return se.empty();if(!arguments.length)return Rt(this,Z);if(1===arguments.length){var We=this._nodes.get(tt=""+tt);if(!We)throw new te("Graph.".concat(Fe,': could not find the "').concat(tt,'" node in the graph.'));return wi(Z,we,We)}if(2===arguments.length){Ot=""+Ot;var Gt=this._nodes.get(tt=""+tt);if(!Gt)throw new te("Graph.".concat(Fe,':  could not find the "').concat(tt,'" source node in the graph.'));if(!this._nodes.has(Ot))throw new te("Graph.".concat(Fe,':  could not find the "').concat(Ot,'" target node in the graph.'));return fs(Z,we,Gt,Ot)}throw new me("Graph.".concat(Fe,": too many arguments (expecting 0, 1 or 2 and got ").concat(arguments.length,")."))}}(ne,he)})}(Sn),function(ne){ks.forEach(function(he){var A,L,Z,we;Z=(A=he).type,we=A.direction,ne.prototype[L=A.name]=function(Fe){if("mixed"!==Z&&"mixed"!==this.type&&Z!==this.type)return[];if(2===arguments.length){var tt=""+arguments[0],Ot=""+arguments[1];if(!this._nodes.has(tt))throw new te("Graph.".concat(L,': could not find the "').concat(tt,'" node in the graph.'));if(!this._nodes.has(Ot))throw new te("Graph.".concat(L,': could not find the "').concat(Ot,'" node in the graph.'));return at(this,Z,we,tt,Ot)}if(1===arguments.length){var We=this._nodes.get(Fe=""+Fe);if(void 0===We)throw new te("Graph.".concat(L,': could not find the "').concat(Fe,'" node in the graph.'));return _a("mixed"===Z?this.type:Z,we,We)}throw new me("Graph.".concat(L,": invalid number of arguments (expecting 1 or 2 and got ").concat(arguments.length,")."))},function(ne,he){var re=he.name,A=he.type,L=he.direction,Z="forEach"+re[0].toUpperCase()+re.slice(1,-1);ne.prototype[Z]=function(we,Fe){if("mixed"===A||"mixed"===this.type||A===this.type){var tt=this._nodes.get(we=""+we);if(void 0===tt)throw new te("Graph.".concat(Z,': could not find the "').concat(we,'" node in the graph.'));!function(Ot,We,Gt,wt){if("mixed"!==Ot){if("undirected"===Ot)return Dl(Gt,Gt.undirected,wt);if("string"==typeof We)return Dl(Gt,Gt[We],wt)}var _n=new Set;"undirected"!==Ot&&("out"!==We&&ya(_n,Gt,Gt.in,wt),"in"!==We&&ya(_n,Gt,Gt.out,wt)),"directed"!==Ot&&ya(_n,Gt,Gt.undirected,wt)}("mixed"===A?this.type:A,L,tt,Fe)}}}(ne,he),function(ne,he){var re=he.name,A=he.type,L=he.direction,Z="forEach"+re[0].toUpperCase()+re.slice(1,-1)+"Until";ne.prototype[Z]=function(we,Fe){if("mixed"===A||"mixed"===this.type||A===this.type){var tt=this._nodes.get(we=""+we);if(void 0===tt)throw new te("Graph.".concat(Z,': could not find the "').concat(we,'" node in the graph.'));!function(Ot,We,Gt,wt){if("mixed"!==Ot){if("undirected"===Ot)return bs(Gt,Gt.undirected,wt);if("string"==typeof We)return bs(Gt,Gt[We],wt)}var _n=new Set;"undirected"!==Ot&&("out"!==We&&Jt(_n,Gt,Gt.in,wt)||"in"!==We&&Jt(_n,Gt,Gt.out,wt))||"directed"===Ot||Jt(_n,Gt,Gt.undirected,wt)}("mixed"===A?this.type:A,L,tt,Fe)}}}(ne,he),function(ne,he){var A=he.type,L=he.direction,Z=he.name.slice(0,-1)+"Entries";ne.prototype[Z]=function(we){if("mixed"!==A&&"mixed"!==this.type&&A!==this.type)return se.empty();var Fe=this._nodes.get(we=""+we);if(void 0===Fe)throw new te("Graph.".concat(Z,': could not find the "').concat(we,'" node in the graph.'));return function(tt,Ot,We){if("mixed"!==tt){if("undirected"===tt)return Xa(We,We.undirected);if("string"==typeof Ot)return Xa(We,We[Ot])}var Gt=se.empty(),wt=new Set;return"undirected"!==tt&&("out"!==Ot&&(Gt=Xe(Gt,rt(wt,We,We.in))),"in"!==Ot&&(Gt=Xe(Gt,rt(wt,We,We.out)))),"directed"!==tt&&(Gt=Xe(Gt,rt(wt,We,We.undirected))),Gt}("mixed"===A?this.type:A,L,Fe)}}(ne,he)})}(Sn);var nr=function(ne){function he(re){var A=pe({type:"directed"},re);if("multi"in A&&!1!==A.multi)throw new me("DirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if("directed"!==A.type)throw new me('DirectedGraph.from: inconsistent "'+A.type+'" type in given options!');return ne.call(this,A)||this}return nt(he,ne),he}(Sn),ir=function(ne){function he(re){var A=pe({type:"undirected"},re);if("multi"in A&&!1!==A.multi)throw new me("UndirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if("undirected"!==A.type)throw new me('UndirectedGraph.from: inconsistent "'+A.type+'" type in given options!');return ne.call(this,A)||this}return nt(he,ne),he}(Sn),Yn=function(ne){function he(re){var A=pe({multi:!0},re);if("multi"in A&&!0!==A.multi)throw new me("MultiGraph.from: inconsistent indication that the graph should be simple in given options!");return ne.call(this,A)||this}return nt(he,ne),he}(Sn),ji=function(ne){function he(re){var A=pe({type:"directed",multi:!0},re);if("multi"in A&&!0!==A.multi)throw new me("MultiDirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if("directed"!==A.type)throw new me('MultiDirectedGraph.from: inconsistent "'+A.type+'" type in given options!');return ne.call(this,A)||this}return nt(he,ne),he}(Sn),va=function(ne){function he(re){var A=pe({type:"undirected",multi:!0},re);if("multi"in A&&!0!==A.multi)throw new me("MultiUndirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if("undirected"!==A.type)throw new me('MultiUndirectedGraph.from: inconsistent "'+A.type+'" type in given options!');return ne.call(this,A)||this}return nt(he,ne),he}(Sn);function Yr(ne){ne.from=function(he,re){var A=pe({},he.options,re),L=new ne(A);return L.import(he),L}}return Yr(Sn),Yr(nr),Yr(ir),Yr(Yn),Yr(ji),Yr(va),Sn.Graph=Sn,Sn.DirectedGraph=nr,Sn.UndirectedGraph=ir,Sn.MultiGraph=Yn,Sn.MultiDirectedGraph=ji,Sn.MultiUndirectedGraph=va,Sn.InvalidArgumentsGraphError=me,Sn.NotFoundGraphError=te,Sn.UsageGraphError=_e,Sn}()},524:(Vt,it,nt)=>{var mt;!function(J,Mt,ht,K){"use strict";var M,Me=["","webkit","Moz","MS","ms","o"],pe=Mt.createElement("div"),U=Math.round,k=Math.abs,ie=Date.now;function W(ye,Ae,Ge){return setTimeout(T(ye,Ge),Ae)}function b(ye,Ae,Ge){return!!Array.isArray(ye)&&(C(ye,Ge[Ae],Ge),!0)}function C(ye,Ae,Ge){var _t;if(ye)if(ye.forEach)ye.forEach(Ae,Ge);else if(ye.length!==K)for(_t=0;_t<ye.length;)Ae.call(Ge,ye[_t],_t,ye),_t++;else for(_t in ye)ye.hasOwnProperty(_t)&&Ae.call(Ge,ye[_t],_t,ye)}function P(ye,Ae,Ge){var _t="DEPRECATED METHOD: "+Ae+"\n"+Ge+" AT \n";return function(){var Ut=new Error("get-stack-trace"),$t=Ut&&Ut.stack?Ut.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",si=J.console&&(J.console.warn||J.console.log);return si&&si.call(J.console,_t,$t),ye.apply(this,arguments)}}M="function"!=typeof Object.assign?function(Ae){if(Ae===K||null===Ae)throw new TypeError("Cannot convert undefined or null to object");for(var Ge=Object(Ae),_t=1;_t<arguments.length;_t++){var Ut=arguments[_t];if(Ut!==K&&null!==Ut)for(var $t in Ut)Ut.hasOwnProperty($t)&&(Ge[$t]=Ut[$t])}return Ge}:Object.assign;var v=P(function(Ae,Ge,_t){for(var Ut=Object.keys(Ge),$t=0;$t<Ut.length;)(!_t||_t&&Ae[Ut[$t]]===K)&&(Ae[Ut[$t]]=Ge[Ut[$t]]),$t++;return Ae},"extend","Use `assign`."),y=P(function(Ae,Ge){return v(Ae,Ge,!0)},"merge","Use `assign`.");function S(ye,Ae,Ge){var Ut,_t=Ae.prototype;(Ut=ye.prototype=Object.create(_t)).constructor=ye,Ut._super=_t,Ge&&M(Ut,Ge)}function T(ye,Ae){return function(){return ye.apply(Ae,arguments)}}function j(ye,Ae){return"function"==typeof ye?ye.apply(Ae&&Ae[0]||K,Ae):ye}function R(ye,Ae){return ye===K?Ae:ye}function q(ye,Ae,Ge){C(X(Ae),function(_t){ye.addEventListener(_t,Ge,!1)})}function ue(ye,Ae,Ge){C(X(Ae),function(_t){ye.removeEventListener(_t,Ge,!1)})}function D(ye,Ae){for(;ye;){if(ye==Ae)return!0;ye=ye.parentNode}return!1}function O(ye,Ae){return ye.indexOf(Ae)>-1}function X(ye){return ye.trim().split(/\s+/g)}function E(ye,Ae,Ge){if(ye.indexOf&&!Ge)return ye.indexOf(Ae);for(var _t=0;_t<ye.length;){if(Ge&&ye[_t][Ge]==Ae||!Ge&&ye[_t]===Ae)return _t;_t++}return-1}function G(ye){return Array.prototype.slice.call(ye,0)}function Q(ye,Ae,Ge){for(var _t=[],Ut=[],$t=0;$t<ye.length;){var si=Ae?ye[$t][Ae]:ye[$t];E(Ut,si)<0&&_t.push(ye[$t]),Ut[$t]=si,$t++}return Ge&&(_t=Ae?_t.sort(function(Xr,Es){return Xr[Ae]>Es[Ae]}):_t.sort()),_t}function ae(ye,Ae){for(var Ge,_t,Ut=Ae[0].toUpperCase()+Ae.slice(1),$t=0;$t<Me.length;){if((_t=(Ge=Me[$t])?Ge+Ut:Ae)in ye)return _t;$t++}return K}var se=1;function xe(ye){var Ae=ye.ownerDocument||ye;return Ae.defaultView||Ae.parentWindow||J}var te="ontouchstart"in J,_e=ae(J,"PointerEvent")!==K,Oe=te&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),$e="touch",Qe="mouse",gt=["x","y"],ft=["clientX","clientY"];function be(ye,Ae){var Ge=this;this.manager=ye,this.callback=Ae,this.element=ye.element,this.target=ye.options.inputTarget,this.domHandler=function(_t){j(ye.options.enable,[ye])&&Ge.handler(_t)},this.init()}function N(ye,Ae,Ge){var _t=Ge.pointers.length,Ut=Ge.changedPointers.length,$t=1&Ae&&_t-Ut==0,si=12&Ae&&_t-Ut==0;Ge.isFirst=!!$t,Ge.isFinal=!!si,$t&&(ye.session={}),Ge.eventType=Ae,function(ye,Ae){var Ge=ye.session,_t=Ae.pointers,Ut=_t.length;Ge.firstInput||(Ge.firstInput=bt(Ae)),Ut>1&&!Ge.firstMultiple?Ge.firstMultiple=bt(Ae):1===Ut&&(Ge.firstMultiple=!1);var $t=Ge.firstInput,si=Ge.firstMultiple,Br=si?si.center:$t.center,Xr=Ae.center=Rt(_t);Ae.timeStamp=ie(),Ae.deltaTime=Ae.timeStamp-$t.timeStamp,Ae.angle=wi(Br,Xr),Ae.distance=Gn(Br,Xr),function(ye,Ae){var Ge=Ae.center,_t=ye.offsetDelta||{},Ut=ye.prevDelta||{},$t=ye.prevInput||{};(1===Ae.eventType||4===$t.eventType)&&(Ut=ye.prevDelta={x:$t.deltaX||0,y:$t.deltaY||0},_t=ye.offsetDelta={x:Ge.x,y:Ge.y}),Ae.deltaX=Ut.x+(Ge.x-_t.x),Ae.deltaY=Ut.y+(Ge.y-_t.y)}(Ge,Ae),Ae.offsetDirection=Nn(Ae.deltaX,Ae.deltaY);var Es=Mn(Ae.deltaTime,Ae.deltaX,Ae.deltaY);Ae.overallVelocityX=Es.x,Ae.overallVelocityY=Es.y,Ae.overallVelocity=k(Es.x)>k(Es.y)?Es.x:Es.y,Ae.scale=si?function(ye,Ae){return Gn(Ae[0],Ae[1],ft)/Gn(ye[0],ye[1],ft)}(si.pointers,_t):1,Ae.rotation=si?function(ye,Ae){return wi(Ae[1],Ae[0],ft)+wi(ye[1],ye[0],ft)}(si.pointers,_t):0,Ae.maxPointers=Ge.prevInput?Ae.pointers.length>Ge.prevInput.maxPointers?Ae.pointers.length:Ge.prevInput.maxPointers:Ae.pointers.length,function(ye,Ae){var Ut,$t,si,Br,Ge=ye.lastInterval||Ae,_t=Ae.timeStamp-Ge.timeStamp;if(8!=Ae.eventType&&(_t>25||Ge.velocity===K)){var Xr=Ae.deltaX-Ge.deltaX,Es=Ae.deltaY-Ge.deltaY,ni=Mn(_t,Xr,Es);$t=ni.x,si=ni.y,Ut=k(ni.x)>k(ni.y)?ni.x:ni.y,Br=Nn(Xr,Es),ye.lastInterval=Ae}else Ut=Ge.velocity,$t=Ge.velocityX,si=Ge.velocityY,Br=Ge.direction;Ae.velocity=Ut,Ae.velocityX=$t,Ae.velocityY=si,Ae.direction=Br}(Ge,Ae);var ni=ye.element;D(Ae.srcEvent.target,ni)&&(ni=Ae.srcEvent.target),Ae.target=ni}(ye,Ge),ye.emit("hammer.input",Ge),ye.recognize(Ge),ye.session.prevInput=Ge}function bt(ye){for(var Ae=[],Ge=0;Ge<ye.pointers.length;)Ae[Ge]={clientX:U(ye.pointers[Ge].clientX),clientY:U(ye.pointers[Ge].clientY)},Ge++;return{timeStamp:ie(),pointers:Ae,center:Rt(Ae),deltaX:ye.deltaX,deltaY:ye.deltaY}}function Rt(ye){var Ae=ye.length;if(1===Ae)return{x:U(ye[0].clientX),y:U(ye[0].clientY)};for(var Ge=0,_t=0,Ut=0;Ut<Ae;)Ge+=ye[Ut].clientX,_t+=ye[Ut].clientY,Ut++;return{x:U(Ge/Ae),y:U(_t/Ae)}}function Mn(ye,Ae,Ge){return{x:Ae/ye||0,y:Ge/ye||0}}function Nn(ye,Ae){return ye===Ae?1:k(ye)>=k(Ae)?ye<0?2:4:Ae<0?8:16}function Gn(ye,Ae,Ge){Ge||(Ge=gt);var _t=Ae[Ge[0]]-ye[Ge[0]],Ut=Ae[Ge[1]]-ye[Ge[1]];return Math.sqrt(_t*_t+Ut*Ut)}function wi(ye,Ae,Ge){return Ge||(Ge=gt),180*Math.atan2(Ae[Ge[1]]-ye[Ge[1]],Ae[Ge[0]]-ye[Ge[0]])/Math.PI}be.prototype={handler:function(){},init:function(){this.evEl&&q(this.element,this.evEl,this.domHandler),this.evTarget&&q(this.target,this.evTarget,this.domHandler),this.evWin&&q(xe(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&ue(this.element,this.evEl,this.domHandler),this.evTarget&&ue(this.target,this.evTarget,this.domHandler),this.evWin&&ue(xe(this.element),this.evWin,this.domHandler)}};var Ls={mousedown:1,mousemove:2,mouseup:4},fs="mousedown",ks="mousemove mouseup";function qr(){this.evEl=fs,this.evWin=ks,this.pressed=!1,be.apply(this,arguments)}S(qr,be,{handler:function(Ae){var Ge=Ls[Ae.type];1&Ge&&0===Ae.button&&(this.pressed=!0),2&Ge&&1!==Ae.which&&(Ge=4),this.pressed&&(4&Ge&&(this.pressed=!1),this.callback(this.manager,Ge,{pointers:[Ae],changedPointers:[Ae],pointerType:Qe,srcEvent:Ae}))}});var _a={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},Dl={2:$e,3:"pen",4:Qe,5:"kinect"},ya="pointerdown",bs="pointermove pointerup pointercancel";function Jt(){this.evEl=ya,this.evWin=bs,be.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}J.MSPointerEvent&&!J.PointerEvent&&(ya="MSPointerDown",bs="MSPointerMove MSPointerUp MSPointerCancel"),S(Jt,be,{handler:function(Ae){var Ge=this.store,_t=!1,Ut=Ae.type.toLowerCase().replace("ms",""),$t=_a[Ut],si=Dl[Ae.pointerType]||Ae.pointerType,Br=si==$e,Xr=E(Ge,Ae.pointerId,"pointerId");1&$t&&(0===Ae.button||Br)?Xr<0&&(Ge.push(Ae),Xr=Ge.length-1):12&$t&&(_t=!0),!(Xr<0)&&(Ge[Xr]=Ae,this.callback(this.manager,$t,{pointers:Ge,changedPointers:[Ae],pointerType:si,srcEvent:Ae}),_t&&Ge.splice(Xr,1))}});var Xa={touchstart:1,touchmove:2,touchend:4,touchcancel:8},rt="touchstart",at="touchstart touchmove touchend touchcancel";function ut(){this.evTarget=rt,this.evWin=at,this.started=!1,be.apply(this,arguments)}function ge(ye,Ae){var Ge=G(ye.touches),_t=G(ye.changedTouches);return 12&Ae&&(Ge=Q(Ge.concat(_t),"identifier",!0)),[Ge,_t]}S(ut,be,{handler:function(Ae){var Ge=Xa[Ae.type];if(1===Ge&&(this.started=!0),this.started){var _t=ge.call(this,Ae,Ge);12&Ge&&_t[0].length-_t[1].length==0&&(this.started=!1),this.callback(this.manager,Ge,{pointers:_t[0],changedPointers:_t[1],pointerType:$e,srcEvent:Ae})}}});var ve={touchstart:1,touchmove:2,touchend:4,touchcancel:8},ke="touchstart touchmove touchend touchcancel";function ct(){this.evTarget=ke,this.targetIds={},be.apply(this,arguments)}function Je(ye,Ae){var Ge=G(ye.touches),_t=this.targetIds;if(3&Ae&&1===Ge.length)return _t[Ge[0].identifier]=!0,[Ge,Ge];var Ut,$t,si=G(ye.changedTouches),Br=[],Xr=this.target;if($t=Ge.filter(function(Es){return D(Es.target,Xr)}),1===Ae)for(Ut=0;Ut<$t.length;)_t[$t[Ut].identifier]=!0,Ut++;for(Ut=0;Ut<si.length;)_t[si[Ut].identifier]&&Br.push(si[Ut]),12&Ae&&delete _t[si[Ut].identifier],Ut++;return Br.length?[Q($t.concat(Br),"identifier",!0),Br]:void 0}function Dt(){be.apply(this,arguments);var ye=T(this.handler,this);this.touch=new ct(this.manager,ye),this.mouse=new qr(this.manager,ye),this.primaryTouch=null,this.lastTouches=[]}function Yt(ye,Ae){1&ye?(this.primaryTouch=Ae.changedPointers[0].identifier,jn.call(this,Ae)):12&ye&&jn.call(this,Ae)}function jn(ye){var Ae=ye.changedPointers[0];if(Ae.identifier===this.primaryTouch){var Ge={x:Ae.clientX,y:Ae.clientY};this.lastTouches.push(Ge);var _t=this.lastTouches;setTimeout(function(){var $t=_t.indexOf(Ge);$t>-1&&_t.splice($t,1)},2500)}}function ri(ye){for(var Ae=ye.srcEvent.clientX,Ge=ye.srcEvent.clientY,_t=0;_t<this.lastTouches.length;_t++){var Ut=this.lastTouches[_t],$t=Math.abs(Ae-Ut.x),si=Math.abs(Ge-Ut.y);if($t<=25&&si<=25)return!0}return!1}S(ct,be,{handler:function(Ae){var Ge=ve[Ae.type],_t=Je.call(this,Ae,Ge);!_t||this.callback(this.manager,Ge,{pointers:_t[0],changedPointers:_t[1],pointerType:$e,srcEvent:Ae})}}),S(Dt,be,{handler:function(Ae,Ge,_t){var $t=_t.pointerType==Qe;if(!($t&&_t.sourceCapabilities&&_t.sourceCapabilities.firesTouchEvents)){if(_t.pointerType==$e)Yt.call(this,Ge,_t);else if($t&&ri.call(this,_t))return;this.callback(Ae,Ge,_t)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var On=ae(pe.style,"touchAction"),mn=On!==K,$n="compute",nr="manipulation",ir="none",Yn="pan-x",ji="pan-y",va=function(){if(!mn)return!1;var ye={},Ae=J.CSS&&J.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(Ge){ye[Ge]=!Ae||J.CSS.supports("touch-action",Ge)}),ye}();function Yr(ye,Ae){this.manager=ye,this.set(Ae)}function Ot(ye){this.options=M({},this.defaults,ye||{}),this.id=se++,this.manager=null,this.options.enable=R(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function We(ye){return 16&ye?"cancel":8&ye?"end":4&ye?"move":2&ye?"start":""}function Gt(ye){return 16==ye?"down":8==ye?"up":2==ye?"left":4==ye?"right":""}function wt(ye,Ae){var Ge=Ae.manager;return Ge?Ge.get(ye):ye}function _n(){Ot.apply(this,arguments)}function ws(){_n.apply(this,arguments),this.pX=null,this.pY=null}function Kr(){_n.apply(this,arguments)}function Qs(){Ot.apply(this,arguments),this._timer=null,this._input=null}function Il(){_n.apply(this,arguments)}function ho(){_n.apply(this,arguments)}function kr(){Ot.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Bs(ye,Ae){return(Ae=Ae||{}).recognizers=R(Ae.recognizers,Bs.defaults.preset),new fo(ye,Ae)}function fo(ye,Ae){this.options=M({},Bs.defaults,Ae||{}),this.options.inputTarget=this.options.inputTarget||ye,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=ye,this.input=function(ye){return new(ye.options.inputClass||(_e?Jt:Oe?ct:te?Dt:qr))(ye,N)}(this),this.touchAction=new Yr(this,this.options.touchAction),Ol(this,!0),C(this.options.recognizers,function(Ge){var _t=this.add(new Ge[0](Ge[1]));Ge[2]&&_t.recognizeWith(Ge[2]),Ge[3]&&_t.requireFailure(Ge[3])},this)}function Ol(ye,Ae){var _t,Ge=ye.element;Ge.style&&(C(ye.options.cssProps,function(Ut,$t){_t=ae(Ge.style,$t),Ae?(ye.oldCssProps[_t]=Ge.style[_t],Ge.style[_t]=Ut):Ge.style[_t]=ye.oldCssProps[_t]||""}),Ae||(ye.oldCssProps={}))}Yr.prototype={set:function(ye){ye==$n&&(ye=this.compute()),mn&&this.manager.element.style&&va[ye]&&(this.manager.element.style[On]=ye),this.actions=ye.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var ye=[];return C(this.manager.recognizers,function(Ae){j(Ae.options.enable,[Ae])&&(ye=ye.concat(Ae.getTouchAction()))}),function(ye){if(O(ye,ir))return ir;var Ae=O(ye,Yn),Ge=O(ye,ji);return Ae&&Ge?ir:Ae||Ge?Ae?Yn:ji:O(ye,nr)?nr:"auto"}(ye.join(" "))},preventDefaults:function(ye){var Ae=ye.srcEvent,Ge=ye.offsetDirection;if(!this.manager.session.prevented){var _t=this.actions,Ut=O(_t,ir)&&!va[ir],$t=O(_t,ji)&&!va[ji],si=O(_t,Yn)&&!va[Yn];if(Ut&&1===ye.pointers.length&&ye.distance<2&&ye.deltaTime<250)return;return si&&$t||!(Ut||$t&&6&Ge||si&&24&Ge)?void 0:this.preventSrc(Ae)}Ae.preventDefault()},preventSrc:function(ye){this.manager.session.prevented=!0,ye.preventDefault()}},Ot.prototype={defaults:{},set:function(ye){return M(this.options,ye),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(ye){if(b(ye,"recognizeWith",this))return this;var Ae=this.simultaneous;return Ae[(ye=wt(ye,this)).id]||(Ae[ye.id]=ye,ye.recognizeWith(this)),this},dropRecognizeWith:function(ye){return b(ye,"dropRecognizeWith",this)||(ye=wt(ye,this),delete this.simultaneous[ye.id]),this},requireFailure:function(ye){if(b(ye,"requireFailure",this))return this;var Ae=this.requireFail;return-1===E(Ae,ye=wt(ye,this))&&(Ae.push(ye),ye.requireFailure(this)),this},dropRequireFailure:function(ye){if(b(ye,"dropRequireFailure",this))return this;ye=wt(ye,this);var Ae=E(this.requireFail,ye);return Ae>-1&&this.requireFail.splice(Ae,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(ye){return!!this.simultaneous[ye.id]},emit:function(ye){var Ae=this,Ge=this.state;function _t(Ut){Ae.manager.emit(Ut,ye)}Ge<8&&_t(Ae.options.event+We(Ge)),_t(Ae.options.event),ye.additionalEvent&&_t(ye.additionalEvent),Ge>=8&&_t(Ae.options.event+We(Ge))},tryEmit:function(ye){if(this.canEmit())return this.emit(ye);this.state=32},canEmit:function(){for(var ye=0;ye<this.requireFail.length;){if(!(33&this.requireFail[ye].state))return!1;ye++}return!0},recognize:function(ye){var Ae=M({},ye);if(!j(this.options.enable,[this,Ae]))return this.reset(),void(this.state=32);56&this.state&&(this.state=1),this.state=this.process(Ae),30&this.state&&this.tryEmit(Ae)},process:function(ye){},getTouchAction:function(){},reset:function(){}},S(_n,Ot,{defaults:{pointers:1},attrTest:function(ye){var Ae=this.options.pointers;return 0===Ae||ye.pointers.length===Ae},process:function(ye){var Ae=this.state,Ge=ye.eventType,_t=6&Ae,Ut=this.attrTest(ye);return _t&&(8&Ge||!Ut)?16|Ae:_t||Ut?4&Ge?8|Ae:2&Ae?4|Ae:2:32}}),S(ws,_n,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var ye=this.options.direction,Ae=[];return 6&ye&&Ae.push(ji),24&ye&&Ae.push(Yn),Ae},directionTest:function(ye){var Ae=this.options,Ge=!0,_t=ye.distance,Ut=ye.direction,$t=ye.deltaX,si=ye.deltaY;return Ut&Ae.direction||(6&Ae.direction?(Ut=0===$t?1:$t<0?2:4,Ge=$t!=this.pX,_t=Math.abs(ye.deltaX)):(Ut=0===si?1:si<0?8:16,Ge=si!=this.pY,_t=Math.abs(ye.deltaY))),ye.direction=Ut,Ge&&_t>Ae.threshold&&Ut&Ae.direction},attrTest:function(ye){return _n.prototype.attrTest.call(this,ye)&&(2&this.state||!(2&this.state)&&this.directionTest(ye))},emit:function(ye){this.pX=ye.deltaX,this.pY=ye.deltaY;var Ae=Gt(ye.direction);Ae&&(ye.additionalEvent=this.options.event+Ae),this._super.emit.call(this,ye)}}),S(Kr,_n,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[ir]},attrTest:function(ye){return this._super.attrTest.call(this,ye)&&(Math.abs(ye.scale-1)>this.options.threshold||2&this.state)},emit:function(ye){1!==ye.scale&&(ye.additionalEvent=this.options.event+(ye.scale<1?"in":"out")),this._super.emit.call(this,ye)}}),S(Qs,Ot,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return["auto"]},process:function(ye){var Ae=this.options,Ge=ye.pointers.length===Ae.pointers,_t=ye.distance<Ae.threshold,Ut=ye.deltaTime>Ae.time;if(this._input=ye,!_t||!Ge||12&ye.eventType&&!Ut)this.reset();else if(1&ye.eventType)this.reset(),this._timer=W(function(){this.state=8,this.tryEmit()},Ae.time,this);else if(4&ye.eventType)return 8;return 32},reset:function(){clearTimeout(this._timer)},emit:function(ye){8===this.state&&(ye&&4&ye.eventType?this.manager.emit(this.options.event+"up",ye):(this._input.timeStamp=ie(),this.manager.emit(this.options.event,this._input)))}}),S(Il,_n,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[ir]},attrTest:function(ye){return this._super.attrTest.call(this,ye)&&(Math.abs(ye.rotation)>this.options.threshold||2&this.state)}}),S(ho,_n,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return ws.prototype.getTouchAction.call(this)},attrTest:function(ye){var Ge,Ae=this.options.direction;return 30&Ae?Ge=ye.overallVelocity:6&Ae?Ge=ye.overallVelocityX:24&Ae&&(Ge=ye.overallVelocityY),this._super.attrTest.call(this,ye)&&Ae&ye.offsetDirection&&ye.distance>this.options.threshold&&ye.maxPointers==this.options.pointers&&k(Ge)>this.options.velocity&&4&ye.eventType},emit:function(ye){var Ae=Gt(ye.offsetDirection);Ae&&this.manager.emit(this.options.event+Ae,ye),this.manager.emit(this.options.event,ye)}}),S(kr,Ot,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[nr]},process:function(ye){var Ae=this.options,Ge=ye.pointers.length===Ae.pointers,_t=ye.distance<Ae.threshold,Ut=ye.deltaTime<Ae.time;if(this.reset(),1&ye.eventType&&0===this.count)return this.failTimeout();if(_t&&Ut&&Ge){if(4!=ye.eventType)return this.failTimeout();var $t=!this.pTime||ye.timeStamp-this.pTime<Ae.interval,si=!this.pCenter||Gn(this.pCenter,ye.center)<Ae.posThreshold;if(this.pTime=ye.timeStamp,this.pCenter=ye.center,si&&$t?this.count+=1:this.count=1,this._input=ye,0==this.count%Ae.taps)return this.hasRequireFailures()?(this._timer=W(function(){this.state=8,this.tryEmit()},Ae.interval,this),2):8}return 32},failTimeout:function(){return this._timer=W(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Bs.VERSION="2.0.7",Bs.defaults={domEvents:!1,touchAction:$n,enable:!0,inputTarget:null,inputClass:null,preset:[[Il,{enable:!1}],[Kr,{enable:!1},["rotate"]],[ho,{direction:6}],[ws,{direction:6},["swipe"]],[kr],[kr,{event:"doubletap",taps:2},["tap"]],[Qs]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},fo.prototype={set:function(ye){return M(this.options,ye),ye.touchAction&&this.touchAction.update(),ye.inputTarget&&(this.input.destroy(),this.input.target=ye.inputTarget,this.input.init()),this},stop:function(ye){this.session.stopped=ye?2:1},recognize:function(ye){var Ae=this.session;if(!Ae.stopped){this.touchAction.preventDefaults(ye);var Ge,_t=this.recognizers,Ut=Ae.curRecognizer;(!Ut||Ut&&8&Ut.state)&&(Ut=Ae.curRecognizer=null);for(var $t=0;$t<_t.length;)Ge=_t[$t],2===Ae.stopped||Ut&&Ge!=Ut&&!Ge.canRecognizeWith(Ut)?Ge.reset():Ge.recognize(ye),!Ut&&14&Ge.state&&(Ut=Ae.curRecognizer=Ge),$t++}},get:function(ye){if(ye instanceof Ot)return ye;for(var Ae=this.recognizers,Ge=0;Ge<Ae.length;Ge++)if(Ae[Ge].options.event==ye)return Ae[Ge];return null},add:function(ye){if(b(ye,"add",this))return this;var Ae=this.get(ye.options.event);return Ae&&this.remove(Ae),this.recognizers.push(ye),ye.manager=this,this.touchAction.update(),ye},remove:function(ye){if(b(ye,"remove",this))return this;if(ye=this.get(ye)){var Ae=this.recognizers,Ge=E(Ae,ye);-1!==Ge&&(Ae.splice(Ge,1),this.touchAction.update())}return this},on:function(ye,Ae){if(ye!==K&&Ae!==K){var Ge=this.handlers;return C(X(ye),function(_t){Ge[_t]=Ge[_t]||[],Ge[_t].push(Ae)}),this}},off:function(ye,Ae){if(ye!==K){var Ge=this.handlers;return C(X(ye),function(_t){Ae?Ge[_t]&&Ge[_t].splice(E(Ge[_t],Ae),1):delete Ge[_t]}),this}},emit:function(ye,Ae){this.options.domEvents&&function(ye,Ae){var Ge=Mt.createEvent("Event");Ge.initEvent(ye,!0,!0),Ge.gesture=Ae,Ae.target.dispatchEvent(Ge)}(ye,Ae);var Ge=this.handlers[ye]&&this.handlers[ye].slice();if(Ge&&Ge.length){Ae.type=ye,Ae.preventDefault=function(){Ae.srcEvent.preventDefault()};for(var _t=0;_t<Ge.length;)Ge[_t](Ae),_t++}},destroy:function(){this.element&&Ol(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},M(Bs,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:fo,Input:be,TouchAction:Yr,TouchInput:ct,MouseInput:qr,PointerEventInput:Jt,TouchMouseInput:Dt,SingleTouchInput:ut,Recognizer:Ot,AttrRecognizer:_n,Tap:kr,Pan:ws,Swipe:ho,Pinch:Kr,Rotate:Il,Press:Qs,on:q,off:ue,each:C,merge:y,extend:v,assign:M,inherit:S,bindFn:T,prefixed:ae}),(void 0!==J?J:"undefined"!=typeof self?self:{}).Hammer=Bs,(mt=function(){return Bs}.call(it,nt,it,Vt))!==K&&(Vt.exports=mt)}(window,document)},815:function(Vt,it,nt){var mt;Vt=nt.nmd(Vt),function(){var J,Me="Expected a function",Y="__lodash_hash_undefined__",k="__lodash_placeholder__",j=32,q=128,ee=1/0,xe=9007199254740991,_e=4294967295,st=[["ary",q],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",j],["partialRight",64],["rearg",256]],Qe="[object Arguments]",et="[object Array]",Ue="[object Boolean]",Le="[object Date]",Te="[object Error]",je="[object Function]",qe="[object GeneratorFunction]",Ne="[object Map]",$="[object Number]",fe="[object Object]",de="[object Promise]",gt="[object RegExp]",ft="[object Set]",be="[object String]",B="[object Symbol]",V="[object WeakMap]",Ze="[object ArrayBuffer]",bt="[object DataView]",Rt="[object Float32Array]",Mn="[object Float64Array]",Nn="[object Int8Array]",Gn="[object Int16Array]",wi="[object Int32Array]",pi="[object Uint8Array]",Wr="[object Uint8ClampedArray]",Ls="[object Uint16Array]",fs="[object Uint32Array]",ks=/\b__p \+= '';/g,qr=/\b(__p \+=) '' \+/g,_a=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Dl=/&(?:amp|lt|gt|quot|#39);/g,ya=/[&<>"']/g,bs=RegExp(Dl.source),Jt=RegExp(ya.source),Xa=/<%-([\s\S]+?)%>/g,rt=/<%([\s\S]+?)%>/g,at=/<%=([\s\S]+?)%>/g,ut=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ge=/^\w*$/,ve=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ke=/[\\^$.*+?()[\]{}|]/g,ct=RegExp(ke.source),Je=/^\s+/,Et=/\s/,Tt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Dt=/\{\n\/\* \[wrapped with (.+)\] \*/,Yt=/,? & /,jn=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ri=/[()=,{}\[\]\/\s]/,On=/\\(\\)?/g,mn=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,$n=/\w*$/,Sn=/^[-+]0x[0-9a-f]+$/i,nr=/^0b[01]+$/i,ir=/^\[object .+?Constructor\]$/,Yn=/^0o[0-7]+$/i,ji=/^(?:0|[1-9]\d*)$/,va=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Yr=/($^)/,ne=/['\n\r\u2028\u2029\\]/g,he="\\ud800-\\udfff",Z="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",we="\\u2700-\\u27bf",Fe="a-z\\xdf-\\xf6\\xf8-\\xff",wt="A-Z\\xc0-\\xd6\\xd8-\\xde",_n="\\ufe0e\\ufe0f",ws="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Qs="["+he+"]",Il="["+ws+"]",ho="["+Z+"]",kr="\\d+",Bs="["+we+"]",wc="["+Fe+"]",wn="[^"+he+ws+kr+we+Fe+wt+"]",fo="\\ud83c[\\udffb-\\udfff]",ba="[^"+he+"]",yd="(?:\\ud83c[\\udde6-\\uddff]){2}",ye="[\\ud800-\\udbff][\\udc00-\\udfff]",Ae="["+wt+"]",_t="(?:"+wc+"|"+wn+")",Ut="(?:"+Ae+"|"+wn+")",$t="(?:['\u2019](?:d|ll|m|re|s|t|ve))?",si="(?:['\u2019](?:D|LL|M|RE|S|T|VE))?",Br="(?:"+ho+"|"+fo+")?",Xr="["+_n+"]?",r1=Xr+Br+"(?:\\u200d(?:"+[ba,yd,ye].join("|")+")"+Xr+Br+")*",vd="(?:"+[Bs,yd,ye].join("|")+")"+r1,Ji="(?:"+[ba+ho+"?",ho,yd,ye,Qs].join("|")+")",op=RegExp("['\u2019]","g"),Gm=RegExp(ho,"g"),Ah=RegExp(fo+"(?="+fo+")|"+Ji+r1,"g"),Uv=RegExp([Ae+"?"+wc+"+"+$t+"(?="+[Il,Ae,"$"].join("|")+")",Ut+"+"+si+"(?="+[Il,Ae+_t,"$"].join("|")+")",Ae+"?"+_t+"+"+$t,Ae+"+"+si,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",kr,vd].join("|"),"g"),s1=RegExp("[\\u200d"+he+Z+_n+"]"),Rl=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Mh=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],o1=-1,yn={};yn[Rt]=yn[Mn]=yn[Nn]=yn[Gn]=yn[wi]=yn[pi]=yn[Wr]=yn[Ls]=yn[fs]=!0,yn[Qe]=yn[et]=yn[Ze]=yn[Ue]=yn[bt]=yn[Le]=yn[Te]=yn[je]=yn[Ne]=yn[$]=yn[fe]=yn[gt]=yn[ft]=yn[be]=yn[V]=!1;var rr={};rr[Qe]=rr[et]=rr[Ze]=rr[bt]=rr[Ue]=rr[Le]=rr[Rt]=rr[Mn]=rr[Nn]=rr[Gn]=rr[wi]=rr[Ne]=rr[$]=rr[fe]=rr[gt]=rr[ft]=rr[be]=rr[B]=rr[pi]=rr[Wr]=rr[Ls]=rr[fs]=!0,rr[Te]=rr[je]=rr[V]=!1;var ln={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},a1=parseFloat,$v=parseInt,kt="object"==typeof global&&global&&global.Object===Object&&global,Vs="object"==typeof self&&self&&self.Object===Object&&self,Fi=kt||Vs||Function("return this")(),Nl=it&&!it.nodeType&&it,wa=Nl&&Vt&&!Vt.nodeType&&Vt,Mo=wa&&wa.exports===Nl,$m=Mo&&kt.process,yr=function(){try{return wa&&wa.require&&wa.require("util").types||$m&&$m.binding&&$m.binding("util")}catch(It){}}(),rn=yr&&yr.isArrayBuffer,ai=yr&&yr.isDate,ar=yr&&yr.isMap,po=yr&&yr.isRegExp,Ec=yr&&yr.isSet,is=yr&&yr.isTypedArray;function rs(ot,It,yt){switch(yt.length){case 0:return ot.call(It);case 1:return ot.call(It,yt[0]);case 2:return ot.call(It,yt[0],yt[1]);case 3:return ot.call(It,yt[0],yt[1],yt[2])}return ot.apply(It,yt)}function Vr(ot,It,yt,un){for(var Tn=-1,Ri=null==ot?0:ot.length;++Tn<Ri;){var Qr=ot[Tn];It(un,Qr,yt(Qr),ot)}return un}function js(ot,It){for(var yt=-1,un=null==ot?0:ot.length;++yt<un&&!1!==It(ot[yt],yt,ot););return ot}function bd(ot,It){for(var yt=null==ot?0:ot.length;yt--&&!1!==It(ot[yt],yt,ot););return ot}function ei(ot,It){for(var yt=-1,un=null==ot?0:ot.length;++yt<un;)if(!It(ot[yt],yt,ot))return!1;return!0}function Ea(ot,It){for(var yt=-1,un=null==ot?0:ot.length,Tn=0,Ri=[];++yt<un;){var Qr=ot[yt];It(Qr,yt,ot)&&(Ri[Tn++]=Qr)}return Ri}function Pl(ot,It){return!(null==ot||!ot.length)&&Qa(ot,It,0)>-1}function Dh(ot,It,yt){for(var un=-1,Tn=null==ot?0:ot.length;++un<Tn;)if(yt(It,ot[un]))return!0;return!1}function Ui(ot,It){for(var yt=-1,un=null==ot?0:ot.length,Tn=Array(un);++yt<un;)Tn[yt]=It(ot[yt],yt,ot);return Tn}function jr(ot,It){for(var yt=-1,un=It.length,Tn=ot.length;++yt<un;)ot[Tn+yt]=It[yt];return ot}function _u(ot,It,yt,un){var Tn=-1,Ri=null==ot?0:ot.length;for(un&&Ri&&(yt=ot[++Tn]);++Tn<Ri;)yt=It(yt,ot[Tn],Tn,ot);return yt}function wd(ot,It,yt,un){var Tn=null==ot?0:ot.length;for(un&&Tn&&(yt=ot[--Tn]);Tn--;)yt=It(yt,ot[Tn],Tn,ot);return yt}function Do(ot,It){for(var yt=-1,un=null==ot?0:ot.length;++yt<un;)if(It(ot[yt],yt,ot))return!0;return!1}var sr=Wm("length");function Ih(ot,It,yt){var un;return yt(ot,function(Tn,Ri,Qr){if(It(Tn,Ri,Qr))return un=Ri,!1}),un}function Ed(ot,It,yt,un){for(var Tn=ot.length,Ri=yt+(un?1:-1);un?Ri--:++Ri<Tn;)if(It(ot[Ri],Ri,ot))return Ri;return-1}function Qa(ot,It,yt){return It==It?function(ot,It,yt){for(var un=yt-1,Tn=ot.length;++un<Tn;)if(ot[un]===It)return un;return-1}(ot,It,yt):Ed(ot,Sc,yt)}function ap(ot,It,yt,un){for(var Tn=yt-1,Ri=ot.length;++Tn<Ri;)if(un(ot[Tn],It))return Tn;return-1}function Sc(ot){return ot!=ot}function Ss(ot,It){var yt=null==ot?0:ot.length;return yt?Sd(ot,It)/yt:NaN}function Wm(ot){return function(It){return null==It?J:It[ot]}}function Wo(ot){return function(It){return null==ot?J:ot[It]}}function qo(ot,It,yt,un,Tn){return Tn(ot,function(Ri,Qr,Hi){yt=un?(un=!1,Ri):It(yt,Ri,Qr,Hi)}),yt}function Sd(ot,It){for(var yt,un=-1,Tn=ot.length;++un<Tn;){var Ri=It(ot[un]);Ri!==J&&(yt=yt===J?Ri:yt+Ri)}return yt}function xd(ot,It){for(var yt=-1,un=Array(ot);++yt<ot;)un[yt]=It(yt);return un}function Wv(ot){return ot&&ot.slice(0,xc(ot)+1).replace(Je,"")}function Yo(ot){return function(It){return ot(It)}}function Ym(ot,It){return Ui(It,function(yt){return ot[yt]})}function Oh(ot,It){return ot.has(It)}function u1(ot,It){for(var yt=-1,un=ot.length;++yt<un&&Qa(It,ot[yt],0)>-1;);return yt}function d1(ot,It){for(var yt=ot.length;yt--&&Qa(It,ot[yt],0)>-1;);return yt}function CF(ot,It){for(var yt=ot.length,un=0;yt--;)ot[yt]===It&&++un;return un}var TF=Wo({\u00c0:"A",\u00c1:"A",\u00c2:"A",\u00c3:"A",\u00c4:"A",\u00c5:"A",\u00e0:"a",\u00e1:"a",\u00e2:"a",\u00e3:"a",\u00e4:"a",\u00e5:"a",\u00c7:"C",\u00e7:"c",\u00d0:"D",\u00f0:"d",\u00c8:"E",\u00c9:"E",\u00ca:"E",\u00cb:"E",\u00e8:"e",\u00e9:"e",\u00ea:"e",\u00eb:"e",\u00cc:"I",\u00cd:"I",\u00ce:"I",\u00cf:"I",\u00ec:"i",\u00ed:"i",\u00ee:"i",\u00ef:"i",\u00d1:"N",\u00f1:"n",\u00d2:"O",\u00d3:"O",\u00d4:"O",\u00d5:"O",\u00d6:"O",\u00d8:"O",\u00f2:"o",\u00f3:"o",\u00f4:"o",\u00f5:"o",\u00f6:"o",\u00f8:"o",\u00d9:"U",\u00da:"U",\u00db:"U",\u00dc:"U",\u00f9:"u",\u00fa:"u",\u00fb:"u",\u00fc:"u",\u00dd:"Y",\u00fd:"y",\u00ff:"y",\u00c6:"Ae",\u00e6:"ae",\u00de:"Th",\u00fe:"th",\u00df:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010a:"C",\u010c:"C",\u0107:"c",\u0109:"c",\u010b:"c",\u010d:"c",\u010e:"D",\u0110:"D",\u010f:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011a:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011b:"e",\u011c:"G",\u011e:"G",\u0120:"G",\u0122:"G",\u011d:"g",\u011f:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012a:"I",\u012c:"I",\u012e:"I",\u0130:"I",\u0129:"i",\u012b:"i",\u012d:"i",\u012f:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013b:"L",\u013d:"L",\u013f:"L",\u0141:"L",\u013a:"l",\u013c:"l",\u013e:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014a:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014b:"n",\u014c:"O",\u014e:"O",\u0150:"O",\u014d:"o",\u014f:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015a:"S",\u015c:"S",\u015e:"S",\u0160:"S",\u015b:"s",\u015d:"s",\u015f:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016a:"U",\u016c:"U",\u016e:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016b:"u",\u016d:"u",\u016f:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017b:"Z",\u017d:"Z",\u017a:"z",\u017c:"z",\u017e:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017f:"s"}),AF=Wo({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function MF(ot){return"\\"+ln[ot]}function Rh(ot){return s1.test(ot)}function qv(ot){var It=-1,yt=Array(ot.size);return ot.forEach(function(un,Tn){yt[++It]=[Tn,un]}),yt}function h1(ot,It){return function(yt){return ot(It(yt))}}function yu(ot,It){for(var yt=-1,un=ot.length,Tn=0,Ri=[];++yt<un;){var Qr=ot[yt];(Qr===It||Qr===k)&&(ot[yt]=k,Ri[Tn++]=yt)}return Ri}function Km(ot){var It=-1,yt=Array(ot.size);return ot.forEach(function(un){yt[++It]=un}),yt}function Nh(ot){return Rh(ot)?function(ot){for(var It=Ah.lastIndex=0;Ah.test(ot);)++It;return It}(ot):sr(ot)}function Za(ot){return Rh(ot)?function(ot){return ot.match(Ah)||[]}(ot):function(ot){return ot.split("")}(ot)}function xc(ot){for(var It=ot.length;It--&&Et.test(ot.charAt(It)););return It}var Qm=Wo({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),Ph=function ot(It){var d,yt=(It=null==It?Fi:Ph.defaults(Fi.Object(),It,Ph.pick(Fi,Mh))).Array,un=It.Date,Tn=It.Error,Ri=It.Function,Qr=It.Math,Hi=It.Object,Zm=It.RegExp,Jm=It.String,xa=It.TypeError,lr=yt.prototype,vu=Hi.prototype,lp=It["__core-js_shared__"],vr=Ri.prototype.toString,Gi=vu.hasOwnProperty,PF=0,Fh=(d=/[^.]+$/.exec(lp&&lp.keys&&lp.keys.IE_PROTO||""))?"Symbol(src)_1."+d:"",Zs=vu.toString,g1=vr.call(Hi),e_=Fi._,Cd=Zm("^"+vr.call(Gi).replace(ke,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Us=Mo?It.Buffer:J,Fl=It.Symbol,Td=It.Uint8Array,Xv=Us?Us.allocUnsafe:J,Ca=h1(Hi.getPrototypeOf,Hi),t_=Hi.create,cp=vu.propertyIsEnumerable,Ln=lr.splice,m1=Fl?Fl.isConcatSpreadable:J,Lh=Fl?Fl.iterator:J,bu=Fl?Fl.toStringTag:J,up=function(){try{var d=Pc(Hi,"defineProperty");return d({},"",{}),d}catch(f){}}(),Qv=It.clearTimeout!==Fi.clearTimeout&&It.clearTimeout,_1=un&&un.now!==Fi.Date.now&&un.now,y1=It.setTimeout!==Fi.setTimeout&&It.setTimeout,Bt=Qr.ceil,gi=Qr.floor,Ir=Hi.getOwnPropertySymbols,ss=Us?Us.isBuffer:J,n_=It.isFinite,kh=lr.join,Ja=h1(Hi.keys,Hi),Ur=Qr.max,ps=Qr.min,FF=un.now,v1=It.parseInt,Bh=Qr.random,dp=lr.reverse,xs=Pc(It,"DataView"),go=Pc(It,"Map"),hp=Pc(It,"Promise"),Ta=Pc(It,"Set"),Io=Pc(It,"WeakMap"),Vh=Pc(Hi,"create"),jh=Io&&new Io,Ad={},b1=Ru(xs),i_=Ru(go),r_=Ru(hp),Zv=Ru(Ta),s_=Ru(Io),fp=Fl?Fl.prototype:J,Md=fp?fp.valueOf:J,Uh=fp?fp.toString:J;function Ee(d){if(Er(d)&&!Dn(d)&&!(d instanceof li)){if(d instanceof Oo)return d;if(Gi.call(d,"__wrapped__"))return kp(d)}return new Oo(d)}var wu=function(){function d(){}return function(f){if(!wr(f))return{};if(t_)return t_(f);d.prototype=f;var _=new d;return d.prototype=J,_}}();function zh(){}function Oo(d,f){this.__wrapped__=d,this.__actions__=[],this.__chain__=!!f,this.__index__=0,this.__values__=J}function li(d){this.__wrapped__=d,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=_e,this.__views__=[]}function mo(d){var f=-1,_=null==d?0:d.length;for(this.clear();++f<_;){var F=d[f];this.set(F[0],F[1])}}function Ll(d){var f=-1,_=null==d?0:d.length;for(this.clear();++f<_;){var F=d[f];this.set(F[0],F[1])}}function el(d){var f=-1,_=null==d?0:d.length;for(this.clear();++f<_;){var F=d[f];this.set(F[0],F[1])}}function Aa(d){var f=-1,_=null==d?0:d.length;for(this.__data__=new el;++f<_;)this.add(d[f])}function Ma(d){var f=this.__data__=new Ll(d);this.size=f.size}function Gh(d,f){var _=Dn(d),F=!_&&cl(d),le=!_&&!F&&ul(d),Ce=!_&&!F&&!le&&of(d),ze=_||F||le||Ce,Ye=ze?xd(d.length,Jm):[],lt=Ye.length;for(var Nt in d)(f||Gi.call(d,Nt))&&(!ze||!("length"==Nt||le&&("offset"==Nt||"parent"==Nt)||Ce&&("buffer"==Nt||"byteLength"==Nt||"byteOffset"==Nt)||Po(Nt,lt)))&&Ye.push(Nt);return Ye}function c_(d){var f=d.length;return f?d[kl(0,f-1)]:J}function eb(d,f){return Hd(eo(d),Eu(f,0,d.length))}function Dd(d){return Hd(eo(d))}function u_(d,f,_){(_!==J&&!An(d[f],_)||_===J&&!(f in d))&&nl(d,f,_)}function tl(d,f,_){var F=d[f];(!Gi.call(d,f)||!An(F,_)||_===J&&!(f in d))&&nl(d,f,_)}function Id(d,f){for(var _=d.length;_--;)if(An(d[_][0],f))return _;return-1}function yp(d,f,_,F){return Ac(d,function(le,Ce,ze){f(F,le,_(le),ze)}),F}function R1(d,f){return d&&Ia(f,Ds(f),d)}function nl(d,f,_){"__proto__"==f&&up?up(d,f,{configurable:!0,enumerable:!0,value:_,writable:!0}):d[f]=_}function d_(d,f){for(var _=-1,F=f.length,le=yt(F),Ce=null==d;++_<F;)le[_]=Ce?J:cf(d,f[_]);return le}function Eu(d,f,_){return d==d&&(_!==J&&(d=d<=_?d:_),f!==J&&(d=d>=f?d:f)),d}function zs(d,f,_,F,le,Ce){var ze,Ye=1&f,lt=2&f,Nt=4&f;if(_&&(ze=le?_(d,F,le,Ce):_(d)),ze!==J)return ze;if(!wr(d))return d;var Pt=Dn(d);if(Pt){if(ze=function(d){var f=d.length,_=new d.constructor(f);return f&&"string"==typeof d[0]&&Gi.call(d,"index")&&(_.index=d.index,_.input=d.input),_}(d),!Ye)return eo(d,ze)}else{var jt=Gs(d),tn=jt==je||jt==qe;if(ul(d))return Tp(d,Ye);if(jt==fe||jt==Qe||tn&&!le){if(ze=lt||tn?{}:Sb(d),!Ye)return lt?function(d,f){return Ia(d,bb(d),f)}(d,function(d,f){return d&&Ia(f,no(f),d)}(ze,d)):function(d,f){return Ia(d,A_(d),f)}(d,R1(ze,d))}else{if(!rr[jt])return le?d:{};ze=function(d,f,_){var F=d.constructor;switch(f){case Ze:return Mu(d);case Ue:case Le:return new F(+d);case bt:return function(d,f){var _=f?Mu(d.buffer):d.buffer;return new d.constructor(_,d.byteOffset,d.byteLength)}(d,_);case Rt:case Mn:case Nn:case Gn:case wi:case pi:case Wr:case Ls:case fs:return E_(d,_);case Ne:return new F;case $:case be:return new F(d);case gt:return function(d){var f=new d.constructor(d.source,$n.exec(d));return f.lastIndex=d.lastIndex,f}(d);case ft:return new F;case B:return function(d){return Md?Hi(Md.call(d)):{}}(d)}}(d,jt,Ye)}}Ce||(Ce=new Ma);var bn=Ce.get(d);if(bn)return bn;Ce.set(d,ze),JT(d)?d.forEach(function(kn){ze.add(zs(kn,f,_,kn,d,Ce))}):KT(d)&&d.forEach(function(kn,di){ze.set(di,zs(kn,f,_,di,d,Ce))});var ui=Pt?J:(Nt?lt?C_:Ul:lt?no:Ds)(d);return js(ui||d,function(kn,di){ui&&(kn=d[di=kn]),tl(ze,di,zs(kn,f,_,di,d,Ce))}),ze}function vp(d,f,_){var F=_.length;if(null==d)return!F;for(d=Hi(d);F--;){var le=_[F],ze=d[le];if(ze===J&&!(le in d)||!(0,f[le])(ze))return!1}return!0}function $h(d,f,_){if("function"!=typeof d)throw new xa(Me);return Zh(function(){d.apply(J,_)},f)}function Tc(d,f,_,F){var le=-1,Ce=Pl,ze=!0,Ye=d.length,lt=[],Nt=f.length;if(!Ye)return lt;_&&(f=Ui(f,Yo(_))),F?(Ce=Dh,ze=!1):f.length>=200&&(Ce=Oh,ze=!1,f=new Aa(f));e:for(;++le<Ye;){var Pt=d[le],jt=null==_?Pt:_(Pt);if(Pt=F||0!==Pt?Pt:0,ze&&jt==jt){for(var tn=Nt;tn--;)if(f[tn]===jt)continue e;lt.push(Pt)}else Ce(f,jt,F)||lt.push(Pt)}return lt}Ee.templateSettings={escape:Xa,evaluate:rt,interpolate:at,variable:"",imports:{_:Ee}},(Ee.prototype=zh.prototype).constructor=Ee,(Oo.prototype=wu(zh.prototype)).constructor=Oo,(li.prototype=wu(zh.prototype)).constructor=li,mo.prototype.clear=function(){this.__data__=Vh?Vh(null):{},this.size=0},mo.prototype.delete=function(d){var f=this.has(d)&&delete this.__data__[d];return this.size-=f?1:0,f},mo.prototype.get=function(d){var f=this.__data__;if(Vh){var _=f[d];return _===Y?J:_}return Gi.call(f,d)?f[d]:J},mo.prototype.has=function(d){var f=this.__data__;return Vh?f[d]!==J:Gi.call(f,d)},mo.prototype.set=function(d,f){var _=this.__data__;return this.size+=this.has(d)?0:1,_[d]=Vh&&f===J?Y:f,this},Ll.prototype.clear=function(){this.__data__=[],this.size=0},Ll.prototype.delete=function(d){var f=this.__data__,_=Id(f,d);return!(_<0||(_==f.length-1?f.pop():Ln.call(f,_,1),--this.size,0))},Ll.prototype.get=function(d){var f=this.__data__,_=Id(f,d);return _<0?J:f[_][1]},Ll.prototype.has=function(d){return Id(this.__data__,d)>-1},Ll.prototype.set=function(d,f){var _=this.__data__,F=Id(_,d);return F<0?(++this.size,_.push([d,f])):_[F][1]=f,this},el.prototype.clear=function(){this.size=0,this.__data__={hash:new mo,map:new(go||Ll),string:new mo}},el.prototype.delete=function(d){var f=Hs(this,d).delete(d);return this.size-=f?1:0,f},el.prototype.get=function(d){return Hs(this,d).get(d)},el.prototype.has=function(d){return Hs(this,d).has(d)},el.prototype.set=function(d,f){var _=Hs(this,d),F=_.size;return _.set(d,f),this.size+=_.size==F?0:1,this},Aa.prototype.add=Aa.prototype.push=function(d){return this.__data__.set(d,Y),this},Aa.prototype.has=function(d){return this.__data__.has(d)},Ma.prototype.clear=function(){this.__data__=new Ll,this.size=0},Ma.prototype.delete=function(d){var f=this.__data__,_=f.delete(d);return this.size=f.size,_},Ma.prototype.get=function(d){return this.__data__.get(d)},Ma.prototype.has=function(d){return this.__data__.has(d)},Ma.prototype.set=function(d,f){var _=this.__data__;if(_ instanceof Ll){var F=_.__data__;if(!go||F.length<199)return F.push([d,f]),this.size=++_.size,this;_=this.__data__=new el(F)}return _.set(d,f),this.size=_.size,this};var Ac=sl(il),f_=sl(bp,!0);function nb(d,f){var _=!0;return Ac(d,function(F,le,Ce){return _=!!f(F,le,Ce)}),_}function Wh(d,f,_){for(var F=-1,le=d.length;++F<le;){var Ce=d[F],ze=f(Ce);if(null!=ze&&(Ye===J?ze==ze&&!sa(ze):_(ze,Ye)))var Ye=ze,lt=Ce}return lt}function rb(d,f){var _=[];return Ac(d,function(F,le,Ce){f(F,le,Ce)&&_.push(F)}),_}function Cs(d,f,_,F,le){var Ce=-1,ze=d.length;for(_||(_=X1),le||(le=[]);++Ce<ze;){var Ye=d[Ce];f>0&&_(Ye)?f>1?Cs(Ye,f-1,_,F,le):jr(le,Ye):F||(le[le.length]=Ye)}return le}var Od=db(),Rd=db(!0);function il(d,f){return d&&Od(d,f,Ds)}function bp(d,f){return d&&Rd(d,f,Ds)}function qh(d,f){return Ea(f,function(_){return ra(d[_])})}function Ko(d,f){for(var _=0,F=(f=Oc(f,d)).length;null!=d&&_<F;)d=d[ti(f[_++])];return _&&_==F?d:J}function $i(d,f,_){var F=f(d);return Dn(d)?F:jr(F,_(d))}function Ts(d){return null==d?d===J?"[object Undefined]":"[object Null]":bu&&bu in Hi(d)?function(d){var f=Gi.call(d,bu),_=d[bu];try{d[bu]=J;var F=!0}catch(Ce){}var le=Zs.call(d);return F&&(f?d[bu]=_:delete d[bu]),le}(d):function(d){return Zs.call(d)}(d)}function Xo(d,f){return d>f}function Nd(d,f){return null!=d&&Gi.call(d,f)}function Pd(d,f){return null!=d&&f in Hi(d)}function Su(d,f,_){for(var F=_?Dh:Pl,le=d[0].length,Ce=d.length,ze=Ce,Ye=yt(Ce),lt=1/0,Nt=[];ze--;){var Pt=d[ze];ze&&f&&(Pt=Ui(Pt,Yo(f))),lt=ps(Pt.length,lt),Ye[ze]=!_&&(f||le>=120&&Pt.length>=120)?new Aa(ze&&Pt):J}Pt=d[0];var jt=-1,tn=Ye[0];e:for(;++jt<le&&Nt.length<lt;){var bn=Pt[jt],Fn=f?f(bn):bn;if(bn=_||0!==bn?bn:0,!(tn?Oh(tn,Fn):F(Nt,Fn,_))){for(ze=Ce;--ze;){var ui=Ye[ze];if(!(ui?Oh(ui,Fn):F(d[ze],Fn,_)))continue e}tn&&tn.push(Fn),Nt.push(bn)}}return Nt}function Da(d,f,_){var F=null==(d=O_(d,f=Oc(f,d)))?d:d[ti(ta(f))];return null==F?J:rs(F,d,_)}function N1(d){return Er(d)&&Ts(d)==Qe}function wp(d,f,_,F,le){return d===f||(null==d||null==f||!Er(d)&&!Er(f)?d!=d&&f!=f:function(d,f,_,F,le,Ce){var ze=Dn(d),Ye=Dn(f),lt=ze?et:Gs(d),Nt=Ye?et:Gs(f),Pt=(lt=lt==Qe?fe:lt)==fe,jt=(Nt=Nt==Qe?fe:Nt)==fe,tn=lt==Nt;if(tn&&ul(d)){if(!ul(f))return!1;ze=!0,Pt=!1}if(tn&&!Pt)return Ce||(Ce=new Ma),ze||of(d)?Rp(d,f,_,F,le,Ce):function(d,f,_,F,le,Ce,ze){switch(_){case bt:if(d.byteLength!=f.byteLength||d.byteOffset!=f.byteOffset)return!1;d=d.buffer,f=f.buffer;case Ze:return!(d.byteLength!=f.byteLength||!Ce(new Td(d),new Td(f)));case Ue:case Le:case $:return An(+d,+f);case Te:return d.name==f.name&&d.message==f.message;case gt:case be:return d==f+"";case Ne:var Ye=qv;case ft:if(Ye||(Ye=Km),d.size!=f.size&&!(1&F))return!1;var Nt=ze.get(d);if(Nt)return Nt==f;F|=2,ze.set(d,f);var Pt=Rp(Ye(d),Ye(f),F,le,Ce,ze);return ze.delete(d),Pt;case B:if(Md)return Md.call(d)==Md.call(f)}return!1}(d,f,lt,_,F,le,Ce);if(!(1&_)){var bn=Pt&&Gi.call(d,"__wrapped__"),Fn=jt&&Gi.call(f,"__wrapped__");if(bn||Fn){var ui=bn?d.value():d,kn=Fn?f.value():f;return Ce||(Ce=new Ma),le(ui,kn,_,F,Ce)}}return!!tn&&(Ce||(Ce=new Ma),function(d,f,_,F,le,Ce){var ze=1&_,Ye=Ul(d),lt=Ye.length;if(lt!=Ul(f).length&&!ze)return!1;for(var jt=lt;jt--;){var tn=Ye[jt];if(!(ze?tn in f:Gi.call(f,tn)))return!1}var bn=Ce.get(d),Fn=Ce.get(f);if(bn&&Fn)return bn==f&&Fn==d;var ui=!0;Ce.set(d,f),Ce.set(f,d);for(var kn=ze;++jt<lt;){var di=d[tn=Ye[jt]],Ei=f[tn];if(F)var vo=ze?F(Ei,di,tn,f,d,Ce):F(di,Ei,tn,d,f,Ce);if(!(vo===J?di===Ei||le(di,Ei,_,F,Ce):vo)){ui=!1;break}kn||(kn="constructor"==tn)}if(ui&&!kn){var Ws=d.constructor,oa=f.constructor;Ws!=oa&&"constructor"in d&&"constructor"in f&&!("function"==typeof Ws&&Ws instanceof Ws&&"function"==typeof oa&&oa instanceof oa)&&(ui=!1)}return Ce.delete(d),Ce.delete(f),ui}(d,f,_,F,le,Ce))}(d,f,_,F,wp,le))}function g_(d,f,_,F){var le=_.length,Ce=le,ze=!F;if(null==d)return!Ce;for(d=Hi(d);le--;){var Ye=_[le];if(ze&&Ye[2]?Ye[1]!==d[Ye[0]]:!(Ye[0]in d))return!1}for(;++le<Ce;){var lt=(Ye=_[le])[0],Nt=d[lt],Pt=Ye[1];if(ze&&Ye[2]){if(Nt===J&&!(lt in d))return!1}else{var jt=new Ma;if(F)var tn=F(Nt,Pt,lt,d,f,jt);if(!(tn===J?wp(Pt,Nt,3,F,jt):tn))return!1}}return!0}function m_(d){return!(!wr(d)||function(d){return!!Fh&&Fh in d}(d))&&(ra(d)?Cd:ir).test(Ru(d))}function L1(d){return"function"==typeof d?d:null==d?io:"object"==typeof d?Dn(d)?Ld(d[0],d[1]):B1(d):Fu(d)}function sb(d){if(!Fp(d))return Ja(d);var f=[];for(var _ in Hi(d))Gi.call(d,_)&&"constructor"!=_&&f.push(_);return f}function ob(d,f){return d<f}function k1(d,f){var _=-1,F=_o(d)?yt(d.length):[];return Ac(d,function(le,Ce,ze){F[++_]=f(le,Ce,ze)}),F}function B1(d){var f=Jo(d);return 1==f.length&&f[0][2]?Z1(f[0][0],f[0][1]):function(_){return _===d||g_(_,d,f)}}function Ld(d,f){return ea(d)&&Q1(f)?Z1(ti(d),f):function(_){var F=cf(_,d);return F===J&&F===f?Yp(_,d):wp(f,F,3)}}function __(d,f,_,F,le){d!==f&&Od(f,function(Ce,ze){if(le||(le=new Ma),wr(Ce))!function(d,f,_,F,le,Ce,ze){var Ye=R_(d,_),lt=R_(f,_),Nt=ze.get(lt);if(Nt)u_(d,_,Nt);else{var Pt=Ce?Ce(Ye,lt,_+"",d,f,ze):J,jt=Pt===J;if(jt){var tn=Dn(lt),bn=!tn&&ul(lt),Fn=!tn&&!bn&&of(lt);Pt=lt,tn||bn||Fn?Dn(Ye)?Pt=Ye:br(Ye)?Pt=eo(Ye):bn?(jt=!1,Pt=Tp(lt,!0)):Fn?(jt=!1,Pt=E_(lt,!0)):Pt=[]:qp(lt)||cl(lt)?(Pt=Ye,cl(Ye)?Pt=gw(Ye):(!wr(Ye)||ra(Ye))&&(Pt=Sb(lt))):jt=!1}jt&&(ze.set(lt,Pt),le(Pt,lt,F,Ce,ze),ze.delete(lt)),u_(d,_,Pt)}}(d,f,ze,_,__,F,le);else{var Ye=F?F(R_(d,ze),Ce,ze+"",d,f,le):J;Ye===J&&(Ye=Ce),u_(d,ze,Ye)}},no)}function xu(d,f){var _=d.length;if(_)return Po(f+=f<0?_:0,_)?d[f]:J}function Yh(d,f,_){f=f.length?Ui(f,function(Ce){return Dn(Ce)?function(ze){return Ko(ze,1===Ce.length?Ce[0]:Ce)}:Ce}):[io];var F=-1;return f=Ui(f,Yo(Pn())),function(ot,It){var yt=ot.length;for(ot.sort(function(Ce,ze){return function(d,f,_){for(var F=-1,le=d.criteria,Ce=f.criteria,ze=le.length,Ye=_.length;++F<ze;){var lt=Rc(le[F],Ce[F]);if(lt)return F>=Ye?lt:lt*("desc"==_[F]?-1:1)}return d.index-f.index}(Ce,ze,_)});yt--;)ot[yt]=ot[yt].value;return ot}(k1(d,function(Ce,ze,Ye){return{criteria:Ui(f,function(Nt){return Nt(Ce)}),index:++F,value:Ce}}))}function ab(d,f,_){for(var F=-1,le=f.length,Ce={};++F<le;){var ze=f[F],Ye=Ko(d,ze);_(Ye,ze)&&Sp(Ce,Oc(ze,d),Ye)}return Ce}function Zo(d,f,_,F){var le=F?ap:Qa,Ce=-1,ze=f.length,Ye=d;for(d===f&&(f=eo(f)),_&&(Ye=Ui(d,Yo(_)));++Ce<ze;)for(var lt=0,Nt=f[Ce],Pt=_?_(Nt):Nt;(lt=le(Ye,Pt,lt,F))>-1;)Ye!==d&&Ln.call(Ye,lt,1),Ln.call(d,lt,1);return d}function Kh(d,f){for(var _=d?f.length:0,F=_-1;_--;){var le=f[_];if(_==F||le!==Ce){var Ce=le;Po(le)?Ln.call(d,le,1):Cu(d,le)}}return d}function kl(d,f){return d+gi(Bh()*(f-d+1))}function Ep(d,f){var _="";if(!d||f<1||f>xe)return _;do{f%2&&(_+=d),(f=gi(f/2))&&(d+=d)}while(f);return _}function ci(d,f){return Lp(J1(d,f,io),d+"")}function V1(d){return c_(Zd(d))}function GF(d,f){var _=Zd(d);return Hd(_,Eu(f,0,_.length))}function Sp(d,f,_,F){if(!wr(d))return d;for(var le=-1,Ce=(f=Oc(f,d)).length,ze=Ce-1,Ye=d;null!=Ye&&++le<Ce;){var lt=ti(f[le]),Nt=_;if("__proto__"===lt||"constructor"===lt||"prototype"===lt)return d;if(le!=ze){var Pt=Ye[lt];(Nt=F?F(Pt,lt,Ye):J)===J&&(Nt=wr(Pt)?Pt:Po(f[le+1])?[]:{})}tl(Ye,lt,Nt),Ye=Ye[lt]}return d}var y_=jh?function(d,f){return jh.set(d,f),d}:io,Ro=up?function(d,f){return up(d,"toString",{configurable:!0,enumerable:!1,value:vy(f),writable:!0})}:io;function v_(d){return Hd(Zd(d))}function As(d,f,_){var F=-1,le=d.length;f<0&&(f=-f>le?0:le+f),(_=_>le?le:_)<0&&(_+=le),le=f>_?0:_-f>>>0,f>>>=0;for(var Ce=yt(le);++F<le;)Ce[F]=d[F+f];return Ce}function $F(d,f){var _;return Ac(d,function(F,le,Ce){return!(_=f(F,le,Ce))}),!!_}function Xh(d,f,_){var F=0,le=null==d?F:d.length;if("number"==typeof f&&f==f&&le<=2147483647){for(;F<le;){var Ce=F+le>>>1,ze=d[Ce];null!==ze&&!sa(ze)&&(_?ze<=f:ze<f)?F=Ce+1:le=Ce}return le}return b_(d,f,io,_)}function b_(d,f,_,F){var le=0,Ce=null==d?0:d.length;if(0===Ce)return 0;for(var ze=(f=_(f))!=f,Ye=null===f,lt=sa(f),Nt=f===J;le<Ce;){var Pt=gi((le+Ce)/2),jt=_(d[Pt]),tn=jt!==J,bn=null===jt,Fn=jt==jt,ui=sa(jt);if(ze)var kn=F||Fn;else kn=Nt?Fn&&(F||tn):Ye?Fn&&tn&&(F||!bn):lt?Fn&&tn&&!bn&&(F||!ui):!bn&&!ui&&(F?jt<=f:jt<f);kn?le=Pt+1:Ce=Pt}return ps(Ce,4294967294)}function lb(d,f){for(var _=-1,F=d.length,le=0,Ce=[];++_<F;){var ze=d[_],Ye=f?f(ze):ze;if(!_||!An(Ye,lt)){var lt=Ye;Ce[le++]=0===ze?0:ze}}return Ce}function cb(d){return"number"==typeof d?d:sa(d)?NaN:+d}function No(d){if("string"==typeof d)return d;if(Dn(d))return Ui(d,No)+"";if(sa(d))return Uh?Uh.call(d):"";var f=d+"";return"0"==f&&1/d==-ee?"-0":f}function Dc(d,f,_){var F=-1,le=Pl,Ce=d.length,ze=!0,Ye=[],lt=Ye;if(_)ze=!1,le=Dh;else if(Ce>=200){var Nt=f?null:x_(d);if(Nt)return Km(Nt);ze=!1,le=Oh,lt=new Aa}else lt=f?[]:Ye;e:for(;++F<Ce;){var Pt=d[F],jt=f?f(Pt):Pt;if(Pt=_||0!==Pt?Pt:0,ze&&jt==jt){for(var tn=lt.length;tn--;)if(lt[tn]===jt)continue e;f&&lt.push(jt),Ye.push(Pt)}else le(lt,jt,_)||(lt!==Ye&&lt.push(jt),Ye.push(Pt))}return Ye}function Cu(d,f){return null==(d=O_(d,f=Oc(f,d)))||delete d[ti(ta(f))]}function xp(d,f,_,F){return Sp(d,f,_(Ko(d,f)),F)}function Tu(d,f,_,F){for(var le=d.length,Ce=F?le:-1;(F?Ce--:++Ce<le)&&f(d[Ce],Ce,d););return _?As(d,F?0:Ce,F?Ce+1:le):As(d,F?Ce+1:0,F?le:Ce)}function j1(d,f){var _=d;return _ instanceof li&&(_=_.value()),_u(f,function(F,le){return le.func.apply(le.thisArg,jr([F],le.args))},_)}function Au(d,f,_){var F=d.length;if(F<2)return F?Dc(d[0]):[];for(var le=-1,Ce=yt(F);++le<F;)for(var ze=d[le],Ye=-1;++Ye<F;)Ye!=le&&(Ce[le]=Tc(Ce[le]||ze,d[Ye],f,_));return Dc(Cs(Ce,1),f,_)}function Cp(d,f,_){for(var F=-1,le=d.length,Ce=f.length,ze={};++F<le;)_(ze,d[F],F<Ce?f[F]:J);return ze}function Ic(d){return br(d)?d:[]}function w_(d){return"function"==typeof d?d:io}function Oc(d,f){return Dn(d)?d:ea(d,f)?[d]:Ab(Li(d))}var U1=ci;function rl(d,f,_){var F=d.length;return _=_===J?F:_,!f&&_>=F?d:As(d,f,_)}var z1=Qv||function(d){return Fi.clearTimeout(d)};function Tp(d,f){if(f)return d.slice();var _=d.length,F=Xv?Xv(_):new d.constructor(_);return d.copy(F),F}function Mu(d){var f=new d.constructor(d.byteLength);return new Td(f).set(new Td(d)),f}function E_(d,f){var _=f?Mu(d.buffer):d.buffer;return new d.constructor(_,d.byteOffset,d.length)}function Rc(d,f){if(d!==f){var _=d!==J,F=null===d,le=d==d,Ce=sa(d),ze=f!==J,Ye=null===f,lt=f==f,Nt=sa(f);if(!Ye&&!Nt&&!Ce&&d>f||Ce&&ze&&lt&&!Ye&&!Nt||F&&ze&&lt||!_&&lt||!le)return 1;if(!F&&!Ce&&!Nt&&d<f||Nt&&_&&le&&!F&&!Ce||Ye&&_&&le||!ze&&le||!lt)return-1}return 0}function Bd(d,f,_,F){for(var le=-1,Ce=d.length,ze=_.length,Ye=-1,lt=f.length,Nt=Ur(Ce-ze,0),Pt=yt(lt+Nt),jt=!F;++Ye<lt;)Pt[Ye]=f[Ye];for(;++le<ze;)(jt||le<Ce)&&(Pt[_[le]]=d[le]);for(;Nt--;)Pt[Ye++]=d[le++];return Pt}function ub(d,f,_,F){for(var le=-1,Ce=d.length,ze=-1,Ye=_.length,lt=-1,Nt=f.length,Pt=Ur(Ce-Ye,0),jt=yt(Pt+Nt),tn=!F;++le<Pt;)jt[le]=d[le];for(var bn=le;++lt<Nt;)jt[bn+lt]=f[lt];for(;++ze<Ye;)(tn||le<Ce)&&(jt[bn+_[ze]]=d[le++]);return jt}function eo(d,f){var _=-1,F=d.length;for(f||(f=yt(F));++_<F;)f[_]=d[_];return f}function Ia(d,f,_,F){var le=!_;_||(_={});for(var Ce=-1,ze=f.length;++Ce<ze;){var Ye=f[Ce],lt=F?F(_[Ye],d[Ye],Ye,_,d):J;lt===J&&(lt=d[Ye]),le?nl(_,Ye,lt):tl(_,Ye,lt)}return _}function Zr(d,f){return function(_,F){var le=Dn(_)?Vr:yp,Ce=f?f():{};return le(_,d,Pn(F,2),Ce)}}function Bl(d){return ci(function(f,_){var F=-1,le=_.length,Ce=le>1?_[le-1]:J,ze=le>2?_[2]:J;for(Ce=d.length>3&&"function"==typeof Ce?(le--,Ce):J,ze&&$s(_[0],_[1],ze)&&(Ce=le<3?J:Ce,le=1),f=Hi(f);++F<le;){var Ye=_[F];Ye&&d(f,Ye,F,Ce)}return f})}function sl(d,f){return function(_,F){if(null==_)return _;if(!_o(_))return d(_,F);for(var le=_.length,Ce=f?le:-1,ze=Hi(_);(f?Ce--:++Ce<le)&&!1!==F(ze[Ce],Ce,ze););return _}}function db(d){return function(f,_,F){for(var le=-1,Ce=Hi(f),ze=F(f),Ye=ze.length;Ye--;){var lt=ze[d?Ye:++le];if(!1===_(Ce[lt],lt,Ce))break}return f}}function Ap(d){return function(f){var _=Rh(f=Li(f))?Za(f):J,F=_?_[0]:f.charAt(0),le=_?rl(_,1).join(""):f.slice(1);return F[d]()+le}}function Vl(d){return function(f){return _u(_y(uy(f).replace(op,"")),d,"")}}function jd(d){return function(){var f=arguments;switch(f.length){case 0:return new d;case 1:return new d(f[0]);case 2:return new d(f[0],f[1]);case 3:return new d(f[0],f[1],f[2]);case 4:return new d(f[0],f[1],f[2],f[3]);case 5:return new d(f[0],f[1],f[2],f[3],f[4]);case 6:return new d(f[0],f[1],f[2],f[3],f[4],f[5]);case 7:return new d(f[0],f[1],f[2],f[3],f[4],f[5],f[6])}var _=wu(d.prototype),F=d.apply(_,f);return wr(F)?F:_}}function fb(d){return function(f,_,F){var le=Hi(f);if(!_o(f)){var Ce=Pn(_,3);f=Ds(f),_=function(Ye){return Ce(le[Ye],Ye,le)}}var ze=d(f,_,F);return ze>-1?le[Ce?f[ze]:ze]:J}}function Iu(d){return ol(function(f){var _=f.length,F=_,le=Oo.prototype.thru;for(d&&f.reverse();F--;){var Ce=f[F];if("function"!=typeof Ce)throw new xa(Me);if(le&&!ze&&"wrapper"==Np(Ce))var ze=new Oo([],!0)}for(F=ze?F:_;++F<_;){var Ye=Np(Ce=f[F]),lt="wrapper"==Ye?T_(Ce):J;ze=lt&&Pp(lt[0])&&424==lt[1]&&!lt[4].length&&1==lt[9]?ze[Np(lt[0])].apply(ze,lt[3]):1==Ce.length&&Pp(Ce)?ze[Ye]():ze.thru(Ce)}return function(){var Nt=arguments,Pt=Nt[0];if(ze&&1==Nt.length&&Dn(Pt))return ze.plant(Pt).value();for(var jt=0,tn=_?f[jt].apply(this,Nt):Pt;++jt<_;)tn=f[jt].call(this,tn);return tn}})}function Nc(d,f,_,F,le,Ce,ze,Ye,lt,Nt){var Pt=f&q,jt=1&f,tn=2&f,bn=24&f,Fn=512&f,ui=tn?J:jd(d);return function kn(){for(var di=arguments.length,Ei=yt(di),vo=di;vo--;)Ei[vo]=arguments[vo];if(bn)var Ws=zd(kn),oa=CF(Ei,Ws);if(F&&(Ei=Bd(Ei,F,le,bn)),Ce&&(Ei=ub(Ei,Ce,ze,bn)),di-=oa,bn&&di<Nt){var ki=yu(Ei,Ws);return mb(d,f,Nc,kn.placeholder,_,Ei,ki,Ye,lt,Nt-di)}var fl=jt?_:this,Bc=tn?fl[d]:d;return di=Ei.length,Ye?Ei=eT(Ei,Ye):Fn&&di>1&&Ei.reverse(),Pt&&lt<di&&(Ei.length=lt),this&&this!==Fi&&this instanceof kn&&(Bc=ui||jd(Bc)),Bc.apply(fl,Ei)}}function pb(d,f){return function(_,F){return function(d,f,_,F){return il(d,function(le,Ce,ze){f(F,_(le),Ce,ze)}),F}(_,d,f(F),{})}}function S_(d,f){return function(_,F){var le;if(_===J&&F===J)return f;if(_!==J&&(le=_),F!==J){if(le===J)return F;"string"==typeof _||"string"==typeof F?(_=No(_),F=No(F)):(_=cb(_),F=cb(F)),le=d(_,F)}return le}}function Mp(d){return ol(function(f){return f=Ui(f,Yo(Pn())),ci(function(_){var F=this;return d(f,function(le){return rs(le,F,_)})})})}function Dp(d,f){var _=(f=f===J?" ":No(f)).length;if(_<2)return _?Ep(f,d):f;var F=Ep(f,Bt(d/Nh(f)));return Rh(f)?rl(Za(F),0,d).join(""):F.slice(0,d)}function gb(d){return function(f,_,F){return F&&"number"!=typeof F&&$s(f,_,F)&&(_=F=J),f=dl(f),_===J?(_=f,f=0):_=dl(_),function(d,f,_,F){for(var le=-1,Ce=Ur(Bt((f-d)/(_||1)),0),ze=yt(Ce);Ce--;)ze[F?Ce:++le]=d,d+=_;return ze}(f,_,F=F===J?f<_?1:-1:dl(F),d)}}function Ip(d){return function(f,_){return"string"==typeof f&&"string"==typeof _||(f=yo(f),_=yo(_)),d(f,_)}}function mb(d,f,_,F,le,Ce,ze,Ye,lt,Nt){var Pt=8&f;f|=Pt?j:64,4&(f&=~(Pt?64:j))||(f&=-4);var ui=[d,f,le,Pt?Ce:J,Pt?ze:J,Pt?J:Ce,Pt?J:ze,Ye,lt,Nt],kn=_.apply(J,ui);return Pp(d)&&Tb(kn,ui),kn.placeholder=F,Jh(kn,d,f)}function Ud(d){var f=Qr[d];return function(_,F){if(_=yo(_),(F=null==F?0:ps(Qn(F),292))&&n_(_)){var le=(Li(_)+"e").split("e");return+((le=(Li(f(le[0]+"e"+(+le[1]+F)))+"e").split("e"))[0]+"e"+(+le[1]-F))}return f(_)}}var x_=Ta&&1/Km(new Ta([,-0]))[1]==ee?function(d){return new Ta(d)}:Ey;function Ou(d){return function(f){var _=Gs(f);return _==Ne?qv(f):_==ft?function(ot){var It=-1,yt=Array(ot.size);return ot.forEach(function(un){yt[++It]=[un,un]}),yt}(f):function(ot,It){return Ui(It,function(yt){return[yt,ot[yt]]})}(f,d(f))}}function jl(d,f,_,F,le,Ce,ze,Ye){var lt=2&f;if(!lt&&"function"!=typeof d)throw new xa(Me);var Nt=F?F.length:0;if(Nt||(f&=-97,F=le=J),ze=ze===J?ze:Ur(Qn(ze),0),Ye=Ye===J?Ye:Qn(Ye),Nt-=le?le.length:0,64&f){var Pt=F,jt=le;F=le=J}var tn=lt?J:T_(d),bn=[d,f,_,F,le,Pt,jt,Ce,ze,Ye];if(tn&&function(d,f){var _=d[1],F=f[1],le=_|F;if(!(le<131||(F==q&&8==_||F==q&&256==_&&d[7].length<=f[8]||384==F&&f[7].length<=f[8]&&8==_)))return d;1&F&&(d[2]=f[2],le|=1&_?0:4);var Ye=f[3];if(Ye){var lt=d[3];d[3]=lt?Bd(lt,Ye,f[4]):Ye,d[4]=lt?yu(d[3],k):f[4]}(Ye=f[5])&&(d[5]=(lt=d[5])?ub(lt,Ye,f[6]):Ye,d[6]=lt?yu(d[5],k):f[6]),(Ye=f[7])&&(d[7]=Ye),F&q&&(d[8]=null==d[8]?f[8]:ps(d[8],f[8])),null==d[9]&&(d[9]=f[9]),d[0]=f[0],d[1]=le}(bn,tn),d=bn[0],f=bn[1],_=bn[2],F=bn[3],le=bn[4],!(Ye=bn[9]=bn[9]===J?lt?0:d.length:Ur(bn[9]-Nt,0))&&24&f&&(f&=-25),f&&1!=f)Fn=8==f||16==f?function(d,f,_){var F=jd(d);return function le(){for(var Ce=arguments.length,ze=yt(Ce),Ye=Ce,lt=zd(le);Ye--;)ze[Ye]=arguments[Ye];var Nt=Ce<3&&ze[0]!==lt&&ze[Ce-1]!==lt?[]:yu(ze,lt);return(Ce-=Nt.length)<_?mb(d,f,Nc,le.placeholder,J,ze,Nt,J,J,_-Ce):rs(this&&this!==Fi&&this instanceof le?F:d,this,ze)}}(d,f,Ye):f!=j&&33!=f||le.length?Nc.apply(J,bn):function(d,f,_,F){var le=1&f,Ce=jd(d);return function ze(){for(var Ye=-1,lt=arguments.length,Nt=-1,Pt=F.length,jt=yt(Pt+lt),tn=this&&this!==Fi&&this instanceof ze?Ce:d;++Nt<Pt;)jt[Nt]=F[Nt];for(;lt--;)jt[Nt++]=arguments[++Ye];return rs(tn,le?_:this,jt)}}(d,f,_,F);else var Fn=function(d,f,_){var F=1&f,le=jd(d);return function Ce(){return(this&&this!==Fi&&this instanceof Ce?le:d).apply(F?_:this,arguments)}}(d,f,_);return Jh((tn?y_:Tb)(Fn,bn),d,f)}function _b(d,f,_,F){return d===J||An(d,vu[_])&&!Gi.call(F,_)?f:d}function $1(d,f,_,F,le,Ce){return wr(d)&&wr(f)&&(Ce.set(f,d),__(d,f,J,$1,Ce),Ce.delete(f)),d}function Op(d){return qp(d)?J:d}function Rp(d,f,_,F,le,Ce){var ze=1&_,Ye=d.length,lt=f.length;if(Ye!=lt&&!(ze&&lt>Ye))return!1;var Nt=Ce.get(d),Pt=Ce.get(f);if(Nt&&Pt)return Nt==f&&Pt==d;var jt=-1,tn=!0,bn=2&_?new Aa:J;for(Ce.set(d,f),Ce.set(f,d);++jt<Ye;){var Fn=d[jt],ui=f[jt];if(F)var kn=ze?F(ui,Fn,jt,f,d,Ce):F(Fn,ui,jt,d,f,Ce);if(kn!==J){if(kn)continue;tn=!1;break}if(bn){if(!Do(f,function(di,Ei){if(!Oh(bn,Ei)&&(Fn===di||le(Fn,di,_,F,Ce)))return bn.push(Ei)})){tn=!1;break}}else if(Fn!==ui&&!le(Fn,ui,_,F,Ce)){tn=!1;break}}return Ce.delete(d),Ce.delete(f),tn}function ol(d){return Lp(J1(d,J,Ms),d+"")}function Ul(d){return $i(d,Ds,A_)}function C_(d){return $i(d,no,bb)}var T_=jh?function(d){return jh.get(d)}:Ey;function Np(d){for(var f=d.name+"",_=Ad[f],F=Gi.call(Ad,f)?_.length:0;F--;){var le=_[F],Ce=le.func;if(null==Ce||Ce==d)return le.name}return f}function zd(d){return(Gi.call(Ee,"placeholder")?Ee:d).placeholder}function Pn(){var d=Ee.iteratee||Pu;return d=d===Pu?L1:d,arguments.length?d(arguments[0],arguments[1]):d}function Hs(d,f){var _=d.__data__;return function(d){var f=typeof d;return"string"==f||"number"==f||"symbol"==f||"boolean"==f?"__proto__"!==d:null===d}(f)?_["string"==typeof f?"string":"hash"]:_.map}function Jo(d){for(var f=Ds(d),_=f.length;_--;){var F=f[_],le=d[F];f[_]=[F,le,Q1(le)]}return f}function Pc(d,f){var _=function(ot,It){return null==ot?J:ot[It]}(d,f);return m_(_)?_:J}var A_=Ir?function(d){return null==d?[]:(d=Hi(d),Ea(Ir(d),function(f){return cp.call(d,f)}))}:kc,bb=Ir?function(d){for(var f=[];d;)jr(f,A_(d)),d=Ca(d);return f}:kc,Gs=Ts;function Eb(d,f,_){for(var F=-1,le=(f=Oc(f,d)).length,Ce=!1;++F<le;){var ze=ti(f[F]);if(!(Ce=null!=d&&_(d,ze)))break;d=d[ze]}return Ce||++F!=le?Ce:!!(le=null==d?0:d.length)&&ty(le)&&Po(ze,le)&&(Dn(d)||cl(d))}function Sb(d){return"function"!=typeof d.constructor||Fp(d)?{}:wu(Ca(d))}function X1(d){return Dn(d)||cl(d)||!!(m1&&d&&d[m1])}function Po(d,f){var _=typeof d;return!!(f=null==f?xe:f)&&("number"==_||"symbol"!=_&&ji.test(d))&&d>-1&&d%1==0&&d<f}function $s(d,f,_){if(!wr(_))return!1;var F=typeof f;return!!("number"==F?_o(_)&&Po(f,_.length):"string"==F&&f in _)&&An(_[f],d)}function ea(d,f){if(Dn(d))return!1;var _=typeof d;return!("number"!=_&&"symbol"!=_&&"boolean"!=_&&null!=d&&!sa(d))||ge.test(d)||!ut.test(d)||null!=f&&d in Hi(f)}function Pp(d){var f=Np(d),_=Ee[f];if("function"!=typeof _||!(f in li.prototype))return!1;if(d===_)return!0;var F=T_(_);return!!F&&d===F[0]}(xs&&Gs(new xs(new ArrayBuffer(1)))!=bt||go&&Gs(new go)!=Ne||hp&&Gs(hp.resolve())!=de||Ta&&Gs(new Ta)!=ft||Io&&Gs(new Io)!=V)&&(Gs=function(d){var f=Ts(d),_=f==fe?d.constructor:J,F=_?Ru(_):"";if(F)switch(F){case b1:return bt;case i_:return Ne;case r_:return de;case Zv:return ft;case s_:return V}return f});var Cb=lp?ra:xy;function Fp(d){var f=d&&d.constructor;return d===("function"==typeof f&&f.prototype||vu)}function Q1(d){return d==d&&!wr(d)}function Z1(d,f){return function(_){return null!=_&&_[d]===f&&(f!==J||d in Hi(_))}}function J1(d,f,_){return f=Ur(f===J?d.length-1:f,0),function(){for(var F=arguments,le=-1,Ce=Ur(F.length-f,0),ze=yt(Ce);++le<Ce;)ze[le]=F[f+le];le=-1;for(var Ye=yt(f+1);++le<f;)Ye[le]=F[le];return Ye[f]=_(ze),rs(d,this,Ye)}}function O_(d,f){return f.length<2?d:Ko(d,As(f,0,-1))}function eT(d,f){for(var _=d.length,F=ps(f.length,_),le=eo(d);F--;){var Ce=f[F];d[F]=Po(Ce,_)?le[Ce]:J}return d}function R_(d,f){if(("constructor"!==f||"function"!=typeof d[f])&&"__proto__"!=f)return d[f]}var Tb=N_(y_),Zh=y1||function(d,f){return Fi.setTimeout(d,f)},Lp=N_(Ro);function Jh(d,f,_){var F=f+"";return Lp(d,function(d,f){var _=f.length;if(!_)return d;var F=_-1;return f[F]=(_>1?"& ":"")+f[F],f=f.join(_>2?", ":" "),d.replace(Tt,"{\n/* [wrapped with "+f+"] */\n")}(F,function(d,f){return js(st,function(_){var F="_."+_[0];f&_[1]&&!Pl(d,F)&&d.push(F)}),d.sort()}(function(d){var f=d.match(Dt);return f?f[1].split(Yt):[]}(F),_)))}function N_(d){var f=0,_=0;return function(){var F=FF(),le=16-(F-_);if(_=F,le>0){if(++f>=800)return arguments[0]}else f=0;return d.apply(J,arguments)}}function Hd(d,f){var _=-1,F=d.length,le=F-1;for(f=f===J?F:f;++_<f;){var Ce=kl(_,le),ze=d[Ce];d[Ce]=d[_],d[_]=ze}return d.length=f,d}var f,_,Ab=(f=sf(function(d){var f=[];return 46===d.charCodeAt(0)&&f.push(""),d.replace(ve,function(_,F,le,Ce){f.push(le?Ce.replace(On,"$1"):F||_)}),f},function(F){return 500===_.size&&_.clear(),F}),_=f.cache,f);function ti(d){if("string"==typeof d||sa(d))return d;var f=d+"";return"0"==f&&1/d==-ee?"-0":f}function Ru(d){if(null!=d){try{return vr.call(d)}catch(f){}try{return d+""}catch(f){}}return""}function kp(d){if(d instanceof li)return d.clone();var f=new Oo(d.__wrapped__,d.__chain__);return f.__actions__=eo(d.__actions__),f.__index__=d.__index__,f.__values__=d.__values__,f}var rT=ci(function(d,f){return br(d)?Tc(d,Cs(f,1,br,!0)):[]}),sT=ci(function(d,f){var _=ta(f);return br(_)&&(_=J),br(d)?Tc(d,Cs(f,1,br,!0),Pn(_,2)):[]}),oT=ci(function(d,f){var _=ta(f);return br(_)&&(_=J),br(d)?Tc(d,Cs(f,1,br,!0),J,_):[]});function F_(d,f,_){var F=null==d?0:d.length;if(!F)return-1;var le=null==_?0:Qn(_);return le<0&&(le=Ur(F+le,0)),Ed(d,Pn(f,3),le)}function L_(d,f,_){var F=null==d?0:d.length;if(!F)return-1;var le=F-1;return _!==J&&(le=Qn(_),le=_<0?Ur(F+le,0):ps(le,F-1)),Ed(d,Pn(f,3),le,!0)}function Ms(d){return null!=d&&d.length?Cs(d,1):[]}function Db(d){return d&&d.length?d[0]:J}var Ob=ci(function(d){var f=Ui(d,Ic);return f.length&&f[0]===d[0]?Su(f):[]}),cT=ci(function(d){var f=ta(d),_=Ui(d,Ic);return f===ta(_)?f=J:_.pop(),_.length&&_[0]===d[0]?Su(_,Pn(f,2)):[]}),Rb=ci(function(d){var f=ta(d),_=Ui(d,Ic);return(f="function"==typeof f?f:J)&&_.pop(),_.length&&_[0]===d[0]?Su(_,J,f):[]});function ta(d){var f=null==d?0:d.length;return f?d[f-1]:J}var B_=ci(V_);function V_(d,f){return d&&d.length&&f&&f.length?Zo(d,f):d}var Pb=ol(function(d,f){var _=null==d?0:d.length,F=d_(d,f);return Kh(d,Ui(f,function(le){return Po(le,_)?+le:le}).sort(Rc)),F});function j_(d){return null==d?d:dp.call(d)}var kb=ci(function(d){return Dc(Cs(d,1,br,!0))}),wT=ci(function(d){var f=ta(d);return br(f)&&(f=J),Dc(Cs(d,1,br,!0),Pn(f,2))}),ET=ci(function(d){var f=ta(d);return f="function"==typeof f?f:J,Dc(Cs(d,1,br,!0),J,f)});function Bb(d){if(!d||!d.length)return[];var f=0;return d=Ea(d,function(_){if(br(_))return f=Ur(_.length,f),!0}),xd(f,function(_){return Ui(d,Wm(_))})}function xT(d,f){if(!d||!d.length)return[];var _=Bb(d);return null==f?_:Ui(_,function(F){return rs(f,J,F)})}var Vb=ci(function(d,f){return br(d)?Tc(d,f):[]}),e2=ci(function(d){return Au(Ea(d,br))}),Fo=ci(function(d){var f=ta(d);return br(f)&&(f=J),Au(Ea(d,br),Pn(f,2))}),U_=ci(function(d){var f=ta(d);return f="function"==typeof f?f:J,Au(Ea(d,br),J,f)}),z_=ci(Bb),nf=ci(function(d){var f=d.length,_=f>1?d[f-1]:J;return _="function"==typeof _?(d.pop(),_):J,xT(d,_)});function H_(d){var f=Ee(d);return f.__chain__=!0,f}function $d(d,f){return f(d)}var G_=ol(function(d){var f=d.length,_=f?d[0]:0,F=this.__wrapped__,le=function(Ce){return d_(Ce,d)};return!(f>1||this.__actions__.length)&&F instanceof li&&Po(_)?((F=F.slice(_,+_+(f?1:0))).__actions__.push({func:$d,args:[le],thisArg:J}),new Oo(F,this.__chain__).thru(function(Ce){return f&&!Ce.length&&Ce.push(J),Ce})):this.thru(le)}),AT=Zr(function(d,f,_){Gi.call(d,_)?++d[_]:nl(d,_,1)}),IT=fb(F_),OT=fb(L_);function Y_(d,f){return(Dn(d)?js:Ac)(d,Pn(f,3))}function jp(d,f){return(Dn(d)?bd:f_)(d,Pn(f,3))}var NT=Zr(function(d,f,_){Gi.call(d,_)?d[_].push(f):nl(d,_,[f])}),$b=ci(function(d,f,_){var F=-1,le="function"==typeof f,Ce=_o(d)?yt(d.length):[];return Ac(d,function(ze){Ce[++F]=le?rs(f,ze,_):Da(ze,f,_)}),Ce}),Wb=Zr(function(d,f,_){nl(d,_,f)});function ll(d,f){return(Dn(d)?Ui:k1)(d,Pn(f,3))}var Yb=Zr(function(d,f,_){d[_?0:1].push(f)},function(){return[[],[]]}),zp=ci(function(d,f){if(null==d)return[];var _=f.length;return _>1&&$s(d,f[0],f[1])?f=[]:_>2&&$s(f[0],f[1],f[2])&&(f=[f[0]]),Yh(d,Cs(f,1),[])}),Nu=_1||function(){return Fi.Date.now()};function Hp(d,f,_){return f=_?J:f,jl(d,q,J,J,J,J,f=d&&null==f?d.length:f)}function X_(d,f){var _;if("function"!=typeof f)throw new xa(Me);return d=Qn(d),function(){return--d>0&&(_=f.apply(this,arguments)),d<=1&&(f=J),_}}var rf=ci(function(d,f,_){var F=1;if(_.length){var le=yu(_,zd(rf));F|=j}return jl(d,F,f,_,le)}),qd=ci(function(d,f,_){var F=3;if(_.length){var le=yu(_,zd(qd));F|=j}return jl(f,F,d,_,le)});function tw(d,f,_){var F,le,Ce,ze,Ye,lt,Nt=0,Pt=!1,jt=!1,tn=!0;if("function"!=typeof d)throw new xa(Me);function bn(ki){var fl=F,Bc=le;return F=le=J,Nt=ki,ze=d.apply(Bc,fl)}function Fn(ki){return Nt=ki,Ye=Zh(di,f),Pt?bn(ki):ze}function kn(ki){var fl=ki-lt;return lt===J||fl>=f||fl<0||jt&&ki-Nt>=Ce}function di(){var ki=Nu();if(kn(ki))return Ei(ki);Ye=Zh(di,function(ki){var zA=f-(ki-lt);return jt?ps(zA,Ce-(ki-Nt)):zA}(ki))}function Ei(ki){return Ye=J,tn&&F?bn(ki):(F=le=J,ze)}function oa(){var ki=Nu(),fl=kn(ki);if(F=arguments,le=this,lt=ki,fl){if(Ye===J)return Fn(lt);if(jt)return z1(Ye),Ye=Zh(di,f),bn(lt)}return Ye===J&&(Ye=Zh(di,f)),ze}return f=yo(f)||0,wr(_)&&(Pt=!!_.leading,Ce=(jt="maxWait"in _)?Ur(yo(_.maxWait)||0,f):Ce,tn="trailing"in _?!!_.trailing:tn),oa.cancel=function(){Ye!==J&&z1(Ye),Nt=0,F=lt=le=Ye=J},oa.flush=function(){return Ye===J?ze:Ei(Nu())},oa}var kT=ci(function(d,f){return $h(d,1,f)}),nw=ci(function(d,f,_){return $h(d,yo(f)||0,_)});function sf(d,f){if("function"!=typeof d||null!=f&&"function"!=typeof f)throw new xa(Me);var _=function(){var F=arguments,le=f?f.apply(this,F):F[0],Ce=_.cache;if(Ce.has(le))return Ce.get(le);var ze=d.apply(this,F);return _.cache=Ce.set(le,ze)||Ce,ze};return _.cache=new(sf.Cache||el),_}function J_(d){if("function"!=typeof d)throw new xa(Me);return function(){var f=arguments;switch(f.length){case 0:return!d.call(this);case 1:return!d.call(this,f[0]);case 2:return!d.call(this,f[0],f[1]);case 3:return!d.call(this,f[0],f[1],f[2])}return!d.apply(this,f)}}sf.Cache=el;var BT=U1(function(d,f){var _=(f=1==f.length&&Dn(f[0])?Ui(f[0],Yo(Pn())):Ui(Cs(f,1),Yo(Pn()))).length;return ci(function(F){for(var le=-1,Ce=ps(F.length,_);++le<Ce;)F[le]=f[le].call(this,F[le]);return rs(d,this,F)})}),Gp=ci(function(d,f){var _=yu(f,zd(Gp));return jl(d,j,J,f,_)}),rw=ci(function(d,f){var _=yu(f,zd(rw));return jl(d,64,J,f,_)}),VT=ol(function(d,f){return jl(d,256,J,J,J,f)});function An(d,f){return d===f||d!=d&&f!=f}var Kt=Ip(Xo),aw=Ip(function(d,f){return d>=f}),cl=N1(function(){return arguments}())?N1:function(d){return Er(d)&&Gi.call(d,"callee")&&!cp.call(d,"callee")},Dn=yt.isArray,lw=rn?Yo(rn):function(d){return Er(d)&&Ts(d)==Ze};function _o(d){return null!=d&&ty(d.length)&&!ra(d)}function br(d){return Er(d)&&_o(d)}var ul=ss||xy,cw=ai?Yo(ai):function(d){return Er(d)&&Ts(d)==Le};function Ra(d){if(!Er(d))return!1;var f=Ts(d);return f==Te||"[object DOMException]"==f||"string"==typeof d.message&&"string"==typeof d.name&&!qp(d)}function ra(d){if(!wr(d))return!1;var f=Ts(d);return f==je||f==qe||"[object AsyncFunction]"==f||"[object Proxy]"==f}function Wp(d){return"number"==typeof d&&d==Qn(d)}function ty(d){return"number"==typeof d&&d>-1&&d%1==0&&d<=xe}function wr(d){var f=typeof d;return null!=d&&("object"==f||"function"==f)}function Er(d){return null!=d&&"object"==typeof d}var KT=ar?Yo(ar):function(d){return Er(d)&&Gs(d)==Ne};function ZT(d){return"number"==typeof d||Er(d)&&Ts(d)==$}function qp(d){if(!Er(d)||Ts(d)!=fe)return!1;var f=Ca(d);if(null===f)return!0;var _=Gi.call(f,"constructor")&&f.constructor;return"function"==typeof _&&_ instanceof _&&vr.call(_)==g1}var fw=po?Yo(po):function(d){return Er(d)&&Ts(d)==gt},JT=Ec?Yo(Ec):function(d){return Er(d)&&Gs(d)==ft};function iy(d){return"string"==typeof d||!Dn(d)&&Er(d)&&Ts(d)==be}function sa(d){return"symbol"==typeof d||Er(d)&&Ts(d)==B}var of=is?Yo(is):function(d){return Er(d)&&ty(d.length)&&!!yn[Ts(d)]},Fc=Ip(ob),ry=Ip(function(d,f){return d<=f});function pw(d){if(!d)return[];if(_o(d))return iy(d)?Za(d):eo(d);if(Lh&&d[Lh])return function(ot){for(var It,yt=[];!(It=ot.next()).done;)yt.push(It.value);return yt}(d[Lh]());var f=Gs(d);return(f==Ne?qv:f==ft?Km:Zd)(d)}function dl(d){return d?(d=yo(d))===ee||d===-ee?17976931348623157e292*(d<0?-1:1):d==d?d:0:0===d?d:0}function Qn(d){var f=dl(d),_=f%1;return f==f?_?f-_:f:0}function sy(d){return d?Eu(Qn(d),0,_e):0}function yo(d){if("number"==typeof d)return d;if(sa(d))return NaN;if(wr(d)){var f="function"==typeof d.valueOf?d.valueOf():d;d=wr(f)?f+"":f}if("string"!=typeof d)return 0===d?d:+d;d=Wv(d);var _=nr.test(d);return _||Yn.test(d)?$v(d.slice(2),_?2:8):Sn.test(d)?NaN:+d}function gw(d){return Ia(d,no(d))}function Li(d){return null==d?"":No(d)}var eA=Bl(function(d,f){if(Fp(f)||_o(f))Ia(f,Ds(f),d);else for(var _ in f)Gi.call(f,_)&&tl(d,_,f[_])}),tA=Bl(function(d,f){Ia(f,no(f),d)}),Yd=Bl(function(d,f,_,F){Ia(f,no(f),d,F)}),nA=Bl(function(d,f,_,F){Ia(f,Ds(f),d,F)}),mw=ol(d_),rA=ci(function(d,f){d=Hi(d);var _=-1,F=f.length,le=F>2?f[2]:J;for(le&&$s(f[0],f[1],le)&&(F=1);++_<F;)for(var Ce=f[_],ze=no(Ce),Ye=-1,lt=ze.length;++Ye<lt;){var Nt=ze[Ye],Pt=d[Nt];(Pt===J||An(Pt,vu[Nt])&&!Gi.call(d,Nt))&&(d[Nt]=Ce[Nt])}return d}),af=ci(function(d){return d.push(J,$1),rs(Ew,J,d)});function cf(d,f,_){var F=null==d?J:Ko(d,f);return F===J?_:F}function Yp(d,f){return null!=d&&Eb(d,f,Pd)}var Kp=pb(function(d,f,_){null!=f&&"function"!=typeof f.toString&&(f=Zs.call(f)),d[f]=_},vy(io)),oA=pb(function(d,f,_){null!=f&&"function"!=typeof f.toString&&(f=Zs.call(f)),Gi.call(d,f)?d[f].push(_):d[f]=[_]},Pn),vw=ci(Da);function Ds(d){return _o(d)?Gh(d):sb(d)}function no(d){return _o(d)?Gh(d,!0):function(d){if(!wr(d))return function(d){var f=[];if(null!=d)for(var _ in Hi(d))f.push(_);return f}(d);var f=Fp(d),_=[];for(var F in d)"constructor"==F&&(f||!Gi.call(d,F))||_.push(F);return _}(d)}var ww=Bl(function(d,f,_){__(d,f,_)}),Ew=Bl(function(d,f,_,F){__(d,f,_,F)}),lA=ol(function(d,f){var _={};if(null==d)return _;var F=!1;f=Ui(f,function(Ce){return Ce=Oc(Ce,d),F||(F=Ce.length>1),Ce}),Ia(d,C_(d),_),F&&(_=zs(_,7,Op));for(var le=f.length;le--;)Cu(_,f[le]);return _}),cA=ol(function(d,f){return null==d?{}:function(d,f){return ab(d,f,function(_,F){return Yp(d,F)})}(d,f)});function Sw(d,f){if(null==d)return{};var _=Ui(C_(d),function(F){return[F]});return f=Pn(f),ab(d,_,function(F,le){return f(F,le[0])})}var uA=Ou(Ds),Cw=Ou(no);function Zd(d){return null==d?[]:Ym(d,Ds(d))}var gA=Vl(function(d,f,_){return f=f.toLowerCase(),d+(_?cy(f):f)});function cy(d){return Qp(Li(d).toLowerCase())}function uy(d){return(d=Li(d))&&d.replace(va,TF).replace(Gm,"")}var _A=Vl(function(d,f,_){return d+(_?"-":"")+f.toLowerCase()}),yA=Vl(function(d,f,_){return d+(_?" ":"")+f.toLowerCase()}),h2=Ap("toLowerCase"),SA=Vl(function(d,f,_){return d+(_?"_":"")+f.toLowerCase()}),fy=Vl(function(d,f,_){return d+(_?" ":"")+Qp(f)}),Ow=Vl(function(d,f,_){return d+(_?" ":"")+f.toUpperCase()}),Qp=Ap("toUpperCase");function _y(d,f,_){return d=Li(d),(f=_?J:f)===J?function(ot){return Rl.test(ot)}(d)?function(ot){return ot.match(Uv)||[]}(d):function(ot){return ot.match(jn)||[]}(d):d.match(f)||[]}var yy=ci(function(d,f){try{return rs(d,J,f)}catch(_){return Ra(_)?_:new Tn(_)}}),Rw=ol(function(d,f){return js(f,function(_){_=ti(_),nl(d,_,rf(d[_],d))}),d});function vy(d){return function(){return d}}var p2=Iu(),Jd=Iu(!0);function io(d){return d}function Pu(d){return L1("function"==typeof d?d:zs(d,1))}var by=ci(function(d,f){return function(_){return Da(_,d,f)}}),Nw=ci(function(d,f){return function(_){return Da(d,_,f)}});function wy(d,f,_){var F=Ds(f),le=qh(f,F);null==_&&(!wr(f)||!le.length&&F.length)&&(_=f,f=d,d=this,le=qh(f,Ds(f)));var Ce=!(wr(_)&&"chain"in _&&!_.chain),ze=ra(d);return js(le,function(Ye){var lt=f[Ye];d[Ye]=lt,ze&&(d.prototype[Ye]=function(){var Nt=this.__chain__;if(Ce||Nt){var Pt=d(this.__wrapped__),jt=Pt.__actions__=eo(this.__actions__);return jt.push({func:lt,args:arguments,thisArg:d}),Pt.__chain__=Nt,Pt}return lt.apply(d,jr([this.value()],arguments))})}),d}function Ey(){}var IA=Mp(Ui),OA=Mp(ei),Fw=Mp(Do);function Fu(d){return ea(d)?Wm(ti(d)):function(d){return function(f){return Ko(f,d)}}(d)}var RA=gb(),NA=gb(!0);function kc(){return[]}function xy(){return!1}var Un=S_(function(d,f){return d+f},0),Cy=Ud("ceil"),m2=S_(function(d,f){return d/f},1),Gl=Ud("floor"),Vw=S_(function(d,f){return d*f},1),jw=Ud("round"),Uw=S_(function(d,f){return d-f},0);return Ee.after=function(d,f){if("function"!=typeof f)throw new xa(Me);return d=Qn(d),function(){if(--d<1)return f.apply(this,arguments)}},Ee.ary=Hp,Ee.assign=eA,Ee.assignIn=tA,Ee.assignInWith=Yd,Ee.assignWith=nA,Ee.at=mw,Ee.before=X_,Ee.bind=rf,Ee.bindAll=Rw,Ee.bindKey=qd,Ee.castArray=function(){if(!arguments.length)return[];var d=arguments[0];return Dn(d)?d:[d]},Ee.chain=H_,Ee.chunk=function(d,f,_){f=(_?$s(d,f,_):f===J)?1:Ur(Qn(f),0);var F=null==d?0:d.length;if(!F||f<1)return[];for(var le=0,Ce=0,ze=yt(Bt(F/f));le<F;)ze[Ce++]=As(d,le,le+=f);return ze},Ee.compact=function(d){for(var f=-1,_=null==d?0:d.length,F=0,le=[];++f<_;){var Ce=d[f];Ce&&(le[F++]=Ce)}return le},Ee.concat=function(){var d=arguments.length;if(!d)return[];for(var f=yt(d-1),_=arguments[0],F=d;F--;)f[F-1]=arguments[F];return jr(Dn(_)?eo(_):[_],Cs(f,1))},Ee.cond=function(d){var f=null==d?0:d.length,_=Pn();return d=f?Ui(d,function(F){if("function"!=typeof F[1])throw new xa(Me);return[_(F[0]),F[1]]}):[],ci(function(F){for(var le=-1;++le<f;){var Ce=d[le];if(rs(Ce[0],this,F))return rs(Ce[1],this,F)}})},Ee.conforms=function(d){return function(d){var f=Ds(d);return function(_){return vp(_,d,f)}}(zs(d,1))},Ee.constant=vy,Ee.countBy=AT,Ee.create=function(d,f){var _=wu(d);return null==f?_:R1(_,f)},Ee.curry=function ew(d,f,_){var F=jl(d,8,J,J,J,J,J,f=_?J:f);return F.placeholder=ew.placeholder,F},Ee.curryRight=function Q_(d,f,_){var F=jl(d,16,J,J,J,J,J,f=_?J:f);return F.placeholder=Q_.placeholder,F},Ee.debounce=tw,Ee.defaults=rA,Ee.defaultsDeep=af,Ee.defer=kT,Ee.delay=nw,Ee.difference=rT,Ee.differenceBy=sT,Ee.differenceWith=oT,Ee.drop=function(d,f,_){var F=null==d?0:d.length;return F?As(d,(f=_||f===J?1:Qn(f))<0?0:f,F):[]},Ee.dropRight=function(d,f,_){var F=null==d?0:d.length;return F?As(d,0,(f=F-(f=_||f===J?1:Qn(f)))<0?0:f):[]},Ee.dropRightWhile=function(d,f){return d&&d.length?Tu(d,Pn(f,3),!0,!0):[]},Ee.dropWhile=function(d,f){return d&&d.length?Tu(d,Pn(f,3),!0):[]},Ee.fill=function(d,f,_,F){var le=null==d?0:d.length;return le?(_&&"number"!=typeof _&&$s(d,f,_)&&(_=0,F=le),function(d,f,_,F){var le=d.length;for((_=Qn(_))<0&&(_=-_>le?0:le+_),(F=F===J||F>le?le:Qn(F))<0&&(F+=le),F=_>F?0:sy(F);_<F;)d[_++]=f;return d}(d,f,_,F)):[]},Ee.filter=function(d,f){return(Dn(d)?Ea:rb)(d,Pn(f,3))},Ee.flatMap=function(d,f){return Cs(ll(d,f),1)},Ee.flatMapDeep=function(d,f){return Cs(ll(d,f),ee)},Ee.flatMapDepth=function(d,f,_){return _=_===J?1:Qn(_),Cs(ll(d,f),_)},Ee.flatten=Ms,Ee.flattenDeep=function(d){return null!=d&&d.length?Cs(d,ee):[]},Ee.flattenDepth=function(d,f){return null!=d&&d.length?Cs(d,f=f===J?1:Qn(f)):[]},Ee.flip=function(d){return jl(d,512)},Ee.flow=p2,Ee.flowRight=Jd,Ee.fromPairs=function(d){for(var f=-1,_=null==d?0:d.length,F={};++f<_;){var le=d[f];F[le[0]]=le[1]}return F},Ee.functions=function(d){return null==d?[]:qh(d,Ds(d))},Ee.functionsIn=function(d){return null==d?[]:qh(d,no(d))},Ee.groupBy=NT,Ee.initial=function(d){return null!=d&&d.length?As(d,0,-1):[]},Ee.intersection=Ob,Ee.intersectionBy=cT,Ee.intersectionWith=Rb,Ee.invert=Kp,Ee.invertBy=oA,Ee.invokeMap=$b,Ee.iteratee=Pu,Ee.keyBy=Wb,Ee.keys=Ds,Ee.keysIn=no,Ee.map=ll,Ee.mapKeys=function(d,f){var _={};return f=Pn(f,3),il(d,function(F,le,Ce){nl(_,f(F,le,Ce),F)}),_},Ee.mapValues=function(d,f){var _={};return f=Pn(f,3),il(d,function(F,le,Ce){nl(_,le,f(F,le,Ce))}),_},Ee.matches=function(d){return B1(zs(d,1))},Ee.matchesProperty=function(d,f){return Ld(d,zs(f,1))},Ee.memoize=sf,Ee.merge=ww,Ee.mergeWith=Ew,Ee.method=by,Ee.methodOf=Nw,Ee.mixin=wy,Ee.negate=J_,Ee.nthArg=function(d){return d=Qn(d),ci(function(f){return xu(f,d)})},Ee.omit=lA,Ee.omitBy=function(d,f){return Sw(d,J_(Pn(f)))},Ee.once=function(d){return X_(2,d)},Ee.orderBy=function(d,f,_,F){return null==d?[]:(Dn(f)||(f=null==f?[]:[f]),Dn(_=F?J:_)||(_=null==_?[]:[_]),Yh(d,f,_))},Ee.over=IA,Ee.overArgs=BT,Ee.overEvery=OA,Ee.overSome=Fw,Ee.partial=Gp,Ee.partialRight=rw,Ee.partition=Yb,Ee.pick=cA,Ee.pickBy=Sw,Ee.property=Fu,Ee.propertyOf=function(d){return function(f){return null==d?J:Ko(d,f)}},Ee.pull=B_,Ee.pullAll=V_,Ee.pullAllBy=function(d,f,_){return d&&d.length&&f&&f.length?Zo(d,f,Pn(_,2)):d},Ee.pullAllWith=function(d,f,_){return d&&d.length&&f&&f.length?Zo(d,f,J,_):d},Ee.pullAt=Pb,Ee.range=RA,Ee.rangeRight=NA,Ee.rearg=VT,Ee.reject=function(d,f){return(Dn(d)?Ea:rb)(d,J_(Pn(f,3)))},Ee.remove=function(d,f){var _=[];if(!d||!d.length)return _;var F=-1,le=[],Ce=d.length;for(f=Pn(f,3);++F<Ce;){var ze=d[F];f(ze,F,d)&&(_.push(ze),le.push(F))}return Kh(d,le),_},Ee.rest=function(d,f){if("function"!=typeof d)throw new xa(Me);return ci(d,f=f===J?f:Qn(f))},Ee.reverse=j_,Ee.sampleSize=function(d,f,_){return f=(_?$s(d,f,_):f===J)?1:Qn(f),(Dn(d)?eb:GF)(d,f)},Ee.set=function(d,f,_){return null==d?d:Sp(d,f,_)},Ee.setWith=function(d,f,_,F){return F="function"==typeof F?F:J,null==d?d:Sp(d,f,_,F)},Ee.shuffle=function(d){return(Dn(d)?Dd:v_)(d)},Ee.slice=function(d,f,_){var F=null==d?0:d.length;return F?(_&&"number"!=typeof _&&$s(d,f,_)?(f=0,_=F):(f=null==f?0:Qn(f),_=_===J?F:Qn(_)),As(d,f,_)):[]},Ee.sortBy=zp,Ee.sortedUniq=function(d){return d&&d.length?lb(d):[]},Ee.sortedUniqBy=function(d,f){return d&&d.length?lb(d,Pn(f,2)):[]},Ee.split=function(d,f,_){return _&&"number"!=typeof _&&$s(d,f,_)&&(f=_=J),(_=_===J?_e:_>>>0)?(d=Li(d))&&("string"==typeof f||null!=f&&!fw(f))&&!(f=No(f))&&Rh(d)?rl(Za(d),0,_):d.split(f,_):[]},Ee.spread=function(d,f){if("function"!=typeof d)throw new xa(Me);return f=null==f?0:Ur(Qn(f),0),ci(function(_){var F=_[f],le=rl(_,0,f);return F&&jr(le,F),rs(d,this,le)})},Ee.tail=function(d){var f=null==d?0:d.length;return f?As(d,1,f):[]},Ee.take=function(d,f,_){return d&&d.length?As(d,0,(f=_||f===J?1:Qn(f))<0?0:f):[]},Ee.takeRight=function(d,f,_){var F=null==d?0:d.length;return F?As(d,(f=F-(f=_||f===J?1:Qn(f)))<0?0:f,F):[]},Ee.takeRightWhile=function(d,f){return d&&d.length?Tu(d,Pn(f,3),!1,!0):[]},Ee.takeWhile=function(d,f){return d&&d.length?Tu(d,Pn(f,3)):[]},Ee.tap=function(d,f){return f(d),d},Ee.throttle=function(d,f,_){var F=!0,le=!0;if("function"!=typeof d)throw new xa(Me);return wr(_)&&(F="leading"in _?!!_.leading:F,le="trailing"in _?!!_.trailing:le),tw(d,f,{leading:F,maxWait:f,trailing:le})},Ee.thru=$d,Ee.toArray=pw,Ee.toPairs=uA,Ee.toPairsIn=Cw,Ee.toPath=function(d){return Dn(d)?Ui(d,ti):sa(d)?[d]:eo(Ab(Li(d)))},Ee.toPlainObject=gw,Ee.transform=function(d,f,_){var F=Dn(d),le=F||ul(d)||of(d);if(f=Pn(f,4),null==_){var Ce=d&&d.constructor;_=le?F?new Ce:[]:wr(d)&&ra(Ce)?wu(Ca(d)):{}}return(le?js:il)(d,function(ze,Ye,lt){return f(_,ze,Ye,lt)}),_},Ee.unary=function(d){return Hp(d,1)},Ee.union=kb,Ee.unionBy=wT,Ee.unionWith=ET,Ee.uniq=function(d){return d&&d.length?Dc(d):[]},Ee.uniqBy=function(d,f){return d&&d.length?Dc(d,Pn(f,2)):[]},Ee.uniqWith=function(d,f){return f="function"==typeof f?f:J,d&&d.length?Dc(d,J,f):[]},Ee.unset=function(d,f){return null==d||Cu(d,f)},Ee.unzip=Bb,Ee.unzipWith=xT,Ee.update=function(d,f,_){return null==d?d:xp(d,f,w_(_))},Ee.updateWith=function(d,f,_,F){return F="function"==typeof F?F:J,null==d?d:xp(d,f,w_(_),F)},Ee.values=Zd,Ee.valuesIn=function(d){return null==d?[]:Ym(d,no(d))},Ee.without=Vb,Ee.words=_y,Ee.wrap=function(d,f){return Gp(w_(f),d)},Ee.xor=e2,Ee.xorBy=Fo,Ee.xorWith=U_,Ee.zip=z_,Ee.zipObject=function(d,f){return Cp(d||[],f||[],tl)},Ee.zipObjectDeep=function(d,f){return Cp(d||[],f||[],Sp)},Ee.zipWith=nf,Ee.entries=uA,Ee.entriesIn=Cw,Ee.extend=tA,Ee.extendWith=Yd,wy(Ee,Ee),Ee.add=Un,Ee.attempt=yy,Ee.camelCase=gA,Ee.capitalize=cy,Ee.ceil=Cy,Ee.clamp=function(d,f,_){return _===J&&(_=f,f=J),_!==J&&(_=(_=yo(_))==_?_:0),f!==J&&(f=(f=yo(f))==f?f:0),Eu(yo(d),f,_)},Ee.clone=function(d){return zs(d,4)},Ee.cloneDeep=function(d){return zs(d,5)},Ee.cloneDeepWith=function(d,f){return zs(d,5,f="function"==typeof f?f:J)},Ee.cloneWith=function(d,f){return zs(d,4,f="function"==typeof f?f:J)},Ee.conformsTo=function(d,f){return null==f||vp(d,f,Ds(f))},Ee.deburr=uy,Ee.defaultTo=function(d,f){return null==d||d!=d?f:d},Ee.divide=m2,Ee.endsWith=function(d,f,_){d=Li(d),f=No(f);var F=d.length,le=_=_===J?F:Eu(Qn(_),0,F);return(_-=f.length)>=0&&d.slice(_,le)==f},Ee.eq=An,Ee.escape=function(d){return(d=Li(d))&&Jt.test(d)?d.replace(ya,AF):d},Ee.escapeRegExp=function(d){return(d=Li(d))&&ct.test(d)?d.replace(ke,"\\$&"):d},Ee.every=function(d,f,_){var F=Dn(d)?ei:nb;return _&&$s(d,f,_)&&(f=J),F(d,Pn(f,3))},Ee.find=IT,Ee.findIndex=F_,Ee.findKey=function(d,f){return Ih(d,Pn(f,3),il)},Ee.findLast=OT,Ee.findLastIndex=L_,Ee.findLastKey=function(d,f){return Ih(d,Pn(f,3),bp)},Ee.floor=Gl,Ee.forEach=Y_,Ee.forEachRight=jp,Ee.forIn=function(d,f){return null==d?d:Od(d,Pn(f,3),no)},Ee.forInRight=function(d,f){return null==d?d:Rd(d,Pn(f,3),no)},Ee.forOwn=function(d,f){return d&&il(d,Pn(f,3))},Ee.forOwnRight=function(d,f){return d&&bp(d,Pn(f,3))},Ee.get=cf,Ee.gt=Kt,Ee.gte=aw,Ee.has=function(d,f){return null!=d&&Eb(d,f,Nd)},Ee.hasIn=Yp,Ee.head=Db,Ee.identity=io,Ee.includes=function(d,f,_,F){d=_o(d)?d:Zd(d),_=_&&!F?Qn(_):0;var le=d.length;return _<0&&(_=Ur(le+_,0)),iy(d)?_<=le&&d.indexOf(f,_)>-1:!!le&&Qa(d,f,_)>-1},Ee.indexOf=function(d,f,_){var F=null==d?0:d.length;if(!F)return-1;var le=null==_?0:Qn(_);return le<0&&(le=Ur(F+le,0)),Qa(d,f,le)},Ee.inRange=function(d,f,_){return f=dl(f),_===J?(_=f,f=0):_=dl(_),function(d,f,_){return d>=ps(f,_)&&d<Ur(f,_)}(d=yo(d),f,_)},Ee.invoke=vw,Ee.isArguments=cl,Ee.isArray=Dn,Ee.isArrayBuffer=lw,Ee.isArrayLike=_o,Ee.isArrayLikeObject=br,Ee.isBoolean=function(d){return!0===d||!1===d||Er(d)&&Ts(d)==Ue},Ee.isBuffer=ul,Ee.isDate=cw,Ee.isElement=function(d){return Er(d)&&1===d.nodeType&&!qp(d)},Ee.isEmpty=function(d){if(null==d)return!0;if(_o(d)&&(Dn(d)||"string"==typeof d||"function"==typeof d.splice||ul(d)||of(d)||cl(d)))return!d.length;var f=Gs(d);if(f==Ne||f==ft)return!d.size;if(Fp(d))return!sb(d).length;for(var _ in d)if(Gi.call(d,_))return!1;return!0},Ee.isEqual=function(d,f){return wp(d,f)},Ee.isEqualWith=function(d,f,_){var F=(_="function"==typeof _?_:J)?_(d,f):J;return F===J?wp(d,f,J,_):!!F},Ee.isError=Ra,Ee.isFinite=function(d){return"number"==typeof d&&n_(d)},Ee.isFunction=ra,Ee.isInteger=Wp,Ee.isLength=ty,Ee.isMap=KT,Ee.isMatch=function(d,f){return d===f||g_(d,f,Jo(f))},Ee.isMatchWith=function(d,f,_){return _="function"==typeof _?_:J,g_(d,f,Jo(f),_)},Ee.isNaN=function(d){return ZT(d)&&d!=+d},Ee.isNative=function(d){if(Cb(d))throw new Tn("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return m_(d)},Ee.isNil=function(d){return null==d},Ee.isNull=function(d){return null===d},Ee.isNumber=ZT,Ee.isObject=wr,Ee.isObjectLike=Er,Ee.isPlainObject=qp,Ee.isRegExp=fw,Ee.isSafeInteger=function(d){return Wp(d)&&d>=-xe&&d<=xe},Ee.isSet=JT,Ee.isString=iy,Ee.isSymbol=sa,Ee.isTypedArray=of,Ee.isUndefined=function(d){return d===J},Ee.isWeakMap=function(d){return Er(d)&&Gs(d)==V},Ee.isWeakSet=function(d){return Er(d)&&"[object WeakSet]"==Ts(d)},Ee.join=function(d,f){return null==d?"":kh.call(d,f)},Ee.kebabCase=_A,Ee.last=ta,Ee.lastIndexOf=function(d,f,_){var F=null==d?0:d.length;if(!F)return-1;var le=F;return _!==J&&(le=(le=Qn(_))<0?Ur(F+le,0):ps(le,F-1)),f==f?function(ot,It,yt){for(var un=yt+1;un--;)if(ot[un]===It)return un;return un}(d,f,le):Ed(d,Sc,le,!0)},Ee.lowerCase=yA,Ee.lowerFirst=h2,Ee.lt=Fc,Ee.lte=ry,Ee.max=function(d){return d&&d.length?Wh(d,io,Xo):J},Ee.maxBy=function(d,f){return d&&d.length?Wh(d,Pn(f,2),Xo):J},Ee.mean=function(d){return Ss(d,io)},Ee.meanBy=function(d,f){return Ss(d,Pn(f,2))},Ee.min=function(d){return d&&d.length?Wh(d,io,ob):J},Ee.minBy=function(d,f){return d&&d.length?Wh(d,Pn(f,2),ob):J},Ee.stubArray=kc,Ee.stubFalse=xy,Ee.stubObject=function(){return{}},Ee.stubString=function(){return""},Ee.stubTrue=function(){return!0},Ee.multiply=Vw,Ee.nth=function(d,f){return d&&d.length?xu(d,Qn(f)):J},Ee.noConflict=function(){return Fi._===this&&(Fi._=e_),this},Ee.noop=Ey,Ee.now=Nu,Ee.pad=function(d,f,_){d=Li(d);var F=(f=Qn(f))?Nh(d):0;if(!f||F>=f)return d;var le=(f-F)/2;return Dp(gi(le),_)+d+Dp(Bt(le),_)},Ee.padEnd=function(d,f,_){d=Li(d);var F=(f=Qn(f))?Nh(d):0;return f&&F<f?d+Dp(f-F,_):d},Ee.padStart=function(d,f,_){d=Li(d);var F=(f=Qn(f))?Nh(d):0;return f&&F<f?Dp(f-F,_)+d:d},Ee.parseInt=function(d,f,_){return _||null==f?f=0:f&&(f=+f),v1(Li(d).replace(Je,""),f||0)},Ee.random=function(d,f,_){if(_&&"boolean"!=typeof _&&$s(d,f,_)&&(f=_=J),_===J&&("boolean"==typeof f?(_=f,f=J):"boolean"==typeof d&&(_=d,d=J)),d===J&&f===J?(d=0,f=1):(d=dl(d),f===J?(f=d,d=0):f=dl(f)),d>f){var F=d;d=f,f=F}if(_||d%1||f%1){var le=Bh();return ps(d+le*(f-d+a1("1e-"+((le+"").length-1))),f)}return kl(d,f)},Ee.reduce=function(d,f,_){var F=Dn(d)?_u:qo,le=arguments.length<3;return F(d,Pn(f,4),_,le,Ac)},Ee.reduceRight=function(d,f,_){var F=Dn(d)?wd:qo,le=arguments.length<3;return F(d,Pn(f,4),_,le,f_)},Ee.repeat=function(d,f,_){return f=(_?$s(d,f,_):f===J)?1:Qn(f),Ep(Li(d),f)},Ee.replace=function(){var d=arguments,f=Li(d[0]);return d.length<3?f:f.replace(d[1],d[2])},Ee.result=function(d,f,_){var F=-1,le=(f=Oc(f,d)).length;for(le||(le=1,d=J);++F<le;){var Ce=null==d?J:d[ti(f[F])];Ce===J&&(F=le,Ce=_),d=ra(Ce)?Ce.call(d):Ce}return d},Ee.round=jw,Ee.runInContext=ot,Ee.sample=function(d){return(Dn(d)?c_:V1)(d)},Ee.size=function(d){if(null==d)return 0;if(_o(d))return iy(d)?Nh(d):d.length;var f=Gs(d);return f==Ne||f==ft?d.size:sb(d).length},Ee.snakeCase=SA,Ee.some=function(d,f,_){var F=Dn(d)?Do:$F;return _&&$s(d,f,_)&&(f=J),F(d,Pn(f,3))},Ee.sortedIndex=function(d,f){return Xh(d,f)},Ee.sortedIndexBy=function(d,f,_){return b_(d,f,Pn(_,2))},Ee.sortedIndexOf=function(d,f){var _=null==d?0:d.length;if(_){var F=Xh(d,f);if(F<_&&An(d[F],f))return F}return-1},Ee.sortedLastIndex=function(d,f){return Xh(d,f,!0)},Ee.sortedLastIndexBy=function(d,f,_){return b_(d,f,Pn(_,2),!0)},Ee.sortedLastIndexOf=function(d,f){if(null!=d&&d.length){var F=Xh(d,f,!0)-1;if(An(d[F],f))return F}return-1},Ee.startCase=fy,Ee.startsWith=function(d,f,_){return d=Li(d),_=null==_?0:Eu(Qn(_),0,d.length),f=No(f),d.slice(_,_+f.length)==f},Ee.subtract=Uw,Ee.sum=function(d){return d&&d.length?Sd(d,io):0},Ee.sumBy=function(d,f){return d&&d.length?Sd(d,Pn(f,2)):0},Ee.template=function(d,f,_){var F=Ee.templateSettings;_&&$s(d,f,_)&&(f=J),d=Li(d),f=Yd({},f,F,_b);var Ye,lt,le=Yd({},f.imports,F.imports,_b),Ce=Ds(le),ze=Ym(le,Ce),Nt=0,Pt=f.interpolate||Yr,jt="__p += '",tn=Zm((f.escape||Yr).source+"|"+Pt.source+"|"+(Pt===at?mn:Yr).source+"|"+(f.evaluate||Yr).source+"|$","g"),bn="//# sourceURL="+(Gi.call(f,"sourceURL")?(f.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++o1+"]")+"\n";d.replace(tn,function(kn,di,Ei,vo,Ws,oa){return Ei||(Ei=vo),jt+=d.slice(Nt,oa).replace(ne,MF),di&&(Ye=!0,jt+="' +\n__e("+di+") +\n'"),Ws&&(lt=!0,jt+="';\n"+Ws+";\n__p += '"),Ei&&(jt+="' +\n((__t = ("+Ei+")) == null ? '' : __t) +\n'"),Nt=oa+kn.length,kn}),jt+="';\n";var Fn=Gi.call(f,"variable")&&f.variable;if(Fn){if(ri.test(Fn))throw new Tn("Invalid `variable` option passed into `_.template`")}else jt="with (obj) {\n"+jt+"\n}\n";jt=(lt?jt.replace(ks,""):jt).replace(qr,"$1").replace(_a,"$1;"),jt="function("+(Fn||"obj")+") {\n"+(Fn?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(Ye?", __e = _.escape":"")+(lt?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+jt+"return __p\n}";var ui=yy(function(){return Ri(Ce,bn+"return "+jt).apply(J,ze)});if(ui.source=jt,Ra(ui))throw ui;return ui},Ee.times=function(d,f){if((d=Qn(d))<1||d>xe)return[];var _=_e,F=ps(d,_e);f=Pn(f),d-=_e;for(var le=xd(F,f);++_<d;)f(_);return le},Ee.toFinite=dl,Ee.toInteger=Qn,Ee.toLength=sy,Ee.toLower=function(d){return Li(d).toLowerCase()},Ee.toNumber=yo,Ee.toSafeInteger=function(d){return d?Eu(Qn(d),-xe,xe):0===d?d:0},Ee.toString=Li,Ee.toUpper=function(d){return Li(d).toUpperCase()},Ee.trim=function(d,f,_){if((d=Li(d))&&(_||f===J))return Wv(d);if(!d||!(f=No(f)))return d;var F=Za(d),le=Za(f);return rl(F,u1(F,le),d1(F,le)+1).join("")},Ee.trimEnd=function(d,f,_){if((d=Li(d))&&(_||f===J))return d.slice(0,xc(d)+1);if(!d||!(f=No(f)))return d;var F=Za(d);return rl(F,0,d1(F,Za(f))+1).join("")},Ee.trimStart=function(d,f,_){if((d=Li(d))&&(_||f===J))return d.replace(Je,"");if(!d||!(f=No(f)))return d;var F=Za(d);return rl(F,u1(F,Za(f))).join("")},Ee.truncate=function(d,f){var _=30,F="...";if(wr(f)){var le="separator"in f?f.separator:le;_="length"in f?Qn(f.length):_,F="omission"in f?No(f.omission):F}var Ce=(d=Li(d)).length;if(Rh(d)){var ze=Za(d);Ce=ze.length}if(_>=Ce)return d;var Ye=_-Nh(F);if(Ye<1)return F;var lt=ze?rl(ze,0,Ye).join(""):d.slice(0,Ye);if(le===J)return lt+F;if(ze&&(Ye+=lt.length-Ye),fw(le)){if(d.slice(Ye).search(le)){var Nt,Pt=lt;for(le.global||(le=Zm(le.source,Li($n.exec(le))+"g")),le.lastIndex=0;Nt=le.exec(Pt);)var jt=Nt.index;lt=lt.slice(0,jt===J?Ye:jt)}}else if(d.indexOf(No(le),Ye)!=Ye){var tn=lt.lastIndexOf(le);tn>-1&&(lt=lt.slice(0,tn))}return lt+F},Ee.unescape=function(d){return(d=Li(d))&&bs.test(d)?d.replace(Dl,Qm):d},Ee.uniqueId=function(d){var f=++PF;return Li(d)+f},Ee.upperCase=Ow,Ee.upperFirst=Qp,Ee.each=Y_,Ee.eachRight=jp,Ee.first=Db,wy(Ee,function(){var d={};return il(Ee,function(f,_){Gi.call(Ee.prototype,_)||(d[_]=f)}),d}(),{chain:!1}),Ee.VERSION="4.17.21",js(["bind","bindKey","curry","curryRight","partial","partialRight"],function(d){Ee[d].placeholder=Ee}),js(["drop","take"],function(d,f){li.prototype[d]=function(_){_=_===J?1:Ur(Qn(_),0);var F=this.__filtered__&&!f?new li(this):this.clone();return F.__filtered__?F.__takeCount__=ps(_,F.__takeCount__):F.__views__.push({size:ps(_,_e),type:d+(F.__dir__<0?"Right":"")}),F},li.prototype[d+"Right"]=function(_){return this.reverse()[d](_).reverse()}}),js(["filter","map","takeWhile"],function(d,f){var _=f+1,F=1==_||3==_;li.prototype[d]=function(le){var Ce=this.clone();return Ce.__iteratees__.push({iteratee:Pn(le,3),type:_}),Ce.__filtered__=Ce.__filtered__||F,Ce}}),js(["head","last"],function(d,f){var _="take"+(f?"Right":"");li.prototype[d]=function(){return this[_](1).value()[0]}}),js(["initial","tail"],function(d,f){var _="drop"+(f?"":"Right");li.prototype[d]=function(){return this.__filtered__?new li(this):this[_](1)}}),li.prototype.compact=function(){return this.filter(io)},li.prototype.find=function(d){return this.filter(d).head()},li.prototype.findLast=function(d){return this.reverse().find(d)},li.prototype.invokeMap=ci(function(d,f){return"function"==typeof d?new li(this):this.map(function(_){return Da(_,d,f)})}),li.prototype.reject=function(d){return this.filter(J_(Pn(d)))},li.prototype.slice=function(d,f){d=Qn(d);var _=this;return _.__filtered__&&(d>0||f<0)?new li(_):(d<0?_=_.takeRight(-d):d&&(_=_.drop(d)),f!==J&&(_=(f=Qn(f))<0?_.dropRight(-f):_.take(f-d)),_)},li.prototype.takeRightWhile=function(d){return this.reverse().takeWhile(d).reverse()},li.prototype.toArray=function(){return this.take(_e)},il(li.prototype,function(d,f){var _=/^(?:filter|find|map|reject)|While$/.test(f),F=/^(?:head|last)$/.test(f),le=Ee[F?"take"+("last"==f?"Right":""):f],Ce=F||/^find/.test(f);!le||(Ee.prototype[f]=function(){var ze=this.__wrapped__,Ye=F?[1]:arguments,lt=ze instanceof li,Nt=Ye[0],Pt=lt||Dn(ze),jt=function(di){var Ei=le.apply(Ee,jr([di],Ye));return F&&tn?Ei[0]:Ei};Pt&&_&&"function"==typeof Nt&&1!=Nt.length&&(lt=Pt=!1);var tn=this.__chain__,bn=!!this.__actions__.length,Fn=Ce&&!tn,ui=lt&&!bn;if(!Ce&&Pt){ze=ui?ze:new li(this);var kn=d.apply(ze,Ye);return kn.__actions__.push({func:$d,args:[jt],thisArg:J}),new Oo(kn,tn)}return Fn&&ui?d.apply(this,Ye):(kn=this.thru(jt),Fn?F?kn.value()[0]:kn.value():kn)})}),js(["pop","push","shift","sort","splice","unshift"],function(d){var f=lr[d],_=/^(?:push|sort|unshift)$/.test(d)?"tap":"thru",F=/^(?:pop|shift)$/.test(d);Ee.prototype[d]=function(){var le=arguments;if(F&&!this.__chain__){var Ce=this.value();return f.apply(Dn(Ce)?Ce:[],le)}return this[_](function(ze){return f.apply(Dn(ze)?ze:[],le)})}}),il(li.prototype,function(d,f){var _=Ee[f];if(_){var F=_.name+"";Gi.call(Ad,F)||(Ad[F]=[]),Ad[F].push({name:f,func:_})}}),Ad[Nc(J,2).name]=[{name:"wrapper",func:J}],li.prototype.clone=function(){var d=new li(this.__wrapped__);return d.__actions__=eo(this.__actions__),d.__dir__=this.__dir__,d.__filtered__=this.__filtered__,d.__iteratees__=eo(this.__iteratees__),d.__takeCount__=this.__takeCount__,d.__views__=eo(this.__views__),d},li.prototype.reverse=function(){if(this.__filtered__){var d=new li(this);d.__dir__=-1,d.__filtered__=!0}else(d=this.clone()).__dir__*=-1;return d},li.prototype.value=function(){var d=this.__wrapped__.value(),f=this.__dir__,_=Dn(d),F=f<0,le=_?d.length:0,Ce=function(d,f,_){for(var F=-1,le=_.length;++F<le;){var Ce=_[F],ze=Ce.size;switch(Ce.type){case"drop":d+=ze;break;case"dropRight":f-=ze;break;case"take":f=ps(f,d+ze);break;case"takeRight":d=Ur(d,f-ze)}}return{start:d,end:f}}(0,le,this.__views__),ze=Ce.start,Ye=Ce.end,lt=Ye-ze,Nt=F?Ye:ze-1,Pt=this.__iteratees__,jt=Pt.length,tn=0,bn=ps(lt,this.__takeCount__);if(!_||!F&&le==lt&&bn==lt)return j1(d,this.__actions__);var Fn=[];e:for(;lt--&&tn<bn;){for(var ui=-1,kn=d[Nt+=f];++ui<jt;){var di=Pt[ui],vo=di.type,Ws=(0,di.iteratee)(kn);if(2==vo)kn=Ws;else if(!Ws){if(1==vo)continue e;break e}}Fn[tn++]=kn}return Fn},Ee.prototype.at=G_,Ee.prototype.chain=function(){return H_(this)},Ee.prototype.commit=function(){return new Oo(this.value(),this.__chain__)},Ee.prototype.next=function(){this.__values__===J&&(this.__values__=pw(this.value()));var d=this.__index__>=this.__values__.length;return{done:d,value:d?J:this.__values__[this.__index__++]}},Ee.prototype.plant=function(d){for(var f,_=this;_ instanceof zh;){var F=kp(_);F.__index__=0,F.__values__=J,f?le.__wrapped__=F:f=F;var le=F;_=_.__wrapped__}return le.__wrapped__=d,f},Ee.prototype.reverse=function(){var d=this.__wrapped__;if(d instanceof li){var f=d;return this.__actions__.length&&(f=new li(this)),(f=f.reverse()).__actions__.push({func:$d,args:[j_],thisArg:J}),new Oo(f,this.__chain__)}return this.thru(j_)},Ee.prototype.toJSON=Ee.prototype.valueOf=Ee.prototype.value=function(){return j1(this.__wrapped__,this.__actions__)},Ee.prototype.first=Ee.prototype.head,Lh&&(Ee.prototype[Lh]=function(){return this}),Ee}();Fi._=Ph,(mt=function(){return Ph}.call(it,nt,it,Vt))!==J&&(Vt.exports=mt)}.call(this)},478:function(Vt){Vt.exports=function(){"use strict";function it(rt,at){for(var ut=0;ut<at.length;ut++){var ge=at[ut];ge.enumerable=ge.enumerable||!1,ge.configurable=!0,"value"in ge&&(ge.writable=!0),Object.defineProperty(rt,ge.key,ge)}}function J(rt,at){(null==at||at>rt.length)&&(at=rt.length);for(var ut=0,ge=new Array(at);ut<at;ut++)ge[ut]=rt[ut];return ge}function Mt(rt,at){var ut="undefined"!=typeof Symbol&&rt[Symbol.iterator]||rt["@@iterator"];if(ut)return(ut=ut.call(rt)).next.bind(ut);if(Array.isArray(rt)||(ut=function(rt,at){if(rt){if("string"==typeof rt)return J(rt,at);var ut=Object.prototype.toString.call(rt).slice(8,-1);if("Object"===ut&&rt.constructor&&(ut=rt.constructor.name),"Map"===ut||"Set"===ut)return Array.from(rt);if("Arguments"===ut||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ut))return J(rt,at)}}(rt))||at&&rt&&"number"==typeof rt.length){ut&&(rt=ut);var ge=0;return function(){return ge>=rt.length?{done:!0}:{done:!1,value:rt[ge++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var ht={exports:{}};function K(){return{baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}ht.exports={defaults:{baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1},getDefaults:K,changeDefaults:function(rt){ht.exports.defaults=rt}};var pe=/[&<>"']/,Y=/[&<>"']/g,U=/[<>"']|&(?!#?\w+;)/,k=/[<>"']|&(?!#?\w+;)/g,ie={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},W=function(at){return ie[at]};var C=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi;function P(rt){return rt.replace(C,function(at,ut){return"colon"===(ut=ut.toLowerCase())?":":"#"===ut.charAt(0)?"x"===ut.charAt(1)?String.fromCharCode(parseInt(ut.substring(2),16)):String.fromCharCode(+ut.substring(1)):""})}var M=/(^|[^\[])\^/g;var y=/[^\w:]/g,S=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;var j={},R=/^[^:]+:\/*[^/]*$/,q=/^([^:]+:)[\s\S]*$/,ue=/^([^:]+:\/*[^/]*)[\s\S]*$/;function D(rt,at){j[" "+rt]||(j[" "+rt]=R.test(rt)?rt+"/":G(rt,"/",!0));var ut=-1===(rt=j[" "+rt]).indexOf(":");return"//"===at.substring(0,2)?ut?at:rt.replace(q,"$1")+at:"/"===at.charAt(0)?ut?at:rt.replace(ue,"$1")+at:rt+at}function G(rt,at,ut){var ge=rt.length;if(0===ge)return"";for(var ve=0;ve<ge;){var ke=rt.charAt(ge-ve-1);if(ke!==at||ut){if(ke===at||!ut)break;ve++}else ve++}return rt.substr(0,ge-ve)}var ee_escape=function(rt,at){if(at){if(pe.test(rt))return rt.replace(Y,W)}else if(U.test(rt))return rt.replace(k,W);return rt},ee_unescape=P,ee_edit=function(rt,at){rt=rt.source||rt,at=at||"";var ut={replace:function(ve,ke){return ke=(ke=ke.source||ke).replace(M,"$1"),rt=rt.replace(ve,ke),ut},getRegex:function(){return new RegExp(rt,at)}};return ut},ee_cleanUrl=function(rt,at,ut){if(rt){var ge;try{ge=decodeURIComponent(P(ut)).replace(y,"").toLowerCase()}catch(ve){return null}if(0===ge.indexOf("javascript:")||0===ge.indexOf("vbscript:")||0===ge.indexOf("data:"))return null}at&&!S.test(ut)&&(ut=D(at,ut));try{ut=encodeURI(ut).replace(/%25/g,"%")}catch(ve){return null}return ut},ee_noopTest={exec:function(){}},ee_merge=function(rt){for(var ut,ge,at=1;at<arguments.length;at++)for(ge in ut=arguments[at])Object.prototype.hasOwnProperty.call(ut,ge)&&(rt[ge]=ut[ge]);return rt},ee_checkSanitizeDeprecation=function(rt){rt&&rt.sanitize&&!rt.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")},ee_repeatString=function(rt,at){if(at<1)return"";for(var ut="";at>1;)1&at&&(ut+=rt),at>>=1,rt+=rt;return ut+rt},xe=ht.exports.defaults,me=G,te=function(rt,at){var ge=rt.replace(/\|/g,function(ke,ct,Je){for(var Et=!1,Tt=ct;--Tt>=0&&"\\"===Je[Tt];)Et=!Et;return Et?"|":" |"}).split(/ \|/),ve=0;if(ge.length>at)ge.splice(at);else for(;ge.length<at;)ge.push("");for(;ve<ge.length;ve++)ge[ve]=ge[ve].trim().replace(/\\\|/g,"|");return ge},_e=ee_escape,Oe=function(rt,at){if(-1===rt.indexOf(at[1]))return-1;for(var ut=rt.length,ge=0,ve=0;ve<ut;ve++)if("\\"===rt[ve])ve++;else if(rt[ve]===at[0])ge++;else if(rt[ve]===at[1]&&--ge<0)return ve;return-1};function $e(rt,at,ut){var ge=at.href,ve=at.title?_e(at.title):null,ke=rt[1].replace(/\\([\[\]])/g,"$1");return"!"!==rt[0].charAt(0)?{type:"link",raw:ut,href:ge,title:ve,text:ke}:{type:"image",raw:ut,href:ge,title:ve,text:_e(ke)}}var Qe=function(){function rt(ut){this.options=ut||xe}var at=rt.prototype;return at.space=function(ge){var ve=this.rules.block.newline.exec(ge);if(ve)return ve[0].length>1?{type:"space",raw:ve[0]}:{raw:"\n"}},at.code=function(ge){var ve=this.rules.block.code.exec(ge);if(ve){var ke=ve[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:ve[0],codeBlockStyle:"indented",text:this.options.pedantic?ke:me(ke,"\n")}}},at.fences=function(ge){var ve=this.rules.block.fences.exec(ge);if(ve){var ke=ve[0],ct=function(rt,at){var ut=rt.match(/^(\s+)(?:```)/);if(null===ut)return at;var ge=ut[1];return at.split("\n").map(function(ve){var ke=ve.match(/^\s+/);return null===ke?ve:ke[0].length>=ge.length?ve.slice(ge.length):ve}).join("\n")}(ke,ve[3]||"");return{type:"code",raw:ke,lang:ve[2]?ve[2].trim():ve[2],text:ct}}},at.heading=function(ge){var ve=this.rules.block.heading.exec(ge);if(ve){var ke=ve[2].trim();if(/#$/.test(ke)){var ct=me(ke,"#");(this.options.pedantic||!ct||/ $/.test(ct))&&(ke=ct.trim())}return{type:"heading",raw:ve[0],depth:ve[1].length,text:ke}}},at.nptable=function(ge){var ve=this.rules.block.nptable.exec(ge);if(ve){var ke={type:"table",header:te(ve[1].replace(/^ *| *\| *$/g,"")),align:ve[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:ve[3]?ve[3].replace(/\n$/,"").split("\n"):[],raw:ve[0]};if(ke.header.length===ke.align.length){var Je,ct=ke.align.length;for(Je=0;Je<ct;Je++)ke.align[Je]=/^ *-+: *$/.test(ke.align[Je])?"right":/^ *:-+: *$/.test(ke.align[Je])?"center":/^ *:-+ *$/.test(ke.align[Je])?"left":null;for(ct=ke.cells.length,Je=0;Je<ct;Je++)ke.cells[Je]=te(ke.cells[Je],ke.header.length);return ke}}},at.hr=function(ge){var ve=this.rules.block.hr.exec(ge);if(ve)return{type:"hr",raw:ve[0]}},at.blockquote=function(ge){var ve=this.rules.block.blockquote.exec(ge);if(ve){var ke=ve[0].replace(/^ *> ?/gm,"");return{type:"blockquote",raw:ve[0],text:ke}}},at.list=function(ge){var ve=this.rules.block.list.exec(ge);if(ve){var Yt,jn,ri,On,mn,$n,Sn,nr,ir,ke=ve[0],ct=ve[2],Je=ct.length>1,Et={type:"list",raw:ke,ordered:Je,start:Je?+ct.slice(0,-1):"",loose:!1,items:[]},Tt=ve[0].match(this.rules.block.item),Dt=!1,Yn=Tt.length;ri=this.rules.block.listItemStart.exec(Tt[0]);for(var ji=0;ji<Yn;ji++){if(ke=Yt=Tt[ji],this.options.pedantic||(ir=Yt.match(new RegExp("\\n\\s*\\n {0,"+(ri[0].length-1)+"}\\S")))&&(mn=Yt.length-ir.index+Tt.slice(ji+1).join("\n").length,Et.raw=Et.raw.substring(0,Et.raw.length-mn),ke=Yt=Yt.substring(0,ir.index),Yn=ji+1),ji!==Yn-1){if(On=this.rules.block.listItemStart.exec(Tt[ji+1]),this.options.pedantic?On[1].length>ri[1].length:On[1].length>=ri[0].length||On[1].length>3){Tt.splice(ji,2,Tt[ji]+(!this.options.pedantic&&On[1].length<ri[0].length&&!Tt[ji].match(/\n$/)?"":"\n")+Tt[ji+1]),ji--,Yn--;continue}(!this.options.pedantic||this.options.smartLists?On[2][On[2].length-1]!==ct[ct.length-1]:Je===(1===On[2].length))&&(mn=Tt.slice(ji+1).join("\n").length,Et.raw=Et.raw.substring(0,Et.raw.length-mn),ji=Yn-1),ri=On}jn=Yt.length,~(Yt=Yt.replace(/^ *([*+-]|\d+[.)]) ?/,"")).indexOf("\n ")&&(jn-=Yt.length,Yt=Yt.replace(this.options.pedantic?/^ {1,4}/gm:new RegExp("^ {1,"+jn+"}","gm"),"")),Yt=me(Yt,"\n"),ji!==Yn-1&&(ke+="\n"),$n=Dt||/\n\n(?!\s*$)/.test(ke),ji!==Yn-1&&(Dt="\n\n"===ke.slice(-2),$n||($n=Dt)),$n&&(Et.loose=!0),this.options.gfm&&(nr=void 0,(Sn=/^\[[ xX]\] /.test(Yt))&&(nr=" "!==Yt[1],Yt=Yt.replace(/^\[[ xX]\] +/,""))),Et.items.push({type:"list_item",raw:ke,task:Sn,checked:nr,loose:$n,text:Yt})}return Et}},at.html=function(ge){var ve=this.rules.block.html.exec(ge);if(ve)return{type:this.options.sanitize?"paragraph":"html",raw:ve[0],pre:!this.options.sanitizer&&("pre"===ve[1]||"script"===ve[1]||"style"===ve[1]),text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(ve[0]):_e(ve[0]):ve[0]}},at.def=function(ge){var ve=this.rules.block.def.exec(ge);if(ve)return ve[3]&&(ve[3]=ve[3].substring(1,ve[3].length-1)),{type:"def",tag:ve[1].toLowerCase().replace(/\s+/g," "),raw:ve[0],href:ve[2],title:ve[3]}},at.table=function(ge){var ve=this.rules.block.table.exec(ge);if(ve){var ke={type:"table",header:te(ve[1].replace(/^ *| *\| *$/g,"")),align:ve[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:ve[3]?ve[3].replace(/\n$/,"").split("\n"):[]};if(ke.header.length===ke.align.length){ke.raw=ve[0];var Je,ct=ke.align.length;for(Je=0;Je<ct;Je++)ke.align[Je]=/^ *-+: *$/.test(ke.align[Je])?"right":/^ *:-+: *$/.test(ke.align[Je])?"center":/^ *:-+ *$/.test(ke.align[Je])?"left":null;for(ct=ke.cells.length,Je=0;Je<ct;Je++)ke.cells[Je]=te(ke.cells[Je].replace(/^ *\| *| *\| *$/g,""),ke.header.length);return ke}}},at.lheading=function(ge){var ve=this.rules.block.lheading.exec(ge);if(ve)return{type:"heading",raw:ve[0],depth:"="===ve[2].charAt(0)?1:2,text:ve[1]}},at.paragraph=function(ge){var ve=this.rules.block.paragraph.exec(ge);if(ve)return{type:"paragraph",raw:ve[0],text:"\n"===ve[1].charAt(ve[1].length-1)?ve[1].slice(0,-1):ve[1]}},at.text=function(ge){var ve=this.rules.block.text.exec(ge);if(ve)return{type:"text",raw:ve[0],text:ve[0]}},at.escape=function(ge){var ve=this.rules.inline.escape.exec(ge);if(ve)return{type:"escape",raw:ve[0],text:_e(ve[1])}},at.tag=function(ge,ve,ke){var ct=this.rules.inline.tag.exec(ge);if(ct)return!ve&&/^<a /i.test(ct[0])?ve=!0:ve&&/^<\/a>/i.test(ct[0])&&(ve=!1),!ke&&/^<(pre|code|kbd|script)(\s|>)/i.test(ct[0])?ke=!0:ke&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(ct[0])&&(ke=!1),{type:this.options.sanitize?"text":"html",raw:ct[0],inLink:ve,inRawBlock:ke,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(ct[0]):_e(ct[0]):ct[0]}},at.link=function(ge){var ve=this.rules.inline.link.exec(ge);if(ve){var ke=ve[2].trim();if(!this.options.pedantic&&/^</.test(ke)){if(!/>$/.test(ke))return;var ct=me(ke.slice(0,-1),"\\");if((ke.length-ct.length)%2==0)return}else{var Je=Oe(ve[2],"()");if(Je>-1){var Tt=(0===ve[0].indexOf("!")?5:4)+ve[1].length+Je;ve[2]=ve[2].substring(0,Je),ve[0]=ve[0].substring(0,Tt).trim(),ve[3]=""}}var Dt=ve[2],Yt="";if(this.options.pedantic){var jn=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(Dt);jn&&(Dt=jn[1],Yt=jn[3])}else Yt=ve[3]?ve[3].slice(1,-1):"";return Dt=Dt.trim(),/^</.test(Dt)&&(Dt=this.options.pedantic&&!/>$/.test(ke)?Dt.slice(1):Dt.slice(1,-1)),$e(ve,{href:Dt&&Dt.replace(this.rules.inline._escapes,"$1"),title:Yt&&Yt.replace(this.rules.inline._escapes,"$1")},ve[0])}},at.reflink=function(ge,ve){var ke;if((ke=this.rules.inline.reflink.exec(ge))||(ke=this.rules.inline.nolink.exec(ge))){var ct=(ke[2]||ke[1]).replace(/\s+/g," ");if(!(ct=ve[ct.toLowerCase()])||!ct.href){var Je=ke[0].charAt(0);return{type:"text",raw:Je,text:Je}}return $e(ke,ct,ke[0])}},at.emStrong=function(ge,ve,ke){void 0===ke&&(ke="");var ct=this.rules.inline.emStrong.lDelim.exec(ge);if(ct&&(!ct[3]||!ke.match(/(?:[0-9A-Za-z\xAA\xB2\xB3\xB5\xB9\xBA\xBC-\xBE\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u0660-\u0669\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07C0-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08C7\u0904-\u0939\u093D\u0950\u0958-\u0961\u0966-\u096F\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09E6-\u09F1\u09F4-\u09F9\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A66-\u0A6F\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AE6-\u0AEF\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B66-\u0B6F\u0B71-\u0B77\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0BE6-\u0BF2\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C66-\u0C6F\u0C78-\u0C7E\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CE6-\u0CEF\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D58-\u0D61\u0D66-\u0D78\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DE6-\u0DEF\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F20-\u0F33\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F-\u1049\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u1090-\u1099\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1369-\u137C\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u17E0-\u17E9\u17F0-\u17F9\u1810-\u1819\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A16\u1A20-\u1A54\u1A80-\u1A89\u1A90-\u1A99\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B50-\u1B59\u1B83-\u1BA0\u1BAE-\u1BE5\u1C00-\u1C23\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2070\u2071\u2074-\u2079\u207F-\u2089\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2150-\u2189\u2460-\u249B\u24EA-\u24FF\u2776-\u2793\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2CFD\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u3192-\u3195\u31A0-\u31BF\u31F0-\u31FF\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\u3400-\u4DBF\u4E00-\u9FFC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7BF\uA7C2-\uA7CA\uA7F5-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA830-\uA835\uA840-\uA873\uA882-\uA8B3\uA8D0-\uA8D9\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA900-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF-\uA9D9\uA9E0-\uA9E4\uA9E6-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA50-\uAA59\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD07-\uDD33\uDD40-\uDD78\uDD8A\uDD8B\uDE80-\uDE9C\uDEA0-\uDED0\uDEE1-\uDEFB\uDF00-\uDF23\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC58-\uDC76\uDC79-\uDC9E\uDCA7-\uDCAF\uDCE0-\uDCF2\uDCF4\uDCF5\uDCFB-\uDD1B\uDD20-\uDD39\uDD80-\uDDB7\uDDBC-\uDDCF\uDDD2-\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE40-\uDE48\uDE60-\uDE7E\uDE80-\uDE9F\uDEC0-\uDEC7\uDEC9-\uDEE4\uDEEB-\uDEEF\uDF00-\uDF35\uDF40-\uDF55\uDF58-\uDF72\uDF78-\uDF91\uDFA9-\uDFAF]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDCFA-\uDD23\uDD30-\uDD39\uDE60-\uDE7E\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF27\uDF30-\uDF45\uDF51-\uDF54\uDFB0-\uDFCB\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC52-\uDC6F\uDC83-\uDCAF\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD03-\uDD26\uDD36-\uDD3F\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDD0-\uDDDA\uDDDC\uDDE1-\uDDF4\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDEF0-\uDEF9\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC50-\uDC59\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE50-\uDE59\uDE80-\uDEAA\uDEB8\uDEC0-\uDEC9\uDF00-\uDF1A\uDF30-\uDF3B]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCF2\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDD50-\uDD59\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC50-\uDC6C\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD50-\uDD59\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDDA0-\uDDA9\uDEE0-\uDEF2\uDFB0\uDFC0-\uDFD4]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF50-\uDF59\uDF5B-\uDF61\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE96\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82C[\uDC00-\uDD1E\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD834[\uDEE0-\uDEF3\uDF60-\uDF78]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD838[\uDD00-\uDD2C\uDD37-\uDD3D\uDD40-\uDD49\uDD4E\uDEC0-\uDEEB\uDEF0-\uDEF9]|\uD83A[\uDC00-\uDCC4\uDCC7-\uDCCF\uDD00-\uDD43\uDD4B\uDD50-\uDD59]|\uD83B[\uDC71-\uDCAB\uDCAD-\uDCAF\uDCB1-\uDCB4\uDD01-\uDD2D\uDD2F-\uDD3D\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD83C[\uDD00-\uDD0C]|\uD83E[\uDFF0-\uDFF9]|\uD869[\uDC00-\uDEDD\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])/))){var Je=ct[1]||ct[2]||"";if(!Je||Je&&(""===ke||this.rules.inline.punctuation.exec(ke))){var Tt,Dt,Et=ct[0].length-1,Yt=Et,jn=0,ri="*"===ct[0][0]?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(ri.lastIndex=0,ve=ve.slice(-1*ge.length+Et);null!=(ct=ri.exec(ve));)if(Tt=ct[1]||ct[2]||ct[3]||ct[4]||ct[5]||ct[6]){if(Dt=Tt.length,ct[3]||ct[4]){Yt+=Dt;continue}if((ct[5]||ct[6])&&Et%3&&!((Et+Dt)%3)){jn+=Dt;continue}if(!((Yt-=Dt)>0))return Dt=Math.min(Dt,Dt+Yt+jn),Math.min(Et,Dt)%2?{type:"em",raw:ge.slice(0,Et+ct.index+Dt+1),text:ge.slice(1,Et+ct.index+Dt)}:{type:"strong",raw:ge.slice(0,Et+ct.index+Dt+1),text:ge.slice(2,Et+ct.index+Dt-1)}}}}},at.codespan=function(ge){var ve=this.rules.inline.code.exec(ge);if(ve){var ke=ve[2].replace(/\n/g," "),ct=/[^ ]/.test(ke),Je=/^ /.test(ke)&&/ $/.test(ke);return ct&&Je&&(ke=ke.substring(1,ke.length-1)),ke=_e(ke,!0),{type:"codespan",raw:ve[0],text:ke}}},at.br=function(ge){var ve=this.rules.inline.br.exec(ge);if(ve)return{type:"br",raw:ve[0]}},at.del=function(ge){var ve=this.rules.inline.del.exec(ge);if(ve)return{type:"del",raw:ve[0],text:ve[2]}},at.autolink=function(ge,ve){var ct,Je,ke=this.rules.inline.autolink.exec(ge);if(ke)return Je="@"===ke[2]?"mailto:"+(ct=_e(this.options.mangle?ve(ke[1]):ke[1])):ct=_e(ke[1]),{type:"link",raw:ke[0],text:ct,href:Je,tokens:[{type:"text",raw:ct,text:ct}]}},at.url=function(ge,ve){var ke;if(ke=this.rules.inline.url.exec(ge)){var ct,Je;if("@"===ke[2])Je="mailto:"+(ct=_e(this.options.mangle?ve(ke[0]):ke[0]));else{var Et;do{Et=ke[0],ke[0]=this.rules.inline._backpedal.exec(ke[0])[0]}while(Et!==ke[0]);ct=_e(ke[0]),Je="www."===ke[1]?"http://"+ct:ct}return{type:"link",raw:ke[0],text:ct,href:Je,tokens:[{type:"text",raw:ct,text:ct}]}}},at.inlineText=function(ge,ve,ke){var Je,ct=this.rules.inline.text.exec(ge);if(ct)return Je=ve?this.options.sanitize?this.options.sanitizer?this.options.sanitizer(ct[0]):_e(ct[0]):ct[0]:_e(this.options.smartypants?ke(ct[0]):ct[0]),{type:"text",raw:ct[0],text:Je}},rt}(),et=ee_noopTest,Ke=ee_edit,Ue=ee_merge,Le={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?:\n+|$)|$)/,hr:/^ {0,3}((?:- *){3,}|(?:_ *){3,}|(?:\* *){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3})(bull) [\s\S]+?(?:hr|def|\n{2,}(?! )(?! {0,3}bull )\n*|\s*$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *\n? *<?([^\s>]+)>?(?:(?: +\n? *| *\n *)(title))? *(?:\n+|$)/,nptable:et,table:et,lheading:/^([^\n]+)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html| +\n)[^\n]+)*)/,text:/^[^\n]+/,_label:/(?!\s*\])(?:\\[\[\]]|[^\[\]])+/,_title:/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/};Le.def=Ke(Le.def).replace("label",Le._label).replace("title",Le._title).getRegex(),Le.bullet=/(?:[*+-]|\d{1,9}[.)])/,Le.item=/^( *)(bull) ?[^\n]*(?:\n(?! *bull ?)[^\n]*)*/,Le.item=Ke(Le.item,"gm").replace(/bull/g,Le.bullet).getRegex(),Le.listItemStart=Ke(/^( *)(bull) */).replace("bull",Le.bullet).getRegex(),Le.list=Ke(Le.list).replace(/bull/g,Le.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+Le.def.source+")").getRegex(),Le._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Le._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/,Le.html=Ke(Le.html,"i").replace("comment",Le._comment).replace("tag",Le._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Le.paragraph=Ke(Le._paragraph).replace("hr",Le.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Le._tag).getRegex(),Le.blockquote=Ke(Le.blockquote).replace("paragraph",Le.paragraph).getRegex(),Le.normal=Ue({},Le),Le.gfm=Ue({},Le.normal,{nptable:"^ *([^|\\n ].*\\|.*)\\n {0,3}([-:]+ *\\|[-| :]*)(?:\\n((?:(?!\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)",table:"^ *\\|(.+)\\n {0,3}\\|?( *[-:]+[-| :]*)(?:\\n *((?:(?!\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"}),Le.gfm.nptable=Ke(Le.gfm.nptable).replace("hr",Le.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Le._tag).getRegex(),Le.gfm.table=Ke(Le.gfm.table).replace("hr",Le.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Le._tag).getRegex(),Le.pedantic=Ue({},Le.normal,{html:Ke("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",Le._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:et,paragraph:Ke(Le.normal._paragraph).replace("hr",Le.hr).replace("heading"," *#{1,6} *[^\n]").replace("lheading",Le.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()});var Xe={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:et,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(?!\s*\])((?:\\[\[\]]?|[^\[\]\\])+)\]/,nolink:/^!?\[(?!\s*\])((?:\[[^\[\]]*\]|\\[\[\]]|[^\[\]])*)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/\_\_[^_*]*?\*[^_*]*?\_\_|[punct_](\*+)(?=[\s]|$)|[^punct*_\s](\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|[^punct*_\s](\*+)(?=[^punct*_\s])/,rDelimUnd:/\*\*[^_*]*?\_[^_*]*?\*\*|[punct*](\_+)(?=[\s]|$)|[^punct*_\s](\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:et,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/,_punctuation:"!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~"};Xe.punctuation=Ke(Xe.punctuation).replace(/punctuation/g,Xe._punctuation).getRegex(),Xe.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g,Xe.escapedEmSt=/\\\*|\\_/g,Xe._comment=Ke(Le._comment).replace("(?:--\x3e|$)","--\x3e").getRegex(),Xe.emStrong.lDelim=Ke(Xe.emStrong.lDelim).replace(/punct/g,Xe._punctuation).getRegex(),Xe.emStrong.rDelimAst=Ke(Xe.emStrong.rDelimAst,"g").replace(/punct/g,Xe._punctuation).getRegex(),Xe.emStrong.rDelimUnd=Ke(Xe.emStrong.rDelimUnd,"g").replace(/punct/g,Xe._punctuation).getRegex(),Xe._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g,Xe._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,Xe._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,Xe.autolink=Ke(Xe.autolink).replace("scheme",Xe._scheme).replace("email",Xe._email).getRegex(),Xe._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/,Xe.tag=Ke(Xe.tag).replace("comment",Xe._comment).replace("attribute",Xe._attribute).getRegex(),Xe._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,Xe._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/,Xe._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/,Xe.link=Ke(Xe.link).replace("label",Xe._label).replace("href",Xe._href).replace("title",Xe._title).getRegex(),Xe.reflink=Ke(Xe.reflink).replace("label",Xe._label).getRegex(),Xe.reflinkSearch=Ke(Xe.reflinkSearch,"g").replace("reflink",Xe.reflink).replace("nolink",Xe.nolink).getRegex(),Xe.normal=Ue({},Xe),Xe.pedantic=Ue({},Xe.normal,{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:Ke(/^!?\[(label)\]\((.*?)\)/).replace("label",Xe._label).getRegex(),reflink:Ke(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Xe._label).getRegex()}),Xe.gfm=Ue({},Xe.normal,{escape:Ke(Xe.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/}),Xe.gfm.url=Ke(Xe.gfm.url,"i").replace("email",Xe.gfm._extended_email).getRegex(),Xe.breaks=Ue({},Xe.gfm,{br:Ke(Xe.br).replace("{2,}","*").getRegex(),text:Ke(Xe.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()});var Te={block:Le,inline:Xe},je=Qe,qe=ht.exports.defaults,Ne=Te.block,$=Te.inline,z=ee_repeatString;function fe(rt){return rt.replace(/---/g,"\u2014").replace(/--/g,"\u2013").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1\u2018").replace(/'/g,"\u2019").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1\u201c").replace(/"/g,"\u201d").replace(/\.{3}/g,"\u2026")}function de(rt){var ut,ge,at="",ve=rt.length;for(ut=0;ut<ve;ut++)ge=rt.charCodeAt(ut),Math.random()>.5&&(ge="x"+ge.toString(16)),at+="&#"+ge+";";return at}var Ve=function(){function rt(ut){this.tokens=[],this.tokens.links=Object.create(null),this.options=ut||qe,this.options.tokenizer=this.options.tokenizer||new je,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options;var ge={block:Ne.normal,inline:$.normal};this.options.pedantic?(ge.block=Ne.pedantic,ge.inline=$.pedantic):this.options.gfm&&(ge.block=Ne.gfm,ge.inline=this.options.breaks?$.breaks:$.gfm),this.tokenizer.rules=ge}rt.lex=function(ge,ve){return new rt(ve).lex(ge)},rt.lexInline=function(ge,ve){return new rt(ve).inlineTokens(ge)};var at=rt.prototype;return at.lex=function(ge){return ge=ge.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    "),this.blockTokens(ge,this.tokens,!0),this.inline(this.tokens),this.tokens},at.blockTokens=function(ge,ve,ke){var Je,Et,Tt,Dt,Yt,jn,ct=this;for(void 0===ve&&(ve=[]),void 0===ke&&(ke=!0),this.options.pedantic&&(ge=ge.replace(/^ +$/gm,""));ge;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(function(On){return!!(Je=On.call(ct,ge,ve))&&(ge=ge.substring(Je.raw.length),ve.push(Je),!0)}))){if(Je=this.tokenizer.space(ge)){ge=ge.substring(Je.raw.length),Je.type&&ve.push(Je);continue}if(Je=this.tokenizer.code(ge)){ge=ge.substring(Je.raw.length),(Dt=ve[ve.length-1])&&"paragraph"===Dt.type?(Dt.raw+="\n"+Je.raw,Dt.text+="\n"+Je.text):ve.push(Je);continue}if(Je=this.tokenizer.fences(ge)){ge=ge.substring(Je.raw.length),ve.push(Je);continue}if(Je=this.tokenizer.heading(ge)){ge=ge.substring(Je.raw.length),ve.push(Je);continue}if(Je=this.tokenizer.nptable(ge)){ge=ge.substring(Je.raw.length),ve.push(Je);continue}if(Je=this.tokenizer.hr(ge)){ge=ge.substring(Je.raw.length),ve.push(Je);continue}if(Je=this.tokenizer.blockquote(ge)){ge=ge.substring(Je.raw.length),Je.tokens=this.blockTokens(Je.text,[],ke),ve.push(Je);continue}if(Je=this.tokenizer.list(ge)){for(ge=ge.substring(Je.raw.length),Tt=Je.items.length,Et=0;Et<Tt;Et++)Je.items[Et].tokens=this.blockTokens(Je.items[Et].text,[],!1);ve.push(Je);continue}if(Je=this.tokenizer.html(ge)){ge=ge.substring(Je.raw.length),ve.push(Je);continue}if(ke&&(Je=this.tokenizer.def(ge))){ge=ge.substring(Je.raw.length),this.tokens.links[Je.tag]||(this.tokens.links[Je.tag]={href:Je.href,title:Je.title});continue}if(Je=this.tokenizer.table(ge)){ge=ge.substring(Je.raw.length),ve.push(Je);continue}if(Je=this.tokenizer.lheading(ge)){ge=ge.substring(Je.raw.length),ve.push(Je);continue}if(Yt=ge,this.options.extensions&&this.options.extensions.startBlock&&function(){var On=1/0,mn=ge.slice(1),$n=void 0;ct.options.extensions.startBlock.forEach(function(Sn){"number"==typeof($n=Sn.call(this,mn))&&$n>=0&&(On=Math.min(On,$n))}),On<1/0&&On>=0&&(Yt=ge.substring(0,On+1))}(),ke&&(Je=this.tokenizer.paragraph(Yt))){Dt=ve[ve.length-1],jn&&"paragraph"===Dt.type?(Dt.raw+="\n"+Je.raw,Dt.text+="\n"+Je.text):ve.push(Je),jn=Yt.length!==ge.length,ge=ge.substring(Je.raw.length);continue}if(Je=this.tokenizer.text(ge)){ge=ge.substring(Je.raw.length),(Dt=ve[ve.length-1])&&"text"===Dt.type?(Dt.raw+="\n"+Je.raw,Dt.text+="\n"+Je.text):ve.push(Je);continue}if(ge){var ri="Infinite loop on byte: "+ge.charCodeAt(0);if(this.options.silent){console.error(ri);break}throw new Error(ri)}}return ve},at.inline=function(ge){var ve,ke,ct,Je,Et,Tt,Dt=ge.length;for(ve=0;ve<Dt;ve++)switch(Tt=ge[ve],Tt.type){case"paragraph":case"text":case"heading":Tt.tokens=[],this.inlineTokens(Tt.text,Tt.tokens);break;case"table":for(Tt.tokens={header:[],cells:[]},Je=Tt.header.length,ke=0;ke<Je;ke++)Tt.tokens.header[ke]=[],this.inlineTokens(Tt.header[ke],Tt.tokens.header[ke]);for(Je=Tt.cells.length,ke=0;ke<Je;ke++)for(Et=Tt.cells[ke],Tt.tokens.cells[ke]=[],ct=0;ct<Et.length;ct++)Tt.tokens.cells[ke][ct]=[],this.inlineTokens(Et[ct],Tt.tokens.cells[ke][ct]);break;case"blockquote":this.inline(Tt.tokens);break;case"list":for(Je=Tt.items.length,ke=0;ke<Je;ke++)this.inline(Tt.items[ke].tokens)}return ge},at.inlineTokens=function(ge,ve,ke,ct){var Je=this;void 0===ve&&(ve=[]),void 0===ke&&(ke=!1),void 0===ct&&(ct=!1);var Et,Tt,Dt,jn,ri,On,Yt=ge;if(this.tokens.links){var mn=Object.keys(this.tokens.links);if(mn.length>0)for(;null!=(jn=this.tokenizer.rules.inline.reflinkSearch.exec(Yt));)mn.includes(jn[0].slice(jn[0].lastIndexOf("[")+1,-1))&&(Yt=Yt.slice(0,jn.index)+"["+z("a",jn[0].length-2)+"]"+Yt.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;null!=(jn=this.tokenizer.rules.inline.blockSkip.exec(Yt));)Yt=Yt.slice(0,jn.index)+"["+z("a",jn[0].length-2)+"]"+Yt.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;null!=(jn=this.tokenizer.rules.inline.escapedEmSt.exec(Yt));)Yt=Yt.slice(0,jn.index)+"++"+Yt.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex);for(;ge;)if(ri||(On=""),ri=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(function(Sn){return!!(Et=Sn.call(Je,ge,ve))&&(ge=ge.substring(Et.raw.length),ve.push(Et),!0)}))){if(Et=this.tokenizer.escape(ge)){ge=ge.substring(Et.raw.length),ve.push(Et);continue}if(Et=this.tokenizer.tag(ge,ke,ct)){ge=ge.substring(Et.raw.length),ke=Et.inLink,ct=Et.inRawBlock,(Tt=ve[ve.length-1])&&"text"===Et.type&&"text"===Tt.type?(Tt.raw+=Et.raw,Tt.text+=Et.text):ve.push(Et);continue}if(Et=this.tokenizer.link(ge)){ge=ge.substring(Et.raw.length),"link"===Et.type&&(Et.tokens=this.inlineTokens(Et.text,[],!0,ct)),ve.push(Et);continue}if(Et=this.tokenizer.reflink(ge,this.tokens.links)){ge=ge.substring(Et.raw.length),Tt=ve[ve.length-1],"link"===Et.type?(Et.tokens=this.inlineTokens(Et.text,[],!0,ct),ve.push(Et)):Tt&&"text"===Et.type&&"text"===Tt.type?(Tt.raw+=Et.raw,Tt.text+=Et.text):ve.push(Et);continue}if(Et=this.tokenizer.emStrong(ge,Yt,On)){ge=ge.substring(Et.raw.length),Et.tokens=this.inlineTokens(Et.text,[],ke,ct),ve.push(Et);continue}if(Et=this.tokenizer.codespan(ge)){ge=ge.substring(Et.raw.length),ve.push(Et);continue}if(Et=this.tokenizer.br(ge)){ge=ge.substring(Et.raw.length),ve.push(Et);continue}if(Et=this.tokenizer.del(ge)){ge=ge.substring(Et.raw.length),Et.tokens=this.inlineTokens(Et.text,[],ke,ct),ve.push(Et);continue}if(Et=this.tokenizer.autolink(ge,de)){ge=ge.substring(Et.raw.length),ve.push(Et);continue}if(!ke&&(Et=this.tokenizer.url(ge,de))){ge=ge.substring(Et.raw.length),ve.push(Et);continue}if(Dt=ge,this.options.extensions&&this.options.extensions.startInline&&function(){var Sn=1/0,nr=ge.slice(1),ir=void 0;Je.options.extensions.startInline.forEach(function(Yn){"number"==typeof(ir=Yn.call(this,nr))&&ir>=0&&(Sn=Math.min(Sn,ir))}),Sn<1/0&&Sn>=0&&(Dt=ge.substring(0,Sn+1))}(),Et=this.tokenizer.inlineText(Dt,ct,fe)){ge=ge.substring(Et.raw.length),"_"!==Et.raw.slice(-1)&&(On=Et.raw.slice(-1)),ri=!0,(Tt=ve[ve.length-1])&&"text"===Tt.type?(Tt.raw+=Et.raw,Tt.text+=Et.text):ve.push(Et);continue}if(ge){var $n="Infinite loop on byte: "+ge.charCodeAt(0);if(this.options.silent){console.error($n);break}throw new Error($n)}}return ve},function(rt,at,ut){at&&it(rt.prototype,at),ut&&it(rt,ut)}(rt,null,[{key:"rules",get:function(){return{block:Ne,inline:$}}}]),rt}(),gt=ht.exports.defaults,ft=ee_cleanUrl,be=ee_escape,B=function(){function rt(ut){this.options=ut||gt}var at=rt.prototype;return at.code=function(ge,ve,ke){var ct=(ve||"").match(/\S*/)[0];if(this.options.highlight){var Je=this.options.highlight(ge,ct);null!=Je&&Je!==ge&&(ke=!0,ge=Je)}return ge=ge.replace(/\n$/,"")+"\n",ct?'<pre><code class="'+this.options.langPrefix+be(ct,!0)+'">'+(ke?ge:be(ge,!0))+"</code></pre>\n":"<pre><code>"+(ke?ge:be(ge,!0))+"</code></pre>\n"},at.blockquote=function(ge){return"<blockquote>\n"+ge+"</blockquote>\n"},at.html=function(ge){return ge},at.heading=function(ge,ve,ke,ct){return this.options.headerIds?"<h"+ve+' id="'+this.options.headerPrefix+ct.slug(ke)+'">'+ge+"</h"+ve+">\n":"<h"+ve+">"+ge+"</h"+ve+">\n"},at.hr=function(){return this.options.xhtml?"<hr/>\n":"<hr>\n"},at.list=function(ge,ve,ke){var ct=ve?"ol":"ul";return"<"+ct+(ve&&1!==ke?' start="'+ke+'"':"")+">\n"+ge+"</"+ct+">\n"},at.listitem=function(ge){return"<li>"+ge+"</li>\n"},at.checkbox=function(ge){return"<input "+(ge?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "},at.paragraph=function(ge){return"<p>"+ge+"</p>\n"},at.table=function(ge,ve){return ve&&(ve="<tbody>"+ve+"</tbody>"),"<table>\n<thead>\n"+ge+"</thead>\n"+ve+"</table>\n"},at.tablerow=function(ge){return"<tr>\n"+ge+"</tr>\n"},at.tablecell=function(ge,ve){var ke=ve.header?"th":"td";return(ve.align?"<"+ke+' align="'+ve.align+'">':"<"+ke+">")+ge+"</"+ke+">\n"},at.strong=function(ge){return"<strong>"+ge+"</strong>"},at.em=function(ge){return"<em>"+ge+"</em>"},at.codespan=function(ge){return"<code>"+ge+"</code>"},at.br=function(){return this.options.xhtml?"<br/>":"<br>"},at.del=function(ge){return"<del>"+ge+"</del>"},at.link=function(ge,ve,ke){if(null===(ge=ft(this.options.sanitize,this.options.baseUrl,ge)))return ke;var ct='<a href="'+be(ge)+'"';return ve&&(ct+=' title="'+ve+'"'),ct+">"+ke+"</a>"},at.image=function(ge,ve,ke){if(null===(ge=ft(this.options.sanitize,this.options.baseUrl,ge)))return ke;var ct='<img src="'+ge+'" alt="'+ke+'"';return ve&&(ct+=' title="'+ve+'"'),ct+(this.options.xhtml?"/>":">")},at.text=function(ge){return ge},rt}(),N=function(){function rt(){}var at=rt.prototype;return at.strong=function(ge){return ge},at.em=function(ge){return ge},at.codespan=function(ge){return ge},at.del=function(ge){return ge},at.html=function(ge){return ge},at.text=function(ge){return ge},at.link=function(ge,ve,ke){return""+ke},at.image=function(ge,ve,ke){return""+ke},at.br=function(){return""},rt}(),V=function(){function rt(){this.seen={}}var at=rt.prototype;return at.serialize=function(ge){return ge.toLowerCase().trim().replace(/<[!\/a-z].*?>/gi,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")},at.getNextSafeSlug=function(ge,ve){var ke=ge,ct=0;if(this.seen.hasOwnProperty(ke)){ct=this.seen[ge];do{ke=ge+"-"+ ++ct}while(this.seen.hasOwnProperty(ke))}return ve||(this.seen[ge]=ct,this.seen[ke]=0),ke},at.slug=function(ge,ve){void 0===ve&&(ve={});var ke=this.serialize(ge);return this.getNextSafeSlug(ke,ve.dryrun)},rt}(),Re=B,Ze=N,bt=V,Rt=ht.exports.defaults,Mn=ee_unescape,Gn=Ve,wi=function(){function rt(ut){this.options=ut||Rt,this.options.renderer=this.options.renderer||new Re,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new Ze,this.slugger=new bt}rt.parse=function(ge,ve){return new rt(ve).parse(ge)},rt.parseInline=function(ge,ve){return new rt(ve).parseInline(ge)};var at=rt.prototype;return at.parse=function(ge,ve){void 0===ve&&(ve=!0);var ct,Je,Et,Tt,Dt,Yt,jn,ri,On,mn,$n,Sn,nr,ir,Yn,ji,va,Yr,ne,ke="",he=ge.length;for(ct=0;ct<he;ct++)if(mn=ge[ct],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[mn.type]&&(!1!==(ne=this.options.extensions.renderers[mn.type].call(this,mn))||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(mn.type)))ke+=ne||"";else switch(mn.type){case"space":continue;case"hr":ke+=this.renderer.hr();continue;case"heading":ke+=this.renderer.heading(this.parseInline(mn.tokens),mn.depth,Mn(this.parseInline(mn.tokens,this.textRenderer)),this.slugger);continue;case"code":ke+=this.renderer.code(mn.text,mn.lang,mn.escaped);continue;case"table":for(ri="",jn="",Tt=mn.header.length,Je=0;Je<Tt;Je++)jn+=this.renderer.tablecell(this.parseInline(mn.tokens.header[Je]),{header:!0,align:mn.align[Je]});for(ri+=this.renderer.tablerow(jn),On="",Tt=mn.cells.length,Je=0;Je<Tt;Je++){for(jn="",Dt=(Yt=mn.tokens.cells[Je]).length,Et=0;Et<Dt;Et++)jn+=this.renderer.tablecell(this.parseInline(Yt[Et]),{header:!1,align:mn.align[Et]});On+=this.renderer.tablerow(jn)}ke+=this.renderer.table(ri,On);continue;case"blockquote":On=this.parse(mn.tokens),ke+=this.renderer.blockquote(On);continue;case"list":for($n=mn.ordered,Sn=mn.start,nr=mn.loose,Tt=mn.items.length,On="",Je=0;Je<Tt;Je++)ji=(Yn=mn.items[Je]).checked,va=Yn.task,ir="",Yn.task&&(Yr=this.renderer.checkbox(ji),nr?Yn.tokens.length>0&&"text"===Yn.tokens[0].type?(Yn.tokens[0].text=Yr+" "+Yn.tokens[0].text,Yn.tokens[0].tokens&&Yn.tokens[0].tokens.length>0&&"text"===Yn.tokens[0].tokens[0].type&&(Yn.tokens[0].tokens[0].text=Yr+" "+Yn.tokens[0].tokens[0].text)):Yn.tokens.unshift({type:"text",text:Yr}):ir+=Yr),ir+=this.parse(Yn.tokens,nr),On+=this.renderer.listitem(ir,va,ji);ke+=this.renderer.list(On,$n,Sn);continue;case"html":ke+=this.renderer.html(mn.text);continue;case"paragraph":ke+=this.renderer.paragraph(this.parseInline(mn.tokens));continue;case"text":for(On=mn.tokens?this.parseInline(mn.tokens):mn.text;ct+1<he&&"text"===ge[ct+1].type;)On+="\n"+((mn=ge[++ct]).tokens?this.parseInline(mn.tokens):mn.text);ke+=ve?this.renderer.paragraph(On):On;continue;default:var re='Token with "'+mn.type+'" type was not found.';if(this.options.silent)return void console.error(re);throw new Error(re)}return ke},at.parseInline=function(ge,ve){ve=ve||this.renderer;var ct,Je,Et,ke="",Tt=ge.length;for(ct=0;ct<Tt;ct++)if(Je=ge[ct],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[Je.type]&&(!1!==(Et=this.options.extensions.renderers[Je.type].call(this,Je))||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(Je.type)))ke+=Et||"";else switch(Je.type){case"escape":ke+=ve.text(Je.text);break;case"html":ke+=ve.html(Je.text);break;case"link":ke+=ve.link(Je.href,Je.title,this.parseInline(Je.tokens,ve));break;case"image":ke+=ve.image(Je.href,Je.title,Je.text);break;case"strong":ke+=ve.strong(this.parseInline(Je.tokens,ve));break;case"em":ke+=ve.em(this.parseInline(Je.tokens,ve));break;case"codespan":ke+=ve.codespan(Je.text);break;case"br":ke+=ve.br();break;case"del":ke+=ve.del(this.parseInline(Je.tokens,ve));break;case"text":ke+=ve.text(Je.text);break;default:var Dt='Token with "'+Je.type+'" type was not found.';if(this.options.silent)return void console.error(Dt);throw new Error(Dt)}return ke},rt}(),pi=Qe,Wr=B,Ls=N,fs=V,ks=ee_merge,qr=ee_checkSanitizeDeprecation,_a=ee_escape,Dl=ht.exports.getDefaults,ya=ht.exports.changeDefaults,bs=ht.exports.defaults;function Jt(rt,at,ut){if(null==rt)throw new Error("marked(): input parameter is undefined or null");if("string"!=typeof rt)throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(rt)+", string expected");if("function"==typeof at&&(ut=at,at=null),at=ks({},Jt.defaults,at||{}),qr(at),ut){var ve,ge=at.highlight;try{ve=Gn.lex(rt,at)}catch(Et){return ut(Et)}var ke=function(Tt){var Dt;if(!Tt)try{at.walkTokens&&Jt.walkTokens(ve,at.walkTokens),Dt=wi.parse(ve,at)}catch(Yt){Tt=Yt}return at.highlight=ge,Tt?ut(Tt):ut(null,Dt)};if(!ge||ge.length<3||(delete at.highlight,!ve.length))return ke();var ct=0;return Jt.walkTokens(ve,function(Et){"code"===Et.type&&(ct++,setTimeout(function(){ge(Et.text,Et.lang,function(Tt,Dt){if(Tt)return ke(Tt);null!=Dt&&Dt!==Et.text&&(Et.text=Dt,Et.escaped=!0),0==--ct&&ke()})},0))}),void(0===ct&&ke())}try{var Je=Gn.lex(rt,at);return at.walkTokens&&Jt.walkTokens(Je,at.walkTokens),wi.parse(Je,at)}catch(Et){if(Et.message+="\nPlease report this to https://github.com/markedjs/marked.",at.silent)return"<p>An error occurred:</p><pre>"+_a(Et.message+"",!0)+"</pre>";throw Et}}return Jt.options=Jt.setOptions=function(rt){return ks(Jt.defaults,rt),ya(Jt.defaults),Jt},Jt.getDefaults=Dl,Jt.defaults=bs,Jt.use=function(){for(var rt=this,at=arguments.length,ut=new Array(at),ge=0;ge<at;ge++)ut[ge]=arguments[ge];var ct,ve=ks.apply(void 0,[{}].concat(ut)),ke=Jt.defaults.extensions||{renderers:{},childTokens:{}};ut.forEach(function(Je){if(Je.extensions&&(ct=!0,Je.extensions.forEach(function(Tt){if(!Tt.name)throw new Error("extension name required");if(Tt.renderer){var Dt=ke.renderers?ke.renderers[Tt.name]:null;ke.renderers[Tt.name]=Dt?function(){for(var Yt=arguments.length,jn=new Array(Yt),ri=0;ri<Yt;ri++)jn[ri]=arguments[ri];var On=Tt.renderer.apply(this,jn);return!1===On&&(On=Dt.apply(this,jn)),On}:Tt.renderer}if(Tt.tokenizer){if(!Tt.level||"block"!==Tt.level&&"inline"!==Tt.level)throw new Error("extension level must be 'block' or 'inline'");ke[Tt.level]?ke[Tt.level].unshift(Tt.tokenizer):ke[Tt.level]=[Tt.tokenizer],Tt.start&&("block"===Tt.level?ke.startBlock?ke.startBlock.push(Tt.start):ke.startBlock=[Tt.start]:"inline"===Tt.level&&(ke.startInline?ke.startInline.push(Tt.start):ke.startInline=[Tt.start]))}Tt.childTokens&&(ke.childTokens[Tt.name]=Tt.childTokens)})),Je.renderer&&function(){var Tt=Jt.defaults.renderer||new Wr,Dt=function(ri){var On=Tt[ri];Tt[ri]=function(){for(var mn=arguments.length,$n=new Array(mn),Sn=0;Sn<mn;Sn++)$n[Sn]=arguments[Sn];var nr=Je.renderer[ri].apply(Tt,$n);return!1===nr&&(nr=On.apply(Tt,$n)),nr}};for(var Yt in Je.renderer)Dt(Yt);ve.renderer=Tt}(),Je.tokenizer&&function(){var Tt=Jt.defaults.tokenizer||new pi,Dt=function(ri){var On=Tt[ri];Tt[ri]=function(){for(var mn=arguments.length,$n=new Array(mn),Sn=0;Sn<mn;Sn++)$n[Sn]=arguments[Sn];var nr=Je.tokenizer[ri].apply(Tt,$n);return!1===nr&&(nr=On.apply(Tt,$n)),nr}};for(var Yt in Je.tokenizer)Dt(Yt);ve.tokenizer=Tt}(),Je.walkTokens){var Et=Jt.defaults.walkTokens;ve.walkTokens=function(Tt){Je.walkTokens.call(rt,Tt),Et&&Et(Tt)}}ct&&(ve.extensions=ke),Jt.setOptions(ve)})},Jt.walkTokens=function(rt,at){for(var ve,ut=function(){var ct=ve.value;switch(at(ct),ct.type){case"table":for(var Et,Je=Mt(ct.tokens.header);!(Et=Je()).done;)Jt.walkTokens(Et.value,at);for(var Yt,Dt=Mt(ct.tokens.cells);!(Yt=Dt()).done;)for(var On,ri=Mt(Yt.value);!(On=ri()).done;)Jt.walkTokens(On.value,at);break;case"list":Jt.walkTokens(ct.items,at);break;default:Jt.defaults.extensions&&Jt.defaults.extensions.childTokens&&Jt.defaults.extensions.childTokens[ct.type]?Jt.defaults.extensions.childTokens[ct.type].forEach(function($n){Jt.walkTokens(ct[$n],at)}):ct.tokens&&Jt.walkTokens(ct.tokens,at)}},ge=Mt(rt);!(ve=ge()).done;)ut()},Jt.parseInline=function(rt,at){if(null==rt)throw new Error("marked.parseInline(): input parameter is undefined or null");if("string"!=typeof rt)throw new Error("marked.parseInline(): input parameter is of type "+Object.prototype.toString.call(rt)+", string expected");at=ks({},Jt.defaults,at||{}),qr(at);try{var ut=Gn.lexInline(rt,at);return at.walkTokens&&Jt.walkTokens(ut,at.walkTokens),wi.parseInline(ut,at)}catch(ge){if(ge.message+="\nPlease report this to https://github.com/markedjs/marked.",at.silent)return"<p>An error occurred:</p><pre>"+_a(ge.message+"",!0)+"</pre>";throw ge}},Jt.Parser=wi,Jt.parser=wi.parse,Jt.Renderer=Wr,Jt.TextRenderer=Ls,Jt.Lexer=Gn,Jt.lexer=Gn.lex,Jt.Tokenizer=pi,Jt.Slugger=fs,Jt.parse=Jt,Jt}()},369:(Vt,it,nt)=>{var mt=nt(284),J=nt(830);function Mt(){this.clear()}Mt.prototype.clear=function(){this.items=[],this.offset=0,this.size=0},Mt.prototype.enqueue=function(ht){return this.items.push(ht),++this.size},Mt.prototype.dequeue=function(){if(this.size){var ht=this.items[this.offset];return 2*++this.offset>=this.items.length&&(this.items=this.items.slice(this.offset),this.offset=0),this.size--,ht}},Mt.prototype.peek=function(){if(this.size)return this.items[this.offset]},Mt.prototype.forEach=function(ht,K){K=arguments.length>1?K:this;for(var Me=this.offset,pe=0,Y=this.items.length;Me<Y;Me++,pe++)ht.call(K,this.items[Me],pe,this)},Mt.prototype.toArray=function(){return this.items.slice(this.offset)},Mt.prototype.values=function(){var ht=this.items,K=this.offset;return new mt(function(){if(K>=ht.length)return{done:!0};var Me=ht[K];return K++,{value:Me,done:!1}})},Mt.prototype.entries=function(){var ht=this.items,K=this.offset,Me=0;return new mt(function(){if(K>=ht.length)return{done:!0};var pe=ht[K];return K++,{value:[Me++,pe],done:!1}})},"undefined"!=typeof Symbol&&(Mt.prototype[Symbol.iterator]=Mt.prototype.values),Mt.prototype.toString=function(){return this.toArray().join(",")},Mt.prototype.toJSON=function(){return this.toArray()},Mt.prototype.inspect=function(){var ht=this.toArray();return Object.defineProperty(ht,"constructor",{value:Mt,enumerable:!1}),ht},"undefined"!=typeof Symbol&&(Mt.prototype[Symbol.for("nodejs.util.inspect.custom")]=Mt.prototype.inspect),Mt.from=function(ht){var K=new Mt;return J(ht,function(Me){K.enqueue(Me)}),K},Mt.of=function(){return Mt.from(arguments)},Vt.exports=Mt},830:Vt=>{var it="undefined"!=typeof ArrayBuffer,nt="undefined"!=typeof Symbol;function mt(J,Mt){var ht,K,Me,pe,Y;if(!J)throw new Error("obliterator/forEach: invalid iterable.");if("function"!=typeof Mt)throw new Error("obliterator/forEach: expecting a callback.");if(Array.isArray(J)||it&&ArrayBuffer.isView(J)||"string"==typeof J||"[object Arguments]"===J.toString())for(Me=0,pe=J.length;Me<pe;Me++)Mt(J[Me],Me);else if("function"!=typeof J.forEach)if(nt&&Symbol.iterator in J&&"function"!=typeof J.next&&(J=J[Symbol.iterator]()),"function"!=typeof J.next)for(K in J)J.hasOwnProperty(K)&&Mt(J[K],K);else for(ht=J,Me=0;!0!==(Y=ht.next()).done;)Mt(Y.value,Me),Me++;else J.forEach(Mt)}mt.forEachWithNullKeys=function(J,Mt){var ht,K,Me,pe,Y;if(!J)throw new Error("obliterator/forEachWithNullKeys: invalid iterable.");if("function"!=typeof Mt)throw new Error("obliterator/forEachWithNullKeys: expecting a callback.");if(Array.isArray(J)||it&&ArrayBuffer.isView(J)||"string"==typeof J||"[object Arguments]"===J.toString())for(Me=0,pe=J.length;Me<pe;Me++)Mt(J[Me],null);else if(J instanceof Set)J.forEach(function(U){Mt(U,null)});else if("function"!=typeof J.forEach)if(nt&&Symbol.iterator in J&&"function"!=typeof J.next&&(J=J[Symbol.iterator]()),"function"!=typeof J.next)for(K in J)J.hasOwnProperty(K)&&Mt(J[K],K);else for(ht=J,Me=0;!0!==(Y=ht.next()).done;)Mt(Y.value,null),Me++;else J.forEach(Mt)},Vt.exports=mt},284:Vt=>{function it(nt){Object.defineProperty(this,"_next",{writable:!1,enumerable:!1,value:nt}),this.done=!1}it.prototype.next=function(){if(this.done)return{done:!0};var nt=this._next();return nt.done&&(this.done=!0),nt},"undefined"!=typeof Symbol&&(it.prototype[Symbol.iterator]=function(){return this}),it.of=function(){var nt=arguments,mt=nt.length,J=0;return new it(function(){return J>=mt?{done:!0}:{done:!1,value:nt[J++]}})},it.empty=function(){var nt=new it(null);return nt.done=!0,nt},it.is=function(nt){return nt instanceof it||"object"==typeof nt&&null!==nt&&"function"==typeof nt.next},Vt.exports=it},310:(Vt,it,nt)=>{"use strict";var mt=nt(948);Object.defineProperty(it,"__esModule",{value:!0}),it.isMobile=function(){return void 0!==J.window.orientation},it.default=function(pe){if(!pe&&!(0,Mt.default)())return"Node";if((0,ht.default)(pe))return"Electron";var Y="undefined"!=typeof navigator?navigator:{},U=pe||Y.userAgent||"";if(U.indexOf("Edge")>-1)return"Edge";var k=-1!==U.indexOf("MSIE "),ie=-1!==U.indexOf("Trident/");return k||ie?"IE":J.window.chrome?"Chrome":J.window.safari?"Safari":J.window.mozInnerScreenX?"Firefox":"Unknown"};var J=nt(151),Mt=mt(nt(602)),ht=mt(nt(344))},151:(Vt,it,nt)=>{"use strict";var mt=nt(948);Object.defineProperty(it,"__esModule",{value:!0}),it.console=it.process=it.document=it.global=it.window=it.self=void 0;var J=mt(nt(321)),Mt={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document,process:"object"===("undefined"==typeof process?"undefined":(0,J.default)(process))&&process};it.self=Mt.self||Mt.window||Mt.global,it.window=Mt.window||Mt.self||Mt.global,it.global=Mt.global||Mt.self||Mt.window,it.document=Mt.document||{},it.process=Mt.process||{};var U=console;it.console=U},761:(Vt,it,nt)=>{"use strict";var J=nt(948),Mt=nt(321);Object.defineProperty(it,"CO",{enumerable:!0,get:function(){return ht.global}}),Object.defineProperty(it,"jU",{enumerable:!0,get:function(){return K.default}}),Object.defineProperty(it,"qs",{enumerable:!0,get:function(){return Me.default}});var ht=nt(151),K=U(nt(602)),Me=U(nt(310));J(nt(344));function Y(k){if("function"!=typeof WeakMap)return null;var ie=new WeakMap,W=new WeakMap;return(Y=function(C){return C?W:ie})(k)}function U(k,ie){if(!ie&&k&&k.__esModule)return k;if(null===k||"object"!==Mt(k)&&"function"!=typeof k)return{default:k};var W=Y(ie);if(W&&W.has(k))return W.get(k);var b={},C=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var P in k)if("default"!==P&&Object.prototype.hasOwnProperty.call(k,P)){var M=C?Object.getOwnPropertyDescriptor(k,P):null;M&&(M.get||M.set)?Object.defineProperty(b,P,M):b[P]=k[P]}return b.default=k,W&&W.set(k,b),b}},602:(Vt,it,nt)=>{"use strict";var mt=nt(948);Object.defineProperty(it,"__esModule",{value:!0}),it.default=ht,it.isBrowserMainThread=function(){return ht()&&"undefined"!=typeof document};var J=mt(nt(321)),Mt=mt(nt(344));function ht(){return!("object"===("undefined"==typeof process?"undefined":(0,J.default)(process))&&"[object process]"===String(process)&&!process.browser)||(0,Mt.default)()}},344:(Vt,it,nt)=>{"use strict";var mt=nt(948);Object.defineProperty(it,"__esModule",{value:!0}),it.default=function(ht){if("undefined"!=typeof window&&"object"===(0,J.default)(window.process)&&"renderer"===window.process.type||"undefined"!=typeof process&&"object"===(0,J.default)(process.versions)&&Boolean(process.versions.electron))return!0;var K="object"===("undefined"==typeof navigator?"undefined":(0,J.default)(navigator))&&"string"==typeof navigator.userAgent&&navigator.userAgent,Me=ht||K;return!!(Me&&Me.indexOf("Electron")>=0)};var J=mt(nt(321))},991:function(Vt,it,nt){"use strict";var mt=this&&this.__createBinding||(Object.create?function(Mt,ht,K,Me){void 0===Me&&(Me=K),Object.defineProperty(Mt,Me,{enumerable:!0,get:function(){return ht[K]}})}:function(Mt,ht,K,Me){void 0===Me&&(Me=K),Mt[Me]=ht[K]}),J=this&&this.__exportStar||function(Mt,ht){for(var K in Mt)"default"!==K&&!Object.prototype.hasOwnProperty.call(ht,K)&&mt(ht,Mt,K)};Object.defineProperty(it,"__esModule",{value:!0}),J(nt(180),it),J(nt(103),it),J(nt(965),it),J(nt(595),it),J(nt(417),it),J(nt(451),it),J(nt(735),it)},180:(Vt,it)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.BlankNode=void 0,it.BlankNode=class{constructor(J){this.termType="BlankNode",this.value=J}equals(J){return!!J&&"BlankNode"===J.termType&&J.value===this.value}}},103:(Vt,it,nt)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.DataFactory=void 0;const mt=nt(180),J=nt(965),Mt=nt(595),ht=nt(417),K=nt(451),Me=nt(735);let pe=0;it.DataFactory=class{constructor(k){this.blankNodeCounter=0,this.blankNodePrefix=(k=k||{}).blankNodePrefix||`df_${pe++}_`}namedNode(k){return new ht.NamedNode(k)}blankNode(k){return new mt.BlankNode(k||`${this.blankNodePrefix}${this.blankNodeCounter++}`)}literal(k,ie){return new Mt.Literal(k,ie)}variable(k){return new Me.Variable(k)}defaultGraph(){return J.DefaultGraph.INSTANCE}quad(k,ie,W,b){return new K.Quad(k,ie,W,b||this.defaultGraph())}fromTerm(k){switch(k.termType){case"NamedNode":return this.namedNode(k.value);case"BlankNode":return this.blankNode(k.value);case"Literal":return k.language?this.literal(k.value,k.language):k.datatype.equals(Mt.Literal.XSD_STRING)?this.literal(k.value):this.literal(k.value,this.fromTerm(k.datatype));case"Variable":return this.variable(k.value);case"DefaultGraph":return this.defaultGraph();case"Quad":return this.quad(this.fromTerm(k.subject),this.fromTerm(k.predicate),this.fromTerm(k.object),this.fromTerm(k.graph))}}fromQuad(k){return this.fromTerm(k)}resetBlankNodeCounter(){this.blankNodeCounter=0}}},965:(Vt,it)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.DefaultGraph=void 0;class nt{constructor(){this.termType="DefaultGraph",this.value=""}equals(J){return!!J&&"DefaultGraph"===J.termType}}it.DefaultGraph=nt,nt.INSTANCE=new nt},595:(Vt,it,nt)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.Literal=void 0;const mt=nt(417);class J{constructor(ht,K){this.termType="Literal",this.value=ht,"string"==typeof K?(this.language=K,this.datatype=J.RDF_LANGUAGE_STRING):K?(this.language="",this.datatype=K):(this.language="",this.datatype=J.XSD_STRING)}equals(ht){return!!ht&&"Literal"===ht.termType&&ht.value===this.value&&ht.language===this.language&&ht.datatype.equals(this.datatype)}}it.Literal=J,J.RDF_LANGUAGE_STRING=new mt.NamedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"),J.XSD_STRING=new mt.NamedNode("http://www.w3.org/2001/XMLSchema#string")},417:(Vt,it)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.NamedNode=void 0,it.NamedNode=class{constructor(J){this.termType="NamedNode",this.value=J}equals(J){return!!J&&"NamedNode"===J.termType&&J.value===this.value}}},451:(Vt,it)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.Quad=void 0,it.Quad=class{constructor(J,Mt,ht,K){this.termType="Quad",this.value="",this.subject=J,this.predicate=Mt,this.object=ht,this.graph=K}equals(J){return!!J&&("Quad"===J.termType||!J.termType)&&this.subject.equals(J.subject)&&this.predicate.equals(J.predicate)&&this.object.equals(J.object)&&this.graph.equals(J.graph)}}},735:(Vt,it)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.Variable=void 0,it.Variable=class{constructor(J){this.termType="Variable",this.value=J}equals(J){return!!J&&"Variable"===J.termType&&J.value===this.value}}},609:function(Vt,it,nt){"use strict";var mt=this&&this.__createBinding||(Object.create?function(b,C,P,M){void 0===M&&(M=P),Object.defineProperty(b,M,{enumerable:!0,get:function(){return C[P]}})}:function(b,C,P,M){void 0===M&&(M=P),b[M]=C[P]}),J=this&&this.__exportStar||function(b,C){for(var P in b)"default"!==P&&!Object.prototype.hasOwnProperty.call(C,P)&&mt(C,b,P)};Object.defineProperty(it,"__esModule",{value:!0}),it.getSupportedJavaScriptPrimitives=it.getSupportedRdfDatatypes=it.getTermRaw=it.toRdf=it.fromRdf=void 0;const Mt=nt(991),ht=nt(938),K=nt(60);J(nt(938),it),J(nt(871),it),J(nt(60),it);const Me=new Mt.DataFactory,pe=new K.Translator;function Y(b,C){return pe.fromRdf(b,C)}pe.registerHandler(new ht.TypeHandlerString,ht.TypeHandlerString.TYPES.map(b=>Me.namedNode(b)),["string"]),pe.registerHandler(new ht.TypeHandlerBoolean,[ht.TypeHandlerBoolean.TYPE].map(b=>Me.namedNode(b)),["boolean"]),pe.registerHandler(new ht.TypeHandlerNumberDouble,ht.TypeHandlerNumberDouble.TYPES.map(b=>Me.namedNode(b)),["number"]),pe.registerHandler(new ht.TypeHandlerNumberInteger,ht.TypeHandlerNumberInteger.TYPES.map(b=>Me.namedNode(b)),["number"]),pe.registerHandler(new ht.TypeHandlerDate,ht.TypeHandlerDate.TYPES.map(b=>Me.namedNode(b)),["object"]),it.fromRdf=Y,it.toRdf=function(b,C){return C&&"namedNode"in C&&(C={dataFactory:C}),(C=C||{})&&!C.dataFactory&&(C.dataFactory=Me),pe.toRdf(b,C)},it.getTermRaw=function(b,C){return"Literal"===b.termType?Y(b,C):b.value},it.getSupportedRdfDatatypes=function(){return pe.getSupportedRdfDatatypes()},it.getSupportedJavaScriptPrimitives=function(){return pe.getSupportedJavaScriptPrimitives()}},871:(Vt,it)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0})},60:(Vt,it)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.Translator=void 0,it.Translator=class{constructor(){this.supportedRdfDatatypes=[],this.fromRdfHandlers={},this.toRdfHandlers={}}static incorrectRdfDataType(J){throw new Error(`Invalid RDF ${J.datatype.value} value: '${J.value}'`)}registerHandler(J,Mt,ht){for(const K of Mt)this.supportedRdfDatatypes.push(K),this.fromRdfHandlers[K.value]=J;for(const K of ht){let Me=this.toRdfHandlers[K];Me||(this.toRdfHandlers[K]=Me=[]),Me.push(J)}}fromRdf(J,Mt){const ht=this.fromRdfHandlers[J.datatype.value];return ht?ht.fromRdf(J,Mt):J.value}toRdf(J,Mt){const ht=this.toRdfHandlers[typeof J];if(ht)for(const K of ht){const Me=K.toRdf(J,Mt);if(Me)return Me}throw new Error(`Invalid JavaScript value: '${J}'`)}getSupportedRdfDatatypes(){return this.supportedRdfDatatypes}getSupportedJavaScriptPrimitives(){return Object.keys(this.toRdfHandlers)}}},727:(Vt,it,nt)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.TypeHandlerBoolean=void 0;const mt=nt(60);class J{fromRdf(ht,K){switch(ht.value){case"true":return!0;case"false":return!1;case"1":return!0;case"0":return!1}return K&&mt.Translator.incorrectRdfDataType(ht),!1}toRdf(ht,{datatype:K,dataFactory:Me}){return Me.literal(ht?"true":"false",K||Me.namedNode(J.TYPE))}}it.TypeHandlerBoolean=J,J.TYPE="http://www.w3.org/2001/XMLSchema#boolean"},748:(Vt,it,nt)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.TypeHandlerDate=void 0;const mt=nt(60);class J{fromRdf(ht,K){switch(K&&!ht.value.match(J.VALIDATORS[ht.datatype.value.substr(33,ht.datatype.value.length)])&&mt.Translator.incorrectRdfDataType(ht),ht.datatype.value){case"http://www.w3.org/2001/XMLSchema#gDay":return new Date(0,0,parseInt(ht.value,10));case"http://www.w3.org/2001/XMLSchema#gMonthDay":const Me=ht.value.split("-");return new Date(0,parseInt(Me[0],10)-1,parseInt(Me[1],10));case"http://www.w3.org/2001/XMLSchema#gYear":return new Date(ht.value+"-01-01");case"http://www.w3.org/2001/XMLSchema#gYearMonth":return new Date(ht.value+"-01");default:return new Date(ht.value)}}toRdf(ht,{datatype:K,dataFactory:Me}){if(K=K||Me.namedNode(J.TYPES[0]),!(ht instanceof Date))return null;const pe=ht;let Y;switch(K.value){case"http://www.w3.org/2001/XMLSchema#gDay":Y=String(pe.getUTCDate());break;case"http://www.w3.org/2001/XMLSchema#gMonthDay":Y=pe.getUTCMonth()+1+"-"+pe.getUTCDate();break;case"http://www.w3.org/2001/XMLSchema#gYear":Y=String(pe.getUTCFullYear());break;case"http://www.w3.org/2001/XMLSchema#gYearMonth":Y=pe.getUTCFullYear()+"-"+(pe.getUTCMonth()+1);break;case"http://www.w3.org/2001/XMLSchema#date":Y=pe.toISOString().replace(/T.*$/,"");break;default:Y=pe.toISOString()}return Me.literal(Y,K)}}it.TypeHandlerDate=J,J.TYPES=["http://www.w3.org/2001/XMLSchema#dateTime","http://www.w3.org/2001/XMLSchema#date","http://www.w3.org/2001/XMLSchema#gDay","http://www.w3.org/2001/XMLSchema#gMonthDay","http://www.w3.org/2001/XMLSchema#gYear","http://www.w3.org/2001/XMLSchema#gYearMonth"],J.VALIDATORS={date:/^[0-9]+-[0-9][0-9]-[0-9][0-9]Z?$/,dateTime:/^[0-9]+-[0-9][0-9]-[0-9][0-9]T[0-9][0-9]:[0-9][0-9]:[0-9][0-9](\.[0-9][0-9][0-9])?((Z?)|([\+-][0-9][0-9]:[0-9][0-9]))$/,gDay:/^[0-9]+$/,gMonthDay:/^[0-9]+-[0-9][0-9]$/,gYear:/^[0-9]+$/,gYearMonth:/^[0-9]+-[0-9][0-9]$/}},554:(Vt,it,nt)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.TypeHandlerNumberDouble=void 0;const mt=nt(60);class J{fromRdf(ht,K){const Me=parseFloat(ht.value);return K&&isNaN(Me)&&mt.Translator.incorrectRdfDataType(ht),Me}toRdf(ht,{datatype:K,dataFactory:Me}){return K=K||Me.namedNode(J.TYPES[0]),isNaN(ht)?Me.literal("NaN",K):isFinite(ht)?ht%1==0?null:Me.literal(ht.toExponential(15).replace(/(\d)0*e\+?/,"$1E"),K):Me.literal(ht>0?"INF":"-INF",K)}}it.TypeHandlerNumberDouble=J,J.TYPES=["http://www.w3.org/2001/XMLSchema#double","http://www.w3.org/2001/XMLSchema#decimal","http://www.w3.org/2001/XMLSchema#float"]},750:(Vt,it,nt)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.TypeHandlerNumberInteger=void 0;const mt=nt(60);class J{fromRdf(ht,K){const Me=parseInt(ht.value,10);return K&&(isNaN(Me)||ht.value.indexOf(".")>=0)&&mt.Translator.incorrectRdfDataType(ht),Me}toRdf(ht,{datatype:K,dataFactory:Me}){return Me.literal(String(ht),K||Me.namedNode(ht<=J.MAX_INT&&ht>=J.MIN_INT?J.TYPES[0]:J.TYPES[1]))}}it.TypeHandlerNumberInteger=J,J.TYPES=["http://www.w3.org/2001/XMLSchema#integer","http://www.w3.org/2001/XMLSchema#long","http://www.w3.org/2001/XMLSchema#int","http://www.w3.org/2001/XMLSchema#byte","http://www.w3.org/2001/XMLSchema#short","http://www.w3.org/2001/XMLSchema#negativeInteger","http://www.w3.org/2001/XMLSchema#nonNegativeInteger","http://www.w3.org/2001/XMLSchema#nonPositiveInteger","http://www.w3.org/2001/XMLSchema#positiveInteger","http://www.w3.org/2001/XMLSchema#unsignedByte","http://www.w3.org/2001/XMLSchema#unsignedInt","http://www.w3.org/2001/XMLSchema#unsignedLong","http://www.w3.org/2001/XMLSchema#unsignedShort"],J.MAX_INT=2147483647,J.MIN_INT=-2147483648},608:(Vt,it)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.TypeHandlerString=void 0;class nt{fromRdf(J){return J.value}toRdf(J,{datatype:Mt,dataFactory:ht}){return ht.literal(J,Mt)}}it.TypeHandlerString=nt,nt.TYPES=["http://www.w3.org/2001/XMLSchema#string","http://www.w3.org/2001/XMLSchema#normalizedString","http://www.w3.org/2001/XMLSchema#anyURI","http://www.w3.org/2001/XMLSchema#base64Binary","http://www.w3.org/2001/XMLSchema#language","http://www.w3.org/2001/XMLSchema#Name","http://www.w3.org/2001/XMLSchema#NCName","http://www.w3.org/2001/XMLSchema#NMTOKEN","http://www.w3.org/2001/XMLSchema#token","http://www.w3.org/2001/XMLSchema#hexBinary","http://www.w3.org/1999/02/22-rdf-syntax-ns#langString","http://www.w3.org/2001/XMLSchema#time","http://www.w3.org/2001/XMLSchema#duration"]},938:function(Vt,it,nt){"use strict";var mt=this&&this.__createBinding||(Object.create?function(Mt,ht,K,Me){void 0===Me&&(Me=K),Object.defineProperty(Mt,Me,{enumerable:!0,get:function(){return ht[K]}})}:function(Mt,ht,K,Me){void 0===Me&&(Me=K),Mt[Me]=ht[K]}),J=this&&this.__exportStar||function(Mt,ht){for(var K in Mt)"default"!==K&&!Object.prototype.hasOwnProperty.call(ht,K)&&mt(ht,Mt,K)};Object.defineProperty(it,"__esModule",{value:!0}),J(nt(727),it),J(nt(748),it),J(nt(554),it),J(nt(750),it),J(nt(608),it)},525:(Vt,it,nt)=>{"use strict";var mt={};nt.r(mt),nt.d(mt,{decode:()=>Dpe,encode:()=>Ipe});var J={};nt.r(J),nt.d(J,{decode:()=>Fpe,encode:()=>Lpe});var Mt={};nt.r(Mt),nt.d(Mt,{decode:()=>kpe,encode:()=>Bpe});var ht={};function K(n){return"function"==typeof n}nt.r(ht),nt.d(ht,{decode:()=>Vpe,encode:()=>jpe});let Me=!1;const pe={Promise:void 0,set useDeprecatedSynchronousErrorHandling(n){if(n){const e=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+e.stack)}else Me&&console.log("RxJS: Back to a better error behavior. Thank you. <3");Me=n},get useDeprecatedSynchronousErrorHandling(){return Me}};function Y(n){setTimeout(()=>{throw n},0)}const U={closed:!0,next(n){},error(n){if(pe.useDeprecatedSynchronousErrorHandling)throw n;Y(n)},complete(){}},k=Array.isArray||(n=>n&&"number"==typeof n.length);function ie(n){return null!==n&&"object"==typeof n}const b=(()=>{function n(e){return Error.call(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((t,i)=>`${i+1}) ${t.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e,this}return n.prototype=Object.create(Error.prototype),n})();class C{constructor(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._ctorUnsubscribe=!0,this._unsubscribe=e)}unsubscribe(){let e;if(this.closed)return;let{_parentOrParents:t,_ctorUnsubscribe:i,_unsubscribe:r,_subscriptions:s}=this;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,t instanceof C)t.remove(this);else if(null!==t)for(let o=0;o<t.length;++o)t[o].remove(this);if(K(r)){i&&(this._unsubscribe=void 0);try{r.call(this)}catch(o){e=o instanceof b?P(o.errors):[o]}}if(k(s)){let o=-1,a=s.length;for(;++o<a;){const l=s[o];if(ie(l))try{l.unsubscribe()}catch(c){e=e||[],c instanceof b?e=e.concat(P(c.errors)):e.push(c)}}}if(e)throw new b(e)}add(e){let t=e;if(!e)return C.EMPTY;switch(typeof e){case"function":t=new C(e);case"object":if(t===this||t.closed||"function"!=typeof t.unsubscribe)return t;if(this.closed)return t.unsubscribe(),t;if(!(t instanceof C)){const s=t;t=new C,t._subscriptions=[s]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}let{_parentOrParents:i}=t;if(null===i)t._parentOrParents=this;else if(i instanceof C){if(i===this)return t;t._parentOrParents=[i,this]}else{if(-1!==i.indexOf(this))return t;i.push(this)}const r=this._subscriptions;return null===r?this._subscriptions=[t]:r.push(t),t}remove(e){const t=this._subscriptions;if(t){const i=t.indexOf(e);-1!==i&&t.splice(i,1)}}}var n;function P(n){return n.reduce((e,t)=>e.concat(t instanceof b?t.errors:t),[])}C.EMPTY=((n=new C).closed=!0,n);const M="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random();class y extends C{constructor(e,t,i){switch(super(),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=U;break;case 1:if(!e){this.destination=U;break}if("object"==typeof e){e instanceof y?(this.syncErrorThrowable=e.syncErrorThrowable,this.destination=e,e.add(this)):(this.syncErrorThrowable=!0,this.destination=new S(this,e));break}default:this.syncErrorThrowable=!0,this.destination=new S(this,e,t,i)}}[M](){return this}static create(e,t,i){const r=new y(e,t,i);return r.syncErrorThrowable=!1,r}next(e){this.isStopped||this._next(e)}error(e){this.isStopped||(this.isStopped=!0,this._error(e))}complete(){this.isStopped||(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe())}_next(e){this.destination.next(e)}_error(e){this.destination.error(e),this.unsubscribe()}_complete(){this.destination.complete(),this.unsubscribe()}_unsubscribeAndRecycle(){const{_parentOrParents:e}=this;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this}}class S extends y{constructor(e,t,i,r){super(),this._parentSubscriber=e;let s,o=this;K(t)?s=t:t&&(s=t.next,i=t.error,r=t.complete,t!==U&&(o=Object.create(t),K(o.unsubscribe)&&this.add(o.unsubscribe.bind(o)),o.unsubscribe=this.unsubscribe.bind(this))),this._context=o,this._next=s,this._error=i,this._complete=r}next(e){if(!this.isStopped&&this._next){const{_parentSubscriber:t}=this;pe.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}}error(e){if(!this.isStopped){const{_parentSubscriber:t}=this,{useDeprecatedSynchronousErrorHandling:i}=pe;if(this._error)i&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)i?(t.syncErrorValue=e,t.syncErrorThrown=!0):Y(e),this.unsubscribe();else{if(this.unsubscribe(),i)throw e;Y(e)}}}complete(){if(!this.isStopped){const{_parentSubscriber:e}=this;if(this._complete){const t=()=>this._complete.call(this._context);pe.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,t),this.unsubscribe()):(this.__tryOrUnsub(t),this.unsubscribe())}else this.unsubscribe()}}__tryOrUnsub(e,t){try{e.call(this._context,t)}catch(i){if(this.unsubscribe(),pe.useDeprecatedSynchronousErrorHandling)throw i;Y(i)}}__tryOrSetError(e,t,i){if(!pe.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,i)}catch(r){return pe.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=r,e.syncErrorThrown=!0,!0):(Y(r),!0)}return!1}_unsubscribe(){const{_parentSubscriber:e}=this;this._context=null,this._parentSubscriber=null,e.unsubscribe()}}const R="function"==typeof Symbol&&Symbol.observable||"@@observable";function q(n){return n}let O=(()=>{class n{constructor(t){this._isScalar=!1,t&&(this._subscribe=t)}lift(t){const i=new n;return i.source=this,i.operator=t,i}subscribe(t,i,r){const{operator:s}=this,o=function(n,e,t){if(n){if(n instanceof y)return n;if(n[M])return n[M]()}return n||e||t?new y(n,e,t):new y(U)}(t,i,r);if(o.add(s?s.call(o,this.source):this.source||pe.useDeprecatedSynchronousErrorHandling&&!o.syncErrorThrowable?this._subscribe(o):this._trySubscribe(o)),pe.useDeprecatedSynchronousErrorHandling&&o.syncErrorThrowable&&(o.syncErrorThrowable=!1,o.syncErrorThrown))throw o.syncErrorValue;return o}_trySubscribe(t){try{return this._subscribe(t)}catch(i){pe.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=i),function(n){for(;n;){const{closed:e,destination:t,isStopped:i}=n;if(e||i)return!1;n=t&&t instanceof y?t:null}return!0}(t)?t.error(i):console.warn(i)}}forEach(t,i){return new(i=X(i))((r,s)=>{let o;o=this.subscribe(a=>{try{t(a)}catch(l){s(l),o&&o.unsubscribe()}},s,r)})}_subscribe(t){const{source:i}=this;return i&&i.subscribe(t)}[R](){return this}pipe(...t){return 0===t.length?this:function(n){return 0===n.length?q:1===n.length?n[0]:function(t){return n.reduce((i,r)=>r(i),t)}}(t)(this)}toPromise(t){return new(t=X(t))((i,r)=>{let s;this.subscribe(o=>s=o,o=>r(o),()=>i(s))})}}return n.create=e=>new n(e),n})();function X(n){if(n||(n=pe.Promise||Promise),!n)throw new Error("no Promise impl found");return n}const G=(()=>{function n(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return n.prototype=Object.create(Error.prototype),n})();class Q extends C{constructor(e,t){super(),this.subject=e,this.subscriber=t,this.closed=!1}unsubscribe(){if(this.closed)return;this.closed=!0;const e=this.subject,t=e.observers;if(this.subject=null,!t||0===t.length||e.isStopped||e.closed)return;const i=t.indexOf(this.subscriber);-1!==i&&t.splice(i,1)}}class ae extends y{constructor(e){super(e),this.destination=e}}let se=(()=>{class n extends O{constructor(){super(),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}[M](){return new ae(this)}lift(t){const i=new ee(this,this);return i.operator=t,i}next(t){if(this.closed)throw new G;if(!this.isStopped){const{observers:i}=this,r=i.length,s=i.slice();for(let o=0;o<r;o++)s[o].next(t)}}error(t){if(this.closed)throw new G;this.hasError=!0,this.thrownError=t,this.isStopped=!0;const{observers:i}=this,r=i.length,s=i.slice();for(let o=0;o<r;o++)s[o].error(t);this.observers.length=0}complete(){if(this.closed)throw new G;this.isStopped=!0;const{observers:t}=this,i=t.length,r=t.slice();for(let s=0;s<i;s++)r[s].complete();this.observers.length=0}unsubscribe(){this.isStopped=!0,this.closed=!0,this.observers=null}_trySubscribe(t){if(this.closed)throw new G;return super._trySubscribe(t)}_subscribe(t){if(this.closed)throw new G;return this.hasError?(t.error(this.thrownError),C.EMPTY):this.isStopped?(t.complete(),C.EMPTY):(this.observers.push(t),new Q(this,t))}asObservable(){const t=new O;return t.source=this,t}}return n.create=(e,t)=>new ee(e,t),n})();class ee extends se{constructor(e,t){super(),this.destination=e,this.source=t}next(e){const{destination:t}=this;t&&t.next&&t.next(e)}error(e){const{destination:t}=this;t&&t.error&&this.destination.error(e)}complete(){const{destination:e}=this;e&&e.complete&&this.destination.complete()}_subscribe(e){const{source:t}=this;return t?this.source.subscribe(e):C.EMPTY}}function xe(n){return n&&"function"==typeof n.schedule}function me(n,e){return function(i){if("function"!=typeof n)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return i.lift(new te(n,e))}}class te{constructor(e,t){this.project=e,this.thisArg=t}call(e,t){return t.subscribe(new _e(e,this.project,this.thisArg))}}class _e extends y{constructor(e,t,i){super(e),this.project=t,this.count=0,this.thisArg=i||this}_next(e){let t;try{t=this.project.call(this.thisArg,e,this.count++)}catch(i){return void this.destination.error(i)}this.destination.next(t)}}const Oe=n=>e=>{for(let t=0,i=n.length;t<i&&!e.closed;t++)e.next(n[t]);e.complete()},Qe="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator",Le=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function Xe(n){return!!n&&"function"!=typeof n.subscribe&&"function"==typeof n.then}const Te=n=>{if(n&&"function"==typeof n[R])return(n=>e=>{const t=n[R]();if("function"!=typeof t.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return t.subscribe(e)})(n);if(Le(n))return Oe(n);if(Xe(n))return(n=>e=>(n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,Y),e))(n);if(n&&"function"==typeof n[Qe])return(n=>e=>{const t=n[Qe]();for(;;){let i;try{i=t.next()}catch(r){return e.error(r),e}if(i.done){e.complete();break}if(e.next(i.value),e.closed)break}return"function"==typeof t.return&&e.add(()=>{t.return&&t.return()}),e})(n);{const t=`You provided ${ie(n)?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.`;throw new TypeError(t)}};function Ne(n,e){return new O(t=>{const i=new C;let r=0;return i.add(e.schedule(function(){r!==n.length?(t.next(n[r++]),t.closed||i.add(this.schedule())):t.complete()})),i})}function Ve(n,e){return e?function(n,e){if(null!=n){if(function(n){return n&&"function"==typeof n[R]}(n))return function(n,e){return new O(t=>{const i=new C;return i.add(e.schedule(()=>{const r=n[R]();i.add(r.subscribe({next(s){i.add(e.schedule(()=>t.next(s)))},error(s){i.add(e.schedule(()=>t.error(s)))},complete(){i.add(e.schedule(()=>t.complete()))}}))})),i})}(n,e);if(Xe(n))return function(n,e){return new O(t=>{const i=new C;return i.add(e.schedule(()=>n.then(r=>{i.add(e.schedule(()=>{t.next(r),i.add(e.schedule(()=>t.complete()))}))},r=>{i.add(e.schedule(()=>t.error(r)))}))),i})}(n,e);if(Le(n))return Ne(n,e);if(function(n){return n&&"function"==typeof n[Qe]}(n)||"string"==typeof n)return function(n,e){if(!n)throw new Error("Iterable cannot be null");return new O(t=>{const i=new C;let r;return i.add(()=>{r&&"function"==typeof r.return&&r.return()}),i.add(e.schedule(()=>{r=n[Qe](),i.add(e.schedule(function(){if(t.closed)return;let s,o;try{const a=r.next();s=a.value,o=a.done}catch(a){return void t.error(a)}o?t.complete():(t.next(s),this.schedule())}))})),i})}(n,e)}throw new TypeError((null!==n&&typeof n||n)+" is not observable")}(n,e):n instanceof O?n:new O(Te(n))}class gt extends y{constructor(e){super(),this.parent=e}_next(e){this.parent.notifyNext(e)}_error(e){this.parent.notifyError(e),this.unsubscribe()}_complete(){this.parent.notifyComplete(),this.unsubscribe()}}class be extends y{notifyNext(e){this.destination.next(e)}notifyError(e){this.destination.error(e)}notifyComplete(){this.destination.complete()}}function N(n,e){if(e.closed)return;if(n instanceof O)return n.subscribe(e);let t;try{t=Te(n)(e)}catch(i){e.error(i)}return t}function V(n,e,t=Number.POSITIVE_INFINITY){return"function"==typeof e?i=>i.pipe(V((r,s)=>Ve(n(r,s)).pipe(me((o,a)=>e(r,o,s,a))),t)):("number"==typeof e&&(t=e),i=>i.lift(new Re(n,t)))}class Re{constructor(e,t=Number.POSITIVE_INFINITY){this.project=e,this.concurrent=t}call(e,t){return t.subscribe(new Ze(e,this.project,this.concurrent))}}class Ze extends be{constructor(e,t,i=Number.POSITIVE_INFINITY){super(e),this.project=t,this.concurrent=i,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}_next(e){this.active<this.concurrent?this._tryNext(e):this.buffer.push(e)}_tryNext(e){let t;const i=this.index++;try{t=this.project(e,i)}catch(r){return void this.destination.error(r)}this.active++,this._innerSub(t)}_innerSub(e){const t=new gt(this),i=this.destination;i.add(t);const r=N(e,t);r!==t&&i.add(r)}_complete(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}notifyNext(e){this.destination.next(e)}notifyComplete(){const e=this.buffer;this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}function Rt(n=Number.POSITIVE_INFINITY){return V(q,n)}function Mn(n,e){return e?Ne(n,e):new O(Oe(n))}function Nn(...n){let e=Number.POSITIVE_INFINITY,t=null,i=n[n.length-1];return xe(i)?(t=n.pop(),n.length>1&&"number"==typeof n[n.length-1]&&(e=n.pop())):"number"==typeof i&&(e=n.pop()),null===t&&1===n.length&&n[0]instanceof O?n[0]:Rt(e)(Mn(n,t))}function Gn(){return function(e){return e.lift(new wi(e))}}class wi{constructor(e){this.connectable=e}call(e,t){const{connectable:i}=this;i._refCount++;const r=new pi(e,i),s=t.subscribe(r);return r.closed||(r.connection=i.connect()),s}}class pi extends y{constructor(e,t){super(e),this.connectable=t}_unsubscribe(){const{connectable:e}=this;if(!e)return void(this.connection=null);this.connectable=null;const t=e._refCount;if(t<=0)return void(this.connection=null);if(e._refCount=t-1,t>1)return void(this.connection=null);const{connection:i}=this,r=e._connection;this.connection=null,r&&(!i||r===i)&&r.unsubscribe()}}class Wr extends O{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._refCount=0,this._isComplete=!1}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}connect(){let e=this._connection;return e||(this._isComplete=!1,e=this._connection=new C,e.add(this.source.subscribe(new fs(this.getSubject(),this))),e.closed&&(this._connection=null,e=C.EMPTY)),e}refCount(){return Gn()(this)}}const Ls=(()=>{const n=Wr.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:n._subscribe},_isComplete:{value:n._isComplete,writable:!0},getSubject:{value:n.getSubject},connect:{value:n.connect},refCount:{value:n.refCount}}})();class fs extends ae{constructor(e,t){super(e),this.connectable=t}_error(e){this._unsubscribe(),super._error(e)}_complete(){this.connectable._isComplete=!0,this._unsubscribe(),super._complete()}_unsubscribe(){const e=this.connectable;if(e){this.connectable=null;const t=e._connection;e._refCount=0,e._subject=null,e._connection=null,t&&t.unsubscribe()}}}function _a(n,e){return function(i){let r;if(r="function"==typeof n?n:function(){return n},"function"==typeof e)return i.lift(new Dl(r,e));const s=Object.create(i,Ls);return s.source=i,s.subjectFactory=r,s}}class Dl{constructor(e,t){this.subjectFactory=e,this.selector=t}call(e,t){const{selector:i}=this,r=this.subjectFactory(),s=i(r).subscribe(e);return s.add(t.subscribe(r)),s}}function ya(){return new se}function bs(){return n=>Gn()(_a(ya)(n))}function Jt(n){for(let e in n)if(n[e]===Jt)return e;throw Error("Could not find renamed property on target object.")}function Xa(n,e){for(const t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function rt(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(rt).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const e=n.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function at(n,e){return null==n||""===n?null===e?"":e:null==e||""===e?n:n+" "+e}const ut=Jt({__forward_ref__:Jt});function ge(n){return n.__forward_ref__=ge,n.toString=function(){return rt(this())},n}function ve(n){return ke(n)?n():n}function ke(n){return"function"==typeof n&&n.hasOwnProperty(ut)&&n.__forward_ref__===ge}class Je extends Error{constructor(e,t){super(function(n,e){return`${n?`NG0${n}: `:""}${e}`}(e,t)),this.code=e}}function Dt(n){return"string"==typeof n?n:null==n?"":String(n)}function Yt(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():Dt(n)}function mn(n,e){const t=e?` in ${e}`:"";throw new Je("201",`No provider for ${Yt(n)} found${t}`)}function Z(n,e){null==n&&function(n,e,t,i){throw new Error(`ASSERTION ERROR: ${n}`+(null==i?"":` [Expected=> ${t} ${i} ${e} <=Actual]`))}(e,n,null,"!=")}function We(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function wt(n){return{providers:n.providers||[],imports:n.imports||[]}}function _n(n){return ws(n,ho)||ws(n,Bs)}function ws(n,e){return n.hasOwnProperty(e)?n[e]:null}function Il(n){return n&&(n.hasOwnProperty(kr)||n.hasOwnProperty(wc))?n[kr]:null}const ho=Jt({\u0275prov:Jt}),kr=Jt({\u0275inj:Jt}),Bs=Jt({ngInjectableDef:Jt}),wc=Jt({ngInjectorDef:Jt});var wn=(()=>((wn=wn||{})[wn.Default=0]="Default",wn[wn.Host=1]="Host",wn[wn.Self=2]="Self",wn[wn.SkipSelf=4]="SkipSelf",wn[wn.Optional=8]="Optional",wn))();let fo;function ba(n){const e=fo;return fo=n,e}function yd(n,e,t){const i=_n(n);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:t&wn.Optional?null:void 0!==e?e:void mn(rt(n),"Injector")}function Ae(n){return{toString:n}.toString()}var Ge=(()=>((Ge=Ge||{})[Ge.OnPush=0]="OnPush",Ge[Ge.Default=1]="Default",Ge))(),$t=(()=>(($t=$t||{})[$t.Emulated=0]="Emulated",$t[$t.None=2]="None",$t[$t.ShadowDom=3]="ShadowDom",$t))();const si="undefined"!=typeof globalThis&&globalThis,Br="undefined"!=typeof window&&window,Xr="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,Es="undefined"!=typeof global&&global,ni=si||Es||Br||Xr,vd={},Ji=[],op=Jt({\u0275cmp:Jt}),Gm=Jt({\u0275dir:Jt}),Ah=Jt({\u0275pipe:Jt}),Uv=Jt({\u0275mod:Jt}),s1=Jt({\u0275loc:Jt}),Rl=Jt({\u0275fac:Jt}),Mh=Jt({__NG_ELEMENT_ID__:Jt});let o1=0;function yn(n){return Ae(()=>{const t={},i={type:n.type,providersResolver:null,decls:n.decls,vars:n.vars,factory:null,template:n.template||null,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:t,inputs:null,outputs:null,exportAs:n.exportAs||null,onPush:n.changeDetection===Ge.OnPush,directiveDefs:null,pipeDefs:null,selectors:n.selectors||Ji,viewQuery:n.viewQuery||null,features:n.features||null,data:n.data||{},encapsulation:n.encapsulation||$t.Emulated,id:"c",styles:n.styles||Ji,_:null,setInput:null,schemas:n.schemas||null,tView:null},r=n.directives,s=n.features,o=n.pipes;return i.id+=o1++,i.inputs=$v(n.inputs,t),i.outputs=$v(n.outputs),s&&s.forEach(a=>a(i)),i.directiveDefs=r?()=>("function"==typeof r?r():r).map(zv):null,i.pipeDefs=o?()=>("function"==typeof o?o():o).map(Hv):null,i})}function zv(n){return Fi(n)||function(n){return n[Gm]||null}(n)}function Hv(n){return function(n){return n[Ah]||null}(n)}const Gv={};function ln(n){return Ae(()=>{const e={type:n.type,bootstrap:n.bootstrap||Ji,declarations:n.declarations||Ji,imports:n.imports||Ji,exports:n.exports||Ji,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null};return null!=n.id&&(Gv[n.id]=n.type),e})}function $v(n,e){if(null==n)return vd;const t={};for(const i in n)if(n.hasOwnProperty(i)){let r=n[i],s=r;Array.isArray(r)&&(s=r[1],r=r[0]),t[r]=i,e&&(e[r]=s)}return t}const kt=yn;function Vs(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,onDestroy:n.type.prototype.ngOnDestroy||null}}function Fi(n){return n[op]||null}function Mo(n,e){const t=n[Uv]||null;if(!t&&!0===e)throw new Error(`Type ${rt(n)} does not have '\u0275mod' property.`);return t}function Wo(n){return Array.isArray(n)&&"object"==typeof n[1]}function qo(n){return Array.isArray(n)&&!0===n[1]}function qm(n){return 0!=(8&n.flags)}function Sd(n){return 2==(2&n.flags)}function xd(n){return 1==(1&n.flags)}function Sa(n){return null!==n.template}function Wv(n){return 0!=(512&n[2])}function xc(n,e){return n.hasOwnProperty(Rl)?n[Rl]:null}class Qm{constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}}function zi(){return Kv}function Kv(n){return n.type.prototype.ngOnChanges&&(n.setInput=p1),f1}function f1(){const n=ot(this),e=null==n?void 0:n.current;if(e){const t=n.previous;if(t===vd)n.previous=e;else for(let i in e)t[i]=e[i];n.current=null,this.ngOnChanges(e)}}function p1(n,e,t,i){const r=ot(n)||function(n,e){return n[Ph]=e}(n,{previous:vd,current:null}),s=r.current||(r.current={}),o=r.previous,a=this.declaredInputs[t],l=o[a];s[a]=new Qm(l&&l.currentValue,e,o===vd),n[i]=e}zi.ngInherit=!0;const Ph="__ngSimpleChanges__";function ot(n){return n[Ph]||null}let Hi;function lr(n){return!!n.listen}const vu={createRenderer:(n,e)=>void 0!==Hi?Hi:"undefined"!=typeof document?document:void 0};function vr(n){for(;Array.isArray(n);)n=n[0];return n}function Fh(n,e){return vr(e[n])}function Zs(n,e){return vr(e[n.index])}function e_(n,e){return n.data[e]}function Cd(n,e){return n[e]}function Us(n,e){const t=e[n];return Wo(t)?t:t[0]}function Fl(n){return 4==(4&n[2])}function Td(n){return 128==(128&n[2])}function Ca(n,e){return null==e?null:n[e]}function t_(n){n[18]=0}function cp(n,e){n[5]+=e;let t=n,i=n[3];for(;null!==i&&(1===e&&1===t[5]||-1===e&&0===t[5]);)i[5]+=e,t=i,i=i[3]}const Ln={lFrame:wu(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function Qv(){return Ln.bindingsEnabled}function Bt(){return Ln.lFrame.lView}function gi(){return Ln.lFrame.tView}function Ir(n){return Ln.lFrame.contextLView=n,n[8]}function ss(){let n=n_();for(;null!==n&&64===n.type;)n=n.parent;return n}function n_(){return Ln.lFrame.currentTNode}function Ja(n,e){const t=Ln.lFrame;t.currentTNode=n,t.isParent=e}function Ur(){return Ln.lFrame.isParent}function ps(){Ln.lFrame.isParent=!1}function Bh(){return Ln.isInCheckNoChangesMode}function dp(n){Ln.isInCheckNoChangesMode=n}function xs(){const n=Ln.lFrame;let e=n.bindingRootIndex;return-1===e&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function Ta(){return Ln.lFrame.bindingIndex++}function Io(n){const e=Ln.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function Ad(n,e){const t=Ln.lFrame;t.bindingIndex=t.bindingRootIndex=n,i_(e)}function i_(n){Ln.lFrame.currentDirectiveIndex=n}function Zv(){return Ln.lFrame.currentQueryIndex}function s_(n){Ln.lFrame.currentQueryIndex=n}function fp(n){const e=n[1];return 2===e.type?e.declTNode:1===e.type?n[6]:null}function Md(n,e,t){if(t&wn.SkipSelf){let r=e,s=n;for(;!(r=r.parent,null!==r||t&wn.Host||(r=fp(s),null===r||(s=s[15],10&r.type))););if(null===r)return!1;e=r,n=s}const i=Ln.lFrame=Ee();return i.currentTNode=e,i.lView=n,!0}function Uh(n){const e=Ee(),t=n[1];Ln.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function Ee(){const n=Ln.lFrame,e=null===n?null:n.child;return null===e?wu(n):e}function wu(n){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=e),e}function zh(){const n=Ln.lFrame;return Ln.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const Oo=zh;function li(){const n=zh();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function Js(){return Ln.lFrame.selectedIndex}function mo(n){Ln.lFrame.selectedIndex=n}function Or(){const n=Ln.lFrame;return e_(n.tView,n.selectedIndex)}function pp(n,e){for(let t=e.directiveStart,i=e.directiveEnd;t<i;t++){const s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:u}=s;o&&(n.contentHooks||(n.contentHooks=[])).push(-t,o),a&&((n.contentHooks||(n.contentHooks=[])).push(t,a),(n.contentCheckHooks||(n.contentCheckHooks=[])).push(t,a)),l&&(n.viewHooks||(n.viewHooks=[])).push(-t,l),c&&((n.viewHooks||(n.viewHooks=[])).push(t,c),(n.viewCheckHooks||(n.viewCheckHooks=[])).push(t,c)),null!=u&&(n.destroyHooks||(n.destroyHooks=[])).push(t,u)}}function gp(n,e,t){el(n,e,3,t)}function mp(n,e,t,i){(3&n[2])===t&&el(n,e,t,i)}function o_(n,e){let t=n[2];(3&t)===e&&(t&=2047,t+=1,n[2]=t)}function el(n,e,t,i){const s=null!=i?i:-1,o=e.length-1;let a=0;for(let l=void 0!==i?65535&n[18]:0;l<o;l++)if("number"==typeof e[l+1]){if(a=e[l],null!=i&&a>=i)break}else e[l]<0&&(n[18]+=65536),(a<s||-1==s)&&(M1(n,t,e,l),n[18]=(4294901760&n[18])+l+2),l++}function M1(n,e,t,i){const r=t[i]<0,s=t[i+1],a=n[r?-t[i]:t[i]];if(r){if(n[2]>>11<n[18]>>16&&(3&n[2])===e){n[2]+=2048;try{s.call(a)}finally{}}}else try{s.call(a)}finally{}}class Hh{constructor(e,t,i){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=i}}function _p(n,e,t){const i=lr(n);let r=0;for(;r<t.length;){const s=t[r];if("number"==typeof s){if(0!==s)break;r++;const o=t[r++],a=t[r++],l=t[r++];i?n.setAttribute(e,a,l,o):e.setAttributeNS(o,a,l)}else{const o=s,a=t[++r];l_(o)?i&&n.setProperty(e,o,a):i?n.setAttribute(e,o,a):e.setAttribute(o,a),r++}}return r}function Jv(n){return 3===n||4===n||6===n}function l_(n){return 64===n.charCodeAt(0)}function Gh(n,e){if(null!==e&&0!==e.length)if(null===n||0===n.length)n=e.slice();else{let t=-1;for(let i=0;i<e.length;i++){const r=e[i];"number"==typeof r?t=r:0===t||c_(n,t,r,null,-1===t||2===t?e[++i]:null)}}return n}function c_(n,e,t,i,r){let s=0,o=n.length;if(-1===e)o=-1;else for(;s<n.length;){const a=n[s++];if("number"==typeof a){if(a===e){o=-1;break}if(a>e){o=s-1;break}}}for(;s<n.length;){const a=n[s];if("number"==typeof a)break;if(a===t){if(null===i)return void(null!==r&&(n[s+1]=r));if(i===n[s+1])return void(n[s+2]=r)}s++,null!==i&&s++,null!==r&&s++}-1!==o&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),null!==i&&n.splice(s++,0,i),null!==r&&n.splice(s++,0,r)}function eb(n){return-1!==n}function Dd(n){return 32767&n}function tl(n,e){let t=function(n){return n>>16}(n),i=e;for(;t>0;)i=i[15],t--;return i}let Id=!0;function yp(n){const e=Id;return Id=n,e}let d_=0;function zs(n,e){const t=vp(n,e);if(-1!==t)return t;const i=e[1];i.firstCreatePass&&(n.injectorIndex=e.length,h_(i.data,n),h_(e,null),h_(i.blueprint,null));const r=$h(n,e),s=n.injectorIndex;if(eb(r)){const o=Dd(r),a=tl(r,e),l=a[1].data;for(let c=0;c<8;c++)e[s+c]=a[o+c]|l[o+c]}return e[s+8]=r,s}function h_(n,e){n.push(0,0,0,0,0,0,0,0,e)}function vp(n,e){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===e[n.injectorIndex+8]?-1:n.injectorIndex}function $h(n,e){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let t=0,i=null,r=e;for(;null!==r;){const s=r[1],o=s.type;if(i=2===o?s.declTNode:1===o?r[6]:null,null===i)return-1;if(t++,r=r[15],-1!==i.injectorIndex)return i.injectorIndex|t<<16}return-1}function Tc(n,e,t){!function(n,e,t){let i;"string"==typeof t?i=t.charCodeAt(0)||0:t.hasOwnProperty(Mh)&&(i=t[Mh]),null==i&&(i=t[Mh]=d_++);const r=255&i;e.data[n+(r>>5)]|=1<<r}(n,e,t)}function f_(n,e,t){if(t&wn.Optional)return n;mn(e,"NodeInjector")}function nb(n,e,t,i){if(t&wn.Optional&&void 0===i&&(i=null),0==(t&(wn.Self|wn.Host))){const r=n[9],s=ba(void 0);try{return r?r.get(e,i,t&wn.Optional):yd(e,i,t&wn.Optional)}finally{ba(s)}}return f_(i,e,t)}function Wh(n,e,t,i=wn.Default,r){if(null!==n){const s=function(n){if("string"==typeof n)return n.charCodeAt(0)||0;const e=n.hasOwnProperty(Mh)?n[Mh]:void 0;return"number"==typeof e?e>=0?255&e:rb:e}(t);if("function"==typeof s){if(!Md(e,n,i))return i&wn.Host?f_(r,t,i):nb(e,t,i,r);try{const o=s(i);if(null!=o||i&wn.Optional)return o;mn(t)}finally{Oo()}}else if("number"==typeof s){let o=null,a=vp(n,e),l=-1,c=i&wn.Host?e[16][6]:null;for((-1===a||i&wn.SkipSelf)&&(l=-1===a?$h(n,e):e[a+8],-1!==l&&qh(i,!1)?(o=e[1],a=Dd(l),e=tl(l,e)):a=-1);-1!==a;){const u=e[1];if(bp(s,a,u.data)){const h=Cs(a,e,t,o,i,c);if(h!==ib)return h}l=e[a+8],-1!==l&&qh(i,e[1].data[a+8]===c)&&bp(s,a,e)?(o=u,a=Dd(l),e=tl(l,e)):a=-1}}}return nb(e,t,i,r)}const ib={};function rb(){return new Ko(ss(),Bt())}function Cs(n,e,t,i,r,s){const o=e[1],a=o.data[n+8],u=Od(a,o,t,null==i?Sd(a)&&Id:i!=o&&0!=(3&a.type),r&wn.Host&&s===a);return null!==u?Rd(e,o,u,a):ib}function Od(n,e,t,i,r){const s=n.providerIndexes,o=e.data,a=1048575&s,l=n.directiveStart,u=s>>20,p=r?a+u:n.directiveEnd;for(let g=i?a:a+u;g<p;g++){const m=o[g];if(g<l&&t===m||g>=l&&m.type===t)return g}if(r){const g=o[l];if(g&&Sa(g)&&g.type===t)return l}return null}function Rd(n,e,t,i){let r=n[t];const s=e.data;if(function(n){return n instanceof Hh}(r)){const o=r;o.resolving&&function(n,e){throw new Je("200",`Circular dependency in DI detected for ${n}`)}(Yt(s[t]));const a=yp(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?ba(o.injectImpl):null;Md(n,i,wn.Default);try{r=n[t]=o.factory(void 0,s,n,i),e.firstCreatePass&&t>=i.directiveStart&&function(n,e,t){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:s}=e.type.prototype;if(i){const o=Kv(e);(t.preOrderHooks||(t.preOrderHooks=[])).push(n,o),(t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n,o)}r&&(t.preOrderHooks||(t.preOrderHooks=[])).push(0-n,r),s&&((t.preOrderHooks||(t.preOrderHooks=[])).push(n,s),(t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n,s))}(t,s[t],e)}finally{null!==l&&ba(l),yp(a),o.resolving=!1,Oo()}}return r}function bp(n,e,t){return!!(t[e+(n>>5)]&1<<n)}function qh(n,e){return!(n&wn.Self||n&wn.Host&&e)}class Ko{constructor(e,t){this._tNode=e,this._lView=t}get(e,t){return Wh(this._tNode,this._lView,e,void 0,t)}}function $i(n){return Ae(()=>{const e=n.prototype.constructor,t=e[Rl]||Ts(e),i=Object.prototype;let r=Object.getPrototypeOf(n.prototype).constructor;for(;r&&r!==i;){const s=r[Rl]||Ts(r);if(s&&s!==t)return s;r=Object.getPrototypeOf(r)}return s=>new s})}function Ts(n){return ke(n)?()=>{const e=Ts(ve(n));return e&&e()}:xc(n)}const Pd="__parameters__";function Da(n,e,t){return Ae(()=>{const i=function(n){return function(...t){if(n){const i=n(...t);for(const r in i)this[r]=i[r]}}}(e);function r(...s){if(this instanceof r)return i.apply(this,s),this;const o=new r(...s);return a.annotation=o,a;function a(l,c,u){const h=l.hasOwnProperty(Pd)?l[Pd]:Object.defineProperty(l,Pd,{value:[]})[Pd];for(;h.length<=u;)h.push(null);return(h[u]=h[u]||[]).push(o),l}}return t&&(r.prototype=Object.create(t.prototype)),r.prototype.ngMetadataName=n,r.annotationCls=r,r})}class zt{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=We({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}toString(){return`InjectionToken ${this._desc}`}}function Qo(n,e){void 0===e&&(e=n);for(let t=0;t<n.length;t++){let i=n[t];Array.isArray(i)?(e===n&&(e=n.slice(0,t)),Qo(i,e)):e!==n&&e.push(i)}return e}function Zo(n,e){n.forEach(t=>Array.isArray(t)?Zo(t,e):e(t))}function Kh(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function kl(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function Mc(n,e){const t=[];for(let i=0;i<n;i++)t.push(e);return t}function Ro(n,e,t){let i=As(n,e);return i>=0?n[1|i]=t:(i=~i,function(n,e,t,i){let r=n.length;if(r==e)n.push(t,i);else if(1===r)n.push(i,n[0]),n[0]=t;else{for(r--,n.push(n[r-1],n[r]);r>e;)n[r]=n[r-2],r--;n[e]=t,n[e+1]=i}}(n,i,e,t)),i}function v_(n,e){const t=As(n,e);if(t>=0)return n[1|t]}function As(n,e){return function(n,e,t){let i=0,r=n.length>>t;for(;r!==i;){const s=i+(r-i>>1),o=n[s<<t];if(e===o)return s<<t;o>e?r=s:i=s+1}return~(r<<t)}(n,e,1)}const Au={},Cp="__NG_DI_FLAG__",Ic="ngTempTokenPath",Oc=/\n/gm,rl="__source",Tp=Jt({provide:String,useValue:Jt});let Mu;function kd(n){const e=Mu;return Mu=n,e}function H1(n,e=wn.Default){if(void 0===Mu)throw new Error("inject() must be called from an injection context");return null===Mu?yd(n,void 0,e):Mu.get(n,e&wn.Optional?null:void 0,e)}function Ie(n,e=wn.Default){return(fo||H1)(ve(n),e)}const Rc=Ie;function Du(n){const e=[];for(let t=0;t<n.length;t++){const i=ve(n[t]);if(Array.isArray(i)){if(0===i.length)throw new Error("Arguments array must have arguments.");let r,s=wn.Default;for(let o=0;o<i.length;o++){const a=i[o],l=ub(a);"number"==typeof l?-1===l?r=a.token:s|=l:r=a}e.push(Ie(r,s))}else e.push(Ie(i))}return e}function Bd(n,e){return n[Cp]=e,n.prototype[Cp]=e,n}function ub(n){return n[Cp]}function eo(n,e,t,i){const r=n[Ic];throw e[rl]&&r.unshift(e[rl]),n.message=function(n,e,t,i=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.substr(2):n;let r=rt(e);if(Array.isArray(e))r=e.map(rt).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):rt(a)))}r=`{${s.join(", ")}}`}return`${t}${i?"("+i+")":""}[${r}]: ${n.replace(Oc,"\n  ")}`}("\n"+n.message,r,t,i),n.ngTokenPath=r,n[Ic]=null,n}const Vd=Bd(Da("Inject",n=>({token:n})),-1),Zr=Bd(Da("Optional"),8),sl=Bd(Da("SkipSelf"),4);function Hs(n){return n instanceof class{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}?n.changingThisBreaksApplicationSecurity:n}const L_="__ngContext__";function Ms(n,e){n[L_]=e}function k_(n){const e=function(n){return n[L_]||null}(n);return e?Array.isArray(e)?e:e.lView:null}function Bp(n){return n.ngOriginalError}function fT(n,...e){n.error(...e)}class na{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e),i=this._findContext(e),r=function(n){return n&&n.ngErrorLogger||fT}(e);r(this._console,"ERROR",e),t&&r(this._console,"ORIGINAL ERROR",t),i&&r(this._console,"ERROR CONTEXT",i)}_findContext(e){return e?function(n){return n.ngDebugContext}(e)||this._findContext(Bp(e)):null}_findOriginalError(e){let t=e&&Bp(e);for(;t&&Bp(t);)t=Bp(t);return t||null}}const kb=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(ni))();function al(n){return n instanceof Function?n():n}var Fo=(()=>((Fo=Fo||{})[Fo.Important=1]="Important",Fo[Fo.DashCase=2]="DashCase",Fo))();function z_(n,e){return undefined(n,e)}function nf(n){const e=n[3];return qo(e)?e[3]:e}function $d(n){return zb(n[13])}function G_(n){return zb(n[4])}function zb(n){for(;null!==n&&!qo(n);)n=n[4];return n}function Wd(n,e,t,i,r){if(null!=i){let s,o=!1;qo(i)?s=i:Wo(i)&&(o=!0,i=i[0]);const a=vr(i);0===n&&null!==t?null==r?qb(e,t,a):ll(e,t,a,r||null,!0):1===n&&null!==t?ll(e,t,a,r||null,!0):2===n?function(n,e,t){const i=Up(n,e);i&&function(n,e,t,i){lr(n)?n.removeChild(e,t,i):e.removeChild(t)}(n,i,e,t)}(e,a,o):3===n&&e.destroyNode(a),null!=s&&function(n,e,t,i,r){const s=t[7];s!==vr(t)&&Wd(e,n,i,s,r);for(let a=10;a<t.length;a++){const l=t[a];qd(l[1],l,n,e,i,s)}}(e,n,s,t,r)}}function W_(n,e,t){return lr(n)?n.createElement(e,t):null===t?n.createElement(e):n.createElementNS(t,e)}function Gb(n,e){const t=n[9],i=t.indexOf(e),r=e[3];1024&e[2]&&(e[2]&=-1025,cp(r,-1)),t.splice(i,1)}function q_(n,e){if(n.length<=10)return;const t=10+e,i=n[t];if(i){const r=i[17];null!==r&&r!==n&&Gb(r,i),e>0&&(n[t-1][4]=i[4]);const s=kl(n,10+e);!function(n,e){qd(n,e,e[11],2,null,null),e[0]=null,e[6]=null}(i[1],i);const o=s[19];null!==o&&o.detachView(s[1]),i[3]=null,i[4]=null,i[2]&=-129}return i}function Y_(n,e){if(!(256&e[2])){const t=e[11];lr(t)&&t.destroyNode&&qd(n,e,t,3,null,null),function(n){let e=n[13];if(!e)return jp(n[1],n);for(;e;){let t=null;if(Wo(e))t=e[13];else{const i=e[10];i&&(t=i)}if(!t){for(;e&&!e[4]&&e!==n;)Wo(e)&&jp(e[1],e),e=e[3];null===e&&(e=n),Wo(e)&&jp(e[1],e),t=e&&e[4]}e=t}}(e)}}function jp(n,e){if(!(256&e[2])){e[2]&=-129,e[2]|=256,function(n,e){let t;if(null!=n&&null!=(t=n.destroyHooks))for(let i=0;i<t.length;i+=2){const r=e[t[i]];if(!(r instanceof Hh)){const s=t[i+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=r[s[o]],l=s[o+1];try{l.call(a)}finally{}}else try{s.call(r)}finally{}}}}(n,e),function(n,e){const t=n.cleanup,i=e[7];let r=-1;if(null!==t)for(let s=0;s<t.length-1;s+=2)if("string"==typeof t[s]){const o=t[s+1],a="function"==typeof o?o(e):vr(e[o]),l=i[r=t[s+2]],c=t[s+3];"boolean"==typeof c?a.removeEventListener(t[s],l,c):c>=0?i[r=c]():i[r=-c].unsubscribe(),s+=2}else{const o=i[r=t[s+1]];t[s].call(o)}if(null!==i){for(let s=r+1;s<i.length;s++)i[s]();e[7]=null}}(n,e),1===e[1].type&&lr(e[11])&&e[11].destroy();const t=e[17];if(null!==t&&qo(e[3])){t!==e[3]&&Gb(t,e);const i=e[19];null!==i&&i.detachView(n)}}}function $b(n,e,t){return function(n,e,t){let i=e;for(;null!==i&&40&i.type;)i=(e=i).parent;if(null===i)return t[0];if(2&i.flags){const r=n.data[i.directiveStart].encapsulation;if(r===$t.None||r===$t.Emulated)return null}return Zs(i,t)}(n,e.parent,t)}function ll(n,e,t,i,r){lr(n)?n.insertBefore(e,t,i,r):e.insertBefore(t,i,r)}function qb(n,e,t){lr(n)?n.appendChild(e,t):e.appendChild(t)}function Yb(n,e,t,i,r){null!==i?ll(n,e,t,i,r):qb(n,e,t)}function Up(n,e){return lr(n)?n.parentNode(e):e.parentNode}function Kb(n,e,t){return Qb(n,e,t)}let Qb=function(n,e,t){return 40&n.type?Zs(n,t):null};function zp(n,e,t,i){const r=$b(n,i,e),s=e[11],a=Kb(i.parent||e[6],i,e);if(null!=r)if(Array.isArray(t))for(let l=0;l<t.length;l++)Yb(s,r,t[l],a,!1);else Yb(s,r,t,a,!1)}function Nu(n,e){if(null!==e){const t=e.type;if(3&t)return Zs(e,n);if(4&t)return Hp(-1,n[e.index]);if(8&t){const i=e.child;if(null!==i)return Nu(n,i);{const r=n[e.index];return qo(r)?Hp(-1,r):vr(r)}}if(32&t)return z_(e,n)()||vr(n[e.index]);{const i=Jb(n,e);return null!==i?Array.isArray(i)?i[0]:Nu(nf(n[16]),i):Nu(n,e.next)}}return null}function Jb(n,e){return null!==e?n[16][6].projection[e.projection]:null}function Hp(n,e){const t=10+n+1;if(t<e.length){const i=e[t],r=i[1].firstChild;if(null!==r)return Nu(i,r)}return e[7]}function rf(n,e,t,i,r,s,o){for(;null!=t;){const a=i[t.index],l=t.type;if(o&&0===e&&(a&&Ms(vr(a),i),t.flags|=4),64!=(64&t.flags))if(8&l)rf(n,e,t.child,i,r,s,!1),Wd(e,n,r,a,s);else if(32&l){const c=z_(t,i);let u;for(;u=c();)Wd(e,n,r,u,s);Wd(e,n,r,a,s)}else 16&l?Q_(n,e,i,t,r,s):Wd(e,n,r,a,s);t=o?t.projectionNext:t.next}}function qd(n,e,t,i,r,s){rf(t,i,n.firstChild,e,r,s,!1)}function Q_(n,e,t,i,r,s){const o=t[16],l=o[6].projection[i.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++)Wd(e,n,r,l[c],s);else rf(n,e,l,o[3],r,s,!0)}function nw(n,e,t){lr(n)?n.setAttribute(e,"style",t):e.style.cssText=t}function Z_(n,e,t){lr(n)?""===t?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t):e.className=t}function sf(n,e,t){let i=n.length;for(;;){const r=n.indexOf(e,t);if(-1===r)return r;if(0===r||n.charCodeAt(r-1)<=32){const s=e.length;if(r+s===i||n.charCodeAt(r+s)<=32)return r}t=r+1}}const iw="ng-template";function BT(n,e,t){let i=0;for(;i<n.length;){let r=n[i++];if(t&&"class"===r){if(r=n[i],-1!==sf(r.toLowerCase(),e,0))return!0}else if(1===r){for(;i<n.length&&"string"==typeof(r=n[i++]);)if(r.toLowerCase()===e)return!0;return!1}}return!1}function Gp(n){return 4===n.type&&n.value!==iw}function rw(n,e,t){return e===(4!==n.type||t?n.value:iw)}function VT(n,e,t){let i=4;const r=n.attrs||[],s=function(n){for(let e=0;e<n.length;e++)if(Jv(n[e]))return e;return n.length}(r);let o=!1;for(let a=0;a<e.length;a++){const l=e[a];if("number"!=typeof l){if(!o)if(4&i){if(i=2|1&i,""!==l&&!rw(n,l,t)||""===l&&1===e.length){if(Oa(i))return!1;o=!0}}else{const c=8&i?l:e[++a];if(8&i&&null!==n.attrs){if(!BT(n.attrs,c,t)){if(Oa(i))return!1;o=!0}continue}const h=jT(8&i?"class":l,r,Gp(n),t);if(-1===h){if(Oa(i))return!1;o=!0;continue}if(""!==c){let p;p=h>s?"":r[h+1].toLowerCase();const g=8&i?p:null;if(g&&-1!==sf(g,c,0)||2&i&&c!==p){if(Oa(i))return!1;o=!0}}}}else{if(!o&&!Oa(i)&&!Oa(l))return!1;if(o&&Oa(l))continue;o=!1,i=l|1&i}}return Oa(i)||o}function Oa(n){return 0==(1&n)}function jT(n,e,t,i){if(null===e)return-1;let r=0;if(i||!t){let s=!1;for(;r<e.length;){const o=e[r];if(o===n)return r;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=e[++r];for(;"string"==typeof a;)a=e[++r];continue}if(4===o)break;if(0===o){r+=4;continue}}r+=s?1:2}return-1}return function(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){const i=n[t];if("number"==typeof i)return-1;if(i===e)return t;t++}return-1}(e,n)}function sw(n,e,t=!1){for(let i=0;i<e.length;i++)if(VT(n,e[i],t))return!0;return!1}function GT(n,e){e:for(let t=0;t<e.length;t++){const i=e[t];if(n.length===i.length){for(let r=0;r<n.length;r++)if(n[r]!==i[r])continue e;return!0}}return!1}function ow(n,e){return n?":not("+e.trim()+")":e}function $T(n){let e=n[0],t=1,i=2,r="",s=!1;for(;t<n.length;){let o=n[t];if("string"==typeof o)if(2&i){const a=n[++t];r+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&i?r+="."+o:4&i&&(r+=" "+o);else""!==r&&!Oa(o)&&(e+=ow(s,r),r=""),i=o,s=s||!Oa(i);t++}return""!==r&&(e+=ow(s,r)),e}const An={};function Kt(n){aw(gi(),Bt(),Js()+n,Bh())}function aw(n,e,t,i){if(!i)if(3==(3&e[2])){const s=n.preOrderCheckHooks;null!==s&&gp(e,s,t)}else{const s=n.preOrderHooks;null!==s&&mp(e,s,0,t)}mo(t)}function cl(n,e){return n<<17|e<<2}function Dn(n){return n>>17&32767}function br(n){return 2|n}function zl(n){return(131068&n)>>2}function ul(n,e){return-131069&n|e<<2}function ey(n){return 1|n}function mw(n,e){const t=n.contentQueries;if(null!==t)for(let i=0;i<t.length;i+=2){const r=t[i],s=t[i+1];if(-1!==s){const o=n.data[s];s_(r),o.contentQueries(2,e[s],s)}}}function af(n,e,t,i,r,s,o,a,l,c){const u=e.blueprint.slice();return u[0]=r,u[2]=140|i,t_(u),u[3]=u[15]=n,u[8]=t,u[10]=o||n&&n[10],u[11]=a||n&&n[11],u[12]=l||n&&n[12]||null,u[9]=c||n&&n[9]||null,u[6]=s,u[16]=2==e.type?n[16]:u,u}function Kd(n,e,t,i,r){let s=n.data[e];if(null===s)s=function(n,e,t,i,r){const s=n_(),o=Ur(),l=n.data[e]=function(n,e,t,i,r,s){return{type:t,index:i,insertBeforeIndex:null,injectorIndex:e?e.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,t,e,i,r);return null===n.firstChild&&(n.firstChild=l),null!==s&&(o?null==s.child&&null!==l.parent&&(s.child=l):null===s.next&&(s.next=l)),l}(n,e,t,i,r),Ln.lFrame.inI18n&&(s.flags|=64);else if(64&s.type){s.type=t,s.value=i,s.attrs=r;const o=function(){const n=Ln.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return Ja(s,!0),s}function Xd(n,e,t,i){if(0===t)return-1;const r=e.length;for(let s=0;s<t;s++)e.push(i),n.blueprint.push(i),n.data.push(null);return r}function lf(n,e,t){Uh(e);try{const i=n.viewQuery;null!==i&&my(1,i,t);const r=n.template;null!==r&&_w(n,e,r,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&mw(n,e),n.staticViewQueries&&my(2,n.viewQuery,t);const s=n.components;null!==s&&function(n,e){for(let t=0;t<e.length;t++)EA(n,e[t])}(e,s)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{e[2]&=-5,li()}}function Qd(n,e,t,i){const r=e[2];if(256==(256&r))return;Uh(e);const s=Bh();try{t_(e),function(n){Ln.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==t&&_w(n,e,t,2,i);const o=3==(3&r);if(!s)if(o){const c=n.preOrderCheckHooks;null!==c&&gp(e,c,null)}else{const c=n.preOrderHooks;null!==c&&mp(e,c,0,null),o_(e,0)}if(function(n){for(let e=$d(n);null!==e;e=G_(e)){if(!e[2])continue;const t=e[9];for(let i=0;i<t.length;i++){const r=t[i],s=r[3];0==(1024&r[2])&&cp(s,1),r[2]|=1024}}}(e),function(n){for(let e=$d(n);null!==e;e=G_(e))for(let t=10;t<e.length;t++){const i=e[t],r=i[1];Td(i)&&Qd(r,i,r.template,i[8])}}(e),null!==n.contentQueries&&mw(n,e),!s)if(o){const c=n.contentCheckHooks;null!==c&&gp(e,c)}else{const c=n.contentHooks;null!==c&&mp(e,c,1),o_(e,1)}!function(n,e){const t=n.hostBindingOpCodes;if(null!==t)try{for(let i=0;i<t.length;i++){const r=t[i];if(r<0)mo(~r);else{const s=r,o=t[++i],a=t[++i];Ad(o,s),a(2,e[s])}}}finally{mo(-1)}}(n,e);const a=n.components;null!==a&&function(n,e){for(let t=0;t<e.length;t++)wA(n,e[t])}(e,a);const l=n.viewQuery;if(null!==l&&my(2,l,i),!s)if(o){const c=n.viewCheckHooks;null!==c&&gp(e,c)}else{const c=n.viewHooks;null!==c&&mp(e,c,2),o_(e,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),s||(e[2]&=-73),1024&e[2]&&(e[2]&=-1025,cp(e[3],-1))}finally{li()}}function sA(n,e,t,i){const r=e[10],s=!Bh(),o=Fl(e);try{s&&!o&&r.begin&&r.begin(),o&&lf(n,e,i),Qd(n,e,t,i)}finally{s&&!o&&r.end&&r.end()}}function _w(n,e,t,i,r){const s=Js(),o=2&i;try{mo(-1),o&&e.length>20&&aw(n,e,20,Bh()),t(i,r)}finally{mo(s)}}function cf(n,e,t){!Qv()||(function(n,e,t,i){const r=t.directiveStart,s=t.directiveEnd;n.firstCreatePass||zs(t,e),Ms(i,e);const o=t.initialInputs;for(let a=r;a<s;a++){const l=n.data[a],c=Sa(l);c&&mA(e,t,l);const u=Rd(e,n,a,t);Ms(u,e),null!==o&&_A(0,a-r,u,l,0,o),c&&(Us(t.index,e)[8]=u)}}(n,e,t,Zs(t,e)),128==(128&t.flags)&&function(n,e,t){const i=t.directiveStart,r=t.directiveEnd,o=t.index,a=Ln.lFrame.currentDirectiveIndex;try{mo(o);for(let l=i;l<r;l++){const c=n.data[l],u=e[l];i_(l),(null!==c.hostBindings||0!==c.hostVars||null!==c.hostAttrs)&&Aw(c,u)}}finally{mo(-1),i_(a)}}(n,e,t))}function ay(n,e,t=Zs){const i=e.localNames;if(null!==i){let r=e.index+1;for(let s=0;s<i.length;s+=2){const o=i[s+1],a=-1===o?t(e,n):n[o];n[r++]=a}}}function Yp(n){const e=n.tView;return null===e||e.incompleteFirstPass?n.tView=Kp(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts):e}function Kp(n,e,t,i,r,s,o,a,l,c){const u=20+i,h=u+r,p=function(n,e){const t=[];for(let i=0;i<e;i++)t.push(i<n?null:An);return t}(u,h),g="function"==typeof c?c():c;return p[1]={type:n,blueprint:p,template:t,queries:null,viewQuery:a,declTNode:e,data:p.slice().fill(null,u),bindingStartIndex:u,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:l,consts:g,incompleteFirstPass:!1}}function bw(n,e,t,i){const r=Ow(e);null===t?r.push(i):(r.push(t),n.firstCreatePass&&Qp(n).push(i,r.length-1))}function ww(n,e,t){for(let i in n)if(n.hasOwnProperty(i)){const r=n[i];(t=null===t?{}:t).hasOwnProperty(i)?t[i].push(e,r):t[i]=[e,r]}return t}function Lo(n,e,t,i,r,s,o,a){const l=Zs(e,t);let u,c=e.inputs;!a&&null!=c&&(u=c[i])?(Rw(n,t,u,i,r),Sd(e)&&function(n,e){const t=Us(e,n);16&t[2]||(t[2]|=64)}(t,e.index)):3&e.type&&(i=function(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(i),r=null!=o?o(r,e.value||"",i):r,lr(s)?s.setProperty(l,i,r):l_(i)||(l.setProperty?l.setProperty(i,r):l[i]=r))}function ly(n,e,t,i){let r=!1;if(Qv()){const s=function(n,e,t){const i=n.directiveRegistry;let r=null;if(i)for(let s=0;s<i.length;s++){const o=i[s];sw(t,o.selectors,!1)&&(r||(r=[]),Tc(zs(t,e),n,o.type),Sa(o)?(Mw(n,t),r.unshift(o)):r.push(o))}return r}(n,e,t),o=null===i?null:{"":-1};if(null!==s){r=!0,cy(t,n.data.length,s.length);for(let u=0;u<s.length;u++){const h=s[u];h.providersResolver&&h.providersResolver(h)}let a=!1,l=!1,c=Xd(n,e,s.length,null);for(let u=0;u<s.length;u++){const h=s[u];t.mergedAttrs=Gh(t.mergedAttrs,h.hostAttrs),uy(n,t,e,c,h),gA(c,h,o),null!==h.contentQueries&&(t.flags|=8),(null!==h.hostBindings||null!==h.hostAttrs||0!==h.hostVars)&&(t.flags|=128);const p=h.type.prototype;!a&&(p.ngOnChanges||p.ngOnInit||p.ngDoCheck)&&((n.preOrderHooks||(n.preOrderHooks=[])).push(t.index),a=!0),!l&&(p.ngOnChanges||p.ngDoCheck)&&((n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t.index),l=!0),c++}!function(n,e){const i=e.directiveEnd,r=n.data,s=e.attrs,o=[];let a=null,l=null;for(let c=e.directiveStart;c<i;c++){const u=r[c],h=u.inputs,p=null===s||Gp(e)?null:yA(h,s);o.push(p),a=ww(h,c,a),l=ww(u.outputs,c,l)}null!==a&&(a.hasOwnProperty("class")&&(e.flags|=16),a.hasOwnProperty("style")&&(e.flags|=32)),e.initialInputs=o,e.inputs=a,e.outputs=l}(n,t)}o&&function(n,e,t){if(e){const i=n.localNames=[];for(let r=0;r<e.length;r+=2){const s=t[e[r+1]];if(null==s)throw new Je("301",`Export of name '${e[r+1]}' not found!`);i.push(e[r],s)}}}(t,i,o)}return t.mergedAttrs=Gh(t.mergedAttrs,t.attrs),r}function Tw(n,e,t,i,r,s){const o=s.hostBindings;if(o){let a=n.hostBindingOpCodes;null===a&&(a=n.hostBindingOpCodes=[]);const l=~e.index;(function(n){let e=n.length;for(;e>0;){const t=n[--e];if("number"==typeof t&&t<0)return t}return 0})(a)!=l&&a.push(l),a.push(i,r,o)}}function Aw(n,e){null!==n.hostBindings&&n.hostBindings(1,e)}function Mw(n,e){e.flags|=2,(n.components||(n.components=[])).push(e.index)}function gA(n,e,t){if(t){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)t[e.exportAs[i]]=n;Sa(e)&&(t[""]=n)}}function cy(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function uy(n,e,t,i,r){n.data[i]=r;const s=r.factory||(r.factory=xc(r.type)),o=new Hh(s,Sa(r),null);n.blueprint[i]=o,t[i]=o,Tw(n,e,0,i,Xd(n,t,r.hostVars,An),r)}function mA(n,e,t){const i=Zs(e,n),r=Yp(t),s=n[10],o=Xp(n,af(n,r,null,t.onPush?64:16,i,e,s,s.createRenderer(i,t),null,null));n[e.index]=o}function hl(n,e,t,i,r,s){const o=Zs(n,e);!function(n,e,t,i,r,s,o){if(null==s)lr(n)?n.removeAttribute(e,r,t):e.removeAttribute(r);else{const a=null==o?Dt(s):o(s,i||"",r);lr(n)?n.setAttribute(e,r,a,t):t?e.setAttributeNS(t,r,a):e.setAttribute(r,a)}}(e[11],o,s,n.value,t,i,r)}function _A(n,e,t,i,r,s){const o=s[e];if(null!==o){const a=i.setInput;for(let l=0;l<o.length;){const c=o[l++],u=o[l++],h=o[l++];null!==a?i.setInput(t,h,c,u):t[u]=h}}}function yA(n,e){let t=null,i=0;for(;i<e.length;){const r=e[i];if(0!==r)if(5!==r){if("number"==typeof r)break;n.hasOwnProperty(r)&&(null===t&&(t=[]),t.push(r,n[r],e[i+1])),i+=2}else i+=2;else i+=4}return t}function Dw(n,e,t,i){return new Array(n,!0,!1,e,null,0,i,t,null,null)}function wA(n,e){const t=Us(e,n);if(Td(t)){const i=t[1];80&t[2]?Qd(i,t,i.template,t[8]):t[5]>0&&hy(t)}}function hy(n){for(let i=$d(n);null!==i;i=G_(i))for(let r=10;r<i.length;r++){const s=i[r];if(1024&s[2]){const o=s[1];Qd(o,s,o.template,s[8])}else s[5]>0&&hy(s)}const t=n[1].components;if(null!==t)for(let i=0;i<t.length;i++){const r=Us(t[i],n);Td(r)&&r[5]>0&&hy(r)}}function EA(n,e){const t=Us(e,n),i=t[1];(function(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])})(i,t),lf(i,t,t[8])}function Xp(n,e){return n[13]?n[14][4]=e:n[13]=e,n[14]=e,e}function fy(n){for(;n;){n[2]|=64;const e=nf(n);if(Wv(n)&&!e)return n;n=e}return null}function gy(n,e,t){const i=e[10];i.begin&&i.begin();try{Qd(n,e,n.template,t)}catch(r){throw yy(e,r),r}finally{i.end&&i.end()}}function Iw(n){!function(n){for(let e=0;e<n.components.length;e++){const t=n.components[e],i=k_(t),r=i[1];sA(r,i,r.template,t)}}(n[8])}function my(n,e,t){s_(0),e(n,t)}const AA=(()=>Promise.resolve(null))();function Ow(n){return n[7]||(n[7]=[])}function Qp(n){return n.cleanup||(n.cleanup=[])}function yy(n,e){const t=n[9],i=t?t.get(na,null):null;i&&i.handleError(e)}function Rw(n,e,t,i,r){for(let s=0;s<t.length;){const o=t[s++],a=t[s++],l=e[o],c=n.data[o];null!==c.setInput?c.setInput(l,r,i,a):l[a]=r}}function Hl(n,e,t){const i=Fh(e,n);!function(n,e,t){lr(n)?n.setValue(e,t):e.textContent=t}(n[11],i,t)}function Zp(n,e,t){let i=t?n.styles:null,r=t?n.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?s=a:1==s?r=at(r,a):2==s&&(i=at(i,a+": "+e[++o]+";"))}t?n.styles=i:n.stylesWithoutHost=i,t?n.classes=r:n.classesWithoutHost=r}const Jd=new zt("INJECTOR",-1);class io{get(e,t=Au){if(t===Au){const i=new Error(`NullInjectorError: No provider for ${rt(e)}!`);throw i.name="NullInjectorError",i}return t}}const Pu=new zt("Set Injector scope."),uf={},DA={};let by;function Nw(){return void 0===by&&(by=new io),by}function Pw(n,e=null,t=null,i){return new Ey(n,t,e||Nw(),i)}class Ey{constructor(e,t,i,r=null){this.parent=i,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const s=[];t&&Zo(t,a=>this.processProvider(a,e,t)),Zo([e],a=>this.processInjectorType(a,[],s)),this.records.set(Jd,Fu(void 0,this));const o=this.records.get(Pu);this.scope=null!=o?o.value:null,this.source=r||("object"==typeof e?null:rt(e))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(e=>e.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(e,t=Au,i=wn.Default){this.assertNotDestroyed();const r=kd(this),s=ba(void 0);try{if(!(i&wn.SkipSelf)){let a=this.records.get(e);if(void 0===a){const l=function(n){return"function"==typeof n||"object"==typeof n&&n instanceof zt}(e)&&_n(e);a=l&&this.injectableDefInScope(l)?Fu(Sy(e),uf):null,this.records.set(e,a)}if(null!=a)return this.hydrate(e,a)}return(i&wn.Self?Nw():this.parent).get(e,t=i&wn.Optional&&t===Au?null:t)}catch(o){if("NullInjectorError"===o.name){if((o[Ic]=o[Ic]||[]).unshift(rt(e)),r)throw o;return eo(o,e,"R3InjectorError",this.source)}throw o}finally{ba(s),kd(r)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(e=>this.get(e))}toString(){const e=[];return this.records.forEach((i,r)=>e.push(rt(r))),`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}processInjectorType(e,t,i){if(!(e=ve(e)))return!1;let r=Il(e);const s=null==r&&e.ngModule||void 0,o=void 0===s?e:s,a=-1!==i.indexOf(o);if(void 0!==s&&(r=Il(s)),null==r)return!1;if(null!=r.imports&&!a){let u;i.push(o);try{Zo(r.imports,h=>{this.processInjectorType(h,t,i)&&(void 0===u&&(u=[]),u.push(h))})}finally{}if(void 0!==u)for(let h=0;h<u.length;h++){const{ngModule:p,providers:g}=u[h];Zo(g,m=>this.processProvider(m,p,g||Ji))}}this.injectorDefTypes.add(o);const l=xc(o)||(()=>new o);this.records.set(o,Fu(l,uf));const c=r.providers;if(null!=c&&!a){const u=e;Zo(c,h=>this.processProvider(h,u,c))}return void 0!==s&&void 0!==e.providers}processProvider(e,t,i){let r=kc(e=ve(e))?e:ve(e&&e.provide);const s=function(n,e,t){return Lw(n)?Fu(void 0,n.useValue):Fu(Fw(n),uf)}(e);if(kc(e)||!0!==e.multi)this.records.get(r);else{let o=this.records.get(r);o||(o=Fu(void 0,uf,!0),o.factory=()=>Du(o.multi),this.records.set(r,o)),r=e,o.multi.push(e)}this.records.set(r,s)}hydrate(e,t){return t.value===uf&&(t.value=DA,t.value=t.factory()),"object"==typeof t.value&&t.value&&function(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(t.value)&&this.onDestroy.add(t.value),t.value}injectableDefInScope(e){if(!e.providedIn)return!1;const t=ve(e.providedIn);return"string"==typeof t?"any"===t||t===this.scope:this.injectorDefTypes.has(t)}}function Sy(n){const e=_n(n),t=null!==e?e.factory:xc(n);if(null!==t)return t;if(n instanceof zt)throw new Error(`Token ${rt(n)} is missing a \u0275prov definition.`);if(n instanceof Function)return function(n){const e=n.length;if(e>0){const i=Mc(e,"?");throw new Error(`Can't resolve all parameters for ${rt(n)}: (${i.join(", ")}).`)}const t=function(n){const e=n&&(n[ho]||n[Bs]);if(e){const t=function(n){if(n.hasOwnProperty("name"))return n.name;const e=(""+n).match(/^function\s*([^\s(]+)/);return null===e?"":e[1]}(n);return console.warn(`DEPRECATED: DI is instantiating a token "${t}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${t}" class.`),e}return null}(n);return null!==t?()=>t.factory(n):()=>new n}(n);throw new Error("unreachable")}function Fw(n,e,t){let i;if(kc(n)){const r=ve(n);return xc(r)||Sy(r)}if(Lw(n))i=()=>ve(n.useValue);else if(function(n){return!(!n||!n.useFactory)}(n))i=()=>n.useFactory(...Du(n.deps||[]));else if(function(n){return!(!n||!n.useExisting)}(n))i=()=>Ie(ve(n.useExisting));else{const r=ve(n&&(n.useClass||n.provide));if(!function(n){return!!n.deps}(n))return xc(r)||Sy(r);i=()=>new r(...Du(n.deps))}return i}function Fu(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function Lw(n){return null!==n&&"object"==typeof n&&Tp in n}function kc(n){return"function"==typeof n}const kw=function(n,e,t){return function(n,e=null,t=null,i){const r=Pw(n,e,t,i);return r._resolveInjectorDefTypes(),r}({name:t},e,n,t)};class Un{static create(e,t){return Array.isArray(e)?kw(e,t,""):kw(e.providers,e.parent,e.name||"")}}function m9(n,e){pp(k_(n)[1],ss())}function In(n){let e=function(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),t=!0;const i=[n];for(;e;){let r;if(Sa(n))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new Error("Directives cannot inherit Components");r=e.\u0275dir}if(r){if(t){i.push(r);const o=n;o.inputs=HA(n.inputs),o.declaredInputs=HA(n.declaredInputs),o.outputs=HA(n.outputs);const a=r.hostBindings;a&&b9(n,a);const l=r.viewQuery,c=r.contentQueries;if(l&&y9(n,l),c&&v9(n,c),Xa(n.inputs,r.inputs),Xa(n.declaredInputs,r.declaredInputs),Xa(n.outputs,r.outputs),Sa(r)&&r.data.animation){const u=n.data;u.animation=(u.animation||[]).concat(r.data.animation)}}const s=r.features;if(s)for(let o=0;o<s.length;o++){const a=s[o];a&&a.ngInherit&&a(n),a===In&&(t=!1)}}e=Object.getPrototypeOf(e)}!function(n){let e=0,t=null;for(let i=n.length-1;i>=0;i--){const r=n[i];r.hostVars=e+=r.hostVars,r.hostAttrs=Gh(r.hostAttrs,t=Gh(t,r.hostAttrs))}}(i)}function HA(n){return n===vd?{}:n===Ji?[]:n}function y9(n,e){const t=n.viewQuery;n.viewQuery=t?(i,r)=>{e(i,r),t(i,r)}:e}function v9(n,e){const t=n.contentQueries;n.contentQueries=t?(i,r,s)=>{e(i,r,s),t(i,r,s)}:e}function b9(n,e){const t=n.hostBindings;n.hostBindings=t?(i,r)=>{e(i,r),t(i,r)}:e}Un.THROW_IF_NOT_FOUND=Au,Un.NULL=new io,Un.\u0275prov=We({token:Un,providedIn:"any",factory:()=>Ie(Jd)}),Un.__NG_ELEMENT_ID__=-1;let zw=null;function Jp(){if(!zw){const n=ni.Symbol;if(n&&n.iterator)zw=n.iterator;else{const e=Object.getOwnPropertyNames(Map.prototype);for(let t=0;t<e.length;++t){const i=e[t];"entries"!==i&&"size"!==i&&Map.prototype[i]===Map.prototype.entries&&(zw=i)}}}return zw}class $l{constructor(e){this.wrapped=e}static wrap(e){return new $l(e)}static unwrap(e){return $l.isWrapped(e)?e.wrapped:e}static isWrapped(e){return e instanceof $l}}function My(n){return!!GA(n)&&(Array.isArray(n)||!(n instanceof Map)&&Jp()in n)}function GA(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function Vc(n,e,t){return n[e]=t}function bo(n,e,t){return!Object.is(n[e],t)&&(n[e]=t,!0)}function Wi(n,e,t,i){const r=Bt();return bo(r,Ta(),e)&&(gi(),hl(Or(),r,n,e,t,i)),Wi}function Si(n,e,t,i,r,s,o,a){const l=Bt(),c=gi(),u=n+20,h=c.firstCreatePass?function(n,e,t,i,r,s,o,a,l){const c=e.consts,u=Kd(e,n,4,o||null,Ca(c,a));ly(e,t,u,Ca(c,l)),pp(e,u);const h=u.tViews=Kp(2,u,i,r,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c);return null!==e.queries&&(e.queries.template(e,u),h.queries=e.queries.embeddedTView(u)),u}(u,c,l,e,t,i,r,s,o):c.data[u];Ja(h,!1);const p=l[11].createComment("");zp(c,l,p,h),Ms(p,l),Xp(l,l[u]=Dw(p,l,p,h)),xd(h)&&cf(c,l,h),null!=o&&ay(l,h,a)}function cg(n){return Cd(Ln.lFrame.contextLView,20+n)}function De(n,e=wn.Default){const t=Bt();return null===t?Ie(n,e):Wh(ss(),t,ve(n),e)}function on(n,e,t){const i=Bt();return bo(i,Ta(),e)&&Lo(gi(),Or(),i,n,e,i[11],t,!1),on}function KA(n,e,t,i,r){const o=r?"class":"style";Rw(n,t,e.inputs[o],o,i)}function Ft(n,e,t,i){const r=Bt(),s=gi(),o=20+n,a=r[11],l=r[o]=W_(a,e,Ln.lFrame.currentNamespace),c=s.firstCreatePass?function(n,e,t,i,r,s,o){const a=e.consts,c=Kd(e,n,2,r,Ca(a,s));return ly(e,t,c,Ca(a,o)),null!==c.attrs&&Zp(c,c.attrs,!1),null!==c.mergedAttrs&&Zp(c,c.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,c),c}(o,s,r,0,e,t,i):s.data[o];Ja(c,!0);const u=c.mergedAttrs;null!==u&&_p(a,l,u);const h=c.classes;null!==h&&Z_(a,l,h);const p=c.styles;null!==p&&nw(a,l,p),64!=(64&c.flags)&&zp(s,r,l,c),0===Ln.lFrame.elementDepthCount&&Ms(l,r),Ln.lFrame.elementDepthCount++,xd(c)&&(cf(s,r,c),function(n,e,t){if(qm(e)){const r=e.directiveEnd;for(let s=e.directiveStart;s<r;s++){const o=n.data[s];o.contentQueries&&o.contentQueries(1,t[s],s)}}}(s,c,r)),null!==i&&ay(r,c)}function Lt(){let n=ss();Ur()?ps():(n=n.parent,Ja(n,!1));const e=n;Ln.lFrame.elementDepthCount--;const t=gi();t.firstCreatePass&&(pp(t,n),qm(n)&&t.queries.elementEnd(n)),null!=e.classesWithoutHost&&function(n){return 0!=(16&n.flags)}(e)&&KA(t,e,Bt(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function(n){return 0!=(32&n.flags)}(e)&&KA(t,e,Bt(),e.stylesWithoutHost,!1)}function Ti(n,e,t,i){Ft(n,e,t,i),Lt()}function Wl(){return Bt()}function Iy(n){return!!n&&"function"==typeof n.then}function G2(n){return!!n&&"function"==typeof n.subscribe}const $w=G2;function Vn(n,e,t,i){const r=Bt(),s=gi(),o=ss();return function(n,e,t,i,r,s,o,a){const l=xd(i),u=n.firstCreatePass&&Qp(n),h=e[8],p=Ow(e);let g=!0;if(3&i.type||a){const x=Zs(i,e),H=a?a(x):x,I=p.length,oe=a?Se=>a(vr(Se[i.index])):i.index;if(lr(t)){let Se=null;if(!a&&l&&(Se=function(n,e,t,i){const r=n.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const o=r[s];if(o===t&&r[s+1]===i){const a=e[7],l=r[s+2];return a.length>l?a[l]:null}"string"==typeof o&&(s+=2)}return null}(n,e,r,i.index)),null!==Se)(Se.__ngLastListenerFn__||Se).__ngNextListenerFn__=s,Se.__ngLastListenerFn__=s,g=!1;else{s=XA(i,e,h,s,!1);const Pe=t.listen(H,r,s);p.push(s,Pe),u&&u.push(r,oe,I,I+1)}}else s=XA(i,e,h,s,!0),H.addEventListener(r,s,o),p.push(s),u&&u.push(r,oe,I,o)}else s=XA(i,e,h,s,!1);const m=i.outputs;let w;if(g&&null!==m&&(w=m[r])){const x=w.length;if(x)for(let H=0;H<x;H+=2){const Be=e[w[H]][w[H+1]].subscribe(s),He=p.length;p.push(s,Be),u&&u.push(r,i.index,He,-(He+1))}}}(s,r,r[11],o,n,e,!!t,i),Vn}function W2(n,e,t,i){try{return!1!==t(i)}catch(r){return yy(n,r),!1}}function XA(n,e,t,i,r){return function s(o){if(o===Function)return i;const a=2&n.flags?Us(n.index,e):e;0==(32&e[2])&&fy(a);let l=W2(e,0,i,o),c=s.__ngNextListenerFn__;for(;c;)l=W2(e,0,c,o)&&l,c=c.__ngNextListenerFn__;return r&&!1===l&&(o.preventDefault(),o.returnValue=!1),l}}function xi(n=1){return function(n){return(Ln.lFrame.contextLView=function(n,e){for(;n>0;)e=e[15],n--;return e}(n,Ln.lFrame.contextLView))[8]}(n)}function eq(n,e){let t=null;const i=function(n){const e=n.attrs;if(null!=e){const t=e.indexOf(5);if(0==(1&t))return e[t+1]}return null}(n);for(let r=0;r<e.length;r++){const s=e[r];if("*"!==s){if(null===i?sw(n,s,!0):GT(i,s))return r}else t=r}return t}function tL(n,e,t,i,r){const s=n[t+1],o=null===e;let a=i?Dn(s):zl(s),l=!1;for(;0!==a&&(!1===l||o);){const u=n[a+1];iq(n[a],e)&&(l=!0,n[a+1]=i?ey(u):br(u)),a=i?Dn(u):zl(u)}l&&(n[t+1]=i?br(s):ey(s))}function iq(n,e){return null===n||null==e||(Array.isArray(n)?n[1]:n)===e||!(!Array.isArray(n)||"string"!=typeof e)&&As(n,e)>=0}const Is={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function nL(n){return n.substring(Is.key,Is.keyEnd)}function iL(n,e){const t=Is.textEnd;return t===e?-1:(e=Is.keyEnd=function(n,e,t){for(;e<t&&n.charCodeAt(e)>32;)e++;return e}(n,Is.key=e,t),fg(n,e,t))}function fg(n,e,t){for(;e<t&&n.charCodeAt(e)<=32;)e++;return e}function Ai(n,e){return function(n,e,t,i){const r=Bt(),s=gi(),o=Io(2);s.firstUpdatePass&&cL(s,n,o,i),e!==An&&bo(r,o,e)&&dL(s,s.data[Js()],r,r[11],n,r[o+1]=function(n,e){return null==n||("string"==typeof e?n+=e:"object"==typeof n&&(n=rt(Hs(n)))),n}(e,t),i,o)}(n,e,null,!0),Ai}function jc(n){!function(n,e,t,i){const r=gi(),s=Io(2);r.firstUpdatePass&&cL(r,null,s,i);const o=Bt();if(t!==An&&bo(o,s,t)){const a=r.data[Js()];if(fL(a,i)&&!lL(r,s)){let l=i?a.classesWithoutHost:a.stylesWithoutHost;null!==l&&(t=at(l,t||"")),KA(r,a,o,t,i)}else!function(n,e,t,i,r,s,o,a){r===An&&(r=Ji);let l=0,c=0,u=0<r.length?r[0]:null,h=0<s.length?s[0]:null;for(;null!==u||null!==h;){const p=l<r.length?r[l+1]:void 0,g=c<s.length?s[c+1]:void 0;let w,m=null;u===h?(l+=2,c+=2,p!==g&&(m=h,w=g)):null===h||null!==u&&u<h?(l+=2,m=u):(c+=2,m=h,w=g),null!==m&&dL(n,e,t,i,m,w,o,a),u=l<r.length?r[l]:null,h=c<s.length?s[c]:null}}(r,a,o,o[11],o[s+1],o[s+1]=function(n,e,t){if(null==t||""===t)return Ji;const i=[],r=Hs(t);if(Array.isArray(r))for(let s=0;s<r.length;s++)n(i,r[s],!0);else if("object"==typeof r)for(const s in r)r.hasOwnProperty(s)&&n(i,s,r[s]);else"string"==typeof r&&e(i,r);return i}(n,e,t),i,s)}}(Ro,Uc,n,!0)}function Uc(n,e){for(let t=function(n){return function(n){Is.key=0,Is.keyEnd=0,Is.value=0,Is.valueEnd=0,Is.textEnd=n.length}(n),iL(n,fg(n,0,Is.textEnd))}(e);t>=0;t=iL(e,t))Ro(n,nL(e),!0)}function lL(n,e){return e>=n.expandoStartIndex}function cL(n,e,t,i){const r=n.data;if(null===r[t+1]){const s=r[Js()],o=lL(n,t);fL(s,i)&&null===e&&!o&&(e=!1),e=function(n,e,t,i){const r=function(n){const e=Ln.lFrame.currentDirectiveIndex;return-1===e?null:n[e]}(n);let s=i?e.residualClasses:e.residualStyles;if(null===r)0===(i?e.classBindings:e.styleBindings)&&(t=Ry(t=ZA(null,n,e,t,i),e.attrs,i),s=null);else{const o=e.directiveStylingLast;if(-1===o||n[o]!==r)if(t=ZA(r,n,e,t,i),null===s){let l=function(n,e,t){const i=t?e.classBindings:e.styleBindings;if(0!==zl(i))return n[Dn(i)]}(n,e,i);void 0!==l&&Array.isArray(l)&&(l=ZA(null,n,e,l[1],i),l=Ry(l,e.attrs,i),function(n,e,t,i){n[Dn(t?e.classBindings:e.styleBindings)]=i}(n,e,i,l))}else s=function(n,e,t){let i;const r=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<r;s++)i=Ry(i,n[s].hostAttrs,t);return Ry(i,e.attrs,t)}(n,e,i)}return void 0!==s&&(i?e.residualClasses=s:e.residualStyles=s),t}(r,s,e,i),function(n,e,t,i,r,s){let o=s?e.classBindings:e.styleBindings,a=Dn(o),l=zl(o);n[i]=t;let u,c=!1;if(Array.isArray(t)){const h=t;u=h[1],(null===u||As(h,u)>0)&&(c=!0)}else u=t;if(r)if(0!==l){const p=Dn(n[a+1]);n[i+1]=cl(p,a),0!==p&&(n[p+1]=ul(n[p+1],i)),n[a+1]=function(n,e){return 131071&n|e<<17}(n[a+1],i)}else n[i+1]=cl(a,0),0!==a&&(n[a+1]=ul(n[a+1],i)),a=i;else n[i+1]=cl(l,0),0===a?a=i:n[l+1]=ul(n[l+1],i),l=i;c&&(n[i+1]=br(n[i+1])),tL(n,u,i,!0),tL(n,u,i,!1),function(n,e,t,i,r){const s=r?n.residualClasses:n.residualStyles;null!=s&&"string"==typeof e&&As(s,e)>=0&&(t[i+1]=ey(t[i+1]))}(e,u,n,i,s),o=cl(a,l),s?e.classBindings=o:e.styleBindings=o}(r,s,e,t,o,i)}}function ZA(n,e,t,i,r){let s=null;const o=t.directiveEnd;let a=t.directiveStylingLast;for(-1===a?a=t.directiveStart:a++;a<o&&(s=e[a],i=Ry(i,s.hostAttrs,r),s!==n);)a++;return null!==n&&(t.directiveStylingLast=a),i}function Ry(n,e,t){const i=t?1:2;let r=-1;if(null!==e)for(let s=0;s<e.length;s++){const o=e[s];"number"==typeof o?r=o:r===i&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),Ro(n,o,!!t||e[++s]))}return void 0===n?null:n}function dL(n,e,t,i,r,s,o,a){if(!(3&e.type))return;const l=n.data,c=l[a+1];Yw(function(n){return 1==(1&n)}(c)?hL(l,e,t,r,zl(c),o):void 0)||(Yw(s)||function(n){return 2==(2&n)}(c)&&(s=hL(l,null,t,r,a,o)),function(n,e,t,i,r){const s=lr(n);if(e)r?s?n.addClass(t,i):t.classList.add(i):s?n.removeClass(t,i):t.classList.remove(i);else{let o=-1===i.indexOf("-")?void 0:Fo.DashCase;if(null==r)s?n.removeStyle(t,i,o):t.style.removeProperty(i);else{const a="string"==typeof r&&r.endsWith("!important");a&&(r=r.slice(0,-10),o|=Fo.Important),s?n.setStyle(t,i,r,o):t.style.setProperty(i,r,a?"important":"")}}}(i,o,Fh(Js(),t),r,s))}function hL(n,e,t,i,r,s){const o=null===e;let a;for(;r>0;){const l=n[r],c=Array.isArray(l),u=c?l[1]:l,h=null===u;let p=t[r+1];p===An&&(p=h?Ji:void 0);let g=h?v_(p,i):u===i?p:void 0;if(c&&!Yw(g)&&(g=v_(l,i)),Yw(g)&&(a=g,o))return a;const m=n[r+1];r=o?Dn(m):zl(m)}if(null!==e){let l=s?e.residualClasses:e.residualStyles;null!=l&&(a=v_(l,i))}return a}function Yw(n){return void 0!==n}function fL(n,e){return 0!=(n.flags&(e?16:32))}function Mi(n,e=""){const t=Bt(),i=gi(),r=n+20,s=i.firstCreatePass?Kd(i,r,1,e,null):i.data[r],o=t[r]=function(n,e){return lr(n)?n.createText(e):n.createTextNode(e)}(t[11],e);zp(i,t,o,s),Ja(s,!1)}function Os(n){return zc("",n,""),Os}function zc(n,e,t){const i=Bt(),r=function(n,e,t,i){return bo(n,Ta(),t)?e+Dt(t)+i:An}(i,n,e,t);return r!==An&&Hl(i,Js(),r),zc}function Lu(n,e,t){const i=Bt();return bo(i,Ta(),e)&&Lo(gi(),Or(),i,n,e,i[11],t,!0),Lu}const hf=void 0;var kq=["en",[["a","p"],["AM","PM"],hf],[["AM","PM"],hf,hf],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],hf,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],hf,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",hf,"{1} 'at' {0}",hf],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(n){const e=Math.floor(Math.abs(n)),t=n.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===t?1:5}];let pg={};function OL(n){return n in pg||(pg[n]=ni.ng&&ni.ng.common&&ni.ng.common.locales&&ni.ng.common.locales[n]),pg[n]}var cn=(()=>((cn=cn||{})[cn.LocaleId=0]="LocaleId",cn[cn.DayPeriodsFormat=1]="DayPeriodsFormat",cn[cn.DayPeriodsStandalone=2]="DayPeriodsStandalone",cn[cn.DaysFormat=3]="DaysFormat",cn[cn.DaysStandalone=4]="DaysStandalone",cn[cn.MonthsFormat=5]="MonthsFormat",cn[cn.MonthsStandalone=6]="MonthsStandalone",cn[cn.Eras=7]="Eras",cn[cn.FirstDayOfWeek=8]="FirstDayOfWeek",cn[cn.WeekendRange=9]="WeekendRange",cn[cn.DateFormat=10]="DateFormat",cn[cn.TimeFormat=11]="TimeFormat",cn[cn.DateTimeFormat=12]="DateTimeFormat",cn[cn.NumberSymbols=13]="NumberSymbols",cn[cn.NumberFormats=14]="NumberFormats",cn[cn.CurrencyCode=15]="CurrencyCode",cn[cn.CurrencySymbol=16]="CurrencySymbol",cn[cn.CurrencyName=17]="CurrencyName",cn[cn.Currencies=18]="Currencies",cn[cn.Directionality=19]="Directionality",cn[cn.PluralCase=20]="PluralCase",cn[cn.ExtraData=21]="ExtraData",cn))();const Xw="en-US";let RL=Xw;function eM(n){Z(n,"Expected localeId to be defined"),"string"==typeof n&&(RL=n.toLowerCase().replace(/_/g,"-"))}function iM(n,e,t,i,r){if(n=ve(n),Array.isArray(n))for(let s=0;s<n.length;s++)iM(n[s],e,t,i,r);else{const s=gi(),o=Bt();let a=kc(n)?n:ve(n.provide),l=Fw(n);const c=ss(),u=1048575&c.providerIndexes,h=c.directiveStart,p=c.providerIndexes>>20;if(kc(n)||!n.multi){const g=new Hh(l,r,De),m=sM(a,e,r?u:u+p,h);-1===m?(Tc(zs(c,o),s,a),rM(s,n,e.length),e.push(a),c.directiveStart++,c.directiveEnd++,r&&(c.providerIndexes+=1048576),t.push(g),o.push(g)):(t[m]=g,o[m]=g)}else{const g=sM(a,e,u+p,h),m=sM(a,e,u,u+p),w=g>=0&&t[g],x=m>=0&&t[m];if(r&&!x||!r&&!w){Tc(zs(c,o),s,a);const H=function(n,e,t,i,r){const s=new Hh(n,t,De);return s.multi=[],s.index=e,s.componentProviders=0,nk(s,r,i&&!t),s}(r?PY:NY,t.length,r,i,l);!r&&x&&(t[m].providerFactory=H),rM(s,n,e.length,0),e.push(a),c.directiveStart++,c.directiveEnd++,r&&(c.providerIndexes+=1048576),t.push(H),o.push(H)}else rM(s,n,g>-1?g:m,nk(t[r?m:g],l,!r&&i));!r&&i&&x&&t[m].componentProviders++}}}function rM(n,e,t,i){const r=kc(e);if(r||function(n){return!!n.useClass}(e)){const o=(e.useClass||e).prototype.ngOnDestroy;if(o){const a=n.destroyHooks||(n.destroyHooks=[]);if(!r&&e.multi){const l=a.indexOf(t);-1===l?a.push(t,[i,o]):a[l+1].push(i,o)}else a.push(t,o)}}}function nk(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function sM(n,e,t,i){for(let r=t;r<i;r++)if(e[r]===n)return r;return-1}function NY(n,e,t,i){return oM(this.multi,[])}function PY(n,e,t,i){const r=this.multi;let s;if(this.providerFactory){const o=this.providerFactory.componentProviders,a=Rd(t,t[1],this.providerFactory.index,i);s=a.slice(0,o),oM(r,s);for(let l=o;l<a.length;l++)s.push(a[l])}else s=[],oM(r,s);return s}function oM(n,e){for(let t=0;t<n.length;t++)e.push((0,n[t])());return e}function Kn(n,e=[]){return t=>{t.providersResolver=(i,r)=>function(n,e,t){const i=gi();if(i.firstCreatePass){const r=Sa(n);iM(t,i.data,i.blueprint,r,!0),iM(e,i.data,i.blueprint,r,!1)}}(i,r?r(n):n,e)}}class ik{}const sk="ngComponent";class kY{resolveComponentFactory(e){throw function(n){const e=Error(`No component factory found for ${rt(n)}. Did you add it to @NgModule.entryComponents?`);return e[sk]=n,e}(e)}}class gl{}function tE(...n){}function mg(n,e){return new En(Zs(n,e))}gl.NULL=new kY;const jY=function(){return mg(ss(),Bt())};let En=(()=>{class n{constructor(t){this.nativeElement=t}}return n.__NG_ELEMENT_ID__=jY,n})();function ok(n){return n instanceof En?n.nativeElement:n}class ff{}let lM=(()=>{class n{}return n.\u0275prov=We({token:n,providedIn:"root",factory:()=>null}),n})();class Bu{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const ak=new Bu("12.2.5");class lk{constructor(){}supports(e){return My(e)}create(e){return new WY(e)}}const $Y=(n,e)=>e;class WY{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||$Y}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,i=this._removalsHead,r=0,s=null;for(;t||i;){const o=!i||t&&t.currentIndex<uk(i,r,s)?t:i,a=uk(o,r,s),l=o.currentIndex;if(o===i)r--,i=i._nextRemoved;else if(t=t._next,null==o.previousIndex)r++;else{s||(s=[]);const c=a-r,u=l-r;if(c!=u){for(let p=0;p<c;p++){const g=p<s.length?s[p]:s[p]=0,m=g+p;u<=m&&m<c&&(s[p]=g+1)}s[o.previousIndex]=u-c}}a!==l&&e(o,a,l)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!My(e))throw new Error(`Error trying to diff '${rt(e)}'. Only arrays and iterables are allowed`);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let r,s,o,t=this._itHead,i=!1;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),null!==t&&Object.is(t.trackById,o)?(i&&(t=this._verifyReinsertion(t,s,o,a)),Object.is(t.item,s)||this._addIdentityChange(t,s)):(t=this._mismatch(t,s,o,a),i=!0),t=t._next}else r=0,function(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{const t=n[Jp()]();let i;for(;!(i=t.next()).done;)e(i.value)}}(e,a=>{o=this._trackByFn(r,a),null!==t&&Object.is(t.trackById,o)?(i&&(t=this._verifyReinsertion(t,a,o,r)),Object.is(t.item,a)||this._addIdentityChange(t,a)):(t=this._mismatch(t,a,o,r),i=!0),t=t._next,r++}),this.length=r;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,i,r){let s;return null===e?s=this._itTail:(s=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,r)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,r)):e=this._addAfter(new qY(t,i),s,r),e}_verifyReinsertion(e,t,i,r){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==s?e=this._reinsertAfter(s,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const r=e._prevRemoved,s=e._nextRemoved;return null===r?this._removalsHead=s:r._nextRemoved=s,null===s?this._removalsTail=r:s._prevRemoved=r,this._insertAfter(e,t,i),this._addToMoves(e,i),e}_moveAfter(e,t,i){return this._unlink(e),this._insertAfter(e,t,i),this._addToMoves(e,i),e}_addAfter(e,t,i){return this._insertAfter(e,t,i),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,i){const r=null===t?this._itHead:t._next;return e._next=r,e._prev=t,null===r?this._itTail=e:r._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new ck),this._linkedRecords.put(e),e.currentIndex=i,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,i=e._next;return null===t?this._itHead=i:t._next=i,null===i?this._itTail=t:i._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new ck),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class qY{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class YY{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===t||t<=i.currentIndex)&&Object.is(i.trackById,e))return i;return null}remove(e){const t=e._prevDup,i=e._nextDup;return null===t?this._head=i:t._nextDup=i,null===i?this._tail=t:i._prevDup=t,null===this._head}}class ck{constructor(){this.map=new Map}put(e){const t=e.trackById;let i=this.map.get(t);i||(i=new YY,this.map.set(t,i)),i.add(e)}get(e,t){const r=this.map.get(e);return r?r.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function uk(n,e,t){const i=n.previousIndex;if(null===i)return i;let r=0;return t&&i<t.length&&(r=t[i]),i+e+r}class dk{constructor(){}supports(e){return e instanceof Map||GA(e)}create(){return new KY}}class KY{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let t;for(t=this._mapHead;null!==t;t=t._next)e(t)}forEachPreviousItem(e){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}forEachChangedItem(e){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}diff(e){if(e){if(!(e instanceof Map||GA(e)))throw new Error(`Error trying to diff '${rt(e)}'. Only maps and objects are allowed`)}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(e,(i,r)=>{if(t&&t.key===r)this._maybeAddToChanges(t,i),this._appendAfter=t,t=t._next;else{const s=this._getOrCreateRecordForKey(r,i);t=this._insertBeforeOrAppend(t,s)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let i=t;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,t){if(e){const i=e._prev;return t._next=e,t._prev=i,e._prev=t,i&&(i._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(e,t){if(this._records.has(e)){const r=this._records.get(e);this._maybeAddToChanges(r,t);const s=r._prev,o=r._next;return s&&(s._next=o),o&&(o._prev=s),r._next=null,r._prev=null,r}const i=new XY(e);return this._records.set(e,i),i.currentValue=t,this._addToAdditions(i),i}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(i=>t(e[i],i))}}class XY{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function hk(){return new _g([new lk])}let _g=(()=>{class n{constructor(t){this.factories=t}static create(t,i){if(null!=i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||hk()),deps:[[n,new sl,new Zr]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(null!=i)return i;throw new Error(`Cannot find a differ supporting object '${t}' of type '${function(n){return n.name||typeof n}(t)}'`)}}return n.\u0275prov=We({token:n,providedIn:"root",factory:hk}),n})();function fk(){return new yg([new dk])}let yg=(()=>{class n{constructor(t){this.factories=t}static create(t,i){if(i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||fk()),deps:[[n,new sl,new Zr]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(i)return i;throw new Error(`Cannot find a differ supporting object '${t}'`)}}return n.\u0275prov=We({token:n,providedIn:"root",factory:fk}),n})();function nE(n,e,t,i,r=!1){for(;null!==t;){const s=e[t.index];if(null!==s&&i.push(vr(s)),qo(s))for(let a=10;a<s.length;a++){const l=s[a],c=l[1].firstChild;null!==c&&nE(l[1],l,c,i)}const o=t.type;if(8&o)nE(n,e,t.child,i);else if(32&o){const a=z_(t,e);let l;for(;l=a();)i.push(l)}else if(16&o){const a=Jb(e,t);if(Array.isArray(a))i.push(...a);else{const l=nf(e[16]);nE(l[1],l,a,i,!0)}}t=r?t.projectionNext:t.next}return i}class ky{constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const e=this._lView,t=e[1];return nE(t,e,t.firstChild,[])}get context(){return this._lView[8]}set context(e){this._lView[8]=e}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[3];if(qo(e)){const t=e[8],i=t?t.indexOf(this):-1;i>-1&&(q_(e,i),kl(t,i))}this._attachedToViewContainer=!1}Y_(this._lView[1],this._lView)}onDestroy(e){bw(this._lView[1],this._lView,null,e)}markForCheck(){fy(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){gy(this._lView[1],this._lView,this.context)}checkNoChanges(){!function(n,e,t){dp(!0);try{gy(n,e,t)}finally{dp(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function(n,e){qd(n,e,e[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new Error("This view is already attached to a ViewContainer!");this._appRef=e}}class ZY extends ky{constructor(e){super(e),this._view=e}detectChanges(){Iw(this._view)}checkNoChanges(){!function(n){dp(!0);try{Iw(n)}finally{dp(!1)}}(this._view)}get context(){return null}}const eK=function(n){return function(n,e,t){if(Sd(n)&&!t){const i=Us(n.index,e);return new ky(i,i)}return 47&n.type?new ky(e[16],e):null}(ss(),Bt(),16==(16&n))};let as=(()=>{class n{}return n.__NG_ELEMENT_ID__=eK,n})();const iK=[new dk],sK=new _g([new lk]),oK=new yg(iK),lK=function(){return iE(ss(),Bt())};let Bo=(()=>{class n{}return n.__NG_ELEMENT_ID__=lK,n})();const cK=Bo,uK=class extends cK{constructor(e,t,i){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=i}createEmbeddedView(e){const t=this._declarationTContainer.tViews,i=af(this._declarationLView,t,e,16,null,t.declTNode,null,null,null,null);i[17]=this._declarationLView[this._declarationTContainer.index];const s=this._declarationLView[19];return null!==s&&(i[19]=s.createEmbeddedView(t)),lf(t,i,e),new ky(i)}};function iE(n,e){return 4&n.type?new uK(e,n,mg(n,e)):null}class Hc{}const fK=function(){return _k(ss(),Bt())};let Rs=(()=>{class n{}return n.__NG_ELEMENT_ID__=fK,n})();const gK=Rs,gk=class extends gK{constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return mg(this._hostTNode,this._hostLView)}get injector(){return new Ko(this._hostTNode,this._hostLView)}get parentInjector(){const e=$h(this._hostTNode,this._hostLView);if(eb(e)){const t=tl(e,this._hostLView),i=Dd(e);return new Ko(t[1].data[i+8],t)}return new Ko(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=mk(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-10}createEmbeddedView(e,t,i){const r=e.createEmbeddedView(t||{});return this.insert(r,i),r}createComponent(e,t,i,r,s){const o=i||this.parentInjector;if(!s&&null==e.ngModule&&o){const l=o.get(Hc,null);l&&(s=l)}const a=e.create(o,r,void 0,s);return this.insert(a.hostView,t),a}insert(e,t){const i=e._lView,r=i[1];if(function(n){return qo(n[3])}(i)){const u=this.indexOf(e);if(-1!==u)this.detach(u);else{const h=i[3],p=new gk(h,h[6],h[3]);p.detach(p.indexOf(e))}}const s=this._adjustIndex(t),o=this._lContainer;!function(n,e,t,i){const r=10+i,s=t.length;i>0&&(t[r-1][4]=e),i<s-10?(e[4]=t[r],Kh(t,10+i,e)):(t.push(e),e[4]=null),e[3]=t;const o=e[17];null!==o&&t!==o&&function(n,e){const t=n[9];e[16]!==e[3][3][16]&&(n[2]=!0),null===t?n[9]=[e]:t.push(e)}(o,e);const a=e[19];null!==a&&a.insertView(n),e[2]|=128}(r,i,o,s);const a=Hp(s,o),l=i[11],c=Up(l,o[7]);return null!==c&&function(n,e,t,i,r,s){i[0]=r,i[6]=e,qd(n,i,t,1,r,s)}(r,o[6],l,i,c,a),e.attachToViewContainerRef(),Kh(cM(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=mk(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),i=q_(this._lContainer,t);i&&(kl(cM(this._lContainer),t),Y_(i[1],i))}detach(e){const t=this._adjustIndex(e,-1),i=q_(this._lContainer,t);return i&&null!=kl(cM(this._lContainer),t)?new ky(i):null}_adjustIndex(e,t=0){return null==e?this.length+t:e}};function mk(n){return n[8]}function cM(n){return n[8]||(n[8]=[])}function _k(n,e){let t;const i=e[n.index];if(qo(i))t=i;else{let r;if(8&n.type)r=vr(i);else{const s=e[11];r=s.createComment("");const o=Zs(n,e);ll(s,Up(s,o),r,function(n,e){return lr(n)?n.nextSibling(e):e.nextSibling}(s,o),!1)}e[n.index]=t=Dw(i,e,r,n),Xp(e,t)}return new gk(t,n,e)}const Eg={};class kk extends gl{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=Fi(e);return new Vk(t,this.ngModule)}}function Bk(n){const e=[];for(let t in n)n.hasOwnProperty(t)&&e.push({propName:n[t],templateName:t});return e}const dX=new zt("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>kb});class Vk extends ik{constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function(n){return n.map($T).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}get inputs(){return Bk(this.componentDef.inputs)}get outputs(){return Bk(this.componentDef.outputs)}create(e,t,i,r){const s=(r=r||this.ngModule)?function(n,e){return{get:(t,i,r)=>{const s=n.get(t,Eg,r);return s!==Eg||i===Eg?s:e.get(t,i,r)}}}(e,r.injector):e,o=s.get(ff,vu),a=s.get(lM,null),l=o.createRenderer(null,this.componentDef),c=this.componentDef.selectors[0][0]||"div",u=i?function(n,e,t){if(lr(n))return n.selectRootElement(e,t===$t.ShadowDom);let i="string"==typeof e?n.querySelector(e):e;return i.textContent="",i}(l,i,this.componentDef.encapsulation):W_(o.createRenderer(null,this.componentDef),c,function(n){const e=n.toLowerCase();return"svg"===e?"http://www.w3.org/2000/svg":"math"===e?"http://www.w3.org/1998/MathML/":null}(c)),h=this.componentDef.onPush?576:528,p=function(n,e){return{components:[],scheduler:n||kb,clean:AA,playerHandler:e||null,flags:0}}(),g=Kp(0,null,null,1,0,null,null,null,null,null),m=af(null,g,p,h,null,null,o,l,a,s);let w,x;Uh(m);try{const H=function(n,e,t,i,r,s){const o=t[1];t[20]=n;const l=Kd(o,20,2,"#host",null),c=l.mergedAttrs=e.hostAttrs;null!==c&&(Zp(l,c,!0),null!==n&&(_p(r,n,c),null!==l.classes&&Z_(r,n,l.classes),null!==l.styles&&nw(r,n,l.styles)));const u=i.createRenderer(n,e),h=af(t,Yp(e),null,e.onPush?64:16,t[20],l,i,u,s||null,null);return o.firstCreatePass&&(Tc(zs(l,t),o,e.type),Mw(o,l),cy(l,t.length,1)),Xp(t,h),t[20]=h}(u,this.componentDef,m,o,l);if(u)if(i)_p(l,u,["ng-version",ak.full]);else{const{attrs:I,classes:oe}=function(n){const e=[],t=[];let i=1,r=2;for(;i<n.length;){let s=n[i];if("string"==typeof s)2===r?""!==s&&e.push(s,n[++i]):8===r&&t.push(s);else{if(!Oa(r))break;r=s}i++}return{attrs:e,classes:t}}(this.componentDef.selectors[0]);I&&_p(l,u,I),oe&&oe.length>0&&Z_(l,u,oe.join(" "))}if(x=e_(g,20),void 0!==t){const I=x.projection=[];for(let oe=0;oe<this.ngContentSelectors.length;oe++){const Se=t[oe];I.push(null!=Se?Array.from(Se):null)}}w=function(n,e,t,i,r){const s=t[1],o=function(n,e,t){const i=ss();n.firstCreatePass&&(t.providersResolver&&t.providersResolver(t),uy(n,i,e,Xd(n,e,1,null),t));const r=Rd(e,n,i.directiveStart,i);Ms(r,e);const s=Zs(i,e);return s&&Ms(s,e),r}(s,t,e);if(i.components.push(o),n[8]=o,r&&r.forEach(l=>l(o,e)),e.contentQueries){const l=ss();e.contentQueries(1,o,l.directiveStart)}const a=ss();return!s.firstCreatePass||null===e.hostBindings&&null===e.hostAttrs||(mo(a.index),Tw(t[1],a,0,a.directiveStart,a.directiveEnd,e),Aw(e,o)),o}(H,this.componentDef,m,p,[m9]),lf(g,m,null)}finally{li()}return new pX(this.componentType,w,mg(x,m),m,x)}}class pX extends class{}{constructor(e,t,i,r,s){super(),this.location=i,this._rootLView=r,this._tNode=s,this.instance=t,this.hostView=this.changeDetectorRef=new ZY(r),this.componentType=e}get injector(){return new Ko(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}const Sg=new Map;class _X extends Hc{constructor(e,t){super(),this._parent=t,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new kk(this);const i=Mo(e),r=function(n){return n[s1]||null}(e);r&&eM(r),this._bootstrapComponents=al(i.bootstrap),this._r3Injector=Pw(e,t,[{provide:Hc,useValue:this},{provide:gl,useValue:this.componentFactoryResolver}],rt(e)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(e)}get(e,t=Un.THROW_IF_NOT_FOUND,i=wn.Default){return e===Un||e===Hc||e===Jd?this:this._r3Injector.get(e,t,i)}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class EM extends class{}{constructor(e){super(),this.moduleType=e,null!==Mo(e)&&function(n){const e=new Set;!function t(i){const r=Mo(i,!0),s=r.id;null!==s&&(function(n,e,t){if(e&&e!==t)throw new Error(`Duplicate module registered for ${n} - ${rt(e)} vs ${rt(e.name)}`)}(s,Sg.get(s),i),Sg.set(s,i));const o=al(r.imports);for(const a of o)e.has(a)||(e.add(a),t(a))}(n)}(e)}create(e){return new _X(this.moduleType,e)}}function lE(n,e,t){const i=xs()+n,r=Bt();return r[i]===An?Vc(r,i,t?e.call(t):e()):function(n,e){return n[e]}(r,i)}function Hk(n,e,t,i,r,s){const o=e+t;return bo(n,o,r)?Vc(n,o+1,s?i.call(s,r):i(r)):function(n,e){const t=n[e];return t===An?void 0:t}(n,o+1)}function yl(n,e){const t=gi();let i;const r=n+20;t.firstCreatePass?(i=function(n,e){if(e)for(let t=e.length-1;t>=0;t--){const i=e[t];if(n===i.name)return i}throw new Je("302",`The pipe '${n}' could not be found!`)}(e,t.pipeRegistry),t.data[r]=i,i.onDestroy&&(t.destroyHooks||(t.destroyHooks=[])).push(r,i.onDestroy)):i=t.data[r];const s=i.factory||(i.factory=xc(i.type)),o=ba(De);try{const a=yp(!1),l=s();return yp(a),function(n,e,t,i){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=i}(t,Bt(),r,l),l}finally{ba(o)}}function vl(n,e,t){const i=n+20,r=Bt(),s=Cd(r,i);return function(n,e){$l.isWrapped(e)&&(e=$l.unwrap(e),n[Ln.lFrame.bindingIndex]=An);return e}(r,function(n,e){return n[1].data[e].pure}(r,i)?Hk(r,xs(),e,s.transform,t,s):s.transform(t))}function SM(n){return e=>{setTimeout(n,void 0,e)}}const hn=class extends se{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,i){var r,s,o;let a=e,l=t||(()=>null),c=i;if(e&&"object"==typeof e){const h=e;a=null===(r=h.next)||void 0===r?void 0:r.bind(h),l=null===(s=h.error)||void 0===s?void 0:s.bind(h),c=null===(o=h.complete)||void 0===o?void 0:o.bind(h)}this.__isAsync&&(l=SM(l),a&&(a=SM(a)),c&&(c=SM(c)));const u=super.subscribe({next:a,error:l,complete:c});return e instanceof C&&e.add(u),u}};function RX(){return this._results[Jp()]()}class mf{constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=Jp(),i=mf.prototype;i[t]||(i[t]=RX)}get changes(){return this._changes||(this._changes=new hn)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){const i=this;i.dirty=!1;const r=Qo(e);(this._changesDetected=!function(n,e,t){if(n.length!==e.length)return!1;for(let i=0;i<n.length;i++){let r=n[i],s=e[i];if(t&&(r=t(r),s=t(s)),s!==r)return!1}return!0}(i._results,r,t))&&(i._results=r,i.length=r.length,i.last=r[this.length-1],i.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;class xM{constructor(e){this.queryList=e,this.matches=null}clone(){return new xM(this.queryList)}setDirty(){this.queryList.setDirty()}}class CM{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const i=null!==e.contentQueries?e.contentQueries[0]:t.length,r=[];for(let s=0;s<i;s++){const o=t.getByIndex(s);r.push(this.queries[o.indexInDeclarationView].clone())}return new CM(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==Zk(e,t).matches&&this.queries[t].setDirty()}}class Yk{constructor(e,t,i=null){this.predicate=e,this.flags=t,this.read=i}}class TM{constructor(e=[]){this.queries=e}elementStart(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let i=0;i<this.length;i++){const r=null!==t?t.length:0,s=this.getByIndex(i).embeddedTView(e,r);s&&(s.indexInDeclarationView=i,null!==t?t.push(s):t=[s])}return null!==t?new TM(t):null}template(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class AM{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new AM(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let i=e.parent;for(;null!==i&&8&i.type&&i.index!==t;)i=i.parent;return t===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const s=i[r];this.matchTNodeWithReadOption(e,t,FX(t,s)),this.matchTNodeWithReadOption(e,t,Od(t,e,s,!1,!1))}else i===Bo?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,Od(t,e,i,!1,!1))}matchTNodeWithReadOption(e,t,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===En||r===Rs||r===Bo&&4&t.type)this.addMatch(t.index,-2);else{const s=Od(t,e,r,!1,!1);null!==s&&this.addMatch(t.index,s)}else this.addMatch(t.index,i)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function FX(n,e){const t=n.localNames;if(null!==t)for(let i=0;i<t.length;i+=2)if(t[i]===e)return t[i+1];return null}function kX(n,e,t,i){return-1===t?function(n,e){return 11&n.type?mg(n,e):4&n.type?iE(n,e):null}(e,n):-2===t?function(n,e,t){return t===En?mg(e,n):t===Bo?iE(e,n):t===Rs?_k(e,n):void 0}(n,e,i):Rd(n,n[1],t,e)}function Kk(n,e,t,i){const r=e[19].queries[i];if(null===r.matches){const s=n.data,o=t.matches,a=[];for(let l=0;l<o.length;l+=2){const c=o[l];a.push(c<0?null:kX(e,s[c],o[l+1],t.metadata.read))}r.matches=a}return r.matches}function MM(n,e,t,i){const r=n.queries.getByIndex(t),s=r.matches;if(null!==s){const o=Kk(n,e,r,t);for(let a=0;a<s.length;a+=2){const l=s[a];if(l>0)i.push(o[a/2]);else{const c=s[a+1],u=e[-l];for(let h=10;h<u.length;h++){const p=u[h];p[17]===p[3]&&MM(p[1],p,c,i)}if(null!==u[9]){const h=u[9];for(let p=0;p<h.length;p++){const g=h[p];MM(g[1],g,c,i)}}}}}return i}function mi(n){const e=Bt(),t=gi(),i=Zv();s_(i+1);const r=Zk(t,i);if(n.dirty&&Fl(e)===(2==(2&r.metadata.flags))){if(null===r.matches)n.reset([]);else{const s=r.crossesNgTemplate?MM(t,e,i,[]):Kk(t,e,r,i);n.reset(s,ok),n.notifyOnChanges()}return!0}return!1}function Rr(n,e,t){const i=gi();i.firstCreatePass&&(function(n,e,t){null===n.queries&&(n.queries=new TM),n.queries.track(new AM(e,t))}(i,new Yk(n,e,t),-1),2==(2&e)&&(i.staticViewQueries=!0)),function(n,e,t){const i=new mf(4==(4&t));bw(n,e,i,i.destroy),null===e[19]&&(e[19]=new CM),e[19].queries.push(new xM(i))}(i,Bt(),e)}function _i(){return function(n,e){return n[19].queries[e].queryList}(Bt(),Zv())}function Zk(n,e){return n.queries.getByIndex(e)}const _f=new zt("Application Initializer");let Cg=(()=>{class n{constructor(t){this.appInits=t,this.resolve=tE,this.reject=tE,this.initialized=!1,this.done=!1,this.donePromise=new Promise((i,r)=>{this.resolve=i,this.reject=r})}runInitializers(){if(this.initialized)return;const t=[],i=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let r=0;r<this.appInits.length;r++){const s=this.appInits[r]();if(Iy(s))t.push(s);else if($w(s)){const o=new Promise((a,l)=>{s.subscribe({complete:a,error:l})});t.push(o)}}Promise.all(t).then(()=>{i()}).catch(r=>{this.reject(r)}),0===t.length&&i(),this.initialized=!0}}return n.\u0275fac=function(t){return new(t||n)(Ie(_f,8))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const Ky=new zt("AppId"),pQ={provide:Ky,useFactory:function(){return`${PM()}${PM()}${PM()}`},deps:[]};function PM(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const _3=new zt("Platform Initializer"),Gc=new zt("Platform ID"),dE=new zt("appBootstrapListener");let hE=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const Vu=new zt("LocaleId"),y3=new zt("DefaultCurrencyCode");class mQ{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}const FM=function(n){return new EM(n)},_Q=FM,yQ=function(n){return Promise.resolve(FM(n))},v3=function(n){const e=FM(n),i=al(Mo(n).declarations).reduce((r,s)=>{const o=Fi(s);return o&&r.push(new Vk(o)),r},[]);return new mQ(e,i)},vQ=v3,bQ=function(n){return Promise.resolve(v3(n))};let yf=(()=>{class n{constructor(){this.compileModuleSync=_Q,this.compileModuleAsync=yQ,this.compileModuleAndAllComponentsSync=vQ,this.compileModuleAndAllComponentsAsync=bQ}clearCache(){}clearCacheFor(t){}getModuleId(t){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const b3=new zt("compilerOptions"),EQ=(()=>Promise.resolve(0))();function LM(n){"undefined"==typeof Zone?EQ.then(()=>{n&&n.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",n)}class vn{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new hn(!1),this.onMicrotaskEmpty=new hn(!1),this.onStable=new hn(!1),this.onError=new hn(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&t,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function(){let n=ni.requestAnimationFrame,e=ni.cancelAnimationFrame;if("undefined"!=typeof Zone&&n&&e){const t=n[Zone.__symbol__("OriginalDelegate")];t&&(n=t);const i=e[Zone.__symbol__("OriginalDelegate")];i&&(e=i)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function(n){const e=()=>{!function(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(ni,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,BM(n),n.isCheckStableRunning=!0,kM(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),BM(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,i,r,s,o,a)=>{try{return w3(n),t.invokeTask(r,s,o,a)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||n.shouldCoalesceRunChangeDetection)&&e(),E3(n)}},onInvoke:(t,i,r,s,o,a,l)=>{try{return w3(n),t.invoke(r,s,o,a,l)}finally{n.shouldCoalesceRunChangeDetection&&e(),E3(n)}},onHasTask:(t,i,r,s)=>{t.hasTask(r,s),i===r&&("microTask"==s.change?(n._hasPendingMicrotasks=s.microTask,BM(n),kM(n)):"macroTask"==s.change&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,i,r,s)=>(t.handleError(r,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}(r)}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!vn.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(vn.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,r){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+r,e,xQ,tE,tE);try{return s.runTask(o,t,i)}finally{s.cancelTask(o)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}}const xQ={};function kM(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function BM(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function w3(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function E3(n){n._nesting--,kM(n)}class AQ{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new hn,this.onMicrotaskEmpty=new hn,this.onStable=new hn,this.onError=new hn}run(e,t,i){return e.apply(t,i)}runGuarded(e,t,i){return e.apply(t,i)}runOutsideAngular(e){return e()}runTask(e,t,i,r){return e.apply(t,i)}}let VM=(()=>{class n{constructor(t){this._ngZone=t,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{vn.assertNotInAngularZone(),LM(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())LM(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(t)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,i,r){let s=-1;i&&i>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),t(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:t,timeoutId:s,updateCb:r})}whenStable(t,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(t,i,r){return[]}}return n.\u0275fac=function(t){return new(t||n)(Ie(vn))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),S3=(()=>{class n{constructor(){this._applications=new Map,jM.addToWindow(this)}registerApplication(t,i){this._applications.set(t,i)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,i=!0){return jM.findTestabilityInTree(this,t,i)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class MQ{addToWindow(e){}findTestabilityInTree(e,t,i){return null}}let jM=new MQ,x3=!0,C3=!1;function la(){return C3=!0,x3}let Zl;const T3=new zt("AllowMultipleToken");function A3(n,e,t=[]){const i=`Platform: ${e}`,r=new zt(i);return(s=[])=>{let o=zM();if(!o||o.injector.get(T3,!1))if(n)n(t.concat(s).concat({provide:r,useValue:!0}));else{const a=t.concat(s).concat({provide:r,useValue:!0},{provide:Pu,useValue:"platform"});!function(n){if(Zl&&!Zl.destroyed&&!Zl.injector.get(T3,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");Zl=n.get(M3);const e=n.get(_3,null);e&&e.forEach(t=>t())}(Un.create({providers:a,name:i}))}return function(n){const e=zM();if(!e)throw new Error("No platform exists!");if(!e.injector.get(n,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return e}(r)}}function zM(){return Zl&&!Zl.destroyed?Zl:null}let M3=(()=>{class n{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,i){const a=function(n,e){let t;return t="noop"===n?new AQ:("zone.js"===n?void 0:n)||new vn({enableLongStackTrace:la(),shouldCoalesceEventChangeDetection:!!(null==e?void 0:e.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==e?void 0:e.ngZoneRunCoalescing)}),t}(i?i.ngZone:void 0,{ngZoneEventCoalescing:i&&i.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:i&&i.ngZoneRunCoalescing||!1}),l=[{provide:vn,useValue:a}];return a.run(()=>{const c=Un.create({providers:l,parent:this.injector,name:t.moduleType.name}),u=t.create(c),h=u.injector.get(na,null);if(!h)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return a.runOutsideAngular(()=>{const p=a.onError.subscribe({next:g=>{h.handleError(g)}});u.onDestroy(()=>{HM(this._modules,u),p.unsubscribe()})}),function(n,e,t){try{const i=t();return Iy(i)?i.catch(r=>{throw e.runOutsideAngular(()=>n.handleError(r)),r}):i}catch(i){throw e.runOutsideAngular(()=>n.handleError(i)),i}}(h,a,()=>{const p=u.injector.get(Cg);return p.runInitializers(),p.donePromise.then(()=>(eM(u.injector.get(Vu,Xw)||Xw),this._moduleDoBootstrap(u),u))})})}bootstrapModule(t,i=[]){const r=D3({},i);return function(n,e,t){const i=new EM(t);return Promise.resolve(i)}(0,0,t).then(s=>this.bootstrapModuleFactory(s,r))}_moduleDoBootstrap(t){const i=t.injector.get(th);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!t.instance.ngDoBootstrap)throw new Error(`The module ${rt(t.instance.constructor)} was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.`);t.instance.ngDoBootstrap(i)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(t=>t.destroy()),this._destroyListeners.forEach(t=>t()),this._destroyed=!0}get destroyed(){return this._destroyed}}return n.\u0275fac=function(t){return new(t||n)(Ie(Un))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();function D3(n,e){return Array.isArray(e)?e.reduce(D3,n):Object.assign(Object.assign({},n),e)}let th=(()=>{class n{constructor(t,i,r,s,o){this._zone=t,this._injector=i,this._exceptionHandler=r,this._componentFactoryResolver=s,this._initStatus=o,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const a=new O(c=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{c.next(this._stable),c.complete()})}),l=new O(c=>{let u;this._zone.runOutsideAngular(()=>{u=this._zone.onStable.subscribe(()=>{vn.assertNotInAngularZone(),LM(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,c.next(!0))})})});const h=this._zone.onUnstable.subscribe(()=>{vn.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{c.next(!1)}))});return()=>{u.unsubscribe(),h.unsubscribe()}});this.isStable=Nn(a,l.pipe(bs()))}bootstrap(t,i){if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");let r;r=t instanceof ik?t:this._componentFactoryResolver.resolveComponentFactory(t),this.componentTypes.push(r.componentType);const s=function(n){return n.isBoundToModule}(r)?void 0:this._injector.get(Hc),a=r.create(Un.NULL,[],i||r.selector,s),l=a.location.nativeElement,c=a.injector.get(VM,null),u=c&&a.injector.get(S3);return c&&u&&u.registerApplication(l,c),a.onDestroy(()=>{this.detachView(a.hostView),HM(this.components,a),u&&u.unregisterApplication(l)}),this._loadComponent(a),a}tick(){if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(t))}finally{this._runningTick=!1}}attachView(t){const i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){const i=t;HM(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t),this._injector.get(dE,[]).concat(this._bootstrapListeners).forEach(r=>r(t))}ngOnDestroy(){this._views.slice().forEach(t=>t.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return n.\u0275fac=function(t){return new(t||n)(Ie(vn),Ie(Un),Ie(na),Ie(gl),Ie(Cg))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();function HM(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}const tZ=A3(null,"core",[{provide:Gc,useValue:"unknown"},{provide:M3,deps:[Un]},{provide:S3,deps:[]},{provide:hE,deps:[]}]),oZ=[{provide:th,useClass:th,deps:[vn,Un,na,gl,Cg]},{provide:dX,deps:[vn],useFactory:function(n){let e=[];return n.onStable.subscribe(()=>{for(;e.length;)e.pop()()}),function(t){e.push(t)}}},{provide:Cg,useClass:Cg,deps:[[new Zr,_f]]},{provide:yf,useClass:yf,deps:[]},pQ,{provide:_g,useFactory:function(){return sK},deps:[]},{provide:yg,useFactory:function(){return oK},deps:[]},{provide:Vu,useFactory:function(n){return eM(n=n||"undefined"!=typeof $localize&&$localize.locale||Xw),n},deps:[[new Vd(Vu),new Zr,new sl]]},{provide:y3,useValue:"USD"}];let lZ=(()=>{class n{constructor(t){}}return n.\u0275fac=function(t){return new(t||n)(Ie(th))},n.\u0275mod=ln({type:n}),n.\u0275inj=wt({providers:oZ}),n})(),xE=null;function $c(){return xE}const dn=new zt("DocumentToken");var gs=(()=>((gs=gs||{})[gs.Zero=0]="Zero",gs[gs.One=1]="One",gs[gs.Two=2]="Two",gs[gs.Few=3]="Few",gs[gs.Many=4]="Many",gs[gs.Other=5]="Other",gs))();const bJ=function(n){return function(n){const e=function(n){return n.toLowerCase().replace(/_/g,"-")}(n);let t=OL(e);if(t)return t;const i=e.split("-")[0];if(t=OL(i),t)return t;if("en"===i)return kq;throw new Error(`Missing locale data for the locale "${n}".`)}(n)[cn.PluralCase]};class PE{}let KJ=(()=>{class n extends PE{constructor(t){super(),this.locale=t}getPluralCategory(t,i){switch(bJ(i||this.locale)(t)){case gs.Zero:return"zero";case gs.One:return"one";case gs.Two:return"two";case gs.Few:return"few";case gs.Many:return"many";default:return"other"}}}return n.\u0275fac=function(t){return new(t||n)(Ie(Vu))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();function mB(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const i=t.indexOf("="),[r,s]=-1==i?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}class QJ{constructor(e,t,i,r){this.$implicit=e,this.ngForOf=t,this.index=i,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let ih=(()=>{class n{constructor(t,i,r){this._viewContainer=t,this._template=i,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const t=this._ngForOf;if(!this._differ&&t)try{this._differ=this._differs.find(t).create(this.ngForTrackBy)}catch(i){throw new Error(`Cannot find a differ supporting object '${t}' of type '${function(n){return n.name||typeof n}(t)}'. NgFor only supports binding to Iterables such as Arrays.`)}}if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const i=[];t.forEachOperation((r,s,o)=>{if(null==r.previousIndex){const a=this._viewContainer.createEmbeddedView(this._template,new QJ(null,this._ngForOf,-1,-1),null===o?void 0:o),l=new _B(r,a);i.push(l)}else if(null==o)this._viewContainer.remove(null===s?void 0:s);else if(null!==s){const a=this._viewContainer.get(s);this._viewContainer.move(a,o);const l=new _B(r,a);i.push(l)}});for(let r=0;r<i.length;r++)this._perViewChange(i[r].view,i[r].record);for(let r=0,s=this._viewContainer.length;r<s;r++){const o=this._viewContainer.get(r);o.context.index=r,o.context.count=s,o.context.ngForOf=this._ngForOf}t.forEachIdentityChange(r=>{this._viewContainer.get(r.currentIndex).context.$implicit=r.item})}_perViewChange(t,i){t.context.$implicit=i.item}static ngTemplateContextGuard(t,i){return!0}}return n.\u0275fac=function(t){return new(t||n)(De(Rs),De(Bo),De(_g))},n.\u0275dir=kt({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),n})();class _B{constructor(e,t){this.record=e,this.view=t}}let Hu=(()=>{class n{constructor(t,i){this._viewContainer=t,this._context=new JJ,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){yB("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){yB("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,i){return!0}}return n.\u0275fac=function(t){return new(t||n)(De(Rs),De(Bo))},n.\u0275dir=kt({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),n})();class JJ{constructor(){this.$implicit=null,this.ngIf=null}}function yB(n,e){if(e&&!e.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${rt(e)}'.`)}class iee{createSubscription(e,t){return e.subscribe({next:t,error:i=>{throw i}})}dispose(e){e.unsubscribe()}onDestroy(e){e.unsubscribe()}}class ree{createSubscription(e,t){return e.then(t,i=>{throw i})}dispose(e){}onDestroy(e){}}const see=new ree,oee=new iee;let LE=(()=>{class n{constructor(t){this._ref=t,this._latestValue=null,this._subscription=null,this._obj=null,this._strategy=null}ngOnDestroy(){this._subscription&&this._dispose()}transform(t){return this._obj?t!==this._obj?(this._dispose(),this.transform(t)):this._latestValue:(t&&this._subscribe(t),this._latestValue)}_subscribe(t){this._obj=t,this._strategy=this._selectStrategy(t),this._subscription=this._strategy.createSubscription(t,i=>this._updateLatestValue(t,i))}_selectStrategy(t){if(Iy(t))return see;if(G2(t))return oee;throw function(n,e){return Error(`InvalidPipeArgument: '${e}' for pipe '${rt(n)}'`)}(n,t)}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(t,i){t===this._obj&&(this._latestValue=i,this._ref.markForCheck())}}return n.\u0275fac=function(t){return new(t||n)(De(as,16))},n.\u0275pipe=Vs({name:"async",type:n,pure:!1}),n})(),es=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=ln({type:n}),n.\u0275inj=wt({providers:[{provide:PE,useClass:KJ}]}),n})();const xB="browser";function Ef(n){return n===xB}class AB{}class yD extends class extends class{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function(n){xE||(xE=n)}(new yD)}onAndCancel(e,t,i){return e.addEventListener(t,i,!1),()=>{e.removeEventListener(t,i,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=(n0=n0||document.querySelector("base"),n0?n0.getAttribute("href"):null);return null==t?null:function(n){kE=kE||document.createElement("a"),kE.setAttribute("href",n);const e=kE.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){n0=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return mB(document.cookie,e)}}let kE,n0=null;const MB=new zt("TRANSITION_ID"),Oee=[{provide:_f,useFactory:function(n,e,t){return()=>{t.get(Cg).donePromise.then(()=>{const i=$c(),r=e.querySelectorAll(`style[ng-transition="${n}"]`);for(let s=0;s<r.length;s++)i.remove(r[s])})}},deps:[MB,dn,Un],multi:!0}];class vD{static init(){!function(n){jM=n}(new vD)}addToWindow(e){ni.getAngularTestability=(i,r=!0)=>{const s=e.findTestabilityInTree(i,r);if(null==s)throw new Error("Could not find testability for element.");return s},ni.getAllAngularTestabilities=()=>e.getAllTestabilities(),ni.getAllAngularRootElements=()=>e.getAllRootElements(),ni.frameworkStabilizers||(ni.frameworkStabilizers=[]),ni.frameworkStabilizers.push(i=>{const r=ni.getAllAngularTestabilities();let s=r.length,o=!1;const a=function(l){o=o||l,s--,0==s&&i(o)};r.forEach(function(l){l.whenStable(a)})})}findTestabilityInTree(e,t,i){if(null==t)return null;const r=e.getTestability(t);return null!=r?r:i?$c().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null}}let Ree=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const r0=new zt("EventManagerPlugins");let VE=(()=>{class n{constructor(t,i){this._zone=i,this._eventNameToPlugin=new Map,t.forEach(r=>r.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,i,r){return this._findPluginFor(i).addEventListener(t,i,r)}addGlobalEventListener(t,i,r){return this._findPluginFor(i).addGlobalEventListener(t,i,r)}getZone(){return this._zone}_findPluginFor(t){const i=this._eventNameToPlugin.get(t);if(i)return i;const r=this._plugins;for(let s=0;s<r.length;s++){const o=r[s];if(o.supports(t))return this._eventNameToPlugin.set(t,o),o}throw new Error(`No event manager plugin found for event ${t}`)}}return n.\u0275fac=function(t){return new(t||n)(Ie(r0),Ie(vn))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class bD{constructor(e){this._doc=e}addGlobalEventListener(e,t,i){const r=$c().getGlobalEventTarget(this._doc,e);if(!r)throw new Error(`Unsupported event target ${r} for event ${t}`);return this.addEventListener(r,t,i)}}let IB=(()=>{class n{constructor(){this._stylesSet=new Set}addStyles(t){const i=new Set;t.forEach(r=>{this._stylesSet.has(r)||(this._stylesSet.add(r),i.add(r))}),this.onStylesAdded(i)}onStylesAdded(t){}getAllStyles(){return Array.from(this._stylesSet)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),s0=(()=>{class n extends IB{constructor(t){super(),this._doc=t,this._hostNodes=new Map,this._hostNodes.set(t.head,[])}_addStylesToHost(t,i,r){t.forEach(s=>{const o=this._doc.createElement("style");o.textContent=s,r.push(i.appendChild(o))})}addHost(t){const i=[];this._addStylesToHost(this._stylesSet,t,i),this._hostNodes.set(t,i)}removeHost(t){const i=this._hostNodes.get(t);i&&i.forEach(OB),this._hostNodes.delete(t)}onStylesAdded(t){this._hostNodes.forEach((i,r)=>{this._addStylesToHost(t,r,i)})}ngOnDestroy(){this._hostNodes.forEach(t=>t.forEach(OB))}}return n.\u0275fac=function(t){return new(t||n)(Ie(dn))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();function OB(n){$c().remove(n)}const wD={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},ED=/%COMP%/g;function jE(n,e,t){for(let i=0;i<e.length;i++){let r=e[i];Array.isArray(r)?jE(n,r,t):(r=r.replace(ED,n),t.push(r))}return t}function PB(n){return e=>{if("__ngUnwrap__"===e)return n;!1===n(e)&&(e.preventDefault(),e.returnValue=!1)}}let UE=(()=>{class n{constructor(t,i,r){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.rendererByCompId=new Map,this.defaultRenderer=new SD(t)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;switch(i.encapsulation){case $t.Emulated:{let r=this.rendererByCompId.get(i.id);return r||(r=new qee(this.eventManager,this.sharedStylesHost,i,this.appId),this.rendererByCompId.set(i.id,r)),r.applyToHost(t),r}case 1:case $t.ShadowDom:return new Yee(this.eventManager,this.sharedStylesHost,t,i);default:if(!this.rendererByCompId.has(i.id)){const r=jE(i.id,i.styles,[]);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(i.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return n.\u0275fac=function(t){return new(t||n)(Ie(VE),Ie(s0),Ie(Ky))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class SD{constructor(e){this.eventManager=e,this.data=Object.create(null)}destroy(){}createElement(e,t){return t?document.createElementNS(wD[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){e.appendChild(t)}insertBefore(e,t,i){e&&e.insertBefore(t,i)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let i="string"==typeof e?document.querySelector(e):e;if(!i)throw new Error(`The selector "${e}" did not match any elements`);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,r){if(r){t=r+":"+t;const s=wD[r];s?e.setAttributeNS(s,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){const r=wD[i];r?e.removeAttributeNS(r,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,r){r&(Fo.DashCase|Fo.Important)?e.style.setProperty(t,i,r&Fo.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&Fo.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e[t]=i}setValue(e,t){e.nodeValue=t}listen(e,t,i){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,PB(i)):this.eventManager.addEventListener(e,t,PB(i))}}class qee extends SD{constructor(e,t,i,r){super(e),this.component=i;const s=jE(r+"-"+i.id,i.styles,[]);t.addStyles(s),this.contentAttr=function(n){return"_ngcontent-%COMP%".replace(ED,n)}(r+"-"+i.id),this.hostAttr=function(n){return"_nghost-%COMP%".replace(ED,n)}(r+"-"+i.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,t){const i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}}class Yee extends SD{constructor(e,t,i,r){super(e),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const s=jE(r.id,r.styles,[]);for(let o=0;o<s.length;o++){const a=document.createElement("style");a.textContent=s[o],this.shadowRoot.appendChild(a)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}let Kee=(()=>{class n extends bD{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r){return t.addEventListener(i,r,!1),()=>this.removeEventListener(t,i,r)}removeEventListener(t,i,r){return t.removeEventListener(i,r)}}return n.\u0275fac=function(t){return new(t||n)(Ie(dn))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const kB=["alt","control","meta","shift"],nte={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},BB={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},ite={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let rte=(()=>{class n extends bD{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,i,r){const s=n.parseEventName(i),o=n.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>$c().onAndCancel(t,s.domEventName,o))}static parseEventName(t){const i=t.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const s=n._normalizeKey(i.pop());let o="";if(kB.forEach(l=>{const c=i.indexOf(l);c>-1&&(i.splice(c,1),o+=l+".")}),o+=s,0!=i.length||0===s.length)return null;const a={};return a.domEventName=r,a.fullKey=o,a}static getEventFullKey(t){let i="",r=function(n){let e=n.key;if(null==e){if(e=n.keyIdentifier,null==e)return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),3===n.location&&BB.hasOwnProperty(e)&&(e=BB[e]))}return nte[e]||e}(t);return r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),kB.forEach(s=>{s!=r&&ite[s](t)&&(i+=s+".")}),i+=r,i}static eventCallback(t,i,r){return s=>{n.getEventFullKey(s)===t&&r.runGuarded(()=>i(s))}}static _normalizeKey(t){switch(t){case"esc":return"escape";default:return t}}}return n.\u0275fac=function(t){return new(t||n)(Ie(dn))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const hte=A3(tZ,"browser",[{provide:Gc,useValue:xB},{provide:_3,useValue:function(){yD.makeCurrent(),vD.init()},multi:!0},{provide:dn,useFactory:function(){return function(n){Hi=n}(document),document},deps:[]}]),fte=[[],{provide:Pu,useValue:"root"},{provide:na,useFactory:function(){return new na},deps:[]},{provide:r0,useClass:Kee,multi:!0,deps:[dn,vn,Gc]},{provide:r0,useClass:rte,multi:!0,deps:[dn]},[],{provide:UE,useClass:UE,deps:[VE,s0,Ky]},{provide:ff,useExisting:UE},{provide:IB,useExisting:s0},{provide:s0,useClass:s0,deps:[dn]},{provide:VM,useClass:VM,deps:[vn]},{provide:VE,useClass:VE,deps:[r0,vn]},{provide:AB,useClass:Ree,deps:[]},[]];let TD=(()=>{class n{constructor(t){if(t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(t){return{ngModule:n,providers:[{provide:Ky,useValue:t.appId},{provide:MB,useExisting:Ky},Oee]}}}return n.\u0275fac=function(t){return new(t||n)(Ie(n,12))},n.\u0275mod=ln({type:n}),n.\u0275inj=wt({providers:fte,imports:[es,lZ]}),n})();"undefined"!=typeof window&&window;class wte extends C{constructor(e,t){super()}schedule(e,t=0){return this}}class zE extends wte{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){if(this.closed)return this;this.state=e;const i=this.id,r=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(r,i,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this}requestAsyncId(e,t,i=0){return setInterval(e.flush.bind(e,this),i)}recycleAsyncId(e,t,i=0){if(null!==i&&this.delay===i&&!1===this.pending)return t;clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(e,t);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r,i=!1;try{this.work(e)}catch(s){i=!0,r=!!s&&s||new Error(s)}if(i)return this.unsubscribe(),r}_unsubscribe(){const e=this.id,t=this.scheduler,i=t.actions,r=i.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&i.splice(r,1),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null}}let jB=(()=>{class n{constructor(t,i=n.now){this.SchedulerAction=t,this.now=i}schedule(t,i=0,r){return new this.SchedulerAction(this,t).schedule(r,i)}}return n.now=()=>Date.now(),n})();class ic extends jB{constructor(e,t=jB.now){super(e,()=>ic.delegate&&ic.delegate!==this?ic.delegate.now():t()),this.actions=[],this.active=!1,this.scheduled=void 0}schedule(e,t=0,i){return ic.delegate&&ic.delegate!==this?ic.delegate.schedule(e,t,i):super.schedule(e,t,i)}flush(e){const{actions:t}=this;if(this.active)return void t.push(e);let i;this.active=!0;do{if(i=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,i){for(;e=t.shift();)e.unsubscribe();throw i}}}const xte=new class extends ic{}(class extends zE{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,i=0){return null!==i&&i>0||null===i&&this.delay>0?super.requestAsyncId(e,t,i):e.flush(this)}}),Wc=new O(n=>n.complete());function o0(n){return n?function(n){return new O(e=>n.schedule(()=>e.complete()))}(n):Wc}function nn(...n){let e=n[n.length-1];return xe(e)?(n.pop(),Ne(n,e)):Mn(n)}function Ig(n,e){return new O(e?t=>e.schedule(Tte,0,{error:n,subscriber:t}):t=>t.error(n))}function Tte({error:n,subscriber:e}){e.error(n)}class ua{constructor(e,t,i){this.kind=e,this.value=t,this.error=i,this.hasValue="N"===e}observe(e){switch(this.kind){case"N":return e.next&&e.next(this.value);case"E":return e.error&&e.error(this.error);case"C":return e.complete&&e.complete()}}do(e,t,i){switch(this.kind){case"N":return e&&e(this.value);case"E":return t&&t(this.error);case"C":return i&&i()}}accept(e,t,i){return e&&"function"==typeof e.next?this.observe(e):this.do(e,t,i)}toObservable(){switch(this.kind){case"N":return nn(this.value);case"E":return Ig(this.error);case"C":return o0()}throw new Error("unexpected notification kind value")}static createNext(e){return void 0!==e?new ua("N",e):ua.undefinedValueNotification}static createError(e){return new ua("E",void 0,e)}static createComplete(){return ua.completeNotification}}ua.completeNotification=new ua("C"),ua.undefinedValueNotification=new ua("N",void 0);class HE extends y{constructor(e,t,i=0){super(e),this.scheduler=t,this.delay=i}static dispatch(e){const{notification:t,destination:i}=e;t.observe(i),this.unsubscribe()}scheduleMessage(e){this.destination.add(this.scheduler.schedule(HE.dispatch,this.delay,new Mte(e,this.destination)))}_next(e){this.scheduleMessage(ua.createNext(e))}_error(e){this.scheduleMessage(ua.createError(e)),this.unsubscribe()}_complete(){this.scheduleMessage(ua.createComplete()),this.unsubscribe()}}class Mte{constructor(e,t){this.notification=e,this.destination=t}}class xf extends se{constructor(e=Number.POSITIVE_INFINITY,t=Number.POSITIVE_INFINITY,i){super(),this.scheduler=i,this._events=[],this._infiniteTimeWindow=!1,this._bufferSize=e<1?1:e,this._windowTime=t<1?1:t,t===Number.POSITIVE_INFINITY?(this._infiniteTimeWindow=!0,this.next=this.nextInfiniteTimeWindow):this.next=this.nextTimeWindow}nextInfiniteTimeWindow(e){if(!this.isStopped){const t=this._events;t.push(e),t.length>this._bufferSize&&t.shift()}super.next(e)}nextTimeWindow(e){this.isStopped||(this._events.push(new Dte(this._getNow(),e)),this._trimBufferThenGetEvents()),super.next(e)}_subscribe(e){const t=this._infiniteTimeWindow,i=t?this._events:this._trimBufferThenGetEvents(),r=this.scheduler,s=i.length;let o;if(this.closed)throw new G;if(this.isStopped||this.hasError?o=C.EMPTY:(this.observers.push(e),o=new Q(this,e)),r&&e.add(e=new HE(e,r)),t)for(let a=0;a<s&&!e.closed;a++)e.next(i[a]);else for(let a=0;a<s&&!e.closed;a++)e.next(i[a].value);return this.hasError?e.error(this.thrownError):this.isStopped&&e.complete(),o}_getNow(){return(this.scheduler||xte).now()}_trimBufferThenGetEvents(){const e=this._getNow(),t=this._bufferSize,i=this._windowTime,r=this._events,s=r.length;let o=0;for(;o<s&&!(e-r[o].time<i);)o++;return s>t&&(o=Math.max(o,s-t)),o>0&&r.splice(0,o),r}}class Dte{constructor(e,t){this.time=e,this.value=t}}function ts(n,e){return"function"==typeof e?t=>t.pipe(ts((i,r)=>Ve(n(i,r)).pipe(me((s,o)=>e(i,s,r,o))))):t=>t.lift(new Ite(n))}class Ite{constructor(e){this.project=e}call(e,t){return t.subscribe(new Ote(e,this.project))}}class Ote extends be{constructor(e,t){super(e),this.project=t,this.index=0}_next(e){let t;const i=this.index++;try{t=this.project(e,i)}catch(r){return void this.destination.error(r)}this._innerSub(t)}_innerSub(e){const t=this.innerSubscription;t&&t.unsubscribe();const i=new gt(this),r=this.destination;r.add(i),this.innerSubscription=N(e,i),this.innerSubscription!==i&&r.add(this.innerSubscription)}_complete(){const{innerSubscription:e}=this;(!e||e.closed)&&super._complete(),this.unsubscribe()}_unsubscribe(){this.innerSubscription=void 0}notifyComplete(){this.innerSubscription=void 0,this.isStopped&&super._complete()}notifyNext(e){this.destination.next(e)}}const GE={schedule(n,e){const t=setTimeout(n,e);return()=>clearTimeout(t)},scheduleBeforeRender(n){if("undefined"==typeof window)return GE.schedule(n,0);if(void 0===window.requestAnimationFrame)return GE.schedule(n,16);const e=window.requestAnimationFrame(n);return()=>window.cancelAnimationFrame(e)}};let MD;function Ute(n,e,t){let i=t;return function(n){return!!n&&n.nodeType===Node.ELEMENT_NODE}(n)&&e.some((r,s)=>!("*"===r||!function(n,e){if(!MD){const t=Element.prototype;MD=t.matches||t.matchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector||t.webkitMatchesSelector}return n.nodeType===Node.ELEMENT_NODE&&MD.call(n,e)}(n,r)||(i=s,0))),i}class Hte{constructor(e,t){this.componentFactory=t.get(gl).resolveComponentFactory(e)}create(e){return new Gte(this.componentFactory,e)}}class Gte{constructor(e,t){this.componentFactory=e,this.injector=t,this.eventEmitters=new xf(1),this.events=this.eventEmitters.pipe(ts(i=>Nn(...i))),this.componentRef=null,this.viewChangeDetectorRef=null,this.inputChanges=null,this.hasInputChanges=!1,this.implementsOnChanges=!1,this.scheduledChangeDetectionFn=null,this.scheduledDestroyFn=null,this.initialInputValues=new Map,this.unchangedInputs=new Set(this.componentFactory.inputs.map(({propName:i})=>i)),this.ngZone=this.injector.get(vn),this.elementZone="undefined"==typeof Zone?null:this.ngZone.run(()=>Zone.current)}connect(e){this.runInZone(()=>{if(null!==this.scheduledDestroyFn)return this.scheduledDestroyFn(),void(this.scheduledDestroyFn=null);null===this.componentRef&&this.initializeComponent(e)})}disconnect(){this.runInZone(()=>{null===this.componentRef||null!==this.scheduledDestroyFn||(this.scheduledDestroyFn=GE.schedule(()=>{null!==this.componentRef&&(this.componentRef.destroy(),this.componentRef=null,this.viewChangeDetectorRef=null)},10))})}getInputValue(e){return this.runInZone(()=>null===this.componentRef?this.initialInputValues.get(e):this.componentRef.instance[e])}setInputValue(e,t){this.runInZone(()=>{null!==this.componentRef?function(n,e){return n===e||n!=n&&e!=e}(t,this.getInputValue(e))&&(void 0!==t||!this.unchangedInputs.has(e))||(this.recordInputChange(e,t),this.unchangedInputs.delete(e),this.hasInputChanges=!0,this.componentRef.instance[e]=t,this.scheduleDetectChanges()):this.initialInputValues.set(e,t)})}initializeComponent(e){const t=Un.create({providers:[],parent:this.injector}),i=function(n,e){const t=n.childNodes,i=e.map(()=>[]);let r=-1;e.some((s,o)=>"*"===s&&(r=o,!0));for(let s=0,o=t.length;s<o;++s){const a=t[s],l=Ute(a,e,r);-1!==l&&i[l].push(a)}return i}(e,this.componentFactory.ngContentSelectors);this.componentRef=this.componentFactory.create(t,i,e),this.viewChangeDetectorRef=this.componentRef.injector.get(as),this.implementsOnChanges=function(n){return"function"==typeof n}(this.componentRef.instance.ngOnChanges),this.initializeInputs(),this.initializeOutputs(this.componentRef),this.detectChanges(),this.injector.get(th).attachView(this.componentRef.hostView)}initializeInputs(){this.componentFactory.inputs.forEach(({propName:e})=>{this.initialInputValues.has(e)&&this.setInputValue(e,this.initialInputValues.get(e))}),this.initialInputValues.clear()}initializeOutputs(e){const t=this.componentFactory.outputs.map(({propName:i,templateName:r})=>e.instance[i].pipe(me(o=>({name:r,value:o}))));this.eventEmitters.next(t)}callNgOnChanges(e){if(!this.implementsOnChanges||null===this.inputChanges)return;const t=this.inputChanges;this.inputChanges=null,e.instance.ngOnChanges(t)}markViewForCheck(e){this.hasInputChanges&&(this.hasInputChanges=!1,e.markForCheck())}scheduleDetectChanges(){this.scheduledChangeDetectionFn||(this.scheduledChangeDetectionFn=GE.scheduleBeforeRender(()=>{this.scheduledChangeDetectionFn=null,this.detectChanges()}))}recordInputChange(e,t){if(!this.implementsOnChanges)return;null===this.inputChanges&&(this.inputChanges={});const i=this.inputChanges[e];if(i)return void(i.currentValue=t);const r=this.unchangedInputs.has(e),s=r?void 0:this.getInputValue(e);this.inputChanges[e]=new Qm(s,t,r)}detectChanges(){null!==this.componentRef&&(this.callNgOnChanges(this.componentRef),this.markViewForCheck(this.viewChangeDetectorRef),this.componentRef.changeDetectorRef.detectChanges())}runInZone(e){return this.elementZone&&Zone.current!==this.elementZone?this.ngZone.run(e):e()}}class $te extends HTMLElement{constructor(){super(...arguments),this.ngElementEventsSubscription=null}}const qte={initialConfig:{},parse:{},rename:{}};class Yte{constructor(e,t){this.configState=e,this.storedChanges={},this.options=Object.assign(Object.assign({},qte),t)}addChanges(e){this.storedChanges=Object.assign(Object.assign({},this.storedChanges),e)}applyChanges(e,t={}){void 0===e&&(e=this.storedChanges,this.storedChanges={});const{configState:i,options:{initialConfig:r}}=this,s=i.snapshot,o=Object.assign(Object.assign(Object.assign({},r),s),t);for(const[a,l]of Object.entries(e))this.processChange(a,l,o);i.setConfig(o)}processChange(e,t,i){var r,s;const{options:{parse:o,rename:a}}=this,l=null!==(r=a[e])&&void 0!==r?r:e,c=t.currentValue,u=null!==(s=o[e])&&void 0!==s?s:o[l];if(null==c)delete i[l];else if(u)try{i[l]=u(c)}catch(h){console.warn(`Failed to parse ${e} = ${c}`,h.message)}else i[l]=c}}let Kte=(()=>{class n{constructor(t,i,r={}){this.configState=t,this.cdr=i,this.options=r,this.initialized=!1,this.configManager=new Yte(this.configState,this.options)}ngOnInit(){var t;this._init=setTimeout(()=>this.initialize(),null!==(t=this.options.initialDelay)&&void 0!==t?t:0)}ngOnDestroy(){this._init&&clearTimeout(this._init)}ngOnChanges(t){this.configManager.addChanges(t),this.initialized&&this.configManager.applyChanges()}initialize(){this._init=void 0,!this.initialized&&(this.configManager.applyChanges(),this.initialized=!0,this.cdr.markForCheck())}}return n.\u0275fac=function(t){!function(){throw new Error("invalid")}()},n.\u0275dir=kt({type:n,features:[zi]}),n})();const DD={boolean:n=>"false"!=`${n}`,json:n=>"string"==typeof n?JSON.parse(n):n,function:n=>{if("function"!=typeof n)throw new Error("Expected a javascript function");return n}};var ID;const Cf={production:!0,disableDbWorker:!0,acceptableViewerDomains:["https://portal.hubmapconsortium.org","https://portal.test.hubmapconsortium.org"],dbOptions:{ccfOwlUrl:"https://cdn.jsdelivr.net/gh/hubmapconsortium/ccf-ui@staging/assets/ccf.owl.n3store.json",ccfContextUrl:"https://hubmapconsortium.github.io/hubmap-ontology/ccf-context.jsonld",dataSources:["https://cdn.jsdelivr.net/gh/hubmapconsortium/ccf-ui@staging/assets/kpmp/data/rui_locations.jsonld","https://cdn.jsdelivr.net/gh/hubmapconsortium/ccf-ui@staging/assets/sparc/data/rui_locations.jsonld"],hubmapDataService:"",hubmapPortalUrl:"",hubmapDataUrl:"",hubmapAssetsUrl:"",hubmapToken:null!==(ID=localStorage.getItem("HUBMAP_TOKEN"))&&void 0!==ID?ID:"",useRemoteApi:!1,remoteApiEndpoint:"https://ccf-api--staging.herokuapp.com/v1"},googleAnalyticsToken:"G-ERNVZ1Q4KE"};function Nr(n,e,t,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,t):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s}function zB(n,e){return function(t,i){e(t,i,n)}}function rc(n,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(n,e)}function Ni(n,e,t,i){return new(t||(t=Promise))(function(s,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?s(u.value):function(s){return s instanceof t?s:new t(function(o){o(s)})}(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})}function $B(n){if("undefined"!=typeof window&&"object"==typeof window.process&&"renderer"===window.process.type||"undefined"!=typeof process&&"object"==typeof process.versions&&Boolean(process.versions.electron))return!0;const e="object"==typeof navigator&&"string"==typeof navigator.userAgent&&navigator.userAgent,t=n||e;return!!(t&&t.indexOf("Electron")>=0)}function RD(){return!("object"==typeof process&&"[object process]"===String(process)&&!process.browser)||$B()}const WB="undefined"!=typeof __VERSION__?__VERSION__:"untranspiled source",WE=RD();class Jte{constructor(e,t,i="sessionStorage"){this.storage=function(n){try{const e=window[n],t="__storage_test__";return e.setItem(t,t),e.removeItem(t),e}catch(e){return null}}(i),this.id=e,this.config={},Object.assign(this.config,t),this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){return this.config={},this.updateConfiguration(e)}updateConfiguration(e){if(Object.assign(this.config,e),this.storage){const t=JSON.stringify(this.config);this.storage.setItem(this.id,t)}return this}_loadConfiguration(){let e={};if(this.storage){const t=this.storage.getItem(this.id);e=t?JSON.parse(t):{}}return Object.assign(this.config,e),this}}function ND(n,e,t,i=600){const r=n.src.replace(/\(/g,"%28").replace(/\)/g,"%29");n.width>i&&(t=Math.min(t,i/n.width));const s=n.width*t,o=n.height*t,a=["font-size:1px;","padding:".concat(Math.floor(o/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(o,"px;"),"background:url(".concat(r,");"),"background-size:".concat(s,"px ").concat(o,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),a]}const qB={BLACK:30,RED:31,GREEN:32,YELLOW:33,BLUE:34,MAGENTA:35,CYAN:36,WHITE:37,BRIGHT_BLACK:90,BRIGHT_RED:91,BRIGHT_GREEN:92,BRIGHT_YELLOW:93,BRIGHT_BLUE:94,BRIGHT_MAGENTA:95,BRIGHT_CYAN:96,BRIGHT_WHITE:97};function YB(n){return"string"==typeof n?qB[n.toUpperCase()]||qB.WHITE:n}function qE(n,e){if(!n)throw new Error(e||"Assertion failed")}const sc={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document,process:"object"==typeof process&&process},a0=sc.window||sc.self||sc.global,KB=sc.process||{};function Og(){let n;if(WE&&a0.performance)n=a0.performance.now();else if(KB.hrtime){const e=KB.hrtime();n=1e3*e[0]+e[1]/1e6}else n=Date.now();return n}console;const Rg={debug:WE&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},one={enabled:!0,level:0};function El(){}const XB={},QB={once:!0};function ane(n){for(const e in n)for(const t in n[e])return t||"untitled";return"empty"}let PD=(()=>{class n{constructor({id:t}={id:""}){this.id=t,this.VERSION=WB,this._startTs=Og(),this._deltaTs=Og(),this.LOG_THROTTLE_TIMEOUT=0,this._storage=new Jte("__probe-".concat(this.id,"__"),one),this.userData={},this.timeStamp("".concat(this.id," started")),function(n,e=["constructor"]){const t=Object.getPrototypeOf(n),i=Object.getOwnPropertyNames(t);for(const r of i)"function"==typeof n[r]&&(e.find(s=>r===s)||(n[r]=n[r].bind(n)))}(this),Object.seal(this)}set level(t){this.setLevel(t)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((Og()-this._startTs).toPrecision(10))}getDelta(){return Number((Og()-this._deltaTs).toPrecision(10))}set priority(t){this.level=t}get priority(){return this.level}getPriority(){return this.level}enable(t=!0){return this._storage.updateConfiguration({enabled:t}),this}setLevel(t){return this._storage.updateConfiguration({level:t}),this}assert(t,i){qE(t,i)}warn(t){return this._getLogFunction(0,t,Rg.warn,arguments,QB)}error(t){return this._getLogFunction(0,t,Rg.error,arguments)}deprecated(t,i){return this.warn("`".concat(t,"` is deprecated and will be removed in a later version. Use `").concat(i,"` instead"))}removed(t,i){return this.error("`".concat(t,"` has been removed. Use `").concat(i,"` instead"))}probe(t,i){return this._getLogFunction(t,i,Rg.log,arguments,{time:!0,once:!0})}log(t,i){return this._getLogFunction(t,i,Rg.debug,arguments)}info(t,i){return this._getLogFunction(t,i,console.info,arguments)}once(t,i){return this._getLogFunction(t,i,Rg.debug||Rg.info,arguments,QB)}table(t,i,r){return i?this._getLogFunction(t,i,console.table||El,r&&[r],{tag:ane(i)}):El}image({logLevel:t,priority:i,image:r,message:s="",scale:o=1}){return this._shouldLog(t||i)?WE?function({image:n,message:e="",scale:t=1}){if("string"==typeof n){const r=new Image;return r.onload=()=>{const s=ND(r,e,t);console.log(...s)},r.src=n,El}const i=n.nodeName||"";if("img"===i.toLowerCase())return console.log(...ND(n,e,t)),El;if("canvas"===i.toLowerCase()){const r=new Image;return r.onload=()=>console.log(...ND(r,e,t)),r.src=n.toDataURL(),El}return El}({image:r,message:s,scale:o}):function({image:n,message:e="",scale:t=1}){let i=null;try{i=nt(307)}catch(r){}return i?()=>i(n,{fit:"box",width:"".concat(Math.round(80*t),"%")}).then(r=>console.log(r)):El}({image:r,message:s,scale:o}):El}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}get(t){return this._storage.config[t]}set(t,i){this._storage.updateConfiguration({[t]:i})}time(t,i){return this._getLogFunction(t,i,console.time?console.time:console.info)}timeEnd(t,i){return this._getLogFunction(t,i,console.timeEnd?console.timeEnd:console.info)}timeStamp(t,i){return this._getLogFunction(t,i,console.timeStamp||El)}group(t,i,r={collapsed:!1}){r=JB({logLevel:t,message:i,opts:r});const{collapsed:s}=r;return r.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(r)}groupCollapsed(t,i,r={}){return this.group(t,i,Object.assign({},r,{collapsed:!0}))}groupEnd(t){return this._getLogFunction(t,"",console.groupEnd||El)}withGroup(t,i,r){this.group(t,i)();try{r()}finally{this.groupEnd(t)()}}trace(){console.trace&&console.trace()}_shouldLog(t){return this.isEnabled()&&this.getLevel()>=ZB(t)}_getLogFunction(t,i,r,s=[],o){if(this._shouldLog(t)){o=JB({logLevel:t,message:i,args:s,opts:o}),qE(r=r||o.method),o.total=this.getTotal(),o.delta=this.getDelta(),this._deltaTs=Og();const a=o.tag||o.message;if(o.once){if(XB[a])return El;XB[a]=Og()}return i=function(n,e,t){if("string"==typeof e){const i=t.time?function(n,e=8){const t=Math.max(e-n.length,0);return"".concat(" ".repeat(t)).concat(n)}(function(n){let e;return e=n<10?"".concat(n.toFixed(2),"ms"):n<100?"".concat(n.toFixed(1),"ms"):n<1e3?"".concat(n.toFixed(0),"ms"):"".concat((n/1e3).toFixed(2),"s"),e}(t.total)):"";e=function(n,e,t){return!WE&&"string"==typeof n&&(e&&(e=YB(e),n="\x1b[".concat(e,"m").concat(n,"\x1b[39m")),t&&(e=YB(t),n="\x1b[".concat(t+10,"m").concat(n,"\x1b[49m"))),n}(e=t.time?"".concat(n,": ").concat(i,"  ").concat(e):"".concat(n,": ").concat(e),t.color,t.background)}return e}(this.id,o.message,o),r.bind(console,i,...o.args)}return El}}return n.VERSION=WB,n})();function ZB(n){if(!n)return 0;let e;switch(typeof n){case"number":e=n;break;case"object":e=n.logLevel||n.priority||0;break;default:return 0}return qE(Number.isFinite(e)&&e>=0),e}function JB(n){const{logLevel:e,message:t}=n;n.logLevel=ZB(e);const i=n.args?Array.from(n.args):[];for(;i.length&&i.shift()!==t;);switch(n.args=i,typeof e){case"string":case"function":void 0!==t&&i.unshift(t),n.message=e;break;case"object":Object.assign(n,e)}"function"==typeof n.message&&(n.message=n.message());const r=typeof n.message;return qE("string"===r||"object"===r),Object.assign(n,n.opts)}const Bi=new PD({id:"deck"}),Pi={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(Pi,"IDENTITY",{get:()=>Bi.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")()||0});const qc={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},eV={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},fn=new PD({id:"luma.gl"});function Uo(n,e){if(!n)throw new Error(e||"luma.gl: assertion failed.")}function YE(n){return"undefined"!=typeof WebGLRenderingContext&&n instanceof WebGLRenderingContext||"undefined"!=typeof WebGL2RenderingContext&&n instanceof WebGL2RenderingContext||Boolean(n&&Number.isFinite(n._version))}function yi(n){return"undefined"!=typeof WebGL2RenderingContext&&n instanceof WebGL2RenderingContext||Boolean(n&&2===n._version)}function KE(n){return Uo(YE(n),"Invalid WebGLRenderingContext"),n}function zo(n){return Uo(yi(n),"Requires WebGL2"),n}var Sr=nt(761);const l0={};const c0=function n(e){const t=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(let i=0;i<this.attribs.length;i++){const r=new n.VertexAttrib(t);this.attribs[i]=r}this.maxAttrib=0};(c0.VertexAttrib=function(e){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()}).prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const Tf=function(e){const t=this;this.gl=e,function(n){const e=n.getError;n.getError=function(){let i;do{i=e.apply(n),0!==i&&(l0[i]=!0)}while(0!==i);for(i in l0)if(l0[i])return delete l0[i],parseInt(i,10);return 0}}(e);const i=this.original={getParameter:e.getParameter,enableVertexAttribArray:e.enableVertexAttribArray,disableVertexAttribArray:e.disableVertexAttribArray,bindBuffer:e.bindBuffer,getVertexAttrib:e.getVertexAttrib,vertexAttribPointer:e.vertexAttribPointer};e.getParameter=function(s){return s===t.VERTEX_ARRAY_BINDING_OES?t.currentVertexArrayObject===t.defaultVertexArrayObject?null:t.currentVertexArrayObject:i.getParameter.apply(this,arguments)},e.enableVertexAttribArray=function(s){const o=t.currentVertexArrayObject;o.maxAttrib=Math.max(o.maxAttrib,s);const a=o.attribs[s];return a.enabled=!0,i.enableVertexAttribArray.apply(this,arguments)},e.disableVertexAttribArray=function(s){const o=t.currentVertexArrayObject;o.maxAttrib=Math.max(o.maxAttrib,s);const a=o.attribs[s];return a.enabled=!1,i.disableVertexAttribArray.apply(this,arguments)},e.bindBuffer=function(s,o){switch(s){case 34962:t.currentArrayBuffer=o;break;case 34963:t.currentVertexArrayObject.elementArrayBuffer=o}return i.bindBuffer.apply(this,arguments)},e.getVertexAttrib=function(s,o){const l=t.currentVertexArrayObject.attribs[s];switch(o){case 34975:return l.buffer;case 34338:return l.enabled;case 34339:return l.size;case 34340:return l.stride;case 34341:return l.type;case 34922:return l.normalized;default:return i.getVertexAttrib.apply(this,arguments)}},e.vertexAttribPointer=function(s,o,a,l,c,u){const h=t.currentVertexArrayObject;h.maxAttrib=Math.max(h.maxAttrib,s);const p=h.attribs[s];return p.buffer=t.currentArrayBuffer,p.size=o,p.type=a,p.normalized=l,p.stride=c,p.offset=u,p.recache(),i.vertexAttribPointer.apply(this,arguments)},e.instrumentExtension&&e.instrumentExtension(this,"OES_vertex_array_object"),e.canvas&&e.canvas.addEventListener("webglcontextrestored",()=>{Sr.CO.console&&Sr.CO.console.log&&Sr.CO.console.log("OESVertexArrayObject emulation library context restored"),t.reset_()},!0),this.reset_()};Tf.prototype.VERTEX_ARRAY_BINDING_OES=34229,Tf.prototype.reset_=function(){if(void 0!==this.vertexArrayObjects)for(let i=0;i<this.vertexArrayObjects.length;++i)this.vertexArrayObjects.isAlive=!1;this.maxVertexAttribs=this.gl.getParameter(34921),this.defaultVertexArrayObject=new c0(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)},Tf.prototype.createVertexArrayOES=function(){const e=new c0(this);return this.vertexArrayObjects.push(e),e},Tf.prototype.deleteVertexArrayOES=function(e){e.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(e),1),this.currentVertexArrayObject===e&&this.bindVertexArrayOES(null)},Tf.prototype.isVertexArrayOES=function(e){return!!(e&&e instanceof c0&&e.hasBeenBound&&e.ext===this)},Tf.prototype.bindVertexArrayOES=function(e){const t=this.gl;if(e&&!e.isAlive)return void function(n,e){l0[n]=!0,void 0!==e&&function(n){Sr.CO.console&&Sr.CO.console.error&&Sr.CO.console.error(n)}(e)}(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");const i=this.original,r=this.currentVertexArrayObject;this.currentVertexArrayObject=e||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const s=this.currentVertexArrayObject;if(r===s)return;(!r||s.elementArrayBuffer!==r.elementArrayBuffer)&&i.bindBuffer.call(t,34963,s.elementArrayBuffer);let o=this.currentArrayBuffer;const a=Math.max(r?r.maxAttrib:0,s.maxAttrib);for(let l=0;l<=a;l++){const c=s.attribs[l],u=r?r.attribs[l]:null;if((!r||c.enabled!==u.enabled)&&(c.enabled?i.enableVertexAttribArray.call(t,l):i.disableVertexAttribArray.call(t,l)),c.enabled){let h=!1;(!r||c.buffer!==u.buffer)&&(o!==c.buffer&&(i.bindBuffer.call(t,34962,c.buffer),o=c.buffer),h=!0),(h||c.cached!==u.cached)&&i.vertexAttribPointer.call(t,l,c.size,c.type,c.normalized,c.stride,c.offset)}}this.currentArrayBuffer!==o&&i.bindBuffer.call(t,34962,this.currentArrayBuffer)};const tV="OES_element_index",nV="WEBGL_draw_buffers",iV="WEBGL_debug_renderer_info",fr=n=>yi(n)?void 0:0,Mne={3074:n=>yi(n)?void 0:36064,35723:n=>yi(n)?void 0:4352,35977:fr,32937:fr,36795:(n,e)=>{const t=yi(n)?n.getExtension("EXT_disjoint_timer_query_webgl2"):n.getExtension("EXT_disjoint_timer_query");return t&&t.GPU_DISJOINT_EXT?e(t.GPU_DISJOINT_EXT):0},37445:(n,e)=>{const t=n.getExtension(iV);return e(t&&t.UNMASKED_VENDOR_WEBGL||7936)},37446:(n,e)=>{const t=n.getExtension(iV);return e(t&&t.UNMASKED_RENDERER_WEBGL||7937)},34047:(n,e)=>{const t=n.luma.extensions.EXT_texture_filter_anisotropic;return t?e(t.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},32883:fr,35071:fr,37447:fr,36063:(n,e)=>{if(!yi(n)){const t=n.getExtension(nV);return t?e(t.MAX_COLOR_ATTACHMENTS_WEBGL):0}},35379:fr,35374:fr,35377:fr,34852:n=>{if(!yi(n)){const e=n.getExtension(nV);return e?e.MAX_DRAW_BUFFERS_WEBGL:0}},36203:n=>n.getExtension(tV)?2147483647:65535,33001:n=>n.getExtension(tV)?16777216:65535,33e3:n=>16777216,37157:fr,35373:fr,35657:fr,36183:fr,37137:fr,34045:fr,35978:fr,35979:fr,35968:fr,35376:fr,35375:fr,35659:fr,37154:fr,35371:fr,35658:fr,35076:fr,35077:fr,35380:fr},rV="ANGLE_instanced_arrays",sV={OES_vertex_array_object:{meta:{suffix:"OES"},createVertexArray:()=>{Uo(!1,"VertexArray requires WebGL2 or OES_vertex_array_object extension")},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[rV]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(n,e){Uo(0===e,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},WEBGL_draw_buffers:{meta:{suffix:"WEBGL"},drawBuffers:()=>{Uo(!1)}},EXT_disjoint_timer_query:{meta:{suffix:"EXT"},createQuery:()=>{Uo(!1)},deleteQuery:()=>{Uo(!1)},beginQuery:()=>{Uo(!1)},endQuery:()=>{},getQuery(n,e){return this.getQueryObject(n,e)},getQueryParameter(n,e){return this.getQueryObject(n,e)},getQueryObject:()=>{}}},FD={readBuffer:(n,e,t)=>{yi(n)&&e(t)},getVertexAttrib:(n,e,t,i)=>{const{webgl2:r,ext:s}=function(n,e){return{webgl2:yi(n),ext:n.getExtension("ANGLE_instanced_arrays")}}(n);let o;switch(i){case 35069:o=!!r&&void 0;break;case 35070:o=r||s?void 0:0}return void 0!==o?o:e(t,i)},getProgramParameter:(n,e,t,i)=>{if(!yi(n))switch(i){case 35967:return 35981;case 35971:case 35382:return 0}return e(t,i)},getInternalformatParameter:(n,e,t,i,r)=>{if(!yi(n))switch(r){case 32937:return new Int32Array([0])}return n.getInternalformatParameter(t,i,r)},getTexParameter(n,e,t,i){switch(i){case 34046:const{extensions:r}=n.luma,s=r.EXT_texture_filter_anisotropic;i=s&&s.TEXTURE_MAX_ANISOTROPY_EXT||34046}return e(t,i)},getParameter:function(n,e,t){const i=Mne[t],r="function"==typeof i?i(n,e,t):i;return void 0!==r?r:e(t)},hint:(n,e,t,i)=>e(t,i)};function Une(n,{extension:e,target:t,target2:i}){const r=sV[e];Uo(r);const{meta:s={}}=r,{suffix:o=""}=s,a=n.getExtension(e);for(const l of Object.keys(r)){const c=`${l}${o}`;let u=null;"meta"===l||"function"==typeof n[l]||(a&&"function"==typeof a[c]?u=(...h)=>a[c](...h):"function"==typeof r[l]&&(u=r[l].bind(t))),u&&(t[l]=u,i[l]=u)}}("undefined"!=typeof global?global:window).polyfillContext=function(n){n.luma=n.luma||{};const{luma:e}=n;return e.polyfilled||(function(n){if("function"==typeof n.createVertexArray)return;const e=n.getSupportedExtensions;n.getSupportedExtensions=function(){const r=e.call(this)||[];return r.indexOf("OES_vertex_array_object")<0&&r.push("OES_vertex_array_object"),r};const t=n.getExtension;n.getExtension=function(r){return t.call(this,r)||("OES_vertex_array_object"!==r?null:(n.__OESVertexArrayObject||(this.__OESVertexArrayObject=new Tf(this)),this.__OESVertexArrayObject))}}(n),function(n){n.luma.extensions={};const e=n.getSupportedExtensions()||[];for(const t of e)n.luma[t]=n.getExtension(t)}(n),function(n,e){for(const t of Object.getOwnPropertyNames(e))"overrides"!==t&&Une(n,{extension:t,target:n.luma,target2:n})}(n,sV),function(n,{target:e,target2:t}){Object.keys(FD).forEach(i=>{if("function"==typeof FD[i]){const r=n[i]?n[i].bind(n):()=>{},s=FD[i].bind(null,n,r);e[i]=s,t[i]=s}})}(n,{target:e,target2:n}),e.polyfilled=!0),n};const LD={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,36006:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],3333:4,3317:4,37440:!1,37441:!1,37443:37444,35723:4352,36010:null,35977:!1,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},sh=(n,e,t)=>e?n.enable(t):n.disable(t),oV=(n,e,t)=>n.hint(t,e),Na=(n,e,t)=>n.pixelStorei(t,e);function u0(n){return Array.isArray(n)||ArrayBuffer.isView(n)}const Gne={3042:sh,32773:(n,e)=>n.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(n,e)=>n.clearColor(...e),3107:(n,e)=>n.colorMask(...e),2884:sh,2885:(n,e)=>n.cullFace(e),2929:sh,2931:(n,e)=>n.clearDepth(e),2932:(n,e)=>n.depthFunc(e),2928:(n,e)=>n.depthRange(...e),2930:(n,e)=>n.depthMask(e),3024:sh,35723:oV,36006:(n,e)=>{const t=yi(n)?36009:36160;return n.bindFramebuffer(t,e)},2886:(n,e)=>n.frontFace(e),33170:oV,2849:(n,e)=>n.lineWidth(e),32823:sh,32824:"polygonOffset",10752:"polygonOffset",35977:sh,32938:"sampleCoverage",32939:"sampleCoverage",3089:sh,3088:(n,e)=>n.scissor(...e),2960:sh,2961:(n,e)=>n.clearStencil(e),2968:(n,e)=>n.stencilMaskSeparate(1028,e),36005:(n,e)=>n.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(n,e)=>n.viewport(...e),3333:Na,3317:Na,37440:Na,37441:Na,37443:Na,3330:Na,3332:Na,3331:Na,36010:(n,e)=>n.bindFramebuffer(36008,e),3314:Na,32878:Na,3316:Na,3315:Na,32877:Na,framebuffer:(n,e)=>n.bindFramebuffer(36160,e&&"handle"in e?e.handle:e),blend:(n,e)=>e?n.enable(3042):n.disable(3042),blendColor:(n,e)=>n.blendColor(...e),blendEquation:(n,e)=>{e=u0(e)?e:[e,e],n.blendEquationSeparate(...e)},blendFunc:(n,e)=>{e=u0(e)&&2===e.length?[...e,...e]:e,n.blendFuncSeparate(...e)},clearColor:(n,e)=>n.clearColor(...e),clearDepth:(n,e)=>n.clearDepth(e),clearStencil:(n,e)=>n.clearStencil(e),colorMask:(n,e)=>n.colorMask(...e),cull:(n,e)=>e?n.enable(2884):n.disable(2884),cullFace:(n,e)=>n.cullFace(e),depthTest:(n,e)=>e?n.enable(2929):n.disable(2929),depthFunc:(n,e)=>n.depthFunc(e),depthMask:(n,e)=>n.depthMask(e),depthRange:(n,e)=>n.depthRange(...e),dither:(n,e)=>e?n.enable(3024):n.disable(3024),derivativeHint:(n,e)=>{n.hint(35723,e)},frontFace:(n,e)=>n.frontFace(e),mipmapHint:(n,e)=>n.hint(33170,e),lineWidth:(n,e)=>n.lineWidth(e),polygonOffsetFill:(n,e)=>e?n.enable(32823):n.disable(32823),polygonOffset:(n,e)=>n.polygonOffset(...e),sampleCoverage:(n,e)=>n.sampleCoverage(...e),scissorTest:(n,e)=>e?n.enable(3089):n.disable(3089),scissor:(n,e)=>n.scissor(...e),stencilTest:(n,e)=>e?n.enable(2960):n.disable(2960),stencilMask:(n,e)=>{e=u0(e)?e:[e,e];const[t,i]=e;n.stencilMaskSeparate(1028,t),n.stencilMaskSeparate(1029,i)},stencilFunc:(n,e)=>{e=u0(e)&&3===e.length?[...e,...e]:e;const[t,i,r,s,o,a]=e;n.stencilFuncSeparate(1028,t,i,r),n.stencilFuncSeparate(1029,s,o,a)},stencilOp:(n,e)=>{e=u0(e)&&3===e.length?[...e,...e]:e;const[t,i,r,s,o,a]=e;n.stencilOpSeparate(1028,t,i,r),n.stencilOpSeparate(1029,s,o,a)},viewport:(n,e)=>n.viewport(...e)};function ns(n,e,t){return void 0!==e[n]?e[n]:t[n]}const $ne={blendEquation:(n,e,t)=>n.blendEquationSeparate(ns(32777,e,t),ns(34877,e,t)),blendFunc:(n,e,t)=>n.blendFuncSeparate(ns(32969,e,t),ns(32968,e,t),ns(32971,e,t),ns(32970,e,t)),polygonOffset:(n,e,t)=>n.polygonOffset(ns(32824,e,t),ns(10752,e,t)),sampleCoverage:(n,e,t)=>n.sampleCoverage(ns(32938,e,t),ns(32939,e,t)),stencilFuncFront:(n,e,t)=>n.stencilFuncSeparate(1028,ns(2962,e,t),ns(2967,e,t),ns(2963,e,t)),stencilFuncBack:(n,e,t)=>n.stencilFuncSeparate(1029,ns(34816,e,t),ns(36003,e,t),ns(36004,e,t)),stencilOpFront:(n,e,t)=>n.stencilOpSeparate(1028,ns(2964,e,t),ns(2965,e,t),ns(2966,e,t)),stencilOpBack:(n,e,t)=>n.stencilOpSeparate(1029,ns(34817,e,t),ns(34818,e,t),ns(34819,e,t))},aV={enable:(n,e)=>n({[e]:!0}),disable:(n,e)=>n({[e]:!1}),pixelStorei:(n,e,t)=>n({[e]:t}),hint:(n,e,t)=>n({[e]:t}),bindFramebuffer:(n,e,t)=>{switch(e){case 36160:return n({36006:t,36010:t});case 36009:return n({36006:t});case 36008:return n({36010:t});default:return null}},blendColor:(n,e,t,i,r)=>n({32773:new Float32Array([e,t,i,r])}),blendEquation:(n,e)=>n({32777:e,34877:e}),blendEquationSeparate:(n,e,t)=>n({32777:e,34877:t}),blendFunc:(n,e,t)=>n({32969:e,32968:t,32971:e,32970:t}),blendFuncSeparate:(n,e,t,i,r)=>n({32969:e,32968:t,32971:i,32970:r}),clearColor:(n,e,t,i,r)=>n({3106:new Float32Array([e,t,i,r])}),clearDepth:(n,e)=>n({2931:e}),clearStencil:(n,e)=>n({2961:e}),colorMask:(n,e,t,i,r)=>n({3107:[e,t,i,r]}),cullFace:(n,e)=>n({2885:e}),depthFunc:(n,e)=>n({2932:e}),depthRange:(n,e,t)=>n({2928:new Float32Array([e,t])}),depthMask:(n,e)=>n({2930:e}),frontFace:(n,e)=>n({2886:e}),lineWidth:(n,e)=>n({2849:e}),polygonOffset:(n,e,t)=>n({32824:e,10752:t}),sampleCoverage:(n,e,t)=>n({32938:e,32939:t}),scissor:(n,e,t,i,r)=>n({3088:new Int32Array([e,t,i,r])}),stencilMask:(n,e)=>n({2968:e,36005:e}),stencilMaskSeparate:(n,e,t)=>n({[1028===e?2968:36005]:t}),stencilFunc:(n,e,t,i)=>n({2962:e,2967:t,2963:i,34816:e,36003:t,36004:i}),stencilFuncSeparate:(n,e,t,i,r)=>n({[1028===e?2962:34816]:t,[1028===e?2967:36003]:i,[1028===e?2963:36004]:r}),stencilOp:(n,e,t,i)=>n({2964:e,2965:t,2966:i,34817:e,34818:t,34819:i}),stencilOpSeparate:(n,e,t,i,r)=>n({[1028===e?2964:34817]:t,[1028===e?2965:34818]:i,[1028===e?2966:34819]:r}),viewport:(n,e,t,i,r)=>n({2978:[e,t,i,r]})},Yc=(n,e)=>n.isEnabled(e),lV={3042:Yc,2884:Yc,2929:Yc,3024:Yc,32823:Yc,32926:Yc,32928:Yc,3089:Yc,2960:Yc,35977:Yc};function cV(n){for(const e in n)return!1;return!0}function Wne(n,e){if(n===e)return!0;const t=Array.isArray(n)||ArrayBuffer.isView(n),i=Array.isArray(e)||ArrayBuffer.isView(e);if(t&&i&&n.length===e.length){for(let r=0;r<n.length;++r)if(n[r]!==e[r])return!1;return!0}return!1}function uV(n,e){const t=n[e].bind(n);n[e]=function(...r){const s=r[0];return s in n.state.cache||(n.state.cache[s]=t(...r)),n.state.enable?n.state.cache[s]:t(...r)},Object.defineProperty(n[e],"name",{value:`${e}-from-cache`,configurable:!1})}function qne(n,e,t){const i=n[e].bind(n);n[e]=function(...s){const{valueChanged:o,oldValue:a}=t(n.state._updateCache,...s);return o&&i(...s),a},Object.defineProperty(n[e],"name",{value:`${e}-to-cache`,configurable:!1})}class Kne{constructor(e,{copyState:t=!1,log:i=(()=>{})}={}){this.gl=e,this.program=null,this.stateStack=[],this.enable=!0,this.cache=t?function(n,e){if("number"==typeof(e=e||LD)){const r=e,s=lV[r];return s?s(n,r):n.getParameter(r)}const t=Array.isArray(e)?e:Object.keys(e),i={};for(const r of t){const s=lV[r];i[r]=s?s(n,Number(r)):n.getParameter(Number(r))}return i}(e):Object.assign({},LD),this.log=i,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(e={}){this.stateStack.push({})}pop(){Uo(this.stateStack.length>0),Gu(this.gl,this.stateStack[this.stateStack.length-1]),this.stateStack.pop()}_updateCache(e){let i,t=!1;const r=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const s in e){Uo(void 0!==s);const o=e[s],a=this.cache[s];Wne(o,a)||(t=!0,i=a,r&&!(s in r)&&(r[s]=a),this.cache[s]=o)}return{valueChanged:t,oldValue:i}}}function dV(n,e={}){const{enable:t=!0,copyState:i}=e;if(Uo(void 0!==i),!n.state){const r="undefined"!=typeof global?global:window,{polyfillContext:s}=r;s&&s(n),n.state=new Kne(n,{copyState:i}),function(n){const e=n.useProgram.bind(n);n.useProgram=function(i){n.state.program!==i&&(e(i),n.state.program=i)}}(n);for(const o in aV)qne(n,o,aV[o]);uV(n,"getParameter"),uV(n,"isEnabled")}return n.state.enable=t,n}function hV(n){Uo(n.state),n.state.pop()}function Gu(n,e){if(Uo(YE(n),"setParameters requires a WebGL context"),cV(e))return;const t={};for(const r in e){const s=Number(r),o=Gne[r];o&&("string"==typeof o?t[o]=!0:o(n,e[r],s))}const i=n.state&&n.state.cache;if(i)for(const r in t)$ne[r](n,e,i)}function oc(n,e,t){if(cV(e))return t(n);const{nocatch:i=!0}=e;let r;if(function(n){n.state||dV(n,{copyState:!1}),n.state.push()}(n),Gu(n,e),i)r=t(n),hV(n);else try{r=t(n)}finally{hV(n)}return r}function Ng(n){const{luma:e}=n;if(n.canvas&&e){const{clientWidth:t}=e.canvasSizeInfo;return t?n.drawingBufferWidth/t:1}return 1}function kD(n,e,t=!0){return function(n,e,t,i,r){const s=fV(n[0],e,t);let o=pV(n[1],e,i,r),a=fV(n[0]+1,e,t);const l=a===t-1?a:a-1;let c;return a=pV(n[1]+1,e,i,r),r?(a=0===a?a:a+1,c=o,o=a):c=a===i-1?a:a-1,{x:s,y:o,width:Math.max(l-s+1,1),height:Math.max(c-o+1,1)}}(e,Ng(n),n.drawingBufferWidth,n.drawingBufferHeight,t)}function fV(n,e,t){return Math.min(Math.round(n*e),t-1)}function pV(n,e,t,i){return i?Math.max(0,t-1-Math.round(n*e)):Math.min(Math.round(n*e),t-1)}const BD=(0,Sr.jU)(),tie=BD&&"undefined"!=typeof document,gV={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function mV(n={}){Uo(BD,"createGLContext only available in the browser.\nCreate your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils"),n=Object.assign({},gV,n);const{width:e,height:t}=n;function i(a){if(n.throwOnError)throw new Error(a);return console.error(a),null}let r;n.onError=i;const{canvas:s}=n,o=function({canvas:n,width:e=800,height:t=600,onError:i}){let r;return"string"==typeof n?(tie&&"complete"===document.readyState||i(`createGLContext called on canvas '${n}' before page was loaded`),r=document.getElementById(n)):n?r=n:(r=document.createElement("canvas"),r.id="lumagl-canvas",r.style.width=Number.isFinite(e)?`${e}px`:"100%",r.style.height=Number.isFinite(t)?`${t}px`:"100%",document.body.insertBefore(r,document.body.firstChild)),r}({canvas:s,width:e,height:t,onError:i});return r=function(n,e){const{onError:t}=e;let i=null;const r=l=>i=l.statusMessage||i;n.addEventListener("webglcontextcreationerror",r,!1);const{webgl1:s=!0,webgl2:o=!0}=e;let a=null;return o&&(a=a||n.getContext("webgl2",e),a=a||n.getContext("experimental-webgl2",e)),s&&(a=a||n.getContext("webgl",e),a=a||n.getContext("experimental-webgl",e)),n.removeEventListener("webglcontextcreationerror",r,!1),a?(e.onContextLost&&n.addEventListener("webglcontextlost",e.onContextLost,!1),e.onContextRestored&&n.addEventListener("webglcontextrestored",e.onContextRestored,!1),a):t(`Failed to create ${o&&!s?"WebGL2":"WebGL"} context: ${i||"Unknown error"}`)}(o,n),r?(r=VD(r,n),function(n){const e=yi(n)?"WebGL2":"WebGL1",t=function(n){const e=n.getParameter(7936),t=n.getParameter(7937),i=n.getExtension("WEBGL_debug_renderer_info");return{vendor:i&&n.getParameter(i.UNMASKED_VENDOR_WEBGL||7936)||e,renderer:i&&n.getParameter(i.UNMASKED_RENDERER_WEBGL||7937)||t,vendorMasked:e,rendererMasked:t,version:n.getParameter(7938),shadingLanguageVersion:n.getParameter(35724)}}(n);fn.info(1,`${e}${n.debug?" debug":""} context ${t?`(${t.vendor},${t.renderer})`:""}`)()}(r),r):null}function VD(n,e={}){if(!n||n._instrumented)return n;n._version=n._version||function(n){return"undefined"!=typeof WebGL2RenderingContext&&n instanceof WebGL2RenderingContext?2:1}(n),n.luma=n.luma||{},n.luma.canvasSizeInfo=n.luma.canvasSizeInfo||{},e=Object.assign({},gV,e);const{manageState:t,debug:i}=e;return t&&dV(n,{copyState:!1,log:(...r)=>fn.log(1,...r)()}),BD&&i&&(Sr.CO.makeDebugContext?(n=Sr.CO.makeDebugContext(n,e),fn.level=Math.max(fn.level,1)):fn.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),n._instrumented=!0,n}function _V(){let n;if("undefined"!=typeof window&&window.performance)n=window.performance.now();else if("undefined"!=typeof process&&process.hrtime){const e=process.hrtime();n=1e3*e[0]+e[1]/1e6}else n=Date.now();return n}class yV{constructor(e,t){this.name=e,this.type=t,this.sampleSize=1,this.reset()}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=_V(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(_V()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class jD{constructor({id:e,stats:t}){this.id=e,this.stats={},this._initializeStats(t),Object.seal(this)}get(e,t="count"){return this._getOrCreate({name:e,type:t})}get size(){return Object.keys(this.stats).length}reset(){for(const e in this.stats)this.stats[e].reset();return this}forEach(e){for(const t in this.stats)e(this.stats[t])}getTable(){const e={};return this.forEach(t=>{e[t.name]={time:t.time||0,count:t.count||0,average:t.getAverageTime()||0,hz:t.getHz()||0}}),e}_initializeStats(e=[]){e.forEach(t=>this._getOrCreate(t))}_getOrCreate(e){if(!e||!e.name)return null;const{name:t,type:i}=e;return this.stats[t]||(this.stats[t]=e instanceof yV?e:new yV(t,i)),this.stats[t]}}const d0="8.5.7",Af=new class{constructor(){this.stats=new Map}get(e){return this.stats.has(e)||this.stats.set(e,new jD({id:e})),this.stats.get(e)}};if(Sr.CO.luma&&Sr.CO.luma.VERSION!==d0)throw new Error(`luma.gl - multiple VERSIONs detected: ${Sr.CO.luma.VERSION} vs 8.5.7`);function sn(n,e){if(!n)throw new Error(e||"luma.gl: assertion failed.")}function UD(n,e){if("string"!=typeof e)return e;const t=Number(e);if(!isNaN(t))return t;const i=n[e=e.replace(/^.*\./,"")];return sn(void 0!==i,`Accessing undefined constant GL.${e}`),i}function oh(n,e){e=Number(e);for(const t in n)if(n[t]===e)return`GL.${t}`;return String(e)}Sr.CO.luma||((0,Sr.jU)()&&fn.log(1,"luma.gl 8.5.7 - set luma.log.level=1 (or higher) to trace rendering")(),Sr.CO.luma=Sr.CO.luma||{VERSION:d0,version:d0,log:fn,stats:Af,globals:{modules:{},nodeIO:{}}});const zD={};function Kc(n="id"){return zD[n]=zD[n]||1,`${n}-${zD[n]++}`}function vV(n){return sn("number"==typeof n,"Input must be a number"),n&&0==(n&n-1)}function Pg(n){let e=!0;for(const t in n){e=!1;break}return e}function bV(n,e,t,i){const r=`See luma.gl ${t} Upgrade Guide at https://luma.gl/docs/upgrade-guide`,s=Object.getPrototypeOf(n);i.forEach(o=>{s.methodName||(s[o]=()=>{throw fn.removed(`Calling removed method ${e}.${o}: `,r)(),new Error(o)})})}const Fg="Resource subclass must define virtual methods";class $u{constructor(e,t={}){KE(e);const{id:i,userData:r={}}=t;this.gl=e,this.gl2=e,this.id=i||Kc(this.constructor.name),this.userData=r,this._bound=!1,this._handle=t.handle,void 0===this._handle&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return`${this.constructor.name}(${this.id})`}get handle(){return this._handle}delete({deleteChildren:e=!1}={}){const t=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,t&&e&&t.filter(Boolean).forEach(i=>i.delete()),this}bind(e=this.handle){if("function"!=typeof e)return this._bindHandle(e),this;let t;return this._bound?t=e():(this._bindHandle(this.handle),this._bound=!0,t=e(),this._bound=!1,this._bindHandle(null)),t}unbind(){this.bind(null)}getParameter(e,t={}){sn(e=UD(this.gl,e));const r=(this.constructor.PARAMETERS||{})[e];if(r){const s=yi(this.gl);if("webgl2"in r&&!s||"extension"in r&&!this.gl.getExtension(r.extension)){const a=r.webgl1,l="webgl2"in r?r.webgl2:r.webgl1;return s?l:a}}return this._getParameter(e,t)}getParameters(e={}){const{parameters:t,keys:i}=e,r=this.constructor.PARAMETERS||{},s=yi(this.gl),o={},a=t||Object.keys(r);for(const l of a){const c=r[l];if(c&&(!("webgl2"in c)||s)&&(!("extension"in c)||this.gl.getExtension(c.extension))){const h=i?oh(this.gl,l):l;o[h]=this.getParameter(l,e),i&&"GLenum"===c.type&&(o[h]=oh(this.gl,o[h]))}}return o}setParameter(e,t){sn(e=UD(this.gl,e));const r=(this.constructor.PARAMETERS||{})[e];if(r){const s=yi(this.gl);if("webgl2"in r&&!s||"extension"in r&&!this.gl.getExtension(r.extension))throw new Error("Parameter not available on this platform");"GLenum"===r.type&&(t=UD(t))}return this._setParameter(e,t),this}setParameters(e){for(const t in e)this.setParameter(t,e[t]);return this}stubRemovedMethods(e,t,i){return bV(this,e,t,i)}initialize(e){}_createHandle(){throw new Error(Fg)}_deleteHandle(){throw new Error(Fg)}_bindHandle(e){throw new Error(Fg)}_getOptsFromHandle(){throw new Error(Fg)}_getParameter(e,t){throw new Error(Fg)}_setParameter(e,t){throw new Error(Fg)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const e=this.constructor.name,t=Af.get("Resource Counts");t.get("Resources Created").incrementCount(),t.get(`${e}s Created`).incrementCount(),t.get(`${e}s Active`).incrementCount()}_removeStats(){const e=this.constructor.name;Af.get("Resource Counts").get(`${e}s Active`).decrementCount()}_trackAllocatedMemory(e,t=this.constructor.name){const i=Af.get("Memory Usage");i.get("GPU Memory").addCount(e),i.get(`${t} Memory`).addCount(e),this.byteLength=e}_trackDeallocatedMemory(e=this.constructor.name){const t=Af.get("Memory Usage");t.get("GPU Memory").subtractCount(this.byteLength),t.get(`${e} Memory`).subtractCount(this.byteLength),this.byteLength=0}}function HD(n){switch(ArrayBuffer.isView(n)?n.constructor:n){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error("Failed to deduce GL constant from typed array")}}function h0(n,{clamped:e=!0}={}){switch(n){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return e?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function fie({data:n,width:e,height:t}){const i=Math.round(e/2),r=Math.round(t/2),s=new Uint8Array(i*r*4);for(let o=0;o<r;o++)for(let a=0;a<i;a++)for(let l=0;l<4;l++)s[4*(o*i+a)+l]=n[4*(2*o*e+2*a)+l];return{data:s,width:i,height:r}}function GD(n,e,t){const{removedProps:i={},deprecatedProps:r={},replacedProps:s={}}=t;for(const a in i)a in e&&fn.removed(`${n}.${a}`,i[a]?`${n}.${i[a]}`:"N/A")();for(const a in r)a in e&&fn.deprecated(`${n}.${a}`,`${n}.${r[a]}`)();let o=null;for(const a in s)if(a in e){const l=s[a];fn.deprecated(`${n}.${a}`,`${n}.${l}`)(),o=o||Object.assign({},e),o[l]=e[a],delete o[a]}return o||e}const pie={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},gie={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class da{static getBytesPerElement(e){return h0(e.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(e){return sn(e.size),h0(e.type||5126).BYTES_PER_ELEMENT*e.size}static resolve(...e){return new da(...[pie,...e])}constructor(...e){e.forEach(t=>this._assign(t)),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return da.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return da.getBytesPerVertex(this)}_assign(e={}){return void 0!==(e=GD("Accessor",e,gie)).type&&(this.type=e.type,(5124===e.type||5125===e.type)&&(this.integer=!0)),void 0!==e.size&&(this.size=e.size),void 0!==e.offset&&(this.offset=e.offset),void 0!==e.stride&&(this.stride=e.stride),void 0!==e.normalized&&(this.normalized=e.normalized),void 0!==e.integer&&(this.integer=e.integer),void 0!==e.divisor&&(this.divisor=e.divisor),void 0!==e.buffer&&(this.buffer=e.buffer),void 0!==e.index&&(this.index="boolean"==typeof e.index?e.index?1:0:e.index),void 0!==e.instanced&&(this.divisor=e.instanced?1:0),void 0!==e.isInstanced&&(this.divisor=e.isInstanced?1:0),this}}const EV={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},mie={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:EV},_ie={removedProps:EV};class or extends $u{constructor(e,t={}){super(e,t),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=t.target||(this.gl.webgl2?36662:34962),this.initialize(t),Object.seal(this)}getElementCount(e=this.accessor){return Math.round(this.byteLength/da.getBytesPerElement(e))}getVertexCount(e=this.accessor){return Math.round(this.byteLength/da.getBytesPerVertex(e))}initialize(e={}){return ArrayBuffer.isView(e)&&(e={data:e}),Number.isFinite(e)&&(e={byteLength:e}),e=GD("Buffer",e,mie),this.usage=e.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},e,e.accessor)),e.data?this._setData(e.data,e.offset,e.byteLength):this._setByteLength(e.byteLength||0),this}setProps(e){return"accessor"in(e=GD("Buffer",e,_ie))&&this.setAccessor(e.accessor),this}setAccessor(e){return delete(e=Object.assign({},e)).buffer,this.accessor=new da(e),this}reallocate(e){return e>this.byteLength?(this._setByteLength(e),!0):(this.bytesUsed=e,!1)}setData(e){return this.initialize(e)}subData(e){ArrayBuffer.isView(e)&&(e={data:e});const{data:t,offset:i=0,srcOffset:r=0}=e,s=e.byteLength||e.length;sn(t);const o=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(o,this.handle),0!==r||void 0!==s?(zo(this.gl),this.gl.bufferSubData(this.target,i,t,r,s)):this.gl.bufferSubData(o,i,t),this.gl.bindBuffer(o,null),this.debugData=null,this._inferType(t),this}copyData({sourceBuffer:e,readOffset:t=0,writeOffset:i=0,size:r}){const{gl:s}=this;return zo(s),s.bindBuffer(36662,e.handle),s.bindBuffer(36663,this.handle),s.copyBufferSubData(36662,36663,t,i,r),s.bindBuffer(36662,null),s.bindBuffer(36663,null),this.debugData=null,this}getData({dstData:e=null,srcByteOffset:t=0,dstOffset:i=0,length:r=0}={}){zo(this.gl);const s=h0(this.accessor.type||5126,{clamped:!1}),o=this._getAvailableElementCount(t),a=i;let l,c;e?(c=e.length,l=c-a):(l=Math.min(o,r||o),c=a+l);const u=Math.min(o,l);return sn((r=r||u)<=u),e=e||new s(c),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,t,e,i,r),this.gl.bindBuffer(36662,null),e}bind({target:e=this.target,index:t=this.accessor&&this.accessor.index,offset:i=0,size:r}={}){return 35345===e||35982===e?void 0!==r?this.gl.bindBufferRange(e,t,this.handle,i,r):(sn(0===i),this.gl.bindBufferBase(e,t,this.handle)):this.gl.bindBuffer(e,this.handle),this}unbind({target:e=this.target,index:t=this.accessor&&this.accessor.index}={}){return 35345===e||35982===e?this.gl.bindBufferBase(e,t,null):this.gl.bindBuffer(e,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(10,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(e,t=0,i=e.byteLength+t){sn(ArrayBuffer.isView(e)),this._trackDeallocatedMemory();const r=this._getTarget();this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,i,this.usage),this.gl.bufferSubData(r,t,e),this.gl.bindBuffer(r,null),this.debugData=e.slice(0,10),this.bytesUsed=i,this._trackAllocatedMemory(i);const s=HD(e);return sn(s),this.setAccessor(new da(this.accessor,{type:s})),this}_setByteLength(e,t=this.usage){sn(e>=0),this._trackDeallocatedMemory();let i=e;0===e&&(i=new Float32Array(0));const r=this._getTarget();return this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,i,t),this.gl.bindBuffer(r,null),this.usage=t,this.debugData=null,this.bytesUsed=e,this._trackAllocatedMemory(e),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(e){const i=e/h0(this.accessor.type||5126,{clamped:!1}).BYTES_PER_ELEMENT;return this.getElementCount()-i}_inferType(e){this.accessor.type||this.setAccessor(new da(this.accessor,{type:HD(e)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(e){this.gl.bindBuffer(this.target,this.handle);const t=this.gl.getBufferParameter(this.target,e);return this.gl.bindBuffer(this.target,null),t}get type(){return fn.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return fn.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(e){return fn.deprecated("setByteLength","reallocate")(),this.reallocate(e)}updateAccessor(e){return fn.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new da(this.accessor,e),this}}const $D={6407:{dataFormat:6407,types:[5121,33635]},6408:{dataFormat:6408,types:[5121,32819,32820]},6406:{dataFormat:6406,types:[5121]},6409:{dataFormat:6409,types:[5121]},6410:{dataFormat:6410,types:[5121]},33326:{dataFormat:6403,types:[5126],gl2:!0},33328:{dataFormat:33319,types:[5126],gl2:!0},34837:{dataFormat:6407,types:[5126],gl2:!0},34836:{dataFormat:6408,types:[5126],gl2:!0}},SV={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},xV={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1},bie=[9729,9728],CV=Sr.CO.WebGLBuffer||function(){};class Lg extends $u{static isSupported(e,t={}){const{format:i,linearFiltering:r}=t;let s=!0;return i&&(s=s&&function(n,e){const t=$D[e];if(!t)return!1;if(void 0===t.gl1&&void 0===t.gl2)return!0;const i=yi(n)&&t.gl2||t.gl1;return"string"==typeof i?n.getExtension(i):i}(e,i),s=s&&(!r||function(n,e){const t=$D[e];switch(t&&t.types[0]){case 5126:return n.getExtension("OES_texture_float_linear");case 5131:return n.getExtension("OES_texture_half_float_linear");default:return!0}}(e,i))),s}constructor(e,t){const{id:i=Kc("texture"),handle:r,target:s}=t;super(e,{id:i,handle:r}),this.target=s,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return`Texture(${this.id},${this.width}x${this.height})`}initialize(e={}){let t=e.data;if(t instanceof Promise)return t.then(I=>this.initialize(Object.assign({},e,{pixels:I,data:I}))),this;const i="undefined"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement;if(i&&t.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,t.addEventListener("loadeddata",()=>this.initialize(e)),this;const{pixels:r=null,format:s=6408,border:o=0,recreate:a=!1,parameters:l={},pixelStore:c={},textureUnit:u}=e;t||(t=r);let{width:h,height:p,dataFormat:g,type:m,compressed:w=!1,mipmaps:x=!0}=e;const{depth:H=0}=e;return({width:h,height:p,compressed:w,dataFormat:g,type:m}=this._deduceParameters({format:s,type:m,dataFormat:g,compressed:w,data:t,width:h,height:p})),this.width=h,this.height=p,this.depth=H,this.format=s,this.type=m,this.dataFormat=g,this.border=o,this.textureUnit=u,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),x&&this._isNPOT()&&(fn.warn(`texture: ${this} is Non-Power-Of-Two, disabling mipmaping`)(),x=!1,this._updateForNPOT(l)),this.mipmaps=x,this.setImageData({data:t,width:h,height:p,depth:H,format:s,type:m,dataFormat:g,border:o,mipmaps:x,parameters:c,compressed:w}),x&&this.generateMipmap(),this.setParameters(l),a&&(this.data=t),i&&(this._video={video:t,parameters:l,lastTime:t.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?t.currentTime:-1}),this}update(){if(this._video){const{video:e,parameters:t,lastTime:i}=this._video;if(i===e.currentTime||e.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:e,parameters:t}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=e.currentTime}}resize({height:e,width:t,mipmaps:i=!1}){return t!==this.width||e!==this.height?this.initialize({width:t,height:e,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:i}):this}generateMipmap(e={}){return this._isNPOT()?(fn.warn(`texture: ${this} is Non-Power-Of-Two, disabling mipmaping`)(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),oc(this.gl,e,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this)}setImageData(e){this._trackDeallocatedMemory("Texture");const{target:t=this.target,pixels:i=null,level:r=0,format:s=this.format,border:o=this.border,offset:a=0,parameters:l={}}=e;let{data:c=null,type:u=this.type,width:h=this.width,height:p=this.height,dataFormat:g=this.dataFormat,compressed:m=!1}=e;c||(c=i),({type:u,dataFormat:g,compressed:m,width:h,height:p}=this._deduceParameters({format:s,type:u,dataFormat:g,compressed:m,data:c,width:h,height:p}));const{gl:w}=this;w.bindTexture(this.target,this.handle);let H,x=null;return({data:c,dataType:x}=this._getDataType({data:c,compressed:m})),oc(this.gl,l,()=>{switch(x){case"null":w.texImage2D(t,r,s,h,p,o,g,u,c);break;case"typed-array":w.texImage2D(t,r,s,h,p,o,g,u,c,a);break;case"buffer":H=zo(w),H.bindBuffer(35052,c.handle||c),H.texImage2D(t,r,s,h,p,o,g,u,a),H.bindBuffer(35052,null);break;case"browser-object":yi(w)?w.texImage2D(t,r,s,h,p,o,g,u,c):w.texImage2D(t,r,s,g,u,c);break;case"compressed":for(const[I,oe]of c.entries())w.compressedTexImage2D(t,I,oe.format,oe.width,oe.height,o,oe.data);break;default:sn(!1,"Unknown image data type")}}),this._trackAllocatedMemory(c&&c.byteLength?c.byteLength:this.width*this.height*(SV[this.dataFormat]||4)*(xV[this.type]||1),"Texture"),this.loaded=!0,this}setSubImageData({target:e=this.target,pixels:t=null,data:i=null,x:r=0,y:s=0,width:o=this.width,height:a=this.height,level:l=0,format:c=this.format,type:u=this.type,dataFormat:h=this.dataFormat,compressed:p=!1,offset:g=0,border:m=this.border,parameters:w={}}){if(({type:u,dataFormat:h,compressed:p,width:o,height:a}=this._deduceParameters({format:c,type:u,dataFormat:h,compressed:p,data:i,width:o,height:a})),sn(0===this.depth,"texSubImage not supported for 3D textures"),i||(i=t),i&&i.data){const x=i;i=x.data,o=x.shape[0],a=x.shape[1]}i instanceof or&&(i=i.handle),this.gl.bindTexture(this.target,this.handle),oc(this.gl,w,()=>{if(p)this.gl.compressedTexSubImage2D(e,l,r,s,o,a,c,i);else if(null===i)this.gl.texSubImage2D(e,l,r,s,o,a,h,u,null);else if(ArrayBuffer.isView(i))this.gl.texSubImage2D(e,l,r,s,o,a,h,u,i,g);else if(i instanceof CV){const x=zo(this.gl);x.bindBuffer(35052,i),x.texSubImage2D(e,l,r,s,o,a,h,u,g),x.bindBuffer(35052,null)}else yi(this.gl)?zo(this.gl).texSubImage2D(e,l,r,s,o,a,h,u,i):this.gl.texSubImage2D(e,l,r,s,h,u,i)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(e={}){return fn.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(e=this.textureUnit){const{gl:t}=this;return void 0!==e&&(this.textureUnit=e,t.activeTexture(33984+e)),t.bindTexture(this.target,this.handle),e}unbind(e=this.textureUnit){const{gl:t}=this;return void 0!==e&&(this.textureUnit=e,t.activeTexture(33984+e)),t.bindTexture(this.target,null),e}_getDataType({data:e,compressed:t=!1}){return t?{data:e,dataType:"compressed"}:null===e?{data:e,dataType:"null"}:ArrayBuffer.isView(e)?{data:e,dataType:"typed-array"}:e instanceof or?{data:e.handle,dataType:"buffer"}:e instanceof CV?{data:e,dataType:"buffer"}:{data:e,dataType:"browser-object"}}_deduceParameters(e){const{format:t,data:i}=e;let{width:r,height:s,dataFormat:o,type:a,compressed:l}=e;const c=$D[t];return o=o||c&&c.dataFormat,a=a||c&&c.types[0],l=l||c&&c.compressed,({width:r,height:s}=this._deduceImageSize(i,r,s)),{dataFormat:o,type:a,compressed:l,width:r,height:s,format:t,data:i}}_deduceImageSize(e,t,i){let r;return r="undefined"!=typeof ImageData&&e instanceof ImageData?{width:e.width,height:e.height}:"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement?{width:e.naturalWidth,height:e.naturalHeight}:"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap?{width:e.width,height:e.height}:"undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement?{width:e.videoWidth,height:e.videoHeight}:e?{width:t,height:i}:{width:t>=0?t:1,height:i>=0?i:1},sn(r,"Could not deduced texture size"),sn(void 0===t||r.width===t,"Deduced texture width does not match supplied width"),sn(void 0===i||r.height===i,"Deduced texture height does not match supplied height"),r}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(e){switch(e){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const t=this.gl.getTexParameter(this.target,e);return this.gl.bindTexture(this.target,null),t}}_setParameter(e,t){switch(this.gl.bindTexture(this.target,this.handle),t=this._getNPOTParam(e,t),e){case 33082:case 33083:this.gl.texParameterf(this.handle,e,t);break;case 4096:case 4097:sn(!1);break;default:this.gl.texParameteri(this.target,e,t)}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return!(yi(this.gl)||!this.width||!this.height||vV(this.width)&&vV(this.height))}_updateForNPOT(e){void 0===e[this.gl.TEXTURE_MIN_FILTER]&&(e[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),void 0===e[this.gl.TEXTURE_WRAP_S]&&(e[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),void 0===e[this.gl.TEXTURE_WRAP_T]&&(e[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(e,t){if(this._isNPOT())switch(e){case 10241:-1===bie.indexOf(t)&&(t=9729);break;case 10242:case 10243:33071!==t&&(t=33071)}return t}}function wie(n,e){return sn("string"==typeof n),n=""+n,new Promise((t,i)=>{try{const r=new Image;r.onload=()=>t(r),r.onerror=()=>i(new Error(`Could not load image ${n}.`)),r.crossOrigin=e&&e.crossOrigin||"anonymous",r.src=n}catch(r){i(r)}})}class Pa extends Lg{static isSupported(e,t){return Lg.isSupported(e,t)}constructor(e,t={}){KE(e),(t instanceof Promise||"string"==typeof t)&&(t={data:t}),"string"==typeof t.data&&(t=Object.assign({},t,{data:wie(t.data)})),super(e,Object.assign({},t,{target:3553})),this.initialize(t),Object.seal(this)}}const Mf="EXT_color_buffer_float",TV={33189:{bpp:2},33190:{gl2:!0,bpp:3},36012:{gl2:!0,bpp:4},36168:{bpp:1},34041:{bpp:4},35056:{gl2:!0,bpp:4},36013:{gl2:!0,bpp:5},32854:{bpp:2},36194:{bpp:2},32855:{bpp:2},33321:{gl2:!0,bpp:1},33330:{gl2:!0,bpp:1},33329:{gl2:!0,bpp:1},33332:{gl2:!0,bpp:2},33331:{gl2:!0,bpp:2},33334:{gl2:!0,bpp:4},33333:{gl2:!0,bpp:4},33323:{gl2:!0,bpp:2},33336:{gl2:!0,bpp:2},33335:{gl2:!0,bpp:2},33338:{gl2:!0,bpp:4},33337:{gl2:!0,bpp:4},33340:{gl2:!0,bpp:8},33339:{gl2:!0,bpp:8},32849:{gl2:!0,bpp:3},32856:{gl2:!0,bpp:4},32857:{gl2:!0,bpp:4},36220:{gl2:!0,bpp:4},36238:{gl2:!0,bpp:4},36975:{gl2:!0,bpp:4},36214:{gl2:!0,bpp:8},36232:{gl2:!0,bpp:8},36226:{gl2:!0,bpp:16},36208:{gl2:!0,bpp:16},33325:{gl2:Mf,bpp:2},33327:{gl2:Mf,bpp:4},34842:{gl2:Mf,bpp:8},33326:{gl2:Mf,bpp:4},33328:{gl2:Mf,bpp:8},34836:{gl2:Mf,bpp:16},35898:{gl2:Mf,bpp:4}};class kg extends $u{static isSupported(e,{format:t}={format:null}){return!t||function(n,e,t){const i=t[e];if(!i)return!1;const r=yi(n)&&i.gl2||i.gl1;return"string"==typeof r?n.getExtension(r):r}(e,t,TV)}static getSamplesForFormat(e,{format:t}){return e.getInternalformatParameter(36161,t,32937)}constructor(e,t={}){super(e,t),this.initialize(t),Object.seal(this)}initialize({format:e,width:t=1,height:i=1,samples:r=0}){return sn(e,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),0!==r&&yi(this.gl)?this.gl.renderbufferStorageMultisample(36161,r,e,t,i):this.gl.renderbufferStorage(36161,e,t,i),this.format=e,this.width=t,this.height=i,this.samples=r,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*TV[this.format].bpp),this}resize({width:e,height:t}){return e!==this.width||t!==this.height?this.initialize({width:e,height:t,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(e){this.gl.bindRenderbuffer(36161,e)}_syncHandle(e){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(e){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,e)}}const OV="clear: bad arguments";function qD(n,{framebuffer:e=null,color:t=null,depth:i=null,stencil:r=null}={}){const s={};e&&(s.framebuffer=e);let o=0;t&&(o|=16384,!0!==t&&(s.clearColor=t)),i&&(o|=256,!0!==i&&(s.clearDepth=i)),r&&(o|=1024,!0!==i&&(s.clearStencil=i)),sn(0!==o,OV),oc(n,s,()=>{n.clear(o)})}function RV(n,e,t,i,r,s,o){try{var a=n[s](o),l=a.value}catch(c){return void t(c)}a.done?e(l):Promise.resolve(l).then(i,r)}function ii(n){return function(){var e=this,t=arguments;return new Promise(function(i,r){var s=n.apply(e,t);function o(l){RV(s,i,r,o,a,"next",l)}function a(l){RV(s,i,r,o,a,"throw",l)}o(void 0)})}}const YD=[34069,34070,34071,34072,34073,34074];let Mie=(()=>{class n extends Lg{constructor(t,i={}){KE(t),super(t,Object.assign({},i,{target:34067})),this.initialize(i),Object.seal(this)}initialize(t={}){const{mipmaps:i=!0,parameters:r={}}=t;return this.opts=t,this.setCubeMapImageData(t).then(()=>{this.loaded=!0,i&&this.generateMipmap(t),this.setParameters(r)}),this}subImage({face:t,data:i,x:r=0,y:s=0,mipmapLevel:o=0}){return this._subImage({target:t,data:i,x:r,y:s,mipmapLevel:o})}setCubeMapImageData({width:t,height:i,pixels:r,data:s,border:o=0,format:a=6408,type:l=5121}){var c=this;return ii(function*(){const{gl:u}=c,h=r||s,p=yield Promise.all(YD.map(g=>{const m=h[g];return Promise.all(Array.isArray(m)?m:[m])}));c.bind(),YD.forEach((g,m)=>{p[m].length>1&&!1!==c.opts.mipmaps&&fn.warn(`${c.id} has mipmap and multiple LODs.`)(),p[m].forEach((w,x)=>{t&&i?u.texImage2D(g,x,a,t,i,o,a,l,w):u.texImage2D(g,x,a,a,l,w)})}),c.unbind()})()}setImageDataForFace(t){const{face:i,width:r,height:s,pixels:o,data:a,border:l=0,format:c=6408,type:u=5121}=t,{gl:h}=this,p=o||a;return this.bind(),p instanceof Promise?p.then(g=>this.setImageDataForFace(Object.assign({},t,{face:i,data:g,pixels:g}))):this.width||this.height?h.texImage2D(i,0,c,r,s,l,c,u,p):h.texImage2D(i,0,c,c,u,p),this}}return n.FACES=YD,n})();class Die extends Lg{static isSupported(e){return yi(e)}constructor(e,t={}){zo(e),super(e,t=Object.assign({depth:1},t,{target:32879,unpackFlipY:!1})),this.initialize(t),Object.seal(this)}setImageData({level:e=0,dataFormat:t=6408,width:i,height:r,depth:s=1,border:o=0,format:a,type:l=5121,offset:c=0,data:u,parameters:h={}}){return this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),oc(this.gl,h,()=>{ArrayBuffer.isView(u)&&this.gl.texImage3D(this.target,e,t,i,r,s,o,a,l,u),u instanceof or&&(this.gl.bindBuffer(35052,u.handle),this.gl.texImage3D(this.target,e,t,i,r,s,o,a,l,c))}),this._trackAllocatedMemory(u&&u.byteLength?u.byteLength:this.width*this.height*this.depth*(SV[this.dataFormat]||4)*(xV[this.type]||1),"Texture"),this.loaded=!0,this}}function Oie(n,e){const{gl:t,width:i,height:r,id:s}=n;return new Ps(t,Object.assign({},e,{id:`framebuffer-for-${s}`,width:i,height:r,attachments:{36064:n}}))}function XE(n,e={}){const{sourceX:t=0,sourceY:i=0,sourceFormat:r=6408}=e;let{sourceAttachment:s=36064,target:o=null,sourceWidth:a,sourceHeight:l,sourceType:c}=e;const{framebuffer:u,deleteFramebuffer:h}=function(n){return n instanceof Ps?{framebuffer:n,deleteFramebuffer:!1}:{framebuffer:Oie(n),deleteFramebuffer:!0}}(n);sn(u);const{gl:p,handle:g,attachments:m}=u;a=a||u.width,l=l||u.height,36064===s&&null===g&&(s=1028),sn(m[s]),c=c||m[s].type,o=function(n,e,t,i,r){if(n)return n;return new(h0(e=e||5121,{clamped:!1}))(i*r*function(n){switch(n){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return sn(!1),0}}(t))}(o,c,r,a,l),c=c||HD(o);const w=p.bindFramebuffer(36160,g);return p.readPixels(t,i,a,l,r,c,o),p.bindFramebuffer(36160,w||null),h&&u.delete(),o}function KD(n,{sourceAttachment:e=36064,targetMaxHeight:t=Number.MAX_SAFE_INTEGER}={}){let i=XE(n,{sourceAttachment:e}),{width:r,height:s}=n;for(;s>t;)({data:i,width:r,height:s}=fie({data:i,width:r,height:s}));!function({data:n,width:e,height:t,bytesPerPixel:i=4,temp:r}){const s=e*i;r=r||new Uint8Array(s);for(let o=0;o<t/2;++o){const a=o*s,l=(t-o-1)*s;r.set(n.subarray(a,a+s)),n.copyWithin(a,l,l+s),n.set(r,l)}}({data:i,width:r,height:s});const o=document.createElement("canvas");o.width=r,o.height=s;const a=o.getContext("2d"),l=a.createImageData(r,s);return l.data.set(i),a.putImageData(l,0,0),o.toDataURL()}const NV="Multiple render targets not supported";class Ps extends $u{static isSupported(e,t={}){const{colorBufferFloat:i,colorBufferHalfFloat:r}=t;let s=!0;return i&&(s=Boolean(e.getExtension("EXT_color_buffer_float")||e.getExtension("WEBGL_color_buffer_float")||e.getExtension("OES_texture_float"))),r&&(s=s&&Boolean(e.getExtension("EXT_color_buffer_float")||e.getExtension("EXT_color_buffer_half_float"))),s}static getDefaultFramebuffer(e){return e.luma=e.luma||{},e.luma.defaultFramebuffer=e.luma.defaultFramebuffer||new Ps(e,{id:"default-framebuffer",handle:null,attachments:{}}),e.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const e=zo(this.gl);return e.getParameter(e.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const e=zo(this.gl);return e.getParameter(e.MAX_DRAW_BUFFERS)}constructor(e,t={}){super(e,t),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(t),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize({width:e=1,height:t=1,attachments:i=null,color:r=!0,depth:s=!0,stencil:o=!1,check:a=!0,readBuffer:l,drawBuffers:c}){if(sn(e>=0&&t>=0,"Width and height need to be integers"),this.width=e,this.height=t,i)for(const u in i){const h=i[u];(Array.isArray(h)?h[0]:h).resize({width:e,height:t})}else i=this._createDefaultAttachments(r,s,o,e,t);this.update({clearAttachments:!0,attachments:i,readBuffer:l,drawBuffers:c}),i&&a&&this.checkStatus()}delete(){for(const e of this.ownResources)e.delete();return super.delete(),this}update({attachments:e={},readBuffer:t,drawBuffers:i,clearAttachments:r=!1,resizeAttachments:s=!0}){this.attach(e,{clearAttachments:r,resizeAttachments:s});const{gl:o}=this,a=o.bindFramebuffer(36160,this.handle);return t&&this._setReadBuffer(t),i&&this._setDrawBuffers(i),o.bindFramebuffer(36160,a||null),this}resize(e={}){let{width:t,height:i}=e;if(null===this.handle)return sn(void 0===t&&void 0===i),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;void 0===t&&(t=this.gl.drawingBufferWidth),void 0===i&&(i=this.gl.drawingBufferHeight),t!==this.width&&i!==this.height&&fn.log(2,`Resizing framebuffer ${this.id} to ${t}x${i}`)();for(const r in this.attachments)this.attachments[r].resize({width:t,height:i});return this.width=t,this.height=i,this}attach(e,{clearAttachments:t=!1,resizeAttachments:i=!0}={}){const r={};t&&Object.keys(this.attachments).forEach(o=>{r[o]=null}),Object.assign(r,e);const s=this.gl.bindFramebuffer(36160,this.handle);for(const o in r){sn(void 0!==o,"Misspelled framebuffer binding point?");const a=Number(o),l=r[a];let c=l;if(c)if(c instanceof kg)this._attachRenderbuffer({attachment:a,renderbuffer:c});else if(Array.isArray(l)){const[u,h=0,p=0]=l;c=u,this._attachTexture({attachment:a,texture:u,layer:h,level:p})}else this._attachTexture({attachment:a,texture:c,layer:0,level:0});else this._unattach(a);i&&c&&c.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,s||null),Object.assign(this.attachments,e),Object.keys(this.attachments).filter(o=>!this.attachments[o]).forEach(o=>{delete this.attachments[o]})}checkStatus(){const t=this.getStatus();if(36053!==t)throw new Error(function(n){return(Ps.STATUS||{})[n]||`Framebuffer error ${n}`}(t));return this}getStatus(){const{gl:e}=this,t=e.bindFramebuffer(36160,this.handle),i=e.checkFramebufferStatus(36160);return e.bindFramebuffer(36160,t||null),i}clear(e={}){const{color:t,depth:i,stencil:r,drawBuffers:s=[]}=e,o=this.gl.bindFramebuffer(36160,this.handle);return(t||i||r)&&qD(this.gl,{color:t,depth:i,stencil:r}),s.forEach((a,l)=>{!function(n,{framebuffer:e=null,buffer:t=6144,drawBuffer:i=0,value:r=[0,0,0,0]}={}){zo(n),oc(n,{framebuffer:e},()=>{switch(t){case 6144:switch(r.constructor){case Int32Array:n.clearBufferiv(t,i,r);break;case Uint32Array:n.clearBufferuiv(t,i,r);break;case Float32Array:default:n.clearBufferfv(t,i,r)}break;case 6145:n.clearBufferfv(6145,0,[r]);break;case 6146:n.clearBufferiv(6146,0,[r]);break;case 34041:const[s,o]=r;n.clearBufferfi(34041,0,s,o);break;default:sn(!1,OV)}})}(this.gl,{drawBuffer:l,value:a})}),this.gl.bindFramebuffer(36160,o||null),this}readPixels(e={}){return fn.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(e={}){return fn.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(e={}){return fn.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(e={}){return fn.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(e={}){return fn.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(e={}){return fn.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate({attachments:e=[],x:t=0,y:i=0,width:r,height:s}){const o=zo(this.gl),a=o.bindFramebuffer(36008,this.handle);return 0===t&&0===i&&void 0===r&&void 0===s?o.invalidateFramebuffer(36008,e):o.invalidateFramebuffer(36008,e,t,i,r,s),o.bindFramebuffer(36008,a),this}getAttachmentParameter(e,t,i){let r=this._getAttachmentParameterFallback(t);return null===r&&(this.gl.bindFramebuffer(36160,this.handle),r=this.gl.getFramebufferAttachmentParameter(36160,e,t),this.gl.bindFramebuffer(36160,null)),i&&r>1e3&&(r=oh(this.gl,r)),r}getAttachmentParameters(e=36064,t,i=this.constructor.ATTACHMENT_PARAMETERS||[]){const r={};for(const s of i)r[t?oh(this.gl,s):s]=this.getAttachmentParameter(e,s,t);return r}getParameters(e=!0){const t=Object.keys(this.attachments),i={};for(const r of t){const s=Number(r);i[e?oh(this.gl,s):s]=this.getAttachmentParameters(s,e)}return i}show(){return"undefined"!=typeof window&&window.open(KD(this),"luma-debug-texture"),this}log(e=0,t=""){if(e>fn.level||"undefined"==typeof window)return this;t=t||`Framebuffer ${this.id}`;const i=KD(this,{targetMaxHeight:100});return fn.image({logLevel:e,message:t,image:i},t)(),this}bind({target:e=36160}={}){return this.gl.bindFramebuffer(e,this.handle),this}unbind({target:e=36160}={}){return this.gl.bindFramebuffer(e,null),this}_createDefaultAttachments(e,t,i,r,s){let o=null;return e&&(o=o||{},o[36064]=new Pa(this.gl,{id:`${this.id}-color0`,pixels:null,format:6408,type:5121,width:r,height:s,mipmaps:!1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.ownResources.push(o[36064])),t&&i?(o=o||{},o[33306]=new kg(this.gl,{id:`${this.id}-depth-stencil`,format:35056,width:r,height:111}),this.ownResources.push(o[33306])):t?(o=o||{},o[36096]=new kg(this.gl,{id:`${this.id}-depth`,format:33189,width:r,height:s}),this.ownResources.push(o[36096])):i&&sn(!1),o}_unattach(e){const t=this.attachments[e];!t||(t instanceof kg?this.gl.framebufferRenderbuffer(36160,e,36161,null):this.gl.framebufferTexture2D(36160,e,3553,null,0),delete this.attachments[e])}_attachRenderbuffer({attachment:e=36064,renderbuffer:t}){const{gl:i}=this;i.framebufferRenderbuffer(36160,e,36161,t.handle),this.attachments[e]=t}_attachTexture({attachment:e=36064,texture:t,layer:i,level:r}){const{gl:s}=this;switch(s.bindTexture(t.target,t.handle),t.target){case 35866:case 32879:zo(s).framebufferTextureLayer(36160,e,t.target,r,i);break;case 34067:const a=function(n){return n<34069?n+34069:n}(i);s.framebufferTexture2D(36160,e,a,t.handle,r);break;case 3553:s.framebufferTexture2D(36160,e,3553,t.handle,r);break;default:sn(!1,"Illegal texture type")}s.bindTexture(t.target,null),this.attachments[e]=t}_setReadBuffer(e){const t=function(n){return yi(n)?n:null}(this.gl);t?t.readBuffer(e):sn(36064===e||1029===e,NV),this.readBuffer=e}_setDrawBuffers(e){const{gl:t}=this,i=zo(t);if(i)i.drawBuffers(e);else{const r=t.getExtension("WEBGL_draw_buffers");r?r.drawBuffersWEBGL(e):sn(1===e.length&&(36064===e[0]||1029===e[0]),NV)}this.drawBuffers=e}_getAttachmentParameterFallback(e){const t=function(n){n.luma=n.luma||{},n.luma.caps=n.luma.caps||{};for(const e in PV)void 0===n.luma.caps[e]&&(n.luma.caps[e]=LV(n,e));return n.luma.caps}(this.gl);switch(e){case 36052:return t.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return t.WEBGL2?null:8;case 33297:return t.WEBGL2?null:5125;case 33296:return t.WEBGL2||t.EXT_sRGB?null:9729;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(e){return this.gl.bindFramebuffer(36160,e)}}Ps.ATTACHMENT_PARAMETERS=[36049,36048,33296,33298,33299,33300,33301,33302,33303];const PV={WEBGL2:[!1,!0],VERTEX_ARRAY_OBJECT:["OES_vertex_array_object",!0],TIMER_QUERY:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],INSTANCED_RENDERING:["ANGLE_instanced_arrays",!0],MULTIPLE_RENDER_TARGETS:["WEBGL_draw_buffers",!0],ELEMENT_INDEX_UINT32:["OES_element_index_uint",!0],BLEND_EQUATION_MINMAX:["EXT_blend_minmax",!0],FLOAT_BLEND:["EXT_float_blend"],COLOR_ENCODING_SRGB:["EXT_sRGB",!0],TEXTURE_DEPTH:["WEBGL_depth_texture",!0],TEXTURE_FLOAT:["OES_texture_float",!0],TEXTURE_HALF_FLOAT:["OES_texture_half_float",!0],TEXTURE_FILTER_LINEAR_FLOAT:["OES_texture_float_linear"],TEXTURE_FILTER_LINEAR_HALF_FLOAT:["OES_texture_half_float_linear"],TEXTURE_FILTER_ANISOTROPIC:["EXT_texture_filter_anisotropic"],COLOR_ATTACHMENT_RGBA32F:[function(n){const e=new Pa(n,{format:6408,type:5126,dataFormat:6408}),t=new Ps(n,{id:"test-framebuffer",check:!1,attachments:{36064:e}}),i=t.getStatus();return e.delete(),t.delete(),36053===i},"EXT_color_buffer_float"],COLOR_ATTACHMENT_FLOAT:[!1,"EXT_color_buffer_float"],COLOR_ATTACHMENT_HALF_FLOAT:["EXT_color_buffer_half_float"],GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]};function XD(n,e){return FV(n,e)}function FV(n,e){return(e=Array.isArray(e)?e:[e]).every(t=>LV(n,t))}function LV(n,e){return n.luma=n.luma||{},n.luma.caps=n.luma.caps||{},void 0===n.luma.caps[e]&&(n.luma.caps[e]=function(n,e){const t=PV[e];let i;sn(t,e);const r=yi(n)&&t[1]||t[0];if("function"==typeof r)i=r(n);else if(Array.isArray(r)){i=!0;for(const s of r)i=i&&Boolean(n.getExtension(s))}else"string"==typeof r?i=Boolean(n.getExtension(r)):"boolean"==typeof r?i=r:sn(!1);return i}(n,e)),n.luma.caps[e]||fn.log(2,`Feature: ${e} not supported`)(),n.luma.caps[e]}class QD{constructor(e,t){this.opts=t,this.source=e}get value(){return this.source.value}getValue(){const e=this.source.getBuffer(),t=this.getAccessor();if(e)return[e,t];const{value:i}=this.source,{size:r}=t;let s=i;if(i&&i.length!==r){s=new Float32Array(r);const o=t.elementOffset||0;for(let a=0;a<r;++a)s[a]=i[o+a]}return s}getAccessor(){return dt(dt({},this.source.getAccessor()),this.opts)}}const p0=new class{constructor(e){this._pool=[],this.props={overAlloc:2,poolSize:100},this.setProps(e)}setProps(e){Object.assign(this.props,e)}allocate(e,t,{size:i=1,type:r,padding:s=0,copy:o=!1,initialize:a=!1,maxCount:l}){const c=r||e&&e.constructor||Float32Array,u=t*i+s;if(ArrayBuffer.isView(e)){if(u<=e.length)return e;if(u*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new c(e.buffer,0,u)}let h;l&&(h=l*i+s);const p=this._allocate(c,u,a,h);return e&&o?p.set(e):a||p.fill(0,0,4),this._release(e),p}release(e){this._release(e)}_allocate(e,t,i,r){let s=Math.max(Math.ceil(t*this.props.overAlloc),1);s>r&&(s=r);const o=this._pool,a=e.BYTES_PER_ELEMENT*s,l=o.findIndex(c=>c.byteLength>=a);if(l>=0){const c=new e(o.splice(l,1)[0],0,s);return i&&c.fill(0),c}return new e(s)}_release(e){if(!ArrayBuffer.isView(e))return;const t=this._pool,{buffer:i}=e,{byteLength:r}=i,s=t.findIndex(o=>o.byteLength>=r);s<0?t.push(i):(s>0||t.length<this.props.poolSize)&&t.splice(s,0,i),t.length>this.props.poolSize&&t.shift()}},zie=1/Math.PI*180,Hie=1/180*Math.PI,xr={};function $ie(n,{precision:e=xr.precision||4}={}){return n=function(n){return Math.round(n/xr.EPSILON)*xr.EPSILON}(n),`${parseFloat(n.toPrecision(e))}`}function ah(n){return Array.isArray(n)||ArrayBuffer.isView(n)&&!(n instanceof DataView)}function Wu(n,e,t){if(ah(n)){t=t||function(n){return n.clone?n.clone():new Array(n.length)}(n);for(let i=0;i<t.length&&i<n.length;++i)t[i]=e(n[i],i,t);return t}return e(n)}function kV(n){return function(n,e){return Wu(n,t=>t*Hie,void 0)}(n)}function qie(n){return function(n,e){return Wu(n,t=>t*zie,void 0)}(n)}function Fa(n,e,t){return Wu(n,i=>Math.max(e,Math.min(t,i)))}function QE(n,e,t){return ah(n)?n.map((i,r)=>QE(i,e[r],t)):t*e+(1-t)*n}function g0(n,e,t){const i=xr.EPSILON;t&&(xr.EPSILON=t);try{if(n===e)return!0;if(ah(n)&&ah(e)){if(n.length!==e.length)return!1;for(let r=0;r<n.length;++r)if(!g0(n[r],e[r]))return!1;return!0}return n&&n.equals?n.equals(e):e&&e.equals?e.equals(n):!(!Number.isFinite(n)||!Number.isFinite(e))&&Math.abs(n-e)<=xr.EPSILON*Math.max(1,Math.abs(n),Math.abs(e))}finally{xr.EPSILON=i}}function qu(n,e){if(!n)throw new Error(`math.gl assertion ${e}`)}xr.EPSILON=1e-12,xr.debug=!1,xr.precision=4,xr.printTypes=!1,xr.printDegrees=!1,xr.printRowMajor=!0;class ZE extends(function(n){function e(){var t=Reflect.construct(n,Array.from(arguments));return Object.setPrototypeOf(t,Object.getPrototypeOf(this)),t}return e.prototype=Object.create(n.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,n):e.__proto__=n,e}(Array)){get ELEMENTS(){return qu(!1),0}clone(){return(new this.constructor).copy(this)}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}fromArray(e,t=0){for(let i=0;i<this.ELEMENTS;++i)this[i]=e[i+t];return this.check()}to(e){return e===this?this:ah(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toArray(e=[],t=0){for(let i=0;i<this.ELEMENTS;++i)e[t+i]=this[i];return e}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(xr)}formatString(e){let t="";for(let i=0;i<this.ELEMENTS;++i)t+=(i>0?", ":"")+$ie(this[i],e);return`${e.printTypes?this.constructor.name:""}[${t}]`}equals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(!g0(this[t],e[t]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(this[t]!==e[t])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,t,i){void 0===i&&(i=t,t=e,e=this);for(let r=0;r<this.ELEMENTS;++r){const s=e[r];this[r]=s+i*(t[r]-s)}return this.check()}min(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.min(e[t],this[t]);return this.check()}max(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.max(e[t],this[t]);return this.check()}clamp(e,t){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(Math.max(this[i],e[i]),t[i]);return this.check()}add(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]+=t[i];return this.check()}subtract(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]-=t[i];return this.check()}scale(e){if(Array.isArray(e))return this.multiply(e);for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}sub(e){return this.subtract(e)}setScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=e;return this.check()}addScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}divideScalar(e){return this.scale(1/e)}clampScalar(e,t){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(Math.max(this[i],e),t);return this.check()}multiplyByScalar(e){return this.scale(e)}get elements(){return this}check(){if(xr.debug&&!this.validate())throw new Error(`math.gl: ${this.constructor.name} some fields set to invalid numbers'`);return this}validate(){let e=this.length===this.ELEMENTS;for(let t=0;t<this.ELEMENTS;++t)e=e&&Number.isFinite(this[t]);return e}}function tr(n){if(!Number.isFinite(n))throw new Error(`Invalid number ${n}`);return n}function m0(n,e,t=""){if(xr.debug&&!function(n,e){if(n.length!==e)return!1;for(let t=0;t<n.length;++t)if(!Number.isFinite(n[t]))return!1;return!0}(n,e))throw new Error(`math.gl: ${t} some fields set to invalid numbers'`);return n}const BV={};function Bg(n,e){BV[n]||(BV[n]=!0,console.warn(`${n} has been removed in version ${e}, see upgrade guide for more information`))}class Jie extends ZE{get ELEMENTS(){return qu(!1),0}copy(e){return qu(!1),this}get x(){return this[0]}set x(e){this[0]=tr(e)}get y(){return this[1]}set y(e){this[1]=tr(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let t=0;t<this.ELEMENTS;++t)e+=this[t]*this[t];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let t=0;for(let i=0;i<this.ELEMENTS;++i){const r=this[i]-e[i];t+=r*r}return tr(t)}dot(e){let t=0;for(let i=0;i<this.ELEMENTS;++i)t+=this[i]*e[i];return tr(t)}normalize(){const e=this.magnitude();if(0!==e)for(let t=0;t<this.ELEMENTS;++t)this[t]/=e;return this.check()}multiply(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]*=t[i];return this.check()}divide(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]/=t[i];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return qu(e>=0&&e<this.ELEMENTS,"index is out of range"),tr(this[e])}setComponent(e,t){return qu(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=t,this.check()}addVectors(e,t){return this.copy(e).add(t)}subVectors(e,t){return this.copy(e).subtract(t)}multiplyVectors(e,t){return this.copy(e).multiply(t)}addScaledVector(e,t){return this.add(new this.constructor(e).multiplyScalar(t))}}var Xc=1e-6,ha="undefined"!=typeof Float32Array?Float32Array:Array;function VV(){var n=new ha(3);return ha!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n}function jV(n,e,t){var i=new ha(3);return i[0]=n,i[1]=e,i[2]=t,i}function UV(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]}function _0(n,e,t){var i=e[0],r=e[1],s=e[2],o=t[0],a=t[1],l=t[2];return n[0]=r*l-s*a,n[1]=s*o-i*l,n[2]=i*a-r*o,n}function ZD(n,e,t){var i=e[0],r=e[1],s=e[2],o=t[3]*i+t[7]*r+t[11]*s+t[15];return n[0]=(t[0]*i+t[4]*r+t[8]*s+t[12])/(o=o||1),n[1]=(t[1]*i+t[5]*r+t[9]*s+t[13])/o,n[2]=(t[2]*i+t[6]*r+t[10]*s+t[14])/o,n}function JE(n,e,t){var i=e[0],r=e[1],s=e[2];return n[0]=i*t[0]+r*t[3]+s*t[6],n[1]=i*t[1]+r*t[4]+s*t[7],n[2]=i*t[2]+r*t[5]+s*t[8],n}function zV(n,e,t){var i=t[0],r=t[1],s=t[2],a=e[0],l=e[1],c=e[2],u=r*c-s*l,h=s*a-i*c,p=i*l-r*a,g=r*p-s*h,m=s*u-i*p,w=i*h-r*u,x=2*t[3];return h*=x,p*=x,m*=2,w*=2,n[0]=a+(u*=x)+(g*=2),n[1]=l+h+m,n[2]=c+p+w,n}function HV(n,e,t,i){var r=[],s=[];return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],s[0]=r[0],s[1]=r[1]*Math.cos(i)-r[2]*Math.sin(i),s[2]=r[1]*Math.sin(i)+r[2]*Math.cos(i),n[0]=s[0]+t[0],n[1]=s[1]+t[1],n[2]=s[2]+t[2],n}function GV(n,e,t,i){var r=[],s=[];return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],s[0]=r[2]*Math.sin(i)+r[0]*Math.cos(i),s[1]=r[1],s[2]=r[2]*Math.cos(i)-r[0]*Math.sin(i),n[0]=s[0]+t[0],n[1]=s[1]+t[1],n[2]=s[2]+t[2],n}function $V(n,e,t,i){var r=[],s=[];return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],s[0]=r[0]*Math.cos(i)-r[1]*Math.sin(i),s[1]=r[0]*Math.sin(i)+r[1]*Math.cos(i),s[2]=r[2],n[0]=s[0]+t[0],n[1]=s[1]+t[1],n[2]=s[2]+t[2],n}function WV(n,e){var t=n[0],i=n[1],r=n[2],s=e[0],o=e[1],a=e[2],u=Math.sqrt(t*t+i*i+r*r)*Math.sqrt(s*s+o*o+a*a),h=u&&UV(n,e)/u;return Math.acos(Math.min(Math.max(h,-1),1))}Math,Math,Math.hypot||(Math.hypot=function(){for(var n=0,e=arguments.length;e--;)n+=arguments[e]*arguments[e];return Math.sqrt(n)});function qV(n,e,t){const i=e[0],r=e[1],s=e[2],o=t[3]*i+t[7]*r+t[11]*s||1;return n[0]=(t[0]*i+t[4]*r+t[8]*s)/o,n[1]=(t[1]*i+t[5]*r+t[9]*s)/o,n[2]=(t[2]*i+t[6]*r+t[10]*s)/o,n}VV();const JD=[0,0,0],YV={};class xo extends Jie{static get ZERO(){return YV.ZERO=YV.ZERO||Object.freeze(new xo(0,0,0,0))}constructor(e=0,t=0,i=0){super(-0,-0,-0),1===arguments.length&&ah(e)?this.copy(e):(xr.debug&&(tr(e),tr(t),tr(i)),this[0]=e,this[1]=t,this[2]=i)}set(e,t,i){return this[0]=e,this[1]=t,this[2]=i,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return xr.debug&&(tr(e.x),tr(e.y),tr(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=tr(e)}angle(e){return WV(this,e)}cross(e){return _0(this,this,e),this.check()}rotateX({radians:e,origin:t=JD}){return HV(this,this,t,e),this.check()}rotateY({radians:e,origin:t=JD}){return GV(this,this,t,e),this.check()}rotateZ({radians:e,origin:t=JD}){return $V(this,this,t,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return ZD(this,this,e),this.check()}transformAsVector(e){return qV(this,this,e),this.check()}transformByMatrix3(e){return JE(this,this,e),this.check()}transformByMatrix2(e){return function(n,e,t){const i=e[0],r=e[1];n[0]=t[0]*i+t[2]*r,n[1]=t[1]*i+t[3]*r,n[2]=e[2]}(this,this,e),this.check()}transformByQuaternion(e){return zV(this,this,e),this.check()}}const KV=new xo;function Vg(n,e,t,i){KV.set(n,e,t);const r=KV.len();return{distance:i/r,normal:new xo(-n/r,-e/r,-t/r)}}function fre(n){return n-Math.fround(n)}let v0;function eI(n,{size:e=1,startIndex:t=0,endIndex:i}){Number.isFinite(i)||(i=n.length);const r=(i-t)/e;v0=p0.allocate(v0,r,{type:Float32Array,size:2*e});let s=t,o=0;for(;s<i;){for(let a=0;a<e;a++){const l=n[s++];v0[o+a]=l,v0[o+a+e]=fre(l)}o+=2*e}return v0.subarray(0,r*e*2)}function eS(n){return n.stride||n.size*n.bytesPerElement}function XV(n,e){e.offset&&Bi.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const t=eS(n),s=("vertexOffset"in e?e.vertexOffset:n.vertexOffset||0)*t+(e.elementOffset||0)*n.bytesPerElement+(n.offset||0);return Hn(dt({},e),{offset:s,stride:t})}function ac(n,e){if(!n)throw new Error(e||"deck.gl: assertion failed.")}const QV=[],ZV=[];function JV(n,e=0,t=1/0){let i=QV;const r={index:-1,data:n,target:[]};return n?"function"==typeof n[Symbol.iterator]?i=n:n.length>0&&(ZV.length=n.length,i=ZV):i=QV,(e>0||Number.isFinite(t))&&(i=(Array.isArray(i)?i:Array.from(i)).slice(e,t),r.index=e-1),{iterable:i,objectInfo:r}}function ej(n){return n&&n[Symbol.asyncIterator]}function tI(n,e=(()=>!0)){return Array.isArray(n)?tj(n,e,[]):e(n)?[n]:[]}function tj(n,e,t){let i=-1;for(;++i<n.length;){const r=n[i];Array.isArray(r)?tj(r,e,t):e(r)&&t.push(r)}return t}function _re({target:n,source:e,start:t=0,count:i=1}){const r=e.length,s=i*r;let o=0;for(let a=t;o<r;o++)n[a++]=e[o];for(;o<s;)o<s-o?(n.copyWithin(t+o,t,t+o),o*=2):(n.copyWithin(t+o,t,t+s-o),o=s);return n}const yre=[],tS=[[0,1/0]];function nI({source:n,target:e,start:t=0,end:i,size:r,getData:s}){const o=n.length,a=(i=i||e.length)-t;if(o>a)return void e.set(n.subarray(0,a),t);if(e.set(n,t),!s)return;let l=o;for(;l<a;){const c=s(l,n);for(let u=0;u<r;u++)e[t+l]=c[u]||0,l++}}const wre={interpolation:{duration:0,easing:n=>n},spring:{stiffness:.05,damping:.5}};function nj(n,e){return n?(Number.isFinite(n)&&(n={duration:n}),n.type=n.type||"interpolation",dt(dt(dt({},wre[n.type]),e),n)):null}function ij(n,e){return e.getBuffer()?[e.getBuffer(),{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function rj(n){switch(n){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(n,'"'))}}function sj(n){n.push(n.shift())}function iI(n,e){const{doublePrecision:t,settings:i,value:r,size:s}=n,o=t&&r instanceof Float64Array?2:1;return(i.noAlloc?r.length:e*s)*o}function oj({buffer:n,numInstances:e,attribute:t,fromLength:i,fromStartIndices:r,getData:s=(o=>o)}){const o=t.doublePrecision&&t.value instanceof Float64Array?2:1,a=t.size*o,l=t.byteOffset,c=t.startIndices,u=r&&c,h=iI(t,e),p=t.state.constant;if(!u&&i>=h)return;const g=p?t.value:t.getBuffer().getData({srcByteOffset:l});if(t.settings.normalized&&!p){const H=s;s=(I,oe)=>t._normalizeConstant(H(I,oe))}const m=p?(H,I)=>s(g,I):(H,I)=>s(g.subarray(H,H+a),I),w=n.getData({length:i}),x=new Float32Array(h);(function({source:n,target:e,size:t,getData:i,sourceStartIndices:r,targetStartIndices:s}){if(!Array.isArray(s))return nI({source:n,target:e,size:t,getData:i}),e;let o=0,a=0;const l=i&&((u,h)=>i(u+a,h)),c=Math.min(r.length,s.length);for(let u=1;u<c;u++){const h=r[u]*t,p=s[u]*t;nI({source:n.subarray(o,h),target:e,start:a,end:p,size:t,getData:l}),o=h,a=p}a<e.length&&nI({source:[],target:e,start:a,size:t,getData:l})})({source:w,target:x,sourceStartIndices:r,targetStartIndices:c,size:a,getData:m}),n.byteLength<x.byteLength+l&&n.reallocate(x.byteLength+l),n.subData({data:x,offset:l})}class rI extends class{constructor(e,t){this.gl=e,this.id=t.id,this.size=t.size;const i=t.logicalType||t.type,r=5130===i;let{defaultValue:s}=t;s=Number.isFinite(s)?[s]:s||new Array(this.size).fill(0),t.defaultValue=s;let o=i;r?o=5126:!o&&t.isIndexed?o=e&&XD(e,"ELEMENT_INDEX_UINT32")?5125:5123:o||(o=5126),t.logicalType=i,t.type=o;let a=function(n){switch(n){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}(i||o||5126);this.shaderAttributes={},this.doublePrecision=r,r&&!1===t.fp64&&(a=Float32Array),t.bytesPerElement=a.BYTES_PER_ELEMENT,this.defaultType=a,this.value=null,this.settings=t,this.state={externalBuffer:null,bufferAccessor:t,allocatedValue:null,constant:!1},this._buffer=null,this.setData(t)}get buffer(){if(!this._buffer){const{isIndexed:e,type:t}=this.settings;this._buffer=new or(this.gl,{id:this.id,target:e?34963:34962,accessor:{type:t}})}return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*eS(e):0}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),p0.release(this.state.allocatedValue)}getShaderAttributes(e,t){if(this.doublePrecision){const i={},r=this.value instanceof Float64Array,s=function(n,e){const t=XV(n,e);return{high:t,low:Hn(dt({},t),{offset:t.offset+4*n.size})}}(this.getAccessor(),t||{});return i[e]=new QD(this,s.high),i["".concat(e,"64Low")]=r?new QD(this,s.low):new Float32Array(this.size),i}if(t){const i=XV(this.getAccessor(),t);return{[e]:new QD(this,i)}}return{[e]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}setData(e){const{state:t}=this;ArrayBuffer.isView(e)?e={value:e}:e instanceof or&&(e={buffer:e});const i=dt(dt({},this.settings),e);if(t.bufferAccessor=i,e.constant){let r=e.value;if(r=this._normalizeValue(r,[],0),this.settings.normalized&&(r=this._normalizeConstant(r)),t.constant&&this._areValuesEqual(r,this.value))return!1;t.externalBuffer=null,t.constant=!0,this.value=r}else if(e.buffer){const r=e.buffer;t.externalBuffer=r,t.constant=!1,this.value=e.value;const s=e.value instanceof Float64Array;i.type=e.type||r.accessor.type,i.bytesPerElement=r.accessor.BYTES_PER_ELEMENT*(s?2:1),i.stride=eS(i)}else if(e.value){this._checkExternalBuffer(e);let r=e.value;t.externalBuffer=null,t.constant=!1,this.value=r,i.bytesPerElement=r.BYTES_PER_ELEMENT,i.stride=eS(i);const{buffer:s,byteOffset:o}=this;this.doublePrecision&&r instanceof Float64Array&&(r=eI(r,i));const a=r.byteLength+o+2*i.stride;s.byteLength<a&&s.reallocate(a),s.setAccessor(null),s.subData({data:r,offset:o}),i.type=e.type||s.accessor.type}return!0}updateSubBuffer(e={}){const{value:t}=this,{startOffset:i=0,endOffset:r}=e;this.buffer.subData({data:this.doublePrecision&&t instanceof Float64Array?eI(t,{size:this.size,startIndex:i,endIndex:r}):t.subarray(i,r),offset:i*t.BYTES_PER_ELEMENT+this.byteOffset})}allocate({numInstances:e,copy:t=!1}){const{state:i}=this,r=i.allocatedValue,s=p0.allocate(r,e+1,{size:this.size,type:this.defaultType,copy:t});this.value=s;const{buffer:o,byteOffset:a}=this;return o.byteLength<s.byteLength+a&&(o.reallocate(s.byteLength+a),t&&r&&o.subData({data:r instanceof Float64Array?eI(r,this):r,offset:a})),i.allocatedValue=s,i.constant=!1,i.externalBuffer=null,i.bufferAccessor=this.settings,!0}_checkExternalBuffer(e){const{value:t}=e;if(!e.constant&&t){const i=this.defaultType;let r=!1;if(this.doublePrecision&&(r=t.BYTES_PER_ELEMENT<4),r)throw new Error("Attribute ".concat(this.id," does not support ").concat(t.constructor.name));!(t instanceof i)&&this.settings.normalized&&!("normalized"in e)&&Bi.warn("Attribute ".concat(this.id," is normalized"))()}}_normalizeConstant(e){switch(this.settings.type){case 5120:return new Float32Array(e).map(t=>(t+128)/255*2-1);case 5122:return new Float32Array(e).map(t=>(t+32768)/65535*2-1);case 5121:return new Float32Array(e).map(t=>t/255);case 5123:return new Float32Array(e).map(t=>t/65535);default:return e}}_normalizeValue(e,t,i){const{defaultValue:r,size:s}=this.settings;if(Number.isFinite(e))return t[i]=e,t;if(!e)return t[i]=r[0],t;switch(s){case 4:t[i+3]=Number.isFinite(e[3])?e[3]:r[3];case 3:t[i+2]=Number.isFinite(e[2])?e[2]:r[2];case 2:t[i+1]=Number.isFinite(e[1])?e[1]:r[1];case 1:t[i+0]=Number.isFinite(e[0])?e[0]:r[0];break;default:let o=s;for(;--o>=0;)t[i+o]=Number.isFinite(e[o])?e[o]:r[o]}return t}_areValuesEqual(e,t){if(!e||!t)return!1;const{size:i}=this;for(let r=0;r<i;r++)if(e[r]!==t[r])return!1;return!0}}{constructor(e,t={}){super(e,t);const{transition:i=!1,noAlloc:r=!1,update:s=null,accessor:o=null,transform:a=null,startIndices:l=null}=t;Object.assign(this.settings,{transition:i,noAlloc:r,update:s||o&&this._autoUpdater,accessor:o,transform:a}),Object.assign(this.state,{lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:tS,startIndices:l}),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const t=this.state.needsRedraw;return this.state.needsRedraw=t&&!e,t}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat("function"!=typeof e&&e||[])}supportsTransition(){return Boolean(this.settings.transition)}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:t}=this.settings,i=this.settings.transition;return nj(Array.isArray(t)?e[t.find(s=>e[s])]:e[t],i)}setNeedsUpdate(e=this.id,t){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),t){const{startRow:i=0,endRow:r=1/0}=t;this.state.updateRanges=function(n,e){if(n===tS||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return n;const t=[],i=n.length;let r=0;for(let s=0;s<i;s++){const o=n[s];o[1]<e[0]?(t.push(o),r=s+1):o[0]>e[1]?t.push(o):e=[Math.min(o[0],e[0]),Math.max(o[1],e[1])]}return t.splice(r,0,e),t}(this.state.updateRanges,[i,r])}else this.state.updateRanges=tS}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=yre}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}update(e){this.setData(e)}allocate(e){const{state:t,settings:i}=this;return!i.noAlloc&&!!i.update&&(super.allocate({numInstances:e,copy:t.updateRanges!==tS}),!0)}updateBuffer({numInstances:e,data:t,props:i,context:r}){if(!this.needsUpdate())return!1;const{state:{updateRanges:s},settings:{update:o,noAlloc:a}}=this;let l=!0;if(o){for(const[c,u]of s)o.call(r,this,{data:t,startRow:c,endRow:u,props:i,numInstances:e});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant});else for(const[c,u]of s){const h=Number.isFinite(c)?this.getVertexOffset(c):0,p=Number.isFinite(u)?this.getVertexOffset(u):a||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:h,endOffset:p})}this._checkAttributeArray()}else l=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),l}setConstantValue(e){return void 0!==e&&"function"!=typeof e&&(this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(e){const{state:t}=this;return e?(this.clearNeedsUpdate(),t.lastExternalBuffer===e||(t.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(t.lastExternalBuffer=null,!1)}setBinaryValue(e,t=null){const{state:i,settings:r}=this;return e?!r.noAlloc&&(i.binaryValue===e?(this.clearNeedsUpdate(),!0):(i.binaryValue=e,this.setNeedsRedraw(),ArrayBuffer.isView(e)&&(e={value:e}),r.transform||t!==this.startIndices?(ac(ArrayBuffer.isView(e.value),"invalid ".concat(r.accessor)),i.binaryAccessor=function(n,{size:e,stride:t,offset:i,startIndices:r,nested:s}){const o=n.BYTES_PER_ELEMENT,a=t?t/o:e,l=i?i/o:0,c=Math.floor((n.length-l)/a);return(u,{index:h,target:p})=>{if(!r){const x=h*a+l;for(let H=0;H<e;H++)p[H]=n[x+H];return p}const g=r[h],m=r[h+1]||c;let w;if(s){w=new Array(m-g);for(let x=g;x<m;x++){const H=x*a+l;p=new Array(e);for(let I=0;I<e;I++)p[I]=n[H+I];w[x-g]=p}}else if(a===e)w=n.subarray(g*e+l,m*e+l);else{w=new n.constructor((m-g)*e);let x=0;for(let H=g;H<m;H++){const I=H*a+l;for(let oe=0;oe<e;oe++)w[x++]=n[I+oe]}}return w}}(e.value,{size:e.size||this.size,stride:e.stride,offset:e.offset,startIndices:t,nested:e.size&&e.size!==this.size}),!1):(this.clearNeedsUpdate(),this.setData(e),!0))):(i.binaryValue=null,i.binaryAccessor=null,!1)}getVertexOffset(e){const{startIndices:t}=this;return(t?t[e]:e)*this.size}getShaderAttributes(){const e=this.settings.shaderAttributes||{[this.id]:null},t={};for(const i in e)Object.assign(t,super.getShaderAttributes(i,e[i]));return t}_autoUpdater(e,{data:t,startRow:i,endRow:r,props:s,numInstances:o}){if(e.constant)return;const{settings:a,state:l,value:c,size:u,startIndices:h}=e,{accessor:p,transform:g}=a,m=l.binaryAccessor||("function"==typeof p?p:s[p]);ac("function"==typeof m,'accessor "'.concat(p,'" is not a function'));let w=e.getVertexOffset(i);const{iterable:x,objectInfo:H}=JV(t,i,r);for(const I of x){H.index++;let oe=m(I,H);if(g&&(oe=g.call(this,oe)),h){const Se=(H.index<h.length-1?h[H.index+1]:o)-h[H.index];if(oe&&Array.isArray(oe[0])){let Pe=w;for(const Be of oe)e._normalizeValue(Be,c,Pe),Pe+=u}else oe&&oe.length>u?c.set(oe,w):(e._normalizeValue(oe,H.target,0),_re({target:c,source:H.target,start:w,count:Se}));w+=Se*u}else e._normalizeValue(oe,c,w),w+=u}}_validateAttributeUpdaters(){const{settings:e}=this;if(!e.noAlloc&&"function"!=typeof e.update)throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:e}=this,t=Math.min(4,this.size);if(e&&e.length>=t){let i=!0;switch(t){case 4:i=i&&Number.isFinite(e[3]);case 3:i=i&&Number.isFinite(e[2]);case 2:i=i&&Number.isFinite(e[1]);case 1:i=i&&Number.isFinite(e[0]);break;default:i=!1}if(!i)throw new Error("Illegal attribute generated for ".concat(this.id))}}}let sI={};function Co(n){Bi.level>0&&sI[n]&&sI[n].call(...arguments)}function La(n,e){if(!n)throw new Error(e||"shadertools: assertion failed.")}const aj="out vec4 transform_output;\nvoid main() {\n  transform_output = vec4(0);\n}",xre=`#version 300 es\n${aj}`;function lj(n,e){e=Array.isArray(e)?e:[e];const t=n.replace(/^\s+/,"").split(/\s+/),[i,r,s]=t;return e.includes(i)&&r&&s?{qualifier:i,type:r,name:s.split(";")[0]}:null}function cj(n={}){const{version:e=100,input:t,inputType:i,output:r}=n;if(!t)return 300===e?xre:e>300?`#version ${e}\n${aj}`:"void main() {gl_FragColor = vec4(0);}";const s=function(n,e){switch(e){case"float":return`vec4(${n}, 0.0, 0.0, 1.0)`;case"vec2":return`vec4(${n}, 0.0, 1.0)`;case"vec3":return`vec4(${n}, 1.0)`;case"vec4":return n;default:return La(!1),null}}(t,i);return e>=300?`#version ${e} ${300===e?"es":""}\nin ${i} ${t};\nout vec4 ${r};\nvoid main() {\n  ${r} = ${s};\n}`:`varying ${i} ${t};\nvoid main() {\n  gl_FragColor = ${s};\n}`}class uj extends $u{static isSupported(e){return yi(e)}constructor(e,t={}){zo(e),super(e,t),this.initialize(t),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(e={}){return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,Pg(this.buffers)||this.bind(()=>this._unbindBuffers()),this.setProps(e),this}setProps(e){"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"bindOnUse"in e&&(e=e.bindOnUse),"buffers"in e&&this.setBuffers(e.buffers)}setBuffers(e={}){return this.bind(()=>{for(const t in e)this.setBuffer(t,e[t])}),this}setBuffer(e,t){const i=this._getVaryingIndex(e),{buffer:r,byteSize:s,byteOffset:o}=this._getBufferParams(t);return i<0?(this.unused[e]=r,fn.warn(()=>`${this.id} unused varying buffer ${e}`)(),this):(this.buffers[i]=t,this.bindOnUse||this._bindBuffer(i,r,o,s),this)}begin(e=0){return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(e),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(e){let t,i,r;return e instanceof or?r=e:(r=e.buffer,i=e.byteSize,t=e.byteOffset),(void 0!==t||void 0!==i)&&(t=t||0,i=i||r.byteLength-t),{buffer:r,byteOffset:t,byteSize:i}}_getVaryingInfo(e){return this.configuration&&this.configuration.getVaryingInfo(e)}_getVaryingIndex(e){if(this.configuration)return this.configuration.getVaryingInfo(e).location;const t=Number(e);return Number.isFinite(t)?t:-1}_bindBuffers(){if(this.bindOnUse)for(const e in this.buffers){const{buffer:t,byteSize:i,byteOffset:r}=this._getBufferParams(this.buffers[e]);this._bindBuffer(e,t,r,i)}}_unbindBuffers(){if(this.bindOnUse)for(const e in this.buffers)this._bindBuffer(e,null)}_bindBuffer(e,t,i=0,r){const s=t&&t.handle;return s&&void 0!==r?this.gl.bindBufferRange(35982,e,s,i,r):this.gl.bindBufferBase(35982,e,s),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(e){this.gl.bindTransformFeedback(36386,this.handle)}}class Mre{constructor(e,t={}){this.gl=e,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(t),Object.seal(this)}setupResources(e){for(const t of this.bindings)this._setupTransformFeedback(t,e)}updateModelProps(e={}){const{varyings:t}=this;return t.length>0&&(e=Object.assign({},e,{varyings:t})),e}getDrawOptions(e={}){const t=this.bindings[this.currentIndex],{sourceBuffers:i,transformFeedback:r}=t;return{attributes:Object.assign({},i,e.attributes),transformFeedback:r}}swap(){return!!this.feedbackMap&&(this.currentIndex=this._getNextIndex(),!0)}update(e={}){this._setupBuffers(e)}getBuffer(e){const{feedbackBuffers:t}=this.bindings[this.currentIndex],i=e?t[e]:null;return i?i instanceof or?i:i.buffer:null}getData(e={}){const{varyingName:t}=e,i=this.getBuffer(t);return i?i.getData():null}delete(){for(const e in this.resources)this.resources[e].delete()}_initialize(e={}){this._setupBuffers(e),this.varyings=e.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&sn(yi(this.gl))}_getFeedbackBuffers(e){const{sourceBuffers:t={}}=e,i={};if(this.bindings[this.currentIndex]&&Object.assign(i,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const r in this.feedbackMap){const s=this.feedbackMap[r];r in t&&(i[s]=r)}Object.assign(i,e.feedbackBuffers);for(const r in i){const s=i[r];if("string"==typeof s){const o=t[s],{byteLength:a,usage:l,accessor:c}=o;i[r]=this._createNewBuffer(r,{byteLength:a,usage:l,accessor:c})}}return i}_setupBuffers(e={}){const{sourceBuffers:t=null}=e;Object.assign(this.feedbackMap,e.feedbackMap);const i=this._getFeedbackBuffers(e);this._updateBindings({sourceBuffers:t,feedbackBuffers:i})}_setupTransformFeedback(e,{model:t}){const{program:i}=t;e.transformFeedback=new uj(this.gl,{program:i,buffers:e.feedbackBuffers})}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this.feedbackMap){const{sourceBuffers:t,feedbackBuffers:i}=this._swapBuffers(this.bindings[this.currentIndex]),r=this._getNextIndex();this.bindings[r]=this._updateBinding(this.bindings[r],{sourceBuffers:t,feedbackBuffers:i})}}_updateBinding(e,t){return e?(Object.assign(e.sourceBuffers,t.sourceBuffers),Object.assign(e.feedbackBuffers,t.feedbackBuffers),e.transformFeedback&&e.transformFeedback.setBuffers(e.feedbackBuffers),e):{sourceBuffers:Object.assign({},t.sourceBuffers),feedbackBuffers:Object.assign({},t.feedbackBuffers)}}_swapBuffers(e){if(!this.feedbackMap)return null;const t=Object.assign({},e.sourceBuffers),i=Object.assign({},e.feedbackBuffers);for(const r in this.feedbackMap){const s=this.feedbackMap[r];t[r]=e.feedbackBuffers[s],i[s]=e.sourceBuffers[r],sn(i[s]instanceof or)}return{sourceBuffers:t,feedbackBuffers:i}}_createNewBuffer(e,t){const i=new or(this.gl,t);return this.resources[e]&&this.resources[e].delete(),this.resources[e]=i,i}_getNextIndex(){return(this.currentIndex+1)%2}}function dj(n){let e=100;const t=n.match(/[^\s]+/g);if(t.length>=2&&"#version"===t[0]){const i=parseInt(t[1],10);Number.isFinite(i)&&(e=i)}return e}const b0="vs",Ore={[b0]:"#ifdef MODULE_LOGDEPTH\n  logdepth_adjustPosition(gl_Position);\n#endif\n",fs:"#ifdef MODULE_MATERIAL\n  gl_FragColor = material_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LIGHTING\n  gl_FragColor = lighting_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_FOG\n  gl_FragColor = fog_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_PICKING\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LOGDEPTH\n  logdepth_setFragDepth();\n#endif\n"},nS="__LUMA_INJECT_DECLARATIONS__",hj=/void\s+main\s*\([^)]*\)\s*\{\n?/,fj=/}\n?[^{}]*$/,aI=[];function pj(n,e,t,i=!1){const r=e===b0;for(const s in t){const o=t[s];o.sort((l,c)=>l.order-c.order),aI.length=o.length;for(let l=0,c=o.length;l<c;++l)aI[l]=o[l].injection;const a=`${aI.join("\n")}\n`;switch(s){case"vs:#decl":r&&(n=n.replace(nS,a));break;case"vs:#main-start":r&&(n=n.replace(hj,l=>l+a));break;case"vs:#main-end":r&&(n=n.replace(fj,l=>a+l));break;case"fs:#decl":r||(n=n.replace(nS,a));break;case"fs:#main-start":r||(n=n.replace(hj,l=>l+a));break;case"fs:#main-end":r||(n=n.replace(fj,l=>a+l));break;default:n=n.replace(s,l=>l+a)}}return n=n.replace(nS,""),i&&(n=n.replace(/\}\s*$/,s=>s+Ore[e])),n}function lI(n){const e={};return La(Array.isArray(n)&&n.length>1),n.forEach(t=>{for(const i in t)e[i]=e[i]?`${e[i]}\n${t[i]}`:t[i]}),e}const Rre={name:"transform",vs:"attribute float transform_elementID;\nvec2 transform_getPixelSizeHalf(vec2 size) {\n  return vec2(1.) / (2. * size);\n}\n\nvec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {\n  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);\n  float xIndex = transform_elementID - (yIndex * texSize[0]);\n  return vec2(xIndex, yIndex);\n}\nvec2 transform_getTexCoord(vec2 size) {\n  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);\n  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);\n  vec2 coord = indices / size + pixelSizeHalf;\n  return coord;\n}\nvec2 transform_getPos(vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);\n  return pos;\n}\nvec4 transform_getInput(sampler2D texSampler, vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec4 textureColor = texture2D(texSampler, texCoord);\n  return textureColor;\n}\n",fs:null},iS="transform_uSize_",gj="transform_position";const jre={10241:9728,10240:9728,10242:33071,10243:33071};class zre{constructor(e,t={}){this.gl=e,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(t),Object.seal(this)}updateModelProps(e={}){const t=this._processVertexShader(e);return Object.assign({},e,t)}getDrawOptions(e={}){const{sourceBuffers:t,sourceTextures:i,framebuffer:r,targetTexture:s}=this.bindings[this.currentIndex],o=Object.assign({},t,e.attributes),a=Object.assign({},e.uniforms),l=Object.assign({},e.parameters);let c=e.discard;if(this.hasSourceTextures||this.hasTargetTexture){o.transform_elementID=this.elementIDBuffer;for(const h in this.samplerTextureMap)a[h]=i[this.samplerTextureMap[h]];this._setSourceTextureParameters();const u=function({sourceTextureMap:n,targetTextureVarying:e,targetTexture:t}){const i={};let r,s;e&&(({width:r,height:s}=t),i[`${iS}${e}`]=[r,s]);for(const o in n)({width:r,height:s}=n[o]),i[`${iS}${o}`]=[r,s];return i}({sourceTextureMap:i,targetTextureVarying:this.targetTextureVarying,targetTexture:s});Object.assign(a,u)}return this.hasTargetTexture&&(c=!1,l.viewport=[0,0,r.width,r.height]),{attributes:o,framebuffer:r,uniforms:a,discard:c,parameters:l}}swap(){return!!this._swapTexture&&(this.currentIndex=this._getNextIndex(),!0)}update(e={}){this._setupTextures(e)}getTargetTexture(){const{targetTexture:e}=this.bindings[this.currentIndex];return e}getData({packed:e=!1}={}){const{framebuffer:t}=this.bindings[this.currentIndex],i=XE(t);if(!e)return i;const r=i.constructor,s=function(n){switch(n){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return La(!1),null}}(this.targetTextureType),o=new r(i.length*s/4);let a=0;for(let l=0;l<i.length;l+=4)for(let c=0;c<s;c++)o[a++]=i[l+c];return o}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(e={}){const{_targetTextureVarying:t,_swapTexture:i}=e;this._swapTexture=i,this.targetTextureVarying=t,this.hasTargetTexture=t,this._setupTextures(e)}_createTargetTexture(e){const{sourceTextures:t,textureOrReference:i}=e;if(i instanceof Pa)return i;const r=t[i];return r?(this._targetRefTexName=i,this._createNewTexture(r)):null}_setupTextures(e={}){const{sourceBuffers:t,_sourceTextures:i={},_targetTexture:r}=e,s=this._createTargetTexture({sourceTextures:i,textureOrReference:r});this.hasSourceTextures=this.hasSourceTextures||i&&Object.keys(i).length>0,this._updateBindings({sourceBuffers:t,sourceTextures:i,targetTexture:s}),"elementCount"in e&&this._updateElementIDBuffer(e.elementCount)}_updateElementIDBuffer(e){if("number"!=typeof e||this.elementCount>=e)return;const t=new Float32Array(e);t.forEach((i,r,s)=>{s[r]=r}),this.elementIDBuffer?this.elementIDBuffer.setData({data:t}):this.elementIDBuffer=new or(this.gl,{data:t,accessor:{size:1}}),this.elementCount=e}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this._swapTexture){const{sourceTextures:t,targetTexture:i}=this._swapTextures(this.bindings[this.currentIndex]),r=this._getNextIndex();this.bindings[r]=this._updateBinding(this.bindings[r],{sourceTextures:t,targetTexture:i})}}_updateBinding(e,t){const{sourceBuffers:i,sourceTextures:r,targetTexture:s}=t;if(e||(e={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(e.sourceTextures,r),Object.assign(e.sourceBuffers,i),s){e.targetTexture=s;const{width:o,height:a}=s,{framebuffer:l}=e;l?(l.update({attachments:{36064:s},resizeAttachments:!1}),l.resize({width:o,height:a})):e.framebuffer=new Ps(this.gl,{id:"transform-framebuffer",width:o,height:a,attachments:{36064:s}})}return e}_setSourceTextureParameters(){const e=this.currentIndex,{sourceTextures:t}=this.bindings[e];for(const i in t)t[i].setParameters(jre)}_swapTextures(e){if(!this._swapTexture)return null;const t=Object.assign({},e.sourceTextures);return t[this._swapTexture]=e.targetTexture,{sourceTextures:t,targetTexture:e.sourceTextures[this._swapTexture]}}_createNewTexture(e){const t=function(n,e){sn(n instanceof Pa||n instanceof Mie||n instanceof Die);const t=n.constructor,{gl:i,width:r,height:s,format:o,type:a,dataFormat:l,border:c,mipmaps:u}=n;return new t(i,Object.assign({width:r,height:s,format:o,type:a,dataFormat:l,border:c,mipmaps:u},{parameters:{10241:9728,10240:9728,10242:33071,10243:33071},pixelStore:{37440:!1}}))}(e);return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=t,t}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(e={}){const{sourceTextures:t,targetTexture:i}=this.bindings[this.currentIndex],{vs:r,uniforms:s,targetTextureType:o,inject:a,samplerTextureMap:l}=function({vs:n,sourceTextureMap:e,targetTextureVarying:t,targetTexture:i}){let s=Object.keys(e).length,o=null;const a={};let l=n,c={};if(s>0||t){const u=l.split("\n"),h=u.slice();if(u.forEach((p,g,m)=>{if(s>0){const w=function(n,e){const t={},i=function(n){return lj(n,["attribute","in"])}(n);if(!i)return null;const{type:r,name:s}=i;if(s&&e[s]){const o=`// ${n} => Replaced by Transform with a sampler`,{samplerName:a,sizeName:l,uniformDeclerations:c}=function(n){const e=`transform_uSampler_${n}`,t=`${iS}${n}`;return{samplerName:e,sizeName:t,uniformDeclerations:`  uniform sampler2D ${e};\n  uniform vec2 ${t};`}}(s),h=`  ${r} ${s} = transform_getInput(${a}, ${l}).${function(n){switch(n){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return La(!1),null}}(r)};\n`;return t[a]=s,{updatedLine:o,inject:{"vs:#decl":c,"vs:#main-start":h},samplerTextureMap:t}}return null}(p,e);if(w){const{updatedLine:x,inject:H}=w;h[g]=x,c=lI([c,H]),Object.assign(a,w.samplerTextureMap),s--}}t&&!o&&(o=function(n,e){const t=lj(n,["varying","out"]);return t&&t.name===e?t.type:null}(p,t))}),t){sn(i);const p=`${iS}${t}`;c=lI([c,{"vs:#decl":`uniform vec2 ${p};\n`,"vs:#main-start":`     vec2 ${gj} = transform_getPos(${p});\n     gl_Position = vec4(${gj}, 0, 1.);\n`}])}l=h.join("\n")}return{vs:l,targetTextureType:o,inject:c,samplerTextureMap:a}}({vs:e.vs,sourceTextureMap:t,targetTextureVarying:this.targetTextureVarying,targetTexture:i}),c=lI([e.inject||{},a]);return this.targetTextureType=o,this.samplerTextureMap=l,{vs:r,fs:e._fs||cj({version:dj(r),input:this.targetTextureVarying,inputType:o,output:"transform_output"}),modules:this.hasSourceTextures||this.targetTextureVarying?[Rre].concat(e.modules||[]):e.modules,uniforms:s,inject:c}}}const cI={number:{validate:(n,e)=>Number.isFinite(n)&&(!("max"in e)||n<=e.max)&&(!("min"in e)||n>=e.min)},array:{validate:(n,e)=>Array.isArray(n)||ArrayBuffer.isView(n)}};function Gre(n){let e=mj(n);return"object"===e?n?"type"in n?Object.assign({},n,cI[n.type]):"value"in n?(e=mj(n.value),Object.assign({type:e},n,cI[e])):{type:"object",value:n}:{type:"object",value:null}:Object.assign({type:e,value:n},cI[e])}function mj(n){return Array.isArray(n)||ArrayBuffer.isView(n)?"array":typeof n}class uI{constructor({name:e,vs:t,fs:i,dependencies:r=[],uniforms:s,getUniforms:o,deprecations:a=[],defines:l={},inject:c={},vertexShader:u,fragmentShader:h}){La("string"==typeof e),this.name=e,this.vs=t||u,this.fs=i||h,this.getModuleUniforms=o,this.dependencies=r,this.deprecations=this._parseDeprecationDefinitions(a),this.defines=l,this.injections=function(n){const e={vs:{},fs:{}};for(const t in n){let i=n[t];const r=t.slice(0,2);"string"==typeof i&&(i={order:0,injection:i}),e[r][t]=i}return e}(c),s&&(this.uniforms=function(n){const e={};for(const t in n){const r=Gre(n[t]);e[t]=r}return e}(s))}getModuleSource(e){let t;switch(e){case"vs":t=this.vs||"";break;case"fs":t=this.fs||"";break;default:La(!1)}return`#define MODULE_${this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_")}\n${t}// END MODULE_${this.name}\n\n`}getUniforms(e,t){return this.getModuleUniforms?this.getModuleUniforms(e,t):this.uniforms?this._defaultGetUniforms(e):{}}getDefines(){return this.defines}checkDeprecations(e,t){this.deprecations.forEach(i=>{i.regex.test(e)&&(i.deprecated?t.deprecated(i.old,i.new)():t.removed(i.old,i.new)())})}_parseDeprecationDefinitions(e){return e.forEach(t=>{switch(t.type){case"function":t.regex=new RegExp(`\\b${t.old}\\(`);break;default:t.regex=new RegExp(`${t.type} ${t.old};`)}}),e}_defaultGetUniforms(e={}){const t={},i=this.uniforms;for(const r in i){const s=i[r];r in e&&!s.private?(s.validate&&La(s.validate(e[r],s),`${this.name}: invalid ${r}`),t[r]=e[r]):t[r]=s.value}return t}}function Yre(n){return function(n){const e={},t={};return dI({modules:n,level:0,moduleMap:e,moduleDepth:t}),Object.keys(t).sort((i,r)=>t[r]-t[i]).map(i=>e[i])}(yj(n))}function dI({modules:n,level:e,moduleMap:t,moduleDepth:i}){if(e>=5)throw new Error("Possible loop in shader dependency graph");for(const r of n)t[r.name]=r,(void 0===i[r.name]||i[r.name]<e)&&(i[r.name]=e);for(const r of n)r.dependencies&&dI({modules:r.dependencies,level:e+1,moduleMap:t,moduleDepth:i})}function yj(n,e){return n.map(t=>(t instanceof uI||(La("string"!=typeof t,`Shader module use by name is deprecated. Import shader module '${t}' and use it directly.`),La(t.name,"shader module has no name"),(t=new uI(t)).dependencies=yj(t.dependencies)),t))}const hI={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},Df={};function nse(n,e){return n.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":n.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":n.match(/Apple/i)||e.match(/Apple/i)?"APPLE":n.match(/AMD/i)||e.match(/AMD/i)||n.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN"}Object.keys(hI).forEach(n=>{Df[n]=n});const fI={};function vj(n,e,t={}){const i=hI[e];if(La(i,e),!function(n={}){const e="undefined"!=typeof window&&window.navigator||{},t=n.userAgent||e.userAgent||"",i=-1!==t.indexOf("MSIE "),r=-1!==t.indexOf("Trident/");return i||r}(t))return!0;if(e in fI)return fI[e];const o=`#extension GL_${i[0]} : ${t.behavior||"enable"}\nvoid main(void) {}`,a=n.createShader(35633);n.shaderSource(a,o),n.compileShader(a);const l=n.getShaderParameter(a,35713);return n.deleteShader(a),fI[e]=l,l}function rS(n,e){return(e=Array.isArray(e)?e:[e]).every(t=>function(n,e){const t=hI[e];La(t,e);const i=function(n){return"undefined"!=typeof WebGL2RenderingContext&&n instanceof WebGL2RenderingContext||Boolean(n&&2===n._version)}(n)&&t[1]||t[0],r="string"==typeof i?Boolean(n.getExtension(i)):i;return La(!1===r||!0===r),r}(n,t))}function jg(n){return new RegExp(`\\b${n}[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)`,"g")}const bj=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,"#version 300 es\n"],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],ose=[...bj,[jg("attribute"),"in $1"],[jg("varying"),"out $1"]],ase=[...bj,[jg("varying"),"in $1"]],wj=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],lse=[...wj,[jg("in"),"attribute $1"],[jg("out"),"varying $1"]],cse=[...wj,[jg("in"),"varying $1"]],pI="gl_FragColor",gI=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,use=/void\s+main\s*\([^)]*\)\s*\{\n?/;function sS(n,e){for(const[t,i]of e)n=n.replace(t,i);return n}const pse=`\n\n${nS}\n\n`,Ej={[b0]:"vertex",fs:"fragment"};function Sj(n,{id:e,source:t,type:i,modules:r,defines:s={},hookFunctions:o=[],inject:a={},transpileToGLSL100:l=!1,prologue:c=!0,log:u}){La("string"==typeof t,"shader source must be a string");const h=i===b0,p=t.split("\n");let g=100,m="",w=t;0===p[0].indexOf("#version ")?(g=300,m=p[0],w=p.slice(1).join("\n")):m=`#version ${g}`;const x={};r.forEach(Be=>{Object.assign(x,Be.getDefines())}),Object.assign(x,s);let H=c?`${m}\n${function({id:n,source:e,type:t}){return n&&"string"==typeof n&&-1===e.indexOf("SHADER_NAME")?`\n#define SHADER_NAME ${n}_${Ej[t]}\n\n`:""}({id:e,source:t,type:i})}\n${function({type:n}){return`\n#define SHADER_TYPE_${Ej[n].toUpperCase()}\n`}({type:i})}\n${function(n){switch(function(n){const e=n.getExtension("WEBGL_debug_renderer_info"),t=n.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||7936),i=n.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||7937);return{gpuVendor:nse(t,i),vendor:t,renderer:i,version:n.getParameter(7938),shadingLanguageVersion:n.getParameter(35724)}}(n).gpuVendor.toLowerCase()){case"nvidia":return"#define NVIDIA_GPU\n// Nvidia optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n";case"intel":return"#define INTEL_GPU\n// Intel optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n";case"amd":return"#define AMD_GPU\n";default:return"#define DEFAULT_GPU\n// Prevent driver from optimizing away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n"}}(n)}\n${function(n,e,t){let i="#if (__VERSION__ > 120)\n\n# define FEATURE_GLSL_DERIVATIVES\n# define FEATURE_GLSL_DRAW_BUFFERS\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FEATURE_GLSL_TEXTURE_LOD\n\n// DEPRECATED FLAGS, remove in v9\n# define FRAG_DEPTH\n# define DERIVATIVES\n# define DRAW_BUFFERS\n# define TEXTURE_LOD\n\n#endif // __VERSION\n";return rS(n,Df.GLSL_FRAG_DEPTH)&&(i+="\n// FRAG_DEPTH => gl_FragDepth is available\n#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FRAG_DEPTH\n# define gl_FragDepth gl_FragDepthEXT\n#endif\n"),rS(n,Df.GLSL_DERIVATIVES)&&vj(n,Df.GLSL_DERIVATIVES)&&(i+="\n// DERIVATIVES => dxdF, dxdY and fwidth are available\n#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n# define FEATURE_GLSL_DERIVATIVES\n# define DERIVATIVES\n#endif\n"),rS(n,Df.GLSL_FRAG_DATA)&&vj(n,Df.GLSL_FRAG_DATA,{behavior:"require"})&&(i+="\n// DRAW_BUFFERS => gl_FragData[] is available\n#ifdef GL_EXT_draw_buffers\n#extension GL_EXT_draw_buffers : require\n#define FEATURE_GLSL_DRAW_BUFFERS\n#define DRAW_BUFFERS\n#endif\n"),rS(n,Df.GLSL_TEXTURE_LOD)&&(i+="// TEXTURE_LOD => texture2DLod etc are available\n#ifdef GL_EXT_shader_texture_lod\n#extension GL_EXT_shader_texture_lod : enable\n\n# define FEATURE_GLSL_TEXTURE_LOD\n# define TEXTURE_LOD\n\n#endif\n"),i}(n)}\n${function(n={}){let e=0,t="";for(const i in n){0===e&&(t+="\n// APPLICATION DEFINES\n"),e++;const r=n[i];(r||Number.isFinite(r))&&(t+=`#define ${i.toUpperCase()} ${n[i]}\n`)}return 0===e&&(t+="\n"),t}(x)}\n${h?"":"precision highp float;\n\n"}\n`:`${m}\n`;const I=function(n){const e={vs:{},fs:{}};return n.forEach(t=>{let i;"string"!=typeof t?(i=t,t=i.hook):i={},t=t.trim();const[r,s]=t.split(":"),o=t.replace(/\(.+/,"");e[r][o]=Object.assign(i,{signature:s})}),e}(o),oe={},Se={},Pe={};for(const Be in a){const He="string"==typeof a[Be]?{injection:a[Be],order:0}:a[Be],vt=Be.match(/^(v|f)s:(#)?([\w-]+)$/);if(vt){const Ct=vt[3];vt[2]?"decl"===Ct?Se[Be]=[He]:Pe[Be]=[He]:oe[Be]=[He]}else Pe[Be]=[He]}for(const Be of r){u&&Be.checkDeprecations(w,u),H+=Be.getModuleSource(i,g);const vt=Be.injections[i];for(const St in vt){const Ct=St.match(/^(v|f)s:#([\w-]+)$/);if(Ct){const en="decl"===Ct[2]?Se:Pe;en[St]=en[St]||[],en[St].push(vt[St])}else oe[St]=oe[St]||[],oe[St].push(vt[St])}}return H+=pse,H=pj(H,i,Se),H+=function(n,e){let t="";for(const i in n){const r=n[i];if(t+=`void ${r.signature} {\n`,r.header&&(t+=`  ${r.header}`),e[i]){const s=e[i];s.sort((o,a)=>o.order-a.order);for(const o of s)t+=`  ${o.injection}\n`}r.footer&&(t+=`  ${r.footer}`),t+="}\n"}return t}(I[i],oe),H+=w,H=pj(H,i,Pe),H=function(n,e,t){switch(e){case 300:return t?sS(n,ose):function(n){const e=(n=sS(n,ase)).match(gI);if(e){const t=e[1];n=n.replace(new RegExp(`\\b${pI}\\b`,"g"),t)}else{const t="fragmentColor";n=n.replace(use,i=>`out vec4 ${t};\n${i}`).replace(new RegExp(`\\b${pI}\\b`,"g"),t)}return n}(n);case 100:return t?sS(n,lse):function(n){const e=(n=sS(n,cse)).match(gI);if(e){const t=e[1];n=n.replace(gI,"").replace(new RegExp(`\\b${t}\\b`,"g"),pI)}return n}(n);default:throw new Error(`unknown GLSL version ${e}`)}}(H,l?100:g,h),H}function _se(n){return function(t){const i={};for(const r of n){const s=r.getUniforms(t,i);Object.assign(i,s)}return i}}const Sse={5126:Cr.bind(null,"uniform1fv",ka,1,To),35664:Cr.bind(null,"uniform2fv",ka,2,To),35665:Cr.bind(null,"uniform3fv",ka,3,To),35666:Cr.bind(null,"uniform4fv",ka,4,To),5124:Cr.bind(null,"uniform1iv",lh,1,To),35667:Cr.bind(null,"uniform2iv",lh,2,To),35668:Cr.bind(null,"uniform3iv",lh,3,To),35669:Cr.bind(null,"uniform4iv",lh,4,To),35670:Cr.bind(null,"uniform1iv",lh,1,To),35671:Cr.bind(null,"uniform2iv",lh,2,To),35672:Cr.bind(null,"uniform3iv",lh,3,To),35673:Cr.bind(null,"uniform4iv",lh,4,To),35674:Cr.bind(null,"uniformMatrix2fv",ka,4,Yu),35675:Cr.bind(null,"uniformMatrix3fv",ka,9,Yu),35676:Cr.bind(null,"uniformMatrix4fv",ka,16,Yu),35678:ro,35680:ro,5125:Cr.bind(null,"uniform1uiv",oS,1,To),36294:Cr.bind(null,"uniform2uiv",oS,2,To),36295:Cr.bind(null,"uniform3uiv",oS,3,To),36296:Cr.bind(null,"uniform4uiv",oS,4,To),35685:Cr.bind(null,"uniformMatrix2x3fv",ka,6,Yu),35686:Cr.bind(null,"uniformMatrix2x4fv",ka,8,Yu),35687:Cr.bind(null,"uniformMatrix3x2fv",ka,6,Yu),35688:Cr.bind(null,"uniformMatrix3x4fv",ka,12,Yu),35689:Cr.bind(null,"uniformMatrix4x2fv",ka,8,Yu),35690:Cr.bind(null,"uniformMatrix4x3fv",ka,12,Yu),35678:ro,35680:ro,35679:ro,35682:ro,36289:ro,36292:ro,36293:ro,36298:ro,36299:ro,36300:ro,36303:ro,36306:ro,36307:ro,36308:ro,36311:ro},xse={},Cse={},Tse={},xj=[0];function mI(n,e,t,i){1===e&&"boolean"==typeof n&&(n=n?1:0),Number.isFinite(n)&&(xj[0]=n,n=xj);const r=n.length;if(r%e&&fn.warn(`Uniform size should be multiples of ${e}`,n)(),n instanceof t)return n;let s=i[r];s||(s=new t(r),i[r]=s);for(let o=0;o<r;o++)s[o]=n[o];return s}function ka(n,e){return mI(n,e,Float32Array,xse)}function lh(n,e){return mI(n,e,Int32Array,Cse)}function oS(n,e){return mI(n,e,Uint32Array,Tse)}function Cj(n,e,t){const i=Sse[t.type];if(!i)throw new Error(`Unknown GLSL uniform type ${t.type}`);return i().bind(null,n,e)}function Ase(n){if("]"!==n[n.length-1])return{name:n,length:1,isArray:!1};const t=n.match(/([^[]*)(\[[0-9]+\])?/);if(!t||t.length<2)throw new Error(`Failed to parse GLSL uniform name ${n}`);return{name:t[1],length:t[2]||1,isArray:Boolean(t[2])}}function Dse(n){return Array.isArray(n)||ArrayBuffer.isView(n)?function(n){if(0===n.length)return!1;const e=Math.min(n.length,16);for(let t=0;t<e;++t)if(!Number.isFinite(n[t]))return!1;return!0}(n):!!(isFinite(n)||!0===n||!1===n||n instanceof Lg||n instanceof kg)||n instanceof Ps&&Boolean(n.texture)}function Ise(n,e,t){if(Array.isArray(t)||ArrayBuffer.isView(t))if(n[e]){const i=n[e];for(let r=0,s=t.length;r<s;++r)i[r]=t[r]}else n[e]=t.slice();else n[e]=t}function ro(){let n=null;return(e,t,i)=>{const r=n!==i;return r&&(e.uniform1i(t,i),n=i),r}}function Cr(n,e,t,i){let r=null,s=null;return(o,a,l)=>{const c=e(l,t),u=c.length;let h=!1;if(null===r)r=new Float32Array(u),s=u,h=!0;else{sn(s===u,"Uniform length cannot change.");for(let p=0;p<u;++p)if(c[p]!==r[p]){h=!0;break}}return h&&(i(o,n,a,c),r.set(c)),h}}function To(n,e,t,i){n[e](t,i)}function Yu(n,e,t,i){n[e](t,!1,i)}function aS(n,e="unnamed"){const i=n.match(/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/);return i?i[1]:e}function Aj(n,e){let t="";for(let i=0;i<e.length;i++){const r=e[i];if((n[i+3]||n[i+2]||n[i+1])&&(t+=`${r}\n`,n[i+1])){const s=n[i+1],o=s.split(":",3),a=o[0],l=parseInt(o[1],10)||0;t+=Mj(`^^^ ${a}: ${s.substring(o.join(":").length+1).trim()}\n\n`,l)}}return t}function Mj(n,e){let t="";for(let i=0;i<e;++i)t+=" ";return`${t}${n}`}class w0 extends $u{static getTypeName(e){switch(e){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return sn(!1),"unknown"}}constructor(e,t){KE(e),sn("string"==typeof t.source,"Shader: GLSL source code must be a JavaScript string"),super(e,{id:aS(t.source,null)||t.id||Kc(`unnamed ${w0.getTypeName(t.shaderType)}`)}),this.shaderType=t.shaderType,this.source=t.source,this.initialize(t)}initialize({source:e}){const t=aS(e,null);t&&(this.id=Kc(t)),this._compile(e)}getParameter(e){return this.gl.getShaderParameter(this.handle,e)}toString(){return`${w0.getTypeName(this.shaderType)}:${this.id}`}getName(){return aS(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const e=this.gl.getExtension("WEBGL_debug_shaders");return e?e.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(e=this.source){if(e.startsWith("#version ")||(e=`#version 100\n${e}`),this.source=e,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){const i=this.gl.getShaderInfoLog(this.handle),{shaderName:r,errors:s,warnings:o}=function(n,e,t,i){const r=n.split(/\r?\n/),s={},o={},a=i||aS(e)||"(unnamed)",l=`${function(n){switch(n){case 35632:return"fragment";case 35633:return"vertex";default:return"unknown type"}}(t)} shader ${a}`;for(let u=0;u<r.length;u++){const h=r[u];if(h.length<=1)continue;const p=h.split(":"),g=p[0],m=parseInt(p[2],10);if(isNaN(m))throw new Error(`GLSL compilation error in ${l}: ${n}`);"WARNING"!==g?s[m]=h:o[m]=h}const c=function(n,e=1,t=": "){const i=n.split(/\r?\n/),r=String(i.length+e-1).length;return i.map((s,o)=>{const a=String(o+e);return Mj(a,r-a.length)+t+s})}(e);return{shaderName:l,errors:Aj(s,c),warnings:Aj(o,c)}}(i,this.source,this.shaderType,this.id);throw fn.error(`GLSL compilation errors in ${r}\n${s}`)(),fn.warn(`GLSL compilation warnings in ${r}\n${o}`)(),new Error(`GLSL compilation errors in ${r}`)}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class _I extends w0{constructor(e,t){"string"==typeof t&&(t={source:t}),super(e,Object.assign({},t,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class yI extends w0{constructor(e,t){"string"==typeof t&&(t={source:t}),super(e,Object.assign({},t,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}const Fs=5126,E0=5124,S0=5125,vI={[Fs]:[Fs,1,"float"],35664:[Fs,2,"vec2"],35665:[Fs,3,"vec3"],35666:[Fs,4,"vec4"],[E0]:[E0,1,"int"],35667:[E0,2,"ivec2"],35668:[E0,3,"ivec3"],35669:[E0,4,"ivec4"],[S0]:[S0,1,"uint"],36294:[S0,2,"uvec2"],36295:[S0,3,"uvec3"],36296:[S0,4,"uvec4"],35670:[Fs,1,"bool"],35671:[Fs,2,"bvec2"],35672:[Fs,3,"bvec3"],35673:[Fs,4,"bvec4"],35674:[Fs,8,"mat2"],35685:[Fs,8,"mat2x3"],35686:[Fs,8,"mat2x4"],35675:[Fs,12,"mat3"],35687:[Fs,12,"mat3x2"],35688:[Fs,12,"mat3x4"],35676:[Fs,16,"mat4"],35689:[Fs,16,"mat4x2"],35690:[Fs,16,"mat4x3"]};function Pj(n){const e=vI[n];if(!e)return null;const[t,i]=e;return{type:t,components:i}}function Fj(n,e){switch(n){case 5120:case 5121:case 5122:case 5123:n=Fs}for(const t in vI){const[i,r,s]=vI[t];if(i===n&&r===e)return{glType:t,name:s}}return null}class uoe{constructor(e){this.id=e.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(e),this._readVaryingsFromProgram(e)}getAttributeInfo(e){const t=Number(e);return Number.isFinite(t)?this.attributeInfosByLocation[t]:this.attributeInfosByName[e]||null}getAttributeLocation(e){const t=this.getAttributeInfo(e);return t?t.location:-1}getAttributeAccessor(e){const t=this.getAttributeInfo(e);return t?t.accessor:null}getVaryingInfo(e){const t=Number(e);return Number.isFinite(t)?this.varyingInfos[t]:this.varyingInfosByName[e]||null}getVaryingIndex(e){const t=this.getVaryingInfo();return t?t.location:-1}getVaryingAccessor(e){const t=this.getVaryingInfo();return t?t.accessor:null}_readAttributesFromProgram(e){const{gl:t}=e,i=t.getProgramParameter(e.handle,35721);for(let r=0;r<i;r++){const{name:s,type:o,size:a}=t.getActiveAttrib(e.handle,r),l=t.getAttribLocation(e.handle,s);l>=0&&this._addAttribute(l,s,o,a)}this.attributeInfos.sort((r,s)=>r.location-s.location)}_readVaryingsFromProgram(e){const{gl:t}=e;if(!yi(t))return;const i=t.getProgramParameter(e.handle,35971);for(let r=0;r<i;r++){const{name:s,type:o,size:a}=t.getTransformFeedbackVarying(e.handle,r);this._addVarying(r,s,o,a)}this.varyingInfos.sort((r,s)=>r.location-s.location)}_addAttribute(e,t,i,r){const{type:s,components:o}=Pj(i),a={type:s,size:r*o};this._inferProperties(e,t,a);const l={location:e,name:t,accessor:new da(a)};this.attributeInfos.push(l),this.attributeInfosByLocation[e]=l,this.attributeInfosByName[l.name]=l}_inferProperties(e,t,i){/instance/i.test(t)&&(i.divisor=1)}_addVarying(e,t,i,r){const{type:s,components:o}=Pj(i),l={location:e,name:t,accessor:new da({type:s,size:r*o})};this.varyingInfos.push(l),this.varyingInfosByName[l.name]=l}}const doe=35981,hoe=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class kj extends $u{constructor(e,t={}){super(e,t),this.stubRemovedMethods("Program","v6.0",hoe),this._isCached=!1,this.initialize(t),Object.seal(this),this._setId(t.id)}initialize(e={}){const{hash:t,vs:i,fs:r,varyings:s,bufferMode:o=doe}=e;return this.hash=t||"",this.vs="string"==typeof i?new _I(this.gl,{id:`${e.id}-vs`,source:i}):i,this.fs="string"==typeof r?new yI(this.gl,{id:`${e.id}-fs`,source:r}):r,sn(this.vs instanceof _I),sn(this.fs instanceof yI),this.uniforms={},this._textureUniforms={},s&&s.length>0&&(zo(this.gl),this.varyings=s,this.gl2.transformFeedbackVaryings(this.handle,s,o)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new uoe(this),this.setProps(e)}delete(e={}){return this._isCached?this:super.delete(e)}setProps(e){return"uniforms"in e&&this.setUniforms(e.uniforms),this}draw({logPriority:e,drawMode:t=4,vertexCount:i,offset:r=0,start:s,end:o,isIndexed:a=!1,indexType:l=5123,instanceCount:c=0,isInstanced:u=c>0,vertexArray:h=null,transformFeedback:p,framebuffer:g,parameters:m={},uniforms:w,samplers:x}){if((w||x)&&(fn.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(w||{})),fn.priority>=e){const H=g?g.id:"default",I=`mode=${oh(this.gl,t)} verts=${i} instances=${c} indexType=${oh(this.gl,l)} isInstanced=${u} isIndexed=${a} Framebuffer=${H}`;fn.log(e,I)()}return sn(h),this.gl.useProgram(this.handle),!(!this._areTexturesRenderable()||0===i||u&&0===c||(h.bindForDraw(i,c,()=>{if(void 0!==g&&(m=Object.assign({},m,{framebuffer:g})),p){const H=function(n){switch(n){case 0:return 0;case 1:case 3:case 2:return 1;case 4:case 5:case 6:return 4;default:return sn(!1),0}}(t);p.begin(H)}this._bindTextures(),oc(this.gl,m,()=>{a&&u?this.gl2.drawElementsInstanced(t,i,l,r,c):a&&yi(this.gl)&&!isNaN(s)&&!isNaN(o)?this.gl2.drawRangeElements(t,s,o,i,l,r):a?this.gl.drawElements(t,i,l,r):u?this.gl2.drawArraysInstanced(t,r,i,c):this.gl.drawArrays(t,r,i)}),p&&p.end()}),0))}setUniforms(e={}){fn.priority>=2&&function(n,e,t){for(const i in n){const r=n[i];if((!t||Boolean(t[i]))&&!Dse(r))throw e=e?`${e} `:"",console.error(`${e} Bad uniform ${i}`,r),new Error(`${e} Bad uniform ${i}`)}}(e,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const t in e){const i=e[t],r=this._uniformSetters[t];if(r){let s=i,o=!1;if(s instanceof Ps&&(s=s.texture),s instanceof Lg)if(o=this.uniforms[t]!==i,o){void 0===r.textureIndex&&(r.textureIndex=this._textureIndexCounter++);const a=s,{textureIndex:l}=r;a.bind(l),s=l,this._textureUniforms[t]=a}else s=r.textureIndex;else this._textureUniforms[t]&&delete this._textureUniforms[t];(r(s)||o)&&Ise(this.uniforms,t,i)}}return this}_areTexturesRenderable(){let e=!0;for(const t in this._textureUniforms){const i=this._textureUniforms[t];i.update(),e=e&&i.loaded}return e}_bindTextures(){for(const e in this._textureUniforms)this._textureUniforms[e].bind(this._uniformSetters[e].textureIndex)}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(e){const t=this.gl.getAttachedShaders(e),i={};for(const r of t)switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:i.vs=new _I({handle:r});break;case 35632:i.fs=new yI({handle:r})}return i}_getParameter(e){return this.gl.getProgramParameter(this.handle,e)}_setId(e){if(!e){const t=this._getName();this.id=Kc(t)}}_getName(){let e=this.vs.getName()||this.fs.getName();return e=e.replace(/shader/i,""),e=e?`${e}-program`:"program",e}_compileAndLink(){const{gl:e}=this;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),fn.time(4,`linkProgram for ${this._getName()}`)(),e.linkProgram(this.handle),fn.timeEnd(4,`linkProgram for ${this._getName()}`)(),e.debug||fn.level>0){if(!e.getProgramParameter(this.handle,35714))throw new Error(`Error linking: ${e.getProgramInfoLog(this.handle)}`);if(e.validateProgram(this.handle),!e.getProgramParameter(this.handle,35715))throw new Error(`Error validating: ${e.getProgramInfoLog(this.handle)}`)}}_readUniformLocationsFromLinkedProgram(){const{gl:e}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let t=0;t<this._uniformCount;t++){const i=this.gl.getActiveUniform(this.handle,t),{name:r}=Ase(i.name);let s=e.getUniformLocation(this.handle,r);if(this._uniformSetters[r]=Cj(e,s,i),i.size>1)for(let o=0;o<i.size;o++)s=e.getUniformLocation(this.handle,`${r}[${o}]`),this._uniformSetters[`${r}[${o}]`]=Cj(e,s,i)}this._textureIndexCounter=0}getActiveUniforms(e,t){return this.gl2.getActiveUniforms(this.handle,e,t)}getUniformBlockIndex(e){return this.gl2.getUniformBlockIndex(this.handle,e)}getActiveUniformBlockParameter(e,t){return this.gl2.getActiveUniformBlockParameter(this.handle,e,t)}uniformBlockBinding(e,t){this.gl2.uniformBlockBinding(this.handle,e,t)}}class x0{static getDefaultProgramManager(e){return e.luma=e.luma||{},e.luma.defaultProgramManager=e.luma.defaultProgramManager||new x0(e),e.luma.defaultProgramManager}constructor(e){this.gl=e,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(e){this._defaultModules.find(t=>t.name===e.name)||this._defaultModules.push(e),this.stateHash++}removeDefaultModule(e){const t="string"==typeof e?e:e.name;this._defaultModules=this._defaultModules.filter(i=>i.name!==t),this.stateHash++}addShaderHook(e,t){t&&(e=Object.assign(t,{hook:e})),this._hookFunctions.push(e),this.stateHash++}get(e={}){const{vs:t="",fs:i="",defines:r={},inject:s={},varyings:o=[],bufferMode:a=35981,transpileToGLSL100:l=!1}=e,c=this._getModuleList(e.modules),u=this._getHash(t),h=this._getHash(i),p=c.map(oe=>this._getHash(oe.name)).sort(),g=o.map(oe=>this._getHash(oe)),m=Object.keys(r).sort(),w=Object.keys(s).sort(),x=[],H=[];for(const oe of m)x.push(this._getHash(oe)),x.push(this._getHash(r[oe]));for(const oe of w)H.push(this._getHash(oe)),H.push(this._getHash(s[oe]));const I=`${u}/${h}D${x.join("/")}M${p.join("/")}I${H.join("/")}V${g.join("/")}H${this.stateHash}B${a}${l?"T":""}`;if(!this._programCache[I]){const oe=function(n,e){const{vs:t,fs:i}=e,r=Yre(e.modules||[]);return{gl:n,vs:Sj(n,Object.assign({},e,{source:t,type:b0,modules:r})),fs:Sj(n,Object.assign({},e,{source:i,type:"fs",modules:r})),getUniforms:_se(r)}}(this.gl,{vs:t,fs:i,modules:c,inject:s,defines:r,hookFunctions:this._hookFunctions,transpileToGLSL100:l});this._programCache[I]=new kj(this.gl,{hash:I,vs:oe.vs,fs:oe.fs,varyings:o,bufferMode:a}),this._getUniforms[I]=oe.getUniforms||(Se=>{}),this._useCounts[I]=0}return this._useCounts[I]++,this._programCache[I]}getUniforms(e){return this._getUniforms[e.hash]||null}release(e){const t=e.hash;this._useCounts[t]--,0===this._useCounts[t]&&(this._programCache[t].delete(),delete this._programCache[t],delete this._getUniforms[t],delete this._useCounts[t])}_getHash(e){return void 0===this._hashes[e]&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}_getModuleList(e=[]){const t=new Array(this._defaultModules.length+e.length),i={};let r=0;for(let s=0,o=this._defaultModules.length;s<o;++s){const a=this._defaultModules[s],l=a.name;t[r++]=a,i[l]=!0}for(let s=0,o=e.length;s<o;++s){const a=e[s],l=a.name;i[l]||(t[r++]=a,i[l]=!0)}return t.length=r,t}}let cS=null;class Ba extends $u{static isSupported(e,t={}){return!t.constantAttributeZero||yi(e)||"Chrome"===function(n){if(!RD())return"Node";if($B(n))return"Electron";const t=("undefined"!=typeof navigator?navigator:{}).userAgent||"";if(t.indexOf("Edge")>-1)return"Edge";const i=-1!==t.indexOf("MSIE "),r=-1!==t.indexOf("Trident/");return i||r?"IE":a0.chrome?"Chrome":a0.safari?"Safari":a0.mozInnerScreenX?"Firefox":"Unknown"}()}static getDefaultArray(e){return e.luma=e.luma||{},e.luma.defaultVertexArray||(e.luma.defaultVertexArray=new Ba(e,{handle:null,isDefaultArray:!0})),e.luma.defaultVertexArray}static getMaxAttributes(e){return Ba.MAX_ATTRIBUTES=Ba.MAX_ATTRIBUTES||e.getParameter(34921),Ba.MAX_ATTRIBUTES}static setConstant(e,t,i){switch(i.constructor){case Float32Array:Ba._setConstantFloatArray(e,t,i);break;case Int32Array:Ba._setConstantIntArray(e,t,i);break;case Uint32Array:Ba._setConstantUintArray(e,t,i);break;default:sn(!1)}}constructor(e,t={}){super(e,Object.assign({},t,{id:t.id||t.program&&t.program.id})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=t.isDefaultArray||!1,this.gl2=e,this.initialize(t),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return Ba.getMaxAttributes(this.gl)}initialize(e={}){return this.setProps(e)}setProps(e){return this}setElementBuffer(e=null,t={}){return sn(!e||34963===e.target,"elements must be GL.ELEMENT_ARRAY_BUFFER"),this.bind(()=>{this.gl.bindBuffer(34963,e?e.handle:null)}),this}setBuffer(e,t,i){if(34963===t.target)return this.setElementBuffer(t,i);const{size:r,type:s,stride:o,offset:a,normalized:l,integer:c,divisor:u}=i,{gl:h,gl2:p}=this;return e=Number(e),this.bind(()=>{h.bindBuffer(34962,t.handle),c?(sn(yi(h)),p.vertexAttribIPointer(e,r,s,o,a)):h.vertexAttribPointer(e,r,s,l,o,a),h.enableVertexAttribArray(e),p.vertexAttribDivisor(e,u||0)}),this}enable(e,t=!0){return!t&&0===e&&!Ba.isSupported(this.gl,{constantAttributeZero:!0})||(e=Number(e),this.bind(()=>t?this.gl.enableVertexAttribArray(e):this.gl.disableVertexAttribArray(e))),this}getConstantBuffer(e,t){const i=this._normalizeConstantArrayValue(t),r=i.byteLength*e,s=i.length*e;let o=!this.buffer;if(this.buffer=this.buffer||new or(this.gl,r),o=o||this.buffer.reallocate(r),o=o||!this._compareConstantArrayValues(i,this.bufferValue),o){const a=function(n,e){return new n(function(n){return(!cS||cS.byteLength<n)&&(cS=new ArrayBuffer(n)),cS}(n.BYTES_PER_ELEMENT*e),0,e)}(t.constructor,s);(function({target:n,source:e,start:t=0,count:i=1}){const r=e.length,s=i*r;let o=0;for(let a=t;o<r;o++)n[a++]=e[o];for(;o<s;)o<s-o?(n.copyWithin(t+o,t,t+o),o*=2):(n.copyWithin(t+o,t,t+s-o),o=s)})({target:a,source:i,start:0,count:s}),this.buffer.subData(a),this.bufferValue=t}return this.buffer}_normalizeConstantArrayValue(e){return Array.isArray(e)?new Float32Array(e):e}_compareConstantArrayValues(e,t){if(!e||!t||e.length!==t.length||e.constructor!==t.constructor)return!1;for(let i=0;i<e.length;++i)if(e[i]!==t[i])return!1;return!0}static _setConstantFloatArray(e,t,i){switch(i.length){case 1:e.vertexAttrib1fv(t,i);break;case 2:e.vertexAttrib2fv(t,i);break;case 3:e.vertexAttrib3fv(t,i);break;case 4:e.vertexAttrib4fv(t,i);break;default:sn(!1)}}static _setConstantIntArray(e,t,i){switch(sn(yi(e)),i.length){case 1:e.vertexAttribI1iv(t,i);break;case 2:e.vertexAttribI2iv(t,i);break;case 3:e.vertexAttribI3iv(t,i);break;case 4:e.vertexAttribI4iv(t,i);break;default:sn(!1)}}static _setConstantUintArray(e,t,i){switch(sn(yi(e)),i.length){case 1:e.vertexAttribI1uiv(t,i);break;case 2:e.vertexAttribI2uiv(t,i);break;case 3:e.vertexAttribI3uiv(t,i);break;case 4:e.vertexAttribI4uiv(t,i);break;default:sn(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(e){return this.gl2.deleteVertexArray(e),[this.elements]}_bindHandle(e){this.gl2.bindVertexArray(e)}_getParameter(e,{location:t}){return sn(Number.isFinite(t)),this.bind(()=>{switch(e){case 34373:return this.gl.getVertexAttribOffset(t,e);default:return this.gl.getVertexAttrib(t,e)}})}}const voe=/^(.+)__LOCATION_([0-9]+)$/,boe=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class woe{constructor(e,t={}){this.id=t.id||t.program&&t.program.id,this.gl=e,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new Ba(e),bV(this,"VertexArray","v6.0",boe),this.initialize(t),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(e={}){return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(e)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:e}=this.vertexArrayObject;return this.values=new Array(e).fill(null),this.accessors=new Array(e).fill(null),this.unused={},this.drawParams=null,this}setProps(e){return"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"attributes"in e&&this.setAttributes(e.attributes),"elements"in e&&this.setElementBuffer(e.elements),"bindOnUse"in e&&(e=e.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(e){return Object.assign(this.attributes,e),this.vertexArrayObject.bind(()=>{for(const t in e)this._setAttribute(t,e[t]);this.gl.bindBuffer(34962,null)}),this}setElementBuffer(e=null,t={}){return this.elements=e,this.elementsAccessor=t,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(e,t),this}setBuffer(e,t,i={}){if(34963===t.target)return this.setElementBuffer(t,i);const{location:r,accessor:s}=this._resolveLocationAndAccessor(e,t,t.accessor,i);return r>=0&&(this.values[r]=t,this.accessors[r]=s,this.clearDrawParams(),this.vertexArrayObject.setBuffer(r,t,s)),this}setConstant(e,t,i={}){const{location:r,accessor:s}=this._resolveLocationAndAccessor(e,t,Object.assign({size:t.length},i));return r>=0&&(t=this.vertexArrayObject._normalizeConstantArrayValue(t),this.values[r]=t,this.accessors[r]=s,this.clearDrawParams(),this.vertexArrayObject.enable(r,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new or(this.gl,{accessor:{size:4}});for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this.values[e]instanceof or&&(this.gl.disableVertexAttribArray(e),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(e,1,5126,!1,0,0))}),this}bindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.setElementBuffer(this.elements);for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++){const t=this.values[e];t instanceof or&&this.setBuffer(e,t)}}),this}bindForDraw(e,t,i){let r;return this.vertexArrayObject.bind(()=>{this._setConstantAttributes(e,t),r=i()}),r}_resolveLocationAndAccessor(e,t,i,r){const s={location:-1,accessor:null},{location:o,name:a}=this._getAttributeIndex(e);if(!Number.isFinite(o)||o<0)return this.unused[e]=t,fn.once(3,()=>`unused value ${e} in ${this.id}`)(),s;const l=this._getAttributeInfo(a||o);if(!l)return s;const u=da.resolve(l.accessor,this.accessors[o]||{},i,r),{size:h,type:p}=u;return sn(Number.isFinite(h)&&Number.isFinite(p)),{location:o,accessor:u}}_getAttributeInfo(e){return this.configuration&&this.configuration.getAttributeInfo(e)}_getAttributeIndex(e){const t=Number(e);if(Number.isFinite(t))return{location:t};const i=voe.exec(e),r=i?i[1]:e,s=i?Number(i[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(r)+s,name:r}:{location:-1}}_setAttribute(e,t){if(t instanceof or)this.setBuffer(e,t);else if(Array.isArray(t)&&t.length&&t[0]instanceof or)this.setBuffer(e,t[0],t[1]);else if(ArrayBuffer.isView(t)||Array.isArray(t))this.setConstant(e,t);else{if(!(t.buffer instanceof or))throw new Error("VertexArray: attributes must be Buffers or constants (i.e. typed array)");this.setBuffer(e,t.buffer,t)}}_setConstantAttributes(e,t){const i=Math.max(0|e,0|t);let r=this.values[0];ArrayBuffer.isView(r)&&this._setConstantAttributeZero(r,i);for(let s=1;s<this.vertexArrayObject.MAX_ATTRIBUTES;s++)r=this.values[s],ArrayBuffer.isView(r)&&this._setConstantAttribute(s,r)}_setConstantAttributeZero(e,t){if(Ba.isSupported(this.gl,{constantAttributeZero:!0}))return void this._setConstantAttribute(0,e);const i=this.vertexArrayObject.getConstantBuffer(t,e);this.vertexArrayObject.setBuffer(0,i,this.accessors[0])}_setConstantAttribute(e,t){Ba.setConstant(this.gl,e,t)}_updateDrawParams(){const e={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let t=0;t<this.vertexArrayObject.MAX_ATTRIBUTES;t++)this._updateDrawParamsForLocation(e,t);return this.elements&&(e.elementCount=this.elements.getElementCount(this.elements.accessor),e.isIndexed=!0,e.indexType=this.elementsAccessor.type||this.elements.accessor.type,e.indexOffset=this.elementsAccessor.offset||0),e.indexCount===1/0&&(e.indexCount=0),e.vertexCount===1/0&&(e.vertexCount=0),e.instanceCount===1/0&&(e.instanceCount=0),e}_updateDrawParamsForLocation(e,t){const i=this.values[t],r=this.accessors[t];if(!i)return;const{divisor:s}=r,o=s>0;if(e.isInstanced=e.isInstanced||o,i instanceof or){const a=i;if(o){const l=a.getVertexCount(r);e.instanceCount=Math.min(e.instanceCount,l)}else{const l=a.getVertexCount(r);e.vertexCount=Math.min(e.vertexCount,l)}}}setElements(e=null,t={}){return fn.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(e,t)}}function C0(n,e={}){const{isInteger:i=!1}=e;if(Array.isArray(n)||ArrayBuffer.isView(n))return function(n,e){const{maxElts:t=16,size:i=1}=e;let r="[";for(let o=0;o<n.length&&o<t;++o)o>0&&(r+=","+(o%i==0?" ":"")),r+=C0(n[o],e);return`${r}${n.length>t?"...":"]"}`}(n,e);if(!Number.isFinite(n))return String(n);if(Math.abs(n)<1e-16)return i?"0":"0.";if(i||Math.abs(n)>100&&Math.abs(n)<1e4)return n.toFixed(0);const r=n.toPrecision(2);return r.indexOf(".0")===r.length-2?r.slice(0,-1):r}function Bj(n,e,t,i){const{gl:r}=n;if(!e)return{[i]:"null","Format ":"N/A"};let c,u,h,s="NOT PROVIDED",o=1,a=0,l=0;if(t&&(s=t.type,o=t.size,s=String(s).replace("Array",""),c=-1!==s.indexOf("nt")),e instanceof or){const p=e,{data:g,changed:m}=p.getDebugData();let w;return u=m?"*":"",h=g,l=p.byteLength,a=l/g.BYTES_PER_ELEMENT/o,t?w=`${t.divisor>0?"I ":"P "} ${a} (x${o}=${l} bytes ${oh(r,s)})`:(c=!0,w=`${l} bytes`),{[i]:`${u}${C0(h,{size:o,isInteger:c})}`,"Format ":w}}return h=e,o=e.length,s=String(e.constructor.name).replace("Array",""),c=-1!==s.indexOf("nt"),{[i]:`${C0(h,{size:o,isInteger:c})} (constant)`,"Format ":`${o}x${s} (constant)`}}function xoe(n,e){const{type:t,size:i}=e,r=Fj(t,i);return r?`${n} (${r.name})`:n}function Vj({header:n="Uniforms",program:e,uniforms:t,undefinedOnly:i=!1}){sn(e);const s=".*Matrix",a={},l=Object.keys(e._uniformSetters).sort();let c=0;for(const p of l)!p.match(".*_.*")&&!p.match(s)&&bI({table:a,header:n,uniforms:t,uniformName:p,undefinedOnly:i})&&c++;for(const p of l)p.match(s)&&bI({table:a,header:n,uniforms:t,uniformName:p,undefinedOnly:i})&&c++;for(const p of l)a[p]||bI({table:a,header:n,uniforms:t,uniformName:p,undefinedOnly:i})&&c++;let u=0;const h={};if(!i)for(const p in t){const g=t[p];a[p]||(u++,h[p]={Type:`NOT USED: ${g}`,[n]:C0(g)})}return{table:a,count:c,unusedTable:h,unusedCount:u}}function bI({table:n,header:e,uniforms:t,uniformName:i,undefinedOnly:r}){const s=t[i],o=function(n){return null!=n}(s);return!(r&&o||(n[i]={[e]:o?C0(s):"N/A","Uniform Type":o?s:"NOT PROVIDED"},0))}function jj(n){const{type:e,size:t}=n.accessor,i=Fj(e,t);return i?`${i.name} ${n.name}`:n.name}const Aoe={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function Doe(n,e){const{attributeMap:t=Aoe}=e||{};return t&&t[n]||n}function Ioe(n,e){let t;switch(n){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":t="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":t="vectors"}switch(t){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2}sn(Number.isFinite(e.size),`attribute ${n} needs size`)}const Uj=()=>{},Noe={};class uS{constructor(e,t={}){const{id:i=Kc("model")}=t;sn(YE(e)),this.id=i,this.gl=e,this.id=t.id||Kc("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(t)}initialize(e){this.props={},this.programManager=e.programManager||x0.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:t=null,vs:i,fs:r,modules:s,defines:o,inject:a,varyings:l,bufferMode:c,transpileToGLSL100:u}=e;this.programProps={program:t,vs:i,fs:r,modules:s,defines:o,inject:a,varyings:l,bufferMode:c,transpileToGLSL100:u},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(e.moduleSettings))),this.drawMode=void 0!==e.drawMode?e.drawMode:4,this.vertexCount=e.vertexCount||0,this.geometryBuffers={},this.isInstanced=e.isInstanced||e.instanced||e.instanceCount>0,this._setModelProps(e),this.geometry={},sn(void 0!==this.drawMode&&Number.isFinite(this.vertexCount),"Model needs drawMode and vertexCount")}setProps(e){this._setModelProps(e)}delete(){for(const e in this._attributes)this._attributes[e]!==this.attributes[e]&&this._attributes[e].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(e){const{program:t,vs:i,fs:r,modules:s,defines:o,inject:a,varyings:l,bufferMode:c,transpileToGLSL100:u}=e;this.programProps={program:t,vs:i,fs:r,modules:s,defines:o,inject:a,varyings:l,bufferMode:c,transpileToGLSL100:u},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(e){return this.drawMode=e,this}setVertexCount(e){return sn(Number.isFinite(e)),this.vertexCount=e,this}setInstanceCount(e){return sn(Number.isFinite(e)),this.instanceCount=e,this}setGeometry(e){return this.drawMode=e.drawMode,this.vertexCount=e.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=function(n,e,t){const i={};let r=e.indices;for(const s in e.attributes){const o=e.attributes[s],a=Doe(s,undefined);if("indices"===s)r=o;else if(o.constant)i[a]=o.value;else{const l=o.value,c=dt({},o);delete c.value,i[a]=[new or(n,l),c],Ioe(s,c)}}if(r){const s=r.value||r;sn(s instanceof Uint16Array||s instanceof Uint32Array,'attribute array for "indices" must be of integer type');const o={size:1,isIndexed:void 0===r.isIndexed||r.isIndexed};i.indices=[new or(n,{data:s,target:34963}),o]}return i}(this.gl,e),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(e={}){if(Pg(e))return this;const t={};for(const i in e){const r=e[i];t[i]=r.getValue?r.getValue():r}return this.vertexArray.setAttributes(t),this}setUniforms(e={}){return Object.assign(this.uniforms,e),this}getModuleUniforms(e){this._checkProgram();const t=this.programManager.getUniforms(this.program);return t?t(e):{}}updateModuleSettings(e){const t=this.getModuleUniforms(e||{});return this.setUniforms(t)}clear(e){return qD(this.program.gl,e),this}draw(e={}){this._checkProgram();const{moduleSettings:t=null,framebuffer:i,uniforms:r={},attributes:s={},transformFeedback:o=this.transformFeedback,parameters:a={},vertexArray:l=this.vertexArray}=e;let c;this.setAttributes(s),this.updateModuleSettings(t),this.setUniforms(r),fn.priority>=2&&(c=this._logDrawCallStart(2));const u=this.vertexArray.getDrawParams(),{isIndexed:h=u.isIndexed,indexType:p=u.indexType,indexOffset:g=u.indexOffset,vertexArrayInstanced:m=u.isInstanced}=this.props;m&&!this.isInstanced&&fn.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:w,instanceCount:x}=this,{onBeforeRender:H=Uj,onAfterRender:I=Uj}=this.props;H(),this.program.setUniforms(this.uniforms);const oe=this.program.draw(Object.assign(Noe,e,{logPriority:c,uniforms:null,framebuffer:i,parameters:a,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:l,transformFeedback:o,isIndexed:h,indexType:p,isInstanced:w,instanceCount:x,offset:h?g:0}));return I(),fn.priority>=2&&this._logDrawCallEnd(c,l,i),oe}transform(e={}){const{discard:t=!0,feedbackBuffers:i,unbindModels:r=[]}=e;let{parameters:s}=e;i&&this._setFeedbackBuffers(i),t&&(s=Object.assign({},s,{35977:t})),r.forEach(o=>o.vertexArray.unbindBuffers());try{this.draw(Object.assign({},e,{parameters:s}))}finally{r.forEach(o=>o.vertexArray.bindBuffers())}return this}render(e={}){return fn.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(e).draw()}_setModelProps(e){Object.assign(this.props,e),"uniforms"in e&&this.setUniforms(e.uniforms),"pickable"in e&&(this.pickable=e.pickable),"instanceCount"in e&&(this.instanceCount=e.instanceCount),"geometry"in e&&this.setGeometry(e.geometry),"attributes"in e&&this.setAttributes(e.attributes),"_feedbackBuffers"in e&&this._setFeedbackBuffers(e._feedbackBuffers)}_checkProgram(){if(!this._programDirty&&this.programManager.stateHash===this._programManagerState)return;let{program:t}=this.programProps;if(t)this._managedProgram=!1;else{const{vs:i,fs:r,modules:s,inject:o,defines:a,varyings:l,bufferMode:c,transpileToGLSL100:u}=this.programProps;t=this.programManager.get({vs:i,fs:r,modules:s,inject:o,defines:a,varyings:l,bufferMode:c,transpileToGLSL100:u}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}sn(t instanceof kj,"Model needs a program"),this._programDirty=!1,t!==this.program&&(this.program=t,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new woe(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const e in this.geometryBuffers){const t=this.geometryBuffers[e][0]||this.geometryBuffers[e];t instanceof or&&t.delete()}}_setAnimationProps(e){this.animated&&sn(e,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(e={}){if(Pg(e))return this;const{gl:t}=this.program;return this.transformFeedback=this.transformFeedback||new uj(t,{program:this.program}),this.transformFeedback.setBuffers(e),this}_logDrawCallStart(e){const t=e>3?0:1e4;if(!(Date.now()-this.lastLogTime<t))return this.lastLogTime=Date.now(),fn.group(2,`>>> DRAWING MODEL ${this.id}`,{collapsed:fn.level<=2})(),e}_logDrawCallEnd(e,t,i,r){if(void 0===e)return;const s=function({vertexArray:n,header:e="Attributes"}){if(!n.configuration)return{};const t={};n.elements&&(t.ELEMENT_ARRAY_BUFFER=Bj(n,n.elements,null,e));const i=n.values;for(const r in i){const s=n._getAttributeInfo(r);if(s){let o=`${r}: ${s.name}`;const a=n.accessors[s.location];a&&(o=`${r}: ${xoe(s.name,a)}`),t[o]=Bj(n,i[r],a,e)}}return t}({vertexArray:t,header:`${this.id} attributes`,attributes:this._attributes}),{table:o,unusedTable:a,unusedCount:l}=Vj({header:`${this.id} uniforms`,program:this.program,uniforms:Object.assign({},this.program.uniforms,i)}),{table:c,count:u}=Vj({header:`${this.id} uniforms`,program:this.program,uniforms:Object.assign({},this.program.uniforms,i),undefinedOnly:!0});u>0&&fn.log("MISSING UNIFORMS",Object.keys(c))(),l>0&&fn.log("UNUSED UNIFORMS",Object.keys(a))();const h=function(n){const e={},t=`Accessors for ${n.id}`;for(const i of n.attributeInfos)i&&(e[`in ${jj(i)}`]={[t]:JSON.stringify(i.accessor)});for(const i of n.varyingInfos)i&&(e[`out ${jj(i)}`]={[t]:JSON.stringify(i.accessor)});return e}(this.vertexArray.configuration);fn.table(e,s)(),fn.table(e,o)(),fn.table(e+1,h)(),r&&r.log({logLevel:2,message:`Rendered to ${r.id}`}),fn.groupEnd(2,`>>> DRAWING MODEL ${this.id}`)()}}class wI{static isSupported(e){return yi(e)}constructor(e,t={}){this.gl=e,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(t),Object.seal(this)}delete(){const{model:e,bufferTransform:t,textureTransform:i}=this;e&&e.delete(),t&&t.delete(),i&&i.delete()}run(e={}){const{clearRenderTarget:t=!0}=e,i=this._updateDrawOptions(e);t&&i.framebuffer&&i.framebuffer.clear({color:!0}),this.model.transform(i)}swap(){let e=!1;const t=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of t)e=e||i.swap();sn(e,"Nothing to swap")}getBuffer(e=null){return this.bufferTransform&&this.bufferTransform.getBuffer(e)}getData(e={}){const t=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of t){const r=i.getData(e);if(r)return r}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(e={}){"elementCount"in e&&this.model.setVertexCount(e.elementCount);const t=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of t)i.update(e)}_initialize(e={}){const{gl:t}=this;this._buildResourceTransforms(t,e),e=this._updateModelProps(e),this.model=new uS(t,Object.assign({},e,{fs:e.fs||cj({version:dj(e.vs)}),id:e.id||"transform-model",drawMode:e.drawMode||0,vertexCount:e.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(e){let t=Object.assign({},e);const i=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of i)t=r.updateModelProps(t);return t}_buildResourceTransforms(e,t){(function(n){return!(Pg(n.feedbackBuffers)&&Pg(n.feedbackMap)&&!(n.varyings&&n.varyings.length>0))})(t)&&(this.bufferTransform=new Mre(e,t)),function(n){return!(Pg(n._sourceTextures)&&!n._targetTexture&&!n._targetTextureVarying)}(t)&&(this.textureTransform=new zre(e,t)),sn(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(e){let t=Object.assign({},e);const i=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of i)t=Object.assign(t,r.getDrawOptions(t));return t}}function dS(){}const Loe={onStart:dS,onUpdate:dS,onInterrupt:dS,onEnd:dS};class T0{constructor(e){this._inProgress=!1,this._handle=null,this.timeline=e,this.settings={}}get inProgress(){return this._inProgress}start(e){this.cancel(),this.settings=dt(dt({},Loe),e),this._inProgress=!0,this.settings.onStart(this)}end(){this._inProgress&&(this.timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,this.settings.onEnd(this))}cancel(){this._inProgress&&(this.settings.onInterrupt(this),this.timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}update(){if(!this._inProgress)return!1;if(null===this._handle){const{timeline:e,settings:t}=this;this._handle=e.addChannel({delay:e.getTime(),duration:t.duration})}return this.time=this.timeline.getTime(this._handle),this._onUpdate(),this.settings.onUpdate(this),this.timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const Goe={interpolation:class{constructor({gl:e,attribute:t,timeline:i}){this.gl=e,this.type="interpolation",this.transition=new T0(i),this.attribute=t,this.attributeInTransition=new rI(e,t.settings),this.currentStartIndices=t.startIndices,this.currentLength=0,this.transform=function(n,e){const t=rj(e.size);return new wI(n,{vs:"\n#define SHADER_NAME interpolation-transition-vertex-shader\n\nuniform float time;\nattribute ATTRIBUTE_TYPE aFrom;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vCurrent;\n\nvoid main(void) {\n  vCurrent = mix(aFrom, aTo, time);\n  gl_Position = vec4(0.0);\n}\n",defines:{ATTRIBUTE_TYPE:t},varyings:["vCurrent"]})}(e,t);const r={byteLength:0,usage:35050};this.buffers=[new or(e,r),new or(e,r)]}get inProgress(){return this.transition.inProgress}start(e,t){if(e.duration<=0)return void this.transition.cancel();const{buffers:r,attribute:s}=this;sj(r);const o={numInstances:t,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const a of r)oj(dt({buffer:a},o));this.currentStartIndices=s.startIndices,this.currentLength=iI(s,t),this.attributeInTransition.update({buffer:r[1],value:s.value}),this.transition.start(e),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aFrom:r[0],aTo:ij(0,s)},feedbackBuffers:{vCurrent:r[1]}})}update(){const e=this.transition.update();if(e){const{time:t,settings:{duration:i,easing:r}}=this.transition,s=r(t/i);this.transform.run({uniforms:{time:s}})}return e}cancel(){for(this.transition.cancel(),this.transform.delete();this.buffers.length;)this.buffers.pop().delete()}},spring:class{constructor({gl:e,attribute:t,timeline:i}){this.gl=e,this.type="spring",this.transition=new T0(i),this.attribute=t,this.attributeInTransition=new rI(e,Hn(dt({},t.settings),{normalized:!1})),this.currentStartIndices=t.startIndices,this.currentLength=0,this.texture=function(n){return new Pa(n,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}(e),this.framebuffer=function(n,e){return new Ps(n,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{36064:e}})}(e,this.texture),this.transform=function(n,e,t){const i=rj(e.size);return new wI(n,{framebuffer:t,vs:"\n#define SHADER_NAME spring-transition-vertex-shader\n\n#define EPSILON 0.00001\n\nuniform float stiffness;\nuniform float damping;\nattribute ATTRIBUTE_TYPE aPrev;\nattribute ATTRIBUTE_TYPE aCur;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vNext;\nvarying float vIsTransitioningFlag;\n\nATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {\n  ATTRIBUTE_TYPE velocity = cur - prev;\n  ATTRIBUTE_TYPE delta = dest - cur;\n  ATTRIBUTE_TYPE spring = delta * stiffness;\n  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;\n  return spring + damper + velocity + cur;\n}\n\nvoid main(void) {\n  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;\n  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;\n\n  vNext = getNextValue(aCur, aPrev, aTo);\n  gl_Position = vec4(0, 0, 0, 1);\n  gl_PointSize = 100.0;\n}\n",fs:"\n#define SHADER_NAME spring-transition-is-transitioning-fragment-shader\n\nvarying float vIsTransitioningFlag;\n\nvoid main(void) {\n  if (vIsTransitioningFlag == 0.0) {\n    discard;\n  }\n  gl_FragColor = vec4(1.0);\n}",defines:{ATTRIBUTE_TYPE:i},varyings:["vNext"]})}(e,t,this.framebuffer);const r={byteLength:0,usage:35050};this.buffers=[new or(e,r),new or(e,r),new or(e,r)]}get inProgress(){return this.transition.inProgress}start(e,t){const{buffers:r,attribute:s}=this,o={numInstances:t,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const a of r)oj(dt({buffer:a},o));this.currentStartIndices=s.startIndices,this.currentLength=iI(s,t),this.attributeInTransition.update({buffer:r[1],value:s.value}),this.transition.start(e),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aTo:ij(0,s)}})}update(){const{buffers:e,transform:t,framebuffer:i,transition:r}=this;return!!r.update()&&(t.update({sourceBuffers:{aPrev:e[0],aCur:e[1]},feedbackBuffers:{vNext:e[2]}}),t.run({framebuffer:i,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:r.settings.stiffness,damping:r.settings.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),sj(e),this.attributeInTransition.update({buffer:e[1],value:this.attribute.value}),XE(i)[0]>0||r.end(),!0)}cancel(){for(this.transition.cancel(),this.transform.delete();this.buffers.length;)this.buffers.pop().delete();this.texture.delete(),this.texture=null,this.framebuffer.delete(),this.framebuffer=null}}};class $oe{constructor(e,{id:t,timeline:i}){this.id=t,this.gl=e,this.timeline=i,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=wI.isSupported(e)}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:t,numInstances:i}){this.numInstances=i||1;for(const r in e){const s=e[r],o=s.getTransitionSetting(t);!o||this._updateAttribute(r,s,o)}for(const r in this.transitions){const s=e[r];(!s||!s.getTransitionSetting(t))&&this._removeTransition(r)}}hasAttribute(e){const t=this.transitions[e];return t&&t.inProgress}getAttributes(){const e={};for(const t in this.transitions){const i=this.transitions[t];i.inProgress&&(e[t]=i.attributeInTransition)}return e}run(){if(!this.isSupported||0===this.numInstances)return!1;for(const t in this.transitions)this.transitions[t].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].cancel(),delete this.transitions[e]}_updateAttribute(e,t,i){const r=this.transitions[e];let s=!r||r.type!==i.type;if(s){if(!this.isSupported)return void Bi.warn("WebGL2 not supported by this browser. Transition for ".concat(e," is disabled."))();r&&this._removeTransition(e);const o=Goe[i.type];o?this.transitions[e]=new o({attribute:t,timeline:this.timeline,gl:this.gl}):(Bi.error("unsupported transition type '".concat(i.type,"'"))(),s=!1)}(s||t.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(i,this.numInstances))}}const zj="attributeManager.invalidate";class Qoe{constructor(e,{id:t="attribute-manager",stats:i,timeline:r}={}){this.id=t,this.gl=e,this.attributes={},this.updateTriggers={},this.accessors={},this.needsRedraw=!0,this.userData={},this.stats=i,this.attributeTransitionManager=new $oe(e,{id:"".concat(t,"-transitions"),timeline:r}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const t=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,t&&this.id}setNeedsRedraw(e=!0){return this.needsRedraw=!0,this}add(e,t){this._add(e,t)}addInstanced(e,t){this._add(e,t,{instanced:1})}remove(e){for(let t=0;t<e.length;t++){const i=e[t];void 0!==this.attributes[i]&&(this.attributes[i].delete(),delete this.attributes[i])}}invalidate(e,t){const i=this._invalidateTrigger(e,t);Co(zj,this,e,i)}invalidateAll(e){for(const t in this.attributes)this.attributes[t].setNeedsUpdate(t,e);Co(zj,this,"all")}update({data:e,numInstances:t,startIndices:i=null,transitions:r,props:s={},buffers:o={},context:a={}}={}){let l=!1;Co("attributeManager.updateStart",this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const c in this.attributes){const u=this.attributes[c],h=u.settings.accessor;u.startIndices=i,s[c]&&Bi.removed("props.".concat(c),"data.attributes.".concat(c))(),u.setExternalBuffer(o[c])||u.setBinaryValue(o[h],e.startIndices)||!o[h]&&u.setConstantValue(s[h])||u.needsUpdate()&&(l=!0,this._updateAttribute({attribute:u,numInstances:t,data:e,props:s,context:a})),this.needsRedraw|=u.needsRedraw()}l&&Co("attributeManager.updateEnd",this,t),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:t,transitions:r})}updateTransition(){const{attributeTransitionManager:e}=this,t=e.run();return this.needsRedraw=this.needsRedraw||t,t}getAttributes(){return this.attributes}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:t,attributeTransitionManager:i}=this,r=dt({},i.getAttributes());for(const s in t){const o=t[s];o.needsRedraw(e)&&!i.hasAttribute(s)&&(r[s]=o)}return r}getShaderAttributes(e,t={}){e||(e=this.getAttributes());const i={};for(const r in e)t[r]||Object.assign(i,e[r].getShaderAttributes());return i}getAccessors(){return this.updateTriggers}_add(e,t,i={}){t&&Bi.warn("AttributeManager.add({updaters}) - updater map no longer supported")();for(const r in e)this.attributes[r]=this._createAttribute(r,e[r],i);this._mapUpdateTriggersToAttributes()}_createAttribute(e,t,i){const r=Hn(dt({},t),{id:e,isIndexed:t.isIndexed||t.elements||!1,constant:t.constant||!1,size:(t.elements?1:t.size)||1,value:t.value||null,divisor:t.instanced||i.instanced?1:t.divisor||0});return new rI(this.gl,r)}_mapUpdateTriggersToAttributes(){const e={};for(const t in this.attributes)this.attributes[t].getUpdateTriggers().forEach(r=>{e[r]||(e[r]=[]),e[r].push(t)});this.updateTriggers=e}_invalidateTrigger(e,t){const{attributes:i,updateTriggers:r}=this,s=r[e];return s&&s.forEach(o=>{const a=i[o];a&&a.setNeedsUpdate(a.id,t)}),s}_updateAttribute(e){const{attribute:t,numInstances:i}=e;Co("attribute.updateStart",t),t.allocate(i)&&Co("attribute.allocate",t,i),t.updateBuffer(e)&&(this.needsRedraw=!0,Co("attribute.updateEnd",t,i))}}function Gj(n,e,t,i,r){const s=e-n;return(t-e)*r+-s*i+s+e}function $j(n,e){if(Array.isArray(n)){let t=0;for(let i=0;i<n.length;i++){const r=n[i]-e[i];t+=r*r}return Math.sqrt(t)}return Math.abs(n-e)}const tae={interpolation:class extends T0{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:t,toValue:i,duration:r,easing:s}}=this,o=s(e/r);this._value=QE(t,i,o)}},spring:class extends T0{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:t,damping:i,stiffness:r}=this.settings,{_prevValue:s=e,_currValue:o=e}=this;let a=function(n,e,t,i,r){if(Array.isArray(t)){const s=[];for(let o=0;o<t.length;o++)s[o]=Gj(n[o],e[o],t[o],i,r);return s}return Gj(n,e,t,i,r)}(s,o,t,i,r);const l=$j(a,t),c=$j(a,o);l<1e-5&&c<1e-5&&(a=t,this.end()),this._prevValue=o,this._currValue=a}}};class nae{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,t,i,r){const{transitions:s}=this;if(s.has(e)){const l=s.get(e),{value:c=l.settings.fromValue}=l;t=c,this.remove(e)}if(!(r=nj(r)))return;const o=tae[r.type];if(!o)return void Bi.error("unsupported transition type '".concat(r.type,"'"))();const a=new o(this.timeline);a.start(Hn(dt({},r),{fromValue:t,toValue:i})),s.set(e,a)}remove(e){const{transitions:t}=this;t.has(e)&&(t.get(e).cancel(),t.delete(e))}update(){const e={};for(const[t,i]of this.transitions)i.update(),e[t]=i.value,i.inProgress||this.remove(t);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}const hS={COMPONENT:Symbol.for("component"),ASYNC_DEFAULTS:Symbol.for("asyncPropDefaults"),ASYNC_ORIGINAL:Symbol.for("asyncPropOriginal"),ASYNC_RESOLVED:Symbol.for("asyncPropResolved")},{COMPONENT:iae}=hS;function oae(n,e){if(!n.transitions)return null;const t={},i=SI(n);for(const r in n.transitions){const s=i[r],o=s&&s.type;("number"===o||"color"===o||"array"===o)&&EI(n[r],e[r],s)&&(t[r]=!0)}return t}function Wj({newProps:n,oldProps:e,ignoreProps:t={},propTypes:i={},triggerName:r="props"}={}){if(e===n)return null;if("object"!=typeof n||null===n||"object"!=typeof e||null===e)return"".concat(r," changed shallowly");for(const s of Object.keys(n))if(!(s in t)){if(!(s in e))return"".concat(r,".").concat(s," added");const o=EI(n[s],e[s],i[s]);if(o)return"".concat(r,".").concat(s," ").concat(o)}for(const s of Object.keys(e))if(!(s in t)){if(!(s in n))return"".concat(r,".").concat(s," dropped");if(!Object.hasOwnProperty.call(n,s)){const o=EI(n[s],e[s],i[s]);if(o)return"".concat(r,".").concat(s," ").concat(o)}}return null}function EI(n,e,t){let i=t&&t.equal;return i&&!i(n,e,t)||!i&&(i=n&&e&&n.equals,i&&!i.call(n,e))?"changed deeply":i||e===n?null:"changed shallowly"}function cae(n,e){if(null===e)return"oldProps is null, initial diff";const t=e.extensions,{extensions:i}=n;if(i===t)return!1;if(i.length!==t.length)return!0;for(let r=0;r<i.length;r++)if(!i[r].equals(t[r]))return!0;return!1}function qj(n,e,t){let i=n.updateTriggers[t];i=null==i?{}:i;let r=e.updateTriggers[t];return r=null==r?{}:r,Wj({oldProps:r,newProps:i,triggerName:t})}function SI(n){const e=n[iae],t=e&&e.constructor;return t?t._propTypes:{}}function gae(n,e){if(n===e)return!0;if(Array.isArray(n)){const t=n.length;if(!e||e.length!==t)return!1;for(let i=0;i<t;i++)if(n[i]!==e[i])return!1;return!0}return!1}function fS(n){let t,e={};return i=>{for(const r in i)if(!gae(i[r],e[r])){t=n(i),e=i;break}return t}}function mae(n,e){if(!e)return n;const t=dt(dt({},n),e);if("defines"in e&&(t.defines=dt(dt({},n.defines),e.defines)),"modules"in e&&(t.modules=(n.modules||[]).concat(e.modules),e.modules.some(i=>"project64"===i.name))){const i=t.modules.findIndex(r=>"project32"===r.name);i>=0&&t.modules.splice(i,1)}if("inject"in e)if(n.inject){const i=dt({},n.inject);for(const r in e.inject)i[r]=(i[r]||"")+e.inject[r];t.inject=i}else t.inject=e.inject;return t}function xI(n,e){var t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=e[9],p=e[10],g=e[11],m=e[12],w=e[13],x=e[14],H=e[15],I=t*a-i*o,oe=t*l-r*o,Se=t*c-s*o,Pe=i*l-r*a,Be=i*c-s*a,He=r*c-s*l,vt=u*w-h*m,St=u*x-p*m,Ct=u*H-g*m,Zt=h*x-p*w,en=h*H-g*w,xt=p*H-g*x,At=I*xt-oe*en+Se*Zt+Pe*Ct-Be*St+He*vt;return At?(n[0]=(a*xt-l*en+c*Zt)*(At=1/At),n[1]=(r*en-i*xt-s*Zt)*At,n[2]=(w*He-x*Be+H*Pe)*At,n[3]=(p*Be-h*He-g*Pe)*At,n[4]=(l*Ct-o*xt-c*St)*At,n[5]=(t*xt-r*Ct+s*St)*At,n[6]=(x*Se-m*He-H*oe)*At,n[7]=(u*He-p*Se+g*oe)*At,n[8]=(o*en-a*Ct+c*vt)*At,n[9]=(i*Ct-t*en-s*vt)*At,n[10]=(m*Be-w*Se+H*I)*At,n[11]=(h*Se-u*Be-g*I)*At,n[12]=(a*St-o*Zt-l*vt)*At,n[13]=(t*Zt-i*St+r*vt)*At,n[14]=(w*oe-m*Pe-x*I)*At,n[15]=(u*Pe-h*oe+p*I)*At,n):null}function If(n,e,t){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],p=e[9],g=e[10],m=e[11],w=e[12],x=e[13],H=e[14],I=e[15],oe=t[0],Se=t[1],Pe=t[2],Be=t[3];return n[0]=oe*i+Se*a+Pe*h+Be*w,n[1]=oe*r+Se*l+Pe*p+Be*x,n[2]=oe*s+Se*c+Pe*g+Be*H,n[3]=oe*o+Se*u+Pe*m+Be*I,n[4]=(oe=t[4])*i+(Se=t[5])*a+(Pe=t[6])*h+(Be=t[7])*w,n[5]=oe*r+Se*l+Pe*p+Be*x,n[6]=oe*s+Se*c+Pe*g+Be*H,n[7]=oe*o+Se*u+Pe*m+Be*I,n[8]=(oe=t[8])*i+(Se=t[9])*a+(Pe=t[10])*h+(Be=t[11])*w,n[9]=oe*r+Se*l+Pe*p+Be*x,n[10]=oe*s+Se*c+Pe*g+Be*H,n[11]=oe*o+Se*u+Pe*m+Be*I,n[12]=(oe=t[12])*i+(Se=t[13])*a+(Pe=t[14])*h+(Be=t[15])*w,n[13]=oe*r+Se*l+Pe*p+Be*x,n[14]=oe*s+Se*c+Pe*g+Be*H,n[15]=oe*o+Se*u+Pe*m+Be*I,n}function pS(n,e,t){var o,a,l,c,u,h,p,g,m,w,x,H,i=t[0],r=t[1],s=t[2];return e===n?(n[12]=e[0]*i+e[4]*r+e[8]*s+e[12],n[13]=e[1]*i+e[5]*r+e[9]*s+e[13],n[14]=e[2]*i+e[6]*r+e[10]*s+e[14],n[15]=e[3]*i+e[7]*r+e[11]*s+e[15]):(a=e[1],l=e[2],c=e[3],u=e[4],h=e[5],p=e[6],g=e[7],m=e[8],w=e[9],x=e[10],H=e[11],n[0]=o=e[0],n[1]=a,n[2]=l,n[3]=c,n[4]=u,n[5]=h,n[6]=p,n[7]=g,n[8]=m,n[9]=w,n[10]=x,n[11]=H,n[12]=o*i+u*r+m*s+e[12],n[13]=a*i+h*r+w*s+e[13],n[14]=l*i+p*r+x*s+e[14],n[15]=c*i+g*r+H*s+e[15]),n}function gS(n,e,t){var i=t[0],r=t[1],s=t[2];return n[0]=e[0]*i,n[1]=e[1]*i,n[2]=e[2]*i,n[3]=e[3]*i,n[4]=e[4]*r,n[5]=e[5]*r,n[6]=e[6]*r,n[7]=e[7]*r,n[8]=e[8]*s,n[9]=e[9]*s,n[10]=e[10]*s,n[11]=e[11]*s,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n}function Yj(n,e,t){var i=Math.sin(t),r=Math.cos(t),s=e[4],o=e[5],a=e[6],l=e[7],c=e[8],u=e[9],h=e[10],p=e[11];return e!==n&&(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[4]=s*r+c*i,n[5]=o*r+u*i,n[6]=a*r+h*i,n[7]=l*r+p*i,n[8]=c*r-s*i,n[9]=u*r-o*i,n[10]=h*r-a*i,n[11]=p*r-l*i,n}function Kj(n,e,t){var i=Math.sin(t),r=Math.cos(t),s=e[0],o=e[1],a=e[2],l=e[3],c=e[4],u=e[5],h=e[6],p=e[7];return e!==n&&(n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=s*r+c*i,n[1]=o*r+u*i,n[2]=a*r+h*i,n[3]=l*r+p*i,n[4]=c*r-s*i,n[5]=u*r-o*i,n[6]=h*r-a*i,n[7]=p*r-l*i,n}function Qj(n,e,t){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n}function mS(n,e,t){var i=e[0],r=e[1],s=e[2],o=e[3];return n[0]=t[0]*i+t[4]*r+t[8]*s+t[12]*o,n[1]=t[1]*i+t[5]*r+t[9]*s+t[13]*o,n[2]=t[2]*i+t[6]*r+t[10]*s+t[14]*o,n[3]=t[3]*i+t[7]*r+t[11]*s+t[15]*o,n}function Zj(n,e,t){var i=e[0],r=e[1],s=e[2],o=t[0],a=t[1],l=t[2],c=t[3],u=c*i+a*s-l*r,h=c*r+l*i-o*s,p=c*s+o*r-a*i,g=-o*i-a*r-l*s;return n[0]=u*c+g*-o+h*-l-p*-a,n[1]=h*c+g*-a+p*-o-u*-l,n[2]=p*c+g*-l+u*-a-h*-o,n[3]=e[3],n}!function(){var n=new ha(4);ha!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0,n[3]=0)}();const Jj=[0,0,0,0],Uae=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],zae=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Hae=[0,0,0],Gae=[0,0,0],$ae=fS(function({viewport:n,devicePixelRatio:e,coordinateSystem:t,coordinateOrigin:i}){const{projectionCenter:r,viewProjectionMatrix:s,originCommon:o,cameraPosCommon:a,shaderCoordinateOrigin:l,geospatialOrigin:c}=function(n,e,t){const{viewMatrixUncentered:i,projectionMatrix:r}=n;let{viewMatrix:s,viewProjectionMatrix:o}=n,a=Jj,l=Jj,c=n.cameraPosition;const{geospatialOrigin:u,shaderCoordinateOrigin:h,offsetMode:p}=eU(n,e,t);return p&&(l=n.projectPosition(u||h),c=[c[0]-l[0],c[1]-l[1],c[2]-l[2]],l[3]=1,a=mS([],l,o),s=i||s,o=If([],r,s),o=If([],o,Uae)),{viewMatrix:s,viewProjectionMatrix:o,projectionCenter:a,originCommon:l,cameraPosCommon:c,shaderCoordinateOrigin:h,geospatialOrigin:u}}(n,t,i),u=n.getDistanceScales(),h=[n.width*e,n.height*e],p=n.projectionMatrix.transform([0,0,-n.focalDistance,1])[3]||1,g={project_uCoordinateSystem:t,project_uProjectionMode:n.projectionMode,project_uCoordinateOrigin:l,project_uCommonOrigin:o.slice(0,3),project_uCenter:r,project_uViewportSize:h,project_uDevicePixelRatio:e,project_uFocalDistance:p,project_uCommonUnitsPerMeter:u.unitsPerMeter,project_uCommonUnitsPerWorldUnit:u.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:Hae,project_uScale:n.scale,project_uViewProjectionMatrix:s,project_uCameraPosition:a};if(c){const m=n.getDistanceScales(c);switch(t){case Pi.METER_OFFSETS:g.project_uCommonUnitsPerWorldUnit=m.unitsPerMeter,g.project_uCommonUnitsPerWorldUnit2=m.unitsPerMeter2;break;case Pi.LNGLAT:case Pi.LNGLAT_OFFSETS:g.project_uCommonUnitsPerWorldUnit=m.unitsPerDegree,g.project_uCommonUnitsPerWorldUnit2=m.unitsPerDegree2;break;case Pi.CARTESIAN:g.project_uCommonUnitsPerWorldUnit=[1,1,m.unitsPerMeter[2]],g.project_uCommonUnitsPerWorldUnit2=[0,0,m.unitsPerMeter2[2]]}}return g});function eU(n,e,t=Gae){let r,i=t,s=!0;switch(r=e===Pi.LNGLAT_OFFSETS||e===Pi.METER_OFFSETS?t:n.isGeospatial?[Math.fround(n.longitude),Math.fround(n.latitude),0]:null,n.projectionMode){case qc.WEB_MERCATOR:(e===Pi.LNGLAT||e===Pi.CARTESIAN)&&(s=!1);break;case qc.WEB_MERCATOR_AUTO_OFFSET:e===Pi.LNGLAT?i=r:e===Pi.CARTESIAN&&(i=[Math.fround(n.center[0]),Math.fround(n.center[1]),0],r=n.unprojectPosition(i),i[0]-=t[0],i[1]-=t[1],i[2]-=t[2]);break;case qc.IDENTITY:i=n.position.map(Math.fround);break;case qc.GLOBE:s=!1,r=null;break;default:s=!1}return i[2]=i[2]||0,{geospatialOrigin:r,shaderCoordinateOrigin:i,offsetMode:s}}class tU extends ZE{get ELEMENTS(){return qu(!1),0}get RANK(){return qu(!1),0}toString(){let e="[";if(xr.printRowMajor){e+="row-major:";for(let t=0;t<this.RANK;++t)for(let i=0;i<this.RANK;++i)e+=` ${this[i*this.RANK+t]}`}else{e+="column-major:";for(let t=0;t<this.ELEMENTS;++t)e+=` ${this[t]}`}return e+="]",e}getElementIndex(e,t){return t*this.RANK+e}getElement(e,t){return this[t*this.RANK+e]}setElement(e,t,i){return this[t*this.RANK+e]=tr(i),this}getColumn(e,t=new Array(this.RANK).fill(-0)){const i=e*this.RANK;for(let r=0;r<this.RANK;++r)t[r]=this[i+r];return t}setColumn(e,t){const i=e*this.RANK;for(let r=0;r<this.RANK;++r)this[i+r]=t[r];return this}}function _S(n,e,t){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n}function nU(n,e){return n[0]=-e[0],n[1]=-e[1],n}function iU(n,e,t,i){var r=e[0],s=e[1];return n[0]=r+i*(t[0]-r),n[1]=s+i*(t[1]-s),n}function rU(n,e,t){var i=e[0],r=e[1];return n[0]=t[0]*i+t[3]*r+t[6],n[1]=t[1]*i+t[4]*r+t[7],n}!function(){var n=new ha(2);ha!=Float32Array&&(n[0]=0,n[1]=0)}();const sU=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),Qae=Object.freeze([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Zae=Object.freeze({COL0ROW0:0,COL0ROW1:1,COL0ROW2:2,COL0ROW3:3,COL1ROW0:4,COL1ROW1:5,COL1ROW2:6,COL1ROW3:7,COL2ROW0:8,COL2ROW1:9,COL2ROW2:10,COL2ROW3:11,COL3ROW0:12,COL3ROW1:13,COL3ROW2:14,COL3ROW3:15}),$g={};class Wn extends tU{static get IDENTITY(){return $g.IDENTITY=$g.IDENTITY||Object.freeze(new Wn(sU)),$g.IDENTITY}static get ZERO(){return $g.ZERO=$g.ZERO||Object.freeze(new Wn(Qae)),$g.ZERO}get INDICES(){return Zae}get ELEMENTS(){return 16}get RANK(){return 4}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,t,i,r,s,o,a,l,c,u,h,p,g,m,w,x){return this[0]=e,this[1]=t,this[2]=i,this[3]=r,this[4]=s,this[5]=o,this[6]=a,this[7]=l,this[8]=c,this[9]=u,this[10]=h,this[11]=p,this[12]=g,this[13]=m,this[14]=w,this[15]=x,this.check()}setRowMajor(e,t,i,r,s,o,a,l,c,u,h,p,g,m,w,x){return this[0]=e,this[1]=s,this[2]=c,this[3]=g,this[4]=t,this[5]=o,this[6]=u,this[7]=m,this[8]=i,this[9]=a,this[10]=h,this[11]=w,this[12]=r,this[13]=l,this[14]=p,this[15]=x,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(sU)}fromQuaternion(e){return function(n,e){var t=e[0],i=e[1],r=e[2],s=e[3],o=t+t,a=i+i,l=r+r,c=t*o,u=i*o,h=i*a,p=r*o,g=r*a,m=r*l,w=s*o,x=s*a,H=s*l;n[0]=1-h-m,n[1]=u+H,n[2]=p-x,n[3]=0,n[4]=u-H,n[5]=1-c-m,n[6]=g+w,n[7]=0,n[8]=p+x,n[9]=g-w,n[10]=1-c-h,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1}(this,e),this.check()}frustum({left:e,right:t,bottom:i,top:r,near:s,far:o}){return o===1/0?Wn._computeInfinitePerspectiveOffCenter(this,e,t,i,r,s):function(n,e,t,i,r,s,o){var a=1/(t-e),l=1/(r-i),c=1/(s-o);n[0]=2*s*a,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=2*s*l,n[6]=0,n[7]=0,n[8]=(t+e)*a,n[9]=(r+i)*l,n[10]=(o+s)*c,n[11]=-1,n[12]=0,n[13]=0,n[14]=o*s*2*c,n[15]=0}(this,e,t,i,r,s,o),this.check()}static _computeInfinitePerspectiveOffCenter(e,t,i,r,s,o){const l=2*o/(s-r),c=(i+t)/(i-t),u=(s+r)/(s-r),g=-2*o;return e[0]=2*o/(i-t),e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=l,e[6]=0,e[7]=0,e[8]=c,e[9]=u,e[10]=-1,e[11]=-1,e[12]=0,e[13]=0,e[14]=g,e[15]=0,e}lookAt(e,t,i){return 1===arguments.length&&({eye:e,center:t,up:i}=e),function(n,e,t,i){var r,s,o,a,l,c,u,h,p,g,m=e[0],w=e[1],x=e[2],H=i[0],I=i[1],oe=i[2],Se=t[0],Pe=t[1],Be=t[2];Math.abs(m-Se)<Xc&&Math.abs(w-Pe)<Xc&&Math.abs(x-Be)<Xc?function(n){n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1}(n):(u=m-Se,h=w-Pe,p=x-Be,r=I*(p*=g=1/Math.hypot(u,h,p))-oe*(h*=g),s=oe*(u*=g)-H*p,o=H*h-I*u,(g=Math.hypot(r,s,o))?(r*=g=1/g,s*=g,o*=g):(r=0,s=0,o=0),a=h*o-p*s,l=p*r-u*o,c=u*s-h*r,(g=Math.hypot(a,l,c))?(a*=g=1/g,l*=g,c*=g):(a=0,l=0,c=0),n[0]=r,n[1]=a,n[2]=u,n[3]=0,n[4]=s,n[5]=l,n[6]=h,n[7]=0,n[8]=o,n[9]=c,n[10]=p,n[11]=0,n[12]=-(r*m+s*w+o*x),n[13]=-(a*m+l*w+c*x),n[14]=-(u*m+h*w+p*x),n[15]=1)}(this,e,t=t||[0,0,0],i=i||[0,1,0]),this.check()}ortho({left:e,right:t,bottom:i,top:r,near:s=.1,far:o=500}){return function(n,e,t,i,r,s,o){var a=1/(e-t),l=1/(i-r),c=1/(s-o);n[0]=-2*a,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*l,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*c,n[11]=0,n[12]=(e+t)*a,n[13]=(r+i)*l,n[14]=(o+s)*c,n[15]=1}(this,e,t,i,r,s,o),this.check()}orthographic({fovy:e=45*Math.PI/180,aspect:t=1,focalDistance:i=1,near:r=.1,far:s=500}){if(e>2*Math.PI)throw Error("radians");const a=i*Math.tan(e/2),l=a*t;return(new Wn).ortho({left:-l,right:l,bottom:-a,top:a,near:r,far:s})}perspective({fovy:e,fov:t=45*Math.PI/180,aspect:i=1,near:r=.1,far:s=500}={}){if((e=e||t)>2*Math.PI)throw Error("radians");return function(n,e,t,i,r){var o,s=1/Math.tan(e/2);n[0]=s/t,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=s,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,null!=r&&r!==1/0?(n[10]=(r+i)*(o=1/(i-r)),n[14]=2*r*i*o):(n[10]=-1,n[14]=-2*i)}(this,e,i,r,s),this.check()}determinant(){return function(n){var e=n[0],t=n[1],i=n[2],r=n[3],s=n[4],o=n[5],a=n[6],l=n[7],c=n[8],u=n[9],h=n[10],p=n[11],g=n[12],m=n[13],w=n[14],x=n[15];return(e*o-t*s)*(h*x-p*w)-(e*a-i*s)*(u*x-p*m)+(e*l-r*s)*(u*w-h*m)+(t*a-i*o)*(c*x-p*g)-(t*l-r*o)*(c*w-h*g)+(i*l-r*a)*(c*m-u*g)}(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e=[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],t=null){const i=this.getScale(t||[-0,-0,-0]),r=1/i[0],s=1/i[1],o=1/i[2];return e[0]=this[0]*r,e[1]=this[1]*s,e[2]=this[2]*o,e[3]=0,e[4]=this[4]*r,e[5]=this[5]*s,e[6]=this[6]*o,e[7]=0,e[8]=this[8]*r,e[9]=this[9]*s,e[10]=this[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e=[-0,-0,-0,-0,-0,-0,-0,-0,-0],t=null){const i=this.getScale(t||[-0,-0,-0]),r=1/i[0],s=1/i[1],o=1/i[2];return e[0]=this[0]*r,e[1]=this[1]*s,e[2]=this[2]*o,e[3]=this[4]*r,e[4]=this[5]*s,e[5]=this[6]*o,e[6]=this[8]*r,e[7]=this[9]*s,e[8]=this[10]*o,e}transpose(){return function(n,e){if(n===e){var t=e[1],i=e[2],r=e[3],s=e[6],o=e[7],a=e[11];n[1]=e[4],n[2]=e[8],n[3]=e[12],n[4]=t,n[6]=e[9],n[7]=e[13],n[8]=i,n[9]=s,n[11]=e[14],n[12]=r,n[13]=o,n[14]=a}else n[0]=e[0],n[1]=e[4],n[2]=e[8],n[3]=e[12],n[4]=e[1],n[5]=e[5],n[6]=e[9],n[7]=e[13],n[8]=e[2],n[9]=e[6],n[10]=e[10],n[11]=e[14],n[12]=e[3],n[13]=e[7],n[14]=e[11],n[15]=e[15]}(this,this),this.check()}invert(){return xI(this,this),this.check()}multiplyLeft(e){return If(this,e,this),this.check()}multiplyRight(e){return If(this,this,e),this.check()}rotateX(e){return Yj(this,this,e),this.check()}rotateY(e){return function(n,e,t){var i=Math.sin(t),r=Math.cos(t),s=e[0],o=e[1],a=e[2],l=e[3],c=e[8],u=e[9],h=e[10],p=e[11];e!==n&&(n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=s*r-c*i,n[1]=o*r-u*i,n[2]=a*r-h*i,n[3]=l*r-p*i,n[8]=s*i+c*r,n[9]=o*i+u*r,n[10]=a*i+h*r,n[11]=l*i+p*r}(this,this,e),this.check()}rotateZ(e){return Kj(this,this,e),this.check()}rotateXYZ([e,t,i]){return this.rotateX(e).rotateY(t).rotateZ(i)}rotateAxis(e,t){return function(n,e,t,i){var l,c,u,h,p,g,m,w,x,H,I,oe,Se,Pe,Be,He,vt,St,Ct,Zt,en,xt,At,Ht,r=i[0],s=i[1],o=i[2],a=Math.hypot(r,s,o);a<Xc||(r*=a=1/a,s*=a,o*=a,l=Math.sin(t),c=Math.cos(t),p=e[1],g=e[2],m=e[3],x=e[5],H=e[6],I=e[7],Se=e[9],Pe=e[10],Be=e[11],Ct=r*s*(u=1-c)-o*l,Zt=s*s*u+c,en=o*s*u+r*l,xt=r*o*u+s*l,At=s*o*u-r*l,Ht=o*o*u+c,n[0]=(h=e[0])*(He=r*r*u+c)+(w=e[4])*(vt=s*r*u+o*l)+(oe=e[8])*(St=o*r*u-s*l),n[1]=p*He+x*vt+Se*St,n[2]=g*He+H*vt+Pe*St,n[3]=m*He+I*vt+Be*St,n[4]=h*Ct+w*Zt+oe*en,n[5]=p*Ct+x*Zt+Se*en,n[6]=g*Ct+H*Zt+Pe*en,n[7]=m*Ct+I*Zt+Be*en,n[8]=h*xt+w*At+oe*Ht,n[9]=p*xt+x*At+Se*Ht,n[10]=g*xt+H*At+Pe*Ht,n[11]=m*xt+I*At+Be*Ht,e!==n&&(n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]))}(this,this,e,t),this.check()}scale(e){return Array.isArray(e)?gS(this,this,e):gS(this,this,[e,e,e]),this.check()}translate(e){return pS(this,this,e),this.check()}transform(e,t){return 4===e.length?(m0(t=mS(t||[-0,-0,-0,-0],e,this),4),t):this.transformAsPoint(e,t)}transformAsPoint(e,t){const{length:i}=e;switch(i){case 2:t=function(n,e,t){var i=e[0],r=e[1];return n[0]=t[0]*i+t[4]*r+t[12],n[1]=t[1]*i+t[5]*r+t[13],n}(t||[-0,-0],e,this);break;case 3:t=ZD(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return m0(t,e.length),t}transformAsVector(e,t){switch(e.length){case 2:t=function(n,e,t){const i=e[0],r=e[1],s=t[3]*i+t[7]*r||1;return n[0]=(t[0]*i+t[4]*r)/s,n[1]=(t[1]*i+t[5]*r)/s,n}(t||[-0,-0],e,this);break;case 3:t=qV(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return m0(t,e.length),t}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,t,i){return this.identity().translate([e,t,i])}transformPoint(e,t){return Bg("Matrix4.transformPoint","3.0"),this.transformAsPoint(e,t)}transformVector(e,t){return Bg("Matrix4.transformVector","3.0"),this.transformAsPoint(e,t)}transformDirection(e,t){return Bg("Matrix4.transformDirection","3.0"),this.transformAsVector(e,t)}}function Wg(n,e){const t=mS([],e,n);return Qj(t,t,1/t[3]),t}function oU(n,e){const t=n%e;return t<0?e+t:t}function aU(n,e,t){return n<e?e:n>t?t:n}const CI=Math.log2||function(n){return Math.log(n)*Math.LOG2E};function Ku(n,e){if(!n)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const lc=Math.PI,lU=lc/4,cc=lc/180,TI=180/lc,AI=4003e4,yS=85.051129;function vS([n,e]){return Ku(Number.isFinite(n)),Ku(Number.isFinite(e)&&e>=-90&&e<=90,"invalid latitude"),[512*(n*cc+lc)/(2*lc),512*(lc+Math.log(Math.tan(lU+e*cc*.5)))/(2*lc)]}function qg([n,e]){const t=n/512*(2*lc)-lc,i=2*(Math.atan(Math.exp(e/512*(2*lc)-lc))-lU);return[t*TI,i*TI]}function MI({latitude:n,longitude:e,highPrecision:t=!1}){Ku(Number.isFinite(n)&&Number.isFinite(e));const i={},s=Math.cos(n*cc),o=512/360,a=o/s,l=512/AI/s;if(i.unitsPerMeter=[l,l,l],i.metersPerUnit=[1/l,1/l,1/l],i.unitsPerDegree=[o,a,l],i.degreesPerUnit=[1/o,1/a,1/l],t){const c=cc*Math.tan(n*cc)/s,h=512/AI*c,p=h/a*l;i.unitsPerDegree2=[0,o*c/2,h],i.unitsPerMeter2=[p,0,p]}return i}function cU(n,e){const[t,i,r]=n,[s,o,a]=e,{unitsPerMeter:l,unitsPerMeter2:c}=MI({longitude:t,latitude:i,highPrecision:!0}),u=vS(n);u[0]+=s*(l[0]+c[0]*o),u[1]+=o*(l[1]+c[1]*o);const h=qg(u),p=(r||0)+(a||0);return Number.isFinite(r)||Number.isFinite(a)?[h[0],h[1],p]:h}function dU(n){return 2*Math.atan(.5/n)*TI}function hU(n,e){const[t,i,r=0]=n;return Ku(Number.isFinite(t)&&Number.isFinite(i)&&Number.isFinite(r)),Wg(e,[t,i,r,1])}function M0(n,e,t=0){const[i,r,s]=n;if(Ku(Number.isFinite(i)&&Number.isFinite(r),"invalid pixel coordinate"),Number.isFinite(s))return Wg(e,[i,r,s,1]);const o=Wg(e,[i,r,0,1]),a=Wg(e,[i,r,1,1]),l=o[2],c=a[2];return iU([],o,a,l===c?0:((t||0)-l)/(c-l))}const fU=Math.PI/180;function pU(n,e,t){const{pixelUnprojectionMatrix:i}=n,r=Wg(i,[e,0,1,1]),s=Wg(i,[e,n.height,1,1]),c=qg(iU([],r,s,(t*n.distanceScales.unitsPerMeter[2]-r[2])/(s[2]-r[2])));return c[2]=t,c}const ule=Math.PI/180,dle=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],II=[0,0,0],fle={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};let Yg=(()=>{class n{constructor(t={}){const{id:i=null,x:r=0,y:s=0,width:o=1,height:a=1}=t;this.id=i||this.constructor.displayName||"viewport",this.x=r,this.y=s,this.width=o||1,this.height=a||1,this._frustumPlanes={},this._initViewMatrix(t),this._initProjectionMatrix(t),this._initPixelMatrices(),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?qc.WEB_MERCATOR:qc.WEB_MERCATOR_AUTO_OFFSET:qc.IDENTITY}equals(t){return t instanceof n&&(this===t||t.width===this.width&&t.height===this.height&&t.scale===this.scale&&g0(t.projectionMatrix,this.projectionMatrix)&&g0(t.viewMatrix,this.viewMatrix))}project(t,{topLeft:i=!0}={}){const s=hU(this.projectPosition(t),this.pixelProjectionMatrix),[o,a]=s,l=i?a:this.height-a;return 2===t.length?[o,l]:[o,l,s[2]]}unproject(t,{topLeft:i=!0,targetZ:r}={}){const[s,o,a]=t,u=M0([s,i?o:this.height-o,a],this.pixelUnprojectionMatrix,r&&r*this.distanceScales.unitsPerMeter[2]),[h,p,g]=this.unprojectPosition(u);return Number.isFinite(a)?[h,p,g]:Number.isFinite(r)?[h,p,r]:[h,p]}projectPosition(t){const[i,r]=this.projectFlat(t);return[i,r,(t[2]||0)*this.distanceScales.unitsPerMeter[2]]}unprojectPosition(t){const[i,r]=this.unprojectFlat(t);return[i,r,(t[2]||0)*this.distanceScales.metersPerUnit[2]]}projectFlat(t){return this.isGeospatial?vS(t):t}unprojectFlat(t){return this.isGeospatial?qg(t):t}getBounds(t={}){const i={targetZ:t.z||0},r=this.unproject([0,0],i),s=this.unproject([this.width,0],i),o=this.unproject([0,this.height],i),a=this.unproject([this.width,this.height],i);return[Math.min(r[0],s[0],o[0],a[0]),Math.min(r[1],s[1],o[1],a[1]),Math.max(r[0],s[0],o[0],a[0]),Math.max(r[1],s[1],o[1],a[1])]}getDistanceScales(t=null){return t?MI({longitude:t[0],latitude:t[1],highPrecision:!0}):this.distanceScales}containsPixel({x:t,y:i,width:r=1,height:s=1}){return t<this.x+this.width&&this.x<t+r&&i<this.y+this.height&&this.y<i+s}getFrustumPlanes(){return this._frustumPlanes.near||Object.assign(this._frustumPlanes,function(n){const e={};return e.left=Vg(n[3]+n[0],n[7]+n[4],n[11]+n[8],n[15]+n[12]),e.right=Vg(n[3]-n[0],n[7]-n[4],n[11]-n[8],n[15]-n[12]),e.bottom=Vg(n[3]+n[1],n[7]+n[5],n[11]+n[9],n[15]+n[13]),e.top=Vg(n[3]-n[1],n[7]-n[5],n[11]-n[9],n[15]-n[13]),e.near=Vg(n[3]+n[2],n[7]+n[6],n[11]+n[10],n[15]+n[14]),e.far=Vg(n[3]-n[2],n[7]-n[6],n[11]-n[10],n[15]-n[14]),e}(this.viewProjectionMatrix)),this._frustumPlanes}panByPosition(t,i){return null}getCameraPosition(){return this.cameraPosition}getCameraDirection(){return this.cameraDirection}getCameraUp(){return this.cameraUp}_createProjectionMatrix({orthographic:t,fovyRadians:i,aspect:r,focalDistance:s,near:o,far:a}){return t?(new Wn).orthographic({fovy:i,aspect:r,focalDistance:s,near:o,far:a}):(new Wn).perspective({fovy:i,aspect:r,near:o,far:a})}_initViewMatrix(t){const{viewMatrix:i=dle,longitude:r=null,latitude:s=null,zoom:o=null,position:a=null,modelMatrix:l=null,focalDistance:c=1,distanceScales:u=null}=t;this.isGeospatial=Number.isFinite(s)&&Number.isFinite(r),this.zoom=o,Number.isFinite(this.zoom)||(this.zoom=this.isGeospatial?function({latitude:n}){Ku(Number.isFinite(n));const e=Math.cos(n*cc);return function(n){return CI(n)}(AI*e)-9}({latitude:s})+Math.log2(c):0);const h=Math.pow(2,this.zoom);this.scale=h,this.distanceScales=this.isGeospatial?MI({latitude:s,longitude:r}):u||fle,this.focalDistance=c,this.distanceScales.metersPerUnit=new xo(this.distanceScales.metersPerUnit),this.distanceScales.unitsPerMeter=new xo(this.distanceScales.unitsPerMeter),this.position=II,this.meterOffset=II,a&&(this.position=a,this.modelMatrix=l,this.meterOffset=l?l.transformVector(a):a),this.isGeospatial?(this.longitude=r,this.latitude=s,this.center=this._getCenterInWorld({longitude:r,latitude:s})):this.center=a?this.projectPosition(a):[0,0,0],this.viewMatrixUncentered=i,this.viewMatrix=(new Wn).multiplyRight(this.viewMatrixUncentered).translate(new xo(this.center||II).negate())}_getCenterInWorld({longitude:t,latitude:i}){const{meterOffset:r,distanceScales:s}=this,o=new xo(this.projectPosition([t,i,0]));if(r){const a=new xo(r).scale(s.unitsPerMeter);o.add(a)}return o}_initProjectionMatrix(t){const{projectionMatrix:i=null,orthographic:r=!1,fovyRadians:s,fovy:o=75,near:a=.1,far:l=1e3,focalDistance:c=1}=t;this.projectionMatrix=i||this._createProjectionMatrix({orthographic:r,fovyRadians:s||o*ule,aspect:this.width/this.height,focalDistance:c,near:a,far:l})}_initPixelMatrices(){const t=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];If(t,t,this.projectionMatrix),If(t,t,this.viewMatrix),this.viewProjectionMatrix=t,this.viewMatrixInverse=xI([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=function(n){return[n[12],n[13],n[14]]}(this.viewMatrixInverse);const i=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],r=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];gS(i,i,[this.width/2,-this.height/2,1]),pS(i,i,[1,-1,0]),If(r,i,this.viewProjectionMatrix),this.pixelProjectionMatrix=r,this.viewportMatrix=i,this.pixelUnprojectionMatrix=xI([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||Bi.warn("Pixel project matrix not invertible")()}}return n.displayName="Viewport",n})(),vU=(()=>{class n extends Yg{constructor(t={}){const{latitude:i=0,longitude:r=0,zoom:s=11,pitch:o=0,bearing:a=0,nearZMultiplier:l=.1,farZMultiplier:c=1.01,orthographic:u=!1,repeat:h=!1,worldOffset:p=0}=t;let{width:g,height:m,altitude:w=1.5}=t;const x=Math.pow(2,s);g=g||1,m=m||1,w=Math.max(.75,w);const{fov:H,aspect:I,focalDistance:oe,near:Se,far:Pe}=function({width:n,height:e,fovy:t=dU(1.5),altitude:i,pitch:r=0,nearZMultiplier:s=1,farZMultiplier:o=1}){void 0!==i&&(t=dU(i));const a=.5*t*cc,l=function(n){return.5/Math.tan(.5*n*cc)}(t),c=r*cc,u=Math.sin(a)*l/Math.sin(Math.min(Math.max(Math.PI/2-c-a,.01),Math.PI-.01));return{fov:2*a,aspect:n/e,focalDistance:l,near:s,far:(Math.sin(c)*u+l)*o}}({width:g,height:m,pitch:o,altitude:w,nearZMultiplier:l,farZMultiplier:c});let Be=function({height:n,pitch:e,bearing:t,altitude:i,scale:r,center:s=null}){const o=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return pS(o,o,[0,0,-i]),Yj(o,o,-e*cc),Kj(o,o,t*cc),gS(o,o,[r/=n,r,r]),s&&pS(o,o,function(n,e){return n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n}([],s)),o}({height:m,pitch:o,bearing:a,scale:x,altitude:w});p&&(Be=(new Wn).translate([512*p,0,0]).multiplyLeft(Be)),super(Hn(dt({},t),{width:g,height:m,viewMatrix:Be,longitude:r,latitude:i,zoom:s,orthographic:u,fovyRadians:H,aspect:I,focalDistance:oe,near:Se,far:Pe})),this.latitude=i,this.longitude=r,this.zoom=s,this.pitch=o,this.bearing=a,this.altitude=w,this.orthographic=u,this._subViewports=h?[]:null,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const t=this.getBounds(),i=Math.floor((t[0]+180)/360),r=Math.ceil((t[2]-180)/360);for(let s=i;s<=r;s++){const o=s?new n(Hn(dt({},this),{worldOffset:s})):this;this._subViewports.push(o)}}return this._subViewports}addMetersToLngLat(t,i){return cU(t,i)}panByPosition(t,i){const r=M0(i,this.pixelUnprojectionMatrix),o=_S([],this.projectFlat(t),nU([],r)),a=_S([],this.center,o),[l,c]=this.unprojectFlat(a);return{longitude:l,latitude:c}}getBounds(t={}){const i=function(n,e=0){const{width:t,height:i,unproject:r}=n,s={targetZ:e},o=r([0,i],s),a=r([t,i],s);let l,c;return(n.fovy?.5*n.fovy*fU:Math.atan(.5/n.altitude))>(90-n.pitch)*fU-.01?(l=pU(n,0,e),c=pU(n,t,e)):(l=r([0,0],s),c=r([t,0],s)),[o,a,c,l]}(this,t.z||0);return[Math.min(i[0][0],i[1][0],i[2][0],i[3][0]),Math.min(i[0][1],i[1][1],i[2][1],i[3][1]),Math.max(i[0][0],i[1][0],i[2][0],i[3][0]),Math.max(i[0][1],i[1][1],i[2][1],i[3][1])]}fitBounds(t,i={}){const{width:r,height:s}=this,{longitude:o,latitude:a,zoom:l}=function({width:n,height:e,bounds:t,minExtent:i=0,maxZoom:r=24,padding:s=0,offset:o=[0,0]}){const[[a,l],[c,u]]=t;Number.isFinite(s)?s={top:s,bottom:s,left:s,right:s}:Ku(Number.isFinite(s.top)&&Number.isFinite(s.bottom)&&Number.isFinite(s.left)&&Number.isFinite(s.right));const h=vS([a,aU(u,-yS,yS)]),p=vS([c,aU(l,-yS,yS)]),g=[Math.max(Math.abs(p[0]-h[0]),i),Math.max(Math.abs(p[1]-h[1]),i)],m=[n-s.left-s.right-2*Math.abs(o[0]),e-s.top-s.bottom-2*Math.abs(o[1])];Ku(m[0]>0&&m[1]>0);const w=m[0]/g[0],x=m[1]/g[1],Se=qg([(p[0]+h[0])/2+(s.right-s.left)/2/w,(p[1]+h[1])/2+(s.bottom-s.top)/2/x]),Pe=Math.min(r,CI(Math.abs(Math.min(w,x))));return Ku(Number.isFinite(Pe)),{longitude:Se[0],latitude:Se[1],zoom:Pe}}(dt({width:r,height:s,bounds:t},i));return new n({width:r,height:s,longitude:o,latitude:a,zoom:l})}}return n.displayName="WebMercatorViewport",n})();function OI(n,e,t=!1){const i=e.projectPosition(n);if(t&&e instanceof vU){const[r,s,o=0]=n,a=e.getDistanceScales([r,s]);i[2]=o*a.unitsPerMeter[2]}return i}function bU(n,{viewport:e,modelMatrix:t,coordinateSystem:i,coordinateOrigin:r,offsetMode:s}){let[o,a,l=0]=n;switch(t&&([o,a,l]=mS([],[o,a,l,1],t)),i){case Pi.LNGLAT:return OI([o,a,l],e,s);case Pi.LNGLAT_OFFSETS:return OI([o+r[0],a+r[1],l+(r[2]||0)],e,s);case Pi.METER_OFFSETS:return OI(cU(r,[o,a,l]),e,s);case Pi.CARTESIAN:default:return e.isGeospatial?[o+r[0],a+r[1],l+r[2]]:e.projectPosition([o,a,l])}}const mle={10241:9987,10240:9729,10242:33071,10243:33071},RI={},vle={boolean:{validate:(n,e)=>!0,equal:(n,e,t)=>Boolean(n)===Boolean(e)},number:{validate:(n,e)=>Number.isFinite(n)&&(!("max"in e)||n<=e.max)&&(!("min"in e)||n>=e.min)},color:{validate:(n,e)=>e.optional&&!n||I0(n)&&(3===n.length||4===n.length),equal:(n,e,t)=>NI(n,e)},accessor:{validate(n,e){const t=bS(n);return"function"===t||t===bS(e.value)},equal:(n,e,t)=>"function"==typeof e||NI(n,e)},array:{validate:(n,e)=>e.optional&&!n||I0(n),equal:(n,e,t)=>t.compare?NI(n,e):n===e},function:{validate:(n,e)=>e.optional&&!n||"function"==typeof n,equal:(n,e,t)=>!t.compare||n===e},data:{transform:(n,e,t)=>{const{dataTransform:i}=t?t.props:{};return i&&n?i(n):n}},image:{transform:(n,e,t)=>function(n,e){const t=n.context&&n.context.gl;if(!t||!e)return null;if(e instanceof Pa)return e;e.constructor&&"Object"!==e.constructor.name&&(e={data:e});let i=null;e.compressed&&(i={10241:e.data.length>1?9985:9729});const r=new Pa(t,Hn(dt({},e),{parameters:dt(dt(dt({},mle),i),n.props.textureParameters)}));return RI[r.id]=!0,r}(t,n),release:n=>{!function(n){!n||!(n instanceof Pa)||RI[n.id]&&(n.delete(),delete RI[n.id])}(n)}}};function NI(n,e){if(n===e)return!0;if(!I0(n)||!I0(e))return!1;const t=n.length;if(t!==e.length)return!1;for(let i=0;i<t;i++)if(n[i]!==e[i])return!1;return!0}function wle(n,e){switch(bS(e)){case"object":return D0(n,e);case"array":return D0(n,{type:"array",value:e,compare:!1});case"boolean":return D0(n,{type:"boolean",value:e});case"number":return D0(n,{type:"number",value:e});case"function":return D0(n,{type:"function",value:e,compare:!0});default:return{name:n,type:"unknown",value:e}}}function D0(n,e){return"type"in e?dt(dt({name:n},vle[e.type]),e):"value"in e?dt({name:n,type:bS(e.value)},e):{name:n,type:"object",value:e}}function I0(n){return Array.isArray(n)||ArrayBuffer.isView(n)}function bS(n){return I0(n)?"array":null===n?"null":typeof n}const{COMPONENT:PI,ASYNC_ORIGINAL:wS,ASYNC_RESOLVED:O0,ASYNC_DEFAULTS:ES}=hS;function Ele(){const n=this,e=wU(n.constructor),t=Object.create(e);t[PI]=n,t[wS]={},t[O0]={};for(let i=0;i<arguments.length;++i){const r=arguments[i];for(const s in r)t[s]=r[s]}return Object.freeze(t),t}function wU(n){return SS(n,"_mergedDefaultProps")||(function(n){if(!n.prototype)return;const t=Object.getPrototypeOf(n),i=wU(t),s=function(n){const e={},t={},i={};for(const[r,s]of Object.entries(n))if(s&&s.deprecatedFor)i[r]=Array.isArray(s.deprecatedFor)?s.deprecatedFor:[s.deprecatedFor];else{const o=wle(r,s);e[r]=o,t[r]=o.value}return{propTypes:e,defaultProps:t,deprecatedProps:i}}(SS(n,"defaultProps")||{}),o=function(n,e,t){const i=Object.create(null);Object.assign(i,e,n);const r=function(n){const e=SS(n,"layerName")||SS(n,"componentName");return e||Bi.once(0,"".concat(n.name,".componentName not specified"))(),e||n.name}(t);return delete n.id,Object.defineProperties(i,{id:{writable:!0,value:r}}),i}(s.defaultProps,i,n),a=dt(dt({},t._propTypes),s.propTypes);!function(n,e){const t={},i={};for(const r in e){const s=e[r],{name:o,value:a}=s;s.async&&(t[o]=a,i[o]=Ale(o))}n[ES]=t,n[wS]={},Object.defineProperties(n,i)}(o,a);const l=dt(dt({},t._deprecatedProps),s.deprecatedProps);(function(n,e){for(const t in e)Object.defineProperty(n,t,{enumerable:!1,set(i){const r="".concat(this.id,": ").concat(t);for(const s of e[t])EU(this,s)||(this[s]=i);Bi.deprecated(r,e[t].join("/"))()}})})(o,l),n._mergedDefaultProps=o,n._propTypes=a,n._deprecatedProps=l}(n),n._mergedDefaultProps)}function Ale(n){return{enumerable:!0,set(e){"string"==typeof e||e instanceof Promise||ej(e)?this[wS][n]=e:this[O0][n]=e},get(){if(this[O0]){if(n in this[O0])return this[O0][n]||this[ES][n];if(n in this[wS]){const e=this[PI]&&this[PI].internalState;if(e&&e.hasAsyncProp(n))return e.getAsyncProp(n)||this[ES][n]}}return this[ES][n]}}}function EU(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function SS(n,e){return EU(n,e)&&n[e]}function FI(n){var e;if("undefined"!=typeof Symbol&&(Symbol.asyncIterator&&(e=n[Symbol.asyncIterator]),null==e&&Symbol.iterator&&(e=n[Symbol.iterator])),null==e&&(e=n["@@asyncIterator"]),null==e&&(e=n["@@iterator"]),null==e)throw new TypeError("Object is not async iterable");return e.call(n)}const{ASYNC_ORIGINAL:Dle,ASYNC_RESOLVED:Ile,ASYNC_DEFAULTS:Ole}=hS,Rle=Object.freeze({});class SU{constructor(e=null){this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=Rle,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const t=this.asyncProps[e];t.type&&t.type.release&&t.type.release(t.resolvedValue,t.type,this.component)}}getOldProps(){return this.oldAsyncProps||this.oldProps}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component.props}freezeAsyncOldProps(){if(!this.oldAsyncProps){this.oldProps=this.oldProps||this.component.props,this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const t=this.asyncProps[e];return t&&t.resolvedValue}isAsyncPropLoading(e){if(e){const t=this.asyncProps[e];return Boolean(t&&t.pendingLoadCount>0&&t.pendingLoadCount!==t.resolvedLoadCount)}for(const t in this.asyncProps)if(this.isAsyncPropLoading(t))return!0;return!1}reloadAsyncProp(e,t){this._watchPromise(e,Promise.resolve(t))}setAsyncProps(e){const t=e[Ile]||{},i=e[Dle]||e,r=e[Ole]||{};for(const s in t){const o=t[s];this._createAsyncPropData(s,r[s]),this._updateAsyncProp(s,o),t[s]=this.getAsyncProp(s)}for(const s in i){const o=i[s];this._createAsyncPropData(s,r[s]),this._updateAsyncProp(s,o)}}_updateAsyncProp(e,t){if(this._didAsyncInputValueChange(e,t)){if("string"==typeof t){var i;const r=null===(i=this.layer)||void 0===i?void 0:i.props.fetch;r&&(t=r(t,{propName:e,layer:this.layer}))}if(t instanceof Promise)return void this._watchPromise(e,t);if(ej(t))return void this._resolveAsyncIterable(e,t);this._setPropValue(e,t)}}_didAsyncInputValueChange(e,t){const i=this.asyncProps[e];return t!==i.resolvedValue&&t!==i.lastValue&&(i.lastValue=t,!0)}_setPropValue(e,t){const i=this.asyncProps[e];t=this._postProcessValue(i,t),i.resolvedValue=t,i.pendingLoadCount++,i.resolvedLoadCount=i.pendingLoadCount}_setAsyncPropValue(e,t,i){const r=this.asyncProps[e];r&&i>=r.resolvedLoadCount&&void 0!==t&&(this.freezeAsyncOldProps(),r.resolvedValue=t,r.resolvedLoadCount=i,this.onAsyncPropUpdated(e,t))}_watchPromise(e,t){const i=this.asyncProps[e];i.pendingLoadCount++;const r=i.pendingLoadCount;t.then(s=>{var o;s=this._postProcessValue(i,s),this._setAsyncPropValue(e,s,r);const a=null===(o=this.layer)||void 0===o?void 0:o.props.onDataLoad;"data"===e&&a&&a(s,{propName:e,layer:this.layer})}).catch(s=>{var o;null===(o=this.layer)||void 0===o||o.raiseError(s,"loading ".concat(e," of ").concat(this.layer))})}_resolveAsyncIterable(e,t){var i=this;return ii(function*(){var r;"data"!==e&&i._setPropValue(e,t);const s=i.asyncProps[e];s.pendingLoadCount++;const o=s.pendingLoadCount;let a=[],l=0;var h,c=!0,u=!1;try{for(var g,m,p=FI(t);c=(g=yield p.next()).done,m=yield g.value,!c;c=!0){const x=m,{dataTransform:H}=i.component?i.component.props:{};a=H?H(x,a):a.concat(x),Object.defineProperty(a,"__diff",{enumerable:!1,value:[{startRow:l,endRow:a.length}]}),l=a.length,i._setAsyncPropValue(e,a,o)}}catch(x){u=!0,h=x}finally{try{!c&&null!=p.return&&(yield p.return())}finally{if(u)throw h}}const w=null===(r=i.layer)||void 0===r?void 0:r.props.onDataLoad;w&&w(a,{propName:e,layer:i.layer})})()}_postProcessValue(e,t){const i=e.type;return i&&(i.release&&i.release(e.resolvedValue,i,this.component),i.transform)?i.transform(t,i,this.component):t}_createAsyncPropData(e,t){if(!this.asyncProps[e]){const r=this.component&&this.component.constructor._propTypes;this.asyncProps[e]={type:r&&r[e],lastValue:null,resolvedValue:t,pendingLoadCount:0,resolvedLoadCount:0}}}}const{ASYNC_ORIGINAL:xU,ASYNC_RESOLVED:CU,ASYNC_DEFAULTS:Nle}=hS,Ple={};let Fle=0,Lle=(()=>{class n{constructor(){this.props=Ele.apply(this,arguments),this.id=this.props.id,this.count=Fle++,this.lifecycle="Awaiting state",this.parent=null,this.context=null,this.state=null,this.internalState=null,Object.seal(this)}clone(t){const{props:i}=this,r={};for(const s in i[Nle])s in i[CU]?r[s]=i[CU][s]:s in i[xU]&&(r[s]=i[xU][s]);return new this.constructor(dt(dt(dt({},i),r),t))}get stats(){return this.internalState.stats}_initState(){this.internalState=new SU({})}}return n.componentName="Component",n.defaultProps=Ple,n})();class kle extends SU{constructor({attributeManager:e,layer:t}){super(t),this.attributeManager=e,this.model=null,this.needsRedraw=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}set layer(e){this.component=e}}const uc=n=>"function"==typeof n,ch=n=>null!==n&&"object"==typeof n,AU=n=>ch(n)&&n.constructor==={}.constructor,Ble=n=>n&&"function"==typeof n[Symbol.iterator],Vle=n=>n&&"function"==typeof n[Symbol.asyncIterator],R0=n=>"undefined"!=typeof Response&&n instanceof Response||n&&n.arrayBuffer&&n.text&&n.json,Kg=n=>"undefined"!=typeof Blob&&n instanceof Blob,MU=n=>(n=>"undefined"!=typeof ReadableStream&&n instanceof ReadableStream||ch(n)&&uc(n.tee)&&uc(n.cancel)&&uc(n.getReader))(n)||(n=>ch(n)&&uc(n.read)&&uc(n.pipe)&&(n=>"boolean"==typeof n)(n.readable))(n);function Of(n,e){if(!n)throw new Error(e||"loader assertion failed.")}function LI(n){var e;return!!n&&(Array.isArray(n)&&(n=n[0]),Array.isArray(null===(e=n)||void 0===e?void 0:e.extensions))}function kI(n){var e,t;let i;return Of(n,"null loader"),Of(LI(n),"invalid loader"),Array.isArray(n)&&(i=n[1],n=Hn(dt({},n=n[0]),{options:dt(dt({},n.options),i)})),(null!==(e=n)&&void 0!==e&&e.parseTextSync||null!==(t=n)&&void 0!==t&&t.parseText)&&(n.text=!0),n.text||(n.binary=!0),n}const Qc={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document},BI=Qc.global||Qc.self||Qc.window||{},$le="object"!=typeof process||"[object process]"!==String(process)||process.browser,DU="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version);DU&&parseFloat(DU[1]);const jI={};function Wle(n){for(const e in jI)n.startsWith(e)&&(n=n.replace(e,jI[e]));return!n.startsWith("http://")&&!n.startsWith("https://")&&(n=`${n}`),n}const qle=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,Yle=/^([-\w.]+\/[-\w.+]+)/;function Kle(n){const e=Yle.exec(n);return e?e[1]:n}function IU(n){const e=qle.exec(n);return e?e[1]:""}const Xle=/\?.*/;function xS(n){if(R0(n)){const e=UI(n.url||"");return{url:e,type:Kle(n.headers.get("content-type")||"")||IU(e)}}return Kg(n)?{url:UI(n.name||""),type:n.type||""}:"string"==typeof n?{url:UI(n),type:IU(n)}:{url:"",type:""}}function Qle(n){return R0(n)?n.headers["content-length"]||-1:Kg(n)?n.size:"string"==typeof n?n.length:n instanceof ArrayBuffer||ArrayBuffer.isView(n)?n.byteLength:-1}function UI(n){return n.replace(Xle,"")}function OU(n){return zI.apply(this,arguments)}function zI(){return(zI=ii(function*(n){if(R0(n))return n;const e={},t=Qle(n);t>=0&&(e["content-length"]=String(t));const{url:i,type:r}=xS(n);r&&(e["content-type"]=r);const s=yield ece(n);s&&(e["x-first-bytes"]=s),"string"==typeof n&&(n=(new TextEncoder).encode(n));const o=new Response(n,{headers:e});return Object.defineProperty(o,"url",{value:i}),o})).apply(this,arguments)}function Zle(n){return HI.apply(this,arguments)}function HI(){return(HI=ii(function*(n){if(!n.ok){const e=yield Jle(n);throw new Error(e)}})).apply(this,arguments)}function Jle(n){return GI.apply(this,arguments)}function GI(){return(GI=ii(function*(n){let e=`Failed to fetch resource ${n.url} (${n.status}): `;try{const t=n.headers.get("Content-Type");let i=n.statusText;t.includes("application/json")&&(i+=` ${yield n.text()}`),e+=i,e=e.length>60?`${e.slice(60)}...`:e}catch(t){}return e})).apply(this,arguments)}function ece(n){return $I.apply(this,arguments)}function $I(){return($I=ii(function*(n){if("string"==typeof n)return`data:,${n.slice(0,5)}`;if(n instanceof Blob){const t=n.slice(0,5);return yield new Promise(i=>{const r=new FileReader;r.onload=s=>{var o;return i(null==s||null===(o=s.target)||void 0===o?void 0:o.result)},r.readAsDataURL(t)})}return n instanceof ArrayBuffer?`data:base64,${tce(n.slice(0,5))}`:null})).apply(this,arguments)}function tce(n){let e="";const t=new Uint8Array(n);for(let i=0;i<t.byteLength;i++)e+=String.fromCharCode(t[i]);return btoa(e)}function RU(n,e){return WI.apply(this,arguments)}function WI(){return(WI=ii(function*(n,e){if("string"==typeof n){n=Wle(n);let t=e;return null!=e&&e.fetch&&"function"!=typeof(null==e?void 0:e.fetch)&&(t=e.fetch),yield fetch(n,t)}return yield OU(n)})).apply(this,arguments)}function qn(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}const NU=new PD({id:"loaders.gl"});class nce{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}const PU={fetch:null,mimeType:void 0,nothrow:!1,log:new class{constructor(){qn(this,"console",void 0),this.console=console}log(...e){return this.console.log.bind(this.console,...e)}info(...e){return this.console.info.bind(this.console,...e)}warn(...e){return this.console.warn.bind(this.console,...e)}error(...e){return this.console.error.bind(this.console,...e)}},CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},rce={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function qI(){BI.loaders=BI.loaders||{};const{loaders:n}=BI;return n._state=n._state||{},n._state}const YI=()=>{const n=qI();return n.globalOptions=n.globalOptions||dt({},PU),n.globalOptions};function sce(n,e,t,i){return t=t||[],function(n,e){LU(n,null,PU,rce,e);for(const t of e)LU(n&&n[t.id]||{},t.id,t.options&&t.options[t.id]||{},t.deprecatedOptions&&t.deprecatedOptions[t.id]||{},e)}(n,t=Array.isArray(t)?t:[t]),function(n,e,t){const r=dt({},n.options||{});return function(n,e){e&&!("baseUri"in n)&&(n.baseUri=e)}(r,t),null===r.log&&(r.log=new nce),BU(r,YI()),BU(r,e),r}(e,n,i)}function FU(n,e){const t=YI(),i=n||t;return"function"==typeof i.fetch?i.fetch:ch(i.fetch)?r=>RU(r,i):null!=e&&e.fetch?null==e?void 0:e.fetch:RU}function LU(n,e,t,i,r){const s=e||"Top level",o=e?`${e}.`:"";for(const a in n){const l=!e&&ch(n[a]),c="baseUri"===a&&!e,u="workerUrl"===a&&e;if(!(a in t)&&!c&&!u)if(a in i)NU.warn(`${s} loader option '${o}${a}' no longer supported, use '${i[a]}'`)();else if(!l){const h=ace(a,r);NU.warn(`${s} loader option '${o}${a}' not recognized. ${h}`)()}}}function ace(n,e){const t=n.toLowerCase();let i="";for(const r of e)for(const s in r.options){if(n===s)return`Did you mean '${r.id}.${s}'?`;const o=s.toLowerCase();(t.startsWith(o)||o.startsWith(t))&&(i=i||`Did you mean '${r.id}.${s}'?`)}return i}function BU(n,e){for(const t in e)t in e&&(n[t]=AU(e[t])&&AU(n[t])?dt(dt({},n[t]),e[t]):e[t])}function Zc(n,e){if(!n)throw new Error(e||"loaders.gl assertion failed.")}function uce(n,e="3.0.12"){return Zc(n,"no worker provided"),!(!e||!n.version)}const Jc={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document},dce=Jc.global||Jc.self||Jc.window||{},KI="object"!=typeof process||"[object process]"!==String(process)||process.browser,XI="function"==typeof importScripts,hce="undefined"!=typeof window&&void 0!==window.orientation,VU="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version),QI=(VU&&parseFloat(VU[1]),new Map);function jU(n){const e=new Blob([n],{type:"application/javascript"});return URL.createObjectURL(e)}function UU(n,e=!0,t){const i=t||new Set;if(n)if(zU(n))i.add(n);else if(zU(n.buffer))i.add(n.buffer);else if(!ArrayBuffer.isView(n)&&e&&"object"==typeof n)for(const r in n)UU(n[r],e,i);return void 0===t?Array.from(i):[]}function zU(n){return!!n&&(n instanceof ArrayBuffer||"undefined"!=typeof MessagePort&&n instanceof MessagePort||"undefined"!=typeof ImageBitmap&&n instanceof ImageBitmap||"undefined"!=typeof OffscreenCanvas&&n instanceof OffscreenCanvas)}const ZI=()=>{};class HU{static isSupported(){return"undefined"!=typeof Worker}constructor(e){qn(this,"name",void 0),qn(this,"source",void 0),qn(this,"url",void 0),qn(this,"terminated",!1),qn(this,"worker",void 0),qn(this,"onMessage",void 0),qn(this,"onError",void 0),qn(this,"_loadableURL","");const{name:t,source:i,url:r}=e;Zc(i||r),this.name=t,this.source=i,this.url=r,this.onMessage=ZI,this.onError=s=>console.log(s),this.worker=this._createBrowserWorker()}destroy(){this.onMessage=ZI,this.onError=ZI,this.worker.terminate(),this.terminated=!0}get isRunning(){return Boolean(this.onMessage)}postMessage(e,t){t=t||UU(e),this.worker.postMessage(e,t)}_getErrorFromErrorEvent(e){let t="Failed to load ";return t+=`worker ${this.name}. `,e.message&&(t+=`${e.message} in `),e.lineno&&(t+=`:${e.lineno}:${e.colno}`),new Error(t)}_createBrowserWorker(){this._loadableURL=function(n){Zc(n.source&&!n.url||!n.source&&n.url);let e=QI.get(n.source||n.url);return e||(n.url&&(e=function(n){return n.startsWith("http")?jU(function(n){return`try {\n  importScripts('${n}');\n} catch (error) {\n  console.error(error);\n  throw error;\n}`}(n)):n}(n.url),QI.set(n.url,e)),n.source&&(e=jU(n.source),QI.set(n.source,e))),Zc(e),e}({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=t=>{t.data?this.onMessage(t.data):this.onError(new Error("No data received"))},e.onerror=t=>{this.onError(this._getErrorFromErrorEvent(t)),this.terminated=!0},e.onmessageerror=t=>console.error(t),e}}class mce{constructor(e,t){qn(this,"name",void 0),qn(this,"workerThread",void 0),qn(this,"isRunning",void 0),qn(this,"result",void 0),qn(this,"_resolve",void 0),qn(this,"_reject",void 0),this.name=e,this.workerThread=t,this.isRunning=!0,this._resolve=()=>{},this._reject=()=>{},this.result=new Promise((i,r)=>{this._resolve=i,this._reject=r})}postMessage(e,t){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:t})}done(e){Zc(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){Zc(this.isRunning),this.isRunning=!1,this._reject(e)}}class _ce{constructor(e){qn(this,"name","unnamed"),qn(this,"source",void 0),qn(this,"url",void 0),qn(this,"maxConcurrency",1),qn(this,"maxMobileConcurrency",1),qn(this,"onDebug",()=>{}),qn(this,"reuseWorkers",!0),qn(this,"props",{}),qn(this,"jobQueue",[]),qn(this,"idleQueue",[]),qn(this,"count",0),qn(this,"isDestroyed",!1),this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props=dt(dt({},this.props),e),void 0!==e.name&&(this.name=e.name),void 0!==e.maxConcurrency&&(this.maxConcurrency=e.maxConcurrency),void 0!==e.maxMobileConcurrency&&(this.maxMobileConcurrency=e.maxMobileConcurrency),void 0!==e.reuseWorkers&&(this.reuseWorkers=e.reuseWorkers),void 0!==e.onDebug&&(this.onDebug=e.onDebug)}startJob(e,t=((r,s,o)=>r.done(o)),i=((r,s)=>r.error(s))){var r=this;return ii(function*(){const s=new Promise(o=>(r.jobQueue.push({name:e,onMessage:t,onError:i,onStart:o}),r));return r._startQueuedJob(),yield s})()}_startQueuedJob(){var e=this;return ii(function*(){if(!e.jobQueue.length)return;const t=e._getAvailableWorker();if(!t)return;const i=e.jobQueue.shift();if(i){e.onDebug({message:"Starting job",name:i.name,workerThread:t,backlog:e.jobQueue.length});const r=new mce(i.name,t);t.onMessage=s=>i.onMessage(r,s.type,s.payload),t.onError=s=>i.onError(r,s),i.onStart(r);try{yield r.result}finally{e.returnWorkerToQueue(t)}}})()}returnWorkerToQueue(e){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e=`${this.name.toLowerCase()} (#${this.count} of ${this.maxConcurrency})`;return new HU({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return hce?this.maxMobileConcurrency:this.maxConcurrency}}const yce={maxConcurrency:3,maxMobileConcurrency:1,onDebug:()=>{},reuseWorkers:!0};class Xu{static isSupported(){return HU.isSupported()}static getWorkerFarm(e={}){return Xu._workerFarm=Xu._workerFarm||new Xu({}),Xu._workerFarm.setProps(e),Xu._workerFarm}constructor(e){qn(this,"props",void 0),qn(this,"workerPools",new Map),this.props=dt({},yce),this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy()}setProps(e){this.props=dt(dt({},this.props),e);for(const t of this.workerPools.values())t.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:t,source:i,url:r}=e;let s=this.workerPools.get(t);return s||(s=new _ce({name:t,source:i,url:r}),s.setProps(this._getWorkerPoolProps()),this.workerPools.set(t,s)),s}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}function bce(n,e={}){const i=`${n.id}-worker.js`;let r=(e[n.id]||{}).workerUrl;if("test"===e._workerType&&(r=`modules/${n.module}/dist/${i}`),!r){let s=n.version;"latest"===s&&(s="latest"),r=`https://unpkg.com/@loaders.gl/${n.module}${s?`@${s}`:""}/dist/${i}`}return Zc(r),r}function wce(n,e){return!!Xu.isSupported()&&n.worker&&(null==e?void 0:e.worker)}function Ece(n,e,t,i,r){return JI.apply(this,arguments)}function JI(){return(JI=ii(function*(n,e,t,i,r){const s=n.id,o=bce(n,t),l=Xu.getWorkerFarm(t).getWorkerPool({name:s,url:o});t=JSON.parse(JSON.stringify(t));const c=yield l.startJob("process-on-worker",Sce.bind(null,r));return c.postMessage("process",{input:e,options:t}),yield(yield c.result).result})).apply(this,arguments)}function Sce(n,e,t,i){return eO.apply(this,arguments)}function eO(){return(eO=ii(function*(n,e,t,i){switch(t){case"done":e.done(i);break;case"error":e.error(i.error);break;case"process":const{id:r,input:s,options:o}=i;try{const a=yield n(s,o);e.postMessage("done",{id:r,result:a})}catch(a){const l=a instanceof Error?a.message:"unknown error";e.postMessage("error",{id:r,error:l})}break;default:console.warn(`parse-with-worker unknown message ${t}`)}})).apply(this,arguments)}qn(Xu,"_workerFarm",void 0);var $U=nt(521);function WU(n){if(function(n){return n&&"object"==typeof n&&n.isBuffer}(n)&&(n=function(n){return $U.toArrayBuffer?$U.toArrayBuffer(n):n}(n)),n instanceof ArrayBuffer)return n;if(ArrayBuffer.isView(n))return 0===n.byteOffset&&n.byteLength===n.buffer.byteLength?n.buffer:n.buffer.slice(n.byteOffset,n.byteOffset+n.byteLength);if("string"==typeof n){const e=n;return(new TextEncoder).encode(e).buffer}if(n&&"object"==typeof n&&n._toArrayBuffer)return n._toArrayBuffer();throw new Error("toArrayBuffer")}function Ace(...n){const e=n.map(s=>s instanceof ArrayBuffer?new Uint8Array(s):s),t=e.reduce((s,o)=>s+o.byteLength,0),i=new Uint8Array(t);let r=0;for(const s of e)i.set(s,r),r+=s.byteLength;return i.buffer}function qU(n,e,t){const i=void 0!==t?new Uint8Array(n).subarray(e,e+t):new Uint8Array(n).subarray(e);return new Uint8Array(i).buffer}function Mce(n){return nO.apply(this,arguments)}function nO(){return(nO=ii(function*(n){const e=[];var r,t=!0,i=!1;try{for(var o,a,s=FI(n);t=(o=yield s.next()).done,a=yield o.value,!t;t=!0)e.push(a)}catch(l){i=!0,r=l}finally{try{!t&&null!=s.return&&(yield s.return())}finally{if(i)throw r}}return Ace(...e)})).apply(this,arguments)}const Oce=262144;function YU(n){this.wrapped=n}function N0(n){return new YU(n)}function P0(n){var e,t;function r(o,a){try{var l=n[o](a),c=l.value,u=c instanceof YU;Promise.resolve(u?c.wrapped:c).then(function(h){u?r("return"===o?"return":"next",h):s(l.done?"return":"normal",h)},function(h){r("throw",h)})}catch(h){s("throw",h)}}function s(o,a){switch(o){case"return":e.resolve({value:a,done:!0});break;case"throw":e.reject(a);break;default:e.resolve({value:a,done:!1})}(e=e.next)?r(e.key,e.arg):t=null}this._invoke=function(o,a){return new Promise(function(l,c){var u={key:o,arg:a,resolve:l,reject:c,next:null};t?t=t.next=u:(e=t=u,r(o,a))})},"function"!=typeof n.return&&(this.return=void 0)}function rO(n){return function(){return new P0(n.apply(this,arguments))}}function sO(){return(sO=rO(function*(n,e){const t=(null==e?void 0:e.chunkSize)||1048576;let i=0;for(;i<n.size;){const r=i+t,s=yield N0(n.slice(i,r).arrayBuffer());i=r,yield s}})).apply(this,arguments)}function KU(n,e){return $le?function(n,e){return oO.apply(this,arguments)}(n,e):function(n,e){return aO.apply(this,arguments)}(n,e)}function oO(){return(oO=rO(function*(n,e){const t=n.getReader();let i;try{for(;;){const r=i||t.read();null!=e&&e._streamReadAhead&&(i=t.read());const{done:s,value:o}=yield N0(r);if(s)return;yield WU(o)}}catch(r){t.releaseLock()}})).apply(this,arguments)}function aO(){return(aO=rO(function*(n,e){var r,t=!0,i=!1;try{for(var o,a,s=FI(n);t=(o=yield N0(s.next())).done,a=yield N0(o.value),!t;t=!0)yield WU(a)}catch(l){i=!0,r=l}finally{try{!t&&null!=s.return&&(yield N0(s.return()))}finally{if(i)throw r}}})).apply(this,arguments)}function kce(n,e){if("string"==typeof n)return function*(n,e){const t=(null==e?void 0:e.chunkSize)||262144;let i=0;const r=new TextEncoder;for(;i<n.length;){const s=Math.min(n.length-i,t),o=n.slice(i,i+s);i+=s,yield r.encode(o)}}(n,e);if(n instanceof ArrayBuffer)return function*(n,e={}){const{chunkSize:t=Oce}=e;let i=0;for(;i<n.byteLength;){const r=Math.min(n.byteLength-i,t),s=new ArrayBuffer(r),o=new Uint8Array(n,i,r);new Uint8Array(s).set(o),i+=r,yield s}}(n,e);if(Kg(n))return function(n,e){return sO.apply(this,arguments)}(n,e);if(MU(n))return KU(n,e);if(R0(n))return KU(n.body,e);throw new Error("makeIterator")}P0.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},P0.prototype.next=function(n){return this._invoke("next",n)},P0.prototype.throw=function(n){return this._invoke("throw",n)},P0.prototype.return=function(n){return this._invoke("return",n)};const lO="Cannot convert supplied data type";function Bce(n,e,t){if(e.text&&"string"==typeof n)return n;if((n=>n&&"object"==typeof n&&n.isBuffer)(n)&&(n=n.buffer),n instanceof ArrayBuffer){const i=n;return e.text&&!e.binary?new TextDecoder("utf8").decode(i):i}if(ArrayBuffer.isView(n)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(n);let i=n.buffer;const r=n.byteLength||n.length;return(0!==n.byteOffset||r!==i.byteLength)&&(i=i.slice(n.byteOffset,n.byteOffset+r)),i}throw new Error(lO)}function Vce(n,e,t){return cO.apply(this,arguments)}function cO(){return(cO=ii(function*(n,e,t){const i=n instanceof ArrayBuffer||ArrayBuffer.isView(n);if("string"==typeof n||i)return Bce(n,e);if(Kg(n)&&(n=yield OU(n)),R0(n)){const r=n;return yield Zle(r),e.binary?yield r.arrayBuffer():yield r.text()}if(MU(n)&&(n=kce(n,t)),Ble(n)||Vle(n))return Mce(n);throw new Error(lO)})).apply(this,arguments)}function Uce(n,e,t=null){if(t)return t;const i=dt({fetch:FU(e,n)},n);return Array.isArray(i.loaders)||(i.loaders=null),i}function zce(n,e){if(!e&&n&&!Array.isArray(n))return n;let t;if(n&&(t=Array.isArray(n)?n:[n]),e&&e.loaders){const i=Array.isArray(e.loaders)?e.loaders:[e.loaders];t=t?[...t,...i]:i}return t&&t.length?t:null}const XU=()=>{const n=qI();return n.loaderRegistry=n.loaderRegistry||[],n.loaderRegistry};function QU(n){const e=XU();n=Array.isArray(n)?n:[n];for(const t of n){const i=kI(t);e.find(r=>i===r)||e.unshift(i)}}const Gce=/\.([^.]+)$/;function $ce(n){return hO.apply(this,arguments)}function hO(){return(hO=ii(function*(n,e=[],t,i){if(!JU(n))return null;let r=ZU(n,e,Hn(dt({},t),{nothrow:!0}),i);if(r)return r;if(Kg(n)&&(r=ZU(n=yield n.slice(0,10).arrayBuffer(),e,t,i)),!(r||null!=t&&t.nothrow))throw new Error(ez(n));return r})).apply(this,arguments)}function ZU(n,e=[],t,i){if(!JU(n))return null;if(e&&!Array.isArray(e))return kI(e);let r=[];e&&(r=r.concat(e)),null!=t&&t.ignoreRegisteredLoaders||r.push(...XU()),function(n){for(const e of n)kI(e)}(r);const s=function(n,e,t,i){const{url:r,type:s}=xS(n),o=r||(null==i?void 0:i.url);let a=null;return null!=t&&t.mimeType&&(a=fO(e,null==t?void 0:t.mimeType)),a=a||function(n,e){const t=e&&Gce.exec(e),i=t&&t[1];return i?function(n,e){e=e.toLowerCase();for(const t of n)for(const i of t.extensions)if(i.toLowerCase()===e)return t;return null}(n,i):null}(e,o),a=a||fO(e,s),a=a||function(n,e){if(!e)return null;for(const t of n)if("string"==typeof e){if(Qce(e,t))return t}else if(ArrayBuffer.isView(e)){if(tz(e.buffer,e.byteOffset,t))return t}else if(e instanceof ArrayBuffer&&tz(e,0,t))return t;return null}(e,n),a=a||fO(e,null==t?void 0:t.fallbackMimeType),a}(n,r,t,i);if(!(s||null!=t&&t.nothrow))throw new Error(ez(n));return s}function JU(n){return!(n instanceof Response&&204===n.status)}function ez(n){const{url:e,type:t}=xS(n);let i="No valid loader found";return n&&(i+=` data: "${function(n,e=5){return"string"==typeof n?n.slice(0,e):ArrayBuffer.isView(n)?pO(n.buffer,n.byteOffset,e):n instanceof ArrayBuffer?pO(n,0,e):""}(n)}", contentType: "${t}"`),e&&(i+=` url: ${e}`),i}function fO(n,e){for(const t of n)if(t.mimeTypes&&t.mimeTypes.includes(e)||e===`application/x.${t.id}`)return t;return null}function Qce(n,e){return e.testText?e.testText(n):(Array.isArray(e.tests)?e.tests:[e.tests]).some(i=>n.startsWith(i))}function tz(n,e,t){return(Array.isArray(t.tests)?t.tests:[t.tests]).some(r=>function(n,e,t,i){if(i instanceof ArrayBuffer)return function(n,e,t){if(n.byteLength<(t=t||n.byteLength)||e.byteLength<t)return!1;const i=new Uint8Array(n),r=new Uint8Array(e);for(let s=0;s<i.length;++s)if(i[s]!==r[s])return!1;return!0}(i,n,i.byteLength);switch(typeof i){case"function":return i(n,t);case"string":return i===pO(n,e,i.length);default:return!1}}(n,e,t,r))}function pO(n,e,t){if(n.byteLength<e+t)return"";const i=new DataView(n);let r="";for(let s=0;s<t;s++)r+=String.fromCharCode(i.getUint8(e+s));return r}function CS(n,e,t,i){return gO.apply(this,arguments)}function gO(){return(gO=ii(function*(n,e,t,i){Zc(!i||"object"==typeof i),e&&!Array.isArray(e)&&!LI(e)&&(i=void 0,t=e,e=void 0),n=yield n,t=t||{};const{url:r}=xS(n),o=zce(e,i),a=yield $ce(n,o,t);return a?(i=Uce({url:r,parse:CS,loaders:o},t=sce(t,a,o,r),i),yield eue(a,n,t,i)):null})).apply(this,arguments)}function eue(n,e,t,i){return mO.apply(this,arguments)}function mO(){return(mO=ii(function*(n,e,t,i){if(uce(n),e=yield Vce(e,n,t),n.parseTextSync&&"string"==typeof e)return t.dataType="text",n.parseTextSync(e,t,i,n);if(wce(n,t))return yield Ece(n,e,t,i,CS);if(n.parseText&&"string"==typeof e)return yield n.parseText(e,t,i,n);if(n.parse)return yield n.parse(e,t,i,n);throw Zc(!n.parseSync),new Error(`${n.id} loader - no parser found and worker is disabled`)})).apply(this,arguments)}function TS(n,e,t,i){return _O.apply(this,arguments)}function _O(){return(_O=ii(function*(n,e,t,i){!Array.isArray(e)&&!LI(e)&&(t=e,e=void 0);const r=FU(t);let s=n;return"string"==typeof n&&(s=yield r(n)),Kg(n)&&(s=yield r(n)),yield CS(s,e,t)})).apply(this,arguments)}const nz=_r(2,24)-1,oue=Object.freeze([]),aue=fS(({oldViewport:n,viewport:e})=>n.equals(e));let eu=new Uint8ClampedArray(0);const lue={data:{type:"data",value:oue,async:!0},dataComparator:null,_dataDiff:{type:"function",value:n=>n&&n.__diff,compare:!1,optional:!0},dataTransform:{type:"function",value:null,compare:!1,optional:!0},onDataLoad:{type:"function",value:null,compare:!1,optional:!0},onError:{type:"function",value:null,compare:!1,optional:!0},fetch:{type:"function",value:(n,{propName:e,layer:t,loaders:i,loadOptions:r,signal:s})=>{const{resourceManager:o}=t.context;var a;r=r||t.getLoadOptions(),i=i||t.props.loaders,s&&(r=Hn(dt({},r),{fetch:Hn(dt({},null===(a=r)||void 0===a?void 0:a.fetch),{signal:s})}));let l=o.contains(n);return!l&&!r&&(o.add({resourceId:n,data:TS(n,i),persistent:!1}),l=!0),l?o.subscribe({resourceId:n,onChange:c=>t.internalState.reloadAsyncProp(e,c),consumerId:t.id,requestId:e}):TS(n,i,r)},compare:!1},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},onHover:{type:"function",value:null,compare:!1,optional:!0},onClick:{type:"function",value:null,compare:!1,optional:!0},onDragStart:{type:"function",value:null,compare:!1,optional:!0},onDrag:{type:"function",value:null,compare:!1,optional:!0},onDragEnd:{type:"function",value:null,compare:!1,optional:!0},coordinateSystem:Pi.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,compare:!0},getPolygonOffset:{type:"function",value:({layerIndex:n})=>[0,100*-n],compare:!1},highlightedObjectIndex:-1,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};let yO=(()=>{class n extends Lle{toString(){return"".concat(this.constructor.layerName||this.constructor.name,"({id: '").concat(this.props.id,"'})")}raiseError(t,i){var r,s,o,a;i&&(t.message="".concat(i,": ").concat(t.message)),(null===(r=(s=this.props).onError)||void 0===r?void 0:r.call(s,t))||null===(o=this.context)||void 0===o||null===(a=o.onError)||void 0===a||a.call(o,t,this)}setState(t){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,t),this.setNeedsRedraw()}setNeedsRedraw(t=!0){this.internalState&&(this.internalState.needsRedraw=t)}setNeedsUpdate(){this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0}getNeedsRedraw(t={clearRedrawFlags:!1}){return this._getNeedsRedraw(t)}needsUpdate(){return this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams())}hasUniformTransition(){return this.internalState.uniformTransitions.active}get isLoaded(){return this.internalState&&!this.internalState.isAsyncPropLoading()}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||(this.state.model?[this.state.model]:[]))}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}project(t){const{viewport:i}=this.context,r=bU(t,{viewport:i,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[s,o,a]=hU(r,i.pixelProjectionMatrix);return 2===t.length?[s,o]:[s,o,a]}unproject(t){const{viewport:i}=this.context;return i.unproject(t)}projectPosition(t){return function(n,e){const{viewport:t,coordinateSystem:i,coordinateOrigin:r,modelMatrix:s,fromCoordinateSystem:o,fromCoordinateOrigin:a}=function(n){const e=dt({},n);let{coordinateSystem:t}=n;const{viewport:i,coordinateOrigin:r,fromCoordinateSystem:s,fromCoordinateOrigin:o}=n;return t===Pi.DEFAULT&&(t=i.isGeospatial?Pi.LNGLAT:Pi.CARTESIAN),void 0===s&&(e.fromCoordinateSystem=t),void 0===o&&(e.fromCoordinateOrigin=r),e.coordinateSystem=t,e}(e),{geospatialOrigin:l,shaderCoordinateOrigin:c,offsetMode:u}=eU(t,i,r),h=bU(n,{viewport:t,modelMatrix:s,coordinateSystem:o,coordinateOrigin:a,offsetMode:u});u&&function(n,e,t){n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2]}(h,h,t.projectPosition(l||c));return h}(t,{viewport:this.context.viewport,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem})}use64bitPositions(){const{coordinateSystem:t}=this.props;return t===Pi.DEFAULT||t===Pi.LNGLAT||t===Pi.CARTESIAN}onHover(t,i){return!!this.props.onHover&&this.props.onHover(t,i)}onClick(t,i){return!!this.props.onClick&&this.props.onClick(t,i)}nullPickingColor(){return[0,0,0]}encodePickingColor(t,i=[]){return i[0]=t+1&255,i[1]=t+1>>8&255,i[2]=t+1>>8>>8&255,i}decodePickingColor(t){ac(t instanceof Uint8Array);const[i,r,s]=t;return i+256*r+65536*s-1}initializeState(){throw new Error("Layer ".concat(this," has not defined initializeState"))}getShaders(t){for(const i of this.props.extensions)t=mae(t,i.getShaders.call(this,i));return t}shouldUpdateState({changeFlags:s}){return s.propsOrDataChanged}updateState({oldProps:t,props:i,changeFlags:s}){const o=this.getAttributeManager();if(s.dataChanged&&o){const{dataChanged:c}=s;if(Array.isArray(c))for(const u of c)o.invalidateAll(u);else o.invalidateAll()}const l=i.highlightedObjectIndex>=0||i.pickable;if((t.highlightedObjectIndex>=0||t.pickable)!==l&&o){const{pickingColors:c,instancePickingColors:u}=o.attributes,h=c||u;h&&(l&&h.constant&&(h.constant=!1,o.invalidate(h.id)),!h.value&&!l&&(h.constant=!0,h.value=[0,0,0]))}}finalizeState(){for(const i of this.getModels())i.delete();const t=this.getAttributeManager();t&&t.finalize(),this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState.uniformTransitions.clear(),this.internalState.finalize()}draw(t){for(const i of this.getModels())i.draw(t)}getPickingInfo({info:t}){const{index:r}=t;return r>=0&&Array.isArray(this.props.data)&&(t.object=this.props.data[r]),t}activateViewport(t){const i=this.internalState.viewport;this.internalState.viewport=t,(!i||!aue({oldViewport:i,viewport:t}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(t="all",i=""){const r=this.getAttributeManager();!r||("all"===t?r.invalidateAll():r.invalidate(t))}updateAttributes(t){for(const i of this.getModels())this._setModelAttributes(i,t)}_updateAttributes(t){const i=this.getAttributeManager();if(!i)return;const r=this.getNumInstances(t),s=this.getStartIndices(t);i.update({data:t.data,numInstances:r,startIndices:s,props:t,transitions:t.transitions,buffers:t.data.attributes,context:this,ignoreUnknownAttributes:!0});const o=i.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(o)}_updateAttributeTransition(){const t=this.getAttributeManager();t&&t.updateTransition()}_updateUniformTransition(){const{uniformTransitions:t}=this.internalState;if(t.active){const i=t.update(),r=Object.create(this.props);for(const s in i)Object.defineProperty(r,s,{value:i[s]});return r}return this.props}calculateInstancePickingColors(t,{numInstances:i}){if(t.constant)return;const r=Math.floor(eu.length/3);if(this.internalState.usesPickingColorCache=!0,r<i){i>nz&&Bi.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),eu=p0.allocate(eu,i,{size:3,copy:!0,maxCount:Math.max(i,nz)});const s=Math.floor(eu.length/3),o=[];for(let a=r;a<s;a++)this.encodePickingColor(a,o),eu[3*a+0]=o[0],eu[3*a+1]=o[1],eu[3*a+2]=o[2]}t.value=eu.subarray(0,3*i)}_setModelAttributes(t,i){const o=this.getAttributeManager().getShaderAttributes(i,t.userData.excludeAttributes||{});t.setAttributes(o)}disablePickingIndex(t){this._disablePickingIndex(t)}_disablePickingIndex(t){const{pickingColors:i,instancePickingColors:r}=this.getAttributeManager().attributes,s=i||r,o=s.getVertexOffset(t),a=s.getVertexOffset(t+1);s.buffer.subData({data:new Uint8Array(a-o),offset:o})}restorePickingColors(){const{pickingColors:t,instancePickingColors:i}=this.getAttributeManager().attributes,r=t||i;this.internalState.usesPickingColorCache&&r.value.buffer!==eu.buffer&&(r.value=eu.subarray(0,r.value.length)),r.updateSubBuffer({startOffset:0})}getNumInstances(t){return void 0!==(t=t||this.props).numInstances?t.numInstances:this.state&&void 0!==this.state.numInstances?this.state.numInstances:function(n){if(!function(n){return null!==n&&"object"==typeof n}(n))throw new Error("count(): argument not an object");if("function"==typeof n.count)return n.count();if(Number.isFinite(n.size))return n.size;if(Number.isFinite(n.length))return n.length;if(function(n){return null!==n&&"object"==typeof n&&n.constructor===Object}(n))return Object.keys(n).length;throw new Error("count(): argument not a container")}(t.data)}getStartIndices(t){return void 0!==(t=t||this.props).startIndices?t.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}_initialize(){Co("layer.initialize",this),this._initState(),this.initializeState(this.context);for(const t of this.props.extensions)t.initializeState.call(this,this.context,t);this.setChangeFlags({dataChanged:!0,propsChanged:!0,viewportChanged:!0,extensionsChanged:!0}),this._updateState()}_update(){const t=this.needsUpdate();Co("layer.update",this,t),t&&this._updateState()}_updateState(){const t=this.props,i=this.context.viewport,r=this._updateUniformTransition();this.internalState.propsInTransition=r,this.context.viewport=this.internalState.viewport||i,this.props=r;try{const s=this._getUpdateParams(),o=this.getModels();if(this.context.gl)this.updateState(s);else try{this.updateState(s)}catch(l){}for(const l of this.props.extensions)l.updateState.call(this,s,l);const a=this.getModels()[0]!==o[0];this._updateModules(s,a),this.isComposite?this._renderLayers(s):(this.setNeedsRedraw(),this._updateAttributes(this.props),this.state.model&&this.state.model.setInstanceCount(this.getNumInstances()))}finally{this.context.viewport=i,this.props=t,this.clearChangeFlags(),this.internalState.needsUpdate=!1,this.internalState.resetOldProps()}}_finalize(){Co("layer.finalize",this),this.finalizeState(this.context);for(const t of this.props.extensions)t.finalizeState.call(this,t)}drawLayer({moduleParameters:t=null,uniforms:i={},parameters:r={}}){this._updateAttributeTransition();const s=this.props;this.props=this.internalState.propsInTransition||s;const{opacity:o}=this.props;i.opacity=Math.pow(o,1/2.2);try{t&&this.setModuleParameters(t);const{getPolygonOffset:a}=this.props,l=a&&a(i)||[0,0];Gu(this.context.gl,{polygonOffset:l}),oc(this.context.gl,r,()=>{const c={moduleParameters:t,uniforms:i,parameters:r,context:this.context};for(const u of this.props.extensions)u.draw.call(this,c,u);this.draw(c)})}finally{this.props=s}}getChangeFlags(){return this.internalState.changeFlags}setChangeFlags(t){const{changeFlags:i}=this.internalState;for(const s in t)if(t[s]){let o=!1;switch(s){case"dataChanged":Array.isArray(i[s])&&(i[s]=Array.isArray(t[s])?i[s].concat(t[s]):t[s],o=!0);default:i[s]||(i[s]=t[s],o=!0)}o&&Co("layer.changeFlag",this,s,t)}const r=i.dataChanged||i.updateTriggersChanged||i.propsChanged||i.extensionsChanged;i.propsOrDataChanged=r,i.somethingChanged=r||t.viewportChanged||t.stateChanged}clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}diffProps(t,i){const r=function(n,e){const t=Wj({newProps:n,oldProps:e,propTypes:SI(n),ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),i=function(n,e){if(null===e)return"oldProps is null, initial diff";let t=null;const{dataComparator:i,_dataDiff:r}=n;return i?i(n.data,e.data)||(t="Data comparator detected a change"):n.data!==e.data&&(t="A new data container was supplied"),t&&r&&(t=r(n.data,e.data)||t),t}(n,e);let r=!1;return i||(r=function(n,e){if(null===e)return"oldProps is null, initial diff";if("all"in n.updateTriggers&&qj(n,e,"all"))return{all:!0};const t={};let i=!1;for(const r in n.updateTriggers)"all"!==r&&qj(n,e,r)&&(t[r]=!0,i=t);return i}(n,e)),{dataChanged:i,propsChanged:t,updateTriggersChanged:r,extensionsChanged:cae(n,e),transitionsChanged:oae(n,e)}}(t,i);if(r.updateTriggersChanged)for(const s in r.updateTriggersChanged)r.updateTriggersChanged[s]&&this.invalidateAttribute(s);if(r.transitionsChanged)for(const s in r.transitionsChanged)this.internalState.uniformTransitions.add(s,i[s],t[s],t.transitions[s]);return this.setChangeFlags(r)}validateProps(){!function(n){const e=SI(n);for(const t in e){const i=e[t],{validate:r}=i;if(r&&!r(n[t],i))throw new Error("Invalid prop ".concat(t,": ").concat(n[t]))}}(this.props)}setModuleParameters(t){for(const i of this.getModels())i.updateModuleSettings(t)}updateAutoHighlight(t){this.props.autoHighlight&&this._updateAutoHighlight(t)}_updateAutoHighlight(t){const i={pickingSelectedColor:t.picked?t.color:null},{highlightColor:r}=this.props;t.picked&&"function"==typeof r&&(i.pickingHighlightColor=r(t)),this.setModuleParameters(i),this.setNeedsRedraw()}_updateModules({props:t,oldProps:i},r){const{autoHighlight:s,highlightedObjectIndex:o,highlightColor:a}=t;if(r||i.autoHighlight!==s||i.highlightedObjectIndex!==o||i.highlightColor!==a){const l={};s||(l.pickingSelectedColor=null),Array.isArray(a)&&(l.pickingHighlightColor=a),Number.isInteger(o)&&(l.pickingSelectedColor=o>=0?this.encodePickingColor(o):null),this.setModuleParameters(l)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(t){if(!this.internalState)return!1;let i=!1;i=i||this.internalState.needsRedraw&&this.id,this.internalState.needsRedraw=this.internalState.needsRedraw&&!t.clearRedrawFlags;const r=this.getAttributeManager(),s=r&&r.getNeedsRedraw(t);return i=i||s,i}_getAttributeManager(){return new Qoe(this.context.gl,{id:this.props.id,stats:this.context.stats,timeline:this.context.timeline})}_initState(){ac(!this.internalState&&!this.state),ac(isFinite(this.props.coordinateSystem));const t=this._getAttributeManager();t&&t.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new kle({attributeManager:t,layer:this}),this.clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(Bi.deprecated("layer.state.attributeManager","layer.getAttributeManager()"),t)}),this.internalState.layer=this,this.internalState.uniformTransitions=new nae(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props)}_transferState(t){Co("layer.matched",this,this===t);const{state:i,internalState:r}=t;this!==t&&(this.internalState=r,this.internalState.layer=this,this.state=i,this.internalState.setAsyncProps(this.props),this.diffProps(this.props,this.internalState.getOldProps()))}_onAsyncPropUpdated(){this.diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}return n.layerName="Layer",n.defaultProps=lue,n})(),uue=(()=>{class n extends yO{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(t=>t.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(){}setState(t){super.setState(t),this.setNeedsUpdate()}getPickingInfo({info:t}){const{object:i}=t;return i&&i.__source&&i.__source.parent&&i.__source.parent.id===this.id&&(t.object=i.__source.object,t.index=i.__source.index),t}renderLayers(){return null}filterSubLayer(t){return!0}shouldRenderSubLayer(t,i){return i&&i.length}getSubLayerClass(t,i){const{_subLayerProps:r}=this.props;return r&&r[t]&&r[t].type||i}getSubLayerRow(t,i,r){return t.__source={parent:this,object:i,index:r},t}getSubLayerAccessor(t){if("function"==typeof t){const i={data:this.props.data,target:[]};return(r,s)=>r&&r.__source?(i.index=r.__source.index,t(r.__source.object,i)):t(r,s)}return t}getSubLayerProps(t={}){const{opacity:i,pickable:r,visible:s,parameters:o,getPolygonOffset:a,highlightedObjectIndex:l,autoHighlight:c,highlightColor:u,coordinateSystem:h,coordinateOrigin:p,wrapLongitude:g,positionFormat:m,modelMatrix:w,extensions:x,fetch:H,_subLayerProps:I}=this.props,oe={opacity:i,pickable:r,visible:s,parameters:o,getPolygonOffset:a,highlightedObjectIndex:l,autoHighlight:c,highlightColor:u,coordinateSystem:h,coordinateOrigin:p,wrapLongitude:g,positionFormat:m,modelMatrix:w,extensions:x,fetch:H},Se=I&&I[t.id],Pe=Se&&Se.updateTriggers,Be=t.id||"sublayer";if(Se){const He=this.constructor._propTypes,vt=t.type?t.type._propTypes:{};for(const St in Se){const Ct=vt[St]||He[St];Ct&&"accessor"===Ct.type&&(Se[St]=this.getSubLayerAccessor(Se[St]))}}Object.assign(oe,t,Se),oe.id="".concat(this.props.id,"-").concat(Be),oe.updateTriggers=dt(dt({all:this.props.updateTriggers.all},t.updateTriggers),Pe);for(const He of x){const vt=He.getSubLayerProps.call(this,He);vt&&Object.assign(oe,vt,{updateTriggers:Object.assign(oe.updateTriggers,vt.updateTriggers)})}return oe}_updateAutoHighlight(t){for(const i of this.getSubLayers())i.updateAutoHighlight(t)}_getAttributeManager(){return null}_renderLayers(){let{subLayers:t}=this.internalState;const i=!t||this.needsUpdate();i&&(t=this.renderLayers(),t=tI(t,Boolean),this.internalState.subLayers=t),Co("compositeLayer.renderLayers",this,i,t);for(const r of t)r.parent=this}}return n.layerName="CompositeLayer",n})();const due=/([0-9]+\.?[0-9]*)(%|px)/;function AS(n){switch(typeof n){case"number":return{position:n,relative:!1};case"string":const e=n.match(due);if(e&&e.length>=3){const t="%"===e[2],i=parseFloat(e[1]);return{position:t?i/100:i,relative:t}}default:throw new Error("Could not parse position string ".concat(n))}}function MS(n,e){return n.relative?Math.round(n.position*e):n.position}function F0(n,e){if(n===e)return!0;if(!n||!e)return!1;for(const t in n){const i=n[t],r=e[t];if(!(i===r||Array.isArray(i)&&Array.isArray(r)&&F0(i,r)))return!1}return!0}class vO{constructor(e={}){const{id:t=null,x:i=0,y:r=0,width:s="100%",height:o="100%",projectionMatrix:a=null,fovy:l=50,near:c=.1,far:u=1e3,modelMatrix:h=null,viewportInstance:p=null,type:g=Yg}=e;ac(!p||p instanceof Yg),this.viewportInstance=p,this.id=t||this.constructor.displayName||"view",this.type=g,this.props=Hn(dt({},e),{id:this.id,projectionMatrix:a,fovy:l,near:c,far:u,modelMatrix:h}),this._parseDimensions({x:i,y:r,width:s,height:o}),this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e||(this.viewportInstance?e.viewportInstance&&this.viewportInstance.equals(e.viewportInstance):F0(this.props,e.props))}makeViewport({width:e,height:t,viewState:i}){if(this.viewportInstance)return this.viewportInstance;i=this.filterViewState(i);const r=this.getDimensions({width:e,height:t});return this._getViewport(i,r)}getViewStateId(){switch(typeof this.props.viewState){case"string":return this.props.viewState;case"object":return this.props.viewState&&this.props.viewState.id;default:return this.id}}filterViewState(e){if(this.props.viewState&&"object"==typeof this.props.viewState){if(!this.props.viewState.id)return this.props.viewState;const t=dt({},e);for(const i in this.props.viewState)"id"!==i&&(t[i]=this.props.viewState[i]);return t}return e}getDimensions({width:e,height:t}){return{x:MS(this._x,e),y:MS(this._y,t),width:MS(this._width,e),height:MS(this._height,t)}}_getControllerProps(e){let t=this.props.controller;return t?!0===t?e:("function"==typeof t&&(t={type:t}),dt(dt({},e),t)):null}_getViewport(e,t){const{type:i}=this;return new i(dt(dt(dt({},e),this.props),t))}_parseDimensions({x:e,y:t,width:i,height:r}){this._x=AS(e),this._y=AS(t),this._width=AS(i),this._height=AS(r)}}const L0=()=>{},iz={transitionEasing:n=>n,transitionInterruption:1,onTransitionStart:L0,onTransitionInterrupt:L0,onTransitionEnd:L0};class hue{constructor(e,t={}){this.ControllerState=e,this.props=dt(dt({},iz),t),this.propsInTransition=null,this.transition=new T0(t.timeline),this.onViewStateChange=t.onViewStateChange||L0,this.onStateChange=t.onStateChange||L0,this._onTransitionUpdate=this._onTransitionUpdate.bind(this)}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let t=!1;const i=this.props;if(e=dt(dt({},iz),e),this.props=e,this._shouldIgnoreViewportChange(i,e))return t;if(this._isTransitionEnabled(e)){const{interruption:r,endProps:s}=this.transition.settings,o=dt(dt({},i),2===r?s:this.propsInTransition||i);this._triggerTransition(o,e),t=!0}else this.transition.cancel();return t}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:t,transitionInterpolator:i}=e;return(t>0||"auto"===t)&&Boolean(i)}_isUpdateDueToCurrentTransition(e){return!!this.transition.inProgress&&this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition)}_shouldIgnoreViewportChange(e,t){return this.transition.inProgress?3===this.transition.settings.interruption||this._isUpdateDueToCurrentTransition(t):!this._isTransitionEnabled(t)||t.transitionInterpolator.arePropsEqual(e,t)}_triggerTransition(e,t){const i=new this.ControllerState(e),r=new this.ControllerState(t).shortestPathFrom(i),{transitionInterpolator:s}=t,o=s.getDuration?s.getDuration(e,t):t.transitionDuration;if(0===o)return;const a=t.transitionInterpolator.initializeProps(e,r);this.propsInTransition={},this.duration=o,this.transition.start({duration:o,easing:t.transitionEasing,interpolator:t.transitionInterpolator,interruption:t.transitionInterruption,startProps:a.start,endProps:a.end,onStart:t.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(t.onTransitionInterrupt),onEnd:this._onTransitionEnd(t.onTransitionEnd)}),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return t=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e(t)}}_onTransitionUpdate(e){const{time:t,settings:{interpolator:i,startProps:r,endProps:s,duration:o,easing:a}}=e,l=a(t/o),c=i.interpolateProps(r,s,l);this.propsInTransition=new this.ControllerState(dt(dt({},this.props),c)).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})}}const rz=["longitude","latitude","zoom","bearing","pitch"],pue=["longitude","latitude","zoom"];class sz extends class{constructor(e={}){Array.isArray(e)&&(e={compare:e,extract:e,required:e});const{compare:t,extract:i,required:r}=e;this._propsToCompare=t,this._propsToExtract=i,this._requiredProps=r}arePropsEqual(e,t){for(const i of this._propsToCompare||Object.keys(t))if(!(i in e)||!(i in t)||!g0(e[i],t[i]))return!1;return!0}initializeProps(e,t){let i;if(this._propsToExtract){const r={},s={};for(const o of this._propsToExtract)r[o]=e[o],s[o]=t[o];i={start:r,end:s}}else i={start:e,end:t};return this._checkRequiredProps(i.start),this._checkRequiredProps(i.end),i}interpolateProps(e,t,i){return t}getDuration(e,t){return t.transitionDuration}_checkRequiredProps(e){!this._requiredProps||this._requiredProps.forEach(t=>{const i=e[t];ac(Number.isFinite(i)||Array.isArray(i),"".concat(t," is required for transition"))})}}{constructor(e={}){super((Array.isArray(e)?e:e.transitionProps)||{compare:rz,extract:rz,required:pue}),this.opts=e}initializeProps(e,t){const i=super.initializeProps(e,t),{makeViewport:r,around:s}=this.opts;if(r&&s){const o=r(e),a=r(t),l=o.unproject(s);i.start.around=s,Object.assign(i.end,{around:a.project(l),aroundPosition:l,width:t.width,height:t.height})}return i}interpolateProps(e,t,i){const r={};for(const s of this._propsToExtract)r[s]=QE(e[s]||0,t[s]||0,i);if(t.aroundPosition){const s=this.opts.makeViewport(dt(dt({},t),r));Object.assign(r,s.panByPosition(t.aroundPosition,QE(e.around,t.around,i)))}return r}}const uh={transitionDuration:0},gue={transitionDuration:300,transitionEasing:n=>n,transitionInterruption:1},IS=n=>1-(1-n)*(1-n),Xg_WHEEL=["wheel"],Xg_PAN=["panstart","panmove","panend"],Xg_PINCH=["pinchstart","pinchmove","pinchend"],Xg_TRIPLE_PAN=["tripanstart","tripanmove","tripanend"],Xg_DOUBLE_TAP=["doubletap"],Xg_KEYBOARD=["keydown"];class bO{constructor(e,t={}){this.ControllerState=e,this.controllerState=null,this.controllerStateProps=null,this.eventManager=null,this.transitionManager=new hue(e,Hn(dt({},t),{onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}));const i=this.linearTransitionProps;this._transition=i&&Hn(dt({},gue),{transitionInterpolator:new sz({transitionProps:i})}),this._events=null,this._interactionState={isDragging:!1},this._customEvents=[],this.onViewStateChange=null,this.onStateChange=null,this.handleEvent=this.handleEvent.bind(this),this.setProps(t)}get linearTransitionProps(){return null}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.setProps(this.controllerStateProps)}finalize(){for(const e in this._events)this._events[e]&&this.eventManager.off(e,this.handleEvent);this.transitionManager.finalize()}handleEvent(e){const{ControllerState:t}=this;this.controllerState=new t(dt(dt({makeViewport:this.makeViewport},this.controllerStateProps),this._state));const i=this._eventStartBlocked;switch(e.type){case"panstart":return!i&&this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return!i&&this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"tripanstart":return!i&&this._onTriplePanStart(e);case"tripanmove":return this._onTriplePan(e);case"tripanend":return this._onTriplePanEnd(e);case"doubletap":return this._onDoubleTap(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}getCenter(e){const{x:t,y:i}=this.controllerStateProps,{offsetCenter:r}=e;return[r.x-t,r.y-i]}isPointInBounds(e,t){const{width:i,height:r}=this.controllerStateProps;if(t&&t.handled)return!1;const s=e[0]>=0&&e[0]<=i&&e[1]>=0&&e[1]<=r;return s&&t&&t.stopPropagation(),s}isFunctionKeyPressed(e){const{srcEvent:t}=e;return Boolean(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}isDragging(){return this._interactionState.isDragging}blockEvents(e){const t=setTimeout(()=>{this._eventStartBlocked===t&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=t}setProps(e){"onViewStateChange"in e&&(this.onViewStateChange=e.onViewStateChange),"onStateChange"in e&&(this.onStateChange=e.onStateChange),"makeViewport"in e&&(this.makeViewport=e.makeViewport),"dragMode"in e&&(this.dragMode=e.dragMode),this.controllerStateProps=e,"eventManager"in e&&this.eventManager!==e.eventManager&&(this.eventManager=e.eventManager,this._events={},this.toggleEvents(this._customEvents,!0)),"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);let{inertia:t}=e;!0===t&&(t=300),this.inertia=t;const{scrollZoom:i=!0,dragPan:r=!0,dragRotate:s=!0,doubleClickZoom:o=!0,touchZoom:a=!0,touchRotate:l=!1,keyboard:c=!0}=e,u=Boolean(this.onViewStateChange);this.toggleEvents(Xg_WHEEL,u&&i),this.toggleEvents(Xg_PAN,u&&(r||s)),this.toggleEvents(Xg_PINCH,u&&(a||l)),this.toggleEvents(Xg_TRIPLE_PAN,u&&l),this.toggleEvents(Xg_DOUBLE_TAP,u&&o),this.toggleEvents(Xg_KEYBOARD,u&&c),this.scrollZoom=i,this.dragPan=r,this.dragRotate=s,this.doubleClickZoom=o,this.touchZoom=a,this.touchRotate=l,this.keyboard=c}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,t){this.eventManager&&e.forEach(i=>{this._events[i]!==t&&(this._events[i]=t,t?this.eventManager.on(i,this.handleEvent):this.eventManager.off(i,this.handleEvent))})}updateViewport(e,t={},i={}){const r=dt(dt({},e.getViewportProps()),t),s=this.controllerState!==e;if(this._state=e.getState(),this._setInteractionState(i),s){const o=this.controllerState?this.controllerState.getViewportProps():null;this.onViewStateChange&&this.onViewStateChange({viewState:r,interactionState:this._interactionState,oldViewState:o})}}_onTransition(e){this.onViewStateChange&&(e.interactionState=this._interactionState,this.onViewStateChange(e))}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange&&this.onStateChange(this._interactionState)}_onPanStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;let i=this.isFunctionKeyPressed(e)||e.rightButton;(this.invertPan||"pan"===this.dragMode)&&(i=!i);const r=this.controllerState[i?"panStart":"rotateStart"]({pos:t});return this._panMove=i,this.updateViewport(r,uh,{isDragging:!0}),!0}_onPan(e){return!!this.isDragging()&&(this._panMove?this._onPanMove(e):this._onPanRotate(e))}_onPanEnd(e){return!!this.isDragging()&&(this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e))}_onPanMove(e){if(!this.dragPan)return!1;const t=this.getCenter(e),i=this.controllerState.pan({pos:t});return this.updateViewport(i,uh,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:t}=this;if(this.dragPan&&t&&e.velocity){const i=this.getCenter(e),s=this.controllerState.pan({pos:[i[0]+e.velocityX*t/2,i[1]+e.velocityY*t/2]}).panEnd();this.updateViewport(s,Hn(dt({},this._getTransitionProps()),{transitionDuration:t,transitionEasing:IS}),{isDragging:!1,isPanning:!0})}else{const i=this.controllerState.panEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const t=this.getCenter(e),i=this.controllerState.rotate({pos:t});return this.updateViewport(i,uh,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:t}=this;if(this.dragRotate&&t&&e.velocity){const i=this.getCenter(e),s=this.controllerState.rotate({pos:[i[0]+e.velocityX*t/2,i[1]+e.velocityY*t/2]}).rotateEnd();this.updateViewport(s,Hn(dt({},this._getTransitionProps()),{transitionDuration:t,transitionEasing:IS}),{isDragging:!1,isRotating:!0})}else{const i=this.controllerState.rotateEnd();this.updateViewport(i,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;e.preventDefault();const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const{speed:i=.01,smooth:r=!1}=this.scrollZoom,{delta:s}=e;let o=2/(1+Math.exp(-Math.abs(s*i)));s<0&&0!==o&&(o=1/o);const a=this.controllerState.zoom({pos:t,scale:o});return this.updateViewport(a,Hn(dt({},this._getTransitionProps({around:t})),{transitionDuration:r?250:1}),{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const i=this.controllerState.rotateStart({pos:t});return this.updateViewport(i,uh,{isDragging:!0}),!0}_onTriplePan(e){if(!this.touchRotate||!this.isDragging())return!1;const t=this.getCenter(e);t[0]-=e.deltaX;const i=this.controllerState.rotate({pos:t});return this.updateViewport(i,uh,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(e){if(!this.isDragging())return!1;const{inertia:t}=this;if(this.touchRotate&&t&&e.velocityY){const i=this.getCenter(e),r=[i[0],i[1]+=e.velocityY*t/2],s=this.controllerState.rotate({pos:r});this.updateViewport(s,Hn(dt({},this._getTransitionProps()),{transitionDuration:t,transitionEasing:IS}),{isDragging:!1,isRotating:!0}),this.blockEvents(t)}else{const i=this.controllerState.rotateEnd();this.updateViewport(i,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const i=this.controllerState.zoomStart({pos:t}).rotateStart({pos:t});return this._startPinchRotation=e.rotation,this._lastPinchEvent=e,this.updateViewport(i,uh,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let t=this.controllerState;if(this.touchZoom){const{scale:i}=e,r=this.getCenter(e);t=t.zoom({pos:r,scale:i})}if(this.touchRotate){const{rotation:i}=e;t=t.rotate({deltaAngleX:this._startPinchRotation-i})}return this.updateViewport(t,uh,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),this._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:t,_lastPinchEvent:i}=this;if(this.touchZoom&&t&&i&&e.scale!==i.scale){const r=this.getCenter(e);let s=this.controllerState.rotateEnd();const o=Math.log2(e.scale),a=(o-Math.log2(i.scale))/(e.deltaTime-i.deltaTime),l=Math.pow(2,o+a*t/2);s=s.zoom({pos:r,scale:l}).zoomEnd(),this.updateViewport(s,Hn(dt({},this._getTransitionProps({around:r})),{transitionDuration:t,transitionEasing:IS}),{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(t)}else{const r=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(r,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return this._startPinchRotation=null,this._lastPinchEvent=null,!0}_onDoubleTap(e){if(!this.doubleClickZoom)return!1;const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const i=this.isFunctionKeyPressed(e),r=this.controllerState.zoom({pos:t,scale:i?.5:2});return this.updateViewport(r,this._getTransitionProps({around:t}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const t=this.isFunctionKeyPressed(e),{zoomSpeed:i,moveSpeed:r,rotateSpeedX:s,rotateSpeedY:o}=this.keyboard,{controllerState:a}=this;let l;const c={};switch(e.srcEvent.code){case"Minus":l=t?a.zoomOut(i).zoomOut(i):a.zoomOut(i),c.isZooming=!0;break;case"Equal":l=t?a.zoomIn(i).zoomIn(i):a.zoomIn(i),c.isZooming=!0;break;case"ArrowLeft":t?(l=a.rotateLeft(s),c.isRotating=!0):(l=a.moveLeft(r),c.isPanning=!0);break;case"ArrowRight":t?(l=a.rotateRight(s),c.isRotating=!0):(l=a.moveRight(r),c.isPanning=!0);break;case"ArrowUp":t?(l=a.rotateUp(o),c.isRotating=!0):(l=a.moveUp(r),c.isPanning=!0);break;case"ArrowDown":t?(l=a.rotateDown(o),c.isRotating=!0):(l=a.moveDown(r),c.isPanning=!0);break;default:return!1}return this.updateViewport(l,this._getTransitionProps(),c),!0}_getTransitionProps(e){const{_transition:t}=this;return t?e?Hn(dt({},t),{transitionInterpolator:new sz(Hn(dt({},e),{transitionProps:this.linearTransitionProps,makeViewport:this.controllerState.makeViewport}))}):t:uh}}class oz{constructor(e){this._viewportProps=this._applyConstraints(e)}getViewportProps(){return this._viewportProps}getState(){return this._state}shortestPathFrom(e){return this._viewportProps}_applyConstraints(e){return e}}const dh_target=[0,0,0];class OS extends oz{constructor({makeViewport:e,width:t,height:i,rotationX:r=0,rotationOrbit:s=0,target:o=dh_target,zoom:a=0,minRotationX:l=-90,maxRotationX:c=90,minZoom:u=-(1/0),maxZoom:h=Infinity,startPanPosition:p,startRotatePos:g,startRotationX:m,startRotationOrbit:w,startZoomPosition:x,startZoom:H}){super({width:t,height:i,rotationX:r,rotationOrbit:s,target:o,zoom:a,minRotationX:l,maxRotationX:c,minZoom:u,maxZoom:h}),this._state={startPanPosition:p,startRotatePos:g,startRotationX:m,startRotationOrbit:w,startZoomPosition:x,startZoom:H},this.makeViewport=e}panStart({pos:e}){return this._getUpdatedState({startPanPosition:this._unproject(e)})}pan({pos:e,startPosition:t}){const i=this._state.startPanPosition||t;if(!i)return this;const s=this.makeViewport(this._viewportProps).panByPosition(i,e);return this._getUpdatedState(s)}panEnd(){return this._getUpdatedState({startPanPosition:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startRotationX:this._viewportProps.rotationX,startRotationOrbit:this._viewportProps.rotationOrbit})}rotate({pos:e,deltaAngleX:t=0,deltaAngleY:i=0}){const{startRotatePos:r,startRotationX:s,startRotationOrbit:o}=this._state,{width:a,height:l}=this._viewportProps;if(!r||!Number.isFinite(s)||!Number.isFinite(o))return this;let c;if(e){let u=(e[0]-r[0])/a;(s<-90||s>90)&&(u*=-1),c={rotationX:s+(e[1]-r[1])/l*180,rotationOrbit:o+180*u}}else c={rotationX:s+i,rotationOrbit:o+t};return this._getUpdatedState(c)}rotateEnd(){return this._getUpdatedState({startRotationX:null,startRotationOrbit:null})}shortestPathFrom(e){const t=e.getViewportProps(),i=dt({},this._viewportProps),{rotationOrbit:r}=i;return Math.abs(r-t.rotationOrbit)>180&&(i.rotationOrbit=r<0?r+360:r-360),i}zoomStart({pos:e}){return this._getUpdatedState({startZoomPosition:this._unproject(e),startZoom:this._viewportProps.zoom})}zoom({pos:e,startPos:t,scale:i}){const{zoom:r}=this._viewportProps;let{startZoom:s,startZoomPosition:o}=this._state;Number.isFinite(s)||(s=r,o=this._unproject(t)||this._unproject(e));const a=this._calculateNewZoom({scale:i,startZoom:s}),l=this.makeViewport(Hn(dt({},this._viewportProps),{zoom:a}));return this._getUpdatedState(dt({zoom:a},l.panByPosition(o,e)))}zoomEnd(){return this._getUpdatedState({startZoomPosition:null,startZoom:null})}zoomIn(e=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:e})})}zoomOut(e=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:1/e})})}moveLeft(e=50){return this._panFromCenter([-e,0])}moveRight(e=50){return this._panFromCenter([e,0])}moveUp(e=50){return this._panFromCenter([0,-e])}moveDown(e=50){return this._panFromCenter([0,e])}rotateLeft(e=15){return this._getUpdatedState({rotationOrbit:this._viewportProps.rotationOrbit-e})}rotateRight(e=15){return this._getUpdatedState({rotationOrbit:this._viewportProps.rotationOrbit+e})}rotateUp(e=10){return this._getUpdatedState({rotationX:this._viewportProps.rotationX-e})}rotateDown(e=10){return this._getUpdatedState({rotationX:this._viewportProps.rotationX+e})}_unproject(e){const t=this.makeViewport(this._viewportProps);return e&&t.unproject(e)}_calculateNewZoom({scale:e,startZoom:t}){const{maxZoom:i,minZoom:r}=this._viewportProps;return Number.isFinite(t)||(t=this._viewportProps.zoom),Fa(t+Math.log2(e),r,i)}_panFromCenter(e){const{width:t,height:i,target:r}=this._viewportProps;return this.pan({startPosition:r,pos:[t/2+e[0],i/2+e[1]]})}_getUpdatedState(e){return new OS(dt(dt(dt({},this._viewportProps),this._state),e))}_applyConstraints(e){const{maxZoom:t,minZoom:i,zoom:r,maxRotationX:s,minRotationX:o,rotationOrbit:a}=e;return e.zoom=Fa(r,i,t),e.rotationX=Fa(e.rotationX,o,s),(a<-180||a>180)&&(e.rotationOrbit=function(n,e){const t=n%360;return t<0?360+t:t}(a+180)-180),e}}class _ue extends bO{constructor(e){super(OS,e)}get linearTransitionProps(){return["target","zoom","rotationX","rotationOrbit"]}}class yue extends bO{constructor(e){e.dragMode=e.dragMode||"pan",super(OS,e)}_onPanRotate(e){return!1}get linearTransitionProps(){return["target","zoom"]}}const vue=(new Wn).lookAt({eye:[0,0,1]});function bue({width:n,height:e,near:t,far:i}){return n=n||1,e=e||1,(new Wn).ortho({left:-n/2,right:n/2,bottom:-e/2,top:e/2,near:t,far:i})}class wue extends Yg{constructor(e){const{width:t,height:i,near:r=.1,far:s=1e3,zoom:o=0,target:a=[0,0,0],flipY:l=!0}=e,c=Math.pow(2,o);super(Hn(dt({},e),{longitude:null,position:a,viewMatrix:vue.clone().scale([c,c*(l?-1:1),c]),projectionMatrix:bue({width:t,height:i,near:r,far:s}),zoom:o}))}panByPosition(e,t){const r=_S([],e,nU([],M0(t,this.pixelUnprojectionMatrix)));return{target:_S([],this.center,r)}}}let Eue=(()=>{class n extends vO{constructor(t){super(Hn(dt({},t),{type:wue}))}get controller(){return this._getControllerProps({type:yue})}}return n.displayName="OrthographicView",n})();const RS=Math.PI/180;function Sue({height:n,fovy:e,orbitAxis:t,rotationX:i,rotationOrbit:r,zoom:s}){const o=.5/Math.tan(e*RS/2),a="Z"===t?[0,0,1]:[0,1,0],l="Z"===t?[0,-o,0]:[0,0,o],c=(new Wn).lookAt({eye:l,up:a});c.rotateX(i*RS),"Z"===t?c.rotateZ(r*RS):c.rotateY(r*RS);const u=Math.pow(2,s)/(n||1);return c.scale(u),c}class xue extends Yg{constructor(e){const{height:t,fovy:i,orbitAxis:r,target:s=[0,0,0],rotationX:o=0,rotationOrbit:a=0,zoom:l=0}=e;super(Hn(dt({},e),{longitude:null,viewMatrix:Sue({height:t,fovy:i,orbitAxis:r,rotationX:o,rotationOrbit:a,zoom:l}),fovy:i,position:s,zoom:l})),this.projectedCenter=this.project(this.center)}unproject(e,{topLeft:t=!0}={}){const[i,r,s=this.projectedCenter[2]]=e,o=t?r:this.height-r,[a,l,c]=M0([i,o,s],this.pixelUnprojectionMatrix);return[a,l,c]}panByPosition(e,t){const i=this.project(e);return{target:this.unproject([this.width/2+i[0]-t[0],this.height/2+i[1]-t[1],this.projectedCenter[2]])}}}let Cue=(()=>{class n extends vO{constructor(t={}){const{orbitAxis:i="Z"}=t;super(Hn(dt({},t),{orbitAxis:i,type:xue}))}get controller(){return this._getControllerProps({type:_ue})}}return n.displayName="OrbitView",n})();const Tue=[255,255,255],Aue=1;let Mue=0;class az{constructor(e={}){const{color:t=Tue}=e,{intensity:i=Aue}=e;this.id=e.id||"ambient-".concat(Mue++),this.color=t,this.intensity=i,this.type="ambient"}}const Due=[255,255,255],Iue=1,Oue=[0,0,-1];let Rue=0;class lz{constructor(e={}){const{color:t=Due}=e,{intensity:i=Iue}=e,{direction:r=Oue}=e,{_shadow:s=!1}=e;this.id=e.id||"directional-".concat(Rue++),this.color=t,this.intensity=i,this.type="directional",this.direction=new xo(r).normalize().toArray(),this.shadow=s}getProjectedLight(){return this}}class cz{constructor(e={}){const{id:t="effect"}=e;this.id=t,this.props=dt({},e)}preRender(){}getModuleParameters(){}cleanup(){}}class wO extends class{constructor(e,t={}){const{id:i="pass"}=t;this.id=i,this.gl=e,this.props=dt({},t)}setProps(e){Object.assign(this.props,e)}render(){}cleanup(){}}{render(e){return Gu(this.gl,{framebuffer:e.target}),this._drawLayers(e)}_drawLayers(e){const{viewports:t,views:i,onViewportActive:r,clearCanvas:s=!0}=e;e.pass=e.pass||"unknown";const o=this.gl;s&&function(n){Gu(n,{viewport:[0,0,n.drawingBufferWidth,n.drawingBufferHeight]}),n.clear(16640)}(o);const a=[];for(const l of t){const c=l.viewport||l,u=i&&i[c.id];r(c);const h=this._getDrawLayerParams(c,e);e.view=u;const p=c.subViewports||[c];for(const g of p){e.viewport=g;const m=this._drawLayersInViewport(o,e,h);a.push(m)}}return a}_getDrawLayerParams(e,{layers:t,pass:i,layerFilter:r,effects:s,moduleParameters:o}){const a=[],l=uz(),c={viewport:e,isPicking:i.startsWith("picking"),renderPass:i};for(let u=0;u<t.length;u++){const h=t[u],p=this._shouldDrawLayer(h,c,r),m={shouldDrawLayer:p,layerRenderIndex:l(h,p)};p&&(m.moduleParameters=this._getModuleParameters(h,s,i,o),m.layerParameters=this.getLayerParameters(h,u)),a[u]=m}return a}_drawLayersInViewport(e,{layers:t,pass:i,viewport:r,view:s},o){const a=function(n,{viewport:e}){const t=n.canvas?n.canvas.clientHeight||n.canvas.height:100,i=e,r=Ng(n);return[i.x*r,(t-i.y-i.height)*r,i.width*r,i.height*r]}(e,{viewport:r});if(s&&s.props.clear){const c=!0===s.props.clear?{color:!0,depth:!0}:s.props.clear;oc(e,{scissorTest:!0,scissor:a},()=>qD(e,c))}const l={totalCount:t.length,visibleCount:0,compositeCount:0,pickableCount:0};Gu(e,{viewport:a});for(let c=0;c<t.length;c++){const u=t[c],{shouldDrawLayer:h,layerRenderIndex:p,moduleParameters:g,layerParameters:m}=o[c];if(h&&u.props.pickable&&l.pickableCount++,u.isComposite)l.compositeCount++;else if(h){l.visibleCount++,g.viewport=r;try{u.drawLayer({moduleParameters:g,uniforms:{layerIndex:p},parameters:m})}catch(w){u.raiseError(w,"drawing ".concat(u," to ").concat(i))}}}return l}shouldDrawLayer(e){return!0}getModuleParameters(e,t){return null}getLayerParameters(e,t){return e.props.parameters}_shouldDrawLayer(e,t,i){if(!this.shouldDrawLayer(e)||!e.props.visible||(t.layer=e,i&&!i(t)))return!1;let s=e.parent;for(;s;){if(!s.filterSubLayer(t))return!1;t.layer=s,s=s.parent}return e.activateViewport(t.viewport),!0}_getModuleParameters(e,t,i,r){const s=Object.assign(Object.create(e.props),{autoWrapLongitude:e.wrapLongitude,viewport:e.context.viewport,mousePosition:e.context.mousePosition,pickingActive:0,devicePixelRatio:Ng(this.gl)});if(t)for(const o of t)Object.assign(s,o.getModuleParameters(e));return Object.assign(s,this.getModuleParameters(e,t),r)}}function uz(n=0,e={}){const t={},i=(r,s)=>{const o=r.props._offset,a=r.id,l=r.parent&&r.parent.id;let c;if(l&&!(l in e)&&i(r.parent,!1),l in t){const u=t[l]=t[l]||uz(e[l],e);c=u(r,s),t[a]=u}else Number.isFinite(o)?(c=o+(e[l]||0),t[a]=null):c=n;return s&&c>=n&&(n=c+1),e[a]=c,c};return i}class Lue extends wO{constructor(e,t){super(e,t),this.shadowMap=new Pa(e,{width:1,height:1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.depthBuffer=new kg(e,{format:33189,width:1,height:1}),this.fbo=new Ps(e,{id:"shadowmap",width:1,height:1,attachments:{36064:this.shadowMap,36096:this.depthBuffer}})}render(e){const t=this.fbo;oc(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},()=>{const i=e.viewports[0],r=Ng(this.gl),s=i.width*r,o=i.height*r;(s!==t.width||o!==t.height)&&t.resize({width:s,height:o}),super.render(Hn(dt({},e),{target:t,pass:"shadow"}))})}shouldDrawLayer(e){return!1!==e.props.shadowEnabled}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}const Bue=Object.keys(Pi).map(n=>"const int COORDINATE_SYSTEM_".concat(n," = ").concat(Pi[n],";")).join(""),Vue=Object.keys(qc).map(n=>"const int PROJECTION_MODE_".concat(n," = ").concat(qc[n],";")).join(""),jue="".concat(Bue,"\n").concat(Vue,"\n\nuniform int project_uCoordinateSystem;\nuniform int project_uProjectionMode;\nuniform float project_uScale;\nuniform bool project_uWrapLongitude;\nuniform vec3 project_uCommonUnitsPerMeter;\nuniform vec3 project_uCommonUnitsPerWorldUnit;\nuniform vec3 project_uCommonUnitsPerWorldUnit2;\nuniform vec4 project_uCenter;\nuniform mat4 project_uModelMatrix;\nuniform mat4 project_uViewProjectionMatrix;\nuniform vec2 project_uViewportSize;\nuniform float project_uDevicePixelRatio;\nuniform float project_uFocalDistance;\nuniform vec3 project_uCameraPosition;\nuniform vec3 project_uCoordinateOrigin;\nuniform vec3 project_uCommonOrigin;\n\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / (PI * 2.0);\nconst vec3 ZERO_64_LOW = vec3(0.0);\nconst float EARTH_RADIUS = 6370972.0;\nconst float GLOBE_RADIUS = 256.0;\nfloat project_size(float meters) {\n  return meters * project_uCommonUnitsPerMeter.z;\n}\n\nvec2 project_size(vec2 meters) {\n  return meters * project_uCommonUnitsPerMeter.xy;\n}\n\nvec3 project_size(vec3 meters) {\n  return meters * project_uCommonUnitsPerMeter;\n}\n\nvec4 project_size(vec4 meters) {\n  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);\n}\nvec3 project_normal(vec3 vector) {\n  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);\n  return normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);\n}\n\nvec4 project_offset_(vec4 offset) {\n  float dy = offset.y;\n  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;\n  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);\n}\nvec2 project_mercator_(vec2 lnglat) {\n  float x = lnglat.x;\n  if (project_uWrapLongitude) {\n    x = mod(x + 180., 360.0) - 180.;\n  }\n  float y = clamp(lnglat.y, -89.9, 89.9);\n  return vec2(\n    radians(x) + PI,\n    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))\n  ) * WORLD_SCALE;\n}\n\nvec3 project_globe_(vec3 lnglatz) {\n  float lambda = radians(lnglatz.x);\n  float phi = radians(lnglatz.y);\n  float cosPhi = cos(phi);\n  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;\n\n  return vec3(\n    sin(lambda) * cosPhi,\n    -cos(lambda) * cosPhi,\n    sin(phi)\n  ) * D;\n}\nvec4 project_position(vec4 position, vec3 position64Low) {\n  vec4 position_world = project_uModelMatrix * position;\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_mercator_(position_world.xy),\n        project_size(position_world.z),\n        position_world.w\n      );\n    }\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {\n      position_world.xyz += project_uCoordinateOrigin;\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_globe_(position_world.xyz),\n        position_world.w\n      );\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {\n        return vec4(\n          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,\n          project_size(position_world.z),\n          position_world.w\n        );\n      }\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||\n    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&\n    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {\n    position_world.xyz -= project_uCoordinateOrigin;\n  }\n  return project_offset_(position_world + project_uModelMatrix * vec4(position64Low, 0.0));\n}\n\nvec4 project_position(vec4 position) {\n  return project_position(position, ZERO_64_LOW);\n}\n\nvec3 project_position(vec3 position, vec3 position64Low) {\n  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);\n  return projected_position.xyz;\n}\n\nvec3 project_position(vec3 position) {\n  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);\n  return projected_position.xyz;\n}\n\nvec2 project_position(vec2 position) {\n  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);\n  return projected_position.xy;\n}\n\nvec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {\n  return viewProjectionMatrix * position + center;\n}\nvec4 project_common_position_to_clipspace(vec4 position) {\n  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);\n}\nvec2 project_pixel_size_to_clipspace(vec2 pixels) {\n  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;\n  return offset * project_uFocalDistance;\n}\n\nfloat project_size_to_pixel(float meters) {\n  return project_size(meters) * project_uScale;\n}\nfloat project_pixel_size(float pixels) {\n  return pixels / project_uScale;\n}\nvec2 project_pixel_size(vec2 pixels) {\n  return pixels / project_uScale;\n}\nmat3 project_get_orientation_matrix(vec3 up) {\n  vec3 uz = normalize(up);\n  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));\n  vec3 uy = cross(uz, ux);\n  return mat3(ux, uy, uz);\n}\n\nbool project_needs_rotation(vec3 commonPosition, out mat3 transform) {\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    transform = project_get_orientation_matrix(commonPosition);\n    return true;\n  }\n  return false;\n}\n"),Uue={},EO={name:"project",dependencies:[{name:"fp32",vs:"#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\nconst float TWO_PI = 6.2831854820251465;\nconst float PI_2 = 1.5707963705062866;\nconst float PI_16 = 0.1963495463132858;\n\nconst float SIN_TABLE_0 = 0.19509032368659973;\nconst float SIN_TABLE_1 = 0.3826834261417389;\nconst float SIN_TABLE_2 = 0.5555702447891235;\nconst float SIN_TABLE_3 = 0.7071067690849304;\n\nconst float COS_TABLE_0 = 0.9807852506637573;\nconst float COS_TABLE_1 = 0.9238795042037964;\nconst float COS_TABLE_2 = 0.8314695954322815;\nconst float COS_TABLE_3 = 0.7071067690849304;\n\nconst float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;\nconst float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;\nconst float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;\nconst float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;\n\nfloat sin_taylor_fp32(float a) {\n  float r, s, t, x;\n\n  if (a == 0.0) {\n    return 0.0;\n  }\n\n  x = -a * a;\n  s = a;\n  r = a;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_3;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_5;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_7;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_9;\n  s = s + t;\n\n  return s;\n}\n\nvoid sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {\n  if (a == 0.0) {\n    sin_t = 0.0;\n    cos_t = 1.0;\n  }\n  sin_t = sin_taylor_fp32(a);\n  cos_t = sqrt(1.0 - sin_t * sin_t);\n}\n\nfloat tan_taylor_fp32(float a) {\n    float sin_a;\n    float cos_a;\n\n    if (a == 0.0) {\n        return 0.0;\n    }\n    float z = floor(a / TWO_PI);\n    float r = a - TWO_PI * z;\n\n    float t;\n    float q = floor(r / PI_2 + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return 1.0 / 0.0;\n    }\n\n    t = r - PI_2 * q;\n\n    q = floor(t / PI_16 + 0.5);\n    int k = int(q);\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return 1.0 / 0.0;\n    } else {\n        t = t - PI_16 * q;\n    }\n\n    float u = 0.0;\n    float v = 0.0;\n\n    float sin_t, cos_t;\n    float s, c;\n    sincos_taylor_fp32(t, sin_t, cos_t);\n\n    if (k == 0) {\n        s = sin_t;\n        c = cos_t;\n    } else {\n        if (abs(float(abs_k) - 1.0) < 0.5) {\n            u = COS_TABLE_0;\n            v = SIN_TABLE_0;\n        } else if (abs(float(abs_k) - 2.0) < 0.5) {\n            u = COS_TABLE_1;\n            v = SIN_TABLE_1;\n        } else if (abs(float(abs_k) - 3.0) < 0.5) {\n            u = COS_TABLE_2;\n            v = SIN_TABLE_2;\n        } else if (abs(float(abs_k) - 4.0) < 0.5) {\n            u = COS_TABLE_3;\n            v = SIN_TABLE_3;\n        }\n        if (k > 0) {\n            s = u * sin_t + v * cos_t;\n            c = u * cos_t - v * sin_t;\n        } else {\n            s = u * sin_t - v * cos_t;\n            c = u * cos_t + v * sin_t;\n        }\n    }\n\n    if (j == 0) {\n        sin_a = s;\n        cos_a = c;\n    } else if (j == 1) {\n        sin_a = c;\n        cos_a = -s;\n    } else if (j == -1) {\n        sin_a = -c;\n        cos_a = s;\n    } else {\n        sin_a = -s;\n        cos_a = -c;\n    }\n    return sin_a / cos_a;\n}\n#endif\n\nfloat tan_fp32(float a) {\n#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\n  return tan_taylor_fp32(a);\n#else\n  return tan(a);\n#endif\n}\n",fs:null}],vs:jue,getUniforms:function(n=Uue){return n.viewport?function({viewport:n,devicePixelRatio:e=1,modelMatrix:t=null,coordinateSystem:i=Pi.DEFAULT,coordinateOrigin:r,autoWrapLongitude:s=!1}={}){i===Pi.DEFAULT&&(i=n.isGeospatial?Pi.LNGLAT:Pi.CARTESIAN);const o=$ae({viewport:n,devicePixelRatio:e,coordinateSystem:i,coordinateOrigin:r});return o.project_uWrapLongitude=s,o.project_uModelMatrix=t||zae,o}(n):{}}},$ue=fS(function({viewport:n,center:e}){return new Wn(n.viewProjectionMatrix).invert().transform(e)}),Wue=fS(function({viewport:n,shadowMatrices:e}){const t=[],i=n.pixelUnprojectionMatrix,r=n.isGeospatial?void 0:1,s=[[0,0,r],[n.width,0,r],[0,n.height,r],[n.width,n.height,r],[0,0,-1],[n.width,0,-1],[0,n.height,-1],[n.width,n.height,-1]].map(o=>function(n,e){const[t,i,r]=n,s=M0([t,i,r],e);return Number.isFinite(r)?s:[s[0],s[1],0]}(o,i));for(const o of e){const a=o.clone().translate(new xo(n.center).negate()),l=s.map(u=>a.transform(u)),c=(new Wn).ortho({left:Math.min(...l.map(u=>u[0])),right:Math.max(...l.map(u=>u[0])),bottom:Math.min(...l.map(u=>u[1])),top:Math.max(...l.map(u=>u[1])),near:Math.min(...l.map(u=>-u[2])),far:Math.max(...l.map(u=>-u[2]))});t.push(c.multiplyRight(o))}return t}),que=[0,0,0,1],Yue=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],SO={name:"shadow",dependencies:[EO],vs:"\nconst int max_lights = 2;\nuniform mat4 shadow_uViewProjectionMatrices[max_lights];\nuniform vec4 shadow_uProjectCenters[max_lights];\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform int shadow_uLightId;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nvec4 shadow_setVertexPosition(vec4 position_commonspace) {\n  if (shadow_uDrawShadowMap) {\n    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);\n  }\n  if (shadow_uUseShadowMap) {\n    for (int i = 0; i < max_lights; i++) {\n      if(i < int(shadow_uLightCount)) {\n        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);\n        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;\n      }\n    }\n  }\n  return gl_Position;\n}\n",fs:"\nconst int max_lights = 2;\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform sampler2D shadow_uShadowMap0;\nuniform sampler2D shadow_uShadowMap1;\nuniform vec4 shadow_uColor;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nconst vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);\nconst vec4 bitUnpackShift = 1.0 / bitPackShift;\nconst vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);\n\nfloat shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {\n  vec4 rgbaDepth = texture2D(shadowMap, position.xy);\n\n  float z = dot(rgbaDepth, bitUnpackShift);\n  return smoothstep(0.001, 0.01, position.z - z);\n}\n\nvec4 shadow_filterShadowColor(vec4 color) {\n  if (shadow_uDrawShadowMap) {\n    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);\n    rgbaDepth -= rgbaDepth.gbaa * bitMask;\n    return rgbaDepth;\n  }\n  if (shadow_uUseShadowMap) {\n    float shadowAlpha = 0.0;\n    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);\n    if(shadow_uLightCount > 1.0) {\n      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);\n    }\n    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;\n    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);\n\n    return vec4(\n      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),\n      blendedAlpha\n    );\n  }\n  return color;\n}\n",inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    position = shadow_setVertexPosition(geometry.position);\n    ","fs:DECKGL_FILTER_COLOR":"\n    color = shadow_filterShadowColor(color);\n    "},getUniforms:(n={},e={})=>{if(n.drawToShadowMap||n.shadowMaps&&n.shadowMaps.length>0){const{shadowEnabled:t=!0}=n;return t&&n.shadowMatrices&&n.shadowMatrices.length>0?function(n={},e={}){const t={shadow_uDrawShadowMap:Boolean(n.drawToShadowMap),shadow_uUseShadowMap:!!n.shadowMaps&&n.shadowMaps.length>0,shadow_uColor:n.shadowColor||que,shadow_uLightId:n.shadowLightId||0,shadow_uLightCount:n.shadowMatrices.length},i=$ue({viewport:n.viewport,center:e.project_uCenter}),r=[],s=Wue({shadowMatrices:n.shadowMatrices,viewport:n.viewport}).slice();for(let o=0;o<n.shadowMatrices.length;o++){const a=s[o],l=a.clone().translate(new xo(n.viewport.center).negate());e.project_uCoordinateSystem===Pi.LNGLAT&&e.project_uProjectionMode===qc.WEB_MERCATOR?(s[o]=l,r[o]=i):(s[o]=a.clone().multiplyRight(Yue),r[o]=l.transform(i))}for(let o=0;o<s.length;o++)t["shadow_uViewProjectionMatrices[".concat(o,"]")]=s[o],t["shadow_uProjectCenters[".concat(o,"]")]=r[o],t["shadow_uShadowMap".concat(o)]=n.shadowMaps&&n.shadowMaps.length>0?n.shadowMaps[o]:n.dummyShadowMap;return t}(n,e):{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1}}return{}}},Jue={color:[255,255,255],intensity:1},dz=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],ede=[0,0,0,200/255];class xO extends cz{constructor(e){super(e),this.ambientLight=null,this.directionalLights=[],this.pointLights=[],this.shadowColor=ede,this.shadowPasses=[],this.shadowMaps=[],this.dummyShadowMap=null,this.shadow=!1,this.programManager=null;for(const t in e){const i=e[t];switch(i.type){case"ambient":this.ambientLight=i;break;case"directional":this.directionalLights.push(i);break;case"point":this.pointLights.push(i)}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(t=>t.shadow)}preRender(e,{layers:t,layerFilter:i,viewports:r,onViewportActive:s,views:o}){if(this.shadow){this.shadowMatrices=this._createLightMatrix(),0===this.shadowPasses.length&&this._createShadowPasses(e),this.programManager||(this.programManager=x0.getDefaultProgramManager(e),SO&&this.programManager.addDefaultModule(SO)),this.dummyShadowMap||(this.dummyShadowMap=new Pa(e,{width:1,height:1}));for(let a=0;a<this.shadowPasses.length;a++)this.shadowPasses[a].render({layers:t,layerFilter:i,viewports:r,onViewportActive:s,views:o,moduleParameters:{shadowLightId:a,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(e){const t=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return t.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(i=>i.getProjectedLight({layer:e})),pointLights:this.pointLights.map(i=>i.getProjectedLight({layer:e}))},t}cleanup(){for(const e of this.shadowPasses)e.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(SO),this.programManager=null)}_createLightMatrix(){const e=[];for(const t of this.directionalLights){const i=(new Wn).lookAt({eye:new xo(t.direction).negate()});e.push(i)}return e}_createShadowPasses(e){for(let t=0;t<this.directionalLights.length;t++){const i=new Lue(e);this.shadowPasses[t]=i,this.shadowMaps[t]=i.shadowMap}}_applyDefaultLights(){const{ambientLight:e,pointLights:t,directionalLights:i}=this;!e&&0===t.length&&0===i.length&&(this.ambientLight=new az(Jue),this.directionalLights.push(new lz(dz[0]),new lz(dz[1])))}}let tde=1,nde=1;class hz{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(e){const{delay:t=0,duration:i=Number.POSITIVE_INFINITY,rate:r=1,repeat:s=1}=e,o=tde++,a={time:0,delay:t,duration:i,rate:r,repeat:s};return this._setChannelTime(a,this.time),this.channels.set(o,a),o}removeChannel(e){this.channels.delete(e);for(const[t,i]of this.animations)i.channel===e&&this.detachAnimation(t)}isFinished(e){const t=this.channels.get(e);return void 0!==t&&this.time>=t.delay+t.duration*t.repeat}getTime(e){if(void 0===e)return this.time;const t=this.channels.get(e);return void 0===t?-1:t.time}setTime(e){this.time=Math.max(0,e);const t=this.channels.values();for(const r of t)this._setChannelTime(r,this.time);const i=this.animations.values();for(const r of i){const{animation:s,channel:o}=r;s.setTime(this.getTime(o))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,t){const i=nde++;return this.animations.set(i,{animation:e,channel:t}),e.setTime(this.getTime(t)),i}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(-1===this.lastEngineTime&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,t){const i=t-e.delay;i>=e.duration*e.repeat?e.time=e.duration*e.rate:(e.time=Math.max(0,i)%e.duration,e.time*=e.rate)}}class ide{constructor(e,t,i){this.id=e,this.context=i,this._loadCount=0,this._subscribers=new Set,this.setData(t)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,t){if(e===this._data&&!t)return;this._data=e;const i=++this._loadCount;let r=e;"string"==typeof e&&(r=TS(e)),r instanceof Promise?(this.isLoaded=!1,this._loader=r.then(s=>{this._loadCount===i&&(this.isLoaded=!0,this._error=null,this._content=s)}).catch(s=>{this._loadCount===i&&(this.isLoaded=!0,this._error=s||!0)})):(this.isLoaded=!0,this._error=null,this._content=e);for(const s of this._subscribers)s.onChange(this.getData())}}class rde{constructor({gl:e,protocol:t}){this.protocol=t||"resource://",this._context={gl:e,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return!!e.startsWith(this.protocol)||e in this._resources}add({resourceId:e,data:t,forceUpdate:i=!1,persistent:r=!0}){let s=this._resources[e];s?s.setData(t,i):(s=new ide(e,t,this._context),this._resources[e]=s),s.persistent=r}remove(e){const t=this._resources[e];t&&(t.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const t=this._consumers[e];if(t){for(const i in t){const r=t[i];r.resource&&r.resource.unsubscribe(r)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:t,consumerId:i,requestId:r="default"}){const{_resources:s,protocol:o}=this;e.startsWith(o)&&(s[e=e.replace(o,"")]||this.add({resourceId:e,data:null,persistent:!1}));const a=s[e];if(this._track(i,r,a,t),a)return a.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,t,i,r){const s=this._consumers,o=s[e]=s[e]||{},a=o[t]||{};a.resource&&(a.resource.unsubscribe(a),a.resource=null,this.prune()),i&&(o[t]=a,a.onChange=r,a.resource=i,i.subscribe(a))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const t=this._resources[e];!t.persistent&&!t.inUse()&&(t.delete(),delete this._resources[e])}}}const sde=[{name:"geometry",vs:"\nstruct VertexGeometry {\n  vec4 position;\n  vec3 worldPosition;\n  vec3 worldPositionAlt;\n  vec3 normal;\n  vec2 uv;\n  vec3 pickingColor;\n} geometry;\n",fs:"\n#define SMOOTH_EDGE_RADIUS 0.5\n\nstruct FragmentGeometry {\n  vec2 uv;\n} geometry;\n\nfloat smoothedge(float edge, float x) {\n  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);\n}\n"},EO],ode=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function ade(n){const e=x0.getDefaultProgramManager(n);for(const t of sde)e.addDefaultModule(t);for(const t of ode)e.addShaderHook(t);return e}const ude=Object.seal({layerManager:null,resourceManager:null,deck:null,gl:null,stats:null,shaderCache:null,pickingFBO:null,mousePosition:null,userData:{}});class dde{constructor(e,{deck:t,stats:i,viewport:r,timeline:s}={}){this.lastRenderedLayers=[],this.layers=[],this.resourceManager=new rde({gl:e,protocol:"deck://"}),this.context=Hn(dt({},ude),{layerManager:this,gl:e,deck:t,programManager:e&&ade(e),stats:i||new jD({id:"deck.gl"}),viewport:r||new Yg({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:s||new hz,resourceManager:this.resourceManager}),this._nextLayers=null,this._needsRedraw="Initial render",this._needsUpdate=!1,this._debug=!1,this.activateViewport=this.activateViewport.bind(this),Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let t=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const i of this.layers){const r=i.getNeedsRedraw(e);t=t||r}return t}needsUpdate(){return this._nextLayers&&this._nextLayers!==this.lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e=null}={}){return e?this.layers.filter(t=>e.find(i=>0===t.id.indexOf(i))):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,t){Co("layerManager.setLayers",this,t,e),this.lastRenderedLayers=e,e=tI(e,Boolean);for(const i of e)i.context=this.context;return this._updateLayers(this.layers,e),this}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw("updating layers: ".concat(e)),this.setLayers(this._nextLayers||this.lastRenderedLayers,e)),this._nextLayers=null}activateViewport(e){return Co("layerManager.activateViewport",this,e),e&&(this.context.viewport=e),this}_handleError(e,t,i){i.raiseError(t,"".concat(e," of ").concat(i))}_updateLayers(e,t){const i={};for(const o of e)i[o.id]?Bi.warn("Multiple old layers with same id ".concat(o.id))():i[o.id]=o;const r=[];this._updateSublayersRecursively(t,i,r),this._finalizeOldLayers(i);let s=!1;for(const o of r)if(o.hasUniformTransition()){s=!0;break}this._needsUpdate=s,this.layers=r}_updateSublayersRecursively(e,t,i){for(const r of e){r.context=this.context;const s=t[r.id];null===s&&Bi.warn("Multiple new layers with same id ".concat(r.id))(),t[r.id]=null;let o=null;try{this._debug&&s!==r&&r.validateProps(),s?(this._transferLayerState(s,r),this._updateLayer(r)):this._initializeLayer(r),i.push(r),o=r.isComposite&&r.getSubLayers()}catch(a){this._handleError("matching",a,r)}o&&this._updateSublayersRecursively(o,t,i)}}_finalizeOldLayers(e){for(const t in e){const i=e[t];i&&this._finalizeLayer(i)}}_initializeLayer(e){try{e._initialize(),e.lifecycle="Initialized"}catch(t){this._handleError("initialization",t,e)}}_transferLayerState(e,t){t._transferState(e),t.lifecycle="Matched. State transferred from previous layer",t!==e&&(e.lifecycle="Discarded. Awaiting garbage collection")}_updateLayer(e){try{e._update()}catch(t){this._handleError("update",t,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||"finalized ".concat(e),e.lifecycle="No longer matched. Awaiting garbage collection";try{e._finalize(),e.lifecycle="Finalized! Awaiting garbage collection"}catch(t){this._handleError("finalization",t,e)}}}class hde{constructor(e={}){this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="Initial render",this._needsUpdate=!0,this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers)this.controllers[e]&&this.controllers[e].finalize();this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const t=this.controllers[e];t&&t.updateTransition()}}getViewports(e){return e?this._viewports.filter(t=>t.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(t=>{e[t.id]=t}),e}getView(e){return"string"==typeof e?this.views.find(t=>t.id===e):e}getViewState(e){const t=this.getView(e),i=t&&this.viewState[t.getViewStateId()]||this.viewState;return t?t.filterViewState(i):i}getViewport(e){return this._viewportMap[e]}unproject(e,t){const i=this.getViewports(),r={x:e[0],y:e[1]};for(let s=i.length-1;s>=0;--s){const o=i[s];if(o.containsPixel(r)){const a=e.slice();return a[0]-=o.x,a[1]-=o.y,o.unproject(a,t)}}return null}setProps(e){"views"in e&&this._setViews(e.views),"viewState"in e&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,t){(e!==this.width||t!==this.height)&&(this.width=e,this.height=t,this.setNeedsUpdate("Size changed"))}_setViews(e){e=tI(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!F0(e,this.viewState)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):Bi.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(e,t){t.viewId=e,this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange(t)}_createController(e,t){return new(0,t.type)(dt({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,t.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:s=>e._getViewport(s,{width:s.width,height:s.height})},t))}_updateController(e,t,i,r){let s=e.controller;return s?(s=Hn(dt(dt(dt({},t),e.props),s),{id:e.id,x:i.x,y:i.y,width:i.width,height:i.height}),r?r.setProps(s):r=this._createController(e,s),r):null}_rebuildViewports(){const{width:e,height:t,views:i}=this,r=this.controllers;this._viewports=[],this.controllers={};let s=!1;for(let o=i.length;o--;){const a=i[o],l=this.getViewState(a),c=a.makeViewport({width:e,height:t,viewState:l});let u=r[a.id];a.controller&&!u&&(s=!0),(s||!a.controller)&&u&&(u.finalize(),u=null),this.controllers[a.id]=this._updateController(a,l,c,u),this._viewports.unshift(c)}for(const o in r)r[o]&&!this.controllers[o]&&r[o].finalize();this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,t){return e.length!==t.length||e.some((i,r)=>!e[r].equals(t[r]))}}class pde extends oz{constructor({makeViewport:e,width:t,height:i,latitude:r,longitude:s,zoom:o,bearing:a=0,pitch:l=0,altitude:c=1.5,maxZoom:u=20,minZoom:h=0,maxPitch:p=60,minPitch:g=0,startPanLngLat:m,startZoomLngLat:w,startRotatePos:x,startBearing:H,startPitch:I,startZoom:oe,normalize:Se}={}){ac(Number.isFinite(s)),ac(Number.isFinite(r)),ac(Number.isFinite(o)),super({width:t,height:i,latitude:r,longitude:s,zoom:o,bearing:a,pitch:l,altitude:c,maxZoom:u,minZoom:h,maxPitch:p,minPitch:g,normalize:Se}),this._state={startPanLngLat:m,startZoomLngLat:w,startRotatePos:x,startBearing:H,startPitch:I,startZoom:oe},this.makeViewport=e}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:t}){const i=this._state.startPanLngLat||this._unproject(t);if(!i)return this;const s=this.makeViewport(this._viewportProps).panByPosition(i,e);return this._getUpdatedState(s)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this._viewportProps.bearing,startPitch:this._viewportProps.pitch})}rotate({pos:e,deltaAngleX:t=0,deltaAngleY:i=0}){const{startRotatePos:r,startBearing:s,startPitch:o}=this._state;if(!r||!Number.isFinite(s)||!Number.isFinite(o))return this;let a;return a=e?this._calculateNewPitchAndBearing(Hn(dt({},this._getRotationParams(e,r)),{startBearing:s,startPitch:o})):{bearing:s+t,pitch:o+i},this._getUpdatedState(a)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this._viewportProps.zoom})}zoom({pos:e,startPos:t,scale:i}){let{startZoom:r,startZoomLngLat:s}=this._state;Number.isFinite(r)||(r=this._viewportProps.zoom,s=this._unproject(t)||this._unproject(e));const o=this._calculateNewZoom({scale:i,startZoom:r}),a=this.makeViewport(Hn(dt({},this._viewportProps),{zoom:o}));return this._getUpdatedState(dt({zoom:o},a.panByPosition(s,e)))}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this._viewportProps.bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this._viewportProps.bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this._viewportProps.pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this._viewportProps.pitch-e})}shortestPathFrom(e){const t=e.getViewportProps(),i=dt({},this._viewportProps),{bearing:r,longitude:s}=i;return Math.abs(r-t.bearing)>180&&(i.bearing=r<0?r+360:r-360),Math.abs(s-t.longitude)>180&&(i.longitude=s<0?s+360:s-360),i}_zoomFromCenter(e){const{width:t,height:i}=this._viewportProps;return this.zoom({pos:[t/2,i/2],scale:e})}_panFromCenter(e){const{width:t,height:i}=this._viewportProps;return this.pan({startPos:[t/2,i/2],pos:[t/2+e[0],i/2+e[1]]})}_getUpdatedState(e){return new this.constructor(dt(dt(dt({makeViewport:this.makeViewport},this._viewportProps),this._state),e))}_applyConstraints(e){const{maxZoom:t,minZoom:i,zoom:r}=e;e.zoom=Fa(r,i,t);const{maxPitch:s,minPitch:o,pitch:a}=e;e.pitch=Fa(a,o,s);const{normalize:l=!0}=e;return l&&Object.assign(e,function({width:n,height:e,longitude:t,latitude:i,zoom:r,pitch:s=0,bearing:o=0}){(t<-180||t>180)&&(t=oU(t+180,360)-180),(o<-180||o>180)&&(o=oU(o+180,360)-180);const a=CI(e/512);if(r<=a)r=a,i=0;else{const l=e/2/Math.pow(2,r),c=qg([0,l])[1];if(i<c)i=c;else{const u=qg([0,512-l])[1];i>u&&(i=u)}}return{width:n,height:e,longitude:t,latitude:i,zoom:r,pitch:s,bearing:o}}(e)),e}_unproject(e){const t=this.makeViewport(this._viewportProps);return e&&t.unproject(e)}_calculateNewZoom({scale:e,startZoom:t}){const{maxZoom:i,minZoom:r}=this._viewportProps;return Fa(t+Math.log2(e),r,i)}_calculateNewPitchAndBearing({deltaScaleX:e,deltaScaleY:t,startBearing:i,startPitch:r}){t=Fa(t,-1,1);const{minPitch:s,maxPitch:o}=this._viewportProps;let l=r;return t>0?l=r+t*(o-r):t<0&&(l=r-t*(s-r)),{pitch:l,bearing:i+180*e}}_getRotationParams(e,t){const i=e[0]-t[0],r=e[1]-t[1],s=e[1],o=t[1],{width:a,height:l}=this._viewportProps,c=i/a;let u=0;return r>0?Math.abs(l-o)>5&&(u=r/(o-l)*1.2):r<0&&o>5&&(u=1-s/o),u=Math.min(1,Math.max(-1,u)),{deltaScaleX:c,deltaScaleY:u}}}class gde extends bO{constructor(e){e.dragMode=e.dragMode||"pan",super(pde,e)}setProps(e){const t=this.controllerStateProps;super.setProps(e),(!t||t.height!==e.height)&&this.updateViewport(new this.ControllerState(dt(dt({makeViewport:this.makeViewport},this.controllerStateProps),this._state)))}get linearTransitionProps(){return["longitude","latitude","zoom","bearing","pitch"]}}let mde=(()=>{class n extends vO{constructor(t){super(Hn(dt({},t),{type:vU}))}get controller(){return this._getControllerProps({type:gde})}}return n.displayName="MapView",n})();const _de=new xO;class yde{constructor(){this.effects=[],this._internalEffects=[],this._needsRedraw="Initial render",this.setEffects()}setProps(e){"effects"in e&&(e.effects.length!==this.effects.length||!F0(e.effects,this.effects))&&(this.setEffects(e.effects),this._needsRedraw="effects changed")}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}getEffects(){return this._internalEffects}finalize(){this.cleanup()}setEffects(e=[]){this.cleanup(),this.effects=e,this._createInternalEffects()}cleanup(){for(const e of this.effects)e.cleanup();for(const e of this._internalEffects)e.cleanup();this.effects.length=0,this._internalEffects.length=0}_createInternalEffects(){this._internalEffects=this.effects.slice(),this.effects.some(e=>e instanceof xO)||this._internalEffects.push(_de)}}class vde extends wO{}const pz={blendFunc:[1,0,32771,0],blendEquation:32774};class gz extends wO{render(e){e.pickingFBO?(this.useAlpha=!0,this._drawPickingBuffer(e)):(this.useAlpha=!1,super.render(e))}_drawPickingBuffer({layers:e,layerFilter:t,views:i,viewports:r,onViewportActive:s,pickingFBO:o,deviceRect:{x:a,y:l,width:c,height:u},pass:h="picking",redrawReason:p,pickZ:g}){const m=this.gl;return this.pickZ=g,oc(m,Hn(dt({scissorTest:!0,scissor:[a,l,c,u],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0]},pz),{blend:!g}),()=>{super.render({target:o,layers:e,layerFilter:t,views:i,viewports:r,onViewportActive:s,pass:h,redrawReason:p})})}shouldDrawLayer(e){return e.props.pickable}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(e,t){const i=this.pickZ?{blend:!1}:Hn(dt({},pz),{blend:!0,blendColor:[0,0,0,this.useAlpha?(t+1)/255:1]});return dt(dt({},e.props.parameters),i)}}class wde{constructor(e){this.gl=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new vde(e),this.pickLayersPass=new gz(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){"layerFilter"in e&&this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),"drawPickingColors"in e&&this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){const t=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass;e.layerFilter=this.layerFilter,e.effects=e.effects||[],e.target=e.target||Ps.getDefaultFramebuffer(this.gl),this._preRender(e.effects,e);const i=this.lastPostProcessEffect?this.renderBuffers[0]:e.target,r=t.render(Hn(dt({},e),{target:i}));this._postRender(e.effects,e),this.renderCount++,Co("deckRenderer.renderLayers",this,r,e)}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}finalize(){const{renderBuffers:e}=this;for(const t of e)t.delete();e.length=0}_preRender(e,t){let i=null;for(const r of e)r.preRender(this.gl,t),r.postRender&&(i=r);i&&this._resizeRenderBuffers(),this.lastPostProcessEffect=i}_resizeRenderBuffers(){const{renderBuffers:e}=this;0===e.length&&e.push(new Ps(this.gl),new Ps(this.gl));for(const t of e)t.resize()}_postRender(e,t){const{renderBuffers:i}=this,r={inputBuffer:i[0],swapBuffer:i[1],target:null};for(const s of e)if(s.postRender){if(s===this.lastPostProcessEffect){r.target=t.target,s.postRender(this.gl,r);break}const o=s.postRender(this.gl,r);r.inputBuffer=o,r.swapBuffer=o===i[0]?i[1]:i[0]}}}const Ede={pickedColor:null,pickedLayer:null,pickedObjectIndex:-1};function Sde({pickedColors:n,layers:e,deviceX:t,deviceY:i,deviceRadius:r,deviceRect:s}){if(n){const{x:o,y:a,width:l,height:c}=s;let u=r*r,h=-1,p=0;for(let g=0;g<c;g++){const m=g+a-i,w=m*m;if(w>u)p+=4*l;else for(let x=0;x<l;x++){if(n[p+3]-1>=0){const I=x+o-t,oe=I*I+w;oe<=u&&(u=oe,h=p)}p+=4}}if(h>=0){const g=n[h+3]-1,m=n.slice(h,h+4),w=e[g];if(w){const x=w.decodePickingColor(m),H=Math.floor(h/4/l);return{pickedColor:m,pickedLayer:w,pickedObjectIndex:x,pickedX:o+(h/4-H*l),pickedY:a+H}}Bi.error("Picked non-existent layer. Is picking buffer corrupt?")()}}return Ede}function mz({pickInfo:n,mode:e,viewports:t,layerFilter:i,pixelRatio:r,x:s,y:o,z:a}){const l=n&&n.pickedLayer,u=function(n,e,t){for(let i=n.length-1;i>=0;i--){const r=n[i];if(r.containsPixel(e)&&(!t||t(r)))return r}return n[0]}(t,{x:s,y:o},i&&l&&(p=>i({layer:l,viewport:p,isPicking:!0,renderPass:"picking:".concat(e)}))),h=u&&u.unproject([s-u.x,o-u.y],{targetZ:a});return{color:null,layer:null,viewport:u,index:-1,picked:!1,x:s,y:o,pixel:[s,o],coordinate:h,devicePixel:n&&[n.pickedX,n.pickedY],pixelRatio:r}}function Cde(n){const{pickInfo:e,lastPickedInfo:t,mode:i,layers:r}=n,{pickedColor:s,pickedLayer:o,pickedObjectIndex:a}=e,l=o?[o]:[];if("hover"===i){const h=t.index,p=t.layerId,g=o&&o.props.id;if(g!==p||a!==h){if(g!==p){const m=r.find(w=>w.props.id===p);m&&l.unshift(m)}t.layerId=g,t.index=a,t.info=null}}const c=mz(n),u=new Map;return u.set(null,c),l.forEach(h=>{let p=dt({},c);h===o&&(p.color=s,p.index=a,p.picked=!0),p=_z({layer:h,info:p,mode:i}),h===o&&"hover"===i&&(t.info=p),u.set(p.layer.id,p),"hover"===i&&p.layer.updateAutoHighlight(p)}),u}function _z({layer:n,info:e,mode:t}){for(;n&&e;){const i=e.layer||null;e.sourceLayer=i,e.layer=n,e=n.getPickingInfo({info:e,mode:t,sourceLayer:i}),n=n.parent}return e}class Ade{constructor(e){this.gl=e,this.pickingFBO=null,this.pickLayersPass=new gz(e),this.layerFilter=null,this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:t,layers:i,viewports:r},s=this.lastPickedInfo.info){const o=s&&s.layer&&s.layer.id,a=s&&s.viewport&&s.viewport.id,l=o?i.find(p=>p.id===o):null,c=a&&r.find(p=>p.id===a)||r[0],u=c&&c.unproject([e-c.x,t-c.y]),h={x:e,y:t,viewport:c,coordinate:u,layer:l};return l?dt(dt({},s),h):Object.assign(h,{color:null,object:null,index:-1})}_resizeBuffer(){const{gl:e}=this;return this.pickingFBO||(this.pickingFBO=new Ps(e),Ps.isSupported(e,{colorBufferFloat:!0})&&(this.depthFBO=new Ps(e),this.depthFBO.attach({36064:new Pa(e,{format:yi(e)?34836:6408,type:5126})}))),this.pickingFBO.resize({width:e.canvas.width,height:e.canvas.height}),this.depthFBO&&this.depthFBO.resize({width:e.canvas.width,height:e.canvas.height}),this.pickingFBO}_getPickable(e){if(!1===this._pickable)return null;const t=e.filter(i=>i.isPickable()&&!i.isComposite);return t.length>255?(Bi.warn("Too many pickable layers, only picking the first 255")(),t.slice(0,255)):t.length?t:null}_pickClosestObject({layers:e,views:t,viewports:i,x:r,y:s,radius:o=0,depth:a=1,mode:l="query",unproject3D:c,onViewportActive:u}){if(!(e=this._getPickable(e)))return{result:[],emptyInfo:mz({viewports:i,x:r,y:s})};this._resizeBuffer();const h=Ng(this.gl),p=kD(this.gl,[r,s],!0),g=[p.x+Math.floor(p.width/2),p.y+Math.floor(p.height/2)],m=Math.round(o*h),{width:w,height:x}=this.pickingFBO,H=this._getPickingRect({deviceX:g[0],deviceY:g[1],deviceRadius:m,deviceWidth:w,deviceHeight:x});let I;const oe=[],Se={};for(let Pe=0;Pe<a;Pe++){const He=Sde({pickedColors:H&&this._drawAndSample({layers:e,views:t,viewports:i,onViewportActive:u,deviceRect:H,pass:"picking:".concat(l),redrawReason:l}),layers:e,deviceX:g[0],deviceY:g[1],deviceRadius:m,deviceRect:H});let vt;if(He.pickedLayer&&c&&this.depthFBO&&(vt=this._drawAndSample({layers:[He.pickedLayer],views:t,viewports:i,onViewportActive:u,deviceRect:{x:He.pickedX,y:He.pickedY,width:1,height:1},pass:"picking:".concat(l),redrawReason:"pick-z",pickZ:!0})[0]*i[0].distanceScales.metersPerUnit[2]+i[0].position[2]),He.pickedColor&&Pe+1<a){const St=He.pickedColor[3]-1;Se[St]=!0,e[St].disablePickingIndex(He.pickedObjectIndex)}I=Cde({pickInfo:He,lastPickedInfo:this.lastPickedInfo,mode:l,layers:e,layerFilter:this.layerFilter,viewports:i,x:r,y:s,z:vt,pixelRatio:h});for(const St of I.values())St.layer&&oe.push(St);if(!He.pickedColor)break}for(const Pe in Se)e[Pe].restorePickingColors();return{result:oe,emptyInfo:I&&I.get(null)}}_pickVisibleObjects({layers:e,views:t,viewports:i,x:r,y:s,width:o=1,height:a=1,mode:l="query",maxObjects:c=null,onViewportActive:u}){if(!(e=this._getPickable(e)))return[];this._resizeBuffer();const h=Ng(this.gl),p=kD(this.gl,[r,s],!0),g=p.x,m=p.y+p.height,w=kD(this.gl,[r+o,s+a],!0),H=w.y,Se=function({pickedColors:n,layers:e}){const t=new Map;if(n)for(let i=0;i<n.length;i+=4){const r=n[i+3]-1;if(r>=0){const s=n.slice(i,i+4),o=s.join(",");if(!t.has(o)){const a=e[r];a?t.set(o,{pickedColor:s,pickedLayer:a,pickedObjectIndex:a.decodePickingColor(s)}):Bi.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(t.values())}({pickedColors:this._drawAndSample({layers:e,views:t,viewports:i,onViewportActive:u,deviceRect:{x:g,y:H,width:w.x+w.width-g,height:m-H},pass:"picking:".concat(l),redrawReason:l}),layers:e}),Pe=new Map,Be=Number.isFinite(c);for(let He=0;He<Se.length&&!(Be&&Pe.size>=c);He++){const vt=Se[He];let St={color:vt.pickedColor,layer:null,index:vt.pickedObjectIndex,picked:!0,x:r,y:s,width:o,height:a,pixelRatio:h};St=_z({layer:vt.pickedLayer,info:St,mode:l}),Pe.has(St.object)||Pe.set(St.object,St)}return Array.from(Pe.values())}_drawAndSample({layers:e,views:t,viewports:i,onViewportActive:r,deviceRect:s,pass:o,redrawReason:a,pickZ:l}){if(e.length<1)return null;const c=l?this.depthFBO:this.pickingFBO;this.pickLayersPass.render({layers:e,layerFilter:this.layerFilter,views:t,viewports:i,onViewportActive:r,pickingFBO:c,deviceRect:s,pass:o,redrawReason:a,pickZ:l});const{x:u,y:h,width:p,height:g}=s,m=new(l?Float32Array:Uint8Array)(p*g*4);return XE(c,{sourceX:u,sourceY:h,sourceWidth:p,sourceHeight:g,target:m}),m}_getPickingRect({deviceX:e,deviceY:t,deviceRadius:i,deviceWidth:r,deviceHeight:s}){const o=Math.max(0,e-i),a=Math.max(0,t-i),l=Math.min(r,e+i+1)-o,c=Math.min(s,t+i+1)-a;return l<=0||c<=0?null:{x:o,y:a,width:l,height:c}}}const Mde={zIndex:1,position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:0,left:0,display:"none"};class Dde{constructor(e){const t=e.parentElement;t&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,Mde),t.appendChild(this.el)),this.isVisible=!1}setTooltip(e,t,i){const r=this.el;if("string"==typeof e)r.innerText=e;else{if(!e)return this.isVisible=!1,void(r.style.display="none");"text"in e&&(r.innerText=e.text),"html"in e&&(r.innerHTML=e.html),"className"in e&&(r.className=e.className),Object.assign(r.style,e.style)}this.isVisible=!0,r.style.display="block",r.style.transform="translate(".concat(t,"px, ").concat(i,"px)")}remove(){this.el&&this.el.remove()}}function yz(n,e){if(!n)throw new Error(e)}const tu={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document},vz=tu.global||tu.self||tu.window,Ode="object"!=typeof process||"[object process]"!==String(process)||process.browser,bz="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version),{_parseImageNode:Rde}=(bz&&parseFloat(bz[1]),vz),CO="undefined"!=typeof Image,TO="undefined"!=typeof ImageBitmap,Nde=Boolean(Rde),AO=!!Ode||Nde;function wz(n){const e=function(n){return"undefined"!=typeof ImageBitmap&&n instanceof ImageBitmap?"imagebitmap":"undefined"!=typeof Image&&n instanceof Image?"image":n&&"object"==typeof n&&n.data&&n.width&&n.height?"data":null}(n);if(!e)throw new Error("Not an image");return e}function Ez(n){switch(wz(n)){case"data":return n;case"image":case"imagebitmap":const e=document.createElement("canvas"),t=e.getContext("2d");if(!t)throw new Error("getImageData");return e.width=n.width,e.height=n.height,t.drawImage(n,0,0),t.getImageData(0,0,n.width,n.height);default:throw new Error("getImageData")}}const Lde=/^data:image\/svg\+xml/,kde=/\.svg((\?|#).*)?$/;function MO(n){return n&&(Lde.test(n)||kde.test(n))}function Bde(n,e){if(MO(e)){let i=(new TextDecoder).decode(n);try{"function"==typeof unescape&&"function"==typeof encodeURIComponent&&(i=unescape(encodeURIComponent(i)))}catch(s){throw new Error(s.message)}return`data:image/svg+xml;base64,${btoa(i)}`}return xz(n,e)}function xz(n,e){if(MO(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(n)])}function Cz(n,e,t){return DO.apply(this,arguments)}function DO(){return(DO=ii(function*(n,e,t){const i=Bde(n,t),r=self.URL||self.webkitURL,s="string"!=typeof i&&r.createObjectURL(i);try{return yield Vde(s||i,e)}finally{s&&r.revokeObjectURL(s)}})).apply(this,arguments)}function Vde(n,e){return IO.apply(this,arguments)}function IO(){return(IO=ii(function*(n,e){const t=new Image;return t.src=n,e.image&&e.image.decode&&t.decode?(yield t.decode(),t):yield new Promise((i,r)=>{try{t.onload=()=>i(t),t.onerror=s=>r(new Error(`Could not load image ${n}: ${s}`))}catch(s){r(s)}})})).apply(this,arguments)}const jde={};let Tz=!0;function Ude(n,e,t){return OO.apply(this,arguments)}function OO(){return(OO=ii(function*(n,e,t){let i;i=MO(t)?yield Cz(n,e,t):xz(n,t);const r=e&&e.imagebitmap;return yield zde(i,r)})).apply(this,arguments)}function zde(n){return RO.apply(this,arguments)}function RO(){return(RO=ii(function*(n,e=null){if((Hde(e)||!Tz)&&(e=null),e)try{return yield createImageBitmap(n,e)}catch(t){console.warn(t),Tz=!1}return yield createImageBitmap(n)})).apply(this,arguments)}function Hde(n){for(const e in n||jde)return!1;return!0}const nu=!1,k0=!0;function NO(n){const e=B0(n);return function(n){const e=B0(n);return e.byteLength>=24&&2303741511===e.getUint32(0,nu)?{mimeType:"image/png",width:e.getUint32(16,nu),height:e.getUint32(20,nu)}:null}(e)||function(n){const e=B0(n);if(!(e.byteLength>=3&&65496===e.getUint16(0,nu)&&255===e.getUint8(2)))return null;const{tableMarkers:i,sofMarkers:r}=function(){const n=new Set([65499,65476,65484,65501,65534]);for(let t=65504;t<65520;++t)n.add(t);return{tableMarkers:n,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}();let s=2;for(;s+9<e.byteLength;){const o=e.getUint16(s,nu);if(r.has(o))return{mimeType:"image/jpeg",height:e.getUint16(s+5,nu),width:e.getUint16(s+7,nu)};if(!i.has(o))return null;s+=2,s+=e.getUint16(s,nu)}return null}(e)||function(n){const e=B0(n);return e.byteLength>=10&&1195984440===e.getUint32(0,nu)?{mimeType:"image/gif",width:e.getUint16(6,k0),height:e.getUint16(8,k0)}:null}(e)||function(n){const e=B0(n);return e.byteLength>=14&&16973===e.getUint16(0,nu)&&e.getUint32(2,k0)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,k0),height:e.getUint32(22,k0)}:null}(e)}function B0(n){if(n instanceof DataView)return n;if(ArrayBuffer.isView(n))return new DataView(n.buffer);if(n instanceof ArrayBuffer)return new DataView(n);throw new Error("toDataView")}function Kde(n,e){const{mimeType:t}=NO(n)||{},{_parseImageNode:i}=vz;return yz(i),i(n,t,e)}function PO(){return(PO=ii(function*(n,e,t){const r=((e=e||{}).image||{}).type||"auto",{url:s}=t||{};let a;switch(Qde(r)){case"imagebitmap":a=yield Ude(n,e,s);break;case"image":a=yield Cz(n,e,s);break;case"data":a=yield Kde(n,e);break;default:yz(!1)}return"data"===r&&(a=Ez(a)),a})).apply(this,arguments)}function Qde(n){switch(n){case"auto":case"data":return function(){if(TO)return"imagebitmap";if(CO)return"image";if(AO)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}();default:return function(n){switch(n){case"auto":return TO||CO||AO;case"imagebitmap":return TO;case"image":return CO;case"data":return AO;default:throw new Error(`@loaders.gl/images: image ${n} not supported in this environment`)}}(n),n}}const Az={id:"image",module:"images",name:"Images",version:"3.0.12",mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],extensions:["png","jpg","jpeg","gif","webp","bmp","ico","svg"],parse:function(n,e,t){return PO.apply(this,arguments)},tests:[n=>Boolean(NO(new DataView(n)))],options:{image:{type:"auto",decode:!0}}},Jde={name:"JSON",extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:function(n){const e=n[0],t=n[n.length-1];return"{"===e&&"}"===t||"["===e&&"]"===t},parseTextSync:JSON.parse},V0="8.5.8",NS=Sr.CO.deck&&Sr.CO.deck.VERSION;if(NS&&NS!==V0)throw new Error("deck.gl - multiple versions detected: ".concat(NS," vs ").concat(V0));NS||(Bi.log(1,"deck.gl ".concat(V0))(),Sr.CO.deck=Object.assign(Sr.CO.deck||{},{VERSION:V0,version:V0,log:Bi,_registerLoggers:function(n){sI=n}}),QU([Jde,[Az,{imagebitmap:{premultiplyAlpha:"none"}}]]));const ehe=Sr.CO.deck;class PS extends $u{static isSupported(e,t=[]){const i=yi(e),r=FV(e,"TIMER_QUERY");let s=i||r;for(const o of t)switch(o){case"queries":s=s&&i;break;case"timers":s=s&&r;break;default:sn(!1)}return s}constructor(e,t={}){super(e,t),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(35007)}beginOcclusionQuery({conservative:e=!1}={}){return this.begin(e?36202:35887)}beginTransformFeedbackQuery(){return this.begin(35976)}begin(e){return this._queryPending||(this.target=e,this.gl2.beginQuery(this.target,this.handle)),this}end(){return this._queryPending||this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this}isResultAvailable(){if(!this._queryPending)return!1;const e=this.gl2.getQueryParameter(this.handle,34919);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.gl2.getParameter(36795)}getResult(){return this.gl2.getQueryParameter(this.handle,34918)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(e=Number.POSITIVE_INFINITY){if(this._pollingPromise)return this._pollingPromise;let t=0;return this._pollingPromise=new Promise((i,r)=>{const s=()=>{this.isResultAvailable()?(i(this.getResult()),this._pollingPromise=null):t++>e?(r("Timed out"),this._pollingPromise=null):requestAnimationFrame(s)};requestAnimationFrame(s)}),this._pollingPromise}_createHandle(){return PS.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}const Mz=(0,Sr.jU)()&&"undefined"!=typeof document;let uhe=0;class dhe{constructor(e={}){const{onCreateContext:t=(x=>mV(x)),onAddHTML:i=null,onInitialize:r=(()=>{}),onRender:s=(()=>{}),onFinalize:o=(()=>{}),onError:a,gl:l=null,glOptions:c={},debug:u=!1,createFramebuffer:h=!1,autoResizeViewport:p=!0,autoResizeDrawingBuffer:g=!0,stats:m=Af.get("animation-loop-"+uhe++)}=e;let{useDevicePixels:w=!0}=e;"useDevicePixelRatio"in e&&(fn.deprecated("useDevicePixelRatio","useDevicePixels")(),w=e.useDevicePixelRatio),this.props={onCreateContext:t,onAddHTML:i,onInitialize:r,onRender:s,onFinalize:o,onError:a,gl:l,glOptions:c,debug:u,createFramebuffer:h},this.gl=l,this.needsRedraw=null,this.timeline=null,this.stats=m,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:p,autoResizeDrawingBuffer:g,useDevicePixels:w}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(e){return sn("string"==typeof e),this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.autoResizeViewport=e.autoResizeViewport),"autoResizeDrawingBuffer"in e&&(this.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer),"useDevicePixels"in e&&(this.useDevicePixels=e.useDevicePixels),this}start(e={}){if(this._running)return this;this._running=!0;const t=this._getPageLoadPromise().then(()=>!this._running||this._initialized?null:(this._createWebGLContext(e),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=PS.isSupported(this.gl,["timers"])?new PS(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps))).then(i=>{this._running&&(this._addCallbackData(i||{}),!1!==i&&this._startLoop())});return this.props.onError&&t.catch(this.props.onError),this}redraw(){return this.isContextLost()||(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers()),this}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}toDataURL(){var e=this;return ii(function*(){return e.setNeedsRedraw("toDataURL"),yield e.waitForRender(),e.gl.canvas.toDataURL()})()}isContextLost(){return this.gl.isContextLost()}onCreateContext(...e){return this.props.onCreateContext(...e)}onInitialize(...e){return this.props.onInitialize(...e)}onRender(...e){return this.props.onRender(...e)}onFinalize(...e){return this.props.onFinalize(...e)}getHTMLControlValue(e,t=1){const i=document.getElementById(e);return i?Number(i.value):t}setViewParameters(){return fn.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const e=()=>{!this._running||(this.redraw(),this._animationFrameId=this._requestAnimationFrame(e))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(e)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=Mz?new Promise((e,t)=>{Mz&&"complete"===document.readyState?e(document):window.addEventListener("load",()=>{e(document)})}):Promise.resolve({})),this._pageLoadPromise}_setDisplay(e){this.display&&(this.display.delete(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_cancelAnimationFrame(e){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(e):function(n){return"undefined"!=typeof window&&window.cancelAnimationFrame?window.cancelAnimationFrame(n):clearTimeout(n)}(e)}_requestAnimationFrame(e){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(e):function(n){return"undefined"!=typeof window&&window.requestAnimationFrame?window.requestAnimationFrame(n):setTimeout(n,1e3/60)}(e)}_renderFrame(...e){this.display?this.display._renderFrame(...e):this.onRender(...e)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:e,height:t,aspect:i}=this._getSizeAndAspect();(e!==this.animationProps.width||t!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),i!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=t,this.animationProps.aspect=i,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(e){"object"==typeof e&&null!==e&&(this.animationProps=Object.assign({},this.animationProps,e))}_createWebGLContext(e){if(this.offScreen=e.canvas&&"undefined"!=typeof OffscreenCanvas&&e.canvas instanceof OffscreenCanvas,e=Object.assign({},e,this.props.glOptions),this.gl=this.props.gl?VD(this.props.gl,e):this.onCreateContext(e),!YE(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");(function(n){Gu(n,LD)})(this.gl),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const t=document.createElement("div");t.style.position="absolute",t.style.left="10px",t.style.bottom="10px",t.style.width="300px",t.style.background="white",e.appendChild(this.gl.canvas),e.appendChild(t);const i=this.props.onAddHTML(t);i&&(t.innerHTML=i)}}_getSizeAndAspect(){const e=this.gl.drawingBufferWidth,t=this.gl.drawingBufferHeight;let i=1;const{canvas:r}=this.gl;return r&&r.clientHeight?i=r.clientWidth/r.clientHeight:e>0&&t>0&&(i=e/t),{width:e,height:t,aspect:i}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&function(n,e={}){if(n.canvas)return void function(n,e,t){let i="width"in t?t.width:n.canvas.clientWidth,r="height"in t?t.height:n.canvas.clientHeight;(!i||!r)&&(fn.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,i=n.canvas.width||1,r=n.canvas.height||1),n.luma=n.luma||{},n.luma.canvasSizeInfo=n.luma.canvasSizeInfo||{};const s=n.luma.canvasSizeInfo;if(s.clientWidth!==i||s.clientHeight!==r||s.devicePixelRatio!==e){let o=e;const a=Math.floor(i*o),l=Math.floor(r*o);n.canvas.width=a,n.canvas.height=l,(n.drawingBufferWidth!==a||n.drawingBufferHeight!==l)&&(fn.warn("Device pixel ratio clamped")(),o=Math.min(n.drawingBufferWidth/i,n.drawingBufferHeight/r),n.canvas.width=Math.floor(i*o),n.canvas.height=Math.floor(r*o)),Object.assign(n.luma.canvasSizeInfo,{clientWidth:i,clientHeight:r,devicePixelRatio:e})}}(n,function(n){const e="undefined"==typeof window?1:window.devicePixelRatio||1;return Number.isFinite(n)?n<=0?1:n:n?e:1}(e.useDevicePixels),e);const t=n.getExtension("STACKGL_resize_drawingbuffer");t&&"width"in e&&"height"in e&&t.resize(e.width,e.height)}(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new Ps(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:e}=this.gl;e&&(e.addEventListener("mousemove",this._onMousemove),e.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(e){this.animationProps._mousePosition=[e.offsetX,e.offsetY]}_onMouseleave(e){this.animationProps._mousePosition=null}}var hhe=nt(524),FS=nt.n(hhe);const fhe={mousedown:1,mousemove:2,mouseup:4};(function(n){const e=n.prototype.handler;n.prototype.handler=function(i){const r=this.store;i.button>0&&"pointerdown"===i.type&&(function(n,e){for(let t=0;t<n.length;t++)if(n[t].pointerId===i.pointerId)return!0;return!1}(r)||r.push(i)),e.call(this,i)}})(FS().PointerEventInput),function(n){n.prototype.handler=function(t){let i=fhe[t.type];1&i&&t.button>=0&&(this.pressed=!0),2&i&&0===t.which&&(i=4),this.pressed&&(4&i&&(this.pressed=!1),this.callback(this.manager,i,{pointers:[t],changedPointers:[t],pointerType:"mouse",srcEvent:t}))}}(FS().MouseInput);const _he=FS().Manager,iu=FS(),yhe=iu?[[iu.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[iu.Rotate,{enable:!1}],[iu.Pinch,{enable:!1}],[iu.Swipe,{enable:!1}],[iu.Pan,{threshold:0,enable:!1}],[iu.Press,{enable:!1}],[iu.Tap,{event:"doubletap",taps:2,enable:!1}],[iu.Tap,{event:"anytap",enable:!1}],[iu.Tap,{enable:!1}]]:null,Oz={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},vhe={doubletap:["tap"]},bhe={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},LO={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},whe={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},Rz={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},Ehe="undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",Qg="undefined"!=typeof window?window:global;"undefined"!=typeof global?global:window,"undefined"!=typeof document&&document;let Nz=!1;try{const n={get passive(){return Nz=!0,!0}};Qg.addEventListener("test",n,n),Qg.removeEventListener("test",n,n)}catch(n){}const She=-1!==Ehe.indexOf("firefox"),{WHEEL_EVENTS:xhe}=LO,Fz=4.000244140625;class Ahe{constructor(e,t,i={}){this.element=e,this.callback=t,this.options=Object.assign({enable:!0},i),this.events=xhe.concat(i.events||[]),this.handleEvent=this.handleEvent.bind(this),this.events.forEach(r=>e.addEventListener(r,this.handleEvent,!!Nz&&{passive:!1}))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){"wheel"===e&&(this.options.enable=t)}handleEvent(e){if(!this.options.enable)return;let t=e.deltaY;Qg.WheelEvent&&(She&&e.deltaMode===Qg.WheelEvent.DOM_DELTA_PIXEL&&(t/=Qg.devicePixelRatio),e.deltaMode===Qg.WheelEvent.DOM_DELTA_LINE&&(t*=40));const i={x:e.clientX,y:e.clientY};0!==t&&t%Fz==0&&(t=Math.floor(t/Fz)),e.shiftKey&&t&&(t*=.25),this._onWheel(e,-t,i)}_onWheel(e,t,i){this.callback({type:"wheel",center:i,delta:t,srcEvent:e,pointerType:"mouse",target:e.target})}}const{MOUSE_EVENTS:Mhe}=LO,Lz="pointermove",kz="pointerover",Bz="pointerout",Vz="pointerleave";class Dhe{constructor(e,t,i={}){this.element=e,this.callback=t,this.pressed=!1,this.options=Object.assign({enable:!0},i),this.enableMoveEvent=this.options.enable,this.enableLeaveEvent=this.options.enable,this.enableOutEvent=this.options.enable,this.enableOverEvent=this.options.enable,this.events=Mhe.concat(i.events||[]),this.handleEvent=this.handleEvent.bind(this),this.events.forEach(r=>e.addEventListener(r,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){e===Lz&&(this.enableMoveEvent=t),e===kz&&(this.enableOverEvent=t),e===Bz&&(this.enableOutEvent=t),e===Vz&&(this.enableLeaveEvent=t)}handleEvent(e){this.handleOverEvent(e),this.handleOutEvent(e),this.handleLeaveEvent(e),this.handleMoveEvent(e)}handleOverEvent(e){this.enableOverEvent&&"mouseover"===e.type&&this.callback({type:kz,srcEvent:e,pointerType:"mouse",target:e.target})}handleOutEvent(e){this.enableOutEvent&&"mouseout"===e.type&&this.callback({type:Bz,srcEvent:e,pointerType:"mouse",target:e.target})}handleLeaveEvent(e){this.enableLeaveEvent&&"mouseleave"===e.type&&this.callback({type:Vz,srcEvent:e,pointerType:"mouse",target:e.target})}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":0===e.which&&(this.pressed=!1),this.pressed||this.callback({type:Lz,srcEvent:e,pointerType:"mouse",target:e.target});break;case"mouseup":this.pressed=!1}}}const{KEY_EVENTS:Ihe}=LO,jz="keydown";class Ohe{constructor(e,t,i={}){this.element=e,this.callback=t,this.options=Object.assign({enable:!0},i),this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=Ihe.concat(i.events||[]),this.handleEvent=this.handleEvent.bind(this),e.tabIndex=i.tabIndex||0,e.style.outline="none",this.events.forEach(r=>e.addEventListener(r,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){e===jz&&(this.enableDownEvent=t),"keyup"===e&&(this.enableUpEvent=t)}handleEvent(e){const t=e.target||e.srcElement;"INPUT"===t.tagName&&"text"===t.type||"TEXTAREA"===t.tagName||(this.enableDownEvent&&"keydown"===e.type&&this.callback({type:jz,srcEvent:e,key:e.key,target:e.target}),this.enableUpEvent&&"keyup"===e.type&&this.callback({type:"keyup",srcEvent:e,key:e.key,target:e.target}))}}const zz="contextmenu";class Rhe{constructor(e,t,i={}){this.element=e,this.callback=t,this.options=Object.assign({enable:!0},i),this.handleEvent=this.handleEvent.bind(this),e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,t){e===zz&&(this.options.enable=t)}handleEvent(e){!this.options.enable||this.callback({type:zz,center:{x:e.clientX,y:e.clientY},srcEvent:e,pointerType:"mouse",target:e.target})}}const Nhe={pointerdown:1,pointermove:2,pointerup:4,mousedown:1,mousemove:2,mouseup:4},Hz={srcElement:"root",priority:0};class $he{constructor(e){this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this.handleEvent=this.handleEvent.bind(this),this._active=!1}isEmpty(){return!this._active}add(e,t,i,r=!1,s=!1){const{handlers:o,handlersByElement:a}=this;i&&("object"!=typeof i||i.addEventListener)&&(i={srcElement:i}),i=i?Object.assign({},Hz,i):Hz;let l=a.get(i.srcElement);l||(l=[],a.set(i.srcElement,l));const c={type:e,handler:t,srcElement:i.srcElement,priority:i.priority};r&&(c.once=!0),s&&(c.passive=!0),o.push(c),this._active=this._active||!c.passive;let u=l.length-1;for(;u>=0&&!(l[u].priority>=c.priority);)u--;l.splice(u+1,0,c)}remove(e,t){const{handlers:i,handlersByElement:r}=this;for(let s=i.length-1;s>=0;s--){const o=i[s];if(o.type===e&&o.handler===t){i.splice(s,1);const a=r.get(o.srcElement);a.splice(a.indexOf(o),1),0===a.length&&r.delete(o.srcElement)}}this._active=i.some(s=>!s.passive)}handleEvent(e){if(this.isEmpty())return;const t=this._normalizeEvent(e);let i=e.srcEvent.target;for(;i&&i!==t.rootElement;){if(this._emit(t,i),t.handled)return;i=i.parentNode}this._emit(t,"root")}_emit(e,t){const i=this.handlersByElement.get(t);if(i){let r=!1;const s=()=>{e.handled=!0},o=()=>{e.handled=!0,r=!0},a=[];for(let l=0;l<i.length;l++){const{type:c,handler:u,once:h}=i[l];if(u(Object.assign({},e,{type:c,stopPropagation:s,stopImmediatePropagation:o})),h&&a.push(i[l]),r)break}for(let l=0;l<a.length;l++){const{type:c,handler:u}=a[l];this.remove(c,u)}}}_normalizeEvent(e){const t=this.eventManager.element;return Object.assign({},e,function(n){const e=Nhe[n.srcEvent.type];if(!e)return null;const{buttons:t,button:i,which:r}=n.srcEvent;let s=!1,o=!1,a=!1;return 4===e||2===e&&!Number.isFinite(t)?(s=1===r,o=2===r,a=3===r):2===e?(s=Boolean(1&t),o=Boolean(4&t),a=Boolean(2&t)):1===e&&(s=0===i,o=1===i,a=2===i),{leftButton:s,middleButton:o,rightButton:a}}(e),function(n,e){const{srcEvent:t}=n;if(!n.center&&!Number.isFinite(t.clientX))return null;const i=n.center||{x:t.clientX,y:t.clientY},r=e.getBoundingClientRect();return{center:i,offsetCenter:{x:(i.x-r.left-e.clientLeft)/(r.width/e.offsetWidth||1),y:(i.y-r.top-e.clientTop)/(r.height/e.offsetHeight||1)}}}(e,t),{handled:!1,rootElement:t})}}const Whe={events:null,recognizers:null,recognizerOptions:{},Manager:_he,touchAction:"none",tabIndex:0};class qhe{constructor(e=null,t={}){this.options=Object.assign({},Whe,t),this.events=new Map,this._onBasicInput=this._onBasicInput.bind(this),this._onOtherEvent=this._onOtherEvent.bind(this),this.setElement(e);const{events:i}=t;i&&this.on(i)}setElement(e){if(this.element&&this.destroy(),this.element=e,!e)return;const{options:t}=this;this.manager=new(0,t.Manager)(e,{touchAction:t.touchAction,recognizers:t.recognizers||yhe}).on("hammer.input",this._onBasicInput),t.recognizers||Object.keys(Oz).forEach(r=>{const s=this.manager.get(r);s&&Oz[r].forEach(o=>{s.recognizeWith(o)})});for(const r in t.recognizerOptions){const s=this.manager.get(r);if(s){const o=t.recognizerOptions[r];delete o.enable,s.set(o)}}this.wheelInput=new Ahe(e,this._onOtherEvent,{enable:!1}),this.moveInput=new Dhe(e,this._onOtherEvent,{enable:!1}),this.keyInput=new Ohe(e,this._onOtherEvent,{enable:!1,tabIndex:t.tabIndex}),this.contextmenuInput=new Rhe(e,this._onOtherEvent,{enable:!1});for(const[r,s]of this.events)s.isEmpty()||(this._toggleRecognizer(s.recognizerName,!0),this.manager.on(r,s.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(e,t,i){this._addEventHandler(e,t,i,!1)}once(e,t,i){this._addEventHandler(e,t,i,!0)}watch(e,t,i){this._addEventHandler(e,t,i,!1,!0)}off(e,t){this._removeEventHandler(e,t)}_toggleRecognizer(e,t){const{manager:i}=this;if(!i)return;const r=i.get(e);if(r&&r.options.enable!==t){r.set({enable:t});const s=vhe[e];s&&!this.options.recognizers&&s.forEach(o=>{const a=i.get(o);t?(a.requireFailure(e),r.dropRequireFailure(o)):a.dropRequireFailure(e)})}this.wheelInput.enableEventType(e,t),this.moveInput.enableEventType(e,t),this.keyInput.enableEventType(e,t),this.contextmenuInput.enableEventType(e,t)}_addEventHandler(e,t,i,r,s){if("string"!=typeof e){i=t;for(const u in e)this._addEventHandler(u,e[u],i,r,s);return}const{manager:o,events:a}=this,l=Rz[e]||e;let c=a.get(l);c||(c=new $he(this),a.set(l,c),c.recognizerName=whe[l]||l,o&&o.on(l,c.handleEvent)),c.add(e,t,i,r,s),c.isEmpty()||this._toggleRecognizer(c.recognizerName,!0)}_removeEventHandler(e,t){if("string"!=typeof e){for(const o in e)this._removeEventHandler(o,e[o]);return}const{events:i}=this,s=i.get(Rz[e]||e);if(s&&(s.remove(e,t),s.isEmpty())){const{recognizerName:o}=s;let a=!1;for(const l of i.values())if(l.recognizerName===o&&!l.isEmpty()){a=!0;break}a||this._toggleRecognizer(o,!1)}}_onBasicInput(e){const{srcEvent:t}=e,i=bhe[t.type];i&&this.manager.emit(i,e)}_onOtherEvent(e){this.manager.emit(e.type,e)}}function Nf(){}const Gz={id:"",width:"100%",height:"100%",pickingRadius:0,layerFilter:null,glOptions:{},gl:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},onWebGLInitialized:Nf,onResize:Nf,onViewStateChange:Nf,onInteractionStateChange:Nf,onBeforeRender:Nf,onAfterRender:Nf,onLoad:Nf,onError:(n,e)=>Bi.error(n)(),_onMetrics:null,getCursor:({isDragging:n})=>n?"grabbing":"grab",debug:!1,drawPickingColors:!1};class kS{constructor(e){e=dt(dt({},Gz),e),this.props={},this.width=0,this.height=0,this.viewManager=null,this.layerManager=null,this.effectManager=null,this.deckRenderer=null,this.deckPicker=null,this._needsRedraw=!0,this._pickRequest={},this._lastPointerDownInfo=null,this.viewState=null,this.interactiveState={isHovering:!1,isDragging:!1},this._onEvent=this._onEvent.bind(this),this._onPointerDown=this._onPointerDown.bind(this),this._onPointerMove=this._onPointerMove.bind(this),e.viewState&&e.initialViewState&&Bi.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),"IE"===(0,Sr.qs)()&&Bi.warn("IE 11 support will be deprecated in v8.0")(),e.gl||"undefined"!=typeof document&&(this.canvas=this._createCanvas(e)),this.animationLoop=this._createAnimationLoop(e),this.stats=new jD({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(e),e._typedArrayManagerProps&&p0.setProps(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){this.animationLoop.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,this.layerManager&&(this.layerManager.finalize(),this.layerManager=null,this.viewManager.finalize(),this.viewManager=null,this.effectManager.finalize(),this.effectManager=null,this.deckRenderer.finalize(),this.deckRenderer=null,this.deckPicker.finalize(),this.deckPicker=null,this.eventManager.destroy(),this.eventManager=null,this.tooltip.remove(),this.tooltip=null),!this.props.canvas&&!this.props.gl&&this.canvas&&(this.canvas.parentElement.removeChild(this.canvas),this.canvas=null)}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&Bi.removed("onLayerHover","onHover")(),"onLayerClick"in e&&Bi.removed("onLayerClick","onClick")(),e.initialViewState&&!F0(this.props.initialViewState,e.initialViewState)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const t=Object.create(this.props);Object.assign(t,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(t),this.layerManager&&(this.viewManager.setProps(t),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(t),this.effectManager.setProps(t),this.deckRenderer.setProps(t),this.deckPicker.setProps(t)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(this.props._animate)return"Deck._animate";let t=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const i=this.viewManager.needsRedraw(e),r=this.layerManager.needsRedraw(e),s=this.effectManager.needsRedraw(e),o=this.deckRenderer.needsRedraw(e);return t=t||i||r||s||o,t}redraw(e){if(!this.layerManager)return;const t=e||this.needsRedraw({clearRedrawFlags:!0});!t||(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(t):this._drawLayers(t))}getViews(){return this.viewManager.views}getViewports(e){return this.viewManager.getViewports(e)}pickObject(e){const t=this._pick("pickObject","pickObject Time",e).result;return t.length?t[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,t=!1){for(const i in e)this.layerManager.resourceManager.add({resourceId:i,data:e[i],forceUpdate:t})}_removeResources(e){for(const t of e)this.layerManager.resourceManager.remove(t)}_pick(e,t,i){const{stats:r}=this;r.get("Pick Count").incrementCount(),r.get(t).timeStart();const s=this.deckPicker[e](dt({layers:this.layerManager.getLayers(i),views:this.viewManager.getViews(),viewports:this.getViewports(i),onViewportActive:this.layerManager.activateViewport},i));return r.get(t).timeEnd(),s}_createCanvas(e){let t=e.canvas;return"string"==typeof t&&(t=document.getElementById(t),ac(t)),t||(t=document.createElement("canvas"),t.id=e.id||"deckgl-overlay",(e.parent||document.body).appendChild(t)),Object.assign(t.style,e.style),t}_setCanvasSize(e){if(!this.canvas)return;let{width:t,height:i}=e;(t||0===t)&&(t=Number.isFinite(t)?"".concat(t,"px"):t,this.canvas.style.width=t),(i||0===i)&&(i=Number.isFinite(i)?"".concat(i,"px"):i,this.canvas.style.position="absolute",this.canvas.style.height=i)}_updateCanvasSize(){if(this._checkForCanvasSizeChange()){const{width:e,height:t}=this;this.viewManager.setProps({width:e,height:t}),this.props.onResize({width:this.width,height:this.height})}}_checkForCanvasSizeChange(){const{canvas:e}=this;if(!e)return!1;const t=e.clientWidth||e.width,i=e.clientHeight||e.height;return(t!==this.width||i!==this.height)&&(this.width=t,this.height=i,!0)}_createAnimationLoop(e){const{width:t,height:i,gl:r,glOptions:s,debug:o,onError:a,onBeforeRender:l,onAfterRender:c,useDevicePixels:u,autoResizeDrawingBuffer:h}=e;return new dhe({width:t,height:i,useDevicePixels:u,autoResizeDrawingBuffer:h,autoResizeViewport:!1,gl:r,onCreateContext:p=>mV(Hn(dt(dt({},s),p),{canvas:this.canvas,debug:o,onContextLost:()=>this._onContextLost()})),onInitialize:p=>this._setGLContext(p.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:l,onAfterRender:c,onError:a})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let e=this.props.views||[new mde({id:"default-view"})];return e=Array.isArray(e)?e:[e],e.length&&this.props.controller&&(e[0].props.controller=this.props.controller),e}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_onPointerMove(e){const{_pickRequest:t}=this;if("pointerleave"===e.type)t.x=-1,t.y=-1,t.radius=0;else{if(e.leftButton||e.rightButton)return;{const i=e.offsetCenter;if(!i)return;t.x=i.x,t.y=i.y,t.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:t.x,y:t.y}),t.event=e,t.mode="hover"}_pickAndCallback(){const{_pickRequest:e}=this;if(e.event){const{result:t,emptyInfo:i}=this._pick("pickObject","pickObject Time",e);this.interactiveState.isHovering=t.length>0;let r=i,s=!1;for(const o of t)r=o,s=o.layer.onHover(o,e.event);if(!s&&this.props.onHover&&this.props.onHover(r,e.event),this.props.getTooltip){const o=this.props.getTooltip(r);this.tooltip.setTooltip(o,r.x,r.y)}e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.interactiveState))}_setGLContext(e){if(this.layerManager)return;this.canvas||(this.canvas=e.canvas,VD(e,{enable:!0,copyState:!0})),this.tooltip=new Dde(this.canvas),Gu(e,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(e);const t=new hz;t.play(),this.animationLoop.attachTimeline(t),this.eventManager=new qhe(this.props.parent||e.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const r in eV)this.eventManager.on(r,this._onEvent);this.viewManager=new hde({timeline:t,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const i=this.viewManager.getViewports()[0];this.layerManager=new dde(e,{deck:this,stats:this.stats,viewport:i,timeline:t}),this.effectManager=new yde,this.deckRenderer=new wde(e),this.deckPicker=new Ade(e),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,t){const{gl:i}=this.layerManager.context;Gu(i,this.props.parameters),this.props.onBeforeRender({gl:i}),this.deckRenderer.renderLayers(dt({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",redrawReason:e,effects:this.effectManager.getEffects()},t)),this.props.onAfterRender({gl:i})}_onRenderFrame(e){this._getFrameStats(),this._metricsCounter++%60==0&&(this._getMetrics(),this.stats.reset(),Bi.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(!1),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const t=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState=Hn(dt({},this.viewState),{[e.viewId]:t}),this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.interactiveState.isDragging=e.isDragging,this.props.onInteractionStateChange(e)}_onEvent(e){const t=eV[e.type],i=e.offsetCenter;if(!t||!i)return;const r=this.layerManager.getLayers(),s=this.deckPicker.getLastPickedObject({x:i.x,y:i.y,layers:r,viewports:this.getViewports(i)},this._lastPointerDownInfo),{layer:o}=s,a=o&&(o[t.handler]||o.props[t.handler]),l=this.props[t.handler];let c=!1;a&&(c=a.call(o,s,e)),!c&&l&&l(s,e)}_onPointerDown(e){const t=e.offsetCenter;this._lastPointerDownInfo=this.pickObject({x:t.x,y:t.y,radius:this.props.pickingRadius})}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const t=this.animationLoop.stats;e.get("GPU Time").addTime(t.get("GPU Time").lastTiming),e.get("CPU Time").addTime(t.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:t}=this;e.fps=t.get("frameRate").getHz(),e.setPropsTime=t.get("setProps Time").time,e.updateAttributesTime=t.get("Update Attributes").time,e.framesRedrawn=t.get("Redraw Count").count,e.pickTime=t.get("pickObject Time").time+t.get("pickMultipleObjects Time").time+t.get("pickObjects Time").time,e.pickCount=t.get("Pick Count").count,e.gpuTime=t.get("GPU Time").time,e.cpuTime=t.get("CPU Time").time,e.gpuTimePerFrame=t.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=t.get("CPU Time").getAverageTime();const i=Af.get("Memory Usage");e.bufferMemory=i.get("Buffer Memory").count,e.textureMemory=i.get("Texture Memory").count,e.renderbufferMemory=i.get("Renderbuffer Memory").count,e.gpuMemory=i.get("GPU Memory").count}}kS.getPropTypes=function(n){return{id:n.string,width:n.oneOfType([n.number,n.string]),height:n.oneOfType([n.number,n.string]),layers:n.oneOfType([n.object,n.array]),layerFilter:n.func,views:n.oneOfType([n.object,n.array]),viewState:n.object,effects:n.arrayOf(n.instanceOf(cz)),controller:n.oneOfType([n.func,n.bool,n.object]),gl:n.object,glOptions:n.object,parameters:n.object,pickingRadius:n.number,useDevicePixels:n.oneOfType([n.bool,n.number]),touchAction:n.string,eventRecognizerOptions:n.object,onWebGLInitialized:n.func,onResize:n.func,onViewStateChange:n.func,onInteractionStateChange:n.func,onBeforeRender:n.func,onAfterRender:n.func,onLoad:n.func,onError:n.func,debug:n.bool,drawPickingColors:n.bool,_framebuffer:n.object,_animate:n.bool,_pickable:n.bool,_typedArrayManagerProps:n.object}},kS.defaultProps=Gz,kS.VERSION=ehe.VERSION;const $z={name:"project32",dependencies:[EO],vs:"\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition\n) {\n  vec3 projectedPosition = project_position(position, position64Low);\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    // offset is specified as ENU\n    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe\n    mat3 rotation = project_get_orientation_matrix(projectedPosition);\n    offset = rotation * offset;\n  }\n  commonPosition = vec4(projectedPosition + offset, 1.0);\n  return project_common_position_to_clipspace(commonPosition);\n}\n\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset\n) {\n  vec4 commonPosition;\n  return project_position_to_clipspace(position, position64Low, offset, commonPosition);\n}\n"},Wz="#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))\n\nstruct AmbientLight {\n vec3 color;\n};\n\nstruct PointLight {\n vec3 color;\n vec3 position;\n vec3 attenuation;\n};\n\nstruct DirectionalLight {\n  vec3 color;\n  vec3 direction;\n};\n\nuniform AmbientLight lighting_uAmbientLight;\nuniform PointLight lighting_uPointLight[MAX_LIGHTS];\nuniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];\nuniform int lighting_uPointLightCount;\nuniform int lighting_uDirectionalLightCount;\n\nuniform bool lighting_uEnabled;\n\nfloat getPointLightAttenuation(PointLight pointLight, float distance) {\n  return pointLight.attenuation.x\n       + pointLight.attenuation.y * distance\n       + pointLight.attenuation.z * distance * distance;\n}\n\n#endif\n",Xhe={lightSources:{}};function VO({color:n=[0,0,0],intensity:e=1}={}){return n.map(t=>t*e/255)}const jO={name:"lights",vs:Wz,fs:Wz,getUniforms:function qz(n=Xhe){if("lightSources"in n){const{ambientLight:e,pointLights:t,directionalLights:i}=n.lightSources||{};return e||t&&t.length>0||i&&i.length>0?Object.assign({},function({ambientLight:n,pointLights:e=[],directionalLights:t=[]}){const i={};return i["lighting_uAmbientLight.color"]=n?VO(n):[0,0,0],e.forEach((r,s)=>{i[`lighting_uPointLight[${s}].color`]=VO(r),i[`lighting_uPointLight[${s}].position`]=r.position,i[`lighting_uPointLight[${s}].attenuation`]=r.attenuation||[1,0,0]}),i.lighting_uPointLightCount=e.length,t.forEach((r,s)=>{i[`lighting_uDirectionalLight[${s}].color`]=VO(r),i[`lighting_uDirectionalLight[${s}].direction`]=r.direction}),i.lighting_uDirectionalLightCount=t.length,i}({ambientLight:e,pointLights:t,directionalLights:i}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in n){const e={pointLights:[],directionalLights:[]};for(const t of n.lights||[])switch(t.type){case"ambient":e.ambientLight=t;break;case"directional":e.directionalLights.push(t);break;case"point":e.pointLights.push(t)}return qz({lightSources:e})}return{}},defines:{MAX_LIGHTS:3}},Zhe={};const efe={name:"phong-lighting",dependencies:[jO],fs:"\nuniform float lighting_uAmbient;\nuniform float lighting_uDiffuse;\nuniform float lighting_uShininess;\nuniform vec3  lighting_uSpecularColor;\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {\n    vec3 halfway_direction = normalize(light_direction + view_direction);\n    float lambertian = dot(light_direction, normal_worldspace);\n    float specular = 0.0;\n    if (lambertian > 0.0) {\n      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);\n      specular = pow(specular_angle, lighting_uShininess);\n    }\n    lambertian = max(lambertian, 0.0);\n    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;\n}\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = surfaceColor;\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n\nvec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = vec3(0, 0, 0);\n  vec3 surfaceColor = vec3(0, 0, 0);\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n",defines:{LIGHTING_FRAGMENT:1},getUniforms:function(n=Zhe){if(!("material"in n))return{};const{material:e}=n;return e?function(n){const{ambient:e=.35,diffuse:t=.6,shininess:i=32,specularColor:r=[30,30,30]}=n;return{lighting_uAmbient:e,lighting_uDiffuse:t,lighting_uShininess:i,lighting_uSpecularColor:r.map(s=>s/255)}}(e):{lighting_uEnabled:!1}}},nfe={pickingSelectedColor:null,pickingHighlightColor:new Uint8Array([0,255,255,255]),pickingActive:!1,pickingAttribute:!1},Xz=dt({inject:{"vs:DECKGL_FILTER_COLOR":"\n  picking_setPickingColor(geometry.pickingColor);\n  // for picking depth values\n  picking_setPickingAttribute(geometry.position.z);\n  ","fs:DECKGL_FILTER_COLOR":{order:99,injection:"\n  // use highlight color if this fragment belongs to the selected object.\n  color = picking_filterHighlightColor(color);\n\n  // use picking color if rendering to picking FBO.\n  color = picking_filterPickingColor(color);\n    "}}},{name:"picking",vs:"uniform bool picking_uActive;\nuniform bool picking_uAttribute;\nuniform vec3 picking_uSelectedColor;\nuniform bool picking_uSelectedColorValid;\n\nout vec4 picking_vRGBcolor_Avalid;\n\nconst float COLOR_SCALE = 1. / 255.;\n\nbool picking_isColorValid(vec3 color) {\n  return dot(color, vec3(1.0)) > 0.001;\n}\n\nbool isVertexPicked(vec3 vertexColor) {\n  return\n    picking_uSelectedColorValid &&\n    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));\n}\n\nvoid picking_setPickingColor(vec3 pickingColor) {\n  if (picking_uActive) {\n    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));\n\n    if (!picking_uAttribute) {\n      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;\n    }\n  } else {\n    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));\n  }\n}\n\nvoid picking_setPickingAttribute(float value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.r = value;\n  }\n}\nvoid picking_setPickingAttribute(vec2 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rg = value;\n  }\n}\nvoid picking_setPickingAttribute(vec3 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rgb = value;\n  }\n}\n",fs:"uniform bool picking_uActive;\nuniform vec3 picking_uSelectedColor;\nuniform vec4 picking_uHighlightColor;\n\nin vec4 picking_vRGBcolor_Avalid;\nvec4 picking_filterHighlightColor(vec4 color) {\n  if (picking_uActive) {\n    return color;\n  }\n  bool selected = bool(picking_vRGBcolor_Avalid.a);\n\n  if (selected) {\n    float highLightAlpha = picking_uHighlightColor.a;\n    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);\n    float highLightRatio = highLightAlpha / blendedAlpha;\n\n    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);\n    return vec4(blendedRGB, blendedAlpha);\n  } else {\n    return color;\n  }\n}\nvec4 picking_filterPickingColor(vec4 color) {\n  if (picking_uActive) {\n    if (picking_vRGBcolor_Avalid.a == 0.0) {\n      discard;\n    }\n    return picking_vRGBcolor_Avalid;\n  }\n  return color;\n}\nvec4 picking_filterColor(vec4 color) {\n  vec4 highightColor = picking_filterHighlightColor(color);\n  return picking_filterPickingColor(highightColor);\n}\n\n",getUniforms:function(n=nfe){const e={};if(void 0!==n.pickingSelectedColor)if(n.pickingSelectedColor){const t=n.pickingSelectedColor.slice(0,3);e.picking_uSelectedColorValid=1,e.picking_uSelectedColor=t}else e.picking_uSelectedColorValid=0;if(n.pickingHighlightColor){const t=Array.from(n.pickingHighlightColor,i=>i/255);Number.isFinite(t[3])||(t[3]=1),e.picking_uHighlightColor=t}return void 0!==n.pickingActive&&(e.picking_uActive=Boolean(n.pickingActive),e.picking_uAttribute=Boolean(n.pickingAttribute)),e}}),Qz={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class BS{static get DRAW_MODE(){return Qz}constructor(e={}){const{id:t=Kc("geometry"),drawMode:i=Qz.TRIANGLES,attributes:r={},indices:s=null,vertexCount:o=null}=e;this.id=t,this.drawMode=0|i,this.attributes={},this.userData={},this._setAttributes(r,s),this.vertexCount=o||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?dt({indices:this.indices},this.attributes):this.attributes}_print(e){return`Geometry ${this.id} attribute ${e}`}_setAttributes(e,t){t&&(this.indices=ArrayBuffer.isView(t)?{value:t,size:1}:t);for(const i in e){let r=e[i];r=ArrayBuffer.isView(r)?{value:r}:r,sn(ArrayBuffer.isView(r.value),`${this._print(i)}: must be typed array or object with value as typed array`),("POSITION"===i||"positions"===i)&&!r.size&&(r.size=3),"indices"===i?(sn(!this.indices),this.indices=r):this.attributes[i]=r}return this.indices&&void 0!==this.indices.isIndexed&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(e,t){if(t)return t.value.length;let i=1/0;for(const r in e){const s=e[r],{value:o,size:a,constant:l}=s;!l&&o&&a>=1&&(i=Math.min(i,o.length/a))}return sn(Number.isFinite(i)),i}}const UO=Math.PI/180,VS=new Float32Array(16),Zz=new Float32Array(12);function Jz(n,e,t){const i=e[0]*UO,r=e[1]*UO,s=e[2]*UO,o=Math.sin(s),a=Math.sin(i),l=Math.sin(r),c=Math.cos(s),u=Math.cos(i),h=Math.cos(r),p=t[0],g=t[1],m=t[2];n[0]=p*h*u,n[1]=p*l*u,n[2]=p*-a,n[3]=g*(-l*c+h*a*o),n[4]=g*(h*c+l*a*o),n[5]=g*u*o,n[6]=m*(l*o+h*a*c),n[7]=m*(-h*o+l*a*c),n[8]=m*u*c}function e4(n){return n[0]=n[0],n[1]=n[1],n[2]=n[2],n[3]=n[4],n[4]=n[5],n[5]=n[6],n[6]=n[8],n[7]=n[9],n[8]=n[10],n[9]=n[12],n[10]=n[13],n[11]=n[14],n.subarray(0,12)}const t4={size:12,accessor:["getOrientation","getScale","getTranslation","getTransformMatrix"],shaderAttributes:{instanceModelMatrix__LOCATION_0:{size:3,elementOffset:0},instanceModelMatrix__LOCATION_1:{size:3,elementOffset:3},instanceModelMatrix__LOCATION_2:{size:3,elementOffset:6},instanceTranslation:{size:3,elementOffset:9}},update(n,{startRow:e,endRow:t}){const{data:i,getOrientation:r,getScale:s,getTranslation:o,getTransformMatrix:a}=this.props,l=Array.isArray(a),c=l&&16===a.length,u=Array.isArray(s),h=Array.isArray(r),p=Array.isArray(o),g=c||!l&&Boolean(a(i[0]));n.constant=g?c:h&&u&&p;const m=n.value;if(n.constant){let w;g?(VS.set(a),w=e4(VS)):(w=Zz,Jz(w,r,s),w.set(o,9)),n.value=new Float32Array(w)}else{let w=e*n.size;const{iterable:x,objectInfo:H}=JV(i,e,t);for(const I of x){let oe;H.index++,g?(VS.set(c?a:a(I,H)),oe=e4(VS)):(oe=Zz,Jz(oe,h?r:r(I,H),u?s:s(I,H)),oe.set(p?o:o(I,H),9)),m[w++]=oe[0],m[w++]=oe[1],m[w++]=oe[2],m[w++]=oe[3],m[w++]=oe[4],m[w++]=oe[5],m[w++]=oe[6],m[w++]=oe[7],m[w++]=oe[8],m[w++]=oe[9],m[w++]=oe[10],m[w++]=oe[11]}}}};function n4(n,e){return e===Pi.CARTESIAN||e===Pi.METER_OFFSETS||e===Pi.DEFAULT&&!n.isGeospatial}function i4(n,e){(n.COLOR_0||n.colors)&&e||(n.colors={constant:!0,value:new Float32Array([1,1,1])}),Bi.assert(n.positions||n.POSITION,'no "postions" or "POSITION" attribute in mesh')}function ofe(n,e){if(n.attributes)return i4(n.attributes,e),n instanceof BS?n:new BS(n);if(n.positions||n.POSITION)return i4(n,e),new BS({attributes:n});throw Error("Invalid mesh")}const afe={mesh:{value:null,type:"object",async:!0},texture:{type:"image",value:null,async:!0},sizeScale:{type:"number",value:1,min:0},_useMeshColors:{type:"boolean",value:!1},_instanced:!0,wireframe:!1,material:!0,getPosition:{type:"accessor",value:n=>n.position},getColor:{type:"accessor",value:[0,0,0,255]},getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]}};let lfe=(()=>{class n extends yO{getShaders(){const t=!yi(this.context.gl),i={};return XD(this.context.gl,"GLSL_DERIVATIVES")&&(i.DERIVATIVES_AVAILABLE=1),super.getShaders({vs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-vs\nuniform float sizeScale;\nuniform bool composeModelMatrix;\nin vec3 positions;\nin vec3 normals;\nin vec3 colors;\nin vec2 texCoords;\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin mat3 instanceModelMatrix;\nin vec3 instanceTranslation;\nout vec2 vTexCoord;\nout vec3 cameraPosition;\nout vec3 normals_commonspace;\nout vec4 position_commonspace;\nout vec4 vColor;\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = texCoords;\n  geometry.pickingColor = instancePickingColors;\n\n  vTexCoord = texCoords;\n  cameraPosition = project_uCameraPosition;\n  normals_commonspace = project_normal(instanceModelMatrix * normals);\n  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);\n  geometry.normal = normals_commonspace;\n\n  vec3 pos = (instanceModelMatrix * positions) * sizeScale + instanceTranslation;\n\n  if (composeModelMatrix) {\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), position_commonspace);\n  }\n  else {\n    pos = project_size(pos);\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, position_commonspace);\n  }\n\n  geometry.position = position_commonspace;\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-fs\n\nprecision highp float;\n\nuniform bool hasTexture;\nuniform sampler2D sampler;\nuniform bool flatShading;\nuniform float opacity;\n\nin vec2 vTexCoord;\nin vec3 cameraPosition;\nin vec3 normals_commonspace;\nin vec4 position_commonspace;\nin vec4 vColor;\n\nout vec4 fragColor;\n\nvoid main(void) {\n  geometry.uv = vTexCoord;\n\n  vec3 normal;\n  if (flatShading) {\n#ifdef DERIVATIVES_AVAILABLE\n    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));\n#else\n    normal = vec3(0.0, 0.0, 1.0);\n#endif\n  } else {\n    normal = normals_commonspace;\n  }\n\n  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;\n  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);\n  fragColor = vec4(lightColor, color.a * opacity);\n\n  DECKGL_FILTER_COLOR(fragColor, geometry);\n}\n",modules:[$z,efe,Xz],transpileToGLSL100:t,defines:i})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{transition:!0,type:5130,fp64:this.use64bitPositions(),size:3,accessor:"getPosition"},instanceColors:{type:5121,transition:!0,size:this.props.colorFormat.length,normalized:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceModelMatrix:t4}),this.setState({emptyTexture:new Pa(this.context.gl,{data:new Uint8Array(4),width:1,height:1})})}updateState({props:t,oldProps:i,changeFlags:r}){if(super.updateState({props:t,oldProps:i,changeFlags:r}),t.mesh!==i.mesh||r.extensionsChanged){var s;if(null===(s=this.state.model)||void 0===s||s.delete(),t.mesh){this.state.model=this.getModel(t.mesh);const o=t.mesh.attributes||t.mesh;this.setState({hasNormals:Boolean(o.NORMAL||o.normals)})}this.getAttributeManager().invalidateAll()}t.texture!==i.texture&&this.setTexture(t.texture),this.state.model&&this.state.model.setDrawMode(this.props.wireframe?3:4)}finalizeState(){super.finalizeState(),this.state.emptyTexture.delete()}draw({uniforms:t}){if(!this.state.model)return;const{viewport:i}=this.context,{sizeScale:r,coordinateSystem:s,_instanced:o}=this.props;this.state.model.setUniforms(t).setUniforms({sizeScale:r,composeModelMatrix:!o||n4(i,s),flatShading:!this.state.hasNormals}).draw()}getModel(t){const i=new uS(this.context.gl,Hn(dt({},this.getShaders()),{id:this.props.id,geometry:ofe(t,this.props._useMeshColors),isInstanced:!0})),{texture:r}=this.props,{emptyTexture:s}=this.state;return i.setUniforms({sampler:r||s,hasTexture:Boolean(r)}),i}setTexture(t){const{emptyTexture:i,model:r}=this.state;null==r||r.setUniforms({sampler:t||i,hasTexture:Boolean(t)})}}return n.layerName="SimpleMeshLayer",n.defaultProps=afe,n})();const r4={name:"pbr",vs:"uniform mat4 u_MVPMatrix;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_NormalMatrix;\n\nvarying vec3 pbr_vPosition;\nvarying vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n# ifdef HAS_TANGENTS\nvarying mat3 pbr_vTBN;\n# else\nvarying vec3 pbr_vNormal;\n# endif\n#endif\n\nvoid pbr_setPositionNormalTangentUV(vec4 position, vec4 normal, vec4 tangent, vec2 uv)\n{\n  vec4 pos = u_ModelMatrix * position;\n  pbr_vPosition = vec3(pos.xyz) / pos.w;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\n  vec3 normalW = normalize(vec3(u_NormalMatrix * vec4(normal.xyz, 0.0)));\n  vec3 tangentW = normalize(vec3(u_ModelMatrix * vec4(tangent.xyz, 0.0)));\n  vec3 bitangentW = cross(normalW, tangentW) * tangent.w;\n  pbr_vTBN = mat3(tangentW, bitangentW, normalW);\n#else\n  pbr_vNormal = normalize(vec3(u_ModelMatrix * vec4(normal.xyz, 0.0)));\n#endif\n#endif\n\n#ifdef HAS_UV\n  pbr_vUV = uv;\n#else\n  pbr_vUV = vec2(0.,0.);\n#endif\n}\n",fs:"#if defined(USE_TEX_LOD) && !defined(FEATURE_GLSL_TEXTURE_LOD)\n# error PBR fragment shader: Texture LOD is not available\n#endif\n\n#if !defined(HAS_TANGENTS) && !defined(FEATURE_GLSL_DERIVATIVES)\n# error PBR fragment shader: Derivatives are not available\n#endif\n\n\n#if (__VERSION__ < 300)\n  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL1COND; INCR)\n#else\n  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL2COND; INCR)\n#endif\n\nprecision highp float;\n\nuniform bool pbr_uUnlit;\n\n#ifdef USE_IBL\nuniform samplerCube u_DiffuseEnvSampler;\nuniform samplerCube u_SpecularEnvSampler;\nuniform sampler2D u_brdfLUT;\nuniform vec2 u_ScaleIBLAmbient;\n#endif\n\n#ifdef HAS_BASECOLORMAP\nuniform sampler2D u_BaseColorSampler;\n#endif\n#ifdef HAS_NORMALMAP\nuniform sampler2D u_NormalSampler;\nuniform float u_NormalScale;\n#endif\n#ifdef HAS_EMISSIVEMAP\nuniform sampler2D u_EmissiveSampler;\nuniform vec3 u_EmissiveFactor;\n#endif\n#ifdef HAS_METALROUGHNESSMAP\nuniform sampler2D u_MetallicRoughnessSampler;\n#endif\n#ifdef HAS_OCCLUSIONMAP\nuniform sampler2D u_OcclusionSampler;\nuniform float u_OcclusionStrength;\n#endif\n\n#ifdef ALPHA_CUTOFF\nuniform float u_AlphaCutoff;\n#endif\n\nuniform vec2 u_MetallicRoughnessValues;\nuniform vec4 u_BaseColorFactor;\n\nuniform vec3 u_Camera;\n#ifdef PBR_DEBUG\nuniform vec4 u_ScaleDiffBaseMR;\nuniform vec4 u_ScaleFGDSpec;\n#endif\n\nvarying vec3 pbr_vPosition;\n\nvarying vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\nvarying mat3 pbr_vTBN;\n#else\nvarying vec3 pbr_vNormal;\n#endif\n#endif\n\n\nstruct PBRInfo\n{\n  float NdotL;\n  float NdotV;\n  float NdotH;\n  float LdotH;\n  float VdotH;\n  float perceptualRoughness;\n  float metalness;\n  vec3 reflectance0;\n  vec3 reflectance90;\n  float alphaRoughness;\n  vec3 diffuseColor;\n  vec3 specularColor;\n  vec3 n;\n  vec3 v;\n};\n\nconst float M_PI = 3.141592653589793;\nconst float c_MinRoughness = 0.04;\n\nvec4 SRGBtoLINEAR(vec4 srgbIn)\n{\n#ifdef MANUAL_SRGB\n#ifdef SRGB_FAST_APPROXIMATION\n  vec3 linOut = pow(srgbIn.xyz,vec3(2.2));\n#else\n  vec3 bLess = step(vec3(0.04045),srgbIn.xyz);\n  vec3 linOut = mix( srgbIn.xyz/vec3(12.92), pow((srgbIn.xyz+vec3(0.055))/vec3(1.055),vec3(2.4)), bLess );\n#endif\n  return vec4(linOut,srgbIn.w);;\n#else\n  return srgbIn;\n#endif\n}\n\nvec3 getNormal()\n{\n#ifndef HAS_TANGENTS\n  vec3 pos_dx = dFdx(pbr_vPosition);\n  vec3 pos_dy = dFdy(pbr_vPosition);\n  vec3 tex_dx = dFdx(vec3(pbr_vUV, 0.0));\n  vec3 tex_dy = dFdy(vec3(pbr_vUV, 0.0));\n  vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);\n\n#ifdef HAS_NORMALS\n  vec3 ng = normalize(pbr_vNormal);\n#else\n  vec3 ng = cross(pos_dx, pos_dy);\n#endif\n\n  t = normalize(t - ng * dot(ng, t));\n  vec3 b = normalize(cross(ng, t));\n  mat3 tbn = mat3(t, b, ng);\n#else\n  mat3 tbn = pbr_vTBN;\n#endif\n\n#ifdef HAS_NORMALMAP\n  vec3 n = texture2D(u_NormalSampler, pbr_vUV).rgb;\n  n = normalize(tbn * ((2.0 * n - 1.0) * vec3(u_NormalScale, u_NormalScale, 1.0)));\n#else\n  vec3 n = normalize(tbn[2].xyz);\n#endif\n\n  return n;\n}\n\n\n#ifdef USE_IBL\nvec3 getIBLContribution(PBRInfo pbrInputs, vec3 n, vec3 reflection)\n{\n  float mipCount = 9.0;\n  float lod = (pbrInputs.perceptualRoughness * mipCount);\n  vec3 brdf = SRGBtoLINEAR(texture2D(u_brdfLUT,\n    vec2(pbrInputs.NdotV, 1.0 - pbrInputs.perceptualRoughness))).rgb;\n  vec3 diffuseLight = SRGBtoLINEAR(textureCube(u_DiffuseEnvSampler, n)).rgb;\n\n#ifdef USE_TEX_LOD\n  vec3 specularLight = SRGBtoLINEAR(textureCubeLod(u_SpecularEnvSampler, reflection, lod)).rgb;\n#else\n  vec3 specularLight = SRGBtoLINEAR(textureCube(u_SpecularEnvSampler, reflection)).rgb;\n#endif\n\n  vec3 diffuse = diffuseLight * pbrInputs.diffuseColor;\n  vec3 specular = specularLight * (pbrInputs.specularColor * brdf.x + brdf.y);\n  diffuse *= u_ScaleIBLAmbient.x;\n  specular *= u_ScaleIBLAmbient.y;\n\n  return diffuse + specular;\n}\n#endif\n\n\nvec3 diffuse(PBRInfo pbrInputs)\n{\n  return pbrInputs.diffuseColor / M_PI;\n}\n\nvec3 specularReflection(PBRInfo pbrInputs)\n{\n  return pbrInputs.reflectance0 +\n    (pbrInputs.reflectance90 - pbrInputs.reflectance0) *\n    pow(clamp(1.0 - pbrInputs.VdotH, 0.0, 1.0), 5.0);\n}\n\n\n\nfloat geometricOcclusion(PBRInfo pbrInputs)\n{\n  float NdotL = pbrInputs.NdotL;\n  float NdotV = pbrInputs.NdotV;\n  float r = pbrInputs.alphaRoughness;\n\n  float attenuationL = 2.0 * NdotL / (NdotL + sqrt(r * r + (1.0 - r * r) * (NdotL * NdotL)));\n  float attenuationV = 2.0 * NdotV / (NdotV + sqrt(r * r + (1.0 - r * r) * (NdotV * NdotV)));\n  return attenuationL * attenuationV;\n}\n\n\n\n\n\nfloat microfacetDistribution(PBRInfo pbrInputs)\n{\n  float roughnessSq = pbrInputs.alphaRoughness * pbrInputs.alphaRoughness;\n  float f = (pbrInputs.NdotH * roughnessSq - pbrInputs.NdotH) * pbrInputs.NdotH + 1.0;\n  return roughnessSq / (M_PI * f * f);\n}\n\nvoid PBRInfo_setAmbientLight(inout PBRInfo pbrInputs) {\n  pbrInputs.NdotL = 1.0;\n  pbrInputs.NdotH = 0.0;\n  pbrInputs.LdotH = 0.0;\n  pbrInputs.VdotH = 1.0;\n}\n\nvoid PBRInfo_setDirectionalLight(inout PBRInfo pbrInputs, vec3 lightDirection) {\n  vec3 n = pbrInputs.n;\n  vec3 v = pbrInputs.v;\n  vec3 l = normalize(lightDirection);\n  vec3 h = normalize(l+v);\n\n  pbrInputs.NdotL = clamp(dot(n, l), 0.001, 1.0);\n  pbrInputs.NdotH = clamp(dot(n, h), 0.0, 1.0);\n  pbrInputs.LdotH = clamp(dot(l, h), 0.0, 1.0);\n  pbrInputs.VdotH = clamp(dot(v, h), 0.0, 1.0);\n}\n\nvoid PBRInfo_setPointLight(inout PBRInfo pbrInputs, PointLight pointLight) {\n  vec3 light_direction = normalize(pointLight.position - pbr_vPosition);\n  PBRInfo_setDirectionalLight(pbrInputs, light_direction);\n}\n\nvec3 calculateFinalColor(PBRInfo pbrInputs, vec3 lightColor) {\n  vec3 F = specularReflection(pbrInputs);\n  float G = geometricOcclusion(pbrInputs);\n  float D = microfacetDistribution(pbrInputs);\n  vec3 diffuseContrib = (1.0 - F) * diffuse(pbrInputs);\n  vec3 specContrib = F * G * D / (4.0 * pbrInputs.NdotL * pbrInputs.NdotV);\n  return pbrInputs.NdotL * lightColor * (diffuseContrib + specContrib);\n}\n\nvec4 pbr_filterColor(vec4 colorUnused)\n{\n#ifdef HAS_BASECOLORMAP\n  vec4 baseColor = SRGBtoLINEAR(texture2D(u_BaseColorSampler, pbr_vUV)) * u_BaseColorFactor;\n#else\n  vec4 baseColor = u_BaseColorFactor;\n#endif\n\n#ifdef ALPHA_CUTOFF\n  if (baseColor.a < u_AlphaCutoff) {\n    discard;\n  }\n#endif\n\n  vec3 color = vec3(0, 0, 0);\n\n  if(pbr_uUnlit){\n    color.rgb = baseColor.rgb;\n  }\n  else{\n\n\n    float perceptualRoughness = u_MetallicRoughnessValues.y;\n    float metallic = u_MetallicRoughnessValues.x;\n#ifdef HAS_METALROUGHNESSMAP\n\n    vec4 mrSample = texture2D(u_MetallicRoughnessSampler, pbr_vUV);\n    perceptualRoughness = mrSample.g * perceptualRoughness;\n    metallic = mrSample.b * metallic;\n#endif\n    perceptualRoughness = clamp(perceptualRoughness, c_MinRoughness, 1.0);\n    metallic = clamp(metallic, 0.0, 1.0);\n\n    float alphaRoughness = perceptualRoughness * perceptualRoughness;\n\n    vec3 f0 = vec3(0.04);\n    vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);\n    diffuseColor *= 1.0 - metallic;\n    vec3 specularColor = mix(f0, baseColor.rgb, metallic);\n    float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);\n\n\n\n    float reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);\n    vec3 specularEnvironmentR0 = specularColor.rgb;\n    vec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;\n\n    vec3 n = getNormal();\n    vec3 v = normalize(u_Camera - pbr_vPosition);\n\n    float NdotV = clamp(abs(dot(n, v)), 0.001, 1.0);\n    vec3 reflection = -normalize(reflect(v, n));\n\n    PBRInfo pbrInputs = PBRInfo(\n      0.0,\n      NdotV,\n      0.0,\n      0.0,\n      0.0,\n      perceptualRoughness,\n      metallic,\n      specularEnvironmentR0,\n      specularEnvironmentR90,\n      alphaRoughness,\n      diffuseColor,\n      specularColor,\n      n,\n      v\n    );\n\n#ifdef USE_LIGHTS\n    PBRInfo_setAmbientLight(pbrInputs);\n    color += calculateFinalColor(pbrInputs, lighting_uAmbientLight.color);\n    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uDirectionalLightCount, i++) {\n      if (i < lighting_uDirectionalLightCount) {\n        PBRInfo_setDirectionalLight(pbrInputs, lighting_uDirectionalLight[i].direction);\n        color += calculateFinalColor(pbrInputs, lighting_uDirectionalLight[i].color);\n      }\n    }\n    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uPointLightCount, i++) {\n      if (i < lighting_uPointLightCount) {\n        PBRInfo_setPointLight(pbrInputs, lighting_uPointLight[i]);\n        float attenuation = getPointLightAttenuation(lighting_uPointLight[i], distance(lighting_uPointLight[i].position, pbr_vPosition));\n        color += calculateFinalColor(pbrInputs, lighting_uPointLight[i].color / attenuation);\n      }\n    }\n#endif\n#ifdef USE_IBL\n    color += getIBLContribution(pbrInputs, n, reflection);\n#endif\n#ifdef HAS_OCCLUSIONMAP\n    float ao = texture2D(u_OcclusionSampler, pbr_vUV).r;\n    color = mix(color, color * ao, u_OcclusionStrength);\n#endif\n\n#ifdef HAS_EMISSIVEMAP\n    vec3 emissive = SRGBtoLINEAR(texture2D(u_EmissiveSampler, pbr_vUV)).rgb * u_EmissiveFactor;\n    color += emissive;\n#endif\n\n#ifdef PBR_DEBUG\n\n\n\n\n\n    color = mix(color, baseColor.rgb, u_ScaleDiffBaseMR.y);\n    color = mix(color, vec3(metallic), u_ScaleDiffBaseMR.z);\n    color = mix(color, vec3(perceptualRoughness), u_ScaleDiffBaseMR.w);\n#endif\n\n  }\n\n  return vec4(pow(color,vec3(1.0/2.2)), baseColor.a);\n}\n",defines:{LIGHTING_FRAGMENT:1},dependencies:[jO]};class Zg{constructor(e={}){const{id:t}=e;this.id=t||Kc(this.constructor.name),this.display=!0,this.position=new xo,this.rotation=new xo,this.scale=new xo(1,1,1),this.matrix=new Wn,this.userData={},this.props={},this._setScenegraphNodeProps(e)}delete(){}setProps(e){return this._setScenegraphNodeProps(e),this}toString(){return`{type: ScenegraphNode, id: ${this.id})}`}setPosition(e){return sn(3===e.length,"setPosition requires vector argument"),this.position=e,this}setRotation(e){return sn(3===e.length,"setRotation requires vector argument"),this.rotation=e,this}setScale(e){return sn(3===e.length,"setScale requires vector argument"),this.scale=e,this}setMatrix(e,t=!0){t?this.matrix.copy(e):this.matrix=e}setMatrixComponents({position:e,rotation:t,scale:i,update:r=!0}){return e&&this.setPosition(e),t&&this.setRotation(t),i&&this.setScale(i),r&&this.updateMatrix(),this}updateMatrix(){const e=this.position,t=this.rotation,i=this.scale;return this.matrix.identity(),this.matrix.translate(e),this.matrix.rotateXYZ(t),this.matrix.scale(i),this}update(e={}){const{position:t,rotation:i,scale:r}=e;return t&&this.setPosition(t),i&&this.setRotation(i),r&&this.setScale(r),this.updateMatrix(),this}getCoordinateUniforms(e,t){sn(e),t=t||this.matrix;const i=new Wn(e).multiplyRight(t),r=i.invert(),s=r.transpose();return{viewMatrix:e,modelMatrix:t,objectMatrix:t,worldMatrix:i,worldInverseMatrix:r,worldInverseTransposeMatrix:s}}_setScenegraphNodeProps(e){"display"in e&&(this.display=e.display),"position"in e&&this.setPosition(e.position),"rotation"in e&&this.setRotation(e.rotation),"scale"in e&&this.setScale(e.scale),"matrix"in e&&this.setMatrix(e.matrix),Object.assign(this.props,e)}}class j0 extends Zg{constructor(e={}){e=Array.isArray(e)?{children:e}:e;const{children:t=[]}=e;fn.assert(t.every(i=>i instanceof Zg),"every child must an instance of ScenegraphNode"),super(e),this.children=t}add(...e){for(const t of e)Array.isArray(t)?this.add(...t):this.children.push(t);return this}remove(e){const t=this.children,i=t.indexOf(e);return i>-1&&t.splice(i,1),this}removeAll(){return this.children=[],this}delete(){this.children.forEach(e=>e.delete()),this.removeAll(),super.delete()}traverse(e,{worldMatrix:t=new Wn}={}){const i=new Wn(t).multiplyRight(this.matrix);for(const r of this.children)r instanceof j0?r.traverse(e,{worldMatrix:i}):e(r,{worldMatrix:i})}}function s4(n,e){if(n===e){var t=e[1],i=e[2],r=e[5];n[1]=e[3],n[2]=e[6],n[3]=t,n[5]=e[7],n[6]=i,n[7]=r}else n[0]=e[0],n[1]=e[3],n[2]=e[6],n[3]=e[1],n[4]=e[4],n[5]=e[7],n[6]=e[2],n[7]=e[5],n[8]=e[8];return n}function o4(n,e){var t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=u*o-a*c,p=-u*s+a*l,g=c*s-o*l,m=t*h+i*p+r*g;return m?(n[0]=h*(m=1/m),n[1]=(-u*i+r*c)*m,n[2]=(a*i-r*o)*m,n[3]=p*m,n[4]=(u*t-r*l)*m,n[5]=(-a*t+r*s)*m,n[6]=g*m,n[7]=(-c*t+i*l)*m,n[8]=(o*t-i*s)*m,n):null}function a4(n){var r=n[3],s=n[4],o=n[5],a=n[6],l=n[7],c=n[8];return n[0]*(c*s-o*l)+n[1]*(-c*r+o*a)+n[2]*(l*r-s*a)}function jS(n,e,t){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],p=t[0],g=t[1],m=t[2],w=t[3],x=t[4],H=t[5],I=t[6],oe=t[7],Se=t[8];return n[0]=p*i+g*o+m*c,n[1]=p*r+g*a+m*u,n[2]=p*s+g*l+m*h,n[3]=w*i+x*o+H*c,n[4]=w*r+x*a+H*u,n[5]=w*s+x*l+H*h,n[6]=I*i+oe*o+Se*c,n[7]=I*r+oe*a+Se*u,n[8]=I*s+oe*l+Se*h,n}function l4(n,e,t){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],p=t[0],g=t[1];return n[0]=i,n[1]=r,n[2]=s,n[3]=o,n[4]=a,n[5]=l,n[6]=p*i+g*o+c,n[7]=p*r+g*a+u,n[8]=p*s+g*l+h,n}function c4(n,e,t){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],p=Math.sin(t),g=Math.cos(t);return n[0]=g*i+p*o,n[1]=g*r+p*a,n[2]=g*s+p*l,n[3]=g*o-p*i,n[4]=g*a-p*r,n[5]=g*l-p*s,n[6]=c,n[7]=u,n[8]=h,n}function US(n,e,t){var i=t[0],r=t[1];return n[0]=i*e[0],n[1]=i*e[1],n[2]=i*e[2],n[3]=r*e[3],n[4]=r*e[4],n[5]=r*e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n}function u4(n,e){var t=e[0],i=e[1],r=e[2],s=e[3],o=t+t,a=i+i,l=r+r,c=t*o,u=i*o,h=i*a,p=r*o,g=r*a,m=r*l,w=s*o,x=s*a,H=s*l;return n[0]=1-h-m,n[3]=u-H,n[6]=p+x,n[1]=u+H,n[4]=1-c-m,n[7]=g-w,n[2]=p-x,n[5]=g+w,n[8]=1-c-h,n}function d4(){var n=new ha(4);return ha!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n[3]=1,n}function h4(n){return n[0]=0,n[1]=0,n[2]=0,n[3]=1,n}function zO(n,e,t){t*=.5;var i=Math.sin(t);return n[0]=i*e[0],n[1]=i*e[1],n[2]=i*e[2],n[3]=Math.cos(t),n}function zS(n,e,t){var i=e[0],r=e[1],s=e[2],o=e[3],a=t[0],l=t[1],c=t[2],u=t[3];return n[0]=i*u+o*a+r*c-s*l,n[1]=r*u+o*l+s*a-i*c,n[2]=s*u+o*c+i*l-r*a,n[3]=o*u-i*a-r*l-s*c,n}function f4(n,e,t){t*=.5;var i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(t),l=Math.cos(t);return n[0]=i*l+o*a,n[1]=r*l+s*a,n[2]=s*l-r*a,n[3]=o*l-i*a,n}function p4(n,e,t){t*=.5;var i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(t),l=Math.cos(t);return n[0]=i*l-s*a,n[1]=r*l+o*a,n[2]=s*l+i*a,n[3]=o*l-r*a,n}function g4(n,e,t){t*=.5;var i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(t),l=Math.cos(t);return n[0]=i*l+r*a,n[1]=r*l-i*a,n[2]=s*l+o*a,n[3]=o*l-s*a,n}function m4(n,e){var t=e[0],i=e[1],r=e[2];return n[0]=t,n[1]=i,n[2]=r,n[3]=Math.sqrt(Math.abs(1-t*t-i*i-r*r)),n}function U0(n,e,t,i){var p,g,m,w,x,r=e[0],s=e[1],o=e[2],a=e[3],l=t[0],c=t[1],u=t[2],h=t[3];return(g=r*l+s*c+o*u+a*h)<0&&(g=-g,l=-l,c=-c,u=-u,h=-h),1-g>Xc?(p=Math.acos(g),m=Math.sin(p),w=Math.sin((1-i)*p)/m,x=Math.sin(i*p)/m):(w=1-i,x=i),n[0]=w*r+x*l,n[1]=w*s+x*c,n[2]=w*o+x*u,n[3]=w*a+x*h,n}function _4(n,e){var t=e[0],i=e[1],r=e[2],s=e[3],o=t*t+i*i+r*r+s*s,a=o?1/o:0;return n[0]=-t*a,n[1]=-i*a,n[2]=-r*a,n[3]=s*a,n}function y4(n,e){return n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n[3]=e[3],n}function HO(n,e){var i,t=e[0]+e[4]+e[8];if(t>0)i=Math.sqrt(t+1),n[3]=.5*i,n[0]=(e[5]-e[7])*(i=.5/i),n[1]=(e[6]-e[2])*i,n[2]=(e[1]-e[3])*i;else{var r=0;e[4]>e[0]&&(r=1),e[8]>e[3*r+r]&&(r=2);var s=(r+1)%3,o=(r+2)%3;i=Math.sqrt(e[3*r+r]-e[3*s+s]-e[3*o+o]+1),n[r]=.5*i,n[3]=(e[3*s+o]-e[3*o+s])*(i=.5/i),n[s]=(e[3*s+r]+e[3*r+s])*i,n[o]=(e[3*o+r]+e[3*r+o])*i}return n}var v4=function(n,e,t){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3],n},GO=Qj,$O=function(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]+n[3]*e[3]},b4=function(n,e,t,i){var r=e[0],s=e[1],o=e[2],a=e[3];return n[0]=r+i*(t[0]-r),n[1]=s+i*(t[1]-s),n[2]=o+i*(t[2]-o),n[3]=a+i*(t[3]-a),n},w4=function(n){return Math.hypot(n[0],n[1],n[2],n[3])},E4=function(n){var e=n[0],t=n[1],i=n[2],r=n[3];return e*e+t*t+i*i+r*r},x4=function(){var n=VV(),e=jV(1,0,0),t=jV(0,1,0);return function(i,r,s){var o=UV(r,s);return o<-.999999?(_0(n,e,r),function(n){return Math.hypot(n[0],n[1],n[2])}(n)<1e-6&&_0(n,t,r),function(n,e){var t=e[0],i=e[1],r=e[2],s=t*t+i*i+r*r;s>0&&(s=1/Math.sqrt(s)),n[0]=e[0]*s,n[1]=e[1]*s,n[2]=e[2]*s}(n,n),zO(i,n,Math.PI),i):o>.999999?(i[0]=0,i[1]=0,i[2]=0,i[3]=1,i):(_0(n,r,s),i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=1+o,function(n,e){var t=e[0],i=e[1],r=e[2],s=e[3],o=t*t+i*i+r*r+s*s;return o>0&&(o=1/Math.sqrt(o)),n[0]=t*o,n[1]=i*o,n[2]=r*o,n[3]=s*o,n}(i,i))}}();d4(),d4(),function(){var n=new ha(9);ha!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[5]=0,n[6]=0,n[7]=0),n[0]=1,n[4]=1,n[8]=1}();const hfe=[0,0,0,1];class WO extends ZE{constructor(e=0,t=0,i=0,r=1){super(-0,-0,-0,-0),Array.isArray(e)&&1===arguments.length?this.copy(e):this.set(e,t,i,r)}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}set(e,t,i,r){return this[0]=e,this[1]=t,this[2]=i,this[3]=r,this.check()}fromMatrix3(e){return HO(this,e),this.check()}identity(){return h4(this),this.check()}fromAxisRotation(e,t){return zO(this,e,t),this.check()}setAxisAngle(e,t){return this.fromAxisRotation(e,t)}get ELEMENTS(){return 4}get x(){return this[0]}set x(e){this[0]=tr(e)}get y(){return this[1]}set y(e){this[1]=tr(e)}get z(){return this[2]}set z(e){this[2]=tr(e)}get w(){return this[3]}set w(e){this[3]=tr(e)}len(){return w4(this)}lengthSquared(){return E4(this)}dot(e,t){if(void 0!==t)throw new Error("Quaternion.dot only takes one argument");return $O(this,e)}rotationTo(e,t){return x4(this,e,t),this.check()}add(e,t){if(void 0!==t)throw new Error("Quaternion.add only takes one argument");return v4(this,this,e),this.check()}calculateW(){return m4(this,this),this.check()}conjugate(){return y4(this,this),this.check()}invert(){return _4(this,this),this.check()}lerp(e,t,i){return b4(this,e,t,i),this.check()}multiplyRight(e,t){return qu(!t),zS(this,this,e),this.check()}multiplyLeft(e,t){return qu(!t),zS(this,e,this),this.check()}normalize(){const e=this.len(),t=e>0?1/e:0;return this[0]=this[0]*t,this[1]=this[1]*t,this[2]=this[2]*t,this[3]=this[3]*t,0===e&&(this[3]=1),this.check()}rotateX(e){return f4(this,this,e),this.check()}rotateY(e){return p4(this,this,e),this.check()}rotateZ(e){return g4(this,this,e),this.check()}scale(e){return GO(this,this,e),this.check()}slerp(e,t,i){switch(arguments.length){case 1:({start:e=hfe,target:t,ratio:i}=arguments[0]);break;case 2:[t,i]=arguments,e=this}return U0(this,e,t,i),this.check()}transformVector4(e,t=e){return Zj(t,e,this),m0(t,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(e,t){return this.setAxisAngle(e,t)}premultiply(e,t){return this.multiplyLeft(e,t)}multiply(e,t){return this.multiplyRight(e,t)}}const ffe={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},pfe={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function C4(n){if(!n._animation){const e=pfe[n.componentType],t=ffe[n.type],i=t*n.count,{buffer:r,byteOffset:s}=n.bufferView.data,o=new e(r,s+(n.byteOffset||0),i);if(1===t)n._animation=Array.from(o);else{const a=[];for(let l=0;l<o.length;l+=t)a.push(Array.from(o.slice(l,l+t)));n._animation=a}}return n._animation}const gfe=new Wn,qO=new WO;class wfe{constructor(e){this.startTime=0,this.playing=!0,this.speed=1,this.channels=[],Object.assign(this,e)}animate(e){if(!this.playing)return;const i=(e/1e3-this.startTime)*this.speed;this.channels.forEach(({sampler:r,target:s,path:o})=>{(function(n,{input:e,interpolation:t,output:i},r,s){const a=n%e[e.length-1],l=e.findIndex(p=>p>=a),c=Math.max(0,l-1);if(!Array.isArray(r[s]))switch(s){case"translation":r[s]=[0,0,0];break;case"rotation":r[s]=[0,0,0,1];break;case"scale":r[s]=[1,1,1];break;default:fn.warn(`Bad animation path ${s}`)()}sn(r[s].length===i[c].length);const u=e[c],h=e[l];switch(t){case"STEP":!function(n,e,t){for(let i=0;i<t.length;i++)n[e][i]=t[i]}(r,s,i[c]);break;case"LINEAR":h>u&&function(n,e,t,i,r){if("rotation"===e){qO.slerp({start:t,target:i,ratio:r});for(let s=0;s<qO.length;s++)n[e][s]=qO[s]}else for(let s=0;s<t.length;s++)n[e][s]=r*i[s]+(1-r)*t[s]}(r,s,i[c],i[l],(a-u)/(h-u));break;case"CUBICSPLINE":h>u&&function(n,e,{p0:t,outTangent0:i,inTangent1:r,p1:s,tDiff:o,ratio:a}){for(let l=0;l<n[e].length;l++){const c=i[l]*o,u=r[l]*o;n[e][l]=(2*Math.pow(a,3)-3*Math.pow(a,2)+1)*t[l]+(Math.pow(a,3)-2*Math.pow(a,2)+a)*c+(-2*Math.pow(a,3)+3*Math.pow(a,2))*s[l]+(Math.pow(a,3)-Math.pow(a,2))*u}}(r,s,{p0:i[3*c+1],outTangent0:i[3*c+2],inTangent1:i[3*l+0],p1:i[3*l+1],tDiff:h-u,ratio:(a-u)/(h-u)});break;default:fn.warn(`Interpolation ${t} not supported`)()}})(i,r,s,o),function(n,e){if(e.matrix.identity(),n.translation&&e.matrix.translate(n.translation),n.rotation){const t=gfe.fromQuaternion(n.rotation);e.matrix.multiplyRight(t)}n.scale&&e.matrix.scale(n.scale)}(s,s._node)})}}class Efe{constructor(e){this.animations=e.animations.map((t,i)=>{const r=t.name||`Animation-${i}`,s=t.samplers.map(({input:a,interpolation:l="LINEAR",output:c})=>({input:C4(e.accessors[a]),interpolation:l,output:C4(e.accessors[c])})),o=t.channels.map(({sampler:a,target:l})=>({sampler:s[a],target:e.nodes[l.node],path:l.path}));return new wfe({name:r,channels:o})})}animate(e){this.setTime(e)}setTime(e){this.animations.forEach(t=>t.animate(e))}getAnimations(){return this.animations}}class Sfe extends Zg{constructor(e,t={}){super(t),this.onBeforeRender=null,this.AfterRender=null,e instanceof uS?(this.model=e,this._setModelNodeProps(t)):this.model=new uS(e,t),this.managedResources=t.managedResources||[]}setProps(e){return super.setProps(e),this._setModelNodeProps(e),this}delete(){this.model&&(this.model.delete(),this.model=null),this.managedResources.forEach(e=>e.delete()),this.managedResources=[]}draw(...e){return this.model.draw(...e)}setUniforms(...e){return this.model.setUniforms(...e),this}setAttributes(...e){return this.model.setAttributes(...e),this}updateModuleSettings(...e){return this.model.updateModuleSettings(...e),this}_setModelNodeProps(e){this.model.setProps(e)}}class xfe{constructor(e,{attributes:t,material:i,pbrDebug:r,imageBasedLightingEnvironment:s,lights:o,useTangents:a}){this.gl=e,this.defines={MANUAL_SRGB:1,SRGB_FAST_APPROXIMATION:1},XD(e,"GLSL_TEXTURE_LOD")&&(this.defines.USE_TEX_LOD=1),this.uniforms={u_Camera:[0,0,0],u_MetallicRoughnessValues:[1,1]},this.parameters={},this.generatedTextures=[],s&&(this.uniforms.u_DiffuseEnvSampler=s.getDiffuseEnvSampler(),this.uniforms.u_SpecularEnvSampler=s.getSpecularEnvSampler(),this.uniforms.u_brdfLUT=s.getBrdfTexture(),this.uniforms.u_ScaleIBLAmbient=[1,1]),r&&(this.uniforms.u_ScaleDiffBaseMR=[0,0,0,0],this.uniforms.u_ScaleFGDSpec=[0,0,0,0]),this.defineIfPresent(t.NORMAL,"HAS_NORMALS"),this.defineIfPresent(t.TANGENT&&a,"HAS_TANGENTS"),this.defineIfPresent(t.TEXCOORD_0,"HAS_UV"),this.defineIfPresent(s,"USE_IBL"),this.defineIfPresent(o,"USE_LIGHTS"),this.defineIfPresent(r,"PBR_DEBUG"),i&&this.parseMaterial(i)}defineIfPresent(e,t){e&&(this.defines[t]=1)}parseTexture(e,t,i=null){const s=e.texture.source.image;let o,a={};s.compressed?(o=s,a={[this.gl.TEXTURE_MIN_FILTER]:s.data.length>1?this.gl.LINEAR_MIPMAP_NEAREST:this.gl.LINEAR}):o={data:s};const l=new Pa(this.gl,dt({id:e.name||e.id,parameters:dt(dt({},e.texture&&e.texture.sampler&&e.texture.sampler.parameters||{}),a),pixelStore:{[this.gl.UNPACK_FLIP_Y_WEBGL]:!1}},o));this.uniforms[t]=l,this.defineIfPresent(i,i),this.generatedTextures.push(l)}parsePbrMetallicRoughness(e){e.baseColorTexture&&this.parseTexture(e.baseColorTexture,"u_BaseColorSampler","HAS_BASECOLORMAP"),this.uniforms.u_BaseColorFactor=e.baseColorFactor||[1,1,1,1],e.metallicRoughnessTexture&&this.parseTexture(e.metallicRoughnessTexture,"u_MetallicRoughnessSampler","HAS_METALROUGHNESSMAP");const{metallicFactor:t=1,roughnessFactor:i=1}=e;this.uniforms.u_MetallicRoughnessValues=[t,i]}parseMaterial(e){if(this.uniforms.pbr_uUnlit=Boolean(e.unlit),e.pbrMetallicRoughness&&this.parsePbrMetallicRoughness(e.pbrMetallicRoughness),e.normalTexture){this.parseTexture(e.normalTexture,"u_NormalSampler","HAS_NORMALMAP");const{scale:t=1}=e.normalTexture;this.uniforms.u_NormalScale=t}if(e.occlusionTexture){this.parseTexture(e.occlusionTexture,"u_OcclusionSampler","HAS_OCCLUSIONMAP");const{strength:t=1}=e.occlusionTexture;this.uniforms.u_OcclusionStrength=t}if(e.emissiveTexture&&(this.parseTexture(e.emissiveTexture,"u_EmissiveSampler","HAS_EMISSIVEMAP"),this.uniforms.u_EmissiveFactor=e.emissiveFactor||[0,0,0]),"MASK"===e.alphaMode){const{alphaCutoff:t=.5}=e;this.defines.ALPHA_CUTOFF=1,this.uniforms.u_AlphaCutoff=t}else"BLEND"===e.alphaMode&&(fn.warn("BLEND alphaMode might not work well because it requires mesh sorting")(),Object.assign(this.parameters,{blend:!0,blendEquation:this.gl.FUNC_ADD,blendFunc:[this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA]}))}}function T4(n,e){return yi(n)?`#version 300 es\n${e}`:e}const Mfe={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Dfe={modelOptions:{},pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0,useTangents:!1};class Ife{constructor(e,t={}){this.gl=e,this.options=Object.assign({},Dfe,t)}instantiate(e){return this.gltf=e,(e.scenes||[]).map(i=>this.createScene(i))}createAnimator(){return Array.isArray(this.gltf.animations)?new Efe(this.gltf):null}createScene(e){const i=(e.nodes||[]).map(s=>this.createNode(s));return new j0({id:e.name||e.id,children:i})}createNode(e){if(!e._node){const i=(e.children||[]).map(s=>this.createNode(s));e.mesh&&i.push(this.createMesh(e.mesh));const r=new j0({id:e.name||e.id,children:i});if(e.matrix)r.setMatrix(e.matrix);else{if(r.matrix.identity(),e.translation&&r.matrix.translate(e.translation),e.rotation){const s=(new Wn).fromQuaternion(e.rotation);r.matrix.multiplyRight(s)}e.scale&&r.matrix.scale(e.scale)}e._node=r}return e._node}createMesh(e){if(!e._mesh){const i=(e.primitives||[]).map((s,o)=>this.createPrimitive(s,o,e)),r=new j0({id:e.name||e.id,children:i});e._mesh=r}return e._mesh}getVertexCount(e){fn.warn("getVertexCount() not found")()}createPrimitive(e,t,i){return function(n,e){const{id:t,drawMode:i,vertexCount:r,attributes:s,modelOptions:o}=e,a=new xfe(n,e);fn.info(4,"createGLTFModel defines: ",a.defines)();const l=[];l.push(...a.generatedTextures),l.push(...Object.values(s).map(u=>u.buffer));const c=new Sfe(n,Object.assign({id:t,drawMode:i,vertexCount:r,modules:[r4],defines:a.defines,parameters:a.parameters,vs:T4(n,"\n#if (__VERSION__ < 300)\n  #define _attr attribute\n#else\n  #define _attr in\n#endif\n\n  _attr vec4 POSITION;\n\n  #ifdef HAS_NORMALS\n    _attr vec4 NORMAL;\n  #endif\n\n  #ifdef HAS_TANGENTS\n    _attr vec4 TANGENT;\n  #endif\n\n  #ifdef HAS_UV\n    _attr vec2 TEXCOORD_0;\n  #endif\n\n  void main(void) {\n    vec4 _NORMAL = vec4(0.);\n    vec4 _TANGENT = vec4(0.);\n    vec2 _TEXCOORD_0 = vec2(0.);\n\n    #ifdef HAS_NORMALS\n      _NORMAL = NORMAL;\n    #endif\n\n    #ifdef HAS_TANGENTS\n      _TANGENT = TANGENT;\n    #endif\n\n    #ifdef HAS_UV\n      _TEXCOORD_0 = TEXCOORD_0;\n    #endif\n\n    pbr_setPositionNormalTangentUV(POSITION, _NORMAL, _TANGENT, _TEXCOORD_0);\n    gl_Position = u_MVPMatrix * POSITION;\n  }\n"),fs:T4(n,"\n#if (__VERSION__ < 300)\n  #define fragmentColor gl_FragColor\n#else\n  out vec4 fragmentColor;\n#endif\n\n  void main(void) {\n    fragmentColor = pbr_filterColor(vec4(0));\n  }\n"),managedResources:l},o));return c.setProps({attributes:s}),c.setUniforms(a.uniforms),c}(this.gl,Object.assign({id:e.name||`${i.name||i.id}-primitive-${t}`,drawMode:e.mode||4,vertexCount:e.indices?e.indices.count:this.getVertexCount(e.attributes),attributes:this.createAttributes(e.attributes,e.indices),material:e.material},this.options))}createAttributes(e,t){const i={};return Object.keys(e).forEach(r=>{i[r]=this.createAccessor(e[r],this.createBuffer(e[r],this.gl.ARRAY_BUFFER))}),t&&(i.indices=this.createAccessor(t,this.createBuffer(t,this.gl.ELEMENT_ARRAY_BUFFER))),fn.info(4,"glTF Attributes",{attributes:e,indices:t,generated:i})(),i}createBuffer(e,t){e.bufferView||(e.bufferView={});const{bufferView:i}=e;return i.lumaBuffers||(i.lumaBuffers={}),i.lumaBuffers[t]||(i.lumaBuffers[t]=new or(this.gl,{id:`from-${i.id}`,data:i.data||e.value,target:t})),i.lumaBuffers[t]}createAccessor(e,t){return new da({buffer:t,offset:e.byteOffset||0,stride:e.bufferView.byteStride||0,type:e.componentType,size:Mfe[e.type]})}createSampler(e){return e}needsPOT(){return!1}}function A4(n,e,t){if(n.byteLength<=e+t)return"";const i=new DataView(n);let r="";for(let s=0;s<t;s++)r+=String.fromCharCode(i.getUint8(e+s));return r}function Va(n,e){if(!n)throw new Error(e||"assert failed: gltf")}function M4(n,e){if(n.startsWith("data:")||n.startsWith("http:")||n.startsWith("https:"))return n;const i=e.baseUri||e.uri;if(!i)throw new Error(`'baseUri' must be provided to resolve relative url ${n}`);return i.substr(0,i.lastIndexOf("/")+1)+n}function D4(n,e,t){const i=n.bufferViews[t];Va(i);const s=e[i.buffer];return Va(s),new Uint8Array(s.arrayBuffer,(i.byteOffset||0)+s.byteOffset,i.byteLength)}const I4={name:"Draco",id:"draco",module:"draco",version:"3.0.12",worker:!0,extensions:["drc"],mimeTypes:["application/octet-stream"],binary:!0,tests:["DRACO"],options:{draco:{decoderType:"object"==typeof WebAssembly?"wasm":"js",libraryPath:"libs/",extraAttributes:{},attributeNameEntry:void 0}}};class Jg{constructor(e,t){qn(this,"fields",void 0),qn(this,"metadata",void 0),function(n,e){if(!n)throw new Error("loader assertion failed.")}(Array.isArray(e)),function(n){const e={};for(const t of n)e[t.name]&&console.warn("Schema: duplicated field name",t.name,t),e[t.name]=!0}(e),this.fields=e,this.metadata=t||new Map}compareTo(e){if(this.metadata!==e.metadata||this.fields.length!==e.fields.length)return!1;for(let t=0;t<this.fields.length;++t)if(!this.fields[t].compareTo(e.fields[t]))return!1;return!0}select(...e){const t=Object.create(null);for(const r of e)t[r]=!0;const i=this.fields.filter(r=>t[r.name]);return new Jg(i,this.metadata)}selectAt(...e){const t=e.map(i=>this.fields[i]).filter(Boolean);return new Jg(t,this.metadata)}assign(e){let t,i=this.metadata;if(e instanceof Jg){const o=e;t=o.fields,i=O4(O4(new Map,this.metadata),o.metadata)}else t=e;const r=Object.create(null);for(const o of this.fields)r[o.name]=o;for(const o of t)r[o.name]=o;const s=Object.values(r);return new Jg(s,i)}}function O4(n,e){return new Map([...n||new Map,...e||new Map])}let Pr,R4,N4,P4,F4,L4,k4,B4;!function(n){n[n.NONE=0]="NONE",n[n.Null=1]="Null",n[n.Int=2]="Int",n[n.Float=3]="Float",n[n.Binary=4]="Binary",n[n.Utf8=5]="Utf8",n[n.Bool=6]="Bool",n[n.Decimal=7]="Decimal",n[n.Date=8]="Date",n[n.Time=9]="Time",n[n.Timestamp=10]="Timestamp",n[n.Interval=11]="Interval",n[n.List=12]="List",n[n.Struct=13]="Struct",n[n.Union=14]="Union",n[n.FixedSizeBinary=15]="FixedSizeBinary",n[n.FixedSizeList=16]="FixedSizeList",n[n.Map=17]="Map",n[n.Dictionary=-1]="Dictionary",n[n.Int8=-2]="Int8",n[n.Int16=-3]="Int16",n[n.Int32=-4]="Int32",n[n.Int64=-5]="Int64",n[n.Uint8=-6]="Uint8",n[n.Uint16=-7]="Uint16",n[n.Uint32=-8]="Uint32",n[n.Uint64=-9]="Uint64",n[n.Float16=-10]="Float16",n[n.Float32=-11]="Float32",n[n.Float64=-12]="Float64",n[n.DateDay=-13]="DateDay",n[n.DateMillisecond=-14]="DateMillisecond",n[n.TimestampSecond=-15]="TimestampSecond",n[n.TimestampMillisecond=-16]="TimestampMillisecond",n[n.TimestampMicrosecond=-17]="TimestampMicrosecond",n[n.TimestampNanosecond=-18]="TimestampNanosecond",n[n.TimeSecond=-19]="TimeSecond",n[n.TimeMillisecond=-20]="TimeMillisecond",n[n.TimeMicrosecond=-21]="TimeMicrosecond",n[n.TimeNanosecond=-22]="TimeNanosecond",n[n.DenseUnion=-23]="DenseUnion",n[n.SparseUnion=-24]="SparseUnion",n[n.IntervalDayTime=-25]="IntervalDayTime",n[n.IntervalYearMonth=-26]="IntervalYearMonth"}(Pr||(Pr={}));class YO{static isNull(e){return e&&e.typeId===Pr.Null}static isInt(e){return e&&e.typeId===Pr.Int}static isFloat(e){return e&&e.typeId===Pr.Float}static isBinary(e){return e&&e.typeId===Pr.Binary}static isUtf8(e){return e&&e.typeId===Pr.Utf8}static isBool(e){return e&&e.typeId===Pr.Bool}static isDecimal(e){return e&&e.typeId===Pr.Decimal}static isDate(e){return e&&e.typeId===Pr.Date}static isTime(e){return e&&e.typeId===Pr.Time}static isTimestamp(e){return e&&e.typeId===Pr.Timestamp}static isInterval(e){return e&&e.typeId===Pr.Interval}static isList(e){return e&&e.typeId===Pr.List}static isStruct(e){return e&&e.typeId===Pr.Struct}static isUnion(e){return e&&e.typeId===Pr.Union}static isFixedSizeBinary(e){return e&&e.typeId===Pr.FixedSizeBinary}static isFixedSizeList(e){return e&&e.typeId===Pr.FixedSizeList}static isMap(e){return e&&e.typeId===Pr.Map}static isDictionary(e){return e&&e.typeId===Pr.Dictionary}get typeId(){return Pr.NONE}compareTo(e){return this===e}}Symbol,Symbol,R4=Symbol.toStringTag;class em extends YO{constructor(e,t){super(),qn(this,"isSigned",void 0),qn(this,"bitWidth",void 0),this.isSigned=e,this.bitWidth=t}get typeId(){return Pr.Int}get[R4](){return"Int"}toString(){return`${this.isSigned?"I":"Ui"}nt${this.bitWidth}`}}class jfe extends em{constructor(){super(!0,8)}}class Ufe extends em{constructor(){super(!0,16)}}class zfe extends em{constructor(){super(!0,32)}}class Hfe extends em{constructor(){super(!1,8)}}class Gfe extends em{constructor(){super(!1,16)}}class $fe extends em{constructor(){super(!1,32)}}N4=Symbol.toStringTag;class V4 extends YO{constructor(e){super(),qn(this,"precision",void 0),this.precision=e}get typeId(){return Pr.Float}get[N4](){return"Float"}toString(){return`Float${this.precision}`}}class Wfe extends V4{constructor(){super(32)}}class qfe extends V4{constructor(){super(64)}}Symbol,Symbol,P4=Symbol.toStringTag,F4=Symbol.toStringTag,L4=Symbol.toStringTag,k4=Symbol.toStringTag,B4=Symbol.toStringTag;class Yfe extends YO{constructor(e,t){super(),qn(this,"listSize",void 0),qn(this,"children",void 0),this.listSize=e,this.children=[t]}get typeId(){return Pr.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get[B4](){return"FixedSizeList"}toString(){return`FixedSizeList[${this.listSize}]<${this.valueType}>`}}class HS{constructor(e,t,i=!1,r=new Map){qn(this,"name",void 0),qn(this,"type",void 0),qn(this,"nullable",void 0),qn(this,"metadata",void 0),this.name=e,this.type=t,this.nullable=i,this.metadata=r}get typeId(){return this.type&&this.type.typeId}clone(){return new HS(this.name,this.type,this.nullable,this.metadata)}compareTo(e){return this.name===e.name&&this.type===e.type&&this.nullable===e.nullable&&this.metadata===e.metadata}toString(){return`${this.type}${this.nullable?", nullable":""}${this.metadata?`, metadata: ${this.metadata}`:""}`}}function j4(n,e,t){const i=t?U4(t.metadata):void 0,r=function(n){switch(n.constructor){case Int8Array:return new jfe;case Uint8Array:return new Hfe;case Int16Array:return new Ufe;case Uint16Array:return new Gfe;case Int32Array:return new zfe;case Uint32Array:return new $fe;case Float32Array:return new Wfe;case Float64Array:return new qfe;default:throw new Error("array type not supported")}}(e.value);return new HS(n,new Yfe(e.size,new HS("value",r)),!1,i)}function U4(n){const e=new Map;for(const t in n)e.set(`${t}.string`,JSON.stringify(n[t]));return e}const z4={POSITION:"POSITION",NORMAL:"NORMAL",COLOR:"COLOR_0",TEX_COORD:"TEXCOORD_0"},Zfe={1:Int8Array,2:Uint8Array,3:Int16Array,4:Uint16Array,5:Int32Array,6:Uint32Array,9:Float32Array};class epe{constructor(e){qn(this,"draco",void 0),qn(this,"decoder",void 0),qn(this,"metadataQuerier",void 0),this.draco=e,this.decoder=new this.draco.Decoder,this.metadataQuerier=new this.draco.MetadataQuerier}destroy(){this.draco.destroy(this.decoder),this.draco.destroy(this.metadataQuerier)}parseSync(e,t={}){const i=new this.draco.DecoderBuffer;i.Init(new Int8Array(e),e.byteLength),this._disableAttributeTransforms(t);const r=this.decoder.GetEncodedGeometryType(i),s=r===this.draco.TRIANGULAR_MESH?new this.draco.Mesh:new this.draco.PointCloud;try{let o;switch(r){case this.draco.TRIANGULAR_MESH:o=this.decoder.DecodeBufferToMesh(i,s);break;case this.draco.POINT_CLOUD:o=this.decoder.DecodeBufferToPointCloud(i,s);break;default:throw new Error("DRACO: Unknown geometry type.")}if(!o.ok()||!s.ptr){const p=`DRACO decompression failed: ${o.error_msg()}`;throw new Error(p)}const a=this._getDracoLoaderData(s,r,t),l=this._getMeshData(s,a,t),c=function(n){let e=1/0,t=1/0,i=1/0,r=-1/0,s=-1/0,o=-1/0;const a=n.POSITION?n.POSITION.value:[],l=a&&a.length;for(let c=0;c<l;c+=3){const u=a[c],h=a[c+1],p=a[c+2];e=u<e?u:e,t=h<t?h:t,i=p<i?p:i,r=u>r?u:r,s=h>s?h:s,o=p>o?p:o}return[[e,t,i],[r,s,o]]}(l.attributes),u=function(n,e,t){const i=U4(e.metadata),r=[],s=function(n){const e={};for(const t in n){const i=n[t];e[i.name||"undefined"]=i}return e}(e.attributes);for(const o in n){const l=j4(o,n[o],s[o]);r.push(l)}if(t){const o=j4("indices",t);r.push(o)}return new Jg(r,i)}(l.attributes,a,l.indices);return Hn(dt({loader:"draco",loaderData:a,header:{vertexCount:s.num_points(),boundingBox:c}},l),{schema:u})}finally{this.draco.destroy(i),s&&this.draco.destroy(s)}}_getDracoLoaderData(e,t,i){const r=this._getTopLevelMetadata(e),s=this._getDracoAttributes(e,i);return{geometry_type:t,num_attributes:e.num_attributes(),num_points:e.num_points(),num_faces:e instanceof this.draco.Mesh?e.num_faces():0,metadata:r,attributes:s}}_getDracoAttributes(e,t){const i={};for(let r=0;r<e.num_attributes();r++){const s=this.decoder.GetAttribute(e,r),o=this._getAttributeMetadata(e,r);i[s.unique_id()]={unique_id:s.unique_id(),attribute_type:s.attribute_type(),data_type:s.data_type(),num_components:s.num_components(),byte_offset:s.byte_offset(),byte_stride:s.byte_stride(),normalized:s.normalized(),attribute_index:r,metadata:o};const a=this._getQuantizationTransform(s,t);a&&(i[s.unique_id()].quantization_transform=a);const l=this._getOctahedronTransform(s,t);l&&(i[s.unique_id()].octahedron_transform=l)}return i}_getMeshData(e,t,i){const r=this._getMeshAttributes(t,e,i);if(!r.POSITION)throw new Error("DRACO: No position attribute found.");if(e instanceof this.draco.Mesh)switch(i.topology){case"triangle-strip":return{topology:"triangle-strip",mode:4,attributes:r,indices:{value:this._getTriangleStripIndices(e),size:1}};case"triangle-list":default:return{topology:"triangle-list",mode:5,attributes:r,indices:{value:this._getTriangleListIndices(e),size:1}}}return{topology:"point-list",mode:0,attributes:r}}_getMeshAttributes(e,t,i){const r={};for(const s of Object.values(e.attributes)){const o=this._deduceAttributeName(s,i);s.name=o;const{value:a,size:l}=this._getAttributeValues(t,s);r[o]={value:a,size:l,byteOffset:s.byte_offset,byteStride:s.byte_stride,normalized:s.normalized}}return r}_getTriangleListIndices(e){const i=3*e.num_faces(),r=4*i,s=this.draco._malloc(r);try{return this.decoder.GetTrianglesUInt32Array(e,r,s),new Uint32Array(this.draco.HEAPF32.buffer,s,i).slice()}finally{this.draco._free(s)}}_getTriangleStripIndices(e){const t=new this.draco.DracoInt32Array;try{return this.decoder.GetTriangleStripsFromMesh(e,t),function(n){const e=n.size(),t=new Int32Array(e);for(let i=0;i<e;i++)t[i]=n.GetValue(i);return t}(t)}finally{this.draco.destroy(t)}}_getAttributeValues(e,t){const i=Zfe[t.data_type],r=t.num_components,o=e.num_points()*r,a=o*i.BYTES_PER_ELEMENT,l=function(n,e){switch(e){case Float32Array:return n.DT_FLOAT32;case Int8Array:return n.DT_INT8;case Int16Array:return n.DT_INT16;case Int32Array:return n.DT_INT32;case Uint8Array:return n.DT_UINT8;case Uint16Array:return n.DT_UINT16;case Uint32Array:return n.DT_UINT32;default:return n.DT_INVALID}}(this.draco,i);let c;const u=this.draco._malloc(a);try{const h=this.decoder.GetAttribute(e,t.attribute_index);this.decoder.GetAttributeDataArrayForAllPoints(e,h,l,a,u),c=new i(this.draco.HEAPF32.buffer,u,o).slice()}finally{this.draco._free(u)}return{value:c,size:r}}_deduceAttributeName(e,t){const i=e.unique_id;for(const[o,a]of Object.entries(t.extraAttributes||{}))if(a===i)return o;const r=e.attribute_type;for(const o in z4)if(this.draco[o]===r)return z4[o];const s=t.attributeNameEntry||"name";return e.metadata[s]?e.metadata[s].string:`CUSTOM_ATTRIBUTE_${i}`}_getTopLevelMetadata(e){const t=this.decoder.GetMetadata(e);return this._getDracoMetadata(t)}_getAttributeMetadata(e,t){const i=this.decoder.GetAttributeMetadata(e,t);return this._getDracoMetadata(i)}_getDracoMetadata(e){if(!e||!e.ptr)return{};const t={},i=this.metadataQuerier.NumEntries(e);for(let r=0;r<i;r++){const s=this.metadataQuerier.GetEntryName(e,r);t[s]=this._getDracoMetadataField(e,s)}return t}_getDracoMetadataField(e,t){const i=new this.draco.DracoInt32Array;try{this.metadataQuerier.GetIntEntryArray(e,t,i);const r=function(n){const e=n.size(),t=new Int32Array(e);for(let i=0;i<e;i++)t[i]=n.GetValue(i);return t}(i);return{int:this.metadataQuerier.GetIntEntry(e,t),string:this.metadataQuerier.GetStringEntry(e,t),double:this.metadataQuerier.GetDoubleEntry(e,t),intArray:r}}finally{this.draco.destroy(i)}}_disableAttributeTransforms(e){const{quantizedAttributes:t=[],octahedronAttributes:i=[]}=e,r=[...t,...i];for(const s of r)this.decoder.SkipAttributeTransform(this.draco[s])}_getQuantizationTransform(e,t){const{quantizedAttributes:i=[]}=t,r=e.attribute_type();if(i.map(o=>this.decoder[o]).includes(r)){const o=new this.draco.AttributeQuantizationTransform;try{if(o.InitFromAttribute(e))return{quantization_bits:o.quantization_bits(),range:o.range(),min_values:new Float32Array([1,2,3]).map(a=>o.min_value(a))}}finally{this.draco.destroy(o)}}return null}_getOctahedronTransform(e,t){const{octahedronAttributes:i=[]}=t,r=e.attribute_type();if(i.map(o=>this.decoder[o]).includes(r)){const o=new this.draco.AttributeQuantizationTransform;try{if(o.InitFromAttribute(e))return{quantization_bits:o.quantization_bits()}}finally{this.draco.destroy(o)}}return null}}var GS=nt(125);const ZO={};function JO(n){return eR.apply(this,arguments)}function eR(){return(eR=ii(function*(n,e=null,t={}){return e&&(n=spe(n,e,t)),ZO[n]=ZO[n]||ope(n),yield ZO[n]})).apply(this,arguments)}function spe(n,e,t){if(n.startsWith("http"))return n;const i=t.modules||{};return i[n]?i[n]:KI?t.CDN?(Zc(t.CDN.startsWith("http")),`${t.CDN}/${e}@3.0.12/dist/libs/${n}`):XI?`../src/libs/${n}`:`modules/${e}/src/libs/${n}`:`modules/${e}/dist/libs/${n}`}function ope(n){return tR.apply(this,arguments)}function tR(){return(tR=ii(function*(n){return n.endsWith("wasm")?yield(yield fetch(n)).arrayBuffer():KI?XI?importScripts(n):ape(yield(yield fetch(n)).text(),n):GS.requireFromFile&&(yield GS.requireFromFile(n))})).apply(this,arguments)}function ape(n,e){if(!KI)return GS.requireFromString&&GS.requireFromString(n,e);if(XI)return eval.call(dce,n),null;const t=document.createElement("script");t.id=e;try{t.appendChild(document.createTextNode(n))}catch(i){t.text=n}return document.body.appendChild(t),null}const lpe="https://www.gstatic.com/draco/versioned/decoders/1.4.1/draco_decoder.js",cpe="https://www.gstatic.com/draco/versioned/decoders/1.4.1/draco_wasm_wrapper.js",upe="https://www.gstatic.com/draco/versioned/decoders/1.4.1/draco_decoder.wasm";let z0;function hpe(n){return nR.apply(this,arguments)}function nR(){return(nR=ii(function*(n){const e=n.modules||{};return z0=e.draco3d?z0||e.draco3d.createDecoderModule({}).then(t=>({draco:t})):z0||fpe(n),yield z0})).apply(this,arguments)}function fpe(n){return rR.apply(this,arguments)}function rR(){return(rR=ii(function*(n){let e,t;switch(n.draco&&n.draco.decoderType){case"js":e=yield JO(lpe,"draco",n);break;case"wasm":default:[e,t]=yield Promise.all([yield JO(cpe,"draco",n),yield JO(upe,"draco",n)])}return e=e||globalThis.DracoDecoderModule,yield ppe(e,t)})).apply(this,arguments)}function ppe(n,e){const t={};return e&&(t.wasmBinary=e),new Promise(i=>{n(Hn(dt({},t),{onModuleLoaded:r=>i({draco:r})}))})}const oR=Hn(dt({},I4),{parse:function(n,e){return aR.apply(this,arguments)}});function aR(){return(aR=ii(function*(n,e){const{draco:t}=yield hpe(e),i=new epe(t);try{return i.parseSync(n,null==e?void 0:e.draco)}finally{i.destroy()}})).apply(this,arguments)}function G0(n,e){return Of(n>=0),Of(e>0),n+(e-1)&~(e-1)}function _pe(n,e,t){let i;return i=n instanceof ArrayBuffer?new Uint8Array(n):new Uint8Array(n.buffer||n.arrayBuffer,n.byteOffset,n.byteLength),e.set(i,t),t+G0(i.byteLength,4)}const H4=["SCALAR","VEC2","VEC3","VEC4"],ype=[[Int8Array,5120],[Uint8Array,5121],[Int16Array,5122],[Uint16Array,5123],[Uint32Array,5125],[Float32Array,5126],[Float64Array,5130]],vpe=new Map(ype),bpe={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},wpe={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},Epe={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function G4(n){return H4[n-1]||H4[0]}function $4(n){const e=vpe.get(n.constructor);if(!e)throw new Error("Illegal typed array");return e}function W4(n,e){const t=Epe[n.componentType],i=bpe[n.type],s=n.count*i,o=n.count*i*wpe[n.componentType];return Va(o>=0&&o<=e.byteLength),{ArrayType:t,length:s,byteLength:o}}const Spe={asset:{version:"2.0",generator:"loaders.gl"},buffers:[]};class fh{constructor(e){qn(this,"gltf",void 0),qn(this,"sourceBuffers",void 0),qn(this,"byteLength",void 0),this.gltf=e||{json:dt({},Spe),buffers:[]},this.sourceBuffers=[],this.byteLength=0,this.gltf.buffers&&this.gltf.buffers[0]&&(this.byteLength=this.gltf.buffers[0].byteLength,this.sourceBuffers=[this.gltf.buffers[0]])}get json(){return this.gltf.json}getApplicationData(e){return this.json[e]}getExtraData(e){return(this.json.extras||{})[e]}getExtension(e){return this.getUsedExtensions().find(r=>r===e)?(this.json.extensions||{})[e]||!0:null}getRequiredExtension(e){return this.getRequiredExtensions().find(i=>i===e)?this.getExtension(e):null}getRequiredExtensions(){return this.json.extensionsRequired||[]}getUsedExtensions(){return this.json.extensionsUsed||[]}getObjectExtension(e,t){return(e.extensions||{})[t]}getScene(e){return this.getObject("scenes",e)}getNode(e){return this.getObject("nodes",e)}getSkin(e){return this.getObject("skins",e)}getMesh(e){return this.getObject("meshes",e)}getMaterial(e){return this.getObject("materials",e)}getAccessor(e){return this.getObject("accessors",e)}getTexture(e){return this.getObject("textures",e)}getSampler(e){return this.getObject("samplers",e)}getImage(e){return this.getObject("images",e)}getBufferView(e){return this.getObject("bufferViews",e)}getBuffer(e){return this.getObject("buffers",e)}getObject(e,t){if("object"==typeof t)return t;const i=this.json[e]&&this.json[e][t];if(!i)throw new Error(`glTF file error: Could not find ${e}[${t}]`);return i}getTypedArrayForBufferView(e){e=this.getBufferView(e);const i=this.gltf.buffers[e.buffer];return Va(i),new Uint8Array(i.arrayBuffer,(e.byteOffset||0)+i.byteOffset,e.byteLength)}getTypedArrayForAccessor(e){e=this.getAccessor(e);const t=this.getBufferView(e.bufferView),r=this.getBuffer(t.buffer).data,{ArrayType:s,length:o}=W4(e,t);return new s(r,t.byteOffset+e.byteOffset,o)}getTypedArrayForImageData(e){e=this.getAccessor(e);const t=this.getBufferView(e.bufferView),r=this.getBuffer(t.buffer).data;return new Uint8Array(r,t.byteOffset||0,t.byteLength)}addApplicationData(e,t){return this.json[e]=t,this}addExtraData(e,t){return this.json.extras=this.json.extras||{},this.json.extras[e]=t,this}addObjectExtension(e,t,i){return e.extensions=e.extensions||{},e.extensions[t]=i,this.registerUsedExtension(t),this}setObjectExtension(e,t,i){(e.extensions||{})[t]=i}removeObjectExtension(e,t){const i=e.extensions||{},r=i[t];return delete i[t],r}addExtension(e,t={}){return Va(t),this.json.extensions=this.json.extensions||{},this.json.extensions[e]=t,this.registerUsedExtension(e),t}addRequiredExtension(e,t={}){return Va(t),this.addExtension(e,t),this.registerRequiredExtension(e),t}registerUsedExtension(e){this.json.extensionsUsed=this.json.extensionsUsed||[],this.json.extensionsUsed.find(t=>t===e)||this.json.extensionsUsed.push(e)}registerRequiredExtension(e){this.registerUsedExtension(e),this.json.extensionsRequired=this.json.extensionsRequired||[],this.json.extensionsRequired.find(t=>t===e)||this.json.extensionsRequired.push(e)}removeExtension(e){this.json.extensionsRequired&&this._removeStringFromArray(this.json.extensionsRequired,e),this.json.extensionsUsed&&this._removeStringFromArray(this.json.extensionsUsed,e),this.json.extensions&&delete this.json.extensions[e]}setDefaultScene(e){this.json.scene=e}addScene(e){const{nodeIndices:t}=e;return this.json.scenes=this.json.scenes||[],this.json.scenes.push({nodes:t}),this.json.scenes.length-1}addNode(e){const{meshIndex:t,matrix:i}=e;this.json.nodes=this.json.nodes||[];const r={mesh:t};return i&&(r.matrix=i),this.json.nodes.push(r),this.json.nodes.length-1}addMesh(e){const{attributes:t,indices:i,material:r,mode:s=4}=e,a={primitives:[{attributes:this._addAttributes(t),mode:s}]};if(i){const l=this._addIndices(i);a.primitives[0].indices=l}return Number.isFinite(r)&&(a.primitives[0].material=r),this.json.meshes=this.json.meshes||[],this.json.meshes.push(a),this.json.meshes.length-1}addPointCloud(e){const i={primitives:[{attributes:this._addAttributes(e),mode:0}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(i),this.json.meshes.length-1}addImage(e,t){const i=NO(e),r=t||(null==i?void 0:i.mimeType),o={bufferView:this.addBufferView(e),mimeType:r};return this.json.images=this.json.images||[],this.json.images.push(o),this.json.images.length-1}addBufferView(e){const t=e.byteLength;Va(Number.isFinite(t)),this.sourceBuffers=this.sourceBuffers||[],this.sourceBuffers.push(e);const i={buffer:0,byteOffset:this.byteLength,byteLength:t};return this.byteLength+=G0(t,4),this.json.bufferViews=this.json.bufferViews||[],this.json.bufferViews.push(i),this.json.bufferViews.length-1}addAccessor(e,t){const i={bufferView:e,type:G4(t.size),componentType:t.componentType,count:t.count,max:t.max,min:t.min};return this.json.accessors=this.json.accessors||[],this.json.accessors.push(i),this.json.accessors.length-1}addBinaryBuffer(e,t={size:3}){const i=this.addBufferView(e);let r={min:t.min,max:t.max};(!r.min||!r.max)&&(r=this._getAccessorMinMax(e,t.size));const s={size:t.size,componentType:$4(e),count:Math.round(e.length/t.size),min:r.min,max:r.max};return this.addAccessor(i,Object.assign(s,t))}addTexture(e){const{imageIndex:t}=e,i={source:t};return this.json.textures=this.json.textures||[],this.json.textures.push(i),this.json.textures.length-1}addMaterial(e){return this.json.materials=this.json.materials||[],this.json.materials.push(e),this.json.materials.length-1}createBinaryChunk(){var e,t;this.gltf.buffers=[];const i=this.byteLength,r=new ArrayBuffer(i),s=new Uint8Array(r);let o=0;for(const a of this.sourceBuffers||[])o=_pe(a,s,o);null!==(e=this.json)&&void 0!==e&&null!==(t=e.buffers)&&void 0!==t&&t[0]?this.json.buffers[0].byteLength=i:this.json.buffers=[{byteLength:i}],this.gltf.binary=r,this.sourceBuffers=[r]}_removeStringFromArray(e,t){let i=!0;for(;i;){const r=e.indexOf(t);r>-1?e.splice(r,1):i=!1}}_addAttributes(e={}){const t={};for(const i in e){const r=e[i],s=this._getGltfAttributeName(i),o=this.addBinaryBuffer(r.value,r);t[s]=o}return t}_addIndices(e){return this.addBinaryBuffer(e,{size:1})}_getGltfAttributeName(e){switch(e.toLowerCase()){case"position":case"positions":case"vertices":return"POSITION";case"normal":case"normals":return"NORMAL";case"color":case"colors":return"COLOR_0";case"texcoord":case"texcoords":return"TEXCOORD_0";default:return e}}_getAccessorMinMax(e,t){const i={min:null,max:null};if(e.length<t)return i;i.min=[],i.max=[];const r=e.subarray(0,t);for(const s of r)i.min.push(s),i.max.push(s);for(let s=t;s<e.length;s+=t)for(let o=0;o<t;o++)i.min[0+o]=Math.min(i.min[0+o],e[s+o]),i.max[0+o]=Math.max(i.max[0+o],e[s+o]);return i}}const q4="KHR_binary_glTF",$0="KHR_draco_mesh_compression",tm="KHR_lights_punctual",WS="KHR_materials_unlit",qS="KHR_techniques_webgl";function Tpe(n){const e={};for(const t in n){const i=n[t];if("indices"!==t){const r=Y4(i);e[t]=r}}return e}function Y4(n){const{buffer:e,size:t,count:i}=function(n){let e=n,t=1,i=0;return n&&n.value&&(e=n.value,t=n.size||1),e&&(ArrayBuffer.isView(e)||(e=function(n,e,t=!1){return n?Array.isArray(n)?new e(n):!t||n instanceof e?n:new e(n):null}(e,Float32Array)),i=e.length/t),{buffer:e,size:t,count:i}}(n);return{value:e,size:t,byteOffset:0,count:i,type:G4(t),componentType:$4(e)}}function Dpe(n,e,t){return lR.apply(this,arguments)}function lR(){return(lR=ii(function*(n,e,t){var i;if(null==e||null===(i=e.gltf)||void 0===i||!i.decompressMeshes)return;const r=new fh(n),s=[];for(const o of Ppe(r))r.getObjectExtension(o,$0)&&s.push(Ope(r,o,e,t));yield Promise.all(s),r.removeExtension($0)})).apply(this,arguments)}function Ipe(n,e={}){const t=new fh(n);for(const i of t.json.meshes||[])Rpe(i),t.addRequiredExtension($0)}function Ope(n,e,t,i){return cR.apply(this,arguments)}function cR(){return(cR=ii(function*(n,e,t,i){const r=n.getObjectExtension(e,$0);if(!r)return;const s=n.getTypedArrayForBufferView(r.bufferView),o=qU(s.buffer,s.byteOffset),{parse:a}=i,l=dt({},t);delete l["3d-tiles"];const c=yield a(o,oR,l,i),u=Tpe(c.attributes);for(const[h,p]of Object.entries(u))if(h in e.attributes){const m=n.getAccessor(e.attributes[h]);null!=m&&m.min&&null!=m&&m.max&&(p.min=m.min,p.max=m.max)}e.attributes=u,c.indices&&(e.indices=Y4(c.indices)),Npe(e)})).apply(this,arguments)}function Rpe(n,e,t=4,i,r){var s;if(!i.DracoWriter)throw new Error("options.gltf.DracoWriter not provided");const o=i.DracoWriter.encodeSync({attributes:n}),a=null==r||null===(s=r.parseSync)||void 0===s?void 0:s.call(r,{attributes:n}),l=i._addFauxAttributes(a.attributes),c=i.addBufferView(o);return{primitives:[{attributes:l,mode:t,extensions:{[$0]:{bufferView:c,attributes:l}}}]}}function Npe(n){if(!n.attributes&&Object.keys(n.attributes).length>0)throw new Error("glTF: Empty primitive detected: Draco decompression failure?")}function*Ppe(n){for(const e of n.json.meshes||[])for(const t of e.primitives)yield t}function Fpe(n){return uR.apply(this,arguments)}function uR(){return(uR=ii(function*(n){const e=new fh(n),{json:t}=e;e.removeExtension(WS);for(const i of t.materials||[])i.extensions&&i.extensions.KHR_materials_unlit&&(i.unlit=!0),e.removeObjectExtension(i,WS)})).apply(this,arguments)}function Lpe(n){const e=new fh(n),{json:t}=e;if(e.materials)for(const i of t.materials||[])i.unlit&&(delete i.unlit,e.addObjectExtension(i,WS,{}),e.addExtension(WS))}function kpe(n){return dR.apply(this,arguments)}function dR(){return(dR=ii(function*(n){const e=new fh(n),{json:t}=e,i=e.getExtension(tm);i&&(e.json.lights=i.lights,e.removeExtension(tm));for(const r of t.nodes||[]){const s=e.getObjectExtension(r,tm);s&&(r.light=s.light),e.removeObjectExtension(r,tm)}})).apply(this,arguments)}function Bpe(n){return hR.apply(this,arguments)}function hR(){return(hR=ii(function*(n){const e=new fh(n),{json:t}=e;if(t.lights){const i=e.addExtension(tm);Va(!i.lights),i.lights=t.lights,delete t.lights}if(e.json.lights){for(const i of e.json.lights)e.addObjectExtension(i.node,tm,i);delete e.json.lights}})).apply(this,arguments)}function Vpe(n){return fR.apply(this,arguments)}function fR(){return(fR=ii(function*(n){const e=new fh(n),{json:t}=e,i=e.getExtension(qS);if(i){const r=Upe(i,e);for(const s of t.materials||[]){const o=e.getObjectExtension(s,qS);o&&(s.technique=Object.assign({},o,r[o.technique]),s.technique.values=zpe(s.technique,e)),e.removeObjectExtension(s,qS)}e.removeExtension(qS)}})).apply(this,arguments)}function jpe(n,e){return pR.apply(this,arguments)}function pR(){return(pR=ii(function*(n,e){})).apply(this,arguments)}function Upe(n,e){const{programs:t=[],shaders:i=[],techniques:r=[]}=n,s=new TextDecoder;return i.forEach(o=>{if(!Number.isFinite(o.bufferView))throw new Error("KHR_techniques_webgl: no shader code");o.code=s.decode(e.getTypedArrayForBufferView(o.bufferView))}),t.forEach(o=>{o.fragmentShader=i[o.fragmentShader],o.vertexShader=i[o.vertexShader]}),r.forEach(o=>{o.program=t[o.program]}),r}function zpe(n,e){const t=Object.assign({},n.values);return Object.keys(n.uniforms||{}).forEach(i=>{n.uniforms[i].value&&!(i in t)&&(t[i]=n.uniforms[i].value)}),Object.keys(t).forEach(i=>{"object"==typeof t[i]&&void 0!==t[i].index&&(t[i].texture=e.getTexture(t[i].index))}),t}const K4={KHR_draco_mesh_compression:mt,KHR_materials_unlit:J,KHR_lights_punctual:Mt,KHR_techniques_webgl:ht};function Hpe(n){return gR.apply(this,arguments)}function gR(){return(gR=ii(function*(n,e={},t){for(const r in K4){var i;const s=(null==e||null===(i=e.gltf)||void 0===i?void 0:i.excludeExtensions)||{};r in s&&!s[r]||(yield K4[r].decode(n,e,t))}})).apply(this,arguments)}const X4={accessors:"accessor",animations:"animation",buffers:"buffer",bufferViews:"bufferView",images:"image",materials:"material",meshes:"mesh",nodes:"node",samplers:"sampler",scenes:"scene",skins:"skin",textures:"texture"},$pe={accessor:"accessors",animations:"animation",buffer:"buffers",bufferView:"bufferViews",image:"images",material:"materials",mesh:"meshes",node:"nodes",sampler:"samplers",scene:"scenes",skin:"skins",texture:"textures"};class Wpe{constructor(e){this.idToIndexMap={animations:{},accessors:{},buffers:{},bufferViews:{},images:{},materials:{},meshes:{},nodes:{},samplers:{},scenes:{},skins:{},textures:{}}}normalize(e,t){this.json=e.json;const i=e.json;switch(i.asset&&i.asset.version){case"2.0":return;case void 0:case"1.0":break;default:return void console.warn(`glTF: Unknown version ${i.asset.version}`)}if(!t.normalize)throw new Error("glTF v1 is not supported.");console.warn("Converting glTF v1 to glTF v2 format. This is experimental and may fail."),this._addAsset(i),this._convertTopLevelObjectsToArrays(i),function(n){const e=new fh(n),{json:t}=e;for(const i of t.images||[]){const r=e.removeObjectExtension(i,q4);r&&Object.assign(i,r)}t.buffers&&t.buffers[0]&&delete t.buffers[0].uri,e.removeExtension(q4)}(e),this._convertObjectIdsToArrayIndices(i),this._updateObjects(i),this._updateMaterial(i)}_addAsset(e){e.asset=e.asset||{},e.asset.version="2.0",e.asset.generator=e.asset.generator||"Normalized to glTF 2.0 by loaders.gl"}_convertTopLevelObjectsToArrays(e){for(const t in X4)this._convertTopLevelObjectToArray(e,t)}_convertTopLevelObjectToArray(e,t){const i=e[t];if(i&&!Array.isArray(i)){e[t]=[];for(const r in i){const s=i[r];s.id=s.id||r;const o=e[t].length;e[t].push(s),this.idToIndexMap[t][r]=o}}}_convertObjectIdsToArrayIndices(e){for(const t in X4)this._convertIdsToIndices(e,t);"scene"in e&&(e.scene=this._convertIdToIndex(e.scene,"scene"));for(const t of e.textures)this._convertTextureIds(t);for(const t of e.meshes)this._convertMeshIds(t);for(const t of e.nodes)this._convertNodeIds(t);for(const t of e.scenes)this._convertSceneIds(t)}_convertTextureIds(e){e.source&&(e.source=this._convertIdToIndex(e.source,"image"))}_convertMeshIds(e){for(const t of e.primitives){const{attributes:i,indices:r,material:s}=t;for(const o in i)i[o]=this._convertIdToIndex(i[o],"accessor");r&&(t.indices=this._convertIdToIndex(r,"accessor")),s&&(t.material=this._convertIdToIndex(s,"material"))}}_convertNodeIds(e){e.children&&(e.children=e.children.map(t=>this._convertIdToIndex(t,"node"))),e.meshes&&(e.meshes=e.meshes.map(t=>this._convertIdToIndex(t,"mesh")))}_convertSceneIds(e){e.nodes&&(e.nodes=e.nodes.map(t=>this._convertIdToIndex(t,"node")))}_convertIdsToIndices(e,t){e[t]||(console.warn(`gltf v1: json doesn't contain attribute ${t}`),e[t]=[]);for(const i of e[t])for(const r in i){const o=this._convertIdToIndex(i[r],r);i[r]=o}}_convertIdToIndex(e,t){const i=$pe[t];if(i in this.idToIndexMap){const r=this.idToIndexMap[i][e];if(!Number.isFinite(r))throw new Error(`gltf v1: failed to resolve ${t} with id ${e}`);return r}return e}_updateObjects(e){for(const t of this.json.buffers)delete t.type}_updateMaterial(e){for(const t of e.materials){t.pbrMetallicRoughness={baseColorFactor:[1,1,1,1],metallicFactor:1,roughnessFactor:1};const i=t.values&&t.values.tex,r=e.textures.findIndex(s=>s.id===i);-1!==r&&(t.pbrMetallicRoughness.baseColorTexture={index:r})}}}function qpe(n,e={}){return(new Wpe).normalize(n,e)}const Ype={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Kpe={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},Sl={TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,REPEAT:10497,LINEAR:9729,NEAREST_MIPMAP_LINEAR:9986},Xpe={magFilter:Sl.TEXTURE_MAG_FILTER,minFilter:Sl.TEXTURE_MIN_FILTER,wrapS:Sl.TEXTURE_WRAP_S,wrapT:Sl.TEXTURE_WRAP_T},Qpe={[Sl.TEXTURE_MAG_FILTER]:Sl.LINEAR,[Sl.TEXTURE_MIN_FILTER]:Sl.NEAREST_MIPMAP_LINEAR,[Sl.TEXTURE_WRAP_S]:Sl.REPEAT,[Sl.TEXTURE_WRAP_]:Sl.REPEAT};class ege{postProcess(e,t={}){const{json:i,buffers:r=[],images:s=[],baseUri:o=""}=e;return Va(i),this.baseUri=o,this.json=i,this.buffers=r,this.images=s,this._resolveTree(this.json,t),this.json}_resolveTree(e,t={}){e.bufferViews&&(e.bufferViews=e.bufferViews.map((i,r)=>this._resolveBufferView(i,r))),e.images&&(e.images=e.images.map((i,r)=>this._resolveImage(i,r))),e.samplers&&(e.samplers=e.samplers.map((i,r)=>this._resolveSampler(i,r))),e.textures&&(e.textures=e.textures.map((i,r)=>this._resolveTexture(i,r))),e.accessors&&(e.accessors=e.accessors.map((i,r)=>this._resolveAccessor(i,r))),e.materials&&(e.materials=e.materials.map((i,r)=>this._resolveMaterial(i,r))),e.meshes&&(e.meshes=e.meshes.map((i,r)=>this._resolveMesh(i,r))),e.nodes&&(e.nodes=e.nodes.map((i,r)=>this._resolveNode(i,r))),e.skins&&(e.skins=e.skins.map((i,r)=>this._resolveSkin(i,r))),e.scenes&&(e.scenes=e.scenes.map((i,r)=>this._resolveScene(i,r))),void 0!==e.scene&&(e.scene=e.scenes[this.json.scene])}getScene(e){return this._get("scenes",e)}getNode(e){return this._get("nodes",e)}getSkin(e){return this._get("skins",e)}getMesh(e){return this._get("meshes",e)}getMaterial(e){return this._get("materials",e)}getAccessor(e){return this._get("accessors",e)}getCamera(e){return null}getTexture(e){return this._get("textures",e)}getSampler(e){return this._get("samplers",e)}getImage(e){return this._get("images",e)}getBufferView(e){return this._get("bufferViews",e)}getBuffer(e){return this._get("buffers",e)}_get(e,t){if("object"==typeof t)return t;const i=this.json[e]&&this.json[e][t];return i||console.warn(`glTF file error: Could not find ${e}[${t}]`),i}_resolveScene(e,t){return e.id=e.id||`scene-${t}`,e.nodes=(e.nodes||[]).map(i=>this.getNode(i)),e}_resolveNode(e,t){return e.id=e.id||`node-${t}`,e.children&&(e.children=e.children.map(i=>this.getNode(i))),void 0!==e.mesh?e.mesh=this.getMesh(e.mesh):void 0!==e.meshes&&e.meshes.length&&(e.mesh=e.meshes.reduce((i,r)=>{const s=this.getMesh(r);return i.id=s.id,i.primitives=i.primitives.concat(s.primitives),i},{primitives:[]})),void 0!==e.camera&&(e.camera=this.getCamera(e.camera)),void 0!==e.skin&&(e.skin=this.getSkin(e.skin)),e}_resolveSkin(e,t){return e.id=e.id||`skin-${t}`,e.inverseBindMatrices=this.getAccessor(e.inverseBindMatrices),e}_resolveMesh(e,t){return e.id=e.id||`mesh-${t}`,e.primitives&&(e.primitives=e.primitives.map(i=>{const r=(i=dt({},i)).attributes;i.attributes={};for(const s in r)i.attributes[s]=this.getAccessor(r[s]);return void 0!==i.indices&&(i.indices=this.getAccessor(i.indices)),void 0!==i.material&&(i.material=this.getMaterial(i.material)),i})),e}_resolveMaterial(e,t){if(e.id=e.id||`material-${t}`,e.normalTexture&&(e.normalTexture=dt({},e.normalTexture),e.normalTexture.texture=this.getTexture(e.normalTexture.index)),e.occlusionTexture&&(e.occlustionTexture=dt({},e.occlustionTexture),e.occlusionTexture.texture=this.getTexture(e.occlusionTexture.index)),e.emissiveTexture&&(e.emmisiveTexture=dt({},e.emmisiveTexture),e.emissiveTexture.texture=this.getTexture(e.emissiveTexture.index)),e.emissiveFactor||(e.emissiveFactor=e.emmisiveTexture?[1,1,1]:[0,0,0]),e.pbrMetallicRoughness){e.pbrMetallicRoughness=dt({},e.pbrMetallicRoughness);const i=e.pbrMetallicRoughness;i.baseColorTexture&&(i.baseColorTexture=dt({},i.baseColorTexture),i.baseColorTexture.texture=this.getTexture(i.baseColorTexture.index)),i.metallicRoughnessTexture&&(i.metallicRoughnessTexture=dt({},i.metallicRoughnessTexture),i.metallicRoughnessTexture.texture=this.getTexture(i.metallicRoughnessTexture.index))}return e}_resolveAccessor(e,t){if(e.id=e.id||`accessor-${t}`,void 0!==e.bufferView&&(e.bufferView=this.getBufferView(e.bufferView)),e.bytesPerComponent=function(n){return Kpe[n]}(e.componentType),e.components=function(n){return Ype[n]}(e.type),e.bytesPerElement=e.bytesPerComponent*e.components,e.bufferView){const i=e.bufferView.buffer,{ArrayType:r,byteLength:s}=W4(e,e.bufferView),o=(e.bufferView.byteOffset||0)+(e.byteOffset||0)+i.byteOffset,a=i.arrayBuffer.slice(o,o+s);e.value=new r(a)}return e}_resolveTexture(e,t){return e.id=e.id||`texture-${t}`,e.sampler="sampler"in e?this.getSampler(e.sampler):Qpe,e.source=this.getImage(e.source),e}_resolveSampler(e,t){e.id=e.id||`sampler-${t}`,e.parameters={};for(const i in e){const r=this._enumSamplerParameter(i);void 0!==r&&(e.parameters[r]=e[i])}return e}_enumSamplerParameter(e){return Xpe[e]}_resolveImage(e,t){e.id=e.id||`image-${t}`,void 0!==e.bufferView&&(e.bufferView=this.getBufferView(e.bufferView));const i=this.images[t];return i&&(e.image=i),e}_resolveBufferView(e,t){e.id=e.id||`bufferView-${t}`;const i=e.buffer;e.buffer=this.buffers[i];let s=this.buffers[i].byteOffset||0;return"byteOffset"in e&&(s+=e.byteOffset),e.data=new Uint8Array(this.buffers[i].arrayBuffer,s,e.byteLength),e}_resolveCamera(e,t){return e.id=e.id||`camera-${t}`,e}}function tge(n,e){return(new ege).postProcess(n,e)}const Q4=1735152710,nm=!0;function _R(n,e,t,i){const r=new Uint8Array(e.buffer,t,i),o=new TextDecoder("utf8").decode(r);return n.json=JSON.parse(o),G0(i,4)}function yR(n,e,t,i){return n.header.hasBinChunk=!0,n.binChunks.push({byteOffset:t,byteLength:i,arrayBuffer:e.buffer}),G0(i,4)}function fge(n,e){return vR.apply(this,arguments)}function vR(){return(vR=ii(function*(n,e,t=0,i,r){var s,o,a,l;pge(n,e,t,i),qpe(n,{normalize:null==i||null===(s=i.gltf)||void 0===s?void 0:s.normalize});const c=[];if(null!=i&&null!==(o=i.gltf)&&void 0!==o&&o.loadBuffers&&n.json.buffers&&(yield gge(n,i,r)),null!=i&&null!==(a=i.gltf)&&void 0!==a&&a.loadImages){const h=mge(n,i,r);c.push(h)}const u=Hpe(n,i,r);return c.push(u),yield Promise.all(c),null!=i&&null!==(l=i.gltf)&&void 0!==l&&l.postProcess?tge(n,i):n})).apply(this,arguments)}function pge(n,e,t,i){if(i.uri&&(n.baseUri=i.uri),e instanceof ArrayBuffer&&!function(n,e=0,t={}){const i=new DataView(n),{magic:r=Q4}=t,s=i.getUint32(e,!1);return s===r||s===Q4}(e,t,i)&&(e=(new TextDecoder).decode(e)),"string"==typeof e)n.json=function(n){try{return JSON.parse(n)}catch(e){throw new Error(`Failed to parse JSON from data starting with "${function(n,e=5){return"string"==typeof n?n.slice(0,e):ArrayBuffer.isView(n)?A4(n.buffer,n.byteOffset,e):n instanceof ArrayBuffer?A4(n,0,e):""}(n)}"`)}}(e);else if(e instanceof ArrayBuffer){const o={};t=function(n,e,t=0,i={}){const r=new DataView(e),s=function(n,e=0){return`${String.fromCharCode(n.getUint8(e+0))}${String.fromCharCode(n.getUint8(e+1))}${String.fromCharCode(n.getUint8(e+2))}${String.fromCharCode(n.getUint8(e+3))}`}(r,t+0),o=r.getUint32(t+4,nm),a=r.getUint32(t+8,nm);switch(Object.assign(n,{header:{byteOffset:t,byteLength:a,hasBinChunk:!1},type:s,version:o,json:{},binChunks:[]}),t+=12,n.version){case 1:return function(n,e,t){Of(n.header.byteLength>20);const i=e.getUint32(t+0,nm),r=e.getUint32(t+4,nm);return t+=8,Of(0===r),_R(n,e,t,i),(t+=i)+yR(n,e,t,n.header.byteLength)}(n,r,t);case 2:return function(n,e,t,i){return Of(n.header.byteLength>20),function(n,e,t,i){for(;t+8<=n.header.byteLength;){const r=e.getUint32(t+0,nm),s=e.getUint32(t+4,nm);switch(t+=8,s){case 1313821514:_R(n,e,t,r);break;case 5130562:yR(n,e,t,r);break;case 0:i.strict||_R(n,e,t,r);break;case 1:i.strict||yR(n,e,t,r)}t+=G0(r,4)}}(n,e,t,{}),t+n.header.byteLength}(n,r,t);default:throw new Error(`Invalid GLB version ${n.version}. Only supports v1 and v2.`)}}(o,e,t,i.glb),Va("glTF"===o.type,`Invalid GLB magic string ${o.type}`),n._glb=o,n.json=o.json}else Va(!1,"GLTF: must be ArrayBuffer or string");if(n.buffers=new Array((n.json.buffers||[]).length).fill(null),n._glb&&n._glb.header.hasBinChunk){const{binChunks:o}=n._glb;n.buffers[0]={arrayBuffer:o[0].arrayBuffer,byteOffset:o[0].byteOffset,byteLength:o[0].byteLength}}n.images=new Array((n.json.images||[]).length).fill({})}function gge(n,e,t){return bR.apply(this,arguments)}function bR(){return(bR=ii(function*(n,e,t){for(let s=0;s<n.json.buffers.length;++s){const o=n.json.buffers[s];if(o.uri){var i,r;const{fetch:a}=t;Va(a);const l=M4(o.uri,e),c=yield null==t||null===(i=t.fetch)||void 0===i?void 0:i.call(t,l),u=yield null==c||null===(r=c.arrayBuffer)||void 0===r?void 0:r.call(c);n.buffers[s]={arrayBuffer:u,byteOffset:0,byteLength:u.byteLength},delete o.uri}}})).apply(this,arguments)}function mge(n,e,t){return wR.apply(this,arguments)}function wR(){return(wR=ii(function*(n,e,t){const i=n.json.images||[],r=[];for(let s=0;s<i.length;++s)r.push(_ge(n,i[s],s,e,t));return yield Promise.all(r)})).apply(this,arguments)}function _ge(n,e,t,i,r){return ER.apply(this,arguments)}function ER(){return(ER=ii(function*(n,e,t,i,r){const{fetch:s,parse:o}=r;let a;if(e.uri){const c=M4(e.uri,i);a=yield(yield s(c)).arrayBuffer()}if(Number.isFinite(e.bufferView)){const c=D4(n.json,n.buffers,e.bufferView);a=qU(c.buffer,c.byteOffset,c.byteLength)}Va(a,"glTF image has no data");const l=yield o(a,Az,{},r);n.images[t]=l})).apply(this,arguments)}const im={name:"glTF",id:"gltf",module:"gltf",version:"3.0.12",extensions:["gltf","glb"],mimeTypes:["model/gltf+json","model/gltf-binary"],text:!0,binary:!0,tests:["glTF"],parse:function(n){return SR.apply(this,arguments)},options:{gltf:{normalize:!0,loadBuffers:!0,loadImages:!0,decompressMeshes:!0,postProcess:!0},log:console},deprecatedOptions:{fetchImages:"gltf.loadImages",createImages:"gltf.loadImages",decompress:"gltf.decompressMeshes",postProcess:"gltf.postProcess",gltf:{decompress:"gltf.decompressMeshes"}}};function SR(){return(SR=ii(function*(n,e={},t){(e=dt(dt({},im.options),e)).gltf=dt(dt({},im.options.gltf),e.gltf);const{byteOffset:i=0}=e;return yield fge({},n,i,e,t)})).apply(this,arguments)}function xR(){return(xR=ii(function*(n){const e=[];return n.scenes.forEach(t=>{t.traverse(i=>{Object.values(i.model.getUniforms()).forEach(r=>{!1===r.loaded&&e.push(r)})})}),yield bge(()=>e.some(t=>!t.loaded))})).apply(this,arguments)}function bge(n){return CR.apply(this,arguments)}function CR(){return(CR=ii(function*(n){for(;n();)yield new Promise(e=>requestAnimationFrame(e))})).apply(this,arguments)}const Z4=[255,255,255,255],Sge={scenegraph:{type:"object",value:null,async:!0},getScene:n=>n&&n.scenes?"object"==typeof n.scene?n.scene:n.scenes[n.scene||0]:n,getAnimator:n=>n&&n.animator,_animations:null,sizeScale:{type:"number",value:1,min:0},sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},getPosition:{type:"accessor",value:n=>n.position},getColor:{type:"accessor",value:Z4},_lighting:"flat",_imageBasedLightingEnvironment:null,getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},loaders:[im]};let xge=(()=>{class n extends yO{getShaders(){const t=[$z,Xz];return"pbr"===this.props._lighting&&t.push(r4),{vs:"#version 300 es\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin mat3 instanceModelMatrix;\nin vec3 instanceTranslation;\nuniform float sizeScale;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform mat4 sceneModelMatrix;\nuniform bool composeModelMatrix;\nin vec4 POSITION;\n\n#ifdef HAS_UV\n  in vec2 TEXCOORD_0;\n#endif\n\n#ifdef MODULE_PBR\n  #ifdef HAS_NORMALS\n    in vec4 NORMAL;\n  #endif\n#endif\nout vec4 vColor;\n#ifndef MODULE_PBR\n  #ifdef HAS_UV\n    out vec2 vTEXCOORD_0;\n  #endif\n#endif\nvoid main(void) {\n  #if defined(HAS_UV) && !defined(MODULE_PBR)\n    vTEXCOORD_0 = TEXCOORD_0;\n    geometry.uv = vTEXCOORD_0;\n  #endif\n\n  geometry.worldPosition = instancePositions;\n  geometry.pickingColor = instancePickingColors;\n\n  #ifdef MODULE_PBR\n    #ifdef HAS_NORMALS\n      pbr_vNormal = project_normal(instanceModelMatrix * (sceneModelMatrix * vec4(NORMAL.xyz, 0.0)).xyz);\n      geometry.normal = pbr_vNormal;\n    #endif\n\n    #ifdef HAS_UV\n      pbr_vUV = TEXCOORD_0;\n    #else\n      pbr_vUV = vec2(0., 0.);\n    #endif\n    geometry.uv = pbr_vUV;\n  #endif\n\n  float originalSize = project_size_to_pixel(sizeScale);\n  float clampedSize = clamp(originalSize, sizeMinPixels, sizeMaxPixels);\n\n  vec3 pos = (instanceModelMatrix * (sceneModelMatrix * POSITION).xyz) * sizeScale * (clampedSize / originalSize) + instanceTranslation;\n  if(composeModelMatrix) {\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n  }\n  else {\n    pos = project_size(pos);\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, geometry.position);\n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  #ifdef MODULE_PBR\n    pbr_vPosition = geometry.position.xyz;\n  #endif\n\n  vColor = instanceColors;\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\nuniform float opacity;\nin vec4 vColor;\n\nout vec4 fragmentColor;\n#ifndef MODULE_PBR\n  #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)\n    in vec2 vTEXCOORD_0;\n    uniform sampler2D u_BaseColorSampler;\n  #endif\n#endif\n\nvoid main(void) {\n  #ifdef MODULE_PBR\n    fragmentColor = vColor * pbr_filterColor(vec4(0));\n    geometry.uv = pbr_vUV;\n  #else\n    #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)\n      fragmentColor = vColor * texture2D(u_BaseColorSampler, vTEXCOORD_0);\n      geometry.uv = vTEXCOORD_0;\n    #else\n      fragmentColor = vColor;\n    #endif\n  #endif\n\n  fragmentColor.a *= opacity;\n  DECKGL_FILTER_COLOR(fragmentColor, geometry);\n}\n",modules:t}}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),accessor:"getPosition",transition:!0},instanceColors:{type:5121,size:this.props.colorFormat.length,accessor:"getColor",normalized:!0,defaultValue:Z4,transition:!0},instanceModelMatrix:t4})}updateState(t){super.updateState(t);const{props:i,oldProps:r}=t;i.scenegraph!==r.scenegraph?this._updateScenegraph(i):i._animations!==r._animations&&this._applyAnimationsProp(this.state.scenegraph,this.state.animator,i._animations)}finalizeState(){super.finalizeState(),this._deleteScenegraph()}_updateScenegraph(t){const{gl:i}=this.context;let r=null;if(t.scenegraph instanceof Zg)r={scenes:[t.scenegraph]};else if(t.scenegraph&&!t.scenegraph.gltf){const l=t.scenegraph,c=function(n,e,t){const i=new Ife(n,t);return{scenes:i.instantiate(e),animator:i.createAnimator()}}(i,l,this._getModelOptions());r=dt({gltf:l},c),function(n){return xR.apply(this,arguments)}(c).then(()=>this.setNeedsRedraw())}else t.scenegraph&&(Bi.deprecated("ScenegraphLayer.props.scenegraph","Use GLTFLoader instead of GLTFScenegraphLoader")(),r=t.scenegraph);const s={layer:this,gl:i},o=t.getScene(r,s),a=t.getAnimator(r,s);o instanceof Zg?(this._deleteScenegraph(),this._applyAllAttributes(o),this._applyAnimationsProp(o,a,t._animations),this.setState({scenegraph:o,animator:a})):null!==o&&Bi.warn("invalid scenegraph:",o)()}_applyAllAttributes(t){if(this.state.attributesAvailable){const i=this.getAttributeManager().getAttributes();t.traverse(r=>{this._setModelAttributes(r.model,i)})}}_applyAnimationsProp(t,i,r){if(!t||!i||!r)return;const s=i.getAnimations();Object.keys(r).sort().forEach(o=>{const a=r[o];if("*"===o)s.forEach(l=>{Object.assign(l,a)});else if(Number.isFinite(Number(o))){const l=Number(o);l>=0&&l<s.length?Object.assign(s[l],a):Bi.warn("animation ".concat(o," not found"))()}else{const l=s.find(({name:c})=>c===o);l?Object.assign(l,a):Bi.warn("animation ".concat(o," not found"))()}})}_deleteScenegraph(){const{scenegraph:t}=this.state;t instanceof Zg&&t.delete()}_getModelOptions(){const{_imageBasedLightingEnvironment:t}=this.props;let i=null;return t&&(i="function"==typeof t?t({gl:this.context.gl,layer:this}):t),{gl:this.context.gl,waitForFullLoad:!0,imageBasedLightingEnvironment:i,modelOptions:dt({isInstanced:!0,transpileToGLSL100:!yi(this.context.gl)},this.getShaders()),useTangents:!1}}updateAttributes(t){this.setState({attributesAvailable:!0}),this.state.scenegraph&&this.state.scenegraph.traverse(i=>{this._setModelAttributes(i.model,t)})}draw({moduleParameters:t=null,parameters:i={},context:r}){if(!this.state.scenegraph)return;this.props._animations&&this.state.animator&&(this.state.animator.animate(r.timeline.getTime()),this.setNeedsRedraw());const{viewport:s}=this.context,{sizeScale:o,sizeMinPixels:a,sizeMaxPixels:l,opacity:c,coordinateSystem:u}=this.props,h=this.getNumInstances();this.state.scenegraph.traverse((p,{worldMatrix:g})=>{p.model.setInstanceCount(h),p.updateModuleSettings(t),p.draw({parameters:i,uniforms:{sizeScale:o,opacity:c,sizeMinPixels:a,sizeMaxPixels:l,composeModelMatrix:n4(s,u),sceneModelMatrix:g,u_Camera:p.model.getUniforms().project_uCameraPosition}})})}}return n.layerName="ScenegraphLayer",n.defaultProps=Sge,n})();const Cge=new Uint16Array([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),Tge=new Float32Array([-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1]),Age=new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0]),Mge=new Float32Array([0,0,1,0,1,1,0,1,1,0,1,1,0,1,0,0,0,1,0,0,1,0,1,1,1,1,0,1,0,0,1,0,1,0,1,1,0,1,0,0,0,0,1,0,1,1,0,1]),Dge={POSITION:{size:3,value:new Float32Array(Tge)},NORMAL:{size:3,value:new Float32Array(Age)},TEXCOORD_0:{size:2,value:new Float32Array(Mge)}};class Ige extends BS{constructor(e={}){const{id:t=Kc("cube-geometry")}=e;super(Hn(dt({},e),{id:t,indices:{size:1,value:new Uint16Array(Cge)},attributes:dt(dt({},Dge),e.attributes)}))}}class ru{constructor(e=[0,0,0,0,0,0,0,0,0]){this.elements=void 0,this.elements=e}identity(){const e=this.elements;e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1}setZero(){const e=this.elements;e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e[8]=0}setTrace(e){const t=this.elements;t[0]=e.x,t[4]=e.y,t[8]=e.z}getTrace(e=new ce){const t=this.elements;return e.x=t[0],e.y=t[4],e.z=t[8],e}vmult(e,t=new ce){const i=this.elements,r=e.x,s=e.y,o=e.z;return t.x=i[0]*r+i[1]*s+i[2]*o,t.y=i[3]*r+i[4]*s+i[5]*o,t.z=i[6]*r+i[7]*s+i[8]*o,t}smult(e){for(let t=0;t<this.elements.length;t++)this.elements[t]*=e}mmult(e,t=new ru){const i=this.elements,r=e.elements,s=t.elements,o=i[0],a=i[1],l=i[2],c=i[3],u=i[4],h=i[5],p=i[6],g=i[7],m=i[8],w=r[0],x=r[1],H=r[2],I=r[3],oe=r[4],Se=r[5],Pe=r[6],Be=r[7],He=r[8];return s[0]=o*w+a*I+l*Pe,s[1]=o*x+a*oe+l*Be,s[2]=o*H+a*Se+l*He,s[3]=c*w+u*I+h*Pe,s[4]=c*x+u*oe+h*Be,s[5]=c*H+u*Se+h*He,s[6]=p*w+g*I+m*Pe,s[7]=p*x+g*oe+m*Be,s[8]=p*H+g*Se+m*He,t}scale(e,t=new ru){const i=this.elements,r=t.elements;for(let s=0;3!==s;s++)r[3*s+0]=e.x*i[3*s+0],r[3*s+1]=e.y*i[3*s+1],r[3*s+2]=e.z*i[3*s+2];return t}solve(e,t=new ce){const s=[];let o,a;for(o=0;o<12;o++)s.push(0);for(o=0;o<3;o++)for(a=0;a<3;a++)s[o+4*a]=this.elements[o+3*a];s[3]=e.x,s[7]=e.y,s[11]=e.z;let l=3;const c=l;let u,p;do{if(o=c-l,0===s[o+4*o])for(a=o+1;a<c;a++)if(0!==s[o+4*a]){u=4;do{p=4-u,s[p+4*o]+=s[p+4*a]}while(--u);break}if(0!==s[o+4*o])for(a=o+1;a<c;a++){const g=s[o+4*a]/s[o+4*o];u=4;do{p=4-u,s[p+4*a]=p<=o?0:s[p+4*a]-s[p+4*o]*g}while(--u)}}while(--l);if(t.z=s[11]/s[10],t.y=(s[7]-s[6]*t.z)/s[5],t.x=(s[3]-s[2]*t.z-s[1]*t.y)/s[0],isNaN(t.x)||isNaN(t.y)||isNaN(t.z)||t.x===1/0||t.y===1/0||t.z===1/0)throw"Could not solve equation! Got x=["+t.toString()+"], b=["+e.toString()+"], A=["+this.toString()+"]";return t}e(e,t,i){if(void 0===i)return this.elements[t+3*e];this.elements[t+3*e]=i}copy(e){for(let t=0;t<e.elements.length;t++)this.elements[t]=e.elements[t];return this}toString(){let e="";for(let i=0;i<9;i++)e+=this.elements[i]+",";return e}reverse(e=new ru){const r=Oge;let s,o;for(s=0;s<3;s++)for(o=0;o<3;o++)r[s+6*o]=this.elements[s+3*o];r[3]=1,r[9]=0,r[15]=0,r[4]=0,r[10]=1,r[16]=0,r[5]=0,r[11]=0,r[17]=1;let a=3;const l=a;let c,h;do{if(s=l-a,0===r[s+6*s])for(o=s+1;o<l;o++)if(0!==r[s+6*o]){c=6;do{h=6-c,r[h+6*s]+=r[h+6*o]}while(--c);break}if(0!==r[s+6*s])for(o=s+1;o<l;o++){const p=r[s+6*o]/r[s+6*s];c=6;do{h=6-c,r[h+6*o]=h<=s?0:r[h+6*o]-r[h+6*s]*p}while(--c)}}while(--a);s=2;do{o=s-1;do{const p=r[s+6*o]/r[s+6*s];c=6;do{h=6-c,r[h+6*o]=r[h+6*o]-r[h+6*s]*p}while(--c)}while(o--)}while(--s);s=2;do{const p=1/r[s+6*s];c=6;do{h=6-c,r[h+6*s]=r[h+6*s]*p}while(--c)}while(s--);s=2;do{o=2;do{if(h=r[3+o+6*s],isNaN(h)||h===1/0)throw"Could not reverse! A=["+this.toString()+"]";e.e(s,o,h)}while(o--)}while(s--);return e}setRotationFromQuaternion(e){const t=e.x,i=e.y,r=e.z,s=e.w,o=t+t,a=i+i,l=r+r,c=t*o,u=t*a,h=t*l,p=i*a,g=i*l,m=r*l,w=s*o,x=s*a,H=s*l,I=this.elements;return I[0]=1-(p+m),I[1]=u-H,I[2]=h+x,I[3]=u+H,I[4]=1-(c+m),I[5]=g-w,I[6]=h-x,I[7]=g+w,I[8]=1-(c+p),this}transpose(e=new ru){const t=this.elements,i=e.elements;let r;return i[0]=t[0],i[4]=t[4],i[8]=t[8],r=t[1],i[1]=t[3],i[3]=r,r=t[2],i[2]=t[6],i[6]=r,r=t[5],i[5]=t[7],i[7]=r,e}}const Oge=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];class ce{constructor(e=0,t=0,i=0){this.x=void 0,this.y=void 0,this.z=void 0,this.x=e,this.y=t,this.z=i}cross(e,t=new ce){const i=e.x,r=e.y,s=e.z,o=this.x,a=this.y,l=this.z;return t.x=a*s-l*r,t.y=l*i-o*s,t.z=o*r-a*i,t}set(e,t,i){return this.x=e,this.y=t,this.z=i,this}setZero(){this.x=this.y=this.z=0}vadd(e,t){if(!t)return new ce(this.x+e.x,this.y+e.y,this.z+e.z);t.x=e.x+this.x,t.y=e.y+this.y,t.z=e.z+this.z}vsub(e,t){if(!t)return new ce(this.x-e.x,this.y-e.y,this.z-e.z);t.x=this.x-e.x,t.y=this.y-e.y,t.z=this.z-e.z}crossmat(){return new ru([0,-this.z,this.y,this.z,0,-this.x,-this.y,this.x,0])}normalize(){const e=this.x,t=this.y,i=this.z,r=Math.sqrt(e*e+t*t+i*i);if(r>0){const s=1/r;this.x*=s,this.y*=s,this.z*=s}else this.x=0,this.y=0,this.z=0;return r}unit(e=new ce){const t=this.x,i=this.y,r=this.z;let s=Math.sqrt(t*t+i*i+r*r);return s>0?(s=1/s,e.x=t*s,e.y=i*s,e.z=r*s):(e.x=1,e.y=0,e.z=0),e}length(){const e=this.x,t=this.y,i=this.z;return Math.sqrt(e*e+t*t+i*i)}lengthSquared(){return this.dot(this)}distanceTo(e){const t=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z;return Math.sqrt((s-t)*(s-t)+(o-i)*(o-i)+(a-r)*(a-r))}distanceSquared(e){const t=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z;return(s-t)*(s-t)+(o-i)*(o-i)+(a-r)*(a-r)}scale(e,t=new ce){const r=this.y,s=this.z;return t.x=e*this.x,t.y=e*r,t.z=e*s,t}vmul(e,t=new ce){return t.x=e.x*this.x,t.y=e.y*this.y,t.z=e.z*this.z,t}addScaledVector(e,t,i=new ce){return i.x=this.x+e*t.x,i.y=this.y+e*t.y,i.z=this.z+e*t.z,i}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}isZero(){return 0===this.x&&0===this.y&&0===this.z}negate(e=new ce){return e.x=-this.x,e.y=-this.y,e.z=-this.z,e}tangents(e,t){const i=this.length();if(i>0){const r=Rge,s=1/i;r.set(this.x*s,this.y*s,this.z*s);const o=Nge;Math.abs(r.x)<.9?(o.set(1,0,0),r.cross(o,e)):(o.set(0,1,0),r.cross(o,e)),r.cross(e,t)}else e.set(1,0,0),t.set(0,1,0)}toString(){return this.x+","+this.y+","+this.z}toArray(){return[this.x,this.y,this.z]}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}lerp(e,t,i){const r=this.x,s=this.y,o=this.z;i.x=r+(e.x-r)*t,i.y=s+(e.y-s)*t,i.z=o+(e.z-o)*t}almostEquals(e,t=1e-6){return!(Math.abs(this.x-e.x)>t||Math.abs(this.y-e.y)>t||Math.abs(this.z-e.z)>t)}almostZero(e=1e-6){return!(Math.abs(this.x)>e||Math.abs(this.y)>e||Math.abs(this.z)>e)}isAntiparallelTo(e,t){return this.negate(J4),J4.almostEquals(e,t)}clone(){return new ce(this.x,this.y,this.z)}}ce.ZERO=void 0,ce.UNIT_X=void 0,ce.UNIT_Y=void 0,ce.UNIT_Z=void 0,ce.ZERO=new ce(0,0,0),ce.UNIT_X=new ce(1,0,0),ce.UNIT_Y=new ce(0,1,0),ce.UNIT_Z=new ce(0,0,1);const Rge=new ce,Nge=new ce,J4=new ce;class ur{constructor(e={}){this.lowerBound=void 0,this.upperBound=void 0,this.lowerBound=new ce,this.upperBound=new ce,e.lowerBound&&this.lowerBound.copy(e.lowerBound),e.upperBound&&this.upperBound.copy(e.upperBound)}setFromPoints(e,t,i,r){const s=this.lowerBound,o=this.upperBound,a=i;s.copy(e[0]),a&&a.vmult(s,s),o.copy(s);for(let l=1;l<e.length;l++){let c=e[l];a&&(a.vmult(c,eH),c=eH),c.x>o.x&&(o.x=c.x),c.x<s.x&&(s.x=c.x),c.y>o.y&&(o.y=c.y),c.y<s.y&&(s.y=c.y),c.z>o.z&&(o.z=c.z),c.z<s.z&&(s.z=c.z)}return t&&(t.vadd(s,s),t.vadd(o,o)),r&&(s.x-=r,s.y-=r,s.z-=r,o.x+=r,o.y+=r,o.z+=r),this}copy(e){return this.lowerBound.copy(e.lowerBound),this.upperBound.copy(e.upperBound),this}clone(){return(new ur).copy(this)}extend(e){this.lowerBound.x=Math.min(this.lowerBound.x,e.lowerBound.x),this.upperBound.x=Math.max(this.upperBound.x,e.upperBound.x),this.lowerBound.y=Math.min(this.lowerBound.y,e.lowerBound.y),this.upperBound.y=Math.max(this.upperBound.y,e.upperBound.y),this.lowerBound.z=Math.min(this.lowerBound.z,e.lowerBound.z),this.upperBound.z=Math.max(this.upperBound.z,e.upperBound.z)}overlaps(e){const t=this.lowerBound,i=this.upperBound,r=e.lowerBound,s=e.upperBound;return(r.x<=i.x&&i.x<=s.x||t.x<=s.x&&s.x<=i.x)&&(r.y<=i.y&&i.y<=s.y||t.y<=s.y&&s.y<=i.y)&&(r.z<=i.z&&i.z<=s.z||t.z<=s.z&&s.z<=i.z)}volume(){const e=this.lowerBound,t=this.upperBound;return(t.x-e.x)*(t.y-e.y)*(t.z-e.z)}contains(e){const t=this.lowerBound,i=this.upperBound,r=e.lowerBound,s=e.upperBound;return t.x<=r.x&&i.x>=s.x&&t.y<=r.y&&i.y>=s.y&&t.z<=r.z&&i.z>=s.z}getCorners(e,t,i,r,s,o,a,l){const c=this.lowerBound,u=this.upperBound;e.copy(c),t.set(u.x,c.y,c.z),i.set(u.x,u.y,c.z),r.set(c.x,u.y,u.z),s.set(u.x,c.y,u.z),o.set(c.x,u.y,c.z),a.set(c.x,c.y,u.z),l.copy(u)}toLocalFrame(e,t){const i=tH;this.getCorners(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7]);for(let p=0;8!==p;p++){const g=i[p];e.pointToLocal(g,g)}return t.setFromPoints(i)}toWorldFrame(e,t){const i=tH;this.getCorners(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7]);for(let p=0;8!==p;p++){const g=i[p];e.pointToWorld(g,g)}return t.setFromPoints(i)}overlapsRay(e){const{direction:t,from:i}=e,r=1/t.x,s=1/t.y,o=1/t.z,a=(this.lowerBound.x-i.x)*r,l=(this.upperBound.x-i.x)*r,c=(this.lowerBound.y-i.y)*s,u=(this.upperBound.y-i.y)*s,h=(this.lowerBound.z-i.z)*o,p=(this.upperBound.z-i.z)*o,g=Math.max(Math.max(Math.min(a,l),Math.min(c,u)),Math.min(h,p)),m=Math.min(Math.min(Math.max(a,l),Math.max(c,u)),Math.max(h,p));return!(m<0||g>m)}}const eH=new ce,tH=[new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce];class cs{constructor(e=0,t=0,i=0,r=1){this.x=void 0,this.y=void 0,this.z=void 0,this.w=void 0,this.x=e,this.y=t,this.z=i,this.w=r}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}toString(){return this.x+","+this.y+","+this.z+","+this.w}toArray(){return[this.x,this.y,this.z,this.w]}setFromAxisAngle(e,t){const i=Math.sin(.5*t);return this.x=e.x*i,this.y=e.y*i,this.z=e.z*i,this.w=Math.cos(.5*t),this}toAxisAngle(e=new ce){this.normalize();const t=2*Math.acos(this.w),i=Math.sqrt(1-this.w*this.w);return i<.001?(e.x=this.x,e.y=this.y,e.z=this.z):(e.x=this.x/i,e.y=this.y/i,e.z=this.z/i),[e,t]}setFromVectors(e,t){if(e.isAntiparallelTo(t)){const i=Fge;e.tangents(i,Lge),this.setFromAxisAngle(i,Math.PI)}else{const i=e.cross(t);this.x=i.x,this.y=i.y,this.z=i.z,this.w=Math.sqrt(_r(e.length(),2)*_r(t.length(),2))+e.dot(t),this.normalize()}return this}mult(e,t=new cs){const i=this.x,r=this.y,s=this.z,o=this.w,a=e.x,l=e.y,c=e.z,u=e.w;return t.x=i*u+o*a+r*c-s*l,t.y=r*u+o*l+s*a-i*c,t.z=s*u+o*c+i*l-r*a,t.w=o*u-i*a-r*l-s*c,t}inverse(e=new cs){const t=this.x,i=this.y,r=this.z,s=this.w;this.conjugate(e);const o=1/(t*t+i*i+r*r+s*s);return e.x*=o,e.y*=o,e.z*=o,e.w*=o,e}conjugate(e=new cs){return e.x=-this.x,e.y=-this.y,e.z=-this.z,e.w=this.w,e}normalize(){let e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return 0===e?(this.x=0,this.y=0,this.z=0,this.w=0):(e=1/e,this.x*=e,this.y*=e,this.z*=e,this.w*=e),this}normalizeFast(){const e=(3-(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w))/2;return 0===e?(this.x=0,this.y=0,this.z=0,this.w=0):(this.x*=e,this.y*=e,this.z*=e,this.w*=e),this}vmult(e,t=new ce){const i=e.x,r=e.y,s=e.z,o=this.x,a=this.y,l=this.z,c=this.w,u=c*i+a*s-l*r,h=c*r+l*i-o*s,p=c*s+o*r-a*i,g=-o*i-a*r-l*s;return t.x=u*c+g*-o+h*-l-p*-a,t.y=h*c+g*-a+p*-o-u*-l,t.z=p*c+g*-l+u*-a-h*-o,t}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this}toEuler(e,t="YZX"){let i,r,s;const o=this.x,a=this.y,l=this.z,c=this.w;switch(t){case"YZX":const u=o*a+l*c;if(u>.499&&(i=2*Math.atan2(o,c),r=Math.PI/2,s=0),u<-.499&&(i=-2*Math.atan2(o,c),r=-Math.PI/2,s=0),void 0===i){const h=o*o,g=l*l;i=Math.atan2(2*a*c-2*o*l,1-a*a*2-2*g),r=Math.asin(2*u),s=Math.atan2(2*o*c-2*a*l,1-2*h-2*g)}break;default:throw new Error("Euler order "+t+" not supported yet.")}e.y=i,e.z=r,e.x=s}setFromEuler(e,t,i,r="XYZ"){const s=Math.cos(e/2),o=Math.cos(t/2),a=Math.cos(i/2),l=Math.sin(e/2),c=Math.sin(t/2),u=Math.sin(i/2);return"XYZ"===r?(this.x=l*o*a+s*c*u,this.y=s*c*a-l*o*u,this.z=s*o*u+l*c*a,this.w=s*o*a-l*c*u):"YXZ"===r?(this.x=l*o*a+s*c*u,this.y=s*c*a-l*o*u,this.z=s*o*u-l*c*a,this.w=s*o*a+l*c*u):"ZXY"===r?(this.x=l*o*a-s*c*u,this.y=s*c*a+l*o*u,this.z=s*o*u+l*c*a,this.w=s*o*a-l*c*u):"ZYX"===r?(this.x=l*o*a-s*c*u,this.y=s*c*a+l*o*u,this.z=s*o*u-l*c*a,this.w=s*o*a+l*c*u):"YZX"===r?(this.x=l*o*a+s*c*u,this.y=s*c*a+l*o*u,this.z=s*o*u-l*c*a,this.w=s*o*a-l*c*u):"XZY"===r&&(this.x=l*o*a-s*c*u,this.y=s*c*a-l*o*u,this.z=s*o*u+l*c*a,this.w=s*o*a+l*c*u),this}clone(){return new cs(this.x,this.y,this.z,this.w)}slerp(e,t,i=new cs){const r=this.x,s=this.y,o=this.z,a=this.w;let p,g,m,w,x,l=e.x,c=e.y,u=e.z,h=e.w;return g=r*l+s*c+o*u+a*h,g<0&&(g=-g,l=-l,c=-c,u=-u,h=-h),1-g>1e-6?(p=Math.acos(g),m=Math.sin(p),w=Math.sin((1-t)*p)/m,x=Math.sin(t*p)/m):(w=1-t,x=t),i.x=w*r+x*l,i.y=w*s+x*c,i.z=w*o+x*u,i.w=w*a+x*h,i}integrate(e,t,i,r=new cs){const s=e.x*i.x,o=e.y*i.y,a=e.z*i.z,l=this.x,c=this.y,u=this.z,h=this.w,p=.5*t;return r.x+=p*(s*h+o*u-a*c),r.y+=p*(o*h+a*l-s*u),r.z+=p*(a*h+s*c-o*l),r.w+=p*(-s*l-o*c-a*u),r}}const Fge=new ce,Lge=new ce,kge={SPHERE:1,PLANE:2,BOX:4,COMPOUND:8,CONVEXPOLYHEDRON:16,HEIGHTFIELD:32,PARTICLE:64,CYLINDER:128,TRIMESH:256};let pn=(()=>{class n{constructor(t={}){this.id=void 0,this.type=void 0,this.boundingSphereRadius=void 0,this.collisionResponse=void 0,this.collisionFilterGroup=void 0,this.collisionFilterMask=void 0,this.material=void 0,this.body=void 0,this.id=n.idCounter++,this.type=t.type||0,this.boundingSphereRadius=0,this.collisionResponse=!t.collisionResponse||t.collisionResponse,this.collisionFilterGroup=void 0!==t.collisionFilterGroup?t.collisionFilterGroup:1,this.collisionFilterMask=void 0!==t.collisionFilterMask?t.collisionFilterMask:-1,this.material=t.material?t.material:null,this.body=null}updateBoundingSphereRadius(){throw"computeBoundingSphereRadius() not implemented for shape type "+this.type}volume(){throw"volume() not implemented for shape type "+this.type}calculateLocalInertia(t,i){throw"calculateLocalInertia() not implemented for shape type "+this.type}calculateWorldAABB(t,i,r,s){throw"calculateWorldAABB() not implemented for shape type "+this.type}}return n.idCounter=0,n.types=kge,n})();class Vi{constructor(e={}){this.position=void 0,this.quaternion=void 0,this.position=new ce,this.quaternion=new cs,e.position&&this.position.copy(e.position),e.quaternion&&this.quaternion.copy(e.quaternion)}pointToLocal(e,t){return Vi.pointToLocalFrame(this.position,this.quaternion,e,t)}pointToWorld(e,t){return Vi.pointToWorldFrame(this.position,this.quaternion,e,t)}vectorToWorldFrame(e,t=new ce){return this.quaternion.vmult(e,t),t}static pointToLocalFrame(e,t,i,r=new ce){return i.vsub(e,r),t.conjugate(iH),iH.vmult(r,r),r}static pointToWorldFrame(e,t,i,r=new ce){return t.vmult(i,r),r.vadd(e,r),r}static vectorToWorldFrame(e,t,i=new ce){return e.vmult(t,i),i}static vectorToLocalFrame(e,t,i,r=new ce){return t.w*=-1,t.vmult(i,r),t.w*=-1,r}}const iH=new cs;class Pf extends pn{constructor(e={}){const{vertices:t=[],faces:i=[],normals:r=[],axes:s,boundingSphereRadius:o}=e;super({type:pn.types.CONVEXPOLYHEDRON}),this.vertices=void 0,this.faces=void 0,this.faceNormals=void 0,this.worldVertices=void 0,this.worldVerticesNeedsUpdate=void 0,this.worldFaceNormals=void 0,this.worldFaceNormalsNeedsUpdate=void 0,this.uniqueAxes=void 0,this.uniqueEdges=void 0,this.vertices=t,this.faces=i,this.faceNormals=r,0===this.faceNormals.length&&this.computeNormals(),o?this.boundingSphereRadius=o:this.updateBoundingSphereRadius(),this.worldVertices=[],this.worldVerticesNeedsUpdate=!0,this.worldFaceNormals=[],this.worldFaceNormalsNeedsUpdate=!0,this.uniqueAxes=s?s.slice():null,this.uniqueEdges=[],this.computeEdges()}computeEdges(){const e=this.faces,t=this.vertices,i=this.uniqueEdges;i.length=0;const r=new ce;for(let s=0;s!==e.length;s++){const o=e[s],a=o.length;for(let l=0;l!==a;l++){t[o[l]].vsub(t[o[(l+1)%a]],r),r.normalize();let u=!1;for(let h=0;h!==i.length;h++)if(i[h].almostEquals(r)||i[h].almostEquals(r)){u=!0;break}u||i.push(r.clone())}}}computeNormals(){this.faceNormals.length=this.faces.length;for(let e=0;e<this.faces.length;e++){for(let r=0;r<this.faces[e].length;r++)if(!this.vertices[this.faces[e][r]])throw new Error("Vertex "+this.faces[e][r]+" not found!");const t=this.faceNormals[e]||new ce;if(this.getFaceNormal(e,t),t.negate(t),this.faceNormals[e]=t,t.dot(this.vertices[this.faces[e][0]])<0){console.error(".faceNormals["+e+"] = Vec3("+t.toString()+") looks like it points into the shape? The vertices follow. Make sure they are ordered CCW around the normal, using the right hand rule.");for(let r=0;r<this.faces[e].length;r++)console.warn(".vertices["+this.faces[e][r]+"] = Vec3("+this.vertices[this.faces[e][r]].toString()+")")}}}getFaceNormal(e,t){const i=this.faces[e];Pf.computeNormal(this.vertices[i[0]],this.vertices[i[1]],this.vertices[i[2]],t)}static computeNormal(e,t,i,r){const s=new ce,o=new ce;t.vsub(e,o),i.vsub(t,s),s.cross(o,r),r.isZero()||r.normalize()}clipAgainstHull(e,t,i,r,s,o,a,l,c){const u=new ce;let h=-1,p=-Number.MAX_VALUE;for(let m=0;m<i.faces.length;m++){u.copy(i.faceNormals[m]),s.vmult(u,u);const w=u.dot(o);w>p&&(p=w,h=m)}const g=[];for(let m=0;m<i.faces[h].length;m++){const w=i.vertices[i.faces[h][m]],x=new ce;x.copy(w),s.vmult(x,x),r.vadd(x,x),g.push(x)}h>=0&&this.clipFaceAgainstHull(o,e,t,g,a,l,c)}findSeparatingAxis(e,t,i,r,s,o,a,l){const c=new ce,u=new ce,h=new ce,p=new ce,g=new ce,m=new ce;let w=Number.MAX_VALUE;const x=this;if(x.uniqueAxes)for(let H=0;H!==x.uniqueAxes.length;H++){i.vmult(x.uniqueAxes[H],c);const I=x.testSepAxis(c,e,t,i,r,s);if(!1===I)return!1;I<w&&(w=I,o.copy(c))}else{const H=a?a.length:x.faces.length;for(let I=0;I<H;I++){c.copy(x.faceNormals[a?a[I]:I]),i.vmult(c,c);const Se=x.testSepAxis(c,e,t,i,r,s);if(!1===Se)return!1;Se<w&&(w=Se,o.copy(c))}}if(e.uniqueAxes)for(let H=0;H!==e.uniqueAxes.length;H++){s.vmult(e.uniqueAxes[H],u);const I=x.testSepAxis(u,e,t,i,r,s);if(!1===I)return!1;I<w&&(w=I,o.copy(u))}else{const H=l?l.length:e.faces.length;for(let I=0;I<H;I++){u.copy(e.faceNormals[l?l[I]:I]),s.vmult(u,u);const Se=x.testSepAxis(u,e,t,i,r,s);if(!1===Se)return!1;Se<w&&(w=Se,o.copy(u))}}for(let H=0;H!==x.uniqueEdges.length;H++){i.vmult(x.uniqueEdges[H],p);for(let I=0;I!==e.uniqueEdges.length;I++)if(s.vmult(e.uniqueEdges[I],g),p.cross(g,m),!m.almostZero()){m.normalize();const oe=x.testSepAxis(m,e,t,i,r,s);if(!1===oe)return!1;oe<w&&(w=oe,o.copy(m))}}return r.vsub(t,h),h.dot(o)>0&&o.negate(o),!0}testSepAxis(e,t,i,r,s,o){Pf.project(this,e,i,r,TR),Pf.project(t,e,s,o,AR);const l=TR[0],c=TR[1],u=AR[0],h=AR[1];if(l<h||u<c)return!1;const p=l-h,g=u-c;return p<g?p:g}calculateLocalInertia(e,t){const i=new ce,r=new ce;this.computeLocalAABB(r,i);const s=i.x-r.x,o=i.y-r.y,a=i.z-r.z;t.x=1/12*e*(2*o*2*o+2*a*2*a),t.y=1/12*e*(2*s*2*s+2*a*2*a),t.z=1/12*e*(2*o*2*o+2*s*2*s)}getPlaneConstantOfFace(e){return-this.faceNormals[e].dot(this.vertices[this.faces[e][0]])}clipFaceAgainstHull(e,t,i,r,s,o,a){const l=new ce,c=new ce,u=new ce,h=new ce,p=new ce,g=new ce,m=new ce,w=new ce,x=this,I=r,oe=[];let Se=-1,Pe=Number.MAX_VALUE;for(let Ct=0;Ct<x.faces.length;Ct++){l.copy(x.faceNormals[Ct]),i.vmult(l,l);const Zt=l.dot(e);Zt<Pe&&(Pe=Zt,Se=Ct)}if(Se<0)return;const Be=x.faces[Se];Be.connectedFaces=[];for(let Ct=0;Ct<x.faces.length;Ct++)for(let Zt=0;Zt<x.faces[Ct].length;Zt++)-1!==Be.indexOf(x.faces[Ct][Zt])&&Ct!==Se&&-1===Be.connectedFaces.indexOf(Ct)&&Be.connectedFaces.push(Ct);const He=Be.length;for(let Ct=0;Ct<He;Ct++){const Zt=x.vertices[Be[Ct]];Zt.vsub(x.vertices[Be[(Ct+1)%He]],c),u.copy(c),i.vmult(u,u),t.vadd(u,u),h.copy(this.faceNormals[Se]),i.vmult(h,h),t.vadd(h,h),u.cross(h,p),p.negate(p),g.copy(Zt),i.vmult(g,g),t.vadd(g,g);const xt=Be.connectedFaces[Ct];m.copy(this.faceNormals[xt]);const At=this.getPlaneConstantOfFace(xt);w.copy(m),i.vmult(w,w);const Ht=At-w.dot(t);for(this.clipFaceAgainstPlane(I,oe,w,Ht);I.length;)I.shift();for(;oe.length;)I.push(oe.shift())}m.copy(this.faceNormals[Se]);const vt=this.getPlaneConstantOfFace(Se);w.copy(m),i.vmult(w,w);const St=vt-w.dot(t);for(let Ct=0;Ct<I.length;Ct++){let Zt=w.dot(I[Ct])+St;if(Zt<=s&&(console.log("clamped: depth="+Zt+" to minDist="+s),Zt=s),Zt<=o){const en=I[Ct];Zt<=1e-6&&a.push({point:en,normal:w,depth:Zt})}}}clipFaceAgainstPlane(e,t,i,r){let s,o;const a=e.length;if(a<2)return t;let l=e[e.length-1],c=e[0];s=i.dot(l)+r;for(let u=0;u<a;u++){if(c=e[u],o=i.dot(c)+r,s<0)if(o<0){const h=new ce;h.copy(c),t.push(h)}else{const h=new ce;l.lerp(c,s/(s-o),h),t.push(h)}else if(o<0){const h=new ce;l.lerp(c,s/(s-o),h),t.push(h),t.push(c)}l=c,s=o}return t}computeWorldVertices(e,t){for(;this.worldVertices.length<this.vertices.length;)this.worldVertices.push(new ce);const i=this.vertices,r=this.worldVertices;for(let s=0;s!==this.vertices.length;s++)t.vmult(i[s],r[s]),e.vadd(r[s],r[s]);this.worldVerticesNeedsUpdate=!1}computeLocalAABB(e,t){const i=this.vertices;e.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),t.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(let r=0;r<this.vertices.length;r++){const s=i[r];s.x<e.x?e.x=s.x:s.x>t.x&&(t.x=s.x),s.y<e.y?e.y=s.y:s.y>t.y&&(t.y=s.y),s.z<e.z?e.z=s.z:s.z>t.z&&(t.z=s.z)}}computeWorldFaceNormals(e){const t=this.faceNormals.length;for(;this.worldFaceNormals.length<t;)this.worldFaceNormals.push(new ce);const i=this.faceNormals,r=this.worldFaceNormals;for(let s=0;s!==t;s++)e.vmult(i[s],r[s]);this.worldFaceNormalsNeedsUpdate=!1}updateBoundingSphereRadius(){let e=0;const t=this.vertices;for(let i=0;i!==t.length;i++){const r=t[i].lengthSquared();r>e&&(e=r)}this.boundingSphereRadius=Math.sqrt(e)}calculateWorldAABB(e,t,i,r){const s=this.vertices;let o,a,l,c,u,h,p=new ce;for(let g=0;g<s.length;g++){p.copy(s[g]),t.vmult(p,p),e.vadd(p,p);const m=p;(void 0===o||m.x<o)&&(o=m.x),(void 0===c||m.x>c)&&(c=m.x),(void 0===a||m.y<a)&&(a=m.y),(void 0===u||m.y>u)&&(u=m.y),(void 0===l||m.z<l)&&(l=m.z),(void 0===h||m.z>h)&&(h=m.z)}i.set(o,a,l),r.set(c,u,h)}volume(){return 4*Math.PI*this.boundingSphereRadius/3}getAveragePointLocal(e=new ce){const t=this.vertices;for(let i=0;i<t.length;i++)e.vadd(t[i],e);return e.scale(1/t.length,e),e}transformAllPoints(e,t){const i=this.vertices.length,r=this.vertices;if(t){for(let s=0;s<i;s++){const o=r[s];t.vmult(o,o)}for(let s=0;s<this.faceNormals.length;s++){const o=this.faceNormals[s];t.vmult(o,o)}}if(e)for(let s=0;s<i;s++){const o=r[s];o.vadd(e,o)}}pointIsInside(e){const t=this.vertices,i=this.faces,r=this.faceNormals,s=new ce;this.getAveragePointLocal(s);for(let o=0;o<this.faces.length;o++){let a=r[o];const l=t[i[o][0]],c=new ce;e.vsub(l,c);const u=a.dot(c),h=new ce;s.vsub(l,h);const p=a.dot(h);if(u<0&&p>0||u>0&&p<0)return!1}return-1}static project(e,t,i,r,s){const o=e.vertices.length,a=Bge;let l=0,c=0;const u=Vge,h=e.vertices;u.setZero(),Vi.vectorToLocalFrame(i,r,t,a),Vi.pointToLocalFrame(i,r,u,u);const p=u.dot(a);c=l=h[0].dot(a);for(let g=1;g<o;g++){const m=h[g].dot(a);m>l&&(l=m),m<c&&(c=m)}if(c-=p,l-=p,c>l){const g=c;c=l,l=g}s[0]=l,s[1]=c}}const TR=[],AR=[],Bge=new ce,Vge=new ce;class KS extends pn{constructor(e){super({type:pn.types.BOX}),this.halfExtents=void 0,this.convexPolyhedronRepresentation=void 0,this.halfExtents=e,this.convexPolyhedronRepresentation=null,this.updateConvexPolyhedronRepresentation(),this.updateBoundingSphereRadius()}updateConvexPolyhedronRepresentation(){const e=this.halfExtents.x,t=this.halfExtents.y,i=this.halfExtents.z,r=ce,s=[new r(-e,-t,-i),new r(e,-t,-i),new r(e,t,-i),new r(-e,t,-i),new r(-e,-t,i),new r(e,-t,i),new r(e,t,i),new r(-e,t,i)],a=[new r(0,0,1),new r(0,1,0),new r(1,0,0)],l=new Pf({vertices:s,faces:[[3,2,1,0],[4,5,6,7],[5,4,0,1],[2,3,7,6],[0,4,7,3],[1,2,6,5]],axes:a});this.convexPolyhedronRepresentation=l,l.material=this.material}calculateLocalInertia(e,t=new ce){return KS.calculateInertia(this.halfExtents,e,t),t}static calculateInertia(e,t,i){const r=e;i.x=1/12*t*(2*r.y*2*r.y+2*r.z*2*r.z),i.y=1/12*t*(2*r.x*2*r.x+2*r.z*2*r.z),i.z=1/12*t*(2*r.y*2*r.y+2*r.x*2*r.x)}getSideNormals(e,t){const i=e,r=this.halfExtents;if(i[0].set(r.x,0,0),i[1].set(0,r.y,0),i[2].set(0,0,r.z),i[3].set(-r.x,0,0),i[4].set(0,-r.y,0),i[5].set(0,0,-r.z),void 0!==t)for(let s=0;s!==i.length;s++)t.vmult(i[s],i[s]);return i}volume(){return 8*this.halfExtents.x*this.halfExtents.y*this.halfExtents.z}updateBoundingSphereRadius(){this.boundingSphereRadius=this.halfExtents.length()}forEachWorldCorner(e,t,i){const r=this.halfExtents,s=[[r.x,r.y,r.z],[-r.x,r.y,r.z],[-r.x,-r.y,r.z],[-r.x,-r.y,-r.z],[r.x,-r.y,-r.z],[r.x,r.y,-r.z],[-r.x,r.y,-r.z],[r.x,-r.y,r.z]];for(let o=0;o<s.length;o++)ph.set(s[o][0],s[o][1],s[o][2]),t.vmult(ph,ph),e.vadd(ph,ph),i(ph.x,ph.y,ph.z)}calculateWorldAABB(e,t,i,r){const s=this.halfExtents;su[0].set(s.x,s.y,s.z),su[1].set(-s.x,s.y,s.z),su[2].set(-s.x,-s.y,s.z),su[3].set(-s.x,-s.y,-s.z),su[4].set(s.x,-s.y,-s.z),su[5].set(s.x,s.y,-s.z),su[6].set(-s.x,s.y,-s.z),su[7].set(s.x,-s.y,s.z);const o=su[0];t.vmult(o,o),e.vadd(o,o),r.copy(o),i.copy(o);for(let a=1;a<8;a++){const l=su[a];t.vmult(l,l),e.vadd(l,l);const c=l.x,u=l.y,h=l.z;c>r.x&&(r.x=c),u>r.y&&(r.y=u),h>r.z&&(r.z=h),c<i.x&&(i.x=c),u<i.y&&(i.y=u),h<i.z&&(i.z=h)}}}const ph=new ce,su=[new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce];class gn extends class{constructor(){this._listeners=void 0}addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const i=this._listeners;return void 0===i[e]&&(i[e]=[]),i[e].includes(t)||i[e].push(t),this}hasEventListener(e,t){if(void 0===this._listeners)return!1;const i=this._listeners;return!(void 0===i[e]||!i[e].includes(t))}hasAnyEventListener(e){return void 0!==this._listeners&&void 0!==this._listeners[e]}removeEventListener(e,t){if(void 0===this._listeners)return this;const i=this._listeners;if(void 0===i[e])return this;const r=i[e].indexOf(t);return-1!==r&&i[e].splice(r,1),this}dispatchEvent(e){if(void 0===this._listeners)return this;const i=this._listeners[e.type];if(void 0!==i){e.target=this;for(let r=0,s=i.length;r<s;r++)i[r].call(this,e)}return this}}{constructor(e={}){super(),this.id=void 0,this.index=void 0,this.world=void 0,this.preStep=void 0,this.postStep=void 0,this.vlambda=void 0,this.collisionFilterGroup=void 0,this.collisionFilterMask=void 0,this.collisionResponse=void 0,this.position=void 0,this.previousPosition=void 0,this.interpolatedPosition=void 0,this.initPosition=void 0,this.velocity=void 0,this.initVelocity=void 0,this.force=void 0,this.mass=void 0,this.invMass=void 0,this.material=void 0,this.linearDamping=void 0,this.type=void 0,this.allowSleep=void 0,this.sleepState=void 0,this.sleepSpeedLimit=void 0,this.sleepTimeLimit=void 0,this.timeLastSleepy=void 0,this.wakeUpAfterNarrowphase=void 0,this.torque=void 0,this.quaternion=void 0,this.initQuaternion=void 0,this.previousQuaternion=void 0,this.interpolatedQuaternion=void 0,this.angularVelocity=void 0,this.initAngularVelocity=void 0,this.shapes=void 0,this.shapeOffsets=void 0,this.shapeOrientations=void 0,this.inertia=void 0,this.invInertia=void 0,this.invInertiaWorld=void 0,this.invMassSolve=void 0,this.invInertiaSolve=void 0,this.invInertiaWorldSolve=void 0,this.fixedRotation=void 0,this.angularDamping=void 0,this.linearFactor=void 0,this.angularFactor=void 0,this.aabb=void 0,this.aabbNeedsUpdate=void 0,this.boundingRadius=void 0,this.wlambda=void 0,this.isTrigger=void 0,this.id=gn.idCounter++,this.index=-1,this.world=null,this.preStep=null,this.postStep=null,this.vlambda=new ce,this.collisionFilterGroup="number"==typeof e.collisionFilterGroup?e.collisionFilterGroup:1,this.collisionFilterMask="number"==typeof e.collisionFilterMask?e.collisionFilterMask:-1,this.collisionResponse="boolean"!=typeof e.collisionResponse||e.collisionResponse,this.position=new ce,this.previousPosition=new ce,this.interpolatedPosition=new ce,this.initPosition=new ce,e.position&&(this.position.copy(e.position),this.previousPosition.copy(e.position),this.interpolatedPosition.copy(e.position),this.initPosition.copy(e.position)),this.velocity=new ce,e.velocity&&this.velocity.copy(e.velocity),this.initVelocity=new ce,this.force=new ce;const t="number"==typeof e.mass?e.mass:0;this.mass=t,this.invMass=t>0?1/t:0,this.material=e.material||null,this.linearDamping="number"==typeof e.linearDamping?e.linearDamping:.01,this.type=t<=0?gn.STATIC:gn.DYNAMIC,typeof e.type==typeof gn.STATIC&&(this.type=e.type),this.allowSleep=void 0===e.allowSleep||e.allowSleep,this.sleepState=gn.AWAKE,this.sleepSpeedLimit=void 0!==e.sleepSpeedLimit?e.sleepSpeedLimit:.1,this.sleepTimeLimit=void 0!==e.sleepTimeLimit?e.sleepTimeLimit:1,this.timeLastSleepy=0,this.wakeUpAfterNarrowphase=!1,this.torque=new ce,this.quaternion=new cs,this.initQuaternion=new cs,this.previousQuaternion=new cs,this.interpolatedQuaternion=new cs,e.quaternion&&(this.quaternion.copy(e.quaternion),this.initQuaternion.copy(e.quaternion),this.previousQuaternion.copy(e.quaternion),this.interpolatedQuaternion.copy(e.quaternion)),this.angularVelocity=new ce,e.angularVelocity&&this.angularVelocity.copy(e.angularVelocity),this.initAngularVelocity=new ce,this.shapes=[],this.shapeOffsets=[],this.shapeOrientations=[],this.inertia=new ce,this.invInertia=new ce,this.invInertiaWorld=new ru,this.invMassSolve=0,this.invInertiaSolve=new ce,this.invInertiaWorldSolve=new ru,this.fixedRotation=void 0!==e.fixedRotation&&e.fixedRotation,this.angularDamping=void 0!==e.angularDamping?e.angularDamping:.01,this.linearFactor=new ce(1,1,1),e.linearFactor&&this.linearFactor.copy(e.linearFactor),this.angularFactor=new ce(1,1,1),e.angularFactor&&this.angularFactor.copy(e.angularFactor),this.aabb=new ur,this.aabbNeedsUpdate=!0,this.boundingRadius=0,this.wlambda=new ce,this.isTrigger=Boolean(e.isTrigger),e.shape&&this.addShape(e.shape),this.updateMassProperties()}wakeUp(){const e=this.sleepState;this.sleepState=gn.AWAKE,this.wakeUpAfterNarrowphase=!1,e===gn.SLEEPING&&this.dispatchEvent(gn.wakeupEvent)}sleep(){this.sleepState=gn.SLEEPING,this.velocity.set(0,0,0),this.angularVelocity.set(0,0,0),this.wakeUpAfterNarrowphase=!1}sleepTick(e){if(this.allowSleep){const t=this.sleepState,i=this.velocity.lengthSquared()+this.angularVelocity.lengthSquared(),r=_r(this.sleepSpeedLimit,2);t===gn.AWAKE&&i<r?(this.sleepState=gn.SLEEPY,this.timeLastSleepy=e,this.dispatchEvent(gn.sleepyEvent)):t===gn.SLEEPY&&i>r?this.wakeUp():t===gn.SLEEPY&&e-this.timeLastSleepy>this.sleepTimeLimit&&(this.sleep(),this.dispatchEvent(gn.sleepEvent))}}updateSolveMassProperties(){this.sleepState===gn.SLEEPING||this.type===gn.KINEMATIC?(this.invMassSolve=0,this.invInertiaSolve.setZero(),this.invInertiaWorldSolve.setZero()):(this.invMassSolve=this.invMass,this.invInertiaSolve.copy(this.invInertia),this.invInertiaWorldSolve.copy(this.invInertiaWorld))}pointToLocalFrame(e,t=new ce){return e.vsub(this.position,t),this.quaternion.conjugate().vmult(t,t),t}vectorToLocalFrame(e,t=new ce){return this.quaternion.conjugate().vmult(e,t),t}pointToWorldFrame(e,t=new ce){return this.quaternion.vmult(e,t),t.vadd(this.position,t),t}vectorToWorldFrame(e,t=new ce){return this.quaternion.vmult(e,t),t}addShape(e,t,i){const r=new ce,s=new cs;return t&&r.copy(t),i&&s.copy(i),this.shapes.push(e),this.shapeOffsets.push(r),this.shapeOrientations.push(s),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,e.body=this,this}removeShape(e){const t=this.shapes.indexOf(e);return-1===t?(console.warn("Shape does not belong to the body"),this):(this.shapes.splice(t,1),this.shapeOffsets.splice(t,1),this.shapeOrientations.splice(t,1),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,e.body=null,this)}updateBoundingRadius(){const e=this.shapes,t=this.shapeOffsets,i=e.length;let r=0;for(let s=0;s!==i;s++){const o=e[s];o.updateBoundingSphereRadius();const a=t[s].length(),l=o.boundingSphereRadius;a+l>r&&(r=a+l)}this.boundingRadius=r}updateAABB(){const e=this.shapes,t=this.shapeOffsets,i=this.shapeOrientations,r=e.length,s=jge,o=Uge,a=this.quaternion,l=this.aabb,c=zge;for(let u=0;u!==r;u++){const h=e[u];a.vmult(t[u],s),s.vadd(this.position,s),a.mult(i[u],o),h.calculateWorldAABB(s,o,c.lowerBound,c.upperBound),0===u?l.copy(c):l.extend(c)}this.aabbNeedsUpdate=!1}updateInertiaWorld(e){const t=this.invInertia;if(t.x!==t.y||t.y!==t.z||e){const i=Hge,r=Gge;i.setRotationFromQuaternion(this.quaternion),i.transpose(r),i.scale(t,i),i.mmult(r,this.invInertiaWorld)}}applyForce(e,t=new ce){if(this.type!==gn.DYNAMIC)return;this.sleepState===gn.SLEEPING&&this.wakeUp();const i=$ge;t.cross(e,i),this.force.vadd(e,this.force),this.torque.vadd(i,this.torque)}applyLocalForce(e,t=new ce){if(this.type!==gn.DYNAMIC)return;const i=Wge,r=qge;this.vectorToWorldFrame(e,i),this.vectorToWorldFrame(t,r),this.applyForce(i,r)}applyTorque(e){this.type===gn.DYNAMIC&&(this.sleepState===gn.SLEEPING&&this.wakeUp(),this.torque.vadd(e,this.torque))}applyImpulse(e,t=new ce){if(this.type!==gn.DYNAMIC)return;this.sleepState===gn.SLEEPING&&this.wakeUp();const i=t,r=Yge;r.copy(e),r.scale(this.invMass,r),this.velocity.vadd(r,this.velocity);const s=Kge;i.cross(e,s),this.invInertiaWorld.vmult(s,s),this.angularVelocity.vadd(s,this.angularVelocity)}applyLocalImpulse(e,t=new ce){if(this.type!==gn.DYNAMIC)return;const i=Xge,r=Qge;this.vectorToWorldFrame(e,i),this.vectorToWorldFrame(t,r),this.applyImpulse(i,r)}updateMassProperties(){const e=Zge;this.invMass=this.mass>0?1/this.mass:0;const t=this.inertia,i=this.fixedRotation;this.updateAABB(),e.set((this.aabb.upperBound.x-this.aabb.lowerBound.x)/2,(this.aabb.upperBound.y-this.aabb.lowerBound.y)/2,(this.aabb.upperBound.z-this.aabb.lowerBound.z)/2),KS.calculateInertia(e,this.mass,t),this.invInertia.set(t.x>0&&!i?1/t.x:0,t.y>0&&!i?1/t.y:0,t.z>0&&!i?1/t.z:0),this.updateInertiaWorld(!0)}getVelocityAtWorldPoint(e,t){const i=new ce;return e.vsub(this.position,i),this.angularVelocity.cross(i,t),this.velocity.vadd(t,t),t}integrate(e,t,i){if(this.previousPosition.copy(this.position),this.previousQuaternion.copy(this.quaternion),this.type!==gn.DYNAMIC&&this.type!==gn.KINEMATIC||this.sleepState===gn.SLEEPING)return;const r=this.velocity,s=this.angularVelocity,o=this.position,a=this.force,l=this.torque,c=this.quaternion,h=this.invInertiaWorld,p=this.linearFactor,g=this.invMass*e;r.x+=a.x*g*p.x,r.y+=a.y*g*p.y,r.z+=a.z*g*p.z;const m=h.elements,w=this.angularFactor,x=l.x*w.x,H=l.y*w.y,I=l.z*w.z;s.x+=e*(m[0]*x+m[1]*H+m[2]*I),s.y+=e*(m[3]*x+m[4]*H+m[5]*I),s.z+=e*(m[6]*x+m[7]*H+m[8]*I),o.x+=r.x*e,o.y+=r.y*e,o.z+=r.z*e,c.integrate(this.angularVelocity,e,this.angularFactor,c),t&&(i?c.normalizeFast():c.normalize()),this.aabbNeedsUpdate=!0,this.updateInertiaWorld()}}gn.idCounter=0,gn.COLLIDE_EVENT_NAME="collide",gn.DYNAMIC=1,gn.STATIC=2,gn.KINEMATIC=4,gn.AWAKE=0,gn.SLEEPY=1,gn.SLEEPING=2,gn.wakeupEvent={type:"wakeup"},gn.sleepyEvent={type:"sleepy"},gn.sleepEvent={type:"sleep"};const jge=new ce,Uge=new cs,zge=new ur,Hge=new ru,Gge=new ru,$ge=new ce,Wge=new ce,qge=new ce,Yge=new ce,Kge=new ce,Xge=new ce,Qge=new ce,Zge=new ce;new ce,new ce;class XS{constructor(){this.rayFromWorld=void 0,this.rayToWorld=void 0,this.hitNormalWorld=void 0,this.hitPointWorld=void 0,this.hasHit=void 0,this.shape=void 0,this.body=void 0,this.hitFaceIndex=void 0,this.distance=void 0,this.shouldStop=void 0,this.rayFromWorld=new ce,this.rayToWorld=new ce,this.hitNormalWorld=new ce,this.hitPointWorld=new ce,this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}reset(){this.rayFromWorld.setZero(),this.rayToWorld.setZero(),this.hitNormalWorld.setZero(),this.hitPointWorld.setZero(),this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}abort(){this.shouldStop=!0}set(e,t,i,r,s,o,a){this.rayFromWorld.copy(e),this.rayToWorld.copy(t),this.hitNormalWorld.copy(i),this.hitPointWorld.copy(r),this.shape=s,this.body=o,this.distance=a}}let rH,sH,oH,aH,lH,cH,uH;rH=pn.types.SPHERE,sH=pn.types.PLANE,oH=pn.types.BOX,aH=pn.types.CYLINDER,lH=pn.types.CONVEXPOLYHEDRON,cH=pn.types.HEIGHTFIELD,uH=pn.types.TRIMESH;class _s{get[rH](){return this._intersectSphere}get[sH](){return this._intersectPlane}get[oH](){return this._intersectBox}get[aH](){return this._intersectConvex}get[lH](){return this._intersectConvex}get[cH](){return this._intersectHeightfield}get[uH](){return this._intersectTrimesh}constructor(e=new ce,t=new ce){this.from=void 0,this.to=void 0,this.direction=void 0,this.precision=void 0,this.checkCollisionResponse=void 0,this.skipBackfaces=void 0,this.collisionFilterMask=void 0,this.collisionFilterGroup=void 0,this.mode=void 0,this.result=void 0,this.hasHit=void 0,this.callback=void 0,this.from=e.clone(),this.to=t.clone(),this.direction=new ce,this.precision=1e-4,this.checkCollisionResponse=!0,this.skipBackfaces=!1,this.collisionFilterMask=-1,this.collisionFilterGroup=-1,this.mode=_s.ANY,this.result=new XS,this.hasHit=!1,this.callback=i=>{}}intersectWorld(e,t){return this.mode=t.mode||_s.ANY,this.result=t.result||new XS,this.skipBackfaces=!!t.skipBackfaces,this.collisionFilterMask=void 0!==t.collisionFilterMask?t.collisionFilterMask:-1,this.collisionFilterGroup=void 0!==t.collisionFilterGroup?t.collisionFilterGroup:-1,this.checkCollisionResponse=void 0===t.checkCollisionResponse||t.checkCollisionResponse,t.from&&this.from.copy(t.from),t.to&&this.to.copy(t.to),this.callback=t.callback||(()=>{}),this.hasHit=!1,this.result.reset(),this.updateDirection(),this.getAABB(dH),OR.length=0,e.broadphase.aabbQuery(e,dH,OR),this.intersectBodies(OR),this.hasHit}intersectBody(e,t){t&&(this.result=t,this.updateDirection());const i=this.checkCollisionResponse;if(i&&!e.collisionResponse||0==(this.collisionFilterGroup&e.collisionFilterMask)||0==(e.collisionFilterGroup&this.collisionFilterMask))return;const r=sme,s=ome;for(let o=0,a=e.shapes.length;o<a;o++){const l=e.shapes[o];if((!i||l.collisionResponse)&&(e.quaternion.mult(e.shapeOrientations[o],s),e.quaternion.vmult(e.shapeOffsets[o],r),r.vadd(e.position,r),this.intersectShape(l,s,r,e),this.result.shouldStop))break}}intersectBodies(e,t){t&&(this.result=t,this.updateDirection());for(let i=0,r=e.length;!this.result.shouldStop&&i<r;i++)this.intersectBody(e[i])}updateDirection(){this.to.vsub(this.from,this.direction),this.direction.normalize()}intersectShape(e,t,i,r){if(function(n,e,t){t.vsub(n,Ff);const i=Ff.dot(e);return e.scale(i,ZS),ZS.vadd(n,ZS),t.distanceTo(ZS)}(this.from,this.direction,i)>e.boundingSphereRadius)return;const a=this[e.type];a&&a.call(this,e,t,i,r,e)}_intersectBox(e,t,i,r,s){return this._intersectConvex(e.convexPolyhedronRepresentation,t,i,r,s)}_intersectPlane(e,t,i,r,s){const o=this.from,a=this.to,l=this.direction,c=new ce(0,0,1);t.vmult(c,c);const u=new ce;o.vsub(i,u);const h=u.dot(c);if(a.vsub(i,u),h*u.dot(c)>0||o.distanceTo(a)<h)return;const g=c.dot(l);if(Math.abs(g)<this.precision)return;const m=new ce,w=new ce,x=new ce;o.vsub(i,m);const H=-c.dot(m)/g;l.scale(H,w),o.vadd(w,x),this.reportIntersection(c,x,s,r,-1)}getAABB(e){const{lowerBound:t,upperBound:i}=e,r=this.to,s=this.from;t.x=Math.min(r.x,s.x),t.y=Math.min(r.y,s.y),t.z=Math.min(r.z,s.z),i.x=Math.max(r.x,s.x),i.y=Math.max(r.y,s.y),i.z=Math.max(r.z,s.z)}_intersectHeightfield(e,t,i,r,s){const o=ame;o.from.copy(this.from),o.to.copy(this.to),Vi.pointToLocalFrame(i,t,o.from,o.from),Vi.pointToLocalFrame(i,t,o.to,o.to),o.updateDirection();const a=lme;let l,c,u,h;l=c=0,u=h=e.data.length-1;const p=new ur;o.getAABB(p),e.getIndexOfPosition(p.lowerBound.x,p.lowerBound.y,a,!0),l=Math.max(l,a[0]),c=Math.max(c,a[1]),e.getIndexOfPosition(p.upperBound.x,p.upperBound.y,a,!0),u=Math.min(u,a[0]+1),h=Math.min(h,a[1]+1);for(let g=l;g<u;g++)for(let m=c;m<h;m++){if(this.result.shouldStop)return;if(e.getAabbAtIndex(g,m,p),p.overlapsRay(o)){if(e.getConvexTrianglePillar(g,m,!1),Vi.pointToWorldFrame(i,t,e.pillarOffset,QS),this._intersectConvex(e.pillarConvex,t,QS,r,s,hH),this.result.shouldStop)return;e.getConvexTrianglePillar(g,m,!0),Vi.pointToWorldFrame(i,t,e.pillarOffset,QS),this._intersectConvex(e.pillarConvex,t,QS,r,s,hH)}}}_intersectSphere(e,t,i,r,s){const o=this.from,a=this.to,l=e.radius,c=_r(a.x-o.x,2)+_r(a.y-o.y,2)+_r(a.z-o.z,2),u=2*((a.x-o.x)*(o.x-i.x)+(a.y-o.y)*(o.y-i.y)+(a.z-o.z)*(o.z-i.z)),h=_r(o.x-i.x,2)+_r(o.y-i.y,2)+_r(o.z-i.z,2)-_r(l,2),p=_r(u,2)-4*c*h,g=cme,m=ume;if(!(p<0))if(0===p)o.lerp(a,p,g),g.vsub(i,m),m.normalize(),this.reportIntersection(m,g,s,r,-1);else{const w=(-u-Math.sqrt(p))/(2*c),x=(-u+Math.sqrt(p))/(2*c);if(w>=0&&w<=1&&(o.lerp(a,w,g),g.vsub(i,m),m.normalize(),this.reportIntersection(m,g,s,r,-1)),this.result.shouldStop)return;x>=0&&x<=1&&(o.lerp(a,x,g),g.vsub(i,m),m.normalize(),this.reportIntersection(m,g,s,r,-1))}}_intersectConvex(e,t,i,r,s,o){const a=dme,l=fH,c=o&&o.faceList||null,u=e.faces,h=e.vertices,p=e.faceNormals,g=this.direction,m=this.from,x=m.distanceTo(this.to),H=c?c.length:u.length,I=this.result;for(let oe=0;!I.shouldStop&&oe<H;oe++){const Se=c?c[oe]:oe,Pe=u[Se],Be=p[Se],He=t,vt=i;l.copy(h[Pe[0]]),He.vmult(l,l),l.vadd(vt,l),l.vsub(m,l),He.vmult(Be,a);const St=g.dot(a);if(Math.abs(St)<this.precision)continue;const Ct=a.dot(l)/St;if(!(Ct<0)){g.scale(Ct,fa),fa.vadd(m,fa),dc.copy(h[Pe[0]]),He.vmult(dc,dc),vt.vadd(dc,dc);for(let Zt=1;!I.shouldStop&&Zt<Pe.length-1;Zt++){ou.copy(h[Pe[Zt]]),au.copy(h[Pe[Zt+1]]),He.vmult(ou,ou),He.vmult(au,au),vt.vadd(ou,ou),vt.vadd(au,au);const en=fa.distanceTo(m);!_s.pointInTriangle(fa,dc,ou,au)&&!_s.pointInTriangle(fa,ou,dc,au)||en>x||this.reportIntersection(a,fa,s,r,Se)}}}}_intersectTrimesh(e,t,i,r,s,o){const a=hme,l=yme,c=vme,u=fH,h=fme,p=pme,g=gme,m=_me,w=mme,x=e.indices,H=this.from,I=this.to,oe=this.direction;c.position.copy(i),c.quaternion.copy(t),Vi.vectorToLocalFrame(i,t,oe,h),Vi.pointToLocalFrame(i,t,H,p),Vi.pointToLocalFrame(i,t,I,g),g.x*=e.scale.x,g.y*=e.scale.y,g.z*=e.scale.z,p.x*=e.scale.x,p.y*=e.scale.y,p.z*=e.scale.z,g.vsub(p,h),h.normalize();const Se=p.distanceSquared(g);e.tree.rayQuery(this,c,l);for(let Pe=0,Be=l.length;!this.result.shouldStop&&Pe!==Be;Pe++){const He=l[Pe];e.getNormal(He,a),e.getVertex(x[3*He],dc),dc.vsub(p,u);const vt=h.dot(a),St=a.dot(u)/vt;if(St<0)continue;h.scale(St,fa),fa.vadd(p,fa),e.getVertex(x[3*He+1],ou),e.getVertex(x[3*He+2],au);const Ct=fa.distanceSquared(p);!_s.pointInTriangle(fa,ou,dc,au)&&!_s.pointInTriangle(fa,dc,ou,au)||Ct>Se||(Vi.vectorToWorldFrame(t,a,w),Vi.pointToWorldFrame(i,t,fa,m),this.reportIntersection(w,m,s,r,He))}l.length=0}reportIntersection(e,t,i,r,s){const o=this.from,a=this.to,l=o.distanceTo(t),c=this.result;if(!(this.skipBackfaces&&e.dot(this.direction)>0))switch(c.hitFaceIndex=void 0!==s?s:-1,this.mode){case _s.ALL:this.hasHit=!0,c.set(o,a,e,t,i,r,l),c.hasHit=!0,this.callback(c);break;case _s.CLOSEST:(l<c.distance||!c.hasHit)&&(this.hasHit=!0,c.hasHit=!0,c.set(o,a,e,t,i,r,l));break;case _s.ANY:this.hasHit=!0,c.hasHit=!0,c.set(o,a,e,t,i,r,l),c.shouldStop=!0}}static pointInTriangle(e,t,i,r){r.vsub(t,Ff),i.vsub(t,W0),e.vsub(t,RR);const s=Ff.dot(Ff),o=Ff.dot(W0),a=Ff.dot(RR),l=W0.dot(W0),c=W0.dot(RR);let u,h;return(u=l*a-o*c)>=0&&(h=s*c-o*a)>=0&&u+h<s*l-o*o}}_s.CLOSEST=1,_s.ANY=2,_s.ALL=4;const dH=new ur,OR=[],W0=new ce,RR=new ce,sme=new ce,ome=new cs,fa=new ce,dc=new ce,ou=new ce,au=new ce,hH={faceList:[0]},QS=new ce,ame=new _s,lme=[],cme=new ce,ume=new ce,dme=new ce,fH=new ce,hme=new ce,fme=new ce,pme=new ce,gme=new ce,mme=new ce,_me=new ce;new ur;const yme=[],vme=new Vi,Ff=new ce,ZS=new ce;let MH,DH,IH,OH,RH,NH,PH,FH,LH,kH,BH,VH,jH,UH,zH,HH,GH,$H,WH,qH,YH,KH,XH,QH,ZH;new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new _s,new ce,new ce,new ce(1,0,0),new ce(0,1,0),new ce(0,0,1),new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ur,new ce,new ur,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ur,new ce,new Vi,new ur;const Tr={sphereSphere:pn.types.SPHERE,spherePlane:pn.types.SPHERE|pn.types.PLANE,boxBox:pn.types.BOX|pn.types.BOX,sphereBox:pn.types.SPHERE|pn.types.BOX,planeBox:pn.types.PLANE|pn.types.BOX,convexConvex:pn.types.CONVEXPOLYHEDRON,sphereConvex:pn.types.SPHERE|pn.types.CONVEXPOLYHEDRON,planeConvex:pn.types.PLANE|pn.types.CONVEXPOLYHEDRON,boxConvex:pn.types.BOX|pn.types.CONVEXPOLYHEDRON,sphereHeightfield:pn.types.SPHERE|pn.types.HEIGHTFIELD,boxHeightfield:pn.types.BOX|pn.types.HEIGHTFIELD,convexHeightfield:pn.types.CONVEXPOLYHEDRON|pn.types.HEIGHTFIELD,sphereParticle:pn.types.PARTICLE|pn.types.SPHERE,planeParticle:pn.types.PLANE|pn.types.PARTICLE,boxParticle:pn.types.BOX|pn.types.PARTICLE,convexParticle:pn.types.PARTICLE|pn.types.CONVEXPOLYHEDRON,cylinderCylinder:pn.types.CYLINDER,sphereCylinder:pn.types.SPHERE|pn.types.CYLINDER,planeCylinder:pn.types.PLANE|pn.types.CYLINDER,boxCylinder:pn.types.BOX|pn.types.CYLINDER,convexCylinder:pn.types.CONVEXPOLYHEDRON|pn.types.CYLINDER,heightfieldCylinder:pn.types.HEIGHTFIELD|pn.types.CYLINDER,particleCylinder:pn.types.PARTICLE|pn.types.CYLINDER,sphereTrimesh:pn.types.SPHERE|pn.types.TRIMESH,planeTrimesh:pn.types.PLANE|pn.types.TRIMESH};MH=Tr.sphereSphere,DH=Tr.spherePlane,IH=Tr.boxBox,OH=Tr.sphereBox,RH=Tr.planeBox,NH=Tr.convexConvex,PH=Tr.sphereConvex,FH=Tr.planeConvex,LH=Tr.boxConvex,kH=Tr.sphereHeightfield,BH=Tr.boxHeightfield,VH=Tr.convexHeightfield,jH=Tr.sphereParticle,UH=Tr.planeParticle,zH=Tr.boxParticle,HH=Tr.convexParticle,GH=Tr.cylinderCylinder,$H=Tr.sphereCylinder,WH=Tr.planeCylinder,qH=Tr.boxCylinder,YH=Tr.convexCylinder,KH=Tr.heightfieldCylinder,XH=Tr.particleCylinder,QH=Tr.sphereTrimesh,ZH=Tr.planeTrimesh,new ce,new ce,new ce,new ce,new ce,new cs,new cs,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ur,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new cs,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ur,new _s;const Ks=globalThis.performance||{};if(!Ks.now){let n=Date.now();Ks.timing&&Ks.timing.navigationStart&&(n=Ks.timing.navigationStart),Ks.now=()=>Date.now()-n}var Vf=nt(517);class Fr extends se{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return t&&!t.closed&&e.next(this._value),t}getValue(){if(this.hasError)throw this.thrownError;if(this.closed)throw new G;return this._value}next(e){super.next(this._value=e)}}function am(n,e,t){e||(e=new Wn(Wn.IDENTITY));const i=new Wn(Wn.IDENTITY);if(!n)return!0;if(n.matrix)i.copy(n.matrix);else{if(i.identity(),n.translation&&i.translate(n.translation),n.rotation){const s=new Wn(Wn.IDENTITY).fromQuaternion(n.rotation);i.multiplyRight(s)}n.scale&&i.scale(n.scale)}const r=new Wn(e).multiplyRight(i);if(!1===t(n,r,e))return!1;for(const s of n.nodes||n.children||[])if(!1===am(s,r,t))return!1;return!0}function r8(){QU([I4,im])}function s8(n,e){const t=e.nodes.find(i=>i.name===n);if(t){let i=!1;for(const r of e.scenes)i||am(r,new Wn(Wn.IDENTITY),(s,o)=>s!==t||(s.matrix=o,s.translation=void 0,s.rotation=void 0,s.scale=void 0,i=!0,!1));return e.scene={id:n,name:n,nodes:[t]},e.scenes=[e.scene],{scene:e.scene,scenes:e.scenes}}return e}function FR(n,e){return Ni(this,void 0,void 0,function*(){const t=n.scenegraph;let i;i=e?e[t]||(e[t]=fetch(t).then(s=>s.blob())):fetch(t);const r=yield CS(i,im,{DracoLoader:oR,gltf:{decompressMeshes:!0,postProcess:!0}});return s8(n.scenegraphNode,r)})}function b0e(n,e){return Ni(this,void 0,void 0,function*(){return s8(n,yield e)})}function LR(n,e,t){if(e&&0!==e.length)return new lfe(Object.assign({id:n,pickable:!0,autoHighlight:!1,highlightColor:[30,136,229,255],coordinateSystem:Pi.CARTESIAN,data:e,mesh:new Ige,wireframe:!1,getTransformMatrix:i=>i.transformMatrix,getColor:i=>i.color||[255,255,255,229.5]},t))}let E0e=(()=>{class n extends uue{initializeState(){const{data:t}=this.props;this.setState({data:null!=t?t:[],zoomOpacity:.8,doCollisions:!1}),r8()}renderLayers(){const t=this.state,i=t.data.filter(l=>!l.scenegraph&&!l.wireframe&&l.unpickable),r=t.data.filter(l=>!l.scenegraph&&!l.wireframe&&!l.unpickable),s=t.data.filter(l=>!l.scenegraph&&l.wireframe),o=t.data.filter(l=>!!l.scenegraph);t.doCollisions&&function(n){Ni(this,void 0,void 0,function*(){console.log("Starting Collisioning");const e=n.filter(o=>!o.scenegraph&&!o.wireframe).map(o=>{const a=new Wn(o.transformMatrix),l=a.transformAsPoint([-1,-1,-1],[]),c=a.transformAsPoint([1,1,1],[]);return{"@id":o["@id"],name:o.tooltip,entityId:o.entityId,bbox:new ur({lowerBound:new ce(...l.map((u,h)=>Math.min(u,c[h]))),upperBound:new ce(...c.map((u,h)=>Math.max(u,l[h])))})}}),t=[];for(const o of n.filter(a=>!!a.scenegraph)){const a=yield TS(o.scenegraph,im,{DracoLoader:oR,decompress:!0,postProcess:!0});for(const l of a.scenes)am(l,new Wn(o.transformMatrix),(c,u)=>{if(c.mesh&&c.mesh.primitives&&c.mesh.primitives.length>0)for(const h of c.mesh.primitives)if(h.attributes.POSITION&&h.attributes.POSITION.min){const p=u.transformAsPoint(h.attributes.POSITION.min,[]),g=u.transformAsPoint(h.attributes.POSITION.max,[]);t.push({"@id":o["@id"],name:c.name,entityId:o.entityId,bbox:new ur({lowerBound:new ce(...p.map((m,w)=>Math.min(m,g[w]))),upperBound:new ce(...g.map((m,w)=>Math.max(m,p[w])))}),gltf:a})}return!0})}const i=[],r=[];for(const o of e){const a=[];for(const l of t)o.bbox.overlaps(l.bbox)&&a.push({"@id":l["@id"],name:l.name});a.length>0?i.push({"@id":o.entityId,name:o.name,hits:a}):r.push(o)}console.log({sourceBoxes:e,targetBoxes:t,report:i,sad:r,maxHits:Math.max(...i.map(o=>o.hits.length))});const s=[];for(const o of i){s.push({"Tissue ID":o["@id"],"Tissue Name":o.name,"Hit ID":"","Hit Name":""});for(const a of o.hits)s.push({"Tissue ID":o["@id"],"Tissue Name":o.name,"Hit ID":a["@id"],"Hit Name":a.name})}return console.log(s),i})}(t.data);const a={};for(const l of o)l.scenegraph&&l.scenegraphNode&&!Object.prototype.hasOwnProperty.call(a,l.scenegraph)&&(a[l.scenegraph]=FR({scenegraph:l.scenegraph},n.gltfCache));return[LR("cubes",i,{wireframe:!1,pickable:!1}),LR("pickableCubes",r,{wireframe:!1,pickable:!0}),LR("wireframes",s,{wireframe:!0,pickable:!1}),...o.map(l=>{var c;return new xge({id:"models-"+l["@id"],opacity:l.zoomBasedOpacity?t.zoomOpacity:void 0!==l.opacity?l.opacity:1,pickable:!l.unpickable,coordinateSystem:Pi.CARTESIAN,data:[l],scenegraph:l.scenegraphNode?b0e(l.scenegraphNode,a[l.scenegraph]):l.scenegraph,_lighting:l._lighting,getTransformMatrix:l.transformMatrix,getColor:null!==(c=l.color)&&void 0!==c?c:[0,255,0,127.5],parameters:{depthMask:!l.zoomBasedOpacity&&(void 0===l.opacity||1===l.opacity)}})})].filter(l=>!!l)}getPickingInfo(t){return t.info}}return n.layerName="BodyUILayer",n.gltfCache={},n})();function o8(n,e=[]){for(const t of n.nodes||n.children||[])e.push(t.name),o8(t,e);return e}let x0e=(()=>{class n{constructor(t){var i,r,s,o,a;this.deckProps=t,this.bodyUILayer=new E0e({}),this.nodeClickSubject=new se,this.nodeHoverStartSubject=new se,this.nodeHoverStopSubject=new se,this.sceneRotationSubject=new Fr([0,0]),this.nodeDragStartSubject=new se,this.nodeDragSubject=new se,this.nodeDragEndSubject=new se,this.nodeClick$=this.nodeClickSubject.pipe(bs()),this.nodeHoverStart$=this.nodeHoverStartSubject.pipe(bs()),this.nodeHoverStop$=this.nodeHoverStopSubject.pipe(bs()),this.sceneRotation$=this.sceneRotationSubject.pipe(bs()),this.nodeDragStart$=this.nodeDragStartSubject.pipe(bs()),this.nodeDrag$=this.nodeDragSubject.pipe(bs()),this.nodeDragEnd$=this.nodeDragEndSubject.pipe(bs());const l=Object.assign(Object.assign({},t),{views:["orthographic"===t.camera?new Eue({flipY:!1,near:-1e3}):new Cue({orbitAxis:"Y"})],controller:void 0===t.interactive||t.interactive,layers:[this.bodyUILayer],onHover:this._onHover,onClick:this._onClick,onViewStateChange:this._onViewStateChange,onDragStart:this._onDragStart,onDrag:this._onDrag,onDragEnd:this._onDragEnd,getCursor:c=>{var u;return null!==(u=this.cursor)&&void 0!==u?u:c.isDragging?"grabbing":"grab"}});t.legacyLighting&&(l.effects=[new xO({ambientLight:new az({color:[255,255,255],intensity:10})})]),this.deck=new kS(l),this.deck.setProps({viewState:{orbitAxis:"Y",minRotationX:null!==(i=t.minRotationX)&&void 0!==i?i:-15,maxRotationX:null!==(r=t.maxRotationX)&&void 0!==r?r:15,target:null!==(s=t.target)&&void 0!==s?s:[.5,.5,0],rotationX:0,rotationOrbit:null!==(o=t.rotation)&&void 0!==o?o:0,zoom:null!==(a=t.zoom)&&void 0!==a?a:9.5,camera:t.camera}}),t.rotation&&this.sceneRotationSubject.next([t.rotation,0])}initialize(){return Ni(this,void 0,void 0,function*(){for(;!this.bodyUILayer.state;)yield new Promise(t=>{setTimeout(t,200)})})}finalize(){this.deck.finalize()}setScene(t){if((null==t?void 0:t.length)>0){let i=this.bodyUILayer.state.zoomOpacity,r=!1;for(const s of t)s.zoomToOnLoad&&(this.zoomTo(s),r=!0);i=r?.05:i,this.deckProps.debugSceneNodeProcessing?this.debugSceneNodeProcessing(t,i):this.bodyUILayer.setState({data:t,zoomOpacity:i})}}debugSceneNodeProcessing(t,i){const r="https://hubmapconsortium.github.io/ccf-3d-reference-object-library/VH_Female/United/VHF_United_Color.glb",s=new Wn([.076,0,0,0,0,.076,16875389974302382e-33,0,0,-16875389974302382e-33,.076,0,.49,.034,.11,1]);(function(n,e,t){return Ni(this,void 0,void 0,function*(){r8();const i=yield FR({scenegraph:n,scenegraphNode:"VHF_Kidney_L_Low1"}),r={},s=[];for(const o of i.scenes)am(o,e=new Wn(e||Wn.IDENTITY),(a,l)=>{const c={"@id":a.name||a.id,"@type":"ProcessedNode",transformMatrix:new Wn(l),wireframe:!0,node:a};if(s.push({"@id":`GLTF:${c["@id"]}`,"@type":"GLTFNode",scenegraph:n,scenegraphNode:c["@id"],transformMatrix:new Wn(e||Wn.IDENTITY),tooltip:a.name||a.id,color:[255,255,255,255],_lighting:"pbr",zoomBasedOpacity:!0,node:a}),a.mesh&&a.mesh.primitives&&a.mesh.primitives.length>0)for(const u of a.mesh.primitives)if(u.attributes.POSITION&&u.attributes.POSITION.min){const h=l.transformAsPoint(u.attributes.POSITION.min,[]),p=l.transformAsPoint(u.attributes.POSITION.max,[]);c.bbox=new ur({lowerBound:new ce(...h.map((g,m)=>Math.min(g,p[m]))),upperBound:new ce(...p.map((g,m)=>Math.max(g,h[m])))})}return r[c["@id"]]=c,!0});for(const o of Object.values(r).filter(a=>!a.bbox)){for(const a of o8(o.node).map(l=>r[l]).filter(l=>l.bbox))o.bbox?o.bbox.extend(a.bbox):o.bbox=a.bbox.clone();o.bbox||delete r[o["@id"]]}for(const o of Object.values(r)){const a=o.bbox.lowerBound,u=(o.size=o.bbox.upperBound.clone().vsub(a)).clone().vmul(new ce(.5,.5,.5)),h=o.center=a.clone().vadd(u);o.transformMatrix=new Wn(Wn.IDENTITY).translate(h.toArray()).scale(u.toArray())}for(const o of s)r[o["@id"]]=o;return r})})(r,s).then(o=>{console.log("results",o),console.log("data",t),(t=t.concat(Object.values(o))).push({"@id":"TEST","@type":"TEST",scenegraph:r,scenegraphNode:"VHF_Kidney_R_Low",transformMatrix:s,color:[255,255,255,200],_lighting:"pbr",zoomBasedOpacity:!1}),this.bodyUILayer.setState({data:t,zoomOpacity:i})})}zoomTo(t){const i=new Wn(t.transformMatrix);this.deck.setProps({viewState:Object.assign(Object.assign({},this.deck.props.viewState),{target:i.getTranslation(),rotationX:0,rotationOrbit:0,zoom:11.5})})}setRotation(t){this.deck.setProps({viewState:Object.assign(Object.assign({},this.deck.props.viewState),{rotationOrbit:t})})}setRotationX(t){this.deck.setProps({viewState:Object.assign(Object.assign({},this.deck.props.viewState),{rotationX:t})})}setZoom(t){this.deck.setProps({viewState:Object.assign(Object.assign({},this.deck.props.viewState),{zoom:t})})}setTarget(t){this.deck.setProps({viewState:Object.assign(Object.assign({},this.deck.props.viewState),{target:t})})}setInteractive(t){this.deck.setProps({controller:t})}_onHover(t){const{lastHovered:i}=this;this.cursor=t.picked?"pointer":void 0,t.picked&&t.object&&t.object["@id"]?i!==t.object&&(i&&this.nodeHoverStopSubject.next(i),this.lastHovered=t.object,this.nodeHoverStartSubject.next(t.object)):i&&(this.nodeHoverStopSubject.next(i),this.lastHovered=void 0)}_onClick(t,i){var r,s;t.picked&&t.object&&t.object["@id"]&&this.nodeClickSubject.next({node:t.object,ctrlClick:null!==(s=null===(r=null==i?void 0:i.srcEvent)||void 0===r?void 0:r.ctrlKey)&&void 0!==s?s:void 0})}_onViewStateChange(t){var i;if(null===(i=t.interactionState)||void 0===i?void 0:i.isZooming){const r=this.bodyUILayer.state,s=Math.min(Math.max(1-(t.viewState.zoom-8.9)/2,.05),1);r.zoomOpacity!==s&&this.bodyUILayer.setState({data:r.data,zoomOpacity:s})}this.deck.setProps({viewState:Object.assign({},t.viewState)}),this.sceneRotationSubject.next([t.viewState.rotationOrbit,t.viewState.rotationX])}_onDragStart(t,i){this._dragEvent(t,i,this.nodeDragStartSubject)}_onDrag(t,i){this._dragEvent(t,i,this.nodeDragSubject)}_onDragEnd(t,i){this._dragEvent(t,i,this.nodeDragEndSubject)}_dragEvent(t,i,r){var s;(null===(s=null==t?void 0:t.object)||void 0===s?void 0:s["@id"])&&r.next({node:t.object,info:t,e:i})}}return Nr([Vf.ZP],n.prototype,"_onHover",null),Nr([Vf.ZP],n.prototype,"_onClick",null),Nr([Vf.ZP],n.prototype,"_onViewStateChange",null),Nr([Vf.ZP],n.prototype,"_onDragStart",null),Nr([Vf.ZP],n.prototype,"_onDrag",null),Nr([Vf.ZP],n.prototype,"_onDragEnd",null),n})();class a8 extends y{notifyNext(e,t,i,r,s){this.destination.next(t)}notifyError(e,t){this.destination.error(e)}notifyComplete(e){this.destination.complete()}}class C0e extends y{constructor(e,t,i){super(),this.parent=e,this.outerValue=t,this.outerIndex=i,this.index=0}_next(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)}_error(e){this.parent.notifyError(e,this),this.unsubscribe()}_complete(){this.parent.notifyComplete(this),this.unsubscribe()}}function l8(n,e,t,i,r=new C0e(n,t,i)){if(!r.closed)return e instanceof O?e.subscribe(r):Te(e)(r)}const c8={};class u8{constructor(e){this.resultSelector=e}call(e,t){return t.subscribe(new T0e(e,this.resultSelector))}}class T0e extends a8{constructor(e,t){super(e),this.resultSelector=t,this.active=0,this.values=[],this.observables=[]}_next(e){this.values.push(c8),this.observables.push(e)}_complete(){const e=this.observables,t=e.length;if(0===t)this.destination.complete();else{this.active=t,this.toRespond=t;for(let i=0;i<t;i++)this.add(l8(this,e[i],void 0,i))}}notifyComplete(e){0==(this.active-=1)&&this.destination.complete()}notifyNext(e,t,i){const r=this.values,o=this.toRespond?r[i]===c8?--this.toRespond:this.toRespond:0;r[i]=t,0===o&&(this.resultSelector?this._tryResultSelector(r):this.destination.next(r.slice()))}_tryResultSelector(e){let t;try{t=this.resultSelector.apply(this,e)}catch(i){return void this.destination.error(i)}this.destination.next(t)}}function M0e(n,e){return n===e}function D0e(n,e,t){if(null===e||null===t||e.length!==t.length)return!1;const i=e.length;for(let r=0;r<i;r++)if(!n(e[r],t[r]))return!1;return!0}function d8(n,e=M0e){let t=null,i=null;function r(){return D0e(e,t,arguments)||(i=n.apply(null,arguments)),t=arguments,i}return r.reset=function(){t=null,i=null},r}const O0e=d8(function(){const n=zM();if(!n)return!1;const e=n.injector.get(b3,null);return!!e&&e.some(i=>(i&&i.providers||[]).some(s=>s&&s.provide&&"MockNgModuleResolver"===s.provide.name||!1))});let kR=(()=>{class n{constructor(){this.bootstrap$=new xf(1)}get appBootstrapped$(){return this.bootstrap$.asObservable()}bootstrap(){this.bootstrap$.next(!0),this.bootstrap$.complete()}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const BR=new zt("INITIAL_STATE_TOKEN");let R0e=(()=>{class n{static set(t){this.value=t}static pop(){const t=this.value;return this.value={},t}}return n.value={},n})();const h8=new zt("Internals.StateContextFactory"),f8=new zt("Internals.StateFactory");function Z0(...n){if(1===n.length){const e=n[0];if(k(e))return sx(e,null);if(ie(e)&&Object.getPrototypeOf(e)===Object.prototype){const t=Object.keys(e);return sx(t.map(i=>e[i]),t)}}if("function"==typeof n[n.length-1]){const e=n.pop();return sx(n=1===n.length&&k(n[0])?n[0]:n,null).pipe(me(t=>e(...t)))}return sx(n,null)}function sx(n,e){return new O(t=>{const i=n.length;if(0===i)return void t.complete();const r=new Array(i);let s=0,o=0;for(let a=0;a<i;a++){const l=Ve(n[a]);let c=!1;t.add(l.subscribe({next:u=>{c||(c=!0,o++),r[a]=u},error:u=>t.error(u),complete:()=>{s++,(s===i||!c)&&(o===i&&t.next(e?e.reduce((u,h,p)=>(u[h]=r[p],u),{}):r),t.complete())}}))}})}function qi(n,e){return function(i){return i.lift(new N0e(n,e))}}class N0e{constructor(e,t){this.predicate=e,this.thisArg=t}call(e,t){return t.subscribe(new P0e(e,this.predicate,this.thisArg))}}class P0e extends y{constructor(e,t,i){super(e),this.predicate=t,this.thisArg=i,this.count=0}_next(e){let t;try{t=this.predicate.call(this.thisArg,e,this.count++)}catch(i){return void this.destination.error(i)}t&&this.destination.next(e)}}function ja(n,e,t){let i;return i=n&&"object"==typeof n?n:{bufferSize:n,windowTime:e,refCount:!1,scheduler:t},r=>r.lift(function({bufferSize:n=Number.POSITIVE_INFINITY,windowTime:e=Number.POSITIVE_INFINITY,refCount:t,scheduler:i}){let r,o,s=0,a=!1,l=!1;return function(u){let h;s++,!r||a?(a=!1,r=new xf(n,e,i),h=r.subscribe(this),o=u.subscribe({next(p){r.next(p)},error(p){a=!0,r.error(p)},complete(){l=!0,o=void 0,r.complete()}}),l&&(o=void 0)):h=r.subscribe(this),this.add(()=>{s--,h.unsubscribe(),h=void 0,o&&!l&&t&&0===s&&(o.unsubscribe(),o=void 0,r=void 0)})}}(i))}const p8=(()=>{function n(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return n.prototype=Object.create(Error.prototype),n})();function Gr(n){return e=>0===n?o0():e.lift(new L0e(n))}class L0e{constructor(e){if(this.total=e,this.total<0)throw new p8}call(e,t){return t.subscribe(new k0e(e,this.total))}}class k0e extends y{constructor(e,t){super(e),this.total=t,this.count=0}_next(e){const t=this.total,i=++this.count;i<=t&&(this.destination.next(e),i===t&&(this.destination.complete(),this.unsubscribe()))}}function g8(n,e){return e?t=>t.pipe(g8((i,r)=>Ve(n(i,r)).pipe(me((s,o)=>e(i,s,r,o))))):t=>t.lift(new B0e(n))}class B0e{constructor(e){this.project=e}call(e,t){return t.subscribe(new V0e(e,this.project))}}class V0e extends be{constructor(e,t){super(e),this.project=t,this.hasSubscription=!1,this.hasCompleted=!1,this.index=0}_next(e){this.hasSubscription||this.tryNext(e)}tryNext(e){let t;const i=this.index++;try{t=this.project(e,i)}catch(r){return void this.destination.error(r)}this.hasSubscription=!0,this._innerSub(t)}_innerSub(e){const t=new gt(this),i=this.destination;i.add(t);const r=N(e,t);r!==t&&i.add(r)}_complete(){this.hasCompleted=!0,this.hasSubscription||this.destination.complete(),this.unsubscribe()}notifyNext(e){this.destination.next(e)}notifyError(e){this.destination.error(e)}notifyComplete(){this.hasSubscription=!1,this.hasCompleted&&this.destination.complete()}}function ox(n=null){return e=>e.lift(new j0e(n))}class j0e{constructor(e){this.defaultValue=e}call(e,t){return t.subscribe(new U0e(e,this.defaultValue))}}class U0e extends y{constructor(e,t){super(e),this.defaultValue=t,this.isEmpty=!0}_next(e){this.isEmpty=!1,this.destination.next(e)}_complete(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()}}function fc(n){return function(t){const i=new z0e(n),r=t.lift(i);return i.caught=r}}class z0e{constructor(e){this.selector=e}call(e,t){return t.subscribe(new H0e(e,this.selector,this.caught))}}class H0e extends be{constructor(e,t,i){super(e),this.selector=t,this.caught=i}error(e){if(!this.isStopped){let t;try{t=this.selector(e,this.caught)}catch(s){return void super.error(s)}this._unsubscribeAndRecycle();const i=new gt(this);this.add(i);const r=N(t,i);r!==i&&this.add(r)}}}function us(n){return e=>e.lift(new G0e(n))}class G0e{constructor(e){this.notifier=e}call(e,t){const i=new $0e(e),r=N(this.notifier,new gt(i));return r&&!i.seenValue?(i.add(r),t.subscribe(i)):i}}class $0e extends be{constructor(e){super(e),this.seenValue=!1}notifyNext(){this.seenValue=!0,this.complete()}notifyComplete(){}}function gh(){}function dr(n,e,t){return function(r){return r.lift(new W0e(n,e,t))}}class W0e{constructor(e,t,i){this.nextOrObserver=e,this.error=t,this.complete=i}call(e,t){return t.subscribe(new q0e(e,this.nextOrObserver,this.error,this.complete))}}class q0e extends y{constructor(e,t,i,r){super(e),this._tapNext=gh,this._tapError=gh,this._tapComplete=gh,this._tapError=i||gh,this._tapComplete=r||gh,K(t)?(this._context=this,this._tapNext=t):t&&(this._context=t,this._tapNext=t.next||gh,this._tapError=t.error||gh,this._tapComplete=t.complete||gh)}_next(e){try{this._tapNext.call(this._context,e)}catch(t){return void this.destination.error(t)}this.destination.next(e)}_error(e){try{this._tapError.call(this._context,e)}catch(t){return void this.destination.error(t)}this.destination.error(e)}_complete(){try{this._tapComplete.call(this._context)}catch(e){return void this.destination.error(e)}return this.destination.complete()}}function id(n,e){return t=>t.lift(new Y0e(n,e))}class Y0e{constructor(e,t){this.compare=e,this.keySelector=t}call(e,t){return t.subscribe(new K0e(e,this.compare,this.keySelector))}}class K0e extends y{constructor(e,t,i){super(e),this.keySelector=i,this.hasKey=!1,"function"==typeof t&&(this.compare=t)}compare(e,t){return e===t}_next(e){let t;try{const{keySelector:r}=this;t=r?r(e):e}catch(r){return this.destination.error(r)}let i=!1;if(this.hasKey)try{const{compare:r}=this;i=r(this.key,t)}catch(r){return this.destination.error(r)}else this.hasKey=!0;i||(this.key=t,this.destination.next(e))}}const Ua={STATE_NAME:n=>`${n} is not a valid state name. It needs to be a valid object property name.`,STATE_NAME_PROPERTY:()=>"States must register a 'name' property",STATE_UNIQUE:(n,e,t)=>`State name '${n}' from ${e} already exists in ${t}`,STATE_DECORATOR:()=>"States must be decorated with @State() decorator",INCORRECT_PRODUCTION:()=>"Angular is running in production mode but NGXS is still running in the development mode!\nPlease set developmentMode to false on the NgxsModule options when in production mode.\nNgxsModule.forRoot(states, { developmentMode: !environment.production })",INCORRECT_DEVELOPMENT:()=>"RECOMMENDATION: Set developmentMode to true on the NgxsModule when Angular is running in development mode.\nNgxsModule.forRoot(states, { developmentMode: !environment.production })",SELECT_FACTORY_NOT_CONNECTED:()=>"You have forgotten to import the NGXS module!",ACTION_DECORATOR:()=>"@Action() decorator cannot be used with static methods",SELECTOR_DECORATOR:()=>"Selectors only work on methods",ZONE_WARNING:()=>"Your application was bootstrapped with nooped zone and your execution strategy requires an actual NgZone!\nPlease set the value of the executionStrategy property to NoopNgxsExecutionStrategy.\nNgxsModule.forRoot(states, { executionStrategy: NoopNgxsExecutionStrategy })",PATCHING_ARRAY:()=>"Patching arrays is not supported.",PATCHING_PRIMITIVE:()=>"Patching primitives is not supported.",UNDECORATED_STATE_IN_IVY:n=>`'${n}' class should be decorated with @Injectable() right after the @State() decorator`};let m8=(()=>{class n{constructor(t,i){this._ngZone=t,this._platformId=i,this.verifyZoneIsNotNooped(this._ngZone)}enter(t){return function(n){return"server"===n}(this._platformId)?this.runInsideAngular(t):this.runOutsideAngular(t)}leave(t){return this.runInsideAngular(t)}runInsideAngular(t){return vn.isInAngularZone()?t():this._ngZone.run(t)}runOutsideAngular(t){return vn.isInAngularZone()?this._ngZone.runOutsideAngular(t):t()}verifyZoneIsNotNooped(t){t instanceof vn||console.warn(Ua.ZONE_WARNING())}}return n.\u0275fac=function(t){return new(t||n)(Ie(vn),Ie(Gc))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const _8=new zt("ROOT_STATE_TOKEN"),y8=new zt("FEATURE_STATE_TOKEN"),v8=new zt("NGXS_PLUGINS"),b8=new zt("NG_TEST_MODE"),w8=new zt("NG_DEV_MODE"),rd="NGXS_META",E8="NGXS_OPTIONS_META";let jf=(()=>{class n{constructor(){this.defaultsState={},this.selectorOptions={injectContainerState:!0,suppressErrors:!0},this.compatibility={strictContentSecurityPolicy:!1},this.executionStrategy=m8}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class X0e{constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}}const S8=new zt("NGXS_EXECUTION_STRATEGY");function Uf(n){return n.constructor&&n.constructor.type?n.constructor.type:n.type}const x8=(n,e,t)=>{n=Object.assign({},n);const i=e.split("."),r=i.length-1;return i.reduce((s,o,a)=>(s[o]=a===r?t:Array.isArray(s[o])?s[o].slice():Object.assign({},s[o]),s&&s[o]),n),n},ax=(n,e)=>e.split(".").reduce((t,i)=>t&&t[i],n),jR=n=>n&&"object"==typeof n&&!Array.isArray(n),UR=(n,...e)=>{if(!e.length)return n;const t=e.shift();if(jR(n)&&jR(t))for(const i in t)jR(t[i])?(n[i]||Object.assign(n,{[i]:{}}),UR(n[i],t[i])):Object.assign(n,{[i]:t[i]});return UR(n,...e)};function J0(n){return n[rd]}function T8(n,e){const t=ax(e.currentAppState,n.path),i=ax(e.newAppState,n.path);return new X0e(t,i,!n.isInitialised)}function rve(...n){return function(n,e,t=ave){const i=function(n){return n.reduce((e,t)=>(e[Uf(t)]=!0,e),{})}(n),r=e&&function(n){return n.reduce((e,t)=>(e[t]=!0,e),{})}(e);return function(s){return s.pipe(function(n,e){return qi(t=>{const i=Uf(t.action);return n[i]&&(!e||e[t.status])})}(i,r),t())}}(n,["DISPATCHED"])}function ave(){return me(n=>n.action)}function lx(n){return e=>new O(t=>e.subscribe({next(i){n.leave(()=>t.next(i))},error(i){n.leave(()=>t.error(i))},complete(){n.leave(()=>t.complete())}}))}let cx=(()=>{class n{constructor(t){this._executionStrategy=t}enter(t){return this._executionStrategy.enter(t)}leave(t){return this._executionStrategy.leave(t)}}return n.\u0275fac=function(t){return new(t||n)(Ie(S8))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class uve extends se{constructor(){super(...arguments),this._itemQueue=[],this._busyPushingNext=!1}next(e){if(this._busyPushingNext)this._itemQueue.unshift(e);else{for(this._busyPushingNext=!0,super.next(e);this._itemQueue.length>0;){const t=this._itemQueue.pop();super.next(t)}this._busyPushingNext=!1}}}let ux=(()=>{class n extends uve{}return n.\u0275fac=function(){let e;return function(i){return(e||(e=$i(n)))(i||n)}}(),n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),dve=(()=>{class n extends O{constructor(t,i){super(r=>{const s=t.pipe(lx(i)).subscribe({next:o=>r.next(o),error:o=>r.error(o),complete:()=>r.complete()});r.add(s)})}}return n.\u0275fac=function(t){return new(t||n)(Ie(ux),Ie(cx))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const A8=n=>(...e)=>n.shift()(...e,(...i)=>A8(n)(...i));let dx=(()=>{class n extends Fr{constructor(){super({})}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),$R=(()=>{class n{constructor(t,i){this._parentManager=t,this._pluginHandlers=i,this.plugins=[],this.registerHandlers()}get rootPlugins(){return this._parentManager&&this._parentManager.plugins||this.plugins}registerHandlers(){const t=this.getPluginHandlers();this.rootPlugins.push(...t)}getPluginHandlers(){return(this._pluginHandlers||[]).map(i=>i.handle?i.handle.bind(i):i)}}return n.\u0275fac=function(t){return new(t||n)(Ie(n,12),Ie(v8,8))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),WR=(()=>{class n extends se{}return n.\u0275fac=function(){let e;return function(i){return(e||(e=$i(n)))(i||n)}}(),n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),M8=(()=>{class n{constructor(t,i,r,s,o,a){this._injector=t,this._actions=i,this._actionResults=r,this._pluginManager=s,this._stateStream=o,this._ngxsExecutionStrategy=a}dispatch(t){const i=this._ngxsExecutionStrategy.enter(()=>this.dispatchByEvents(t));return i.subscribe({error:r=>this._ngxsExecutionStrategy.leave(()=>{try{this._errorHandler=this._errorHandler||this._injector.get(na),this._errorHandler.handleError(r)}catch(s){}})}),i.pipe(lx(this._ngxsExecutionStrategy))}dispatchByEvents(t){return Array.isArray(t)?0===t.length?nn(this._stateStream.getValue()):Z0(t.map(i=>this.dispatchSingle(i))):this.dispatchSingle(t)}dispatchSingle(t){if(!Uf(t))return Ig(new Error(`This action doesn't have a type property: ${t.constructor.name}`));const r=this._stateStream.getValue();return A8([...this._pluginManager.plugins,(o,a)=>{o!==r&&this._stateStream.next(o);const l=this.getActionResultStream(a);return l.subscribe(c=>this._actions.next(c)),this._actions.next({action:a,status:"DISPATCHED"}),this.createDispatchObservable(l)}])(r,t).pipe(ja())}getActionResultStream(t){return this._actionResults.pipe(qi(i=>i.action===t&&"DISPATCHED"!==i.status),Gr(1),ja())}createDispatchObservable(t){return t.pipe(g8(i=>{switch(i.status){case"SUCCESSFUL":return nn(this._stateStream.getValue());case"ERRORED":return Ig(i.error);default:return Wc}})).pipe(ja())}}return n.\u0275fac=function(t){return new(t||n)(Ie(Un),Ie(ux),Ie(WR),Ie($R),Ie(dx),Ie(cx))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const D8=n=>{Object.freeze(n);const e="function"==typeof n,t=Object.prototype.hasOwnProperty;return Object.getOwnPropertyNames(n).forEach(function(i){t.call(n,i)&&(!e||"caller"!==i&&"callee"!==i&&"arguments"!==i)&&null!==n[i]&&("object"==typeof n[i]||"function"==typeof n[i])&&!Object.isFrozen(n[i])&&D8(n[i])}),n};let I8=(()=>{class n{constructor(t,i){this.isDevMode=t,this.isTestMode=i}}return n.\u0275fac=function(t){return new(t||n)(Ie(w8),Ie(b8))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),O8=(()=>{class n{constructor(t,i){this._host=t,this._config=i}get isIncorrectProduction(){return!this._host.isDevMode()&&this._config.developmentMode}get isIncorrectDevelopment(){return this._host.isDevMode()&&!this._config.developmentMode}verifyDevMode(){this._host.isTestMode()||(this.isIncorrectProduction?console.warn(Ua.INCORRECT_PRODUCTION()):this.isIncorrectDevelopment&&console.warn(Ua.INCORRECT_DEVELOPMENT()))}}return n.\u0275fac=function(t){return new(t||n)(Ie(I8),Ie(jf))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),cm=(()=>{class n{constructor(t,i,r,s){this._stateStream=t,this._dispatcher=i,this._config=r,s.verifyDevMode()}getRootStateOperations(){const t={getState:()=>this._stateStream.getValue(),setState:i=>this._stateStream.next(i),dispatch:i=>this._dispatcher.dispatch(i)};return this._config.developmentMode?this.ensureStateAndActionsAreImmutable(t):t}ensureStateAndActionsAreImmutable(t){return{getState:()=>t.getState(),setState:i=>{const r=D8(i);return t.setState(r)},dispatch:i=>t.dispatch(i)}}setStateToTheCurrentWithNew(t){const i=this.getRootStateOperations(),r=i.getState();i.setState(Object.assign({},r,t.defaults))}}return n.\u0275fac=function(t){return new(t||n)(Ie(dx),Ie(M8),Ie(jf),Ie(O8))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),hx=(()=>{class n{constructor(t){this._internalStateOperations=t}createStateContext(t){const i=this._internalStateOperations.getRootStateOperations();function r(l){return ax(l,t.path)}function s(l,c){const u=x8(l,t.path,c),h=t.instance;if(h.ngxsOnChanges){const p=T8(t,{currentAppState:l,newAppState:u});h.ngxsOnChanges(p)}return i.setState(u),u}function o(l,c){return s(l,c(r(l)))}return{getState:()=>r(i.getState()),patchState:l=>o(i.getState(),function(n){return e=>{if(Array.isArray(n))throw new Error(Ua.PATCHING_ARRAY());if("object"!=typeof n)throw new Error(Ua.PATCHING_PRIMITIVE());const t=Object.assign({},e);for(const i in n)t[i]=n[i];return t}}(l)),setState(l){const c=i.getState();return function(l){return"function"==typeof l}(l)?o(c,l):s(c,l)},dispatch:l=>i.dispatch(l)}}}return n.\u0275fac=function(t){return new(t||n)(Ie(cm))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class fx{static stateNameErrorMessage(e){return Ua.STATE_NAME(e)}static checkCorrectStateName(e){if(!e)throw new Error(Ua.STATE_NAME_PROPERTY());if(!this.stateNameRegex.test(e))throw new Error(this.stateNameErrorMessage(e))}static checkStateNameIsUnique(e,t){const r=this.getValidStateMeta(e).name,s=t[r];if(s&&s!==e)throw new Error(Ua.STATE_UNIQUE(r,e.name,s.name));return r}static getValidStateMeta(e){const t=J0(e);if(!t)throw new Error(Ua.STATE_DECORATOR());return t}}fx.stateNameRegex=new RegExp("^[a-zA-Z0-9_]+$");let um=(()=>{class n{constructor(t,i,r,s,o,a,l){this._injector=t,this._config=i,this._parentFactory=r,this._actions=s,this._actionResults=o,this._stateContextFactory=a,this._initialState=l,this._actionsSubscription=null,this._states=[],this._statesByName={},this._statePaths={},this.getRuntimeSelectorContext=d8(()=>{const c=this;function u(p){const g=c.statePaths[p];return g?function(n,e){return e&&e.compatibility&&e.compatibility.strictContentSecurityPolicy?function(n){const e=n.slice();return t=>e.reduce((i,r)=>i&&i[r],t)}(n):function(n){const e=n;let t="store."+e[0],i=0;const r=e.length;let s=t;for(;++i<r;)s=s+" && "+(t=t+"."+e[i]);return new Function("store","return "+s+";")}(n)}(g.split("."),c._config):null}return this._parentFactory?this._parentFactory.getRuntimeSelectorContext():{getStateGetter(p){let g=u(p);return g||((...m)=>(g||(g=u(p)),g?g(...m):void 0))},getSelectorOptions:p=>Object.assign({},c._config.selectorOptions,p||{})}})}get states(){return this._parentFactory?this._parentFactory.states:this._states}get statesByName(){return this._parentFactory?this._parentFactory.statesByName:this._statesByName}get statePaths(){return this._parentFactory?this._parentFactory.statePaths:this._statePaths}static cloneDefaults(t){let i={};return i=Array.isArray(t)?t.slice():function(n){return"object"==typeof n&&null!==n||"function"==typeof n}(t)?Object.assign({},t):void 0===t?{}:t,i}static checkStatesAreValid(t){t.forEach(fx.getValidStateMeta)}ngOnDestroy(){this._actionsSubscription.unsubscribe()}add(t){n.checkStatesAreValid(t);const{newStates:i}=this.addToStatesMap(t);if(!i.length)return[];const r=function(n){const e=t=>{const i=n.find(r=>r===t);if(!i)throw new Error(`Child state not found: ${t}. \r\nYou may have forgotten to add states to module`);return i[rd].name};return n.reduce((t,i)=>{const{name:r,children:s}=i[rd];return t[r]=(s||[]).map(e),t},{})}(i),s=function(n){const e=[],t={},i=(r,s=[])=>{Array.isArray(s)||(s=[]),s.push(r),t[r]=!0,n[r].forEach(o=>{if(s.indexOf(o)>=0)throw new Error(`Circular dependency '${o}' is required by '${r}': ${s.join(" -> ")}`);t[o]||i(o,s.slice(0))}),e.indexOf(r)<0&&e.push(r)};return Object.keys(n).forEach(r=>i(r)),e.reverse()}(r),o=function(n,e={}){const t=(i,r)=>{for(const s in i)if(i.hasOwnProperty(s)&&i[s].indexOf(r)>=0){const o=t(i,s);return null!==o?`${o}.${s}`:s}return null};for(const i in n)if(n.hasOwnProperty(i)){const r=t(n,i);e[i]=r?`${r}.${i}`:i}return e}(r),a=function(n){return n.reduce((e,t)=>(e[t[rd].name]=t,e),{})}(i),l=[];for(const c of s){const u=a[c],h=o[c],p=u[rd];this.addRuntimeInfoToMeta(p,h);const g={name:c,path:h,isInitialised:!1,actions:p.actions,instance:this._injector.get(u),defaults:n.cloneDefaults(p.defaults)};this.hasBeenMountedAndBootstrapped(c,h)||l.push(g),this.states.push(g)}return l}addAndReturnDefaults(t){const r=this.add(t||[]);return{defaults:r.reduce((o,a)=>x8(o,a.path,a.defaults),{}),states:r}}connectActionHandlers(){null===this._actionsSubscription&&(this._actionsSubscription=this._actions.pipe(qi(t=>"DISPATCHED"===t.status),V(({action:t})=>this.invokeActions(this._actions,t).pipe(me(()=>({action:t,status:"SUCCESSFUL"})),ox({action:t,status:"CANCELED"}),fc(i=>nn({action:t,status:"ERRORED",error:i}))))).subscribe(t=>this._actionResults.next(t)))}invokeActions(t,i){const r=Uf(i),s=[];for(const o of this.states){const a=o.actions[r];if(a)for(const l of a){const c=this._stateContextFactory.createStateContext(o);try{let u=o.instance[l.fn](c,i);u instanceof Promise&&(u=Ve(u)),u instanceof O?(u=u.pipe(ox({})),l.options.cancelUncompleted&&(u=u.pipe(us(t.pipe(rve(i)))))):u=nn({}).pipe(ja()),s.push(u)}catch(u){s.push(Ig(u))}}}return s.length||s.push(nn({})),Z0(s)}addToStatesMap(t){const i=[],r=this.statesByName;for(const s of t){const o=fx.checkStateNameIsUnique(s,r);!r[o]&&(i.push(s),r[o]=s)}return{newStates:i}}addRuntimeInfoToMeta(t,i){this.statePaths[t.name]=i,t.path=i}hasBeenMountedAndBootstrapped(t,i){const r=void 0!==ax(this._initialState,i);return this.statesByName[t]&&r}}return n.\u0275fac=function(t){return new(t||n)(Ie(Un),Ie(jf),Ie(n,12),Ie(ux),Ie(WR),Ie(hx),Ie(BR,8))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),qR=(()=>{class n{constructor(t,i,r){this.internalStateOperations=t,this.stateContextFactory=i,this.bootstrapper=r}ngxsBootstrap(t,i){this.internalStateOperations.getRootStateOperations().dispatch(t).pipe(qi(()=>!!i),dr(()=>this.invokeInit(i.states)),V(()=>this.bootstrapper.appBootstrapped$),qi(r=>!!r)).subscribe(()=>this.invokeBootstrap(i.states))}invokeInit(t){for(const i of t){const r=i.instance;if(r.ngxsOnChanges){const a=T8(i,{currentAppState:{},newAppState:this.internalStateOperations.getRootStateOperations().getState()});r.ngxsOnChanges(a)}r.ngxsOnInit&&r.ngxsOnInit(this.getStateContext(i)),i.isInitialised=!0}}invokeBootstrap(t){for(const i of t){const r=i.instance;r.ngxsAfterBootstrap&&r.ngxsAfterBootstrap(this.getStateContext(i))}}getStateContext(t){return this.stateContextFactory.createStateContext(t)}}return n.\u0275fac=function(t){return new(t||n)(Ie(cm),Ie(hx),Ie(kR))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();let mh=(()=>{class n{constructor(t,i,r,s,o,a){this._stateStream=t,this._internalStateOperations=i,this._config=r,this._internalExecutionStrategy=s,this._stateFactory=o,this.initStateStream(a)}dispatch(t){return this._internalStateOperations.getRootStateOperations().dispatch(t)}select(t){const i=this.getStoreBoundSelectorFn(t);return this._stateStream.pipe(me(i),fc(r=>{const{suppressErrors:s}=this._config.selectorOptions;return r instanceof TypeError&&s?nn(void 0):Ig(r)}),id(),lx(this._internalExecutionStrategy))}selectOnce(t){return this.select(t).pipe(Gr(1))}selectSnapshot(t){return this.getStoreBoundSelectorFn(t)(this._stateStream.getValue())}subscribe(t){return this._stateStream.pipe(lx(this._internalExecutionStrategy)).subscribe(t)}snapshot(){return this._internalStateOperations.getRootStateOperations().getState()}reset(t){return this._internalStateOperations.getRootStateOperations().setState(t)}getStoreBoundSelectorFn(t){return function(n){const e=function(n){return n.NGXS_SELECTOR_META}(n)||J0(n);return e&&e.makeRootSelector||(()=>n)}(t)(this._stateFactory.getRuntimeSelectorContext())}initStateStream(t){const i=this._stateStream.value;if(!i||0===Object.keys(i).length){const o=Object.keys(this._config.defaultsState).length>0?Object.assign({},this._config.defaultsState,t):t;this._stateStream.next(o)}}}return n.\u0275fac=function(t){return new(t||n)(Ie(dx),Ie(cm),Ie(jf),Ie(cx),Ie(um),Ie(BR,8))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),ev=(()=>{class n{constructor(t,i){n.store=t,n.config=i}ngOnDestroy(){n.store=null,n.config=null}}return n.\u0275fac=function(t){return new(t||n)(Ie(mh),Ie(jf))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n.store=null,n.config=null,n})();class yve{static get type(){return"@@INIT"}}class vve{constructor(e){this.addedStates=e}static get type(){return"@@UPDATE_STATE"}}const gx=new xf(1);let wve=(()=>{class n{constructor(t,i,r,s,o=[],a){!function(){try{const n=window.ng,t=!(n.probe&&n.coreTokens)&&la();gx.next(t)}catch(n){gx.next(!1)}finally{gx.complete()}}();const l=t.addAndReturnDefaults(o);i.setStateToTheCurrentWithNew(l),t.connectActionHandlers(),a.ngxsBootstrap(new yve,l)}}return n.\u0275fac=function(t){return new(t||n)(Ie(um),Ie(cm),Ie(mh),Ie(ev),Ie(_8,8),Ie(qR))},n.\u0275mod=ln({type:n}),n.\u0275inj=wt({}),n})(),Eve=(()=>{class n{constructor(t,i,r,s=[],o){const a=n.flattenStates(s),l=r.addAndReturnDefaults(a);l.states.length&&(i.setStateToTheCurrentWithNew(l),o.ngxsBootstrap(new vve(l.defaults),l))}static flattenStates(t=[]){return t.reduce((i,r)=>i.concat(r),[])}}return n.\u0275fac=function(t){return new(t||n)(Ie(mh),Ie(cm),Ie(um),Ie(y8,8),Ie(qR))},n.\u0275mod=ln({type:n}),n.\u0275inj=wt({}),n})();class pa{static forRoot(e=[],t={}){return{ngModule:wve,providers:[um,hx,dve,ux,kR,O8,I8,qR,M8,WR,cm,cx,mh,dx,ev,$R,...e,...pa.ngxsTokenProviders(e,t)]}}static forFeature(e=[]){return{ngModule:Eve,providers:[um,$R,...e,{provide:y8,multi:!0,useValue:e}]}}static ngxsTokenProviders(e,t){return[{provide:b8,useValue:O0e},{provide:w8,useValue:la},{provide:S8,useClass:t.executionStrategy||m8},{provide:_8,useValue:e},{provide:pa.ROOT_OPTIONS,useValue:t},{provide:jf,useFactory:pa.ngxsConfigFactory,deps:[pa.ROOT_OPTIONS]},{provide:dE,useFactory:pa.appBootstrapListenerFactory,multi:!0,deps:[kR]},{provide:BR,useFactory:pa.getInitialState},{provide:h8,useExisting:hx},{provide:f8,useExisting:um}]}static ngxsConfigFactory(e){return UR(new jf,e)}static appBootstrapListenerFactory(e){return()=>e.bootstrap()}static getInitialState(){return R0e.pop()}}function xve(n){return i=>{!function(n){gx.subscribe(e=>{e&&(n.\u0275prov||console.warn(Ua.UNDECORATED_STATE_IN_IVY(n.name)))})}(i);const r=i,s=function(n){if(!n.hasOwnProperty(rd)){const e={name:null,actions:{},defaults:{},path:null,makeRootSelector:t=>t.getStateGetter(e.name),children:[]};Object.defineProperty(n,rd,{value:e})}return J0(n)}(r),o=Object.getPrototypeOf(r),a=function(i){return Object.assign({},i[E8]||{},n)}(o);(function(i){const{meta:r,inheritedStateClass:s,optionsWithInheritance:o}=i,{children:a,defaults:l,name:c}=o,u="string"==typeof c?c:c&&c.getName()||null;fx.checkCorrectStateName(u),s.hasOwnProperty(rd)&&(r.actions=Object.assign({},r.actions,(s[rd]||{}).actions)),r.children=a,r.defaults=l,r.name=u})({meta:s,inheritedStateClass:o,optionsWithInheritance:a}),r[E8]=a}}pa.\u0275fac=function(e){return new(e||pa)},pa.\u0275mod=ln({type:pa}),pa.\u0275inj=wt({}),pa.ROOT_OPTIONS=new zt("ROOT_OPTIONS");const za=new zt("NgValueAccessor"),Ax=new ic(zE);class Rbe{constructor(e,t){this.dueTime=e,this.scheduler=t}call(e,t){return t.subscribe(new Nbe(e,this.dueTime,this.scheduler))}}class Nbe extends y{constructor(e,t,i){super(e),this.dueTime=t,this.scheduler=i,this.debouncedSubscription=null,this.lastValue=null,this.hasValue=!1}_next(e){this.clearDebounce(),this.lastValue=e,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(Pbe,this.dueTime,this))}_complete(){this.debouncedNext(),this.destination.complete()}debouncedNext(){if(this.clearDebounce(),this.hasValue){const{lastValue:e}=this;this.lastValue=null,this.hasValue=!1,this.destination.next(e)}}clearDebounce(){const e=this.debouncedSubscription;null!==e&&(this.remove(e),e.unsubscribe(),this.debouncedSubscription=null)}}function Pbe(n){n.debouncedNext()}class Fbe{constructor(e){this.total=e}call(e,t){return t.subscribe(new Lbe(e,this.total))}}class Lbe extends y{constructor(e,t){super(e),this.total=t,this.count=0}_next(e){++this.count>this.total&&this.destination.next(e)}}function Yi(n){return null!=n&&"false"!=`${n}`}function Ha(n,e=0){return function(n){return!isNaN(parseFloat(n))&&!isNaN(Number(n))}(n)?Number(n):e}function od(n){return n instanceof En?n.nativeElement:n}let vN;try{vN="undefined"!=typeof Intl&&Intl.v8BreakIterator}catch(n){vN=!1}let cv,bN,Ki=(()=>{class n{constructor(t){this._platformId=t,this.isBrowser=this._platformId?Ef(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!vN)&&"undefined"!=typeof CSS&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return n.\u0275fac=function(t){return new(t||n)(Ie(Gc))},n.\u0275prov=We({factory:function(){return new n(Ie(Gc))},token:n,providedIn:"root"}),n})(),lv=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=ln({type:n}),n.\u0275inj=wt({}),n})();function fm(n){return function(){if(null==cv&&"undefined"!=typeof window)try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>cv=!0}))}finally{cv=cv||!1}return cv}()?n:!!n.capture}function Gf(n){return n.composedPath?n.composedPath()[0]:n.target}let wN=(()=>{class n{create(t){return"undefined"==typeof MutationObserver?null:new MutationObserver(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({factory:function(){return new n},token:n,providedIn:"root"}),n})(),H5=(()=>{class n{constructor(t){this._mutationObserverFactory=t,this._observedElements=new Map}ngOnDestroy(){this._observedElements.forEach((t,i)=>this._cleanupObserver(i))}observe(t){const i=od(t);return new O(r=>{const o=this._observeElement(i).subscribe(r);return()=>{o.unsubscribe(),this._unobserveElement(i)}})}_observeElement(t){if(this._observedElements.has(t))this._observedElements.get(t).count++;else{const i=new se,r=this._mutationObserverFactory.create(s=>i.next(s));r&&r.observe(t,{characterData:!0,childList:!0,subtree:!0}),this._observedElements.set(t,{observer:r,stream:i,count:1})}return this._observedElements.get(t).stream}_unobserveElement(t){this._observedElements.has(t)&&(this._observedElements.get(t).count--,this._observedElements.get(t).count||this._cleanupObserver(t))}_cleanupObserver(t){if(this._observedElements.has(t)){const{observer:i,stream:r}=this._observedElements.get(t);i&&i.disconnect(),r.complete(),this._observedElements.delete(t)}}}return n.\u0275fac=function(t){return new(t||n)(Ie(wN))},n.\u0275prov=We({factory:function(){return new n(Ie(wN))},token:n,providedIn:"root"}),n})(),G5=(()=>{class n{constructor(t,i,r){this._contentObserver=t,this._elementRef=i,this._ngZone=r,this.event=new hn,this._disabled=!1,this._currentSubscription=null}get disabled(){return this._disabled}set disabled(t){this._disabled=Yi(t),this._disabled?this._unsubscribe():this._subscribe()}get debounce(){return this._debounce}set debounce(t){this._debounce=Ha(t),this._subscribe()}ngAfterContentInit(){!this._currentSubscription&&!this.disabled&&this._subscribe()}ngOnDestroy(){this._unsubscribe()}_subscribe(){this._unsubscribe();const t=this._contentObserver.observe(this._elementRef);this._ngZone.runOutsideAngular(()=>{this._currentSubscription=(this.debounce?t.pipe(function(n,e=Ax){return t=>t.lift(new Rbe(n,e))}(this.debounce)):t).subscribe(this.event)})}_unsubscribe(){var t;null===(t=this._currentSubscription)||void 0===t||t.unsubscribe()}}return n.\u0275fac=function(t){return new(t||n)(De(H5),De(En),De(vn))},n.\u0275dir=kt({type:n,selectors:[["","cdkObserveContent",""]],inputs:{disabled:["cdkObserveContentDisabled","disabled"],debounce:"debounce"},outputs:{event:"cdkObserveContent"},exportAs:["cdkObserveContent"]}),n})(),EN=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=ln({type:n}),n.\u0275inj=wt({providers:[wN]}),n})();function t6(n){return 0===n.offsetX&&0===n.offsetY}function n6(n){const e=n.touches&&n.touches[0]||n.changedTouches&&n.changedTouches[0];return!(!e||-1!==e.identifier||null!=e.radiusX&&1!==e.radiusX||null!=e.radiusY&&1!==e.radiusY)}"undefined"!=typeof Element&&Element;const i6=new zt("cdk-input-modality-detector-options"),lwe={ignoreKeys:[18,17,224,91,16]},pm=fm({passive:!0,capture:!0});let s6=(()=>{class n{constructor(t,i,r,s){this._platform=t,this._mostRecentTarget=null,this._modality=new Fr(null),this._lastTouchMs=0,this._onKeydown=o=>{var a,l;(null===(l=null===(a=this._options)||void 0===a?void 0:a.ignoreKeys)||void 0===l?void 0:l.some(c=>c===o.keyCode))||(this._modality.next("keyboard"),this._mostRecentTarget=Gf(o))},this._onMousedown=o=>{Date.now()-this._lastTouchMs<650||(this._modality.next(t6(o)?"keyboard":"mouse"),this._mostRecentTarget=Gf(o))},this._onTouchstart=o=>{n6(o)?this._modality.next("keyboard"):(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=Gf(o))},this._options=Object.assign(Object.assign({},lwe),s),this.modalityDetected=this._modality.pipe(function(n){return e=>e.lift(new Fbe(n))}(1)),this.modalityChanged=this.modalityDetected.pipe(id()),t.isBrowser&&i.runOutsideAngular(()=>{r.addEventListener("keydown",this._onKeydown,pm),r.addEventListener("mousedown",this._onMousedown,pm),r.addEventListener("touchstart",this._onTouchstart,pm)})}get mostRecentModality(){return this._modality.value}ngOnDestroy(){!this._platform.isBrowser||(document.removeEventListener("keydown",this._onKeydown,pm),document.removeEventListener("mousedown",this._onMousedown,pm),document.removeEventListener("touchstart",this._onTouchstart,pm))}}return n.\u0275fac=function(t){return new(t||n)(Ie(Ki),Ie(vn),Ie(dn),Ie(i6,8))},n.\u0275prov=We({factory:function(){return new n(Ie(Ki),Ie(vn),Ie(dn),Ie(i6,8))},token:n,providedIn:"root"}),n})();const l6=new zt("cdk-focus-monitor-default-options"),Nx=fm({passive:!0,capture:!0});let ad=(()=>{class n{constructor(t,i,r,s,o){this._ngZone=t,this._platform=i,this._inputModalityDetector=r,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new se,this._rootNodeFocusAndBlurListener=a=>{const l=Gf(a),c="focus"===a.type?this._onFocus:this._onBlur;for(let u=l;u;u=u.parentElement)c.call(this,a,u)},this._document=s,this._detectionMode=(null==o?void 0:o.detectionMode)||0}monitor(t,i=!1){const r=od(t);if(!this._platform.isBrowser||1!==r.nodeType)return nn(null);const s=function(n){if(function(){if(null==bN){const n="undefined"!=typeof document?document.head:null;bN=!(!n||!n.createShadowRoot&&!n.attachShadow)}return bN}()){const e=n.getRootNode?n.getRootNode():null;if("undefined"!=typeof ShadowRoot&&ShadowRoot&&e instanceof ShadowRoot)return e}return null}(r)||this._getDocument(),o=this._elementInfo.get(r);if(o)return i&&(o.checkChildren=!0),o.subject;const a={checkChildren:i,subject:new se,rootNode:s};return this._elementInfo.set(r,a),this._registerGlobalListeners(a),a.subject}stopMonitoring(t){const i=od(t),r=this._elementInfo.get(i);r&&(r.subject.complete(),this._setClasses(i),this._elementInfo.delete(i),this._removeGlobalListeners(r))}focusVia(t,i,r){const s=od(t);s===this._getDocument().activeElement?this._getClosestElementsInfo(s).forEach(([a,l])=>this._originChanged(a,i,l)):(this._setOrigin(i),"function"==typeof s.focus&&s.focus(r))}ngOnDestroy(){this._elementInfo.forEach((t,i)=>this.stopMonitoring(i))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_toggleClass(t,i,r){r?t.classList.add(i):t.classList.remove(i)}_getFocusOrigin(t){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(t)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:"program"}_shouldBeAttributedToTouch(t){return 1===this._detectionMode||!!(null==t?void 0:t.contains(this._inputModalityDetector._mostRecentTarget))}_setClasses(t,i){this._toggleClass(t,"cdk-focused",!!i),this._toggleClass(t,"cdk-touch-focused","touch"===i),this._toggleClass(t,"cdk-keyboard-focused","keyboard"===i),this._toggleClass(t,"cdk-mouse-focused","mouse"===i),this._toggleClass(t,"cdk-program-focused","program"===i)}_setOrigin(t,i=!1){this._ngZone.runOutsideAngular(()=>{this._origin=t,this._originFromTouchInteraction="touch"===t&&i,0===this._detectionMode&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(t,i){const r=this._elementInfo.get(i),s=Gf(t);!r||!r.checkChildren&&i!==s||this._originChanged(i,this._getFocusOrigin(s),r)}_onBlur(t,i){const r=this._elementInfo.get(i);!r||r.checkChildren&&t.relatedTarget instanceof Node&&i.contains(t.relatedTarget)||(this._setClasses(i),this._emitOrigin(r.subject,null))}_emitOrigin(t,i){this._ngZone.run(()=>t.next(i))}_registerGlobalListeners(t){if(!this._platform.isBrowser)return;const i=t.rootNode,r=this._rootNodeFocusListenerCount.get(i)||0;r||this._ngZone.runOutsideAngular(()=>{i.addEventListener("focus",this._rootNodeFocusAndBlurListener,Nx),i.addEventListener("blur",this._rootNodeFocusAndBlurListener,Nx)}),this._rootNodeFocusListenerCount.set(i,r+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(us(this._stopInputModalityDetector)).subscribe(s=>{this._setOrigin(s,!0)}))}_removeGlobalListeners(t){const i=t.rootNode;if(this._rootNodeFocusListenerCount.has(i)){const r=this._rootNodeFocusListenerCount.get(i);r>1?this._rootNodeFocusListenerCount.set(i,r-1):(i.removeEventListener("focus",this._rootNodeFocusAndBlurListener,Nx),i.removeEventListener("blur",this._rootNodeFocusAndBlurListener,Nx),this._rootNodeFocusListenerCount.delete(i))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(t,i,r){this._setClasses(t,i),this._emitOrigin(r.subject,i),this._lastFocusOrigin=i}_getClosestElementsInfo(t){const i=[];return this._elementInfo.forEach((r,s)=>{(s===t||r.checkChildren&&s.contains(t))&&i.push([s,r])}),i}}return n.\u0275fac=function(t){return new(t||n)(Ie(vn),Ie(Ki),Ie(s6),Ie(dn,8),Ie(l6,8))},n.\u0275prov=We({factory:function(){return new n(Ie(vn),Ie(Ki),Ie(s6),Ie(dn,8),Ie(l6,8))},token:n,providedIn:"root"}),n})();const c6="cdk-high-contrast-black-on-white",u6="cdk-high-contrast-white-on-black",xN="cdk-high-contrast-active";let d6=(()=>{class n{constructor(t,i){this._platform=t,this._document=i}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const t=this._document.createElement("div");t.style.backgroundColor="rgb(1,2,3)",t.style.position="absolute",this._document.body.appendChild(t);const i=this._document.defaultView||window,r=i&&i.getComputedStyle?i.getComputedStyle(t):null,s=(r&&r.backgroundColor||"").replace(/ /g,"");switch(this._document.body.removeChild(t),s){case"rgb(0,0,0)":return 2;case"rgb(255,255,255)":return 1}return 0}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const t=this._document.body.classList;t.remove(xN),t.remove(c6),t.remove(u6),this._hasCheckedHighContrastMode=!0;const i=this.getHighContrastMode();1===i?(t.add(xN),t.add(c6)):2===i&&(t.add(xN),t.add(u6))}}}return n.\u0275fac=function(t){return new(t||n)(Ie(Ki),Ie(dn))},n.\u0275prov=We({factory:function(){return new n(Ie(Ki),Ie(dn))},token:n,providedIn:"root"}),n})(),dv=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=ln({type:n}),n.\u0275inj=wt({}),n})();const f6=new Bu("12.2.5");function m6(n){Promise.resolve(null).then(n)}class mm{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._onStartFns.push(e)}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){m6(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}function y6(){return"undefined"!=typeof window&&void 0!==window.document}function TN(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}let IN=(n,e)=>!1,ON=(n,e)=>!1,w6=(n,e,t)=>[];const E6=TN();(E6||"undefined"!=typeof Element)&&(IN=y6()?(n,e)=>{for(;e&&e!==document.documentElement;){if(e===n)return!0;e=e.parentNode||e.host}return!1}:(n,e)=>n.contains(e),ON=(()=>{if(E6||Element.prototype.matches)return(n,e)=>n.matches(e);{const n=Element.prototype,e=n.matchesSelector||n.mozMatchesSelector||n.msMatchesSelector||n.oMatchesSelector||n.webkitMatchesSelector;return e?(t,i)=>e.apply(t,[i]):ON}})(),w6=(n,e,t)=>{let i=[];if(t){const r=n.querySelectorAll(e);for(let s=0;s<r.length;s++)i.push(r[s])}else{const r=n.querySelector(e);r&&i.push(r)}return i});let $f=null,S6=!1;function RN(n){$f||($f=("undefined"!=typeof document?document.body:null)||{},S6=!!$f.style&&"WebkitAppearance"in $f.style);let e=!0;return $f.style&&!function(n){return"ebkit"==n.substring(1,6)}(n)&&(e=n in $f.style,!e&&S6&&(e="Webkit"+n.charAt(0).toUpperCase()+n.substr(1)in $f.style)),e}const NN=ON,PN=IN,FN=w6;let C6=(()=>{class n{validateStyleProperty(t){return RN(t)}matchesElement(t,i){return NN(t,i)}containsElement(t,i){return PN(t,i)}query(t,i,r){return FN(t,i,r)}computeStyle(t,i,r){return r||""}animate(t,i,r,s,o,a=[],l){return new mm(r,s)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class Px{}Px.NOOP=new C6;function D6(n,e,t){return t?e+":"+t+";":""}function I6(n){let e="";for(let t=0;t<n.style.length;t++){const i=n.style.item(t);e+=D6(0,i,n.style.getPropertyValue(i))}for(const t in n.style)n.style.hasOwnProperty(t)&&!t.startsWith("_")&&(e+=D6(0,Ewe(t),n.style[t]));n.setAttribute("style",e)}function uu(n,e,t){n.style&&(Object.keys(e).forEach(i=>{const r=jN(i);t&&!t.hasOwnProperty(i)&&(t[i]=n.style[r]),n.style[r]=e[i]}),TN()&&I6(n))}function qf(n,e){n.style&&(Object.keys(e).forEach(t=>{const i=jN(t);n.style[i]=""}),TN()&&I6(n))}const wwe=/-+([a-z0-9])/g;function jN(n){return n.replace(wwe,(...e)=>e[1].toUpperCase())}function Ewe(n){return n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}class vm{constructor(e,t,i){this._element=e,this._startStyles=t,this._endStyles=i,this._state=0;let r=vm.initialStylesByElement.get(e);r||vm.initialStylesByElement.set(e,r={}),this._initialStyles=r}start(){this._state<1&&(this._startStyles&&uu(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(uu(this._element,this._initialStyles),this._endStyles&&(uu(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(vm.initialStylesByElement.delete(this._element),this._startStyles&&(qf(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(qf(this._element,this._endStyles),this._endStyles=null),uu(this._element,this._initialStyles),this._state=3)}}vm.initialStylesByElement=new WeakMap;const gc=new zt("AnimationModuleType"),pG=new Bu("12.2.5"),HEe=new zt("mat-sanity-checks",{providedIn:"root",factory:function(){return!0}});let Kf,mr=(()=>{class n{constructor(t,i,r){this._hasDoneGlobalChecks=!1,this._document=r,t._applyBodyHighContrastModeCssClasses(),this._sanityChecks=i,this._hasDoneGlobalChecks||(this._checkDoctypeIsDefined(),this._checkThemeIsPresent(),this._checkCdkVersionMatch(),this._hasDoneGlobalChecks=!0)}_getWindow(){const t=this._document.defaultView||window;return"object"==typeof t&&t?t:null}_checkIsEnabled(t){return!(!la()||this._isTestEnv())&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[t])}_isTestEnv(){const t=this._getWindow();return t&&(t.__karma__||t.jasmine)}_checkDoctypeIsDefined(){this._checkIsEnabled("doctype")&&!this._document.doctype&&console.warn("Current document does not have a doctype. This may cause some Angular Material components not to behave as expected.")}_checkThemeIsPresent(){if(!this._checkIsEnabled("theme")||!this._document.body||"function"!=typeof getComputedStyle)return;const t=this._document.createElement("div");t.classList.add("mat-theme-loaded-marker"),this._document.body.appendChild(t);const i=getComputedStyle(t);i&&"none"!==i.display&&console.warn("Could not find Angular Material core theme. Most Material components may not work as expected. For more info refer to the theming guide: https://material.angular.io/guide/theming"),this._document.body.removeChild(t)}_checkCdkVersionMatch(){this._checkIsEnabled("version")&&pG.full!==f6.full&&console.warn("The Angular Material version ("+pG.full+") does not match the Angular CDK version ("+f6.full+").\nPlease ensure the versions of these two packages exactly match.")}}return n.\u0275fac=function(t){return new(t||n)(Ie(d6),Ie(HEe,8),Ie(dn))},n.\u0275mod=ln({type:n}),n.\u0275inj=wt({imports:[[dv],dv]}),n})();function Jx(n){return class extends n{constructor(...e){super(...e),this._disabled=!1}get disabled(){return this._disabled}set disabled(e){this._disabled=Yi(e)}}}function pv(n,e){return class extends n{constructor(...t){super(...t),this.defaultColor=e,this.color=e}get color(){return this._color}set color(t){const i=t||this.defaultColor;i!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove(`mat-${this._color}`),i&&this._elementRef.nativeElement.classList.add(`mat-${i}`),this._color=i)}}}function tP(n){return class extends n{constructor(...e){super(...e),this._disableRipple=!1}get disableRipple(){return this._disableRipple}set disableRipple(e){this._disableRipple=Yi(e)}}}function nP(n,e=0){return class extends n{constructor(...t){super(...t),this._tabIndex=e,this.defaultTabIndex=e}get tabIndex(){return this.disabled?-1:this._tabIndex}set tabIndex(t){this._tabIndex=null!=t?Ha(t):this.defaultTabIndex}}}try{Kf="undefined"!=typeof Intl}catch(n){Kf=!1}class nSe{constructor(e,t,i){this._renderer=e,this.element=t,this.config=i,this.state=3}fadeOut(){this._renderer.fadeOutRipple(this)}}const _G={enterDuration:225,exitDuration:150},iP=fm({passive:!0}),yG=["mousedown","touchstart"],vG=["mouseup","mouseleave","touchend","touchcancel"];class rSe{constructor(e,t,i,r){this._target=e,this._ngZone=t,this._isPointerDown=!1,this._activeRipples=new Set,this._pointerUpEventsRegistered=!1,r.isBrowser&&(this._containerElement=od(i))}fadeInRipple(e,t,i={}){const r=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),s=Object.assign(Object.assign({},_G),i.animation);i.centered&&(e=r.left+r.width/2,t=r.top+r.height/2);const o=i.radius||function(n,e,t){const i=Math.max(Math.abs(n-t.left),Math.abs(n-t.right)),r=Math.max(Math.abs(e-t.top),Math.abs(e-t.bottom));return Math.sqrt(i*i+r*r)}(e,t,r),a=e-r.left,l=t-r.top,c=s.enterDuration,u=document.createElement("div");u.classList.add("mat-ripple-element"),u.style.left=a-o+"px",u.style.top=l-o+"px",u.style.height=2*o+"px",u.style.width=2*o+"px",null!=i.color&&(u.style.backgroundColor=i.color),u.style.transitionDuration=`${c}ms`,this._containerElement.appendChild(u),function(n){window.getComputedStyle(n).getPropertyValue("opacity")}(u),u.style.transform="scale(1)";const h=new nSe(this,u,i);return h.state=0,this._activeRipples.add(h),i.persistent||(this._mostRecentTransientRipple=h),this._runTimeoutOutsideZone(()=>{const p=h===this._mostRecentTransientRipple;h.state=1,!i.persistent&&(!p||!this._isPointerDown)&&h.fadeOut()},c),h}fadeOutRipple(e){const t=this._activeRipples.delete(e);if(e===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),this._activeRipples.size||(this._containerRect=null),!t)return;const i=e.element,r=Object.assign(Object.assign({},_G),e.config.animation);i.style.transitionDuration=`${r.exitDuration}ms`,i.style.opacity="0",e.state=2,this._runTimeoutOutsideZone(()=>{e.state=3,i.parentNode.removeChild(i)},r.exitDuration)}fadeOutAll(){this._activeRipples.forEach(e=>e.fadeOut())}fadeOutAllNonPersistent(){this._activeRipples.forEach(e=>{e.config.persistent||e.fadeOut()})}setupTriggerEvents(e){const t=od(e);!t||t===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=t,this._registerEvents(yG))}handleEvent(e){"mousedown"===e.type?this._onMousedown(e):"touchstart"===e.type?this._onTouchStart(e):this._onPointerUp(),this._pointerUpEventsRegistered||(this._registerEvents(vG),this._pointerUpEventsRegistered=!0)}_onMousedown(e){const t=t6(e),i=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!t&&!i&&(this._isPointerDown=!0,this.fadeInRipple(e.clientX,e.clientY,this._target.rippleConfig))}_onTouchStart(e){if(!this._target.rippleDisabled&&!n6(e)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const t=e.changedTouches;for(let i=0;i<t.length;i++)this.fadeInRipple(t[i].clientX,t[i].clientY,this._target.rippleConfig)}}_onPointerUp(){!this._isPointerDown||(this._isPointerDown=!1,this._activeRipples.forEach(e=>{!e.config.persistent&&(1===e.state||e.config.terminateOnPointerUp&&0===e.state)&&e.fadeOut()}))}_runTimeoutOutsideZone(e,t=0){this._ngZone.runOutsideAngular(()=>setTimeout(e,t))}_registerEvents(e){this._ngZone.runOutsideAngular(()=>{e.forEach(t=>{this._triggerElement.addEventListener(t,this,iP)})})}_removeTriggerEvents(){this._triggerElement&&(yG.forEach(e=>{this._triggerElement.removeEventListener(e,this,iP)}),this._pointerUpEventsRegistered&&vG.forEach(e=>{this._triggerElement.removeEventListener(e,this,iP)}))}}const aSe=new zt("mat-ripple-global-options");let bm=(()=>{class n{constructor(t,i,r,s,o){this._elementRef=t,this._animationMode=o,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=s||{},this._rippleRenderer=new rSe(this,i,t,r)}get disabled(){return this._disabled}set disabled(t){t&&this.fadeOutAllNonPersistent(),this._disabled=t,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(t){this._trigger=t,this._setupTriggerEventsIfEnabled()}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:Object.assign(Object.assign(Object.assign({},this._globalOptions.animation),"NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{}),this.animation),terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(t,i=0,r){return"number"==typeof t?this._rippleRenderer.fadeInRipple(t,i,Object.assign(Object.assign({},this.rippleConfig),r)):this._rippleRenderer.fadeInRipple(0,0,Object.assign(Object.assign({},this.rippleConfig),t))}}return n.\u0275fac=function(t){return new(t||n)(De(En),De(vn),De(Ki),De(aSe,8),De(gc,8))},n.\u0275dir=kt({type:n,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(t,i){2&t&&Ai("mat-ripple-unbounded",i.unbounded)},inputs:{radius:["matRippleRadius","radius"],disabled:["matRippleDisabled","disabled"],trigger:["matRippleTrigger","trigger"],color:["matRippleColor","color"],unbounded:["matRippleUnbounded","unbounded"],centered:["matRippleCentered","centered"],animation:["matRippleAnimation","animation"]},exportAs:["matRipple"]}),n})(),tC=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=ln({type:n}),n.\u0275inj=wt({imports:[[mr,lv],mr]}),n})();function dd(n,e,t,i){return K(t)&&(i=t,t=void 0),i?dd(n,e,t).pipe(me(r=>k(r)?i(...r):i(r))):new O(r=>{xG(n,e,function(o){r.next(arguments.length>1?Array.prototype.slice.call(arguments):o)},r,t)})}function xG(n,e,t,i,r){let s;if(function(n){return n&&"function"==typeof n.addEventListener&&"function"==typeof n.removeEventListener}(n)){const o=n;n.addEventListener(e,t,r),s=()=>o.removeEventListener(e,t,r)}else if(function(n){return n&&"function"==typeof n.on&&"function"==typeof n.off}(n)){const o=n;n.on(e,t),s=()=>o.off(e,t)}else if(function(n){return n&&"function"==typeof n.addListener&&"function"==typeof n.removeListener}(n)){const o=n;n.addListener(e,t),s=()=>o.removeListener(e,t)}else{if(!n||!n.length)throw new TypeError("Invalid event target");for(let o=0,a=n.length;o<a;o++)xG(n[o],e,t,i,r)}i.add(s)}new class extends ic{flush(e){this.active=!0,this.scheduled=void 0;const{actions:t}=this;let i,r=-1,s=t.length;e=e||t.shift();do{if(i=e.execute(e.state,e.delay))break}while(++r<s&&(e=t.shift()));if(this.active=!1,i){for(;++r<s&&(e=t.shift());)e.unsubscribe();throw i}}}(class extends zE{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,i=0){return null!==i&&i>0?super.requestAsyncId(e,t,i):(e.actions.push(this),e.scheduled||(e.scheduled=requestAnimationFrame(()=>e.flush(null))))}recycleAsyncId(e,t,i=0){if(null!==i&&i>0||null===i&&this.delay>0)return super.recycleAsyncId(e,t,i);0===e.actions.length&&(cancelAnimationFrame(t),e.scheduled=void 0)}});let ESe=1;const SSe=Promise.resolve(),iC={};function CG(n){return n in iC&&(delete iC[n],!0)}const TG={setImmediate(n){const e=ESe++;return iC[e]=!0,SSe.then(()=>CG(e)&&n()),e},clearImmediate(n){CG(n)}};new class extends ic{flush(e){this.active=!0,this.scheduled=void 0;const{actions:t}=this;let i,r=-1,s=t.length;e=e||t.shift();do{if(i=e.execute(e.state,e.delay))break}while(++r<s&&(e=t.shift()));if(this.active=!1,i){for(;++r<s&&(e=t.shift());)e.unsubscribe();throw i}}}(class extends zE{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,i=0){return null!==i&&i>0?super.requestAsyncId(e,t,i):(e.actions.push(this),e.scheduled||(e.scheduled=TG.setImmediate(e.flush.bind(e,null))))}recycleAsyncId(e,t,i=0){if(null!==i&&i>0||null===i&&this.delay>0)return super.recycleAsyncId(e,t,i);0===e.actions.length&&(TG.clearImmediate(t),e.scheduled=void 0)}});function mv(n){return!!n&&(n instanceof O||"function"==typeof n.lift&&"function"==typeof n.subscribe)}function sC(...n){return Rt(1)(nn(...n))}"undefined"!=typeof window&&window;class $xe{constructor(e,t){this.delay=e,this.scheduler=t}call(e,t){return t.subscribe(new dP(e,this.delay,this.scheduler))}}class dP extends y{constructor(e,t,i){super(e),this.delay=t,this.scheduler=i,this.queue=[],this.active=!1,this.errored=!1}static dispatch(e){const t=e.source,i=t.queue,r=e.scheduler,s=e.destination;for(;i.length>0&&i[0].time-r.now()<=0;)i.shift().notification.observe(s);if(i.length>0){const o=Math.max(0,i[0].time-r.now());this.schedule(e,o)}else this.unsubscribe(),t.active=!1}_schedule(e){this.active=!0,this.destination.add(e.schedule(dP.dispatch,this.delay,{source:this,destination:this.destination,scheduler:e}))}scheduleNotification(e){if(!0===this.errored)return;const t=this.scheduler,i=new Wxe(t.now()+this.delay,e);this.queue.push(i),!1===this.active&&this._schedule(t)}_next(e){this.scheduleNotification(ua.createNext(e))}_error(e){this.errored=!0,this.queue=[],this.destination.error(e),this.unsubscribe()}_complete(){this.scheduleNotification(ua.createComplete()),this.unsubscribe()}}class Wxe{constructor(e,t){this.time=e,this.notification=t}}function o$(...n){const e=n.length;if(0===e)throw new Error("list of properties cannot be empty.");return t=>me(function(n,e){return i=>{let r=i;for(let s=0;s<e;s++){const o=null!=r?r[n[s]]:void 0;if(void 0===o)return;r=o}return r}}(n,e))(t)}nt(266);class NCe{constructor(e){this.callback=e}call(e,t){return t.subscribe(new PCe(e,this.callback))}}class PCe extends y{constructor(e,t){super(e),this.add(new C(t))}}class f${}class p${}class du{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?this.lazyInit="string"==typeof e?()=>{this.headers=new Map,e.split("\n").forEach(t=>{const i=t.indexOf(":");if(i>0){const r=t.slice(0,i),s=r.toLowerCase(),o=t.slice(i+1).trim();this.maybeSetNormalizedName(r,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:()=>{this.headers=new Map,Object.keys(e).forEach(t=>{let i=e[t];const r=t.toLowerCase();"string"==typeof i&&(i=[i]),i.length>0&&(this.headers.set(r,i),this.maybeSetNormalizedName(t,r))})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof du?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){const t=new du;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof du?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){const t=e.name.toLowerCase();switch(e.op){case"a":case"s":let i=e.value;if("string"==typeof i&&(i=[i]),0===i.length)return;this.maybeSetNormalizedName(e.name,t);const r=("a"===e.op?this.headers.get(t):void 0)||[];r.push(...i),this.headers.set(t,r);break;case"d":const s=e.value;if(s){let o=this.headers.get(t);if(!o)return;o=o.filter(a=>-1===s.indexOf(a)),0===o.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}else this.headers.delete(t),this.normalizedNames.delete(t)}}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}}class FCe{encodeKey(e){return g$(e)}encodeValue(e){return g$(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const kCe=/%(\d[a-f0-9])/gi,BCe={40:"@","3A":":",24:"$","2C":",","3B":";","2B":"+","3D":"=","3F":"?","2F":"/"};function g$(n){return encodeURIComponent(n).replace(kCe,(e,t)=>{var i;return null!==(i=BCe[t])&&void 0!==i?i:e})}function m$(n){return`${n}`}class Lr{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new FCe,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function(n,e){const t=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(r=>{const s=r.indexOf("="),[o,a]=-1==s?[e.decodeKey(r),""]:[e.decodeKey(r.slice(0,s)),e.decodeValue(r.slice(s+1))],l=t.get(o)||[];l.push(a),t.set(o,l)}),t}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{const i=e.fromObject[t];this.map.set(t,Array.isArray(i)?i:[i])})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){const t=[];return Object.keys(e).forEach(i=>{const r=e[i];Array.isArray(r)?r.forEach(s=>{t.push({param:i,value:s,op:"a"})}):t.push({param:i,value:r,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const t=this.encoder.encodeKey(e);return this.map.get(e).map(i=>t+"="+this.encoder.encodeValue(i)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const t=new Lr({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const t=("a"===e.op?this.map.get(e.param):void 0)||[];t.push(m$(e.value)),this.map.set(e.param,t);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let i=this.map.get(e.param)||[];const r=i.indexOf(m$(e.value));-1!==r&&i.splice(r,1),i.length>0?this.map.set(e.param,i):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class Xs{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}keys(){return this.map.keys()}}function _$(n){return"undefined"!=typeof ArrayBuffer&&n instanceof ArrayBuffer}function y$(n){return"undefined"!=typeof Blob&&n instanceof Blob}function v$(n){return"undefined"!=typeof FormData&&n instanceof FormData}class yv{constructor(e,t,i,r){let s;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==i?i:null,s=r):s=i,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params)),this.headers||(this.headers=new du),this.context||(this.context=new Xs),this.params){const o=this.params.toString();if(0===o.length)this.urlWithParams=t;else{const a=t.indexOf("?");this.urlWithParams=t+(-1===a?"?":a<t.length-1?"&":"")+o}}else this.params=new Lr,this.urlWithParams=t}serializeBody(){return null===this.body?null:_$(this.body)||y$(this.body)||v$(this.body)||function(n){return"undefined"!=typeof URLSearchParams&&n instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof Lr?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||v$(this.body)?null:y$(this.body)?this.body.type||null:_$(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Lr?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(e={}){var t;const i=e.method||this.method,r=e.url||this.url,s=e.responseType||this.responseType,o=void 0!==e.body?e.body:this.body,a=void 0!==e.withCredentials?e.withCredentials:this.withCredentials,l=void 0!==e.reportProgress?e.reportProgress:this.reportProgress;let c=e.headers||this.headers,u=e.params||this.params;const h=null!==(t=e.context)&&void 0!==t?t:this.context;return void 0!==e.setHeaders&&(c=Object.keys(e.setHeaders).reduce((p,g)=>p.set(g,e.setHeaders[g]),c)),e.setParams&&(u=Object.keys(e.setParams).reduce((p,g)=>p.set(g,e.setParams[g]),u)),new yv(i,r,o,{params:u,headers:c,context:h,reportProgress:l,responseType:s,withCredentials:a})}}var vs=(()=>((vs=vs||{})[vs.Sent=0]="Sent",vs[vs.UploadProgress=1]="UploadProgress",vs[vs.ResponseHeader=2]="ResponseHeader",vs[vs.DownloadProgress=3]="DownloadProgress",vs[vs.Response=4]="Response",vs[vs.User=5]="User",vs))();class fP{constructor(e,t=200,i="OK"){this.headers=e.headers||new du,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||i,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class pP extends fP{constructor(e={}){super(e),this.type=vs.ResponseHeader}clone(e={}){return new pP({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class hC extends fP{constructor(e={}){super(e),this.type=vs.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new hC({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class b$ extends fP{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${e.url||"(unknown url)"}`:`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}}function gP(n,e){return{body:e,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials}}let hd=(()=>{class n{constructor(t){this.handler=t}request(t,i,r={}){let s;if(t instanceof yv)s=t;else{let l,c;l=r.headers instanceof du?r.headers:new du(r.headers),r.params&&(c=r.params instanceof Lr?r.params:new Lr({fromObject:r.params})),s=new yv(t,i,void 0!==r.body?r.body:null,{headers:l,context:r.context,params:c,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials})}const o=nn(s).pipe(function(n,e){return V(n,e,1)}(l=>this.handler.handle(l)));if(t instanceof yv||"events"===r.observe)return o;const a=o.pipe(qi(l=>l instanceof hC));switch(r.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return a.pipe(me(l=>{if(null!==l.body&&!(l.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return l.body}));case"blob":return a.pipe(me(l=>{if(null!==l.body&&!(l.body instanceof Blob))throw new Error("Response is not a Blob.");return l.body}));case"text":return a.pipe(me(l=>{if(null!==l.body&&"string"!=typeof l.body)throw new Error("Response is not a string.");return l.body}));case"json":default:return a.pipe(me(l=>l.body))}case"response":return a;default:throw new Error(`Unreachable: unhandled observe type ${r.observe}}`)}}delete(t,i={}){return this.request("DELETE",t,i)}get(t,i={}){return this.request("GET",t,i)}head(t,i={}){return this.request("HEAD",t,i)}jsonp(t,i){return this.request("JSONP",t,{params:(new Lr).append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,i={}){return this.request("OPTIONS",t,i)}patch(t,i,r={}){return this.request("PATCH",t,gP(r,i))}post(t,i,r={}){return this.request("POST",t,gP(r,i))}put(t,i,r={}){return this.request("PUT",t,gP(r,i))}}return n.\u0275fac=function(t){return new(t||n)(Ie(f$))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class w${constructor(e,t){this.next=e,this.interceptor=t}handle(e){return this.interceptor.intercept(e,this.next)}}const E$=new zt("HTTP_INTERCEPTORS");let UCe=(()=>{class n{intercept(t,i){return i.handle(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const zCe=/^\)\]\}',?\n/;let S$=(()=>{class n{constructor(t){this.xhrFactory=t}handle(t){if("JSONP"===t.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new O(i=>{const r=this.xhrFactory.build();if(r.open(t.method,t.urlWithParams),t.withCredentials&&(r.withCredentials=!0),t.headers.forEach((g,m)=>r.setRequestHeader(g,m.join(","))),t.headers.has("Accept")||r.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){const g=t.detectContentTypeHeader();null!==g&&r.setRequestHeader("Content-Type",g)}if(t.responseType){const g=t.responseType.toLowerCase();r.responseType="json"!==g?g:"text"}const s=t.serializeBody();let o=null;const a=()=>{if(null!==o)return o;const g=1223===r.status?204:r.status,m=r.statusText||"OK",w=new du(r.getAllResponseHeaders()),x=function(n){return"responseURL"in n&&n.responseURL?n.responseURL:/^X-Request-URL:/m.test(n.getAllResponseHeaders())?n.getResponseHeader("X-Request-URL"):null}(r)||t.url;return o=new pP({headers:w,status:g,statusText:m,url:x}),o},l=()=>{let{headers:g,status:m,statusText:w,url:x}=a(),H=null;204!==m&&(H=void 0===r.response?r.responseText:r.response),0===m&&(m=H?200:0);let I=m>=200&&m<300;if("json"===t.responseType&&"string"==typeof H){const oe=H;H=H.replace(zCe,"");try{H=""!==H?JSON.parse(H):null}catch(Se){H=oe,I&&(I=!1,H={error:Se,text:H})}}I?(i.next(new hC({body:H,headers:g,status:m,statusText:w,url:x||void 0})),i.complete()):i.error(new b$({error:H,headers:g,status:m,statusText:w,url:x||void 0}))},c=g=>{const{url:m}=a(),w=new b$({error:g,status:r.status||0,statusText:r.statusText||"Unknown Error",url:m||void 0});i.error(w)};let u=!1;const h=g=>{u||(i.next(a()),u=!0);let m={type:vs.DownloadProgress,loaded:g.loaded};g.lengthComputable&&(m.total=g.total),"text"===t.responseType&&!!r.responseText&&(m.partialText=r.responseText),i.next(m)},p=g=>{let m={type:vs.UploadProgress,loaded:g.loaded};g.lengthComputable&&(m.total=g.total),i.next(m)};return r.addEventListener("load",l),r.addEventListener("error",c),r.addEventListener("timeout",c),r.addEventListener("abort",c),t.reportProgress&&(r.addEventListener("progress",h),null!==s&&r.upload&&r.upload.addEventListener("progress",p)),r.send(s),i.next({type:vs.Sent}),()=>{r.removeEventListener("error",c),r.removeEventListener("abort",c),r.removeEventListener("load",l),r.removeEventListener("timeout",c),t.reportProgress&&(r.removeEventListener("progress",h),null!==s&&r.upload&&r.upload.removeEventListener("progress",p)),r.readyState!==r.DONE&&r.abort()}})}}return n.\u0275fac=function(t){return new(t||n)(Ie(AB))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const mP=new zt("XSRF_COOKIE_NAME"),_P=new zt("XSRF_HEADER_NAME");class x${}let GCe=(()=>{class n{constructor(t,i,r){this.doc=t,this.platform=i,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=mB(t,this.cookieName),this.lastCookieString=t),this.lastToken}}return n.\u0275fac=function(t){return new(t||n)(Ie(dn),Ie(Gc),Ie(mP))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),yP=(()=>{class n{constructor(t,i){this.tokenService=t,this.headerName=i}intercept(t,i){const r=t.url.toLowerCase();if("GET"===t.method||"HEAD"===t.method||r.startsWith("http://")||r.startsWith("https://"))return i.handle(t);const s=this.tokenService.getToken();return null!==s&&!t.headers.has(this.headerName)&&(t=t.clone({headers:t.headers.set(this.headerName,s)})),i.handle(t)}}return n.\u0275fac=function(t){return new(t||n)(Ie(x$),Ie(_P))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),$Ce=(()=>{class n{constructor(t,i){this.backend=t,this.injector=i,this.chain=null}handle(t){if(null===this.chain){const i=this.injector.get(E$,[]);this.chain=i.reduceRight((r,s)=>new w$(r,s),this.backend)}return this.chain.handle(t)}}return n.\u0275fac=function(t){return new(t||n)(Ie(p$),Ie(Un))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),WCe=(()=>{class n{static disable(){return{ngModule:n,providers:[{provide:yP,useClass:UCe}]}}static withOptions(t={}){return{ngModule:n,providers:[t.cookieName?{provide:mP,useValue:t.cookieName}:[],t.headerName?{provide:_P,useValue:t.headerName}:[]]}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=ln({type:n}),n.\u0275inj=wt({providers:[yP,{provide:E$,useExisting:yP,multi:!0},{provide:x$,useClass:GCe},{provide:mP,useValue:"XSRF-TOKEN"},{provide:_P,useValue:"X-XSRF-TOKEN"}]}),n})(),C$=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=ln({type:n}),n.\u0275inj=wt({providers:[hd,{provide:f$,useClass:$Ce},S$,{provide:p$,useExisting:S$}],imports:[[WCe.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),n})();function wv(n){return!0===n}function Wa(n){return null==n}function qa(n){return!Wa(n)}function MP(n){return Boolean(n)}function J$(n){return Wa(n)?n:JSON.parse(JSON.stringify(n))}nt(478),Object.create(Error.prototype),new zt("SECURITY_CONTEXT");const EC=n=>{const t=n instanceof Date;if("object"!=typeof n||null===n||t)return n;Object.freeze(n);const r="function"==typeof n,s=Object.prototype.hasOwnProperty;return Object.getOwnPropertyNames(n).forEach(o=>{s.call(n,o)&&(!r||"caller"!==o&&"callee"!==o&&"arguments"!==o)&&null!==n[o]&&("object"==typeof n[o]||"function"==typeof n[o])&&!Object.isFrozen(n[o])&&EC(n[o])}),n};function eW(n){return qa(n)&&"object"==typeof n&&function(n){return"[object Object]"===Object.prototype.toString.call(n)}(n)}const iW="NGXS_DATA_META",IP="NGXS_META",rW="NGXS_ARGUMENT_REGISTRY_META";let sW=(()=>{class n{constructor(t){this.sequence$=new Fr(0),this.subscription=null,t&&(this.subscription=t.subscribe(()=>this.updateSequence()))}get sequenceValue(){return this.sequence$.getValue()}ngOnDestroy(){var t;this.sequence$.next(0),null===(t=this.subscription)||void 0===t||t.unsubscribe()}updateSequence(){this.sequence$.next(this.sequenceValue+1)}}return n.\u0275fac=function(t){return new(t||n)(Ie(mh,8))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();function Ev(n){return n[iW]}let Ya=(()=>{class n{constructor(t,i,r){n.store=t.get(mh),n.ngZone=t.get(vn),n.factory=i,n.context=r,n.computed=t.get(sW)}}return n.store=null,n.computed=null,n.context=null,n.factory=null,n.ngZone=null,n.\u0275fac=function(t){return new(t||n)(Ie(Un),Ie(f8),Ie(h8))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class hs{constructor(){hs.statesCachedMeta.clear()}static createStateContext(e){return Ya.context.createStateContext(e)}static ensureMappedState(e){if(Wa(Ya.factory)||Wa(e))throw new Error("Metadata not created \n Maybe you forgot to import the NgxsDataPluginModule\n Also, you cannot use this.ctx.* until the application is fully rendered \n (use by default ngxsOnInit(ctx: StateContext), or ngxsAfterBootstrap(ctx: StateContext) !!!");return(qa(e.name)?hs.statesCachedMeta.get(e.name):null)||hs.ensureMeta(e)}static getRepositoryByInstance(e){var t;const r=null!==(t=Ev(hs.getStateClassByInstance(e)))&&void 0!==t?t:null;if(Wa(r))throw new Error("You forgot add decorator @StateRepository or initialize state!\nExample: NgxsModule.forRoot([ .. ]), or NgxsModule.forFeature([ .. ])");return r}static getStateClassByInstance(e){return(null!=e?e:{}).constructor}static clearMetaByInstance(e){const t=hs.getRepositoryByInstance(e);t.stateMeta.actions={},t.operations={}}static createPayload(e,t){const i={},r=Array.from(e);for(let s=0;s<r.length;s++){const o=null==t?void 0:t.getPayloadTypeByIndex(s);qa(o)&&(i[o]=r[s])}return Object.keys(i).length>0?i:null}static createAction(e,t,i){const r=hs.createPayload(t,i);return new(function(n){return class{constructor(t){t&&Object.keys(t).forEach(i=>{this[i]=t[i]})}static get type(){return n}}}(e.type))(r)}static ensureMeta(e){var t;const i=qa(e.name)?null===(t=Ya.factory.states)||void 0===t?void 0:t.find(r=>r.name===e.name):null;return qa(i)&&qa(e.name)&&hs.statesCachedMeta.set(e.name,i),i}}hs.statesCachedMeta=new Map,hs.\u0275fac=function(e){return new(e||hs)},hs.\u0275prov=We({token:hs,factory:hs.\u0275fac}),new xf(1);class zTe extends Error{constructor(e){super(`Child states can only be added to an object. Cannot convert ${qa(null==e?void 0:e.constructor)?e.constructor.name:e} to PlainObject`)}}function oW(n){var e;return null!==(e=n.NGXS_OPTIONS_META)&&void 0!==e?e:{name:""}}function aW(n){var e;const t=oW(n),i=null!==(e=t.children)&&void 0!==e?e:[],s=J$(void 0===t.defaults?{}:t.defaults);if(i.length){if(eW(s))return function(n,e){return e.reduce((t,i)=>{const r=oW(i);if(function(n){const e="string"==typeof n?n.trim():n;return[void 0,null,NaN,"",1/0].includes(e)}(r.name))throw new Error("State name not provided in class");return t[r.name.toString()]=aW(i),t},null!=n?n:{})}(s,i);throw new zTe(s)}return s}function cW(n){var e;return null!==(e=n.__NGXS_COMPUTED_OPTION__)&&void 0!==e?e:null}function uW(){var n,e;return null!==(e=null===(n=null==Ya?void 0:Ya.computed)||void 0===n?void 0:n.sequenceValue)&&void 0!==e?e:0}function WTe(n){let e=!1;return mv(n)&&(e=!0),e}function OP(n){return n[rW]}class qTe extends Error{constructor(e,t){super(`An argument with the name '${e}' already exists in the method '${t}'`)}}class YTe{constructor(){this.payloadMap=new Map,this.argumentMap=new Map}getPayloadTypeByIndex(e){var t;return null!==(t=this.payloadMap.get(e))&&void 0!==t?t:null}getArgumentNameByIndex(e){var t;return null!==(t=this.argumentMap.get(e))&&void 0!==t?t:null}createPayloadType(e,t,i){this.checkDuplicateName(e,t),this.payloadMap.set(i,e),this.payloadMap.set(e,e)}createArgumentName(e,t,i){this.checkDuplicateName(e,t),this.argumentMap.set(i,e),this.argumentMap.set(e,e)}checkDuplicateName(e,t){if(MP(this.argumentMap.has(e))||MP(this.payloadMap.has(e)))throw new qTe(e,t)}}function eAe(n){return{enumerable:!0,configurable:!0,get(){const e=Ev(n),t=hs.ensureMappedState(e.stateMeta);return hs.createStateContext(t)}}}function dW(){return(n,e,t)=>{!function(n,e){if(!function(n,e){var t;let i=n,r=!1;if(eW(i))for(;null!==i;){if(wv(null==i?void 0:i.hasOwnProperty(e))){r=!!(null===(t=Object.getOwnPropertyDescriptor(i,e))||void 0===t?void 0:t.get);break}i=Object.getPrototypeOf(i)}return r}(n,null==e?void 0:e.toString()))throw new Error(`The method must be a getter for the computed decorator to work properly.\nExample: \n@Computed() get ${e.toString()}() { \n\t .. \n}`)}(n,e);const i=t.get;return t.get=function(...r){const s=function(n){return Wa(cW(n))&&Object.defineProperties(n,{__NGXS_COMPUTED_OPTION__:{enumerable:!0,configurable:!0,value:new WeakMap}}),cW(n)}(this),o=null==s?void 0:s.get(i);if(wv(null==o?void 0:o.isObservable))return null==o?void 0:o.value;if(Wa(o)||o.sequenceId!==uW()){s.delete(i);const l=i.apply(this,r);return s.set(i,{value:l,sequenceId:uW(),isObservable:WTe(l)}),l}return o.value},t}}const oAe={cancelUncompleted:!0,insideZone:!1};function RP(n=oAe){return(e,t,i)=>{!function(n,e){if(n.hasOwnProperty("prototype"))throw new Error("Cannot support static methods with @DataAction()");if(void 0===e)throw new Error("@DataAction() can only decorate a method implementation")}(e,i);const r=i.value,s=t.toString();return i.value=function(...o){const a=this;let l=null;const c=hs.getRepositoryByInstance(a),u=c.operations;let h=u[s];const p=c.stateMeta,g=OP(r);if(Wa(h)){const I=function(n){var e,t,i;return null!==(i=null===(t=null===(e=(n+"").replace(/[/][/].*$/gm,"").replace(/\s+/g,"").replace(/[/][*][^/*]*[*][/]/g,"").split("){",1))||void 0===e?void 0:e[0])||void 0===t?void 0:t.replace(/^[^(]*[(]/,"").replace(/=[^,]+/g,"").split(",").filter(Boolean))&&void 0!==i?i:[]}(r),oe=function(n){const{statePath:e,argumentsNames:t,methodName:i,argumentRegistry:r}=n;let s="";for(let o=0;o<t.length;o++)qa(null==r?void 0:r.getArgumentNameByIndex(o))?s+=null==r?void 0:r.getArgumentNameByIndex(o):qa(null==r?void 0:r.getPayloadTypeByIndex(o))?s+=null==r?void 0:r.getPayloadTypeByIndex(o):s+=`$arg${o}`,o!==t.length-1&&(s+=", ");return`@${e.replace(/\./g,"/")}.${i}(${s})`}({statePath:p.path,methodName:s,argumentsNames:I,argumentRegistry:g});h=u[s]={type:oe,options:{cancelUncompleted:n.cancelUncompleted}},p.actions[h.type]=[{type:h.type,options:h.options,fn:h.type}]}hs.ensureMappedState(p).instance[h.type]=()=>{var I;return wv(n.insideZone)?null===(I=Ya.ngZone)||void 0===I||I.run(()=>{l=r.apply(a,o)}):l=r.apply(a,o),mv(l)?nn(null).pipe(me(()=>l)):l};const x=hs.createAction(h,o,g),H=Ya.store.dispatch(x);return mv(l)?function(n,e){return Z0([n,e]).pipe(me(t=>t.pop()))}(H,l):l},i}}function hW(n){return(e,t,i)=>{const r=n.trim();if(!r)throw new Error("Payload name should be initialized");(function(n,e){const t=n[e];return Wa(OP(t))&&Object.defineProperties(t,{[rW]:{enumerable:!0,configurable:!0,value:new YTe}}),OP(t)})(e,t).createPayloadType(r,t,i)}}function lAe(){return n=>{const e=function(n){if(function(n){return!MP(n)}(n.hasOwnProperty(IP))){const e={name:null,actions:{},defaults:{},path:null,makeRootSelector:t=>t.getStateGetter(e.name),children:[]};Object.defineProperty(n,IP,{value:e})}return function(n){var e;return null===(e=n)||void 0===e?void 0:e[IP]}(n)}(n);if(Wa(e.name))throw new Error("@StateRepository should be add before decorator @State");!function(n,e){(function(n){var e;const t=null!==(e=Ev(n))&&void 0!==e?e:null;return(Wa(t)||(null==t?void 0:t.stateClass)!==n)&&function(n){Object.defineProperty(n,iW,{writable:!0,configurable:!0,enumerable:!0,value:{stateMeta:null,operations:{},stateClass:n}})}(n),Ev(n)}(n)).stateMeta=e}(n,e),function(n,e,t){Object.defineProperties(n.prototype,{name:{enumerable:!0,configurable:!0,value:e.name},initialState:{enumerable:!0,configurable:!0,get:()=>J$(t)},context:eAe(n)})}(n,e,aW(n)),function(n){var e,t;const i=Ev(n),r=null!==(t=null===(e=null==i?void 0:i.stateMeta)||void 0===e?void 0:e.name)&&void 0!==t?t:null;if(qa(r)){const s=`__${r}__selector`;Object.defineProperties(n.prototype,{[s]:{writable:!0,enumerable:!1,configurable:!0},state$:{enumerable:!0,configurable:!0,get(){if(qa(this[s]))return this[s];if(Wa(Ya.store))throw new Error("Metadata not created \n Maybe you forgot to import the NgxsDataPluginModule\n Also, you cannot use this.ctx.* until the application is fully rendered \n (use by default ngxsOnInit(ctx: StateContext), or ngxsAfterBootstrap(ctx: StateContext) !!!");return this[s]=Ya.store.select(n).pipe(me(o=>la()?EC(o):o),ja({refCount:!0,bufferSize:1})),this[s]}}})}}(n)}}let uAe=(()=>{class n{constructor(){this.browserStorageEvents$=new se,this.isInitialised=!1,this.isBootstrapped=!1,this._dirty=!0}get dirty(){return this._dirty}set dirty(t){this._dirty=t}ngxsOnChanges(t){var r;this.dirty&&this.isBootstrapped&&(this.dirty=!1,null===(r=this.ngxsDataDoCheck)||void 0===r||r.call(this))}ngxsOnInit(){this.isInitialised=!0}ngxsAfterBootstrap(){var i;this.isBootstrapped=!0,this.dirty&&(this.dirty=!1,null===(i=this.ngxsDataDoCheck)||void 0===i||i.call(this))}markAsDirtyAfterReset(){var i;this.dirty=!0,null===(i=this.ngxsDataAfterReset)||void 0===i||i.call(this)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),dAe=(()=>{class n extends uAe{get snapshot(){return function(n){return la()?EC(n):n}(this.getState())}get ctx(){return function(n){if(!n)throw new Error("You forgot add decorator @StateRepository or initialize state!\nExample: NgxsModule.forRoot([ .. ]), or NgxsModule.forFeature([ .. ])");return Object.assign(Object.assign({},n),{getState:()=>la()?EC(n.getState()):n.getState(),setState(e){n.setState(e)},patchState(e){n.patchState(e)}})}(this.context)}getState(){return this.ctx.getState()}dispatch(t){return this.ctx.dispatch(t)}patchState(t){this.ctx.patchState(t)}setState(t){this.ctx.setState(t)}reset(){this.ctx.setState(this.initialState),this.markAsDirtyAfterReset()}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=$i(n)))(i||n)}}(),n.\u0275prov=We({token:n,factory:n.\u0275fac}),Nr([dW(),rc("design:type",Object),rc("design:paramtypes",[])],n.prototype,"snapshot",null),Nr([RP(),zB(0,hW("patchValue")),rc("design:type",Function),rc("design:paramtypes",[Object]),rc("design:returntype",void 0)],n.prototype,"patchState",null),Nr([RP(),zB(0,hW("stateValue")),rc("design:type",Function),rc("design:paramtypes",[Object]),rc("design:returntype",void 0)],n.prototype,"setState",null),Nr([RP(),rc("design:type",Function),rc("design:paramtypes",[]),rc("design:returntype",void 0)],n.prototype,"reset",null),n})(),v7=(()=>{class n{constructor(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=kt({type:n,selectors:[["","gaEvent","","gaCategory",""],["","gaCategory",""]],inputs:{gaCategory:"gaCategory"},exportAs:["gaCategory"]}),n})();const Om=new zt("ngx-google-analytics-settings",{factory:()=>({trackingCode:"",enableTracing:!1})}),nF=new zt("ngx-window",{providedIn:"root",factory:()=>function(n){return Ef(n)?window:null}(Rc(Gc))}),RDe=new zt("ngx-data-layer",{providedIn:"root",factory:()=>function(n){return n?n.dataLayer=n.dataLayer||[]:null}(Rc(nF))}),iF=new zt("ngx-gtag-fn",{providedIn:"root",factory:()=>function(n,e){return n?n.gtag=n.gtag||function(){e.push(arguments)}:null}(Rc(nF),Rc(RDe))});let jC=(()=>{class n{constructor(t,i,r){this.settings=t,this._document=i,this._gtag=r}get document(){return this._document}throw(t){(this.settings.enableTracing||la())&&console&&console.error&&console.error(t)}toKeyValue(t){return t.size>0?Array.from(t).reduce((i,[r,s])=>Object.defineProperty(i,r,{value:s,enumerable:!0}),{}):void 0}gtag(...t){try{this._gtag(...t.filter(i=>void 0!==i))}catch(i){this.throw(i)}}event(t,i,r,s,o){try{const a=new Map;i&&a.set("event_category",i),r&&a.set("event_label",r),s&&a.set("value",s),void 0!==o&&a.set("interaction",o);const l=this.toKeyValue(a);l?this.gtag("event",t,l):this.gtag("event",t)}catch(a){this.throw(a)}}pageView(t,i,r,s){try{const o=new Map([["page_path",t]]);i&&o.set("page_title",i),(r||this.document)&&o.set("page_location",r||this.document.location.href),s&&Object.entries(s).map(([a,l])=>o.set(a,l)),this.gtag("config",this.settings.trackingCode,this.toKeyValue(o))}catch(o){this.throw(o)}}appView(t,i,r,s,o){try{const a=new Map([["screen_name",t],["app_name",i]]);r&&a.set("app_id",r),s&&a.set("app_version",s),o&&a.set("app_installer_id",o),this.gtag("event","screen_view",this.toKeyValue(a))}catch(a){this.throw(a)}}set(...t){try{this._gtag("set",...t)}catch(i){this.throw(i)}}exception(t,i){try{const r=new Map;t&&r.set("description",t),i&&r.set("fatal",i),this.toKeyValue(r)?this.gtag("event","exception",this.toKeyValue(r)):this.gtag("event","exception")}catch(r){this.throw(r)}}}return n.\u0275fac=function(t){return new(t||n)(Ie(Om),Ie(dn),Ie(iF))},n.\u0275prov=We({factory:function(){return new n(Ie(Om),Ie(dn),Ie(iF))},token:n,providedIn:"root"}),n})(),b7=(()=>{class n{constructor(t,i,r,s){this.gaCategoryDirective=t,this.gaService=i,this.settings=r,this.el=s,this.gaBind="click"}set gaBind(t){this.bindSubscription&&this.bindSubscription.unsubscribe(),this._gaBind=t,this.bindSubscription=dd(this.el.nativeElement,t).subscribe(()=>this.trigger())}get gaBind(){return this._gaBind}ngOnDestroy(){this.bindSubscription&&this.bindSubscription.unsubscribe()}trigger(){try{if(!this.gaAction&&!this.gaEvent)throw new Error("You must provide a gaAction attribute to identify this event.");this.gaService.event(this.gaAction||this.gaEvent,this.gaCategoryDirective?this.gaCategoryDirective.gaCategory:void 0,this.gaLabel||this.label,this.gaValue,this.gaInteraction)}catch(t){this.throw(t)}}throw(t){(la()||this.settings.enableTracing)&&console&&console.warn&&console.warn(t)}}return n.\u0275fac=function(t){return new(t||n)(De(v7,8),De(jC),De(Om),De(En))},n.\u0275dir=kt({type:n,selectors:[["","gaEvent",""]],inputs:{gaBind:"gaBind",gaAction:"gaAction",gaLabel:"gaLabel",label:"label",gaValue:"gaValue",gaInteraction:"gaInteraction",gaEvent:"gaEvent"},exportAs:["gaEvent"]}),n})();const PDe={provide:_f,multi:!0,useFactory:function(n,e,t){return()=>Ni(this,void 0,void 0,function*(){var i;if(!n.trackingCode)return void(la()||console.error("Empty tracking code for Google Analytics. Make sure to provide one when initializing NgxGoogleAnalyticsModule."));if(!e)return void(la()||console.error("Was not possible create or read gtag() fn. Make sure this module is running on a Browser w/ access to Window interface."));t||la()||console.error("Was not possible to access Document interface. Make sure this module is running on a Browser w/ access do Document interface."),n.uri=n.uri||`https://www.googletagmanager.com/gtag/js?id=${n.trackingCode}`,n.initCommands=null!==(i=null==n?void 0:n.initCommands)&&void 0!==i?i:[],n.initCommands.find(o=>"config"===o.command)||n.initCommands.unshift({command:"config",values:[n.trackingCode]}),n.initCommands.find(o=>"js"===o.command)||n.initCommands.unshift({command:"js",values:[new Date]});for(const o of n.initCommands)e(o.command,...o.values);const r=t.createElement("script");r.async=!0,r.src=n.uri,n.nonce&&r.setAttribute("nonce",n.nonce),t.getElementsByTagName("head")[0].appendChild(r)})},deps:[Om,iF,dn]};new zt("ngx-google-analytics-routing-settings",{factory:()=>({})});let UC=(()=>{class n{static forRoot(t,i=[],r,s,o){return{ngModule:n,providers:[{provide:Om,useValue:{trackingCode:t,initCommands:i,uri:r,enableTracing:s,nonce:o}},PDe]}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=ln({type:n}),n.\u0275inj=wt({imports:[[]]}),n})(),zC=(()=>{class n{constructor(){this.consent="not-set",this.consentChange=new xf(1),this.consentChange.next(this.consent)}ngOnDestroy(){this.consentChange.complete()}setConsent(t){this.consent!==t&&(this.consent=t,this.consentChange.next(t))}unsetConsent(){this.setConsent("not-set")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),BDe=(()=>{class n{constructor(t,i,{trackingCode:r}){this.window=i,this.subscriptions=new C,this.token=r,this.subscriptions.add(t.consentChange.subscribe(s=>this.toggleGoogleAnalytics("rescinded"===s)))}ngOnDestroy(){this.subscriptions.unsubscribe()}toggleGoogleAnalytics(t){this.window&&(this.window[`ga-disable-${this.token}`]=t)}}return n.\u0275fac=function(t){return new(t||n)(Ie(zC),Ie(nF),Ie(Om))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const VDe=new zt("Key under which consent is stored",{providedIn:"root",factory:()=>"ALLOW_TELEMETRY"}),S7=[zC,BDe,(()=>{class n{constructor(t,i){this.key=i,this.subscriptions=new C;try{this.storage=localStorage}catch(r){}t.setConsent(this.loadConsent()),this.subscriptions.add(t.consentChange.subscribe(r=>this.saveConsent(r)))}ngOnDestroy(){this.subscriptions.unsubscribe()}loadConsent(){var t,i;const r=null===(i=null===(t=this.storage)||void 0===t?void 0:t.getItem)||void 0===i?void 0:i.call(t,this.key);if(null==r)return"not-set";const s=r.trim().toLowerCase();switch(s){case"given":case"rescinded":return s;default:return"not-set"}}saveConsent(t){var i,r;null===(r=null===(i=this.storage)||void 0===i?void 0:i.setItem)||void 0===r||r.call(i,this.key,t)}}return n.\u0275fac=function(t){return new(t||n)(Ie(zC),Ie(VDe))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})()];function UDe(n){return Object.entries(n).reduce((e,[t,i])=>(null!=i&&(e[t]=`${i}`),e),{})}let HDe=(()=>{class n{static forRoot(t){const{providers:i=[]}=UC.forRoot(t.gaToken,function(n){const{appName:e,projectName:t,developmentMode:i}=n;return[{command:"set",values:[UDe({appName:e,projectName:t,developmentMode:i})]}]}(t));return{ngModule:n,providers:i}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=ln({type:n}),n.\u0275inj=wt({providers:[...S7,{provide:_f,multi:!0,useFactory:()=>()=>{},deps:S7}],imports:[[UC]]}),n})();const qDe=(n,e)=>JSON.stringify(n)===JSON.stringify(e),YDe=n=>n.map(e=>void 0!==e?JSON.parse(JSON.stringify(e)):e),_c={storageStrategy:class extends class{}{constructor(){super(...arguments),this.cachePairs=[]}add(e,t,i){this.cachePairs.push(e)}addMany(e){this.cachePairs=e}updateAtIndex(e,t){Object.assign(this.cachePairs[e],t)}update(e,t){Object.assign(this.cachePairs[e],t)}getAll(){return this.cachePairs}removeAtIndex(e){this.cachePairs.splice(e,1)}remove(e){this.cachePairs.splice(e,1)}removeAll(){this.cachePairs.length=0}},globalCacheKey:"CACHE_STORAGE",promiseImplementation:Promise},KDe=new se;function yc(n={}){return function(e,t,i){const r=n.cacheKey||e.constructor.name+"#"+t,s=i.value;if(i&&i.value){let o=n.storageStrategy?new n.storageStrategy:new _c.storageStrategy;const a=[];n.cacheModifier&&n.cacheModifier.subscribe(u=>o.addMany(u(o.getAll(r,this)),r,this)),Nn(KDe.asObservable(),n.cacheBusterObserver?n.cacheBusterObserver:o0()).subscribe(u=>{o.removeAll(r,this),a.length=0}),n.cacheResolver=n.cacheResolver||_c.cacheResolver||qDe,n.cacheHasher=n.cacheHasher||_c.cacheHasher||YDe,i.value=function(...u){const h=o.getAll(r,this);let p=n.cacheHasher(u),g=h.find(w=>n.cacheResolver(w.parameters,p));const m=a.find(w=>n.cacheResolver(w.parameters,p));if((n.maxAge||_c.maxAge)&&g&&g.created&&((new Date).getTime()-new Date(g.created).getTime()>(n.maxAge||_c.maxAge)?(o.remove?o.remove(h.indexOf(g),g,r,this):o.removeAtIndex(h.indexOf(g),r,this),g=null):(n.slidingExpiration||_c.slidingExpiration)&&(g.created=new Date,o.update?o.update(h.indexOf(g),g,r,this):o.updateAtIndex(h.indexOf(g),g,r,this))),g){const w=nn(g.response);return n.async?w.pipe(function(n,e=Ax){const i=function(n){return n instanceof Date&&!isNaN(+n)}(n)?+n-e.now():Math.abs(n);return r=>r.lift(new $xe(i,e))}(0)):w}if(m)return m.response;{const w=s.call(this,...u).pipe(function(n){return e=>e.lift(new NCe(n))}(()=>{const x=a.find(H=>n.cacheResolver(H.parameters,p));a.splice(a.indexOf(x),1)}),dr(x=>{(!n.shouldCacheDecider||n.shouldCacheDecider(x))&&((!(n.maxCacheCount||_c.maxCacheCount)||1===(n.maxCacheCount||_c.maxCacheCount)||(n.maxCacheCount||_c.maxCacheCount)&&(n.maxCacheCount||_c.maxCacheCount)<h.length+1)&&(o.remove?o.remove(0,h[0],r,this):o.removeAtIndex(0,r,this)),o.add({parameters:p,response:x,created:n.maxAge||_c.maxAge?new Date:null},r,this))}),function(n,e,t,i){const s=new xf(1,void 0,i);return o=>_a(()=>s,undefined)(o)}(),Gn());return a.push({parameters:p,response:w,created:new Date}),w}}}return i}}class XDe{encodeKey(e){return encodeURIComponent(e)}encodeValue(e){return encodeURIComponent(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const x7=new zt("basePath");class Rv{constructor(e={}){this.apiKeys=e.apiKeys,this.username=e.username,this.password=e.password,this.accessToken=e.accessToken,this.basePath=e.basePath,this.withCredentials=e.withCredentials,this.encoder=e.encoder,this.credentials=e.credentials?e.credentials:{}}selectHeaderContentType(e){if(0===e.length)return;const t=e.find(i=>this.isJsonMime(i));return void 0===t?e[0]:t}selectHeaderAccept(e){if(0===e.length)return;const t=e.find(i=>this.isJsonMime(i));return void 0===t?e[0]:t}isJsonMime(e){const t=new RegExp("^(application/json|[^;/ \t]+/[^;/ \t]+[+]json)[ \t]*(;.*)?$","i");return null!==e&&(t.test(e)||"application/json-patch+json"===e.toLowerCase())}lookupCredential(e){const t=this.credentials[e];return"function"==typeof t?t():t}}let C7=(()=>{class n{constructor(t,i,r){this.httpClient=t,this.basePath="/v1",this.defaultHeaders=new du,this.configuration=new Rv,r&&(this.configuration=r),"string"!=typeof this.configuration.basePath&&("string"!=typeof i&&(i=this.basePath),this.configuration.basePath=i),this.encoder=this.configuration.encoder||new XDe}addToHttpParams(t,i,r){return this.addToHttpParamsRecursive(t,i,r)}addToHttpParamsRecursive(t,i,r){if(null==i)return t;if("object"==typeof i)if(Array.isArray(i))i.forEach(s=>t=this.addToHttpParamsRecursive(t,s,r));else if(i instanceof Date){if(null==r)throw Error("key may not be null if value is Date");t=t.append(r,i.toISOString().substr(0,10))}else Object.keys(i).forEach(s=>t=this.addToHttpParamsRecursive(t,i[s],null!=r?`${r}.${s}`:s));else{if(null==r)throw Error("key may not be null if value is not object or array");t=t.append(r,i)}return t}aggregateResults(t,i="body",r=!1,s){const o=t.age,a=t.ageRange,l=t.bmi,c=t.bmiRange,u=t.cache,h=t.ontologyTerms,p=t.cellTypeTerms,g=t.providers,m=t.sex,w=t.spatial,x=t.technologies,H=t.token;let I=new Lr({encoder:this.encoder});null!=o&&(I=this.addToHttpParams(I,o,"age")),null!=a&&(I=this.addToHttpParams(I,a,"age-range")),null!=l&&(I=this.addToHttpParams(I,l,"bmi")),null!=c&&(I=this.addToHttpParams(I,c,"bmi-range")),null!=u&&(I=this.addToHttpParams(I,u,"cache")),h&&h.forEach(He=>{I=this.addToHttpParams(I,He,"ontology-terms")}),p&&p.forEach(He=>{I=this.addToHttpParams(I,He,"cell-type-terms")}),g&&g.forEach(He=>{I=this.addToHttpParams(I,He,"providers")}),null!=m&&(I=this.addToHttpParams(I,m,"sex")),w&&w.forEach(He=>{I=this.addToHttpParams(I,He,"spatial")}),x&&x.forEach(He=>{I=this.addToHttpParams(I,He,"technologies")}),null!=H&&(I=this.addToHttpParams(I,H,"token"));let oe=this.defaultHeaders,Se=s&&s.httpHeaderAccept;void 0===Se&&(Se=this.configuration.selectHeaderAccept(["application/json"])),void 0!==Se&&(oe=oe.set("Accept",Se));let Pe=s&&s.context;void 0===Pe&&(Pe=new Xs);let Be="json";return Se&&(Be=Se.startsWith("text")?"text":this.configuration.isJsonMime(Se)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/aggregate-results`,{context:Pe,params:I,responseType:Be,withCredentials:this.configuration.withCredentials,headers:oe,observe:i,reportProgress:r})}cellTypeTermOccurences(t,i="body",r=!1,s){const o=t.age,a=t.ageRange,l=t.bmi,c=t.bmiRange,u=t.cache,h=t.ontologyTerms,p=t.cellTypeTerms,g=t.providers,m=t.sex,w=t.spatial,x=t.technologies,H=t.token;let I=new Lr({encoder:this.encoder});null!=o&&(I=this.addToHttpParams(I,o,"age")),null!=a&&(I=this.addToHttpParams(I,a,"age-range")),null!=l&&(I=this.addToHttpParams(I,l,"bmi")),null!=c&&(I=this.addToHttpParams(I,c,"bmi-range")),null!=u&&(I=this.addToHttpParams(I,u,"cache")),h&&h.forEach(He=>{I=this.addToHttpParams(I,He,"ontology-terms")}),p&&p.forEach(He=>{I=this.addToHttpParams(I,He,"cell-type-terms")}),g&&g.forEach(He=>{I=this.addToHttpParams(I,He,"providers")}),null!=m&&(I=this.addToHttpParams(I,m,"sex")),w&&w.forEach(He=>{I=this.addToHttpParams(I,He,"spatial")}),x&&x.forEach(He=>{I=this.addToHttpParams(I,He,"technologies")}),null!=H&&(I=this.addToHttpParams(I,H,"token"));let oe=this.defaultHeaders,Se=s&&s.httpHeaderAccept;void 0===Se&&(Se=this.configuration.selectHeaderAccept(["application/json"])),void 0!==Se&&(oe=oe.set("Accept",Se));let Pe=s&&s.context;void 0===Pe&&(Pe=new Xs);let Be="json";return Se&&(Be=Se.startsWith("text")?"text":this.configuration.isJsonMime(Se)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/cell-type-term-occurences`,{context:Pe,params:I,responseType:Be,withCredentials:this.configuration.withCredentials,headers:oe,observe:i,reportProgress:r})}cellTypeTreeModel(t,i="body",r=!1,s){const o=t.cache,a=t.token;let l=new Lr({encoder:this.encoder});null!=o&&(l=this.addToHttpParams(l,o,"cache")),null!=a&&(l=this.addToHttpParams(l,a,"token"));let c=this.defaultHeaders,u=s&&s.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(c=c.set("Accept",u));let h=s&&s.context;void 0===h&&(h=new Xs);let p="json";return u&&(p=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/cell-type-tree-model`,{context:h,params:l,responseType:p,withCredentials:this.configuration.withCredentials,headers:c,observe:i,reportProgress:r})}dbStatus(t,i="body",r=!1,s){const o=t.token;let a=new Lr({encoder:this.encoder});null!=o&&(a=this.addToHttpParams(a,o,"token"));let l=this.defaultHeaders,c=s&&s.httpHeaderAccept;void 0===c&&(c=this.configuration.selectHeaderAccept(["application/json"])),void 0!==c&&(l=l.set("Accept",c));let u=s&&s.context;void 0===u&&(u=new Xs);let h="json";return c&&(h=c.startsWith("text")?"text":this.configuration.isJsonMime(c)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/db-status`,{context:u,params:a,responseType:h,withCredentials:this.configuration.withCredentials,headers:l,observe:i,reportProgress:r})}getSpatialPlacement(t,i="body",r=!1,s){const o=t.getSpatialPlacementRequest;if(null==o)throw new Error("Required parameter getSpatialPlacementRequest was null or undefined when calling getSpatialPlacement.");let a=this.defaultHeaders,l=s&&s.httpHeaderAccept;void 0===l&&(l=this.configuration.selectHeaderAccept(["application/json"])),void 0!==l&&(a=a.set("Accept",l));let c=s&&s.context;void 0===c&&(c=new Xs);const h=this.configuration.selectHeaderContentType(["application/json"]);void 0!==h&&(a=a.set("Content-Type",h));let p="json";return l&&(p=l.startsWith("text")?"text":this.configuration.isJsonMime(l)?"json":"blob"),this.httpClient.post(`${this.configuration.basePath}/get-spatial-placement`,o,{context:c,responseType:p,withCredentials:this.configuration.withCredentials,headers:a,observe:i,reportProgress:r})}gtexRuiLocations(t,i="body",r=!1,s){const o=t.cache;let a=new Lr({encoder:this.encoder});null!=o&&(a=this.addToHttpParams(a,o,"cache"));let l=this.defaultHeaders,c=s&&s.httpHeaderAccept;void 0===c&&(c=this.configuration.selectHeaderAccept(["application/json"])),void 0!==c&&(l=l.set("Accept",c));let u=s&&s.context;void 0===u&&(u=new Xs);let h="json";return c&&(h=c.startsWith("text")?"text":this.configuration.isJsonMime(c)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/gtex/rui_locations.jsonld`,{context:u,params:a,responseType:h,withCredentials:this.configuration.withCredentials,headers:l,observe:i,reportProgress:r})}hubmapRuiLocations(t,i="body",r=!1,s){const o=t.cache,a=t.token;let l=new Lr({encoder:this.encoder});null!=o&&(l=this.addToHttpParams(l,o,"cache")),null!=a&&(l=this.addToHttpParams(l,a,"token"));let c=this.defaultHeaders,u=s&&s.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(c=c.set("Accept",u));let h=s&&s.context;void 0===h&&(h=new Xs);let p="json";return u&&(p=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/hubmap/rui_locations.jsonld`,{context:h,params:l,responseType:p,withCredentials:this.configuration.withCredentials,headers:c,observe:i,reportProgress:r})}ontologyTermOccurences(t,i="body",r=!1,s){const o=t.age,a=t.ageRange,l=t.bmi,c=t.bmiRange,u=t.cache,h=t.ontologyTerms,p=t.cellTypeTerms,g=t.providers,m=t.sex,w=t.spatial,x=t.technologies,H=t.token;let I=new Lr({encoder:this.encoder});null!=o&&(I=this.addToHttpParams(I,o,"age")),null!=a&&(I=this.addToHttpParams(I,a,"age-range")),null!=l&&(I=this.addToHttpParams(I,l,"bmi")),null!=c&&(I=this.addToHttpParams(I,c,"bmi-range")),null!=u&&(I=this.addToHttpParams(I,u,"cache")),h&&h.forEach(He=>{I=this.addToHttpParams(I,He,"ontology-terms")}),p&&p.forEach(He=>{I=this.addToHttpParams(I,He,"cell-type-terms")}),g&&g.forEach(He=>{I=this.addToHttpParams(I,He,"providers")}),null!=m&&(I=this.addToHttpParams(I,m,"sex")),w&&w.forEach(He=>{I=this.addToHttpParams(I,He,"spatial")}),x&&x.forEach(He=>{I=this.addToHttpParams(I,He,"technologies")}),null!=H&&(I=this.addToHttpParams(I,H,"token"));let oe=this.defaultHeaders,Se=s&&s.httpHeaderAccept;void 0===Se&&(Se=this.configuration.selectHeaderAccept(["application/json"])),void 0!==Se&&(oe=oe.set("Accept",Se));let Pe=s&&s.context;void 0===Pe&&(Pe=new Xs);let Be="json";return Se&&(Be=Se.startsWith("text")?"text":this.configuration.isJsonMime(Se)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/ontology-term-occurences`,{context:Pe,params:I,responseType:Be,withCredentials:this.configuration.withCredentials,headers:oe,observe:i,reportProgress:r})}ontologyTreeModel(t,i="body",r=!1,s){const o=t.cache,a=t.token;let l=new Lr({encoder:this.encoder});null!=o&&(l=this.addToHttpParams(l,o,"cache")),null!=a&&(l=this.addToHttpParams(l,a,"token"));let c=this.defaultHeaders,u=s&&s.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(c=c.set("Accept",u));let h=s&&s.context;void 0===h&&(h=new Xs);let p="json";return u&&(p=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/ontology-tree-model`,{context:h,params:l,responseType:p,withCredentials:this.configuration.withCredentials,headers:c,observe:i,reportProgress:r})}providerNames(t,i="body",r=!1,s){const o=t.cache,a=t.token;let l=new Lr({encoder:this.encoder});null!=o&&(l=this.addToHttpParams(l,o,"cache")),null!=a&&(l=this.addToHttpParams(l,a,"token"));let c=this.defaultHeaders,u=s&&s.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(c=c.set("Accept",u));let h=s&&s.context;void 0===h&&(h=new Xs);let p="json";return u&&(p=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/provider-names`,{context:h,params:l,responseType:p,withCredentials:this.configuration.withCredentials,headers:c,observe:i,reportProgress:r})}referenceOrganScene(t,i="body",r=!1,s){const o=t.organIri;if(null==o)throw new Error("Required parameter organIri was null or undefined when calling referenceOrganScene.");const a=t.age,l=t.ageRange,c=t.bmi,u=t.bmiRange,h=t.cache,p=t.ontologyTerms,g=t.cellTypeTerms,m=t.providers,w=t.sex,x=t.spatial,H=t.technologies,I=t.token;let oe=new Lr({encoder:this.encoder});null!=a&&(oe=this.addToHttpParams(oe,a,"age")),null!=l&&(oe=this.addToHttpParams(oe,l,"age-range")),null!=c&&(oe=this.addToHttpParams(oe,c,"bmi")),null!=u&&(oe=this.addToHttpParams(oe,u,"bmi-range")),null!=h&&(oe=this.addToHttpParams(oe,h,"cache")),p&&p.forEach(vt=>{oe=this.addToHttpParams(oe,vt,"ontology-terms")}),g&&g.forEach(vt=>{oe=this.addToHttpParams(oe,vt,"cell-type-terms")}),null!=o&&(oe=this.addToHttpParams(oe,o,"organ-iri")),m&&m.forEach(vt=>{oe=this.addToHttpParams(oe,vt,"providers")}),null!=w&&(oe=this.addToHttpParams(oe,w,"sex")),x&&x.forEach(vt=>{oe=this.addToHttpParams(oe,vt,"spatial")}),H&&H.forEach(vt=>{oe=this.addToHttpParams(oe,vt,"technologies")}),null!=I&&(oe=this.addToHttpParams(oe,I,"token"));let Se=this.defaultHeaders,Pe=s&&s.httpHeaderAccept;void 0===Pe&&(Pe=this.configuration.selectHeaderAccept(["application/json"])),void 0!==Pe&&(Se=Se.set("Accept",Pe));let Be=s&&s.context;void 0===Be&&(Be=new Xs);let He="json";return Pe&&(He=Pe.startsWith("text")?"text":this.configuration.isJsonMime(Pe)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/reference-organ-scene`,{context:Be,params:oe,responseType:He,withCredentials:this.configuration.withCredentials,headers:Se,observe:i,reportProgress:r})}referenceOrgans(t,i="body",r=!1,s){const o=t.cache,a=t.token;let l=new Lr({encoder:this.encoder});null!=o&&(l=this.addToHttpParams(l,o,"cache")),null!=a&&(l=this.addToHttpParams(l,a,"token"));let c=this.defaultHeaders,u=s&&s.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(c=c.set("Accept",u));let h=s&&s.context;void 0===h&&(h=new Xs);let p="json";return u&&(p=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/reference-organs`,{context:h,params:l,responseType:p,withCredentials:this.configuration.withCredentials,headers:c,observe:i,reportProgress:r})}scene(t,i="body",r=!1,s){const o=t.age,a=t.ageRange,l=t.bmi,c=t.bmiRange,u=t.cache,h=t.ontologyTerms,p=t.cellTypeTerms,g=t.providers,m=t.sex,w=t.spatial,x=t.technologies,H=t.token;let I=new Lr({encoder:this.encoder});null!=o&&(I=this.addToHttpParams(I,o,"age")),null!=a&&(I=this.addToHttpParams(I,a,"age-range")),null!=l&&(I=this.addToHttpParams(I,l,"bmi")),null!=c&&(I=this.addToHttpParams(I,c,"bmi-range")),null!=u&&(I=this.addToHttpParams(I,u,"cache")),h&&h.forEach(He=>{I=this.addToHttpParams(I,He,"ontology-terms")}),p&&p.forEach(He=>{I=this.addToHttpParams(I,He,"cell-type-terms")}),g&&g.forEach(He=>{I=this.addToHttpParams(I,He,"providers")}),null!=m&&(I=this.addToHttpParams(I,m,"sex")),w&&w.forEach(He=>{I=this.addToHttpParams(I,He,"spatial")}),x&&x.forEach(He=>{I=this.addToHttpParams(I,He,"technologies")}),null!=H&&(I=this.addToHttpParams(I,H,"token"));let oe=this.defaultHeaders,Se=s&&s.httpHeaderAccept;void 0===Se&&(Se=this.configuration.selectHeaderAccept(["application/json"])),void 0!==Se&&(oe=oe.set("Accept",Se));let Pe=s&&s.context;void 0===Pe&&(Pe=new Xs);let Be="json";return Se&&(Be=Se.startsWith("text")?"text":this.configuration.isJsonMime(Se)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/scene`,{context:Pe,params:I,responseType:Be,withCredentials:this.configuration.withCredentials,headers:oe,observe:i,reportProgress:r})}sparql(t,i="body",r=!1,s){const o=t.query;if(null==o)throw new Error("Required parameter query was null or undefined when calling sparql.");const a=t.token,l=t.format;let c=new Lr({encoder:this.encoder});null!=o&&(c=this.addToHttpParams(c,o,"query")),null!=a&&(c=this.addToHttpParams(c,a,"token")),null!=l&&(c=this.addToHttpParams(c,l,"format"));let u=this.defaultHeaders,h=s&&s.httpHeaderAccept;void 0===h&&(h=this.configuration.selectHeaderAccept(["application/json"])),void 0!==h&&(u=u.set("Accept",h));let p=s&&s.context;void 0===p&&(p=new Xs);let g="json";return h&&(g=h.startsWith("text")?"text":this.configuration.isJsonMime(h)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/sparql`,{context:p,params:c,responseType:g,withCredentials:this.configuration.withCredentials,headers:u,observe:i,reportProgress:r})}sparqlPost(t,i="body",r=!1,s){const o=t.sparqlQueryRequest;if(null==o)throw new Error("Required parameter sparqlQueryRequest was null or undefined when calling sparqlPost.");const a=t.token,l=t.format;let c=new Lr({encoder:this.encoder});null!=a&&(c=this.addToHttpParams(c,a,"token")),null!=l&&(c=this.addToHttpParams(c,l,"format"));let u=this.defaultHeaders,h=s&&s.httpHeaderAccept;void 0===h&&(h=this.configuration.selectHeaderAccept(["application/json"])),void 0!==h&&(u=u.set("Accept",h));let p=s&&s.context;void 0===p&&(p=new Xs);const m=this.configuration.selectHeaderContentType(["application/json","application/x-www-form-urlencoded"]);void 0!==m&&(u=u.set("Content-Type",m));let w="json";return h&&(w=h.startsWith("text")?"text":this.configuration.isJsonMime(h)?"json":"blob"),this.httpClient.post(`${this.configuration.basePath}/sparql`,o,{context:p,params:c,responseType:w,withCredentials:this.configuration.withCredentials,headers:u,observe:i,reportProgress:r})}technologyNames(t,i="body",r=!1,s){const o=t.cache,a=t.token;let l=new Lr({encoder:this.encoder});null!=o&&(l=this.addToHttpParams(l,o,"cache")),null!=a&&(l=this.addToHttpParams(l,a,"token"));let c=this.defaultHeaders,u=s&&s.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(c=c.set("Accept",u));let h=s&&s.context;void 0===h&&(h=new Xs);let p="json";return u&&(p=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/technology-names`,{context:h,params:l,responseType:p,withCredentials:this.configuration.withCredentials,headers:c,observe:i,reportProgress:r})}tissueBlocks(t,i="body",r=!1,s){const o=t.age,a=t.ageRange,l=t.bmi,c=t.bmiRange,u=t.cache,h=t.ontologyTerms,p=t.cellTypeTerms,g=t.providers,m=t.sex,w=t.spatial,x=t.technologies,H=t.token;let I=new Lr({encoder:this.encoder});null!=o&&(I=this.addToHttpParams(I,o,"age")),null!=a&&(I=this.addToHttpParams(I,a,"age-range")),null!=l&&(I=this.addToHttpParams(I,l,"bmi")),null!=c&&(I=this.addToHttpParams(I,c,"bmi-range")),null!=u&&(I=this.addToHttpParams(I,u,"cache")),h&&h.forEach(He=>{I=this.addToHttpParams(I,He,"ontology-terms")}),p&&p.forEach(He=>{I=this.addToHttpParams(I,He,"cell-type-terms")}),g&&g.forEach(He=>{I=this.addToHttpParams(I,He,"providers")}),null!=m&&(I=this.addToHttpParams(I,m,"sex")),w&&w.forEach(He=>{I=this.addToHttpParams(I,He,"spatial")}),x&&x.forEach(He=>{I=this.addToHttpParams(I,He,"technologies")}),null!=H&&(I=this.addToHttpParams(I,H,"token"));let oe=this.defaultHeaders,Se=s&&s.httpHeaderAccept;void 0===Se&&(Se=this.configuration.selectHeaderAccept(["application/json"])),void 0!==Se&&(oe=oe.set("Accept",Se));let Pe=s&&s.context;void 0===Pe&&(Pe=new Xs);let Be="json";return Se&&(Be=Se.startsWith("text")?"text":this.configuration.isJsonMime(Se)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/tissue-blocks`,{context:Pe,params:I,responseType:Be,withCredentials:this.configuration.withCredentials,headers:oe,observe:i,reportProgress:r})}}return n.\u0275fac=function(t){return new(t||n)(Ie(hd),Ie(x7,8),Ie(Rv,8))},n.\u0275prov=We({factory:function(){return new n(Ie(hd),Ie(x7,8),Ie(Rv,8))},token:n,providedIn:"root"}),n})(),QDe=(()=>{class n{constructor(t,i){if(t)throw new Error("CcfApiModule is already loaded. Import in your base AppModule only.");if(!i)throw new Error("You need to import the HttpClientModule in your AppModule! \nSee also https://github.com/angular/angular/issues/20575")}static forRoot(t){return{ngModule:n,providers:[{provide:Rv,useFactory:t}]}}}return n.\u0275fac=function(t){return new(t||n)(Ie(n,12),Ie(hd,8))},n.\u0275mod=ln({type:n}),n.\u0275inj=wt({providers:[],imports:[[]]}),n})();function pu(n){return new Promise((e,t)=>{n.oncomplete=n.onsuccess=()=>e(n.result),n.onabort=n.onerror=()=>t(n.error)})}let rF;function vc(){return rF||(rF=function(n,e){const t=function(){if(navigator.userAgentData||!/Safari\//.test(navigator.userAgent)||/Chrom(e|ium)\//.test(navigator.userAgent)||!indexedDB.databases)return Promise.resolve();let e;return new Promise(t=>{const i=()=>indexedDB.databases().finally(t);e=setInterval(i,100),i()}).finally(()=>clearInterval(e))}().then(()=>{const i=indexedDB.open("keyval-store");return i.onupgradeneeded=()=>i.result.createObjectStore(e),pu(i)});return(i,r)=>t.then(s=>r(s.transaction(e,i).objectStore(e)))}(0,"keyval")),rF}function T7(n,e=vc()){return e("readonly",t=>pu(t.get(n)))}var Jn=nt(440);const HC="Unknown Euler angle order",Rm=.99999;class Xi extends ZE{static get ZYX(){return 0}static get YXZ(){return 1}static get XZY(){return 2}static get ZXY(){return 3}static get YZX(){return 4}static get XYZ(){return 5}static get RollPitchYaw(){return 0}static get DefaultOrder(){return Xi.ZYX}static get RotationOrders(){return["ZYX","YXZ","XZY","ZXY","YZX","XYZ"]}static rotationOrder(e){return Xi.RotationOrders[e]}get ELEMENTS(){return 4}constructor(e=0,t=0,i=0,r=Xi.DefaultOrder){super(-0,-0,-0,-0),arguments.length>0&&Array.isArray(arguments[0])?this.fromVector3(...arguments):this.set(e,t,i,r)}fromQuaternion(e){const[t,i,r,s]=e,o=i*i,a=-2*(o+r*r)+1,l=2*(t*i+s*r);let c=-2*(t*r-s*i);c=c>1?1:c,c=c<-1?-1:c;const p=Math.atan2(2*(i*r+s*t),-2*(t*t+o)+1),g=Math.asin(c),m=Math.atan2(l,a);return new Xi(p,g,m,Xi.RollPitchYaw)}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=Number.isFinite(e[3])||this.order,this.check()}set(e=0,t=0,i=0,r){return this[0]=e,this[1]=t,this[2]=i,this[3]=Number.isFinite(r)?r:this[3],this.check()}validate(){return function(n){return n>=0&&n<6}(this[3])&&Number.isFinite(this[0])&&Number.isFinite(this[1])&&Number.isFinite(this[2])}toArray(e=[],t=0){return e[t]=this[0],e[t+1]=this[1],e[t+2]=this[2],e}toArray4(e=[],t=0){return e[t]=this[0],e[t+1]=this[1],e[t+2]=this[2],e[t+3]=this[3],e}toVector3(e=[-0,-0,-0]){return e[0]=this[0],e[1]=this[1],e[2]=this[2],e}get x(){return this[0]}set x(e){this[0]=tr(e)}get y(){return this[1]}set y(e){this[1]=tr(e)}get z(){return this[2]}set z(e){this[2]=tr(e)}get alpha(){return this[0]}set alpha(e){this[0]=tr(e)}get beta(){return this[1]}set beta(e){this[1]=tr(e)}get gamma(){return this[2]}set gamma(e){this[2]=tr(e)}get phi(){return this[0]}set phi(e){this[0]=tr(e)}get theta(){return this[1]}set theta(e){this[1]=tr(e)}get psi(){return this[2]}set psi(e){this[2]=tr(e)}get roll(){return this[0]}set roll(e){this[0]=tr(e)}get pitch(){return this[1]}set pitch(e){this[1]=tr(e)}get yaw(){return this[2]}set yaw(e){this[2]=tr(e)}get order(){return this[3]}set order(e){this[3]=function(n){if(n<0&&n>=6)throw new Error(HC);return n}(e)}fromVector3(e,t){return this.set(e[0],e[1],e[2],Number.isFinite(t)?t:this[3])}fromArray(e,t=0){return this[0]=e[0+t],this[1]=e[1+t],this[2]=e[2+t],void 0!==e[3]&&(this[3]=e[3]),this.check()}fromRollPitchYaw(e,t,i){return this.set(e,t,i,Xi.ZYX)}fromRotationMatrix(e,t=Xi.DefaultOrder){return this._fromRotationMatrix(e,t),this.check()}getRotationMatrix(e){return this._getRotationMatrix(e)}getQuaternion(){const e=new WO;switch(this[4]){case Xi.XYZ:return e.rotateX(this[0]).rotateY(this[1]).rotateZ(this[2]);case Xi.YXZ:return e.rotateY(this[0]).rotateX(this[1]).rotateZ(this[2]);case Xi.ZXY:return e.rotateZ(this[0]).rotateX(this[1]).rotateY(this[2]);case Xi.ZYX:return e.rotateZ(this[0]).rotateY(this[1]).rotateX(this[2]);case Xi.YZX:return e.rotateY(this[0]).rotateZ(this[1]).rotateX(this[2]);case Xi.XZY:return e.rotateX(this[0]).rotateZ(this[1]).rotateY(this[2]);default:throw new Error(HC)}}_fromRotationMatrix(e,t=Xi.DefaultOrder){const i=e.elements,r=i[0],s=i[4],o=i[8],a=i[1],l=i[5],c=i[9],u=i[2],h=i[6],p=i[10];switch(t=t||this[3]){case Xi.XYZ:this[1]=Math.asin(Fa(o,-1,1)),Math.abs(o)<Rm?(this[0]=Math.atan2(-c,p),this[2]=Math.atan2(-s,r)):(this[0]=Math.atan2(h,l),this[2]=0);break;case Xi.YXZ:this[0]=Math.asin(-Fa(c,-1,1)),Math.abs(c)<Rm?(this[1]=Math.atan2(o,p),this[2]=Math.atan2(a,l)):(this[1]=Math.atan2(-u,r),this[2]=0);break;case Xi.ZXY:this[0]=Math.asin(Fa(h,-1,1)),Math.abs(h)<Rm?(this[1]=Math.atan2(-u,p),this[2]=Math.atan2(-s,l)):(this[1]=0,this[2]=Math.atan2(a,r));break;case Xi.ZYX:this[1]=Math.asin(-Fa(u,-1,1)),Math.abs(u)<Rm?(this[0]=Math.atan2(h,p),this[2]=Math.atan2(a,r)):(this[0]=0,this[2]=Math.atan2(-s,l));break;case Xi.YZX:this[2]=Math.asin(Fa(a,-1,1)),Math.abs(a)<Rm?(this[0]=Math.atan2(-c,l),this[1]=Math.atan2(-u,r)):(this[0]=0,this[1]=Math.atan2(o,p));break;case Xi.XZY:this[2]=Math.asin(-Fa(s,-1,1)),Math.abs(s)<Rm?(this[0]=Math.atan2(h,l),this[1]=Math.atan2(o,r)):(this[0]=Math.atan2(-c,p),this[1]=0);break;default:throw new Error(HC)}return this[3]=t,this}_getRotationMatrix(e){const t=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],i=this.x,r=this.y,s=this.z,o=Math.cos(i),a=Math.cos(r),l=Math.cos(s),c=Math.sin(i),u=Math.sin(r),h=Math.sin(s);switch(this[3]){case Xi.XYZ:{const p=o*l,g=o*h,m=c*l,w=c*h;t[0]=a*l,t[4]=-a*h,t[8]=u,t[1]=g+m*u,t[5]=p-w*u,t[9]=-c*a,t[2]=w-p*u,t[6]=m+g*u,t[10]=o*a;break}case Xi.YXZ:{const p=a*l,g=a*h,m=u*l,w=u*h;t[0]=p+w*c,t[4]=m*c-g,t[8]=o*u,t[1]=o*h,t[5]=o*l,t[9]=-c,t[2]=g*c-m,t[6]=w+p*c,t[10]=o*a;break}case Xi.ZXY:{const p=a*l,g=a*h,m=u*l,w=u*h;t[0]=p-w*c,t[4]=-o*h,t[8]=m+g*c,t[1]=g+m*c,t[5]=o*l,t[9]=w-p*c,t[2]=-o*u,t[6]=c,t[10]=o*a;break}case Xi.ZYX:{const p=o*l,g=o*h,m=c*l,w=c*h;t[0]=a*l,t[4]=m*u-g,t[8]=p*u+w,t[1]=a*h,t[5]=w*u+p,t[9]=g*u-m,t[2]=-u,t[6]=c*a,t[10]=o*a;break}case Xi.YZX:{const p=o*a,g=o*u,m=c*a,w=c*u;t[0]=a*l,t[4]=w-p*h,t[8]=m*h+g,t[1]=h,t[5]=o*l,t[9]=-c*l,t[2]=-u*l,t[6]=g*h+m,t[10]=p-w*h;break}case Xi.XZY:{const p=o*a,g=o*u,m=c*a,w=c*u;t[0]=a*l,t[4]=-h,t[8]=u*l,t[1]=p*h+w,t[5]=o*l,t[9]=g*h-m,t[2]=m*h-g,t[6]=c*l,t[10]=w*h+p;break}default:throw new Error(HC)}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}toQuaternion(){const e=Math.cos(.5*this.yaw),t=Math.sin(.5*this.yaw),i=Math.cos(.5*this.roll),r=Math.sin(.5*this.roll),s=Math.cos(.5*this.pitch),o=Math.sin(.5*this.pitch);return new WO(e*r*s-t*i*o,e*i*o+t*r*s,t*i*s-e*r*o,e*i*s+t*r*o)}}const A7=Object.freeze([1,0,0,0,1,0,0,0,1]),sIe=Object.freeze([0,0,0,0,0,0,0,0,0]),oIe=Object.freeze({COL0ROW0:0,COL0ROW1:1,COL0ROW2:2,COL1ROW0:3,COL1ROW1:4,COL1ROW2:5,COL2ROW0:6,COL2ROW1:7,COL2ROW2:8}),Nm={};class Nv extends tU{static get IDENTITY(){return Nm.IDENTITY=Nm.IDENTITY||Object.freeze(new Nv(A7)),Nm.IDENTITY}static get ZERO(){return Nm.ZERO=Nm.ZERO||Object.freeze(new Nv(sIe)),Nm.ZERO}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return oIe}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this.check()}set(e,t,i,r,s,o,a,l,c){return this[0]=e,this[1]=t,this[2]=i,this[3]=r,this[4]=s,this[5]=o,this[6]=a,this[7]=l,this[8]=c,this.check()}setRowMajor(e,t,i,r,s,o,a,l,c){return this[0]=e,this[1]=r,this[2]=a,this[3]=t,this[4]=s,this[5]=l,this[6]=i,this[7]=o,this[8]=c,this.check()}determinant(){return a4(this)}identity(){return this.copy(A7)}fromQuaternion(e){return u4(this,e),this.check()}transpose(){return s4(this,this),this.check()}invert(){return o4(this,this),this.check()}multiplyLeft(e){return jS(this,e,this),this.check()}multiplyRight(e){return jS(this,this,e),this.check()}rotate(e){return c4(this,this,e),this.check()}scale(e){return Array.isArray(e)?US(this,this,e):US(this,this,[e,e,e]),this.check()}translate(e){return l4(this,this,e),this.check()}transform(e,t){switch(e.length){case 2:t=rU(t||[-0,-0],e,this);break;case 3:t=JE(t||[-0,-0,-0],e,this);break;case 4:t=function(n,e,t){const i=e[0],r=e[1],s=e[2];return n[0]=t[0]*i+t[3]*r+t[6]*s,n[1]=t[1]*i+t[4]*r+t[7]*s,n[2]=t[2]*i+t[5]*r+t[8]*s,n[3]=e[3],n}(t||[-0,-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return m0(t,e.length),t}transformVector(e,t){return Bg("Matrix3.transformVector"),this.transform(e,t)}transformVector2(e,t){return Bg("Matrix3.transformVector"),this.transform(e,t)}transformVector3(e,t){return Bg("Matrix3.transformVector"),this.transform(e,t)}}var GC,aIe=nt(698),lIe=nt(445),cIe=nt.n(lIe),Ar=nt(815),uIe=new Uint8Array(16);function dIe(){if(!GC&&!(GC="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return GC(uIe)}const hIe=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,pIe=function(n){return"string"==typeof n&&hIe.test(n)};for(var lo=[],oF=0;oF<256;++oF)lo.push((oF+256).toString(16).substr(1));const yIe=function(n,e,t){var i=(n=n||{}).random||(n.rng||dIe)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,e){t=t||0;for(var r=0;r<16;++r)e[t+r]=i[r];return e}return function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=(lo[n[e+0]]+lo[n[e+1]]+lo[n[e+2]]+lo[n[e+3]]+"-"+lo[n[e+4]]+lo[n[e+5]]+"-"+lo[n[e+6]]+lo[n[e+7]]+"-"+lo[n[e+8]]+lo[n[e+9]]+"-"+lo[n[e+10]]+lo[n[e+11]]+lo[n[e+12]]+lo[n[e+13]]+lo[n[e+14]]+lo[n[e+15]]).toLowerCase();if(!pIe(t))throw TypeError("Stringified UUID is invalid");return t}(i)};var $C=nt(609);const Pm=Object.freeze({OUTSIDE:-1,INTERSECTING:0,INSIDE:1}),Mr=(Math,Math,{});function EIe(n,{precision:e=Mr.precision||4}={}){return n=function(n){return Math.round(n/Mr.EPSILON)*Mr.EPSILON}(n),"".concat(parseFloat(n.toPrecision(e)))}function xh(n){return Array.isArray(n)||ArrayBuffer.isView(n)&&!(n instanceof DataView)}function Pv(n,e,t){const i=Mr.EPSILON;t&&(Mr.EPSILON=t);try{if(n===e)return!0;if(xh(n)&&xh(e)){if(n.length!==e.length)return!1;for(let r=0;r<n.length;++r)if(!Pv(n[r],e[r]))return!1;return!0}return n&&n.equals?n.equals(e):e&&e.equals?e.equals(n):!(!Number.isFinite(n)||!Number.isFinite(e))&&Math.abs(n-e)<=Mr.EPSILON*Math.max(1,Math.abs(n),Math.abs(e))}finally{Mr.EPSILON=i}}function bc(n,e){if(!n)throw new Error("math.gl assertion ".concat(e))}Mr.EPSILON=1e-12,Mr.debug=!1,Mr.precision=4,Mr.printTypes=!1,Mr.printDegrees=!1,Mr.printRowMajor=!0;class aF extends(function(n){function e(){var t=Reflect.construct(n,Array.from(arguments));return Object.setPrototypeOf(t,Object.getPrototypeOf(this)),t}return e.prototype=Object.create(n.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,n):e.__proto__=n,e}(Array)){get ELEMENTS(){return bc(!1),0}clone(){return(new this.constructor).copy(this)}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}fromArray(e,t=0){for(let i=0;i<this.ELEMENTS;++i)this[i]=e[i+t];return this.check()}to(e){return e===this?this:xh(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toArray(e=[],t=0){for(let i=0;i<this.ELEMENTS;++i)e[t+i]=this[i];return e}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(Mr)}formatString(e){let t="";for(let i=0;i<this.ELEMENTS;++i)t+=(i>0?", ":"")+EIe(this[i],e);return"".concat(e.printTypes?this.constructor.name:"","[").concat(t,"]")}equals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(!Pv(this[t],e[t]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(this[t]!==e[t])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,t,i){void 0===i&&(i=t,t=e,e=this);for(let r=0;r<this.ELEMENTS;++r){const s=e[r];this[r]=s+i*(t[r]-s)}return this.check()}min(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.min(e[t],this[t]);return this.check()}max(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.max(e[t],this[t]);return this.check()}clamp(e,t){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(Math.max(this[i],e[i]),t[i]);return this.check()}add(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]+=t[i];return this.check()}subtract(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]-=t[i];return this.check()}scale(e){if(Array.isArray(e))return this.multiply(e);for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}sub(e){return this.subtract(e)}setScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=e;return this.check()}addScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}divideScalar(e){return this.scale(1/e)}clampScalar(e,t){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(Math.max(this[i],e),t);return this.check()}multiplyByScalar(e){return this.scale(e)}get elements(){return this}check(){if(Mr.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let e=this.length===this.ELEMENTS;for(let t=0;t<this.ELEMENTS;++t)e=e&&Number.isFinite(this[t]);return e}}function co(n){if(!Number.isFinite(n))throw new Error("Invalid number ".concat(n));return n}function M7(n,e,t=""){if(Mr.debug&&!function(n,e){if(n.length!==e)return!1;for(let t=0;t<n.length;++t)if(!Number.isFinite(n[t]))return!1;return!0}(n,e))throw new Error("math.gl: ".concat(t," some fields set to invalid numbers'"));return n}const D7={};function lF(n,e){D7[n]||(D7[n]=!0,console.warn("".concat(n," has been removed in version ").concat(e,", see upgrade guide for more information")))}class IIe extends aF{get ELEMENTS(){return bc(!1),0}copy(e){return bc(!1),this}get x(){return this[0]}set x(e){this[0]=co(e)}get y(){return this[1]}set y(e){this[1]=co(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let t=0;t<this.ELEMENTS;++t)e+=this[t]*this[t];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let t=0;for(let i=0;i<this.ELEMENTS;++i){const r=this[i]-e[i];t+=r*r}return co(t)}dot(e){let t=0;for(let i=0;i<this.ELEMENTS;++i)t+=this[i]*e[i];return co(t)}normalize(){const e=this.magnitude();if(0!==e)for(let t=0;t<this.ELEMENTS;++t)this[t]/=e;return this.check()}multiply(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]*=t[i];return this.check()}divide(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]/=t[i];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return bc(e>=0&&e<this.ELEMENTS,"index is out of range"),co(this[e])}setComponent(e,t){return bc(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=t,this.check()}addVectors(e,t){return this.copy(e).add(t)}subVectors(e,t){return this.copy(e).subtract(t)}multiplyVectors(e,t){return this.copy(e).multiply(t)}addScaledVector(e,t){return this.add(new this.constructor(e).multiplyScalar(t))}}const cF=[0,0,0],I7={};class Rn extends IIe{static get ZERO(){return I7.ZERO=I7.ZERO||Object.freeze(new Rn(0,0,0,0))}constructor(e=0,t=0,i=0){super(-0,-0,-0),1===arguments.length&&xh(e)?this.copy(e):(Mr.debug&&(co(e),co(t),co(i)),this[0]=e,this[1]=t,this[2]=i)}set(e,t,i){return this[0]=e,this[1]=t,this[2]=i,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return Mr.debug&&(co(e.x),co(e.y),co(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=co(e)}angle(e){return WV(this,e)}cross(e){return _0(this,this,e),this.check()}rotateX({radians:e,origin:t=cF}){return HV(this,this,t,e),this.check()}rotateY({radians:e,origin:t=cF}){return GV(this,this,t,e),this.check()}rotateZ({radians:e,origin:t=cF}){return $V(this,this,t,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return ZD(this,this,e),this.check()}transformAsVector(e){return function(n,e,t){const i=e[0],r=e[1],s=e[2],o=t[3]*i+t[7]*r+t[11]*s||1;n[0]=(t[0]*i+t[4]*r+t[8]*s)/o,n[1]=(t[1]*i+t[5]*r+t[9]*s)/o,n[2]=(t[2]*i+t[6]*r+t[10]*s)/o}(this,this,e),this.check()}transformByMatrix3(e){return JE(this,this,e),this.check()}transformByMatrix2(e){return function(n,e,t){const i=e[0],r=e[1];n[0]=t[0]*i+t[2]*r,n[1]=t[1]*i+t[3]*r,n[2]=e[2]}(this,this,e),this.check()}transformByQuaternion(e){return zV(this,this,e),this.check()}}new Rn,new Rn;const Fv=new Rn,N7=new Rn;class uF{constructor(e=[0,0,0],t=0){this.radius=-0,this.center=new Rn,this.fromCenterRadius(e,t)}fromCenterRadius(e,t){return this.center.from(e),this.radius=t,this}fromCornerPoints(e,t){return t=Fv.from(t),this.center=(new Rn).from(e).add(t).scale(.5),this.radius=this.center.distance(t),this}equals(e){return this===e||Boolean(e)&&this.center.equals(e.center)&&this.radius===e.radius}clone(){return new uF(this.center,this.radius)}union(e){const t=this.center,i=this.radius,s=e.radius,o=Fv.copy(e.center).subtract(t),a=o.magnitude();if(i>=a+s)return this.clone();if(s>=a+i)return e.clone();const l=.5*(i+a+s);return N7.copy(o).scale((-i+l)/a).add(t),this.center.copy(N7),this.radius=l,this}expand(e){const t=(e=Fv.from(e)).subtract(this.center).magnitude();return t>this.radius&&(this.radius=t),this}transform(e){this.center.transform(e);const t=function(n,e){var s=e[4],o=e[5],a=e[6],l=e[8],c=e[9],u=e[10];return n[0]=Math.hypot(e[0],e[1],e[2]),n[1]=Math.hypot(s,o,a),n[2]=Math.hypot(l,c,u),n}(Fv,e);return this.radius=Math.max(t[0],Math.max(t[1],t[2]))*this.radius,this}distanceSquaredTo(e){const t=this.distanceTo(e);return t*t}distanceTo(e){const t=(e=Fv.from(e)).subtract(this.center);return Math.max(0,t.len()-this.radius)}intersectPlane(e){const i=this.radius,s=e.normal.dot(this.center)+e.distance;return s<-i?Pm.OUTSIDE:s<i?Pm.INTERSECTING:Pm.INSIDE}}class FIe extends aF{get ELEMENTS(){return bc(!1),0}get RANK(){return bc(!1),0}toString(){let e="[";if(Mr.printRowMajor){e+="row-major:";for(let t=0;t<this.RANK;++t)for(let i=0;i<this.RANK;++i)e+=" ".concat(this[i*this.RANK+t])}else{e+="column-major:";for(let t=0;t<this.ELEMENTS;++t)e+=" ".concat(this[t])}return e+="]",e}getElementIndex(e,t){return t*this.RANK+e}getElement(e,t){return this[t*this.RANK+e]}setElement(e,t,i){return this[t*this.RANK+e]=co(i),this}getColumn(e,t=new Array(this.RANK).fill(-0)){const i=e*this.RANK;for(let r=0;r<this.RANK;++r)t[r]=this[i+r];return t}setColumn(e,t){const i=e*this.RANK;for(let r=0;r<this.RANK;++r)this[i+r]=t[r];return this}}const P7=Object.freeze([1,0,0,0,1,0,0,0,1]),LIe=Object.freeze([0,0,0,0,0,0,0,0,0]),kIe=Object.freeze({COL0ROW0:0,COL0ROW1:1,COL0ROW2:2,COL1ROW0:3,COL1ROW1:4,COL1ROW2:5,COL2ROW0:6,COL2ROW1:7,COL2ROW2:8}),Fm={};class $o extends FIe{static get IDENTITY(){return Fm.IDENTITY=Fm.IDENTITY||Object.freeze(new $o(P7)),Fm.IDENTITY}static get ZERO(){return Fm.ZERO=Fm.ZERO||Object.freeze(new $o(LIe)),Fm.ZERO}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return kIe}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this.check()}set(e,t,i,r,s,o,a,l,c){return this[0]=e,this[1]=t,this[2]=i,this[3]=r,this[4]=s,this[5]=o,this[6]=a,this[7]=l,this[8]=c,this.check()}setRowMajor(e,t,i,r,s,o,a,l,c){return this[0]=e,this[1]=r,this[2]=a,this[3]=t,this[4]=s,this[5]=l,this[6]=i,this[7]=o,this[8]=c,this.check()}determinant(){return a4(this)}identity(){return this.copy(P7)}fromQuaternion(e){return u4(this,e),this.check()}transpose(){return s4(this,this),this.check()}invert(){return o4(this,this),this.check()}multiplyLeft(e){return jS(this,e,this),this.check()}multiplyRight(e){return jS(this,this,e),this.check()}rotate(e){return c4(this,this,e),this.check()}scale(e){return Array.isArray(e)?US(this,this,e):US(this,this,[e,e,e]),this.check()}translate(e){return l4(this,this,e),this.check()}transform(e,t){switch(e.length){case 2:t=rU(t||[-0,-0],e,this);break;case 3:t=JE(t||[-0,-0,-0],e,this);break;case 4:t=function(n,e,t){const i=e[0],r=e[1],s=e[2];return n[0]=t[0]*i+t[3]*r+t[6]*s,n[1]=t[1]*i+t[4]*r+t[7]*s,n[2]=t[2]*i+t[5]*r+t[8]*s,n[3]=e[3],n}(t||[-0,-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return M7(t,e.length),t}transformVector(e,t){return lF("Matrix3.transformVector"),this.transform(e,t)}transformVector2(e,t){return lF("Matrix3.transformVector"),this.transform(e,t)}transformVector3(e,t){return lF("Matrix3.transformVector"),this.transform(e,t)}}const BIe=[0,0,0,1];class F7 extends aF{constructor(e=0,t=0,i=0,r=1){super(-0,-0,-0,-0),Array.isArray(e)&&1===arguments.length?this.copy(e):this.set(e,t,i,r)}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}set(e,t,i,r){return this[0]=e,this[1]=t,this[2]=i,this[3]=r,this.check()}fromMatrix3(e){return HO(this,e),this.check()}identity(){return h4(this),this.check()}fromAxisRotation(e,t){return zO(this,e,t),this.check()}setAxisAngle(e,t){return this.fromAxisRotation(e,t)}get ELEMENTS(){return 4}get x(){return this[0]}set x(e){this[0]=co(e)}get y(){return this[1]}set y(e){this[1]=co(e)}get z(){return this[2]}set z(e){this[2]=co(e)}get w(){return this[3]}set w(e){this[3]=co(e)}len(){return w4(this)}lengthSquared(){return E4(this)}dot(e,t){if(void 0!==t)throw new Error("Quaternion.dot only takes one argument");return $O(this,e)}rotationTo(e,t){return x4(this,e,t),this.check()}add(e,t){if(void 0!==t)throw new Error("Quaternion.add only takes one argument");return v4(this,this,e),this.check()}calculateW(){return m4(this,this),this.check()}conjugate(){return y4(this,this),this.check()}invert(){return _4(this,this),this.check()}lerp(e,t,i){return b4(this,e,t,i),this.check()}multiplyRight(e,t){return bc(!t),zS(this,this,e),this.check()}multiplyLeft(e,t){return bc(!t),zS(this,e,this),this.check()}normalize(){const e=this.len(),t=e>0?1/e:0;return this[0]=this[0]*t,this[1]=this[1]*t,this[2]=this[2]*t,this[3]=this[3]*t,0===e&&(this[3]=1),this.check()}rotateX(e){return f4(this,this,e),this.check()}rotateY(e){return p4(this,this,e),this.check()}rotateZ(e){return g4(this,this,e),this.check()}scale(e){return GO(this,this,e),this.check()}slerp(e,t,i){switch(arguments.length){case 1:({start:e=BIe,target:t,ratio:i}=arguments[0]);break;case 2:[t,i]=arguments,e=this}return U0(this,e,t,i),this.check()}transformVector4(e,t=e){return Zj(t,e,this),M7(t,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(e,t){return this.setAxisAngle(e,t)}premultiply(e,t){return this.multiplyLeft(e,t)}multiply(e,t){return this.multiplyRight(e,t)}}const VIe=new Rn,jIe=new Rn,WC=new Rn,qC=new Rn,YC=new Rn,UIe=new Rn,zIe=new Rn;class dF{constructor(e=[0,0,0],t=[0,0,0,0,0,0,0,0,0]){this.center=(new Rn).from(e),this.halfAxes=new $o(t)}get halfSize(){const e=this.halfAxes.getColumn(0),t=this.halfAxes.getColumn(1),i=this.halfAxes.getColumn(2);return[new Rn(e).len(),new Rn(t).len(),new Rn(i).len()]}get quaternion(){const e=this.halfAxes.getColumn(0),t=this.halfAxes.getColumn(1),i=this.halfAxes.getColumn(2),r=new Rn(e).normalize(),s=new Rn(t).normalize(),o=new Rn(i).normalize();return(new F7).fromMatrix3(new $o([...r,...s,...o]))}fromCenterHalfSizeQuaternion(e,t,i){const r=new F7(i),s=(new $o).fromQuaternion(r);return s[0]=s[0]*t[0],s[1]=s[1]*t[0],s[2]=s[2]*t[0],s[3]=s[3]*t[1],s[4]=s[4]*t[1],s[5]=s[5]*t[1],s[6]=s[6]*t[2],s[7]=s[7]*t[2],s[8]=s[8]*t[2],this.center=(new Rn).from(e),this.halfAxes=s,this}clone(){return new dF(this.center,this.halfAxes)}equals(e){return this===e||Boolean(e)&&this.center.equals(e.center)&&this.halfAxes.equals(e.halfAxes)}getBoundingSphere(e=new uF){const t=this.halfAxes,i=t.getColumn(0,WC),r=t.getColumn(1,qC),s=t.getColumn(2,YC),o=VIe.copy(i).add(r).add(s);return e.center.copy(this.center),e.radius=o.magnitude(),e}intersectPlane(e){const t=this.center,i=e.normal,r=this.halfAxes,s=i.x,o=i.y,a=i.z,l=Math.abs(s*r[0]+o*r[1]+a*r[2])+Math.abs(s*r[3]+o*r[4]+a*r[5])+Math.abs(s*r[6]+o*r[7]+a*r[8]),c=i.dot(t)+e.distance;return c<=-l?Pm.OUTSIDE:c>=l?Pm.INSIDE:Pm.INTERSECTING}distanceTo(e){return Math.sqrt(this.distanceSquaredTo(e))}distanceSquaredTo(e){const t=jIe.from(e).subtract(this.center),i=this.halfAxes,r=i.getColumn(0,WC),s=i.getColumn(1,qC),o=i.getColumn(2,YC),a=r.magnitude(),l=s.magnitude(),c=o.magnitude();r.normalize(),s.normalize(),o.normalize();let h,u=0;return h=Math.abs(t.dot(r))-a,h>0&&(u+=h*h),h=Math.abs(t.dot(s))-l,h>0&&(u+=h*h),h=Math.abs(t.dot(o))-c,h>0&&(u+=h*h),u}computePlaneDistances(e,t,i=[-0,-0]){let r=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;const o=this.center,a=this.halfAxes,l=a.getColumn(0,WC),c=a.getColumn(1,qC),u=a.getColumn(2,YC),h=UIe.copy(l).add(c).add(u).add(o),p=zIe.copy(h).subtract(e);let g=t.dot(p);return r=Math.min(g,r),s=Math.max(g,s),h.copy(o).add(l).add(c).subtract(u),p.copy(h).subtract(e),g=t.dot(p),r=Math.min(g,r),s=Math.max(g,s),h.copy(o).add(l).subtract(c).add(u),p.copy(h).subtract(e),g=t.dot(p),r=Math.min(g,r),s=Math.max(g,s),h.copy(o).add(l).subtract(c).subtract(u),p.copy(h).subtract(e),g=t.dot(p),r=Math.min(g,r),s=Math.max(g,s),o.copy(h).subtract(l).add(c).add(u),p.copy(h).subtract(e),g=t.dot(p),r=Math.min(g,r),s=Math.max(g,s),o.copy(h).subtract(l).add(c).subtract(u),p.copy(h).subtract(e),g=t.dot(p),r=Math.min(g,r),s=Math.max(g,s),o.copy(h).subtract(l).subtract(c).add(u),p.copy(h).subtract(e),g=t.dot(p),r=Math.min(g,r),s=Math.max(g,s),o.copy(h).subtract(l).subtract(c).subtract(u),p.copy(h).subtract(e),g=t.dot(p),r=Math.min(g,r),s=Math.max(g,s),i[0]=r,i[1]=s,i}transform(e){this.center.transformAsPoint(e);const t=this.halfAxes.getColumn(0,WC);t.transformAsPoint(e);const i=this.halfAxes.getColumn(1,qC);i.transformAsPoint(e);const r=this.halfAxes.getColumn(2,YC);return r.transformAsPoint(e),this.halfAxes=new $o([...t,...i,...r]),this}getTransform(){throw new Error("not implemented")}}const L7=new Rn,k7=new Rn;class hF{constructor(e=[0,0,1],t=0){this.normal=new Rn,this.distance=-0,this.fromNormalDistance(e,t)}fromNormalDistance(e,t){return bc(Number.isFinite(t)),this.normal.from(e).normalize(),this.distance=t,this}fromPointNormal(e,t){e=L7.from(e),this.normal.from(t).normalize();const i=-this.normal.dot(e);return this.distance=i,this}fromCoefficients(e,t,i,r){return this.normal.set(e,t,i),bc(Pv(this.normal.len(),1)),this.distance=r,this}clone(e){return new hF(this.normal,this.distance)}equals(e){return Pv(this.distance,e.distance)&&Pv(this.normal,e.normal)}getPointDistance(e){return this.normal.dot(e)+this.distance}transform(e){const t=k7.copy(this.normal).transformAsVector(e).normalize(),i=this.normal.scale(-this.distance).transform(e);return this.fromPointNormal(i,t)}projectPointOntoPlane(e,t=[0,0,0]){e=L7.from(e);const i=this.getPointDistance(e),r=k7.copy(this.normal).scale(i);return e.subtract(r).to(t)}}function*yF(n,e,t){for(const[i,r]of Object.entries(t))for(const s of(0,Jn.readQuads)(n,e,i,null,null)){const o="Literal"===s.object.termType?(0,$C.fromRdf)(s.object):s.object.id;yield[r,o]}}function rp(n,e,t,i){const r={"@id":e,"@type":t};for(const[s,o]of Object.entries(i))for(const a of(0,Jn.readQuads)(n,r["@id"],s,null,null)){const l="Literal"===a.object.termType?(0,$C.fromRdf)(a.object):a.object.id;r[o]=l}return r}new Rn([1,0,0]),new Rn([0,1,0]),new Rn([0,0,1]),new Rn,new Rn,new hF(new Rn(1,0,0),0),new Rn,new Rn,new Rn,new Rn,new Rn,new Rn,new Rn,new Rn,new Rn,new Rn,new Rn,new Rn,new Rn,new Rn,new Rn,new Rn,new Rn,Math,new $o,new $o,new $o,new $o,new $o,new Rn,new Rn,new Rn,new Rn,new Rn,new $o,new $o,new $o;const Ii=Jn.Util.prefixes({ccf:"http://purl.org/ccf/latest/ccf.owl#",entity:"http://purl.org/ccf/latest/ccf-entity.owl#",fma:"http://purl.obolibrary.org/obo/FMA_",obo:"http://purl.obolibrary.org/obo/",uberon:"http://purl.obolibrary.org/obo/UBERON_",cl:"http://purl.obolibrary.org/obo/CL_",lmha:"http://purl.obolibrary.org/obo/LMHA_",rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",rdfs:"http://www.w3.org/2000/01/rdf-schema#",dc:"http://purl.org/dc/elements/1.1/"},Jn.DataFactory),U7={x:Ii("rdf"),type:Ii("rdf")("type")},km={x:Ii("rdfs"),label:Ii("rdfs")("label"),comment:Ii("rdfs")("comment"),isDefinedBy:Ii("rdfs")("isDefinedBy"),seeAlso:Ii("rdfs")("seeAlso")},fi={x:Ii("entity"),id:Ii("entity")("id"),label:km.label,description:km.comment,link:km.seeAlso,sex:Ii("entity")("sex"),age:Ii("entity")("age"),bmi:Ii("entity")("bmi"),Male:Jn.DataFactory.literal("Male"),Female:Jn.DataFactory.literal("Female"),consortiumName:Ii("entity")("consortium_name"),providerName:Ii("entity")("provider_name"),providerUUID:Ii("entity")("provider_uuid"),donor:Ii("entity")("has_donor"),sections:Ii("entity")("has_tissue_section"),datasets:Ii("entity")("has_dataset"),sampleType:Ii("entity")("sample_type"),TissueBlock:Jn.DataFactory.literal("Tissue Block"),TissueSection:Jn.DataFactory.literal("Tissue Section"),NonStandard:Jn.DataFactory.literal("Non-standard"),sectionCount:Ii("entity")("section_count"),sectionSize:Ii("entity")("section_size"),sectionUnits:Ii("entity")("section_units"),sectionNumber:Ii("entity")("section_number"),spatialEntity:Ii("entity")("has_spatial_entity"),ontologyTerms:Ii("entity")("has_ontology_term"),cellTypeTerms:Ii("entity")("has_cell_type_term"),technology:Ii("entity")("technology"),thumbnail:Ii("entity")("has_thumbnail")},xn=Ii("ccf"),Qi={x:xn,ontologyNode:{label:xn("ccf_preferred_label"),parent:xn("ccf_part_of"),children:xn("ccf_part_of"),rui_rank:xn("ccf_rui_rank"),synonymLabels:Jn.DataFactory.namedNode("http://www.geneontology.org/formats/oboInOwl#hasExactSynonym")},asctb:{part_of:xn("ccf_part_of"),ct_is_a:xn("ct_is_a"),located_in:xn("located_in"),characterizes:xn("characterizes")},spatial:{Female:xn("VHFemale"),Male:xn("VHMale"),BothSexes:xn("VHBothSexes"),FemaleOrgans:xn("VHFemaleOrgans"),MaleOrgans:xn("VHMaleOrgans")},SpatialObjectReference:xn("SpatialObjectReference"),SpatialEntity:xn("SpatialEntity"),SpatialPlacement:xn("SpatialPlacement"),spatialObjectReference:{file:xn("has_object_file"),file_format:xn("has_object_file_format"),file_subpath:xn("has_object_file_subpath")},extractionSet:{label:km.label,rui_rank:xn("ccf_rui_rank")},spatialEntity:{label:km.label,comment:km.comment,creator:Ii("dc")("creator"),creator_first_name:xn("creator_first_name"),creator_last_name:xn("creator_last_name"),creator_orcid:xn("creator_orcid"),creation_date:xn("creation_date"),updated_date:xn("updated_date"),ccf_annotations:xn("ccf_annotation"),representation_of:xn("ccf_representation_of"),reference_organ:xn("anatomical_structure_of"),extraction_set_for:xn("extraction_set_for"),extraction_set:xn("extraction_site_for"),sex:xn("has_sex"),side:xn("has_side"),rui_rank:xn("ccf_rui_rank"),slice_thickness:xn("ccf_slice_thickness"),slice_count:xn("ccf_slice_count"),x_dimension:xn("has_x_dimension"),y_dimension:xn("has_y_dimension"),z_dimension:xn("has_z_dimension"),dimension_units:xn("has_dimension_units"),object:xn("has_object_reference")},spatialPlacement:{source:xn("has_placement_source"),target:xn("has_placement_target"),placement_date:xn("has_placement_date"),x_scaling:xn("has_x_scaling"),y_scaling:xn("has_y_scaling"),z_scaling:xn("has_z_scaling"),scaling_units:xn("has_scaling_units"),x_rotation:xn("has_x_rotation"),y_rotation:xn("has_y_rotation"),z_rotation:xn("has_z_rotation"),w_rotation:xn("has_theta_rotation"),rotation_order:xn("has_rotation_order"),rotation_units:xn("has_rotation_units"),x_translation:xn("has_x_translation"),y_translation:xn("has_y_translation"),z_translation:xn("has_z_translation"),translation_units:xn("has_translation_units")}},oi={x:Ii("uberon"),body:Ii("uberon")("0013702")},vOe={x:Ii("cl"),cell:Ii("cl")("0000000")},kv={x:Ii("fma")},mu=(Ii("lmha"),{body:oi.body,cell:vOe.cell,respiratory_system:oi.x("0001004"),colon:oi.x("0001155"),left_lung:oi.x("0002168"),right_lung:oi.x("0002167"),left_bronchus:oi.x("0002178"),right_bronchus:oi.x("0002177"),kidney:oi.x("0002113"),ureter:oi.x("0000056"),eye:oi.x("0000970"),fallopian_tube:oi.x("0003889"),knee:oi.x("0001465"),ovary:oi.x("0000992"),trachea:oi.x("0003126"),aorta:oi.x("0000947"),blood:oi.x("0000178"),bone_marrow:oi.x("0002371"),male_reproductive_system:oi.x("0000079"),lymph_node:oi.x("0000029"),blood_vasculature:oi.x("0004537"),brain:oi.x("0000955"),eye_left:oi.x("0004548"),eye_right:kv.x("54449"),fallopian_tube_left:oi.x("0001303"),fallopian_tube_right:oi.x("0001302"),heart:oi.x("0000948"),kidney_left:oi.x("0004538"),kidney_right:oi.x("0004539"),knee_left:kv.x("24978"),knee_right:kv.x("24977"),large_intestine:oi.x("0000059"),liver:oi.x("0002107"),lungs:oi.x("0002048"),mesenteric_lymph_node:oi.x("0002509"),ovary_left:kv.x("7214"),ovary_right:kv.x("7213"),pancreas:oi.x("0001264"),pelvis:oi.x("0001270"),prostate_gland:oi.x("0002367"),skin:oi.x("0002097"),small_intestine:oi.x("0002108"),spleen:oi.x("0002106"),thymus:oi.x("0002370"),ureter_left:oi.x("0001223"),ureter_right:oi.x("0001222"),urinary_bladder:oi.x("0001255"),uterus:oi.x("0000995")});function vF(n){const e={};return Object.entries(n).forEach(([t,i])=>{e[i.id]=t}),e}const XC={spatialObjectReference:vF(Qi.spatialObjectReference),spatialEntity:vF(Qi.spatialEntity),spatialPlacement:vF(Qi.spatialPlacement)};function z7(n,e){const t=rp(n,e,"ExtractionSet",XC.spatialEntity);return t.extractionSites=(0,Ar.sortBy)(n.getSubjects(Qi.spatialEntity.extraction_set,e,null).map(i=>sp(n,i.id)),["rui_rank"]),t}function sp(n,e){const t=rp(n,e,"SpatialEntity",XC.spatialEntity);return t.object&&(t.object=function(n,e){return rp(n,e,"SpatialObjectReference",XC.spatialObjectReference)}(n,t.object)),t.ccf_annotations&&(t.ccf_annotations=n.getObjects(e,Qi.spatialEntity.ccf_annotations,null).map(i=>i.id)),n.forSubjects(i=>t.entityId=i.id,fi.spatialEntity,e,null),t}function xOe(n,e){const t=rp(n,e,"SpatialPlacement",XC.spatialPlacement);return t.source&&(t.source=sp(n,t.source)),t.target&&(t.target=sp(n,t.target)),t}function H7(n,e){const t=e;let i;switch(t.translation_units){case"centimeter":i=.01;break;case"millimeter":i=.001;break;case"meter":default:i=1}const r=[t.x_translation,t.y_translation,t.z_translation].map(a=>a*i),s=[t.x_rotation,t.y_rotation,t.z_rotation].map(kV),o=[t.x_scaling,t.y_scaling,t.z_scaling];return n.translate(r).rotateXYZ(s).scale(o)}class G7{constructor(e){this.db=e,this.createGraph()}createGraph(){this.graph=new aIe.DirectedGraph;const e=this.db.store;e.forSubjects(i=>{this.addNode(i.id,"SpatialObjectReference")},U7.type,Qi.SpatialObjectReference,null),e.forSubjects(i=>{this.addNode(i.id,"SpatialEntity")},U7.type,Qi.SpatialEntity,null);const t={};for(const i of(0,Jn.readQuads)(e,null,Qi.spatialPlacement.source,null,null))t[i.subject.id]=i.object.id;for(const i of(0,Jn.readQuads)(e,null,Qi.spatialPlacement.target,null,null)){const r=t[i.subject.id];r&&this.addEdge(i.subject.id,r,i.object.id,"SpatialPlacement")}}addNode(e,t){this.graph.mergeNode(e,{type:t})}addEdge(e,t,i,r){this.graph.mergeDirectedEdge(t,i,{type:r,id:e})}getTransformationMatrix(e,t){if(e===t)return new Wn(Wn.IDENTITY);if(!this.graph.hasNode(e)||!this.graph.hasNode(t))return;const i=this.db.store,r=new Wn(Wn.IDENTITY),s=cIe()(this.graph,e,t);if(s&&s.length>0){s.reverse();let o="";for(const a of s)o&&H7(r,xOe(i,this.graph.getEdgeAttribute(a,o,"id"))),o=a;return r}}getSpatialPlacement(e,t){const i=this.graph.hasNode(e["@id"])?e["@id"]:void 0,r=(0,Ar.get)(e,"placement[0]",(0,Ar.get)(e,"placement",void 0));let s;if(r&&this.graph.hasNode(r.target)?(s=this.getTransformationMatrix(r.target,t),s&&(s=H7(s,r))):i&&(s=this.getTransformationMatrix(i,t)),s){const o=(new Xi).fromRotationMatrix(s,Xi.XYZ),a=s.getTranslation().map(u=>1e3*u),l=o.toVector3().map(qie),c=s.getScale().map(u=>u<1&&u>.999999?1:u);return{"@context":"https://hubmapconsortium.github.io/hubmap-ontology/ccf-context.jsonld","@id":`http://purl.org/ccf/1.5/${yIe()}_placement`,"@type":"SpatialPlacement",source:e["@id"],target:t,placement_date:(new Date).toISOString().split("T")[0],x_scaling:c[0],y_scaling:c[1],z_scaling:c[2],scaling_units:"ratio",x_rotation:l[0],y_rotation:l[1],z_rotation:l[2],rotation_order:"XYZ",rotation_units:"degree",x_translation:a[0],y_translation:a[1],z_translation:a[2],translation_units:"millimeter"}}}}class $7{constructor(e){this.db=e}getSpatialEntity(e){return sp(this.db.store,e)}getExtractionSets(e){return function(n,e){return(0,Ar.sortBy)(n.getSubjects(Qi.spatialEntity.extraction_set_for,e,null).map(t=>z7(n,t.id)),["rui_rank"])}(this.db.store,e)}getExtractionSet(e){return z7(this.db.store,e)}getAnatomicalStructures(e){return function(n,e){return(0,Ar.sortBy)(n.getSubjects(Qi.spatialEntity.reference_organ,e,null).map(t=>sp(n,t.id)).filter(t=>t["@id"]!==e),["rui_rank"])}(this.db.store,e)}getReferenceOrgans(){return function(n){const e=[];return n.forEach(t=>{t.subject.id===t.object.id&&e.push(sp(n,t.subject.id))},null,Qi.spatialEntity.reference_organ,null,null),(0,Ar.sortBy)(e,["rui_rank"])}(this.db.store)}getReferenceBody(e){let t;switch(null==e?void 0:e.sex){case"Male":t=Qi.spatial.Male.id;break;case"Female":t=Qi.spatial.Female.id;break;case"Both":default:t=Qi.spatial.BothSexes.id}return this.getSpatialEntity(t)}getReferenceOrganSets(e){let t=this.getReferenceOrgans();switch(null==e?void 0:e.sex){case"Male":t=t.filter(i=>"Male"===i.sex);break;case"Female":t=t.filter(i=>"Female"===i.sex)}return(null==e?void 0:e.debug)&&(t=t.map(i=>[[i],this.getAnatomicalStructures(i["@id"])]).reduce((i,[r,s])=>i.concat(s.length>0?s:r),[])),t}getReferenceSceneNodes(e){const t=this.getReferenceBody(e),i=[];let r=[...this.getReferenceOrganSets(e).map(s=>{const o="http://purl.obolibrary.org/obo/UBERON_0002097"===s.representation_of,a=this.getSceneNode(s,t,{color:[255,255,255,255],opacity:o?.5:.2,unpickable:!0,_lighting:"pbr",zoomBasedOpacity:!o});return o&&a?void i.push(a):a})];return i.length>0&&(r=[...i,...r]),(null==e?void 0:e.debug)&&(r=r.concat([this.getSceneNode(this.getSpatialEntity(Qi.x("VHRightKidney").id),t,{color:[0,0,255,127.5],wireframe:!0}),this.getSceneNode(this.getSpatialEntity(Qi.x("VHLeftKidney").id),t,{color:[255,0,0,127.5],wireframe:!0}),this.getSceneNode(this.getSpatialEntity(Qi.x("VHSpleenCC1").id),t,{color:[0,255,0,127.5],wireframe:!0}),this.getSceneNode(this.getSpatialEntity(Qi.x("VHSpleenCC2").id),t,{color:[0,255,0,127.5],wireframe:!0}),this.getSceneNode(this.getSpatialEntity(Qi.x("VHSpleenCC3").id),t,{color:[0,255,0,127.5],wireframe:!0})])),r.filter(s=>void 0!==s)}getReferenceOrganScene(e,t){var i,r;const s=null!==(i=void 0!==(null==t?void 0:t.sex))&&void 0!==i&&i,o=this.getReferenceOrgans().filter(a=>a.representation_of===e&&(!s||a.sex===(null==t?void 0:t.sex)));if(o.length>0){const a=o[0],c=this.getSceneNode(a,a,{color:[255,255,255,255],opacity:"http://purl.obolibrary.org/obo/UBERON_0002097"===a.representation_of?.5:.2,unpickable:!0,_lighting:"pbr"}),u=(null!==(r=this.db.getSpatialEntities(t))&&void 0!==r?r:[]).map(h=>this.getSceneNode(h,a,{color:[255,255,255,229.5]}));return[c].concat(u).filter(h=>void 0!==h)}return[]}getEntitySceneNodes(e){const t=this.getReferenceBody(e);return this.db.getSpatialEntities(e).map(i=>this.getSceneNode(i,t,{color:[255,255,255,229.5]})).filter(i=>void 0!==i)}getSceneNode(e,t,i={}){var r,s,o,a;const l=null===(s=null===(r=null==e?void 0:e.object)||void 0===r?void 0:r.file_format)||void 0===s?void 0:s.startsWith("model/gltf");let u=this.db.graph.getTransformationMatrix(l&&e.object?e.object["@id"]:e["@id"],t["@id"]);if(u){if(l)u=new Wn(Wn.IDENTITY).rotateX(kV(90)).multiplyLeft(u);else{let h;switch(e.dimension_units){case"centimeter":h=.01;break;case"millimeter":h=.001;break;case"meter":default:h=1}const p=[e.x_dimension,e.y_dimension,e.z_dimension].map(g=>g*h/2);u.scale(p)}return Object.assign({"@id":e["@id"],"@type":"SpatialSceneNode",entityId:e.entityId,ccf_annotations:e.ccf_annotations,representation_of:e.representation_of,reference_organ:e.reference_organ,scenegraph:l?null===(o=e.object)||void 0===o?void 0:o.file:void 0,scenegraphNode:l?null===(a=e.object)||void 0===a?void 0:a.file_subpath:void 0,transformMatrix:u,tooltip:e.label},i)}}getScene(e){return[...this.getReferenceSceneNodes(e),...this.getEntitySceneNodes(e)]}}const QC="https://entity.api.hubmapconsortium.org/entities/",W7=new Set(["VAN0003-LK-32-21-AF_preIMS_registered_thumbnail.jpg","VAN0003-LK-32-21-IMS_NegMode_multilayer_thumbnail.jpg","VAN0003-LK-32-21-IMS_PosMode_multilayer_thumbnail.jpg","VAN0003-LK-32-21-PAS_registered_thumbnail.jpg","VAN0003-LK-32-22-AF_preMxIF_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc1_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc2_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc3_registered_thumbnail.jpg","VAN0005-RK-1-1-AF_preIMS_registered_thumbnail.jpg","VAN0005-RK-1-1-IMS_NegMode_multilayer_thumbnail.jpg","VAN0005-RK-1-1-IMS_PosMode_multilayer_thumbnail.jpg","VAN0005-RK-1-1-PAS_registered_thumbnail.jpg","VAN0005-RK-4-172-AF_preIMS_registered_thumbnail.jpg","VAN0005-RK-4-172-IMS_NegMode_multilayer_thumbnail.jpg","VAN0005-RK-4-172-IMS_PosMode_multilayer_thumbnail.jpg","VAN0005-RK-4-172-PAS_registered_thumbnail.jpg","VAN0006-LK-2-85-AF_preIMS_registered_thumbnail.jpg","VAN0006-LK-2-85-IMS_NegMode_multilayer_thumbnail.jpg","VAN0006-LK-2-85-IMS_PosMode_multilayer_thumbnail.jpg","VAN0006-LK-2-85-PAS_registered_thumbnail.jpg","VAN0006-LK-2-86-AF_preMxIF_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc1_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc2_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc3_registered_thumbnail.jpg","VAN0007-LK-203-103-AF_preIMS_registered_thumbnail.jpg","VAN0007-LK-203-103-IMS_NegMode_multilayer_thumbnail.jpg","VAN0007-LK-203-103-IMS_PosMode_multilayer_thumbnail.jpg","VAN0007-LK-203-103-PAS_registered_thumbnail.jpg","VAN0008-RK-403-100-AF_preIMS_registered_thumbnail.jpg","VAN0008-RK-403-100-IMS_NegMode_multilayer_thumbnail.jpg","VAN0008-RK-403-100-IMS_PosMode_multilayer_thumbnail.jpg","VAN0008-RK-403-100-PAS_registered_thumbnail.jpg","VAN0008-RK-403-101-AF_preMxIF_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc1_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc2_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc3_registered_thumbnail.jpg","VAN0009-LK-102-7-AF_preIMS_registered_thumbnail.jpg","VAN0009-LK-102-7-IMS_NegMode_multilayer_thumbnail.jpg","VAN0009-LK-102-7-IMS_PosMode_multilayer_thumbnail.jpg","VAN0009-LK-102-7-PAS_registered_thumbnail.jpg","VAN0010-LK-155-40-AF_preIMS_registered_thumbnail.jpg","VAN0010-LK-155-40-IMS_NegMode_multilayer_thumbnail.jpg","VAN0010-LK-155-40-IMS_PosMode_multilayer_thumbnail.jpg","VAN0010-LK-155-40-PAS_registered_thumbnail.jpg","VAN0011-RK-3-10-AF_preIMS_registered_thumbnail.jpg","VAN0011-RK-3-10-IMS_NegMode_multilayer_thumbnail.jpg","VAN0011-RK-3-10-IMS_PosMode_multilayer_thumbnail.jpg","VAN0011-RK-3-10-PAS_registered_thumbnail.jpg","VAN0011-RK-3-11-AF_preMxIF_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc1_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc2_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc3_registered_thumbnail.jpg","VAN0012-RK-103-75-AF_preIMS_registered_thumbnail.jpg","VAN0012-RK-103-75-IMS_NegMode_multilayer_thumbnail.jpg","VAN0012-RK-103-75-IMS_PosMode_multilayer_thumbnail.jpg","VAN0012-RK-103-75-PAS_registered_thumbnail.jpg","VAN0012-RK-103-76-AF_preMxIF_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc1_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc2_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc3_registered_thumbnail.jpg","VAN0013-LK-202-96-AF_preIMS_registered_thumbnail.jpg","VAN0013-LK-202-96-IMS_NegMode_multilayer_thumbnail.jpg","VAN0013-LK-202-96-IMS_PosMode_multilayer_thumbnail.jpg","VAN0013-LK-202-96-PAS_registered_thumbnail.jpg","VAN0013-LK-202-97-AF_preMxIF_registered_thumbnail.jpg","VAN0013-LK-202-97-MxIF_cyc1_registered_thumbnail.jpg","VAN0013-LK-202-97-MxIF_cyc2_registered_thumbnail.jpg","VAN0013-LK-202-97-MxIF_cyc3_registered_thumbnail.jpg","VAN0014-LK-203-108-AF_preIMS_registered_thumbnail.jpg","VAN0014-LK-203-108-IMS_NegMode_multilayer_thumbnail.jpg","VAN0014-LK-203-108-IMS_PosMode_multilayer_thumbnail.jpg","VAN0014-LK-203-108-PAS_registered_thumbnail.jpg","VAN0016-LK-202-89-AF_preIMS_registered_thumbnail.jpg","VAN0016-LK-202-89-IMS_NegMode_multilayer_thumbnail.jpg","VAN0016-LK-202-89-IMS_PosMode_multilayer_thumbnail.jpg","VAN0016-LK-202-89-PAS_registered_thumbnail.jpg","VAN0003-LK-32-21-AF_preIMS_registered_thumbnail.jpg","VAN0003-LK-32-21-IMS_NegMode_multilayer_thumbnail.jpg","VAN0003-LK-32-21-IMS_PosMode_multilayer_thumbnail.jpg","VAN0003-LK-32-21-PAS_registered_thumbnail.jpg","VAN0003-LK-32-22-AF_preMxIF_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc1_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc2_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc3_registered_thumbnail.jpg","VAN0005-RK-1-1-AF_preIMS_registered_thumbnail.jpg","VAN0005-RK-1-1-IMS_NegMode_multilayer_thumbnail.jpg","VAN0005-RK-1-1-IMS_PosMode_multilayer_thumbnail.jpg","VAN0005-RK-1-1-PAS_registered_thumbnail.jpg","VAN0005-RK-4-172-AF_preIMS_registered_thumbnail.jpg","VAN0005-RK-4-172-IMS_NegMode_multilayer_thumbnail.jpg","VAN0005-RK-4-172-IMS_PosMode_multilayer_thumbnail.jpg","VAN0005-RK-4-172-PAS_registered_thumbnail.jpg","VAN0006-LK-2-85-AF_preIMS_registered_thumbnail.jpg","VAN0006-LK-2-85-IMS_NegMode_multilayer_thumbnail.jpg","VAN0006-LK-2-85-IMS_PosMode_multilayer_thumbnail.jpg","VAN0006-LK-2-85-PAS_registered_thumbnail.jpg","VAN0006-LK-2-86-AF_preMxIF_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc1_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc2_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc3_registered_thumbnail.jpg","VAN0007-LK-203-103-AF_preIMS_registered_thumbnail.jpg","VAN0007-LK-203-103-IMS_NegMode_multilayer_thumbnail.jpg","VAN0007-LK-203-103-IMS_PosMode_multilayer_thumbnail.jpg","VAN0007-LK-203-103-PAS_registered_thumbnail.jpg","VAN0008-RK-403-100-AF_preIMS_registered_thumbnail.jpg","VAN0008-RK-403-100-IMS_NegMode_multilayer_thumbnail.jpg","VAN0008-RK-403-100-IMS_PosMode_multilayer_thumbnail.jpg","VAN0008-RK-403-100-PAS_registered_thumbnail.jpg","VAN0008-RK-403-101-AF_preMxIF_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc1_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc2_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc3_registered_thumbnail.jpg","VAN0011-RK-3-10-AF_preIMS_registered_thumbnail.jpg","VAN0011-RK-3-10-IMS_NegMode_multilayer_thumbnail.jpg","VAN0011-RK-3-10-IMS_PosMode_multilayer_thumbnail.jpg","VAN0011-RK-3-10-PAS_registered_thumbnail.jpg","VAN0011-RK-3-11-AF_preMxIF_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc1_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc2_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc3_registered_thumbnail.jpg","VAN0012-RK-103-75-AF_preIMS_registered_thumbnail.jpg","VAN0012-RK-103-75-IMS_NegMode_multilayer_thumbnail.jpg","VAN0012-RK-103-75-IMS_PosMode_multilayer_thumbnail.jpg","VAN0012-RK-103-75-PAS_registered_thumbnail.jpg","VAN0012-RK-103-76-AF_preMxIF_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc1_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc2_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc3_registered_thumbnail.jpg"]),TOe={"HBM558.SRZG.629":"HBM558.SRZG.629_UFL0002-SP-3-4-1.jpg","HBM562.NTMH.548":"HBM562.NTMH.548_UFL0006-SP-1-2-1.jpg","HBM685.KHRQ.684":"HBM685.KHRQ.684_UFL0008-LY07-1-1.jpg","HBM278.SFQW.627":"HBM278.SFQW.627_UFL0008-LY09-1-1.jpg","HBM427.SMGB.866":"HBM427.SMGB.866_UFL0004-SP-1-4-1.jpg","HBM432.LLCF.677":"HBM432.LLCF.677_UFL0001-SP-2-5-1.jpg","HBM586.ZSVS.996":"HBM586.ZSVS.996_UFL0008-SP-1-1-1.jpg","HBM285.XMBT.542":"HBM285.XMBT.542_UFL0006-TH-1-3-1.jpg","HBM289.BWJW.663":"HBM289.BWJW.663_UFL0006-TH-1-2-1.jpg","HBM255.SRPR.985":"HBM255.SRPR.985_UFL0005-TH-2-2-1.jpg","HBM799.WXHD.535":"HBM799.WXHD.535_UFL0009-LY02-1-1.jpg","HBM294.RZFN.624":"HBM294.RZFN.624_UFL0005-TH-1-1-1.jpg","HBM383.TRQG.424":"HBM383.TRQG.424_UFL0006-SP-1-3-1.jpg","HBM647.MFQB.496":"HBM647.MFQB.496_UFL0001-SP-1-2-1.jpg","HBM237.GGPR.739":"HBM237.GGPR.739_UFL0006-LY01-1-1.jpg","HBM288.TPBD.654":"HBM288.TPBD.654_UFL0003-SP-2-2-1.jpg","HBM974.NDXT.675":"HBM974.NDXT.675_UFL0008-TH-2-2-1.jpg","HBM589.SLVV.423":"HBM589.SLVV.423_UFL0008-LY10-1-1.jpg","HBM794.RLFN.358":"HBM794.RLFN.358_UFL0006-LY03-1-1.jpg","HBM372.BQSR.778":"HBM372.BQSR.778_UFL0007-SP-1-1-1.jpg","HBM499.TKDW.458":"HBM499.TKDW.458_UFL0009-LY03-1-1.jpg","HBM342.PRQB.739":"HBM342.PRQB.739_UFL0003-LY06-1-1.jpg","HBM633.CLVN.674":"HBM633.CLVN.674_UFL0003-SP-3-6-1.jpg","HBM343.JQKM.578":"HBM343.JQKM.578_UFL0009-LY01-1-1.jpg","HBM987.XGTH.368":"HBM987.XGTH.368_UFL0002-SP-2-4-1.jpg","HBM964.CWCP.788":"HBM964.CWCP.788_UFL0006-LY02-2-1.jpg","HBM244.TJLK.223":"HBM244.TJLK.223_UFL0003-SP-1-4-1.jpg","HBM646.FSBQ.966":"HBM646.FSBQ.966_UFL0007-SP-2-2-1.jpg","HBM572.GXSB.234":"HBM572.GXSB.234_UFL0003-SP-3-2-1.jpg","HBM772.TKGJ.794":"HBM772.TKGJ.794_UFL0008-SP-2-1-1.jpg","HBM239.CBWR.263":"HBM239.CBWR.263_UFL0008-SP-1-2-1.jpg","HBM992.NRTT.383":"HBM992.NRTT.383_UFL0006-SP-1-1-1.jpg","HBM283.DQXD.546":"HBM283.DQXD.546_UFL0003-SP-1-2-1.jpg","HBM795.JHND.856":"HBM795.JHND.856_UFL0007-SP-1-2-1.jpg","HBM267.BZKT.867":"HBM267.BZKT.867_UFL0003-SP-2-6-1.jpg","HBM838.DLMJ.782":"HBM838.DLMJ.782_UFL0008-TH-1-1-1.jpg","HBM337.FSXL.564":"HBM337.FSXL.564_UFL0001-SP-3-8-2.jpg","HBM355.JDLK.244":"HBM355.JDLK.244_UFL0004-SP-2-4-1.jpg","HBM599.PSZG.737":"HBM599.PSZG.737_UFL0006-LY02-1-1.jpg"},Bm={"03b3d854-ed44-11e8-8bce-0e368f3075e8":"TMC-UCSD","07a29e4c-ed43-11e8-b56a-0e8017bdda58":"TMC-Florida","308f5ffc-ed43-11e8-b56a-0e8017bdda58":"TMC-CalTech","5bd084c8-edc2-11e8-802f-0e368f3075e8":"HBM-TestingGroup","73bb26e4-ed43-11e8-8f19-0a7c1eab007a":"TMC-Vanderbilt","def5fd76-ed43-11e8-b56a-0e8017bdda58":"TMC-Stanford","5c106f29-ea2d-11e9-85e8-0efb3ba9a670":"RTI-General Electric","301615f9-c870-11eb-a8dc-35ce3d8786fe":"TMC-UConn"},Wt=function(){const n={};return Object.entries(mu).forEach(([e,t])=>n[e]=t.id),n}(),MOe={AO:[Wt.body,Wt.heart,Wt.aorta],BL:[Wt.body,Wt.urinary_bladder],BD:[Wt.body,Wt.pelvis,Wt.blood],BM:[Wt.body,Wt.pelvis,Wt.bone_marrow],BR:[Wt.body,Wt.brain],LB:[Wt.body,Wt.respiratory_system,Wt.lungs,Wt.left_bronchus],RB:[Wt.body,Wt.respiratory_system,Wt.lungs,Wt.right_bronchus],LE:[Wt.body,Wt.eye,Wt.eye_left],RE:[Wt.body,Wt.eye,Wt.eye_right],LF:[Wt.body,Wt.fallopian_tube,Wt.fallopian_tube_left],RF:[Wt.body,Wt.fallopian_tube,Wt.fallopian_tube_right],HT:[Wt.body,Wt.heart],LK:[Wt.body,Wt.kidney,Wt.kidney_left],RK:[Wt.body,Wt.kidney,Wt.kidney_right],LI:[Wt.body,Wt.large_intestine,Wt.colon],LV:[Wt.body,Wt.liver],LL:[Wt.body,Wt.respiratory_system,Wt.lungs,Wt.left_lung],LN:[Wt.body,Wt.knee,Wt.knee_left],RL:[Wt.body,Wt.respiratory_system,Wt.lungs,Wt.right_lung],RN:[Wt.body,Wt.knee,Wt.knee_right],LY:[Wt.body,Wt.lymph_node,Wt.mesenteric_lymph_node],LO:[Wt.body,Wt.ovary,Wt.ovary_left],RO:[Wt.body,Wt.ovary,Wt.ovary_right],PA:[Wt.body,Wt.pancreas],PL:[Wt.body],SI:[Wt.body,Wt.small_intestine],SK:[Wt.body,Wt.skin],SP:[Wt.body,Wt.spleen],ST:[Wt.body],TH:[Wt.body,Wt.thymus],TR:[Wt.body,Wt.respiratory_system,Wt.lungs,Wt.trachea],UR:[Wt.body,Wt.ureter],UT:[Wt.body,Wt.uterus],OT:[Wt.body]},q7={"@base":"http://purl.org/ccf/latest/ccf-entity.owl#","@vocab":"http://purl.org/ccf/latest/ccf-entity.owl#",ccf:"http://purl.org/ccf/latest/ccf.owl#",rdfs:"http://www.w3.org/2000/01/rdf-schema#",label:"rdfs:label",description:"rdfs:comment",link:{"@id":"rdfs:seeAlso","@type":"@id"},samples:{"@reverse":"has_donor"},sections:{"@id":"has_tissue_section","@type":"@id"},datasets:{"@id":"has_dataset","@type":"@id"},rui_location:{"@id":"has_spatial_entity","@type":"@id"},ontologyTerms:{"@id":"has_ontology_term","@type":"@id"},cellTypeTerms:{"@id":"has_cell_type_term","@type":"@id"},thumbnail:{"@id":"has_thumbnail"}};class OOe{constructor(e,t="",i="",r){var s,o;if(this.data=e,this.bad=!1,this["@type"]="Sample",this.sample_type="Tissue Block","Sample"!==this.data.entity_type)return void(this.bad=!0);const c=this.data.descendants||[],u=(this.data.ancestors||[]).find(Be=>"Donor"===Be.entity_type);this.donor=this.getDonor(u,i);const h=this.getRuiLocation(e,this.donor);h?this.rui_location=h:this.bad=!0,Bm[e.group_uuid]||(Bm[e.group_uuid]=e.group_name);const p=new Date(e.last_modified_timestamp).toLocaleDateString(),g=Bm[e.group_uuid]||e.group_name,m=e.created_by_user_displayname;this["@id"]=QC+e.uuid,this.label=`Registered ${p}, ${m}, ${g}`,this.link=`${i}browse/sample/${e.uuid}`;const w={},x=[];this.sections=x;const H=[];this.datasets=H;for(const Be of c.filter(He=>"Sample"===He.entity_type)){const He=this.getSection(Be,e,i);w[Be.submission_id]=He,x.push(He),He.section_number=null!==(s=He.section_number)&&void 0!==s?s:x.length}for(const Be of c)if("Dataset"===Be.entity_type){const He=this.getDataset(Be,t,i,r),vt=(0,Ar.get)(Be,["ingest_metadata","metadata","tissue_id"]);w[vt]?null===(o=w[vt].datasets)||void 0===o||o.push(He):H.push(He)}const I=null!=h?h:{},oe=`${I.x_dimension} x ${I.y_dimension} x ${I.z_dimension} ${I.dimension_units}`;this.section_count=I.slice_count||x.length;const Se=parseFloat((I.slice_thickness||(I.z_dimension||0)/Math.max(this.section_count,1)).toFixed(1));this.section_size=Se;const Pe=I.dimension_units||"millimeter";this.section_units=Pe,this.description=`${oe}, ${Se} ${Pe}, ${e.specimen_type}, ${this.section_count} Sections`,x.forEach((Be,He)=>{Be.description=`${I.x_dimension} x ${I.y_dimension} x ${Se} ${Pe}, ${Se} ${Pe}, ${Be.description}`,Be.section_number=He+1})}getSection(e,t,i){const r=new Date(e.last_modified_timestamp).toLocaleDateString();return{"@id":QC+e.uuid,"@type":"Sample",label:`Registered ${r}, ${e.created_by_user_displayname}, ${Bm[e.group_uuid]||e.group_name}`,description:`${t.specimen_type}`,link:`${i}browse/sample/${e.uuid}`,sample_type:"Tissue Section",section_number:1,samples:[],datasets:[]}}getDataset(e,t="",i="",r){var s;const o=new Date(e.last_modified_timestamp).toLocaleDateString(),a=Bm[e.group_uuid]||e.group_name,l=e.created_by_user_displayname,c=[...e.data_types,(0,Ar.get)(e,["ingest_metadata","metadata","assay_type"],"")],u=c.join("|").toLowerCase();let h,p="assets/icons/ico-unknown.svg";return-1!==u.indexOf("10x")?(h="10x",p="assets/icons/ico-bulk-10x.svg"):-1!==u.indexOf("af")?(h="AF",p="assets/icons/ico-spatial-af.svg"):-1!==u.indexOf("codex")?(h="CODEX",p="assets/icons/ico-spatial-codex.svg"):-1!==u.indexOf("imc")?(h="IMC",p="assets/icons/ico-spatial-imc.svg"):-1!==u.indexOf("lc")&&-1===u.indexOf("af")?(h="LC",p="assets/icons/ico-bulk-lc.svg"):h=-1!==u.indexOf("maldi")?"MALDI":-1!==u.indexOf("pas")?"PAS":"OTHER",p=null!==(s=this.getDatasetThumbnail(e,t,r))&&void 0!==s?s:p,{"@id":QC+e.uuid,"@type":"Dataset",label:`Registered ${o}, ${l}, ${a}`,description:`Data/Assay Types: ${c.join(", ")}`,link:`${i}browse/dataset/${e.uuid}`,technology:h,thumbnail:p}}getDatasetThumbnail(e,t,i){if(e.thumbnail_file){const r=e.thumbnail_file;return`${t}/${r.file_uuid}/${r.filename}`+(i?`?token=${i}`:"")}if("73bb26e4-ed43-11e8-8f19-0a7c1eab007a"===e.group_uuid){const r=(0,Ar.get)(e,"metadata.files",[]).filter(s=>/\.(ome\.tif|ome\.tiff)$/.test(s.rel_path)).filter(s=>!/(multilayer\.ome\.tif|_ac\.ome\.tif)/.test(s.rel_path)).filter(s=>W7.has(s.rel_path.split("/").slice(-1)[0].split("?")[0].replace(".ome.tif","_thumbnail.jpg"))).map(s=>`${t}/${e.uuid}/${s.rel_path}`+(i?`?token=${i}`:""));if(r.length>0){const s=r[0].split("/").slice(-1)[0].split("?")[0].replace(".ome.tif","_thumbnail.jpg");if(W7.has(s))return`assets/thumbnails/TMC-Vanderbilt/DR1/${s}`}}else if("07a29e4c-ed43-11e8-b56a-0e8017bdda58"===e.group_uuid){const r=TOe[e.hubmap_id];if(r)return`assets/thumbnails/TMC-Florida/${r}`}}getDonor(e,t){const i=(e.description||"").toLowerCase();let r;i.includes("female")?r="Female":i.includes("male")&&(r="Male");const s=i.match(/age ([0-9]+)/);let o,a;s&&(o=(0,Ar.toNumber)(s[1]));for(const p of(0,Ar.get)(e,"metadata.organ_donor_data",[]))"Feminine gender"===p.preferred_term||"Female"===p.preferred_term?r="Female":"Masculine gender"===p.preferred_term||"Male"===p.preferred_term?r="Male":"Current chronological age"===p.preferred_term||"Age"===p.preferred_term?o=(0,Ar.toNumber)(p.data_value):"Body mass index"===p.preferred_term&&(a=(0,Ar.toNumber)(p.data_value));let l="";r&&o&&(l+=`${r}, Age ${o}`,a&&(l+=`, BMI ${a.toFixed(1)}`));const c=new Date(e.last_modified_timestamp).toLocaleDateString(),u=Bm[e.group_uuid]||e.group_name;return{"@id":QC+e.uuid,"@type":"Donor",label:l,description:`Entered ${c}, ${e.created_by_user_displayname}, ${u}`,link:`${t}browse/donor/${e.uuid}`,age:o,sex:r,bmi:a,consortium_name:"HuBMAP",provider_name:u,provider_uuid:e.group_uuid,samples:[]}}getRuiLocation(e,t){var i;const s=(e.ancestors||[]).find(c=>"Sample"===c.entity_type&&"organ"===c.specimen_type),o=MOe[null==s?void 0:s.organ]||[Wt.body];let a,l=e.rui_location;if(l&&("string"==typeof l&&(l=JSON.parse(l)),l.alignment_id?console.log("Detected a deprecated rui_location",e.uuid):l["@id"]&&(a=l)),a){a.ccf_annotations=o.concat(a.ccf_annotations||[]);const c=null!==(i=(0,Ar.get)(a,["placement","target"]))&&void 0!==i?i:"";c.startsWith("http://purl.org/ccf/latest/ccf.owl#VHSpleenCC")&&(0,Ar.set)(a,["placement","target"],c.replace("#VHSpleenCC","Male"===t.sex?"#VHMSpleenCC":"#VHFSpleenCC")),("http://purl.org/ccf/latest/ccf.owl#VHLeftKidney"===c||"http://purl.org/ccf/latest/ccf.owl#VHRightKidney"===c)&&(0,Ar.set)(a,["placement","target"],"Male"===t.sex?c.replace("#VH","#VHM")+"_Patch":c.replace("#VH","#VHF")+"_Patch")}return a}getTissueBlock(){return(0,Ar.omit)(Object.assign({},this),["data","bad","donor"])}toJsonLd(){return Object.assign(Object.assign({},this.donor),{samples:[this.getTissueBlock()]})}}const NOe=["uuid","entity_type","group_uuid","group_name","last_modified_timestamp","created_by_user_displayname","ancestors","descendants","rui_location","specimen_type"],POe={exists:{field:"rui_location"}};function Y7(n,e,t){return JSON.stringify({version:!0,from:n,size:e,stored_fields:["*"],script_fields:{},docvalue_fields:[],query:null!=t?t:POe,_source:{includes:NOe}})}function bF(n,e){return Ni(this,void 0,void 0,function*(){try{const t=yield fetch(n,e);return t.ok?yield t.json():void 0}catch(t){return}})}function K7(n,e,t,i,r="",s=""){return Ni(this,void 0,void 0,function*(){let o;if("static"===e?o=yield bF(n):"search-api"===e&&(o=yield function(n,e,t){return Ni(this,void 0,void 0,function*(){const r=function(n){const e=new Headers;return e.append("Content-type","application/json"),n&&e.append("Authorization",`Bearer ${n}`),e}(e),s=Y7(0,50,t),o=yield bF(n,{method:"POST",headers:r,body:s});if(!o)return;const a=o.hits.total.value;if(a<=50)return o;const l=[];for(let h=50;h<a;h+=50)l.push(bF(n,{method:"POST",headers:r,body:Y7(h,50,t)}));const c=yield Promise.all(l);if(c.some(h=>!h))return;const u=c.map(h=>h.hits.hits);return Object.assign(Object.assign({},o),{hits:Object.assign(Object.assign({},o.hits),{hits:o.hits.hits.concat(...u)})})})}(n,i,t)),o)return function(n,e="",t="",i,r=!1){const o={},a=(0,Ar.get)(n,"hits.hits",[]).map(c=>(0,Ar.get)(c,"_source",{})).map(c=>new OOe(c,e,t,i).toJsonLd());for(const c of a){const u=c["@id"];o[u]?o[u].samples.push(c.samples[0]):o[u]=c}const l=Object.values(o);return r&&(function(n){let e=[],t=0;for(const i of n.filter(r=>r.samples.length>1)){const r=i.samples;for(let s=0;s<r.length;s++){const o=r[s]["@id"];e=e.concat(r[s].datasets);for(const a of r[s].sections)e=e.concat(a.datasets);for(let a=s+1;a<r.length;a++)r[a].sections.find(c=>c["@id"]===o)&&(r[s].deleteMe=!0,t++)}i.samples=r.filter(s=>!0!==s.deleteMe)}t>0&&console.log(`\u26a0 ${t} sections identified as blocks`)}(l),console.log(l.map(c=>Object.assign({"@context":q7},c)))),{"@context":q7,"@graph":l}}(o,r,s,i);console.warn(`Unable to load ${n} as HuBMAP Data`)})}function Bv(n,e,t){const i=new Set;for(const r of e)for(const s of(0,Jn.readQuads)(n,r,t,null,null))i.add(s.object.id);return i}const jOe={[Qi.spatialEntity.x_dimension.id]:"x",[Qi.spatialEntity.y_dimension.id]:"y",[Qi.spatialEntity.z_dimension.id]:"z"};function zOe(n,e,t,i){const r=e.getTransformationMatrix(t,i);let s;if(r){const o=function(n,e){const t=rp(n,e,"Dimensions",jOe);return[t.x,t.y,t.z]}(n,t),a=r.getTranslation(),l=(new Xi).fromRotationMatrix(r,Xi.XYZ),c=new Nv(Nv.IDENTITY).fromQuaternion(l.toQuaternion()).scale(o.map(u=>u/1e3/1e3));s=new dF(a,c)}return s}function HOe(n,e,t,i){const{x:r,y:s,z:o,radius:a,target:l}=i,c=new Set,u=a/1e3*(a/1e3);for(const h of t){const p=zOe(n,e,h,l);p&&p.distanceSquaredTo([r,s,o].map(m=>m/1e3))<u&&c.add(h)}return c}function ZC(n,e,t){var i,r;const s=new Map,o=new Set;for(const c of e)for(const u of(0,Jn.readQuads)(n,c,fi.donor,null,null))o.add(u.object.id),s.has(u.object.id)?null===(i=s.get(u.object.id))||void 0===i||i.push(c):s.set(u.object.id,[c]);const a=t(o),l=new Set;for(const c of a)for(const u of null!==(r=s.get(c))&&void 0!==r?r:[])l.add(u);return l}function wF(n,e,t){var i,r;const s=new Map,o=new Set;for(const c of e)for(const u of(0,Jn.readQuads)(n,c,fi.spatialEntity,null,null))o.add(u.object.id),s.has(u.object.id)?null===(i=s.get(u.object.id))||void 0===i||i.push(c):s.set(u.object.id,[c]);const a=t(o),l=new Set;for(const c of a)for(const u of null!==(r=s.get(c))&&void 0!==r?r:[])l.add(u);return l}function Vv(n,e){return function(t){n.has(t.id)&&e.add(t.id)}}function X7(n,e,t){const i=new Set;for(const r of t){const s=Jn.DataFactory.namedNode(r);n.forSubjects(Vv(e,i),Qi.spatialEntity.ccf_annotations,s,null)}return i}function Q7(n,e){const t=function(n,e){const t=new Map;for(const i of n)for(const r of(0,Jn.readQuads)(e,i,fi.spatialEntity,null,null))t.has(r.object.id)?t.get(r.object.id).add(i):t.set(r.object.id,new Set([i]));return t}(n,e),i=new Map;for(const r of t.keys()){const s=t.get(r);for(const o of(0,Jn.readQuads)(e,r,Qi.spatialEntity.ccf_annotations,null,null))if(i.has(o.object.id)){const a=i.get(o.object.id);s.forEach(l=>a.add(l))}else i.set(o.object.id,new Set(s))}return i}function rRe(n,e,t){const i={"@id":e,"@type":"OntologyTreeNode",id:e,parent:"",children:[],synonymLabels:[],label:""},r={[Qi.ontologyNode.label.id]:"label",[t]:"parent",[Qi.ontologyNode.synonymLabels.id]:"synonymLabels"};for(const[s,o]of yF(n,e,r))"synonymLabels"===s?i.synonymLabels.push(o):i[s]=o;return i.children=n.getSubjects(t,e,null).map(s=>s.id),i}function Z7(n,e,t,i){const r={root:e,nodes:{}},s=new Set;for(const a of(0,Jn.readQuads)(n,null,i,null,null))s.add(a.subject.id),s.add(a.object.id);for(const a of s)r.nodes[a]=rRe(n,a,i);r.nodes[e]||(r.nodes[e]={"@id":e,"@type":"OntologyTreeNode",id:e,label:t,children:[],synonymLabels:[]});const o=n.getSubjects(i,e,null).map(a=>a.id).sort((a,l)=>r.nodes[a].label.localeCompare(r.nodes[l].label));return r.nodes[e].children=o,r}const JC={[fi.label.id]:"label",[fi.description.id]:"description",[fi.link.id]:"link"},aRe=Object.assign(Object.assign({},JC),{[fi.providerName.id]:"providerName"}),lRe=Object.assign(Object.assign({},JC),{[fi.technology.id]:"technology",[fi.thumbnail.id]:"thumbnail"}),cRe=Object.assign(Object.assign({},JC),{[fi.sampleType.id]:"sampleType",[fi.sectionNumber.id]:"sectionNumber",[fi.datasets.id]:"datasets"}),uRe=Object.assign(Object.assign({},JC),{[fi.sampleType.id]:"sampleType",[fi.sectionCount.id]:"sectionCount",[fi.sectionSize.id]:"sectionSize",[fi.sectionUnits.id]:"sectionUnits",[fi.donor.id]:"donor",[fi.spatialEntity.id]:"spatialEntityId",[fi.sections.id]:"sections",[fi.datasets.id]:"datasets"});function dRe(n,e){return rp(n,e,"Donor",aRe)}function J7(n,e){return rp(n,e,"Dataset",lRe)}function hRe(n,e){const t={"@id":e,"@type":"Sample",datasets:[]};for(const[i,r]of yF(n,e,cRe))if("datasets"===i){const s=J7(n,r);t[i].push(s)}else t[i]=r;return t}class pRe{constructor(e){this.database=e,this.connect()}toJson(){return{status:this.status,message:this.message,checkback:"Ready"===this.status||"Error"===this.status?36e5:2e3,loadTime:this.loadTime}}connect(){this.status="Loading",this.message="Loading database";const e=Date.now();return this.database.connect().then(t=>Ni(this,void 0,void 0,function*(){t?(this.message="Building scene",yield this.database.getScene(),this.message="Building tissue block results",yield this.database.getTissueBlockResults(),this.message="Aggregating results",yield this.database.getAggregateResults(),this.status="Ready",this.message="Database successfully loaded"):(this.status="Error",this.message="Unknown error while loading database")})).catch(t=>{var i;this.status="Error",this.message=null!==(i=null==t?void 0:t.message)&&void 0!==i?i:"Unknown error while loading database"}).finally(()=>{this.loadTime=Date.now()-e})}}const gRe={ccfOwlUrl:"https://purl.org/ccf/latest/ccf.owl",ccfContextUrl:"https://purl.org/ccf/latest/ccf-context.jsonld",dataSources:[],hubmapDataService:"static",hubmapPortalUrl:"https://portal.hubmapconsortium.org/",hubmapDataUrl:"",hubmapAssetsUrl:"https://assets.hubmapconsortium.org"};class mRe{constructor(e=gRe){this.options=e,this.store=new Jn.Store(void 0,{factory:Jn.DataFactory}),this.graph=new G7(this),this.scene=new $7(this)}connect(e,t=!1){return Ni(this,void 0,void 0,function*(){return e&&(this.options=e),this.initializing||(this.initializing=t?this.cachedConnect():this.doConnect()),yield this.initializing,this.store.size>0})}cachedConnect(){return Ni(this,void 0,void 0,function*(){const e=(new Date).getTime(),t="ccf-database.last_modified",i="ccf-database",r=yield T7(t).catch(()=>{});let s;r&&e-new Date(+r).getTime()>36e5?yield function(n,e=vc()){return e("readwrite",t=>(n.forEach(i=>t.delete(i)),pu(t.transaction)))}([i,t]).catch(()=>{}):s=yield T7(i).catch(()=>{}),s?yield this.deserialize(s):(yield this.doConnect(),function(n,e=vc()){return e("readwrite",t=>(n.forEach(i=>t.put(i[1],i[0])),pu(t.transaction)))}([[i,this.serialize()],[t,""+e]]).catch(()=>{}))})}doConnect(){var e,t;return Ni(this,void 0,void 0,function*(){const i=[],r=null!==(t=null===(e=this.options.dataSources)||void 0===e?void 0:e.concat())&&void 0!==t?t:[],s=this.options.ccfOwlUrl;if(s.startsWith("{"))this.store=(0,Jn.deserializeN3Store)(s,Jn.DataFactory);else if(s.endsWith(".n3store.json")){const o=yield fetch(s).then(a=>a.text()).catch(()=>console.log("Couldn't locate serialized store."));o&&(this.store=(0,Jn.deserializeN3Store)(o,Jn.DataFactory))}else(null==s?void 0:s.length)>0&&r.push(s);this.options.hubmapDataUrl&&(this.options.hubmapDataUrl.endsWith("jsonld")?r.push(this.options.hubmapDataUrl):i.push(K7(this.options.hubmapDataUrl,this.options.hubmapDataService,this.options.hubmapQuery,this.options.hubmapToken,this.options.hubmapAssetsUrl,this.options.hubmapPortalUrl).then(o=>{if(o)return this.addDataSources([o])}))),i.push(this.addDataSources(r)),yield Promise.all(i),yield this.synchronize()})}addDataSources(e,t){return Ni(this,void 0,void 0,function*(){const i=null!=t?t:this.store;return yield Promise.all(e.map(r=>Ni(this,void 0,void 0,function*(){"string"==typeof r?r.endsWith("jsonld")?yield(0,Jn.addJsonLdToStore)(r,i):r.endsWith("n3")?yield(0,Jn.addN3ToStore)(r,i):r.endsWith("rdf")||r.endsWith("owl")||r.endsWith("xml")?yield(0,Jn.addRdfXmlToStore)(r,i):yield(0,Jn.addJsonLdToStore)(r,i):yield(0,Jn.addJsonLdToStore)(r,i)}))),this})}synchronize(){return Ni(this,void 0,void 0,function*(){return yield new Promise(e=>{setTimeout(e,500)}),this.graph.createGraph(),this})}serialize(){return(0,Jn.serializeN3Store)(this.store)}deserialize(e){return Ni(this,void 0,void 0,function*(){this.store=(0,Jn.deserializeN3Store)(e,Jn.DataFactory),this.graph=new G7(this),this.scene=new $7(this),yield new Promise(t=>{setTimeout(t,10)})})}getIds(e={}){return function(n,e,t){var i,r,s,o,a,l,c;let u=function(n){const e=new Set;return n.forSubjects(t=>e.add(t.id),fi.spatialEntity,null,null),e}(n);if(u.size>0&&(u=function(n,e,t=!0){const i=new Set;if(n.forSubjects(Vv(e,i),fi.spatialEntity,null,null),!t){const r=new Set;return e.forEach(s=>i.has(s)?void 0:r.add(s)),r}return i}(n,u)),u.size>0&&("Male"===t.sex||"Female"===t.sex)){const h=t.sex;u=ZC(n,u,p=>function(n,e,t){const i=new Set;return n.forSubjects(Vv(e,i),fi.sex,fi[t],null),i}(n,p,h))}if(u.size>0&&(null===(i=t.tmc)||void 0===i?void 0:i.length)>0&&(u=ZC(n,u,h=>function(n,e,t){const i=new Set;for(const r of t){const s=Jn.DataFactory.literal(r);n.forSubjects(Vv(e,i),fi.providerName,s,null)}return i}(n,h,t.tmc))),u.size>0&&(null===(r=t.technologies)||void 0===r?void 0:r.length)>0&&(u=function(n,e,t){var i,r;const s=new Map,o=new Set,a=new Set(e);for(const u of e)for(const h of(0,Jn.readQuads)(n,u,fi.sections,null,null))a.add(h.object.id);for(const u of a)for(const h of(0,Jn.readQuads)(n,u,fi.datasets,null,null))o.add(h.object.id),s.has(h.object.id)?null===(i=s.get(h.object.id))||void 0===i||i.push(u):s.set(h.object.id,[u]);const l=t(o),c=new Set;for(const u of l)for(const h of null!==(r=s.get(u))&&void 0!==r?r:[])c.add(h);return c}(n,u,h=>function(n,e,t){const i=new Set;for(const r of t){const s=Jn.DataFactory.literal(r);n.forSubjects(Vv(e,i),fi.technology,s,null)}return i}(n,h,t.technologies))),u.size>0&&(null===(s=t.spatialSearches)||void 0===s?void 0:s.length)>0&&(u=wF(n,u,h=>function(n,e,t,i){const r=new Set;for(const s of i)HOe(n,e,t,s).forEach(a=>r.add(a));return r}(n,e,h,t.spatialSearches))),u.size>0&&(null===(o=t.ontologyTerms)||void 0===o?void 0:o.length)>0){const h=t.ontologyTerms;-1===h.indexOf(mu.body.id)&&(u=wF(n,u,p=>X7(n,p,h)))}if(u.size>0&&(null===(a=t.cellTypeTerms)||void 0===a?void 0:a.length)>0){const h=t.cellTypeTerms;-1===h.indexOf(mu.cell.id)&&(u=wF(n,u,p=>function(n,e,t){const i=new Set;for(const r of t)n.forObjects(s=>{i.add(s.id)},r,Qi.asctb.located_in,null),r===mu.cell.id&&i.add(mu.body.id);return X7(n,e,[...i])}(n,p,h)))}if(u.size>0&&2===(null===(l=t.ageRange)||void 0===l?void 0:l.length)&&(0,Ar.isFinite)(t.ageRange[0])&&(0,Ar.isFinite)(t.ageRange[1])){const h=Math.max(...t.ageRange),p=Math.min(...t.ageRange);1===p&&110===h||(u=ZC(n,u,g=>function(n,e,t,i){const r=new Set;for(const s of e)for(const o of(0,Jn.readQuads)(n,s,fi.age,null,null)){const a=(0,$C.fromRdf)(o.object);a>=t&&a<=i&&r.add(s)}return r}(n,g,p,h)))}if(u.size>0&&2===(null===(c=t.bmiRange)||void 0===c?void 0:c.length)&&(0,Ar.isFinite)(t.bmiRange[0])&&(0,Ar.isFinite)(t.bmiRange[1])){const h=Math.max(...t.bmiRange),p=Math.min(...t.bmiRange);13===p&&83===h||(u=ZC(n,u,g=>function(n,e,t,i){const r=new Set;for(const s of e)for(const o of(0,Jn.readQuads)(n,s,fi.bmi,null,null)){const a=(0,$C.fromRdf)(o.object);a>=t&&a<=i&&r.add(s)}return r}(n,g,p,h)))}return u}(this.store,this.graph,e)}get(e){return this.store.getQuads(Jn.DataFactory.namedNode(e),null,null,null)}search(e={}){return[...this.getIds(e)].map(t=>this.get(t))}getSpatialEntities(e){return e=Object.assign(Object.assign({},e),{hasSpatialEntity:!0}),[...this.getIds(e)].map(t=>function(n,e){const t=n.getObjects(Jn.DataFactory.namedNode(e),fi.spatialEntity,null);if(t.length>0)return sp(n,t[0].id)}(this.store,t))}getDatabaseStatus(){return Ni(this,void 0,void 0,function*(){return this.status||(this.status=new pRe(this)),this.status.toJson()})}getDatasetTechnologyNames(){return Ni(this,void 0,void 0,function*(){return function(n){const e=new Set;for(const t of(0,Jn.readQuads)(n,null,fi.technology,null,null))e.add(t.object.value);return Array.from(e).sort()}(this.store)})}getProviderNames(){return Ni(this,void 0,void 0,function*(){return function(n){const e=new Set;for(const t of(0,Jn.readQuads)(n,null,fi.providerName,null,null))e.add(t.object.value);return Array.from(e).sort()}(this.store)})}getTissueBlockResults(e){return Ni(this,void 0,void 0,function*(){return e=Object.assign(Object.assign({},e),{hasSpatialEntity:!0}),[...this.getIds(e)].map(t=>function(n,e){const t={"@id":e,"@type":"Sample",sections:[],datasets:[]};for(const[i,r]of yF(n,e,uRe))if("sections"===i){const s=hRe(n,r);t[i].push(s)}else if("datasets"===i){const s=J7(n,r);t[i].push(s)}else t[i]="donor"===i?dRe(n,r):r;return t}(this.store,t))})}getAggregateResults(e){return Ni(this,void 0,void 0,function*(){return function(n,e){const t=Bv(e,n,fi.donor.id),i=Bv(e,t,fi.providerUUID.id),r=new Set;for(const l of n)for(const c of(0,Jn.readQuads)(e,l,fi.spatialEntity,null,null))r.add(c.subject.id);const s=Bv(e,r,fi.sections.id),o=new Set([...Bv(e,r,fi.datasets.id),...Bv(e,s,fi.datasets.id)]);return Object.entries({"Tissue Data Providers":i.size,Donors:t.size,"Tissue Blocks":r.size,"Tissue Sections":s.size,"Tissue Datasets":o.size}).map(([l,c])=>({label:l,count:c}))}(this.getIds(e),this.store)})}getOntologyTermOccurences(e){return Ni(this,void 0,void 0,function*(){return function(n,e){const t={};return Q7(n,e).forEach((r,s)=>{t[s]=r.size}),t}(this.getIds(e),this.store)})}getCellTypeTermOccurences(e){return Ni(this,void 0,void 0,function*(){return function(n,e){var t,i;const r=Q7(n,e),s=new Map;for(const a of r.keys()){const l=r.get(a);for(const c of(0,Jn.readQuads)(e,null,Qi.asctb.located_in,a,null)){const u=c.subject.id;if(s.has(u)){const h=s.get(u);l.forEach(p=>h.add(p))}else s.set(u,new Set(l))}}const o={};return s.forEach((a,l)=>{o[l]=a.size}),o[mu.cell.id]=null!==(i=null===(t=r.get(mu.body.id))||void 0===t?void 0:t.size)&&void 0!==i?i:0,o}(this.getIds(e),this.store)})}getOntologyTreeModel(){return Ni(this,void 0,void 0,function*(){return function(n){const e=Z7(n,mu.body.id,"body",Qi.asctb.part_of.id);return e.nodes[mu.body.id].children=["http://purl.obolibrary.org/obo/UBERON_0000955","http://purl.obolibrary.org/obo/UBERON_0000029","http://purl.obolibrary.org/obo/UBERON_0000970","http://purl.obolibrary.org/obo/UBERON_0003889","http://purl.obolibrary.org/obo/UBERON_0000948","http://purl.obolibrary.org/obo/UBERON_0002113","http://purl.obolibrary.org/obo/UBERON_0001465","http://purl.obolibrary.org/obo/UBERON_0002107","http://purl.obolibrary.org/obo/UBERON_0002048","http://purl.obolibrary.org/obo/UBERON_0000992","http://purl.obolibrary.org/obo/UBERON_0001264","http://purl.obolibrary.org/obo/UBERON_0001270","http://purl.obolibrary.org/obo/UBERON_0002367","http://purl.obolibrary.org/obo/UBERON_0002097","http://purl.obolibrary.org/obo/UBERON_0002108","http://purl.obolibrary.org/obo/UBERON_0000059","http://purl.obolibrary.org/obo/UBERON_0002106","http://purl.obolibrary.org/obo/UBERON_0002370","http://purl.obolibrary.org/obo/UBERON_0000056","http://purl.obolibrary.org/obo/UBERON_0001255","http://purl.obolibrary.org/obo/UBERON_0000995","http://purl.obolibrary.org/obo/UBERON_0004537"].filter(t=>t in e.nodes),e}(this.store)})}getCellTypeTreeModel(){return Ni(this,void 0,void 0,function*(){return function(n){return Z7(n,mu.cell.id,"cell",Qi.asctb.ct_is_a.id)}(this.store)})}getReferenceOrgans(){return Ni(this,void 0,void 0,function*(){return this.scene.getReferenceOrgans()})}getScene(e){return Ni(this,void 0,void 0,function*(){return this.graph.createGraph(),this.scene.getScene(e)})}getReferenceOrganScene(e,t){return Ni(this,void 0,void 0,function*(){return this.graph.createGraph(),this.scene.getReferenceOrganScene(e,t)})}getSpatialPlacement(e,t){return Ni(this,void 0,void 0,function*(){return this.graph.getSpatialPlacement(e,t)})}}const _Re=["bodyCanvas"];let yRe=(()=>{class n{constructor(){this.clsName="ccf-body-ui",this.rotationChange=new hn,this.nodeDrag=new hn,this.nodeClick=new hn,this.nodeHoverStart=new hn,this.nodeHoverStop=new hn,this.initialized=new hn,this._interactive=!0,this._rotation=0,this._rotationX=0,this._zoom=9.5,this._target=[0,0,0],this._scene=[],this.subscriptions=[]}get scene(){return this._scene}set scene(t){var i;this._scene=t,null===(i=this.bodyUI)||void 0===i||i.setScene(t)}get rotation(){return this._rotation}set rotation(t){var i;this._rotation=t,null===(i=this.bodyUI)||void 0===i||i.setRotation(t)}get rotationX(){return this._rotationX}set rotationX(t){var i;this._rotationX=t,null===(i=this.bodyUI)||void 0===i||i.setRotationX(t)}get zoom(){return this._zoom}set zoom(t){var i;this._zoom=t,null===(i=this.bodyUI)||void 0===i||i.setZoom(t)}get target(){return this._target}set target(t){var i;this._target=t,null===(i=this.bodyUI)||void 0===i||i.setTarget(t)}get bounds(){return this._bounds}set bounds(t){this._bounds=t,this.zoomToBounds(t)}get camera(){return this._camera}set camera(t){this._camera=t}get interactive(){return this._interactive}set interactive(t){this._interactive=t,this.bodyUI&&this.recreateBodyUI()}ngAfterViewInit(){this.setupBodyUI()}zoomToBounds(t,i={x:48,y:48}){if(this.bodyCanvas){const{width:r,height:s}=this.bodyCanvas.nativeElement,o=window.devicePixelRatio,a=Math.min(Math.log2((r-i.x)/o/t.x),Math.log2((s-i.y)/o/t.y));this.zoom=a}}setupBodyUI(){var t;return Ni(this,void 0,void 0,function*(){const i=this.bodyCanvas.nativeElement,r=new x0e({id:"body-ui",canvas:i,zoom:this.zoom,target:[0,0,0],rotation:0,minRotationX:-75,maxRotationX:75,interactive:this.interactive,camera:this.camera});i.addEventListener("contextmenu",s=>s.preventDefault()),yield r.initialize(),this.bodyUI=r,window.bodyUI=r,(null===(t=this.scene)||void 0===t?void 0:t.length)>0&&this.bodyUI.setScene(this.scene),this.bounds&&this.zoomToBounds(this.bounds),this.subscriptions=[this.bodyUI.sceneRotation$.subscribe(s=>this.rotationChange.next(s)),this.bodyUI.nodeDrag$.subscribe(s=>this.nodeDrag.emit(s)),this.bodyUI.nodeClick$.subscribe(s=>this.nodeClick.emit(s)),this.bodyUI.nodeHoverStart$.subscribe(s=>this.nodeHoverStart.emit(s)),this.bodyUI.nodeHoverStop$.subscribe(s=>this.nodeHoverStop.emit(s))],this.initialized.emit()})}recreateBodyUI(){this.clearSubscriptions(),this.bodyUI.finalize(),this.setupBodyUI()}clearSubscriptions(){this.subscriptions.forEach(t=>t.unsubscribe()),this.subscriptions=[]}ngOnDestroy(){this.clearSubscriptions()}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=yn({type:n,selectors:[["ccf-body-ui"]],viewQuery:function(t,i){if(1&t&&Rr(_Re,5,En),2&t){let r;mi(r=_i())&&(i.bodyCanvas=r.first)}},hostVars:2,hostBindings:function(t,i){2&t&&jc(i.clsName)},inputs:{scene:"scene",rotation:"rotation",rotationX:"rotationX",zoom:"zoom",target:"target",bounds:"bounds",camera:"camera",interactive:"interactive"},outputs:{rotationChange:"rotationChange",nodeDrag:"nodeDrag",nodeClick:"nodeClick",nodeHoverStart:"nodeHoverStart",nodeHoverStop:"nodeHoverStop",initialized:"initialized"},decls:2,vars:0,consts:[[1,"body-ui"],["bodyCanvas",""]],template:function(t,i){1&t&&Ti(0,"canvas",0,1)},styles:["[_nghost-%COMP%]{height:100%;display:block}[_nghost-%COMP%]   .body-ui[_ngcontent-%COMP%]{position:relative!important;background-color:#000;border-radius:.5rem}"]}),n})(),vRe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=ln({type:n}),n.\u0275inj=wt({imports:[[es]]}),n})();new zt("Maximum number of autocomplete options displayed",{providedIn:"root",factory:()=>10});const t9=[{src:"app:skin",organ:"Skin",name:"Skin",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002097"},{src:"app:brain",organ:"Brain",name:"Brain",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000955"},{disabled:!0,src:"app:lymph-nodes",organ:"Lymph Node",name:"Lymph Node",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000029"},{src:"app:lymph-nodes",organ:"Lymph Node",name:"Lymph Node",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002509"},{disabled:!0,src:"app:eye",organ:"Eye",name:"Eye, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000970"},{src:"app:eye",organ:"Eye",name:"Eye, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0004548"},{src:"app:eye",organ:"Eye",name:"Eye, R",side:"right",hasSex:!0,id:"http://purl.obolibrary.org/obo/FMA_54449"},{disabled:!0,src:"app:fallopian-tube-left",organ:"Fallopian Tube",name:"Fallopian Tube, L",side:"left",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0003889"},{src:"app:fallopian-tube-left",organ:"Fallopian Tube",name:"Fallopian Tube, L",side:"left",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0001303"},{src:"app:fallopian-tube-right",organ:"Fallopian Tube",name:"Fallopian Tube, R",side:"right",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0001302"},{src:"app:heart",organ:"Heart",name:"Heart",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000948"},{disabled:!0,src:"app:kidney-left",organ:"Kidney",name:"Kidney, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002113"},{src:"app:kidney-left",organ:"Kidney",name:"Kidney, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0004538"},{src:"app:kidney-right",organ:"Kidney",name:"Kidney, R",side:"right",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0004539"},{disabled:!0,src:"app:knee",organ:"Knee",name:"Knee, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001465"},{src:"app:knee",organ:"Knee",name:"Knee, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/FMA_24978"},{src:"app:knee",organ:"Knee",name:"Knee, R",side:"right",hasSex:!0,id:"http://purl.obolibrary.org/obo/FMA_24977"},{src:"app:liver",organ:"Liver",name:"Liver",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002107"},{disabled:!0,src:"app:lung",organ:"Lung",name:"Lungs",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002048"},{src:"app:lung",organ:"Lung",name:"Lungs",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001004"},{disabled:!0,src:"app:ovary-left",organ:"Ovary",name:"Ovary, L",side:"left",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0000992"},{src:"app:ovary-left",organ:"Ovary",name:"Ovary, L",side:"left",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/FMA_7214"},{src:"app:ovary-right",organ:"Ovary",name:"Ovary, R",side:"right",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/FMA_7213"},{src:"app:pancreas",organ:"Pancreas",name:"Pancreas",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001264"},{src:"app:pelvis-f",organ:"Pelvis",name:"Pelvis",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001270"},{src:"app:prostate",organ:"Prostate",name:"Prostate",hasSex:!1,sex:"male",id:"http://purl.obolibrary.org/obo/UBERON_0002367",disabled:!0},{src:"app:prostate",organ:"Prostate",name:"Prostate",hasSex:!1,sex:"male",id:"http://purl.obolibrary.org/obo/UBERON_0000079"},{src:"app:small-intestine",organ:"Small Intestine",name:"Small Intestine",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002108"},{src:"app:large-intestine",organ:"Large Intestine",name:"Large Intestine",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000059"},{src:"app:spleen",organ:"Spleen",name:"Spleen",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002106"},{src:"app:thymus",organ:"Thymus",name:"Thymus",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002370"},{disabled:!0,src:"app:ureter-left",organ:"Ureter",name:"Ureter, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000056"},{src:"app:ureter-left",organ:"Ureter",name:"Ureter, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001223"},{src:"app:ureter-right",organ:"Ureter",name:"Ureter, R",side:"right",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001222"},{src:"app:bladder",organ:"Urinary Bladder",name:"Urinary Bladder",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001255"},{src:"app:uterus",organ:"Uterus",name:"Uterus",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0000995"},{src:"app:vasculature-thick",organ:"Blood Vasculature",name:"Blood Vasculature",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0004537"},{disabled:!0,src:"app:vasculature-thick",organ:"Blood Vasculature",name:"Blood Vasculature",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002049"}].sort((n,e)=>n.name.localeCompare(e.name));t9.filter(n=>!0!==n.disabled);let Vm=(()=>{let n=class extends dAe{constructor(){super(...arguments),this.optionCache=new Map}get config$(){return this.state$.pipe(qi(n=>null!=n),ja(1))}setConfig(t){this.setState(t)}patchConfig(t){this.patchState(t)}getProperty(t){return this.config$.pipe(o$(...t),id(),ja(1))}getOption(...t){const i=this.getPathKey(t);if(this.optionCache.has(i))return this.optionCache.get(i);const r=this.config$.pipe(o$(...t),id(),ja(1));return this.optionCache.set(i,r),r}getPathKey(t){return`${t.length}:${t.join(".")}`}};return n.\u0275fac=function(){let e;return function(i){return(e||(e=$i(n)))(i||n)}}(),n.\u0275prov=We({token:n,factory:n.\u0275fac}),Nr([dW()],n.prototype,"config$",null),n=Nr([lAe(),xve({name:"globalConfig",defaults:null})],n),n})();!function(){const n=localStorage.getItem("ALLOW_TELEMETRY");null===n||n.toLowerCase()}();class n9 extends class{getDatabaseStatus(){return this.forwardCall("getDatabaseStatus")}getProviderNames(){return this.forwardCall("getProviderNames")}getDatasetTechnologyNames(){return this.forwardCall("getDatasetTechnologyNames")}getOntologyTreeModel(){return this.forwardCall("getOntologyTreeModel")}getCellTypeTreeModel(){return this.forwardCall("getCellTypeTreeModel")}getReferenceOrgans(){return this.forwardCall("getReferenceOrgans")}getTissueBlockResults(e){return this.forwardCall("getTissueBlockResults",e)}getAggregateResults(e){return this.forwardCall("getAggregateResults",e)}getOntologyTermOccurences(e){return this.forwardCall("getOntologyTermOccurences",e)}getCellTypeTermOccurences(e){return this.forwardCall("getCellTypeTermOccurences",e)}getScene(e){return this.forwardCall("getScene",e)}getReferenceOrganScene(e,t){return this.forwardCall("getReferenceOrganScene",e,t)}}{forwardCall(e,...t){return this.impl$.pipe(ts(i=>i[e](...t)))}}let i9=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const EF=new se,jv={cacheBusterObserver:EF},jm={cacheBusterObserver:EF,maxCacheCount:4};function r9(n,e,t){return n?{min:n[0]>e?n[0]:void 0,max:n[1]<t?n[1]:void 0}:void 0}function s9(n){return n.map(e=>{var t;return Object.assign(Object.assign({},e),{transformMatrix:new Wn(null!==(t=e.transformMatrix)&&void 0!==t?t:[])})})}let QRe=(()=>{class n{constructor(t,i){this.api=t,this.globalConfig=i,i.getOption("hubmapToken").subscribe(EF)}getDatabaseStatus(){return this.doRequest(t=>this.api.dbStatus(t))}getProviderNames(){return this.doRequest(t=>this.api.providerNames(t))}getDatasetTechnologyNames(){return this.doRequest(t=>this.api.technologyNames(t))}getOntologyTreeModel(){return this.doRequest(t=>this.api.ontologyTreeModel(t),void 0,{},n=>n)}getCellTypeTreeModel(){return this.doRequest(t=>this.api.cellTypeTreeModel(t),void 0,{},n=>n)}getReferenceOrgans(){return this.doRequest(t=>this.api.referenceOrgans(t),void 0,{},n=>n)}getTissueBlockResults(t){return this.doRequest(i=>this.api.tissueBlocks(i),t,{},n=>n)}getAggregateResults(t){return this.doRequest(i=>this.api.aggregateResults(i),t)}getOntologyTermOccurences(t){return this.doRequest(i=>this.api.ontologyTermOccurences(i),t)}getCellTypeTermOccurences(t){return this.doRequest(i=>this.api.cellTypeTermOccurences(i),t)}getScene(t){return this.doRequest(i=>this.api.scene(i),t,{},s9)}getReferenceOrganScene(t,i){return this.doRequest(r=>this.api.referenceOrganScene(r),i,{organIri:t},s9)}doRequest(t,i,r,s){const{api:o,globalConfig:a}=this,l=Object.assign(Object.assign({},function(n){var e,t;return{age:r9(null==n?void 0:n.ageRange,1,110),bmi:r9(null==n?void 0:n.bmiRange,13,83),sex:null===(t=null===(e=null==n?void 0:n.sex)||void 0===e?void 0:e.toLowerCase)||void 0===t?void 0:t.call(e),ontologyTerms:null==n?void 0:n.ontologyTerms,cellTypeTerms:null==n?void 0:n.cellTypeTerms,providers:null==n?void 0:n.tmc,technologies:null==n?void 0:n.technologies,spatial:null==n?void 0:n.spatialSearches}}(i)),r);return function(...n){let e,t;return xe(n[n.length-1])&&(t=n.pop()),"function"==typeof n[n.length-1]&&(e=n.pop()),1===n.length&&k(n[0])&&(n=n[0]),Mn(n,t).lift(new u8(e))}([a.getOption("remoteApiEndpoint"),a.getOption("hubmapToken")]).pipe(Gr(1),dr(([c,u])=>{o.configuration.basePath=c,u&&(l.token=u)}),ts(()=>t(l)),me(c=>s?s(c):c))}}return n.\u0275fac=function(t){return new(t||n)(Ie(C7),Ie(Vm))},n.\u0275prov=We({token:n,factory:n.\u0275fac,providedIn:"root"}),Nr([yc(jv)],n.prototype,"getProviderNames",null),Nr([yc(jv)],n.prototype,"getDatasetTechnologyNames",null),Nr([yc(jv)],n.prototype,"getOntologyTreeModel",null),Nr([yc(jv)],n.prototype,"getCellTypeTreeModel",null),Nr([yc(jv)],n.prototype,"getReferenceOrgans",null),Nr([yc(jm)],n.prototype,"getTissueBlockResults",null),Nr([yc(jm)],n.prototype,"getAggregateResults",null),Nr([yc(jm)],n.prototype,"getOntologyTermOccurences",null),Nr([yc(jm)],n.prototype,"getCellTypeTermOccurences",null),Nr([yc(jm)],n.prototype,"getScene",null),Nr([yc(jm)],n.prototype,"getReferenceOrganScene",null),n})(),ZRe=(()=>{class n extends n9{constructor(t){super(),this.impl$=this.database$=t.config$.pipe(i=>i,qi(i=>Object.keys(i).length>0),ts(i=>function(n,e){return new O(t=>{let i,r;try{i=n()}catch(a){return void t.error(a)}try{r=e(i)}catch(a){return void t.error(a)}const o=(r?Ve(r):Wc).subscribe(t);return()=>{o.unsubscribe(),i&&i.unsubscribe()}})}(()=>this.createDatabase(i),r=>this.connectDatabase(r,i))),me(i=>i.database),ja(1))}connectDatabase(t,i){return Ni(this,void 0,void 0,function*(){const r=!la();return yield t.database.connect(i,r),t})}}return n.\u0275fac=function(t){return new(t||n)(Ie(Vm))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),JRe=(()=>{class n extends ZRe{createDatabase(t){return{database:new mRe(t),unsubscribe:()=>{}}}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=$i(n)))(i||n)}}(),n.\u0275prov=We({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),eNe=(()=>{class n extends n9{constructor(t,i){super(),this.impl$=t.config$.pipe(r=>r,me(r=>this.selectToken(r)),id(),me(r=>i.get(r)),ja(1))}}return n.\u0275fac=function(t){return new(t||n)(Ie(Vm),Ie(Un))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),tNe=(()=>{class n{constructor(t){this.source=t,this.organs=t9}getOrganInfo(t,i,r="Female"){let s=this.organs.find(a=>a.id===t);if(!s)return nn(void 0);const o=s.organ;return s.disabled&&(s=this.organs.find(a=>!a.disabled&&a.organ===o)),(null==s?void 0:s.side)&&i&&s.side!==i&&(s=this.organs.find(a=>!a.disabled&&a.organ===o&&a.side===i)),nn(s)}getOrgan(t,i="Both"){return this.source.getReferenceOrgans().pipe(me(r=>r.find(s=>s.representation_of===t.id&&("Both"===i||s.sex===i))))}getOrganScene(t,i="Female"){return t.id?this.source.getReferenceOrganScene(t.id,{ontologyTerms:[t.id],sex:i}):nn([])}getOrganStats(t,i="Female"){return t.id?this.source.getAggregateResults({ontologyTerms:[t.id],sex:i}):nn([])}getBlocks(t,i="Female"){return t.id?this.source.getTissueBlockResults({ontologyTerms:[t.id],sex:i}):nn([])}}return n.\u0275fac=function(t){return new(t||n)(Ie(i9))},n.\u0275prov=We({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const nNe=["thumbContainer"],iNe=["toggleBar"],rNe=["input"],sNe=function(n){return{enterDuration:n}},oNe=["*"],aNe=new zt("mat-slide-toggle-default-options",{providedIn:"root",factory:()=>({disableToggleValue:!1})});let lNe=0;const cNe={provide:za,useExisting:ge(()=>o9),multi:!0};class uNe{constructor(e,t){this.source=e,this.checked=t}}const dNe=nP(pv(tP(Jx(class{constructor(n){this._elementRef=n}}))));let o9=(()=>{class n extends dNe{constructor(t,i,r,s,o,a){super(t),this._focusMonitor=i,this._changeDetectorRef=r,this.defaults=o,this._onChange=l=>{},this._onTouched=()=>{},this._uniqueId="mat-slide-toggle-"+ ++lNe,this._required=!1,this._checked=!1,this.name=null,this.id=this._uniqueId,this.labelPosition="after",this.ariaLabel=null,this.ariaLabelledby=null,this.change=new hn,this.toggleChange=new hn,this.tabIndex=parseInt(s)||0,this.color=this.defaultColor=o.color||"accent",this._noopAnimations="NoopAnimations"===a}get required(){return this._required}set required(t){this._required=Yi(t)}get checked(){return this._checked}set checked(t){this._checked=Yi(t),this._changeDetectorRef.markForCheck()}get inputId(){return`${this.id||this._uniqueId}-input`}ngAfterContentInit(){this._focusMonitor.monitor(this._elementRef,!0).subscribe(t=>{"keyboard"===t||"program"===t?this._inputElement.nativeElement.focus():t||Promise.resolve().then(()=>this._onTouched())})}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}_onChangeEvent(t){t.stopPropagation(),this.toggleChange.emit(),this.defaults.disableToggleValue?this._inputElement.nativeElement.checked=this.checked:(this.checked=this._inputElement.nativeElement.checked,this._emitChangeEvent())}_onInputClick(t){t.stopPropagation()}writeValue(t){this.checked=!!t}registerOnChange(t){this._onChange=t}registerOnTouched(t){this._onTouched=t}setDisabledState(t){this.disabled=t,this._changeDetectorRef.markForCheck()}focus(t,i){i?this._focusMonitor.focusVia(this._inputElement,i,t):this._inputElement.nativeElement.focus(t)}toggle(){this.checked=!this.checked,this._onChange(this.checked)}_emitChangeEvent(){this._onChange(this.checked),this.change.emit(new uNe(this,this.checked))}_onLabelTextChange(){this._changeDetectorRef.detectChanges()}}return n.\u0275fac=function(t){return new(t||n)(De(En),De(ad),De(as),function(n){return function(n,e){if("class"===e)return n.classes;if("style"===e)return n.styles;const t=n.attrs;if(t){const i=t.length;let r=0;for(;r<i;){const s=t[r];if(Jv(s))break;if(0===s)r+=2;else if("number"==typeof s)for(r++;r<i&&"string"==typeof t[r];)r++;else{if(s===e)return t[r+1];r+=2}}}return null}(ss(),n)}("tabindex"),De(aNe),De(gc,8))},n.\u0275cmp=yn({type:n,selectors:[["mat-slide-toggle"]],viewQuery:function(t,i){if(1&t&&(Rr(nNe,5),Rr(iNe,5),Rr(rNe,5)),2&t){let r;mi(r=_i())&&(i._thumbEl=r.first),mi(r=_i())&&(i._thumbBarEl=r.first),mi(r=_i())&&(i._inputElement=r.first)}},hostAttrs:[1,"mat-slide-toggle"],hostVars:12,hostBindings:function(t,i){2&t&&(Lu("id",i.id),Wi("tabindex",i.disabled?null:-1)("aria-label",null)("aria-labelledby",null),Ai("mat-checked",i.checked)("mat-disabled",i.disabled)("mat-slide-toggle-label-before","before"==i.labelPosition)("_mat-animation-noopable",i._noopAnimations))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color",tabIndex:"tabIndex",name:"name",id:"id",labelPosition:"labelPosition",ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],required:"required",checked:"checked",ariaDescribedby:["aria-describedby","ariaDescribedby"]},outputs:{change:"change",toggleChange:"toggleChange"},exportAs:["matSlideToggle"],features:[Kn([cNe]),In],ngContentSelectors:oNe,decls:16,vars:20,consts:[[1,"mat-slide-toggle-label"],["label",""],[1,"mat-slide-toggle-bar"],["toggleBar",""],["type","checkbox","role","switch",1,"mat-slide-toggle-input","cdk-visually-hidden",3,"id","required","tabIndex","checked","disabled","change","click"],["input",""],[1,"mat-slide-toggle-thumb-container"],["thumbContainer",""],[1,"mat-slide-toggle-thumb"],["mat-ripple","",1,"mat-slide-toggle-ripple","mat-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleCentered","matRippleRadius","matRippleAnimation"],[1,"mat-ripple-element","mat-slide-toggle-persistent-ripple"],[1,"mat-slide-toggle-content",3,"cdkObserveContent"],["labelContent",""],[2,"display","none"]],template:function(t,i){if(1&t&&(function(n){const e=Bt()[16][6];if(!e.projection){const i=e.projection=Mc(n?n.length:1,null),r=i.slice();let s=e.child;for(;null!==s;){const o=n?eq(s,n):0;null!==o&&(r[o]?r[o].projectionNext=s:i[o]=s,r[o]=s),s=s.next}}}(),Ft(0,"label",0,1),Ft(2,"div",2,3),Ft(4,"input",4,5),Vn("change",function(s){return i._onChangeEvent(s)})("click",function(s){return i._onInputClick(s)}),Lt(),Ft(6,"div",6,7),Ti(8,"div",8),Ft(9,"div",9),Ti(10,"div",10),Lt(),Lt(),Lt(),Ft(11,"span",11,12),Vn("cdkObserveContent",function(){return i._onLabelTextChange()}),Ft(13,"span",13),Mi(14,"\xa0"),Lt(),function(n,e=0,t){const i=Bt(),r=gi(),s=Kd(r,20+n,16,null,t||null);null===s.projection&&(s.projection=e),ps(),64!=(64&s.flags)&&function(n,e,t){Q_(e[11],0,e,t,$b(n,t,e),Kb(t.parent||e[6],t,e))}(r,i,s)}(15),Lt(),Lt()),2&t){const r=cg(1),s=cg(12);Wi("for",i.inputId),Kt(2),Ai("mat-slide-toggle-bar-no-side-margin",!s.textContent||!s.textContent.trim()),Kt(2),on("id",i.inputId)("required",i.required)("tabIndex",i.tabIndex)("checked",i.checked)("disabled",i.disabled),Wi("name",i.name)("aria-checked",i.checked.toString())("aria-label",i.ariaLabel)("aria-labelledby",i.ariaLabelledby)("aria-describedby",i.ariaDescribedby),Kt(5),on("matRippleTrigger",r)("matRippleDisabled",i.disableRipple||i.disabled)("matRippleCentered",!0)("matRippleRadius",20)("matRippleAnimation",function(n,e,t,i){return Hk(Bt(),xs(),n,e,t,i)}(18,sNe,i._noopAnimations?0:150))}},directives:[bm,G5],styles:[".mat-slide-toggle{display:inline-block;height:24px;max-width:100%;line-height:24px;white-space:nowrap;outline:none;-webkit-tap-highlight-color:transparent}.mat-slide-toggle.mat-checked .mat-slide-toggle-thumb-container{transform:translate3d(16px, 0, 0)}[dir=rtl] .mat-slide-toggle.mat-checked .mat-slide-toggle-thumb-container{transform:translate3d(-16px, 0, 0)}.mat-slide-toggle.mat-disabled{opacity:.38}.mat-slide-toggle.mat-disabled .mat-slide-toggle-label,.mat-slide-toggle.mat-disabled .mat-slide-toggle-thumb-container{cursor:default}.mat-slide-toggle-label{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;display:flex;flex:1;flex-direction:row;align-items:center;height:inherit;cursor:pointer}.mat-slide-toggle-content{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.mat-slide-toggle-label-before .mat-slide-toggle-label{order:1}.mat-slide-toggle-label-before .mat-slide-toggle-bar{order:2}[dir=rtl] .mat-slide-toggle-label-before .mat-slide-toggle-bar,.mat-slide-toggle-bar{margin-right:8px;margin-left:0}[dir=rtl] .mat-slide-toggle-bar,.mat-slide-toggle-label-before .mat-slide-toggle-bar{margin-left:8px;margin-right:0}.mat-slide-toggle-bar-no-side-margin{margin-left:0;margin-right:0}.mat-slide-toggle-thumb-container{position:absolute;z-index:1;width:20px;height:20px;top:-3px;left:0;transform:translate3d(0, 0, 0);transition:all 80ms linear;transition-property:transform}._mat-animation-noopable .mat-slide-toggle-thumb-container{transition:none}[dir=rtl] .mat-slide-toggle-thumb-container{left:auto;right:0}.mat-slide-toggle-thumb{height:20px;width:20px;border-radius:50%}.mat-slide-toggle-bar{position:relative;width:36px;height:14px;flex-shrink:0;border-radius:8px}.mat-slide-toggle-input{bottom:0;left:10px}[dir=rtl] .mat-slide-toggle-input{left:auto;right:10px}.mat-slide-toggle-bar,.mat-slide-toggle-thumb{transition:all 80ms linear;transition-property:background-color;transition-delay:50ms}._mat-animation-noopable .mat-slide-toggle-bar,._mat-animation-noopable .mat-slide-toggle-thumb{transition:none}.mat-slide-toggle .mat-slide-toggle-ripple{position:absolute;top:calc(50% - 20px);left:calc(50% - 20px);height:40px;width:40px;z-index:1;pointer-events:none}.mat-slide-toggle .mat-slide-toggle-ripple .mat-ripple-element:not(.mat-slide-toggle-persistent-ripple){opacity:.12}.mat-slide-toggle-persistent-ripple{width:100%;height:100%;transform:none}.mat-slide-toggle-bar:hover .mat-slide-toggle-persistent-ripple{opacity:.04}.mat-slide-toggle:not(.mat-disabled).cdk-keyboard-focused .mat-slide-toggle-persistent-ripple{opacity:.12}.mat-slide-toggle-persistent-ripple,.mat-slide-toggle.mat-disabled .mat-slide-toggle-bar:hover .mat-slide-toggle-persistent-ripple{opacity:0}@media(hover: none){.mat-slide-toggle-bar:hover .mat-slide-toggle-persistent-ripple{display:none}}.cdk-high-contrast-active .mat-slide-toggle-thumb,.cdk-high-contrast-active .mat-slide-toggle-bar{border:1px solid}.cdk-high-contrast-active .mat-slide-toggle.cdk-keyboard-focused .mat-slide-toggle-bar{outline:2px dotted;outline-offset:5px}\n"],encapsulation:2,changeDetection:0}),n})(),a9=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=ln({type:n}),n.\u0275inj=wt({}),n})(),pNe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=ln({type:n}),n.\u0275inj=wt({imports:[[a9,tC,mr,EN],a9,mr]}),n})(),gNe=(()=>{class n{constructor(){this.clsName="ccf-slide-toggle",this.labels=["Left","Right"],this.value="Left",this.disabled=!1,this.valueChange=new hn}get left(){const{value:t,labels:i}=this;return t!==i[1]}updateToggle(t){this.value=t?this.labels[0]:this.labels[1],this.valueChange.emit(this.value)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=yn({type:n,selectors:[["ccf-slide-toggle"]],hostVars:2,hostBindings:function(t,i){2&t&&jc(i.clsName)},inputs:{labels:"labels",value:"value",disabled:"disabled"},outputs:{valueChange:"valueChange"},decls:6,vars:12,consts:[[1,"slide-label",3,"click"],[1,"slider",3,"disabled","checked","change"],["toggle",""]],template:function(t,i){if(1&t){const r=Wl();Ft(0,"span",0),Vn("click",function(){Ir(r);const o=cg(3);return i.left||o.toggle(),i.updateToggle(!0)}),Mi(1),Lt(),Ft(2,"mat-slide-toggle",1,2),Vn("change",function(o){return i.updateToggle(!o.checked)}),Lt(),Ft(4,"span",0),Vn("click",function(){Ir(r);const o=cg(3);return i.left&&o.toggle(),i.updateToggle(!1)}),Mi(5),Lt()}2&t&&(Ai("disabled",i.disabled)("highlighted",i.left),Kt(1),Os(i.labels[0].charAt(0).toUpperCase()+i.labels[0].slice(1)),Kt(1),on("disabled",i.disabled)("checked",!i.left),Kt(2),Ai("disabled",i.disabled)("highlighted",!i.left),Kt(1),Os(i.labels[1].charAt(0).toUpperCase()+i.labels[1].slice(1)))},directives:[o9],styles:["[_nghost-%COMP%]   .slide-label[_ngcontent-%COMP%]{margin:0 1rem;transition:color .6s;cursor:pointer;opacity:50%}[_nghost-%COMP%]   .slide-label.highlighted[_ngcontent-%COMP%]{opacity:100%}[_nghost-%COMP%]   .disabled[_ngcontent-%COMP%]{opacity:30%!important;cursor:not-allowed}[_nghost-%COMP%]     .slider .mat-slide-toggle-bar{background-color:#43476580}[_nghost-%COMP%]     .slider .mat-slide-toggle-thumb{background-color:#434765}"],changeDetection:0}),n})();const mNe=["bodyUI"],_Ne=function(){return["Male","Female"]},yNe=function(){return["Left","Right"]};let vNe=(()=>{class n{constructor(t){this.ga=t,this.sexChange=new hn,this.sideChange=new hn}ngAfterViewChecked(){this.updateHighlighting()}updateHighlighting(){var t,i,r,s;const o=new Set(null!==(i=null===(t=this.filter)||void 0===t?void 0:t.tmc)&&void 0!==i?i:[]);this.filteredBlocks=null!==(s=null===(r=this.blocks)||void 0===r?void 0:r.filter(a=>o.has(a.donor.providerName)).map(a=>a["@id"]))&&void 0!==s?s:[],this.bodyUI.scene=this.bodyUI.scene.map(a=>{var l;return Object.assign(Object.assign({},a),{color:a.entityId&&this.highlightedNodeId===a["@id"]?[30,136,229,255]:this.filteredBlocks.includes(null!==(l=a.entityId)&&void 0!==l?l:"")?[173,255,47,229.5]:[255,255,255,229.5]})})}ngOnChanges(t){this.bodyUI&&"organ"in t&&this.zoomToFitOrgan()}updateSex(t){this.sex=t,this.sexChange.emit(this.sex)}updateSide(t){this.side=t,this.sideChange.emit(this.side)}zoomToFitOrgan(){const{bodyUI:t,organ:i}=this;if(i){const{x_dimension:r,y_dimension:s,z_dimension:o}=i;t.rotation=t.rotationX=0,t.bounds={x:1.25*r/1e3,y:1.25*s/1e3,z:1.25*o/1e3},t.target=[r/1e3/2,s/1e3/2,o/1e3/2]}}nodeClicked(t){this.ga.event("node_click","organ",t.node["@id"]),this.highlightedNodeId=this.highlightedNodeId&&this.highlightedNodeId===t.node["@id"]?"":t.node["@id"]}}return n.\u0275fac=function(t){return new(t||n)(De(jC))},n.\u0275cmp=yn({type:n,selectors:[["ccf-organ"]],viewQuery:function(t,i){if(1&t&&Rr(mNe,7),2&t){let r;mi(r=_i())&&(i.bodyUI=r.first)}},inputs:{organ:"organ",scene:"scene",organIri:"organIri",sex:"sex",side:"side",blocks:"blocks",filter:"filter"},outputs:{sexChange:"sexChange",sideChange:"sideChange"},features:[zi],decls:5,vars:10,consts:[["camera","perspective",1,"body-ui",3,"scene","interactive","nodeClick","initialized"],["bodyUI",""],[1,"stage-options"],[1,"view-slider",3,"labels","value","hidden","valueChange"]],template:function(t,i){1&t&&(Ft(0,"ccf-body-ui",0,1),Vn("nodeClick",function(s){return i.nodeClicked(s)})("initialized",function(){return i.zoomToFitOrgan()}),Lt(),Ft(2,"div",2),Ft(3,"ccf-slide-toggle",3),Vn("valueChange",function(s){return i.updateSex(s)}),Lt(),Ft(4,"ccf-slide-toggle",3),Vn("valueChange",function(s){return i.updateSide(s)}),Lt(),Lt()),2&t&&(on("scene",i.scene)("interactive",!0),Kt(3),on("labels",lE(8,_Ne))("value",i.sex)("hidden",!i.sex),Kt(1),on("labels",lE(9,yNe))("value",i.side)("hidden",!i.side))},directives:[yRe,gNe],styles:["[_nghost-%COMP%]{display:block;background-color:#000;border-radius:.5rem;color:#fff;height:100%}[_nghost-%COMP%]   .body-ui[_ngcontent-%COMP%]{height:90%}[_nghost-%COMP%]   .stage-options[_ngcontent-%COMP%]{padding:1rem;min-width:352px}"],changeDetection:0}),n})();function bNe(n,e){if(1&n&&(Ft(0,"div",3),Ft(1,"div",4),Mi(2),Lt(),Ft(3,"div",5),Mi(4),Lt(),Lt()),2&n){const t=e.$implicit;Kt(2),Os(t.count),Kt(2),Os(t.label)}}let wNe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=yn({type:n,selectors:[["ccf-stats-list"]],inputs:{statsLabel:"statsLabel",stats:"stats"},decls:4,vars:2,consts:[[1,"stats-container"],[1,"header"],["class","stats-row",4,"ngFor","ngForOf"],[1,"stats-row"],[1,"stat"],[1,"label"]],template:function(t,i){1&t&&(Ft(0,"div",0),Ft(1,"div",1),Mi(2),Lt(),Si(3,bNe,5,2,"div",2),Lt()),2&t&&(Kt(2),zc(" ",i.statsLabel," "),Kt(1),on("ngForOf",i.stats))},directives:[ih],styles:[".stats-container[_ngcontent-%COMP%]{margin-bottom:2rem;min-height:9rem}.stats-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{margin-bottom:1rem}.stats-container[_ngcontent-%COMP%]   .stats-row[_ngcontent-%COMP%]{display:flex;flex-direction:row;height:1.325rem}.stats-container[_ngcontent-%COMP%]   .stats-row[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]{width:2rem;margin-right:1rem;text-align:right}.stats-container[_ngcontent-%COMP%]   .stats-row[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{flex-grow:1;text-align:left}"],changeDetection:0}),n})();function ENe(n,e){if(1&n){const t=Wl();Ft(0,"div",6),Ft(1,"div",7),Ft(2,"div",8),Mi(3),Lt(),Ft(4,"div",9),Vn("click",function(){const s=Ir(t).$implicit;return xi().goToURL(s.buttonUrl)}),Mi(5),Lt(),Lt(),Lt()}if(2&n){const t=e.$implicit;Kt(3),Os(t.body),Kt(1),on("gaLabel",t.buttonUrl),Kt(1),zc(" ",t.buttonTitle,"")}}function SNe(n,e){if(1&n){const t=Wl();Ft(0,"div",10),Vn("click",function(){const s=Ir(t).$implicit;return xi().goToURL(s.buttonUrl)}),Mi(1),Lt()}if(2&n){const t=e.$implicit;on("gaLabel",t.buttonUrl),Kt(1),Os(t.buttonTitle)}}let xNe=(()=>{class n{constructor(){this.linkCards=[{body:"Add tissue blocks using the CCF Registration User Interface (RUI).",buttonTitle:"Register Tissue",buttonUrl:"https://hubmapconsortium.github.io/ccf-ui/rui/"},{body:"Explore tissue sections in tissue blocks with the CCF Exploration User Interface (EUI).",buttonTitle:"Explore Tissue",buttonUrl:"https://portal.hubmapconsortium.org/ccf-eui"},{body:"View linkages between anatomical structures, cell types, and common biomarkers (ASCT+B).",buttonTitle:"ASCT+B Reporter",buttonUrl:"https://hubmapconsortium.github.io/ccf-asct-reporter/"}],this.deepDives=[{body:"",buttonTitle:"CCF Portal",buttonUrl:"https://hubmapconsortium.github.io/ccf/"},{body:"",buttonTitle:"Online Course",buttonUrl:"https://expand.iu.edu/browse/sice/cns/courses/hubmap-visible-human-mooc"},{body:"",buttonTitle:"Paper",buttonUrl:"https://www.biorxiv.org/content/10.1101/2021.05.31.446440v2"}]}goToURL(t){window.open(t,"_blank")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=yn({type:n,selectors:[["ccf-link-cards"]],decls:7,vars:2,consts:[["gaCategory","link-cards",1,"link-cards-container"],["class","link-card",4,"ngFor","ngForOf"],["gaCategory","deep-dive",1,"deep-dive-section"],[1,"title"],[1,"button-container"],["class","btn-outline btn","gaEvent","visit-link",3,"gaLabel","click",4,"ngFor","ngForOf"],[1,"link-card"],[1,"link-card-content"],[1,"body"],["gaEvent","visit-link",1,"link-button","btn",3,"gaLabel","click"],["gaEvent","visit-link",1,"btn-outline","btn",3,"gaLabel","click"]],template:function(t,i){1&t&&(Ft(0,"div",0),Si(1,ENe,6,3,"div",1),Lt(),Ft(2,"div",2),Ft(3,"div",3),Mi(4,"Common Coordinate Framework (CCF) Deep Dive"),Lt(),Ft(5,"div",4),Si(6,SNe,2,2,"div",5),Lt(),Lt()),2&t&&(Kt(1),on("ngForOf",i.linkCards),Kt(5),on("ngForOf",i.deepDives))},directives:[v7,ih,b7],styles:[".link-cards-container[_ngcontent-%COMP%]{max-width:30rem}.link-cards-container[_ngcontent-%COMP%]   .link-card[_ngcontent-%COMP%]{border-top:1px solid #e0e0e0;padding-top:1px;padding-bottom:1px}.link-cards-container[_ngcontent-%COMP%]   .link-card[_ngcontent-%COMP%]:last-of-type{border-bottom:1px solid #e0e0e0}.link-cards-container[_ngcontent-%COMP%]   .link-card[_ngcontent-%COMP%]   .link-card-content[_ngcontent-%COMP%]{align-items:center;padding:1rem 0 1rem 1rem;display:flex;flex-direction:row;justify-content:space-between;border-left:6px solid #444A65}.link-cards-container[_ngcontent-%COMP%]   .link-card[_ngcontent-%COMP%]   .link-card-content[_ngcontent-%COMP%]   .link-button[_ngcontent-%COMP%]{margin-left:2rem;background-color:#444a65;color:#fff}.link-cards-container[_ngcontent-%COMP%]   .link-card[_ngcontent-%COMP%]   .link-card-content[_ngcontent-%COMP%]   .link-button[_ngcontent-%COMP%]:hover{background-color:#2f3346}.deep-dive-section[_ngcontent-%COMP%]{margin-top:2rem}.deep-dive-section[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{margin-bottom:1rem;font-size:1rem}.deep-dive-section[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]{display:flex;flex-direction:row}.deep-dive-section[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]   .btn-outline[_ngcontent-%COMP%]{color:#444a65;border:1px solid #444A65;background-color:#fff}.deep-dive-section[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]   .btn-outline[_ngcontent-%COMP%]:not(:last-of-type){margin-right:1rem}.deep-dive-section[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]   .btn-outline[_ngcontent-%COMP%]:hover{background-color:#e0e0e0}.btn[_ngcontent-%COMP%]{min-width:9rem!important;max-height:2.28125rem;text-align:center;white-space:nowrap;cursor:pointer;font-size:.875rem;font-weight:500;border-radius:2px;line-height:2.75;transition:background-color .25s cubic-bezier(.4,0,.2,1) 0ms,box-shadow .25s cubic-bezier(.4,0,.2,1) 0ms,border .25s cubic-bezier(.4,0,.2,1) 0ms;font-family:Inter Variable,Helvetica,Arial,sans-serif}"],changeDetection:0}),n})();const CNe=["left"],TNe=["right"],ANe=function(){return[]},MNe=[{color:[0,0,0,0],opacity:.001}];let DNe=(()=>{class n{constructor(t,i,r){this.ga=i,this.configState=r,this.sex$=this.configState.getOption("sex"),this.side$=this.configState.getOption("side"),this.filter$=this.configState.getOption("highlightProviders").pipe(me(s=>({tmc:s}))),this.latestConfig={},this.organInfo$=r.config$.pipe(dr(s=>this.latestConfig=s),ts(s=>{var o,a,l;return t.getOrganInfo(null!==(o=s.organIri)&&void 0!==o?o:"",null===(l=null===(a=s.side)||void 0===a?void 0:a.toLowerCase)||void 0===l?void 0:l.call(a),s.sex)}),dr(s=>this.logOrganLookup(s)),dr(s=>this.latestOrganInfo=s),ja(1)),this.organ$=this.organInfo$.pipe(ts(s=>s?t.getOrgan(s,s.hasSex?this.latestConfig.sex:void 0):nn(void 0)),dr(s=>{var o;if(s&&this.latestOrganInfo){const a=(null===(o=this.latestOrganInfo)||void 0===o?void 0:o.hasSex)?s.sex:void 0;a!==this.latestConfig.sex&&this.updateInput("sex",a),s.side!==this.latestConfig.side&&this.updateInput("side",s.side)}}),ja(1)),this.scene$=this.organ$.pipe(ts(s=>s&&this.latestOrganInfo?t.getOrganScene(this.latestOrganInfo,s.sex):nn(MNe))),this.stats$=this.organ$.pipe(ts(s=>s&&this.latestOrganInfo?t.getOrganStats(this.latestOrganInfo,s.sex):nn([]))),this.statsLabel$=this.organ$.pipe(me(s=>this.makeStatsLabel(this.latestOrganInfo,null==s?void 0:s.sex)),function(...n){const e=n[n.length-1];return xe(e)?(n.pop(),t=>sC(n,t,e)):t=>sC(n,t)}("Loading...")),this.blocks$=this.organ$.pipe(ts(s=>s&&this.latestOrganInfo?t.getBlocks(this.latestOrganInfo,s.sex):nn([])))}ngAfterViewInit(){const{left:t,right:i}=this;t.nativeElement.style.height=`${i.nativeElement.offsetHeight}px`}updateInput(t,i){this.configState.patchConfig({[t]:i})}makeStatsLabel(t,i){let r=[`Unknown IRI: ${this.latestConfig.organIri}`];if(t){const s=t.side?t.side.charAt(0).toUpperCase()+t.side.slice(1):void 0;r=[i,t.organ,s]}return r.filter(s=>!!s).join(", ")}logOrganLookup(t){this.ga.event(t?"organ_lookup_success":"organ_lookup_failure","organ",`Iri: ${this.latestConfig.organIri} - Sex: ${this.latestConfig.sex} - Side: ${this.latestConfig.side}`)}}return n.\u0275fac=function(t){return new(t||n)(De(tNe),De(jC),De(Vm))},n.\u0275cmp=yn({type:n,selectors:[["ccf-root"]],viewQuery:function(t,i){if(1&t&&(Rr(CNe,7,En),Rr(TNe,7,En)),2&t){let r;mi(r=_i())&&(i.left=r.first),mi(r=_i())&&(i.right=r.first)}},decls:16,vars:25,consts:[[1,"container"],[1,"left"],["left",""],[3,"blocks","filter","sex","side","organ","scene","sexChange","sideChange"],[1,"right"],["right",""],[3,"statsLabel","stats"]],template:function(t,i){if(1&t&&(Ft(0,"div",0),Ft(1,"div",1,2),Ft(3,"ccf-organ",3),Vn("sexChange",function(s){return i.updateInput("sex",s)})("sideChange",function(s){return i.updateInput("side",s)}),yl(4,"async"),yl(5,"async"),yl(6,"async"),yl(7,"async"),yl(8,"async"),yl(9,"async"),Lt(),Lt(),Ft(10,"div",4,5),Ti(12,"ccf-stats-list",6),yl(13,"async"),yl(14,"async"),Ti(15,"ccf-link-cards"),Lt(),Lt()),2&t){let r;Kt(3),on("blocks",vl(4,8,i.blocks$))("filter",vl(5,10,i.filter$))("sex",vl(6,12,i.sex$))("side",vl(7,14,i.side$))("organ",vl(8,16,i.organ$))("scene",null!==(r=vl(9,18,i.scene$))&&void 0!==r?r:lE(24,ANe)),Kt(9),on("statsLabel",vl(13,20,i.statsLabel$))("stats",vl(14,22,i.stats$))}},directives:[vNe,wNe,xNe],pipes:[LE],styles:[".container[_ngcontent-%COMP%]{height:-webkit-fit-content;height:-moz-fit-content;height:fit-content;display:flex;flex-direction:row;padding:1rem;font-family:Inter;font-size:.95rem;line-height:1.5;text-align:left;position:relative;background-color:#fff;color:#000}.container[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%]{width:auto;flex-grow:1}.container[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{margin-left:2rem;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content;width:29rem}"],changeDetection:0}),n})();function INe(n,e){1&n&&Ti(0,"ccf-root")}function ONe(n){const e=i=>"string"==typeof i,t=i=>Array.isArray(i)&&i.every(e);if("string"==typeof n){const i=DD.json(n);if(t(i))return i}else if(t(n))return n;throw new Error("Invalid data sources")}function RNe(n){const e=i=>"string"==typeof i,t=i=>Array.isArray(i)&&i.every(e);if("string"==typeof n){if(!(null==n?void 0:n.startsWith("[")))return[n];{const i=DD.json(n);if(t(i))return i}}else if(t(n))return n;throw new Error("Invalid data sources")}let NNe=(()=>{class n extends Kte{constructor(t,i){super(t,i,{initialDelay:10,initialConfig:Object.assign(Object.assign({},Cf.dbOptions),globalThis.dbOptions),parse:{dataSources:ONe,highlightProviders:RNe,useRemoteApi:DD.boolean}}),this.sex="Female",this.side="Left"}}return n.\u0275fac=function(t){return new(t||n)(De(Vm),De(as))},n.\u0275cmp=yn({type:n,selectors:[["ccf-root-wc"]],inputs:{organIri:"organIri",sex:"sex",side:"side",dataSources:"dataSources",highlightProviders:"highlightProviders",hubmapDataService:"hubmapDataService",hubmapDataUrl:"hubmapDataUrl",hubmapAssetUrl:"hubmapAssetUrl",hubmapToken:"hubmapToken",hubmapPortalUrl:"hubmapPortalUrl",useRemoteApi:"useRemoteApi",remoteApiEndpoint:"remoteApiEndpoint"},features:[In],decls:1,vars:1,consts:[[4,"ngIf"]],template:function(t,i){1&t&&Si(0,INe,1,0,"ccf-root",0),2&t&&on("ngIf",i.initialized)},directives:[Hu,DNe],encapsulation:2,changeDetection:0}),n})(),PNe=(()=>{class n extends eNe{selectToken(t){return t.useRemoteApi&&t.remoteApiEndpoint?QRe:JRe}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=$i(n)))(i||n)}}(),n.\u0275prov=We({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),FNe=(()=>{class n{constructor(t,i){this.accessor=t,this.injector=i}static forRoot(t=[]){return{ngModule:n,providers:[hs,Ya,sW,...t]}}}return n.\u0275fac=function(t){return new(t||n)(Ie(hs,2),Ie(Ya,2))},n.\u0275mod=ln({type:n}),n.\u0275inj=wt({}),n})();const t1=(n,e)=>((n,e)=>new Array(e+1).join("0"))(0,e-n.toString().length)+n;class BNe{constructor(e,t,i){this.action=e,this.store=t,this.logWriter=i}dispatched(e){const t=Uf(this.action),i=function(n){return t1(n.getHours(),2)+":"+t1(n.getMinutes(),2)+":"+t1(n.getSeconds(),2)+"."+t1(n.getMilliseconds(),3)}(new Date);this.logWriter.startGroup(`action ${t} @ ${i}`),this._hasPayload(this.action)&&this.logWriter.logGrey("payload",Object.assign({},this.action)),this.logWriter.logGrey("prev state",e)}completed(e){this.logWriter.logGreen("next state",e),this.logWriter.endGroup()}errored(e){this.logWriter.logRedish("next state after error",this.store.snapshot()),this.logWriter.logRedish("error",e),this.logWriter.endGroup()}_hasPayload(e){return this._getNonEmptyProperties(e).length>0}_getNonEmptyProperties(e){return Object.keys(e).map(r=>e[r]).filter(r=>void 0!==r)}}class VNe{constructor(e){this.options=e,this.options=this.options||{},this.logger=e.logger||console}startGroup(e){const t=this.options.collapsed?this.logger.groupCollapsed:this.logger.group;try{t.call(this.logger,e)}catch(i){console.log(e)}}endGroup(){try{this.logger.groupEnd()}catch(e){this.logger.log("\u2014\u2014 log end \u2014\u2014")}}logGrey(e,t){this.log(e,"color: #9E9E9E; font-weight: bold",t)}logGreen(e,t){this.log(e,"color: #4CAF50; font-weight: bold",t)}logRedish(e,t){this.log(e,"color: #FD8182; font-weight: bold",t)}log(e,t,i){this.isIE()?this.logger.log(e,i):this.logger.log("%c "+e,t,i)}isIE(){const e="undefined"!=typeof window&&window.navigator.userAgent?window.navigator.userAgent:"";let t=!1;const i=e.indexOf("MSIE "),r=e.indexOf("Trident/");return(i>-1||r>-1)&&(t=!0),t}}const l9=new zt("NGXS_LOGGER_PLUGIN_OPTIONS");let jNe=(()=>{class n{constructor(t,i){this._options=t,this._injector=i}handle(t,i,r){if(this._options.disabled||!this._options.filter(i,t))return r(t,i);this._logWriter=this._logWriter||new VNe(this._options),this._store=this._store||this._injector.get(mh);const s=new BNe(i,this._store,this._logWriter);return s.dispatched(t),r(t,i).pipe(dr(o=>{s.completed(o)}),fc(o=>{throw s.errored(o),o}))}}return n.\u0275fac=function(t){return new(t||n)(Ie(l9),Ie(Un))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const c9=new zt("LOGGER_USER_OPTIONS");function UNe(n){return Object.assign({},{logger:console,collapsed:!1,disabled:!1,filter:()=>!0},n)}let zNe=(()=>{class n{static forRoot(t){return{ngModule:n,providers:[{provide:v8,useClass:jNe,multi:!0},{provide:c9,useValue:t},{provide:l9,useFactory:UNe,deps:[c9]}]}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=ln({type:n}),n.\u0275inj=wt({}),n})();const HNe=[Vm];let GNe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=ln({type:n}),n.\u0275inj=wt({imports:[[FNe.forRoot(),pa.forRoot(HNe,{developmentMode:!Cf.production}),zNe.forRoot({disabled:Cf.production})]]}),n})(),$Ne=(()=>{class n{constructor(t){if(t)throw new Error("The core module should only be imported once in the root module")}}return n.\u0275fac=function(t){return new(t||n)(Ie(n,12))},n.\u0275mod=ln({type:n}),n.\u0275inj=wt({providers:[{provide:i9,useExisting:PNe}],imports:[[C$,HDe.forRoot({gaToken:Cf.googleAnalyticsToken,appName:"organ-info",projectName:"ccf",developmentMode:!Cf.production}),QDe.forRoot(()=>new Rv({basePath:Cf.dbOptions.remoteApiEndpoint})),GNe]]}),n})(),WNe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=ln({type:n}),n.\u0275inj=wt({imports:[[es,pNe]]}),n})(),qNe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=ln({type:n}),n.\u0275inj=wt({imports:[[es,vRe,WNe]]}),n})(),YNe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=ln({type:n}),n.\u0275inj=wt({imports:[[es,UC]]}),n})(),KNe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=ln({type:n}),n.\u0275inj=wt({imports:[[es]]}),n})(),XNe=(()=>{class n{constructor(t){this.injector=t}ngDoBootstrap(){const t=function(n,e){const t=function(n,e){return e.get(gl).resolveComponentFactory(n).inputs}(n,e.injector),i=e.strategyFactory||new Hte(n,e.injector),r=function(n){const e={};return n.forEach(({propName:t,templateName:i})=>{e[function(n){return n.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}(i)]=t}),e}(t);class s extends $te{constructor(a){super(),this.injector=a}get ngElementStrategy(){if(!this._ngElementStrategy){const a=this._ngElementStrategy=i.create(this.injector||e.injector);t.forEach(({propName:l})=>{if(!this.hasOwnProperty(l))return;const c=this[l];delete this[l],a.setInputValue(l,c)})}return this._ngElementStrategy}attributeChangedCallback(a,l,c,u){this.ngElementStrategy.setInputValue(r[a],c)}connectedCallback(){let a=!1;this.ngElementStrategy.events&&(this.subscribeToEvents(),a=!0),this.ngElementStrategy.connect(this),a||this.subscribeToEvents()}disconnectedCallback(){this._ngElementStrategy&&this._ngElementStrategy.disconnect(),this.ngElementEventsSubscription&&(this.ngElementEventsSubscription.unsubscribe(),this.ngElementEventsSubscription=null)}subscribeToEvents(){this.ngElementEventsSubscription=this.ngElementStrategy.events.subscribe(a=>{const l=function(n,e,t){if("function"!=typeof CustomEvent){const s=n.createEvent("CustomEvent");return s.initCustomEvent(e,!1,!1,t),s}return new CustomEvent(e,{bubbles:!1,cancelable:!1,detail:t})}(this.ownerDocument,a.name,a.value);this.dispatchEvent(l)})}}return s.observedAttributes=Object.keys(r),t.forEach(({propName:o})=>{Object.defineProperty(s.prototype,o,{get(){return this.ngElementStrategy.getInputValue(o)},set(a){this.ngElementStrategy.setInputValue(o,a)},configurable:!0,enumerable:!0})}),s}(NNe,{injector:this.injector});customElements.define("ccf-organ-info",t)}}return n.\u0275fac=function(t){return new(t||n)(Ie(Un))},n.\u0275mod=ln({type:n}),n.\u0275inj=wt({providers:[],imports:[[TD,$Ne,YNe,KNe,qNe]]}),n})();Cf.production&&function(){if(C3)throw new Error("Cannot enable prod mode after platform setup.");x3=!1}(),hte().bootstrapModule(XNe).catch(n=>console.error(n))},52:Vt=>{function it(mt,J,Mt,ht,K,Me,pe){try{var Y=mt[Me](pe),U=Y.value}catch(k){return void Mt(k)}Y.done?J(U):Promise.resolve(U).then(ht,K)}Vt.exports=function(mt){return function(){var J=this,Mt=arguments;return new Promise(function(ht,K){var Me=mt.apply(J,Mt);function pe(U){it(Me,ht,K,pe,Y,"next",U)}function Y(U){it(Me,ht,K,pe,Y,"throw",U)}pe(void 0)})}},Vt.exports.default=Vt.exports,Vt.exports.__esModule=!0},948:Vt=>{Vt.exports=function(nt){return nt&&nt.__esModule?nt:{default:nt}},Vt.exports.default=Vt.exports,Vt.exports.__esModule=!0},321:Vt=>{function it(nt){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?(Vt.exports=it=function(J){return typeof J},Vt.exports.default=Vt.exports,Vt.exports.__esModule=!0):(Vt.exports=it=function(J){return J&&"function"==typeof Symbol&&J.constructor===Symbol&&J!==Symbol.prototype?"symbol":typeof J},Vt.exports.default=Vt.exports,Vt.exports.__esModule=!0),it(nt)}Vt.exports=it,Vt.exports.default=Vt.exports,Vt.exports.__esModule=!0},82:Vt=>{function it(nt){return Promise.resolve().then(()=>{var mt=new Error("Cannot find module '"+nt+"'");throw mt.code="MODULE_NOT_FOUND",mt})}it.keys=()=>[],it.resolve=it,it.id=82,Vt.exports=it},521:()=>{},125:()=>{},307:()=>{}},Vt=>{Vt(Vt.s=525)}]);